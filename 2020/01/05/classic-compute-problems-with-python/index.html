<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.5" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.5">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.5" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.0.5',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="Python,DataStructure,Algorithm,Advanced,Program,Search," />


<meta name="description" content="一、斐波那契数列递归函数123456789def fib(n: int) -&amp;gt; int:    if n &amp;lt; 2:        return n    return fib(n - 2) + fib(n - 1)if __name__ == &apos;__main__&apos;:    for i in range(10):        print(fib(i), end=&apos; &apos;)# =&amp;gt;">
<meta name="keywords" content="Python,DataStructure,Algorithm,Advanced,Program,Search">
<meta property="og:type" content="article">
<meta property="og:title" content="基本算法问题的 Python 解法（递归与搜索）">
<meta property="og:url" content="https://rollingstarky.github.io/2020/01/05/classic-compute-problems-with-python/index.html">
<meta property="og:site_name" content="StarryLand">
<meta property="og:description" content="一、斐波那契数列递归函数123456789def fib(n: int) -&amp;gt; int:    if n &amp;lt; 2:        return n    return fib(n - 2) + fib(n - 1)if __name__ == &apos;__main__&apos;:    for i in range(10):        print(fib(i), end=&apos; &apos;)# =&amp;gt;">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/6875152-f5a72f3f63c7824b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2020-01-04T20:00:50.117Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基本算法问题的 Python 解法（递归与搜索）">
<meta name="twitter:description" content="一、斐波那契数列递归函数123456789def fib(n: int) -&amp;gt; int:    if n &amp;lt; 2:        return n    return fib(n - 2) + fib(n - 1)if __name__ == &apos;__main__&apos;:    for i in range(10):        print(fib(i), end=&apos; &apos;)# =&amp;gt;">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/6875152-f5a72f3f63c7824b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



  <link rel="alternate" href="/atom.xml" title="StarryLand" type="application/atom+xml" />




  <link rel="canonical" href="https://rollingstarky.github.io/2020/01/05/classic-compute-problems-with-python/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>基本算法问题的 Python 解法（递归与搜索） | StarryLand</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">StarryLand</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我的全部道路，就是从孤独走向人间</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://rollingstarky.github.io/2020/01/05/classic-compute-problems-with-python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="星舞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="StarryLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">基本算法问题的 Python 解法（递归与搜索）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-05T00:00:00+08:00">2020-01-05</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/05/classic-compute-problems-with-python/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/01/05/classic-compute-problems-with-python/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/01/05/classic-compute-problems-with-python/" class="leancloud_visitors" data-flag-title="基本算法问题的 Python 解法（递归与搜索）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">21k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">0:21</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="一、斐波那契数列"><a href="#一、斐波那契数列" class="headerlink" title="一、斐波那契数列"></a>一、斐波那契数列</h4><h5 id="递归函数"><a href="#递归函数" class="headerlink" title="递归函数"></a>递归函数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> fib(n - <span class="number">2</span>) + fib(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        print(fib(i), end=<span class="string">' '</span>)</span><br><span class="line"><span class="comment"># =&gt; 0 1 1 2 3 5 8 13 21 34</span></span><br></pre></td></tr></table></figure>
<p>不要尝试调用 <code>fib(50)</code>（这个我试过了，因为等得不耐烦 Ctrl+C 掉了）。在上面版本的程序中，每次对 <code>fib()</code> 函数的调用都会导致额外的两次对 <code>fib()</code> 自身的调用（即 <code>fib(n -2)</code> 和 <code>fib(n - 1)</code>）。这个行为模式会一直传递下去，直到每一个新的调用分支都满足 <code>n &lt; 2</code>。<br>比如 <code>fib(4)</code> 最终会执行以下函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fib(4) -&gt; fib(3), fib(2)</span><br><span class="line">fib(3) -&gt; fib(2), fib(1)</span><br><span class="line">fib(2) -&gt; fib(1), fib(0)</span><br><span class="line">fib(2) -&gt; fib(1), fib(0)</span><br><span class="line">fib(1) -&gt; 1</span><br><span class="line">fib(1) -&gt; 1</span><br><span class="line">fib(1) -&gt; 1</span><br><span class="line">fib(0) -&gt; 0</span><br><span class="line">fib(0) -&gt; 0</span><br></pre></td></tr></table></figure></p>
<p>计算 <code>fib(4)</code> 最终会调用 9 次 <code>fib()</code> 函数，<code>fib(5)</code> 调用 15 次，<code>fib(10)</code> 调用 177 次，计算 <code>fib(20)</code> 则需要执行整整 21891 次。<br>换句话说，函数的调用树会以<strong>指数级</strong>的速度扩展。</p>
<h5 id="Memoization"><a href="#Memoization" class="headerlink" title="Memoization"></a>Memoization</h5><p>Memoization 是指将计算任务执行后得到的结果保存在某个地方，后面需要用到时就可以直接取出使用，而不必再次计算。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Dict</span><br><span class="line">memo: Dict[int, int] = &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">1</span>&#125;  <span class="comment"># base cases</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib2</span><span class="params">(n: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> memo:</span><br><span class="line">        memo[n] = fib2(n <span class="number">-1</span>) + fib2(n - <span class="number">2</span>)  <span class="comment"># memoization</span></span><br><span class="line">    <span class="keyword">return</span> memo[n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(fib2(<span class="number">50</span>))</span><br><span class="line"><span class="comment"># =&gt; 12586269025</span></span><br></pre></td></tr></table></figure></p>
<h5 id="lru-cache"><a href="#lru-cache" class="headerlink" title="lru_cache"></a>lru_cache</h5><p>Python 提供了一个内置的装饰器 <a href="mailto:``@functools.lr" target="_blank" rel="noopener">``@functools.lr</a>u_cache()<code>用来自动记录（缓存）某个函数的执行结果。因此上面的</code>fib2()<code></code> 可以改为如下形式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"></span><br><span class="line"><span class="meta">@lru_cache(maxsize=None)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib3</span><span class="params">(n: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> fib3(n - <span class="number">2</span>) + fib3(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(fib3(<span class="number">50</span>))</span><br><span class="line"><span class="comment"># =&gt; 12586269025</span></span><br></pre></td></tr></table></figure></p>
<h5 id="迭代式方案"><a href="#迭代式方案" class="headerlink" title="迭代式方案"></a>迭代式方案</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib4</span><span class="params">(n: int)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>: <span class="keyword">return</span> n</span><br><span class="line">    last: int = <span class="number">0</span></span><br><span class="line">    next: int = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">        last, next = next, last + next</span><br><span class="line">    <span class="keyword">return</span> next</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__== <span class="string">'__main__'</span>:</span><br><span class="line">    print(fib4(<span class="number">50</span>))</span><br><span class="line"><span class="comment"># =&gt; 12586269025</span></span><br></pre></td></tr></table></figure>
<p>上面的程序算是这几个方案中性能最好的一个，<code>for</code> 循环最多只执行 <code>n-1</code> 次。递归式方案借助逆向思维，而迭代式方案则是正向的逻辑。<br>在某些情况下，原始的递归计算方式会带来过多的性能消耗。但是任何可以通过递归计算解决的问题，同样可以用迭代的方式解决。</p>
<h5 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Generator</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib5</span><span class="params">(n: int)</span> -&gt; Generator[int, <span class="keyword">None</span>, <span class="keyword">None</span>]:</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">0</span>: <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    last: int = <span class="number">0</span></span><br><span class="line">    next: int = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">        last, next = next, last + next</span><br><span class="line">        <span class="keyword">yield</span> next</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> fib5(<span class="number">50</span>):</span><br><span class="line">        print(i, end=<span class="string">' '</span>)</span><br><span class="line"><span class="comment"># =&gt; 0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025</span></span><br></pre></td></tr></table></figure>
<h4 id="二、汉诺塔问题"><a href="#二、汉诺塔问题" class="headerlink" title="二、汉诺塔问题"></a>二、汉诺塔问题</h4><p>关于汉诺塔问题的简单描述：</p>
<ul>
<li>有三根柱子，柱子 A 上摞有 n 个不同大小的圆盘，需要将所有圆盘借助柱子 B 转移到柱子 C</li>
<li>每次只能转移一个圆盘</li>
<li>大的圆盘必须放置在小的圆盘下面</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/6875152-f5a72f3f63c7824b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Hanoi Tower"></p>
<p>递归解法的逻辑如下：</p>
<ul>
<li>利用 C 作中转，移动 A 顶部的 n-1 个圆盘到柱子 B</li>
<li>移动 A 底部剩下的最大号圆盘到柱子 C</li>
<li>利用 A 作中转，移动 B 上的 n-1 个圆盘到柱子 C（此时问题由最初的将 n 个圆盘从 A 转移到 C，变成将 n-1 个圆盘从 B 转移到 C）</li>
<li>重复以上步骤</li>
</ul>
<p>实现代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypeVar, Generic, List</span><br><span class="line">T = TypeVar(<span class="string">'T'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span><span class="params">(Generic[T])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container: List[T] = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, item: T)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; T:</span></span><br><span class="line">        <span class="keyword">return</span> self._container.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">return</span> repr(self._container)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hanobi</span><span class="params">(begin: Stack[int], end: Stack[int], temp: Stack[int], n: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        end.push(begin.pop())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        hanobi(begin, temp, end, n - <span class="number">1</span>)</span><br><span class="line">        hanobi(begin, end, temp, <span class="number">1</span>)</span><br><span class="line">        hanobi(temp, end, begin, n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    num_discs: int = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    tower_a: Stack[int] = Stack()</span><br><span class="line">    tower_b: Stack[int] = Stack()</span><br><span class="line">    tower_c: Stack[int] = Stack()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, num_discs + <span class="number">1</span>):</span><br><span class="line">        tower_a.push(i)</span><br><span class="line"></span><br><span class="line">    hanobi(tower_a, tower_c, tower_b, num_discs)</span><br><span class="line">    print(tower_a)  <span class="comment"># []</span></span><br><span class="line">    print(tower_b)  <span class="comment"># []</span></span><br><span class="line">    print(tower_c)  <span class="comment"># [1, 2, 3]</span></span><br></pre></td></tr></table></figure></p>
<p>这只是一个简单的演示程序，<code>Stack</code> 类抽象出单根柱子与圆盘的模型，<code>hanobi</code> 函数则以递归的方式定义了圆盘移动的过程。<br>如果是真人来操作的话，每次移动一个圆盘花费 1 秒钟时间。解决由 50 个圆盘组成的汉诺塔问题，共需要耗费多长时间？<br>约等于 <strong>3570.2 万年</strong>。</p>
<h4 id="三、DNA-检索"><a href="#三、DNA-检索" class="headerlink" title="三、DNA 检索"></a>三、DNA 检索</h4><p>在计算机软件中，基因（<em>Gene</em>）一般通过由 A、C、G、T 组成的字符序列表示。其中每个字符代表一个核苷酸（<em>nucleotide</em>），每相邻的三个核苷酸（碱基）组成一个密码子（<em>codon</em>）。</p>
<p>基因的数据模型如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> IntEnum</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Tuple, List</span><br><span class="line"></span><br><span class="line">Nucleotide: IntEnum = IntEnum(<span class="string">'Nucleotide'</span>, (<span class="string">'A'</span>, <span class="string">'C'</span>, <span class="string">'G'</span>, <span class="string">'T'</span>))</span><br><span class="line">Codon = Tuple[Nucleotide, Nucleotide, Nucleotide]</span><br><span class="line">Gene = List[Codon]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">string_to_gene</span><span class="params">(s: str)</span> -&gt; Gene:</span></span><br><span class="line">    gene: Gene = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">3</span>):</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">2</span>) &gt;= len(s):</span><br><span class="line">            <span class="keyword">return</span> gene</span><br><span class="line">        codon: Codon = (Nucleotide[s[i]], Nucleotide[s[i + <span class="number">1</span>]],</span><br><span class="line">                        Nucleotide[s[i + <span class="number">2</span>]])</span><br><span class="line">        gene.append(codon)</span><br><span class="line">    <span class="keyword">return</span> gene</span><br><span class="line"></span><br><span class="line">gene_str: str = <span class="string">"ACGTGGCTCTCTAACGTACGTACGTACGGGGTTTATATATACCCTAGGACTCCCTTT"</span></span><br><span class="line">my_gene: Gene = string_to_gene(gene_str)</span><br><span class="line"><span class="keyword">for</span> conda <span class="keyword">in</span> my_gene:</span><br><span class="line">    print(conda)</span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.C: 2&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;)</span></span><br><span class="line"><span class="comment"># =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;)</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Linear-search"><a href="#Linear-search" class="headerlink" title="Linear search"></a>Linear search</h5><p>线性搜索会按照原始数据结构中的元素排列顺序，逐个检查搜索空间中的每一个元素，是最简单直观的搜索方式，复杂度为 O(n)。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_contains</span><span class="params">(gene: Gene, key_codon: Codon)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">for</span> codon <span class="keyword">in</span> gene:</span><br><span class="line">        <span class="keyword">if</span> codon == key_codon:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">acg: Codon = (Nucleotide.A, Nucleotide.C, Nucleotide.G)</span><br><span class="line">gat: Codon = (Nucleotide.G, Nucleotide.A, Nucleotide.T)</span><br><span class="line">print(linear_contains(my_gene, acg))  <span class="comment"># True</span></span><br><span class="line">print(linear_contains(my_gene, gat))  <span class="comment"># False</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Binary-search"><a href="#Binary-search" class="headerlink" title="Binary search"></a>Binary search</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_contains</span><span class="params">(gene: Gene, key_codon: Codon)</span> -&gt; bool:</span></span><br><span class="line">    low: int = <span class="number">0</span></span><br><span class="line">    high: int = len(gene) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid: int = (low + high)</span><br><span class="line">        <span class="keyword">if</span> gene[mid] &lt; key_codon:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> gene[mid] &gt; key_codon:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">my_sorted_gene: Gene = sorted(my_gene)</span><br><span class="line">print(binary_contains(my_sorted_gene, acg))</span><br><span class="line">print(binary_contains(my_sorted_gene, gat))</span><br></pre></td></tr></table></figure>
<p>Binary Search 将搜索对象与<strong>有序列表</strong>中间位置的值进行比对，根据大小关系确定下一次搜索在序列的前半或者后半部分继续进行。依照此规则持续进行检索，每一次比较都会将下一次的搜索空间减小一半（类似猜数字游戏）。</p>
<p>Binary Search 在最坏情况下的复杂度为 <code>O(lg n)</code>，前提是序列中的所有元素已经根据大小排序。最好的排序算法复杂度为 <code>O(n lg n)</code>。<br>因此在需要对无序列表执行<strong>多次</strong>搜索的场景下，可以先对列表元素排序再执行 Binary Search。</p>
<h5 id="通用示例"><a href="#通用示例" class="headerlink" title="通用示例"></a>通用示例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generic_search.py</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypeVar, Iterable, Sequence, Generic, List, Callable, Set, Deque, Dict, Any, Optional</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Protocol</span><br><span class="line"><span class="keyword">from</span> heapq <span class="keyword">import</span> heappush, heappop</span><br><span class="line"></span><br><span class="line">T = TypeVar(<span class="string">'T'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_contains</span><span class="params">(iterable: Iterable[T], key: T)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> iterable:</span><br><span class="line">        <span class="keyword">if</span> item == key:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">C = TypeVar(<span class="string">"C"</span>, bound=<span class="string">"Comparable"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comparable</span><span class="params">(Protocol)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other: Any)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> self == other</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other: C)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> self &lt; other</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__gt__</span><span class="params">(self: C, other: C)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">not</span> self &lt; other) <span class="keyword">and</span> self != other</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__le__</span><span class="params">(self: C, other: C)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> self &lt; other <span class="keyword">or</span> self == other</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__ge__</span><span class="params">(self: C, other: C)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> self &lt; other</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_contains</span><span class="params">(sequence: Sequence[C], key: C)</span> -&gt; bool:</span></span><br><span class="line">    low: int = <span class="number">0</span></span><br><span class="line">    high: int = len(sequence) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid: int = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> sequence[mid] &lt; key:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> sequence[mid] &gt; key:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(linear_contains([<span class="number">1</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">20</span>], <span class="number">5</span>))</span><br><span class="line">    print(binary_contains([<span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"z"</span>], <span class="string">"f"</span>))</span><br><span class="line">    print(binary_contains([<span class="string">"join"</span>, <span class="string">"mark"</span>, <span class="string">"ronald"</span>, <span class="string">"sarah"</span>], <span class="string">"sheila"</span>))</span><br></pre></td></tr></table></figure>
<h4 id="四、迷宫问题"><a href="#四、迷宫问题" class="headerlink" title="四、迷宫问题"></a>四、迷宫问题</h4><p>迷宫建模：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># maze.py</span></span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List, NamedTuple, Callable, Optional</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cell</span><span class="params">(str, Enum)</span>:</span></span><br><span class="line">    EMPTY = <span class="string">" "</span></span><br><span class="line">    BLOCKED = <span class="string">"X"</span></span><br><span class="line">    START = <span class="string">"S"</span></span><br><span class="line">    GOAL = <span class="string">"G"</span></span><br><span class="line">    PATH = <span class="string">"*"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MazeLocation</span><span class="params">(NamedTuple)</span>:</span></span><br><span class="line">    row: int</span><br><span class="line">    column: int</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Maze</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, rows: int = <span class="number">10</span>, columns: int = <span class="number">10</span>, sparseness: float = <span class="number">0.2</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 start: MazeLocation = MazeLocation<span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 goal: MazeLocation = MazeLocation<span class="params">(<span class="number">9</span>, <span class="number">9</span>)</span>)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._rows: int = rows</span><br><span class="line">        self._columns: int = columns</span><br><span class="line">        self.start: MazeLocation = start</span><br><span class="line">        self.goal: MazeLocation = goal</span><br><span class="line">        self._grid: List[List[Cell]] = [[Cell.EMPTY <span class="keyword">for</span> c <span class="keyword">in</span> range(columns)]</span><br><span class="line">                                        <span class="keyword">for</span> r <span class="keyword">in</span> range(rows)]</span><br><span class="line">        self._randomly_fill(rows, columns, sparseness)</span><br><span class="line">        self._grid[start.row][start.column] = Cell.START</span><br><span class="line">        self._grid[goal.row][goal.column] = Cell.GOAL</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_randomly_fill</span><span class="params">(self, rows: int, columns: int, sparseness: float)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(rows):</span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(columns):</span><br><span class="line">                <span class="keyword">if</span> random.uniform(<span class="number">0</span>, <span class="number">1.0</span>) &lt; sparseness:</span><br><span class="line">                    self._grid[row][column] = Cell.BLOCKED</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span> -&gt; str:</span></span><br><span class="line">        output: str = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> self._grid:</span><br><span class="line">            output += <span class="string">""</span>.join([c.value <span class="keyword">for</span> c <span class="keyword">in</span> row]) + <span class="string">"\n"</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maze: Maze = Maze()</span><br><span class="line">print(maze)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SX X    X</span><br><span class="line">    XX</span><br><span class="line"></span><br><span class="line">   X X  X</span><br><span class="line"> X</span><br><span class="line">    X</span><br><span class="line">XX      X</span><br><span class="line">  X    X X</span><br><span class="line">    X</span><br><span class="line">XX  X  X G</span><br></pre></td></tr></table></figure>
<p>为 <code>Maze</code> 类创建如下两个方法，<code>goal_test</code> 用于确定当前 Cell 是否为目标地点；<code>successors</code> 用于判断与当前 Cell 相邻的哪些 Cell 可以作为下一步的落脚点，返回其列表：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># maze.py continued</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">goal_test</span><span class="params">(self, ml: MazeLocation)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> ml == self.goal</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">successors</span><span class="params">(self, ml: MazeLocation)</span> -&gt; List[MazeLocation]:</span></span><br><span class="line">        locations: List[MazeLocation] = []</span><br><span class="line">        <span class="keyword">if</span> ml.row + <span class="number">1</span> &lt; self._rows <span class="keyword">and</span> self._grid[ml.row + <span class="number">1</span>][ml.column] != Cell.BLOCKED:</span><br><span class="line">            locations.append(MazeLocation(ml.row + <span class="number">1</span>, ml.column))</span><br><span class="line">        <span class="keyword">if</span> ml.row - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> self._grid[ml.row - <span class="number">1</span>][ml.column] != Cell.BLOCKED:</span><br><span class="line">            locations.append(MazeLocation(ml.row - <span class="number">1</span>, ml.column))</span><br><span class="line">        <span class="keyword">if</span> ml.column + <span class="number">1</span> &lt; self._columns <span class="keyword">and</span> self._grid[ml.row][ml.column + <span class="number">1</span>] != Cell.BLOCKED:</span><br><span class="line">            locations.append(MazeLocation(ml.row, ml.column + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">if</span> ml.column - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> self._grid[ml.row][ml.column - <span class="number">1</span>] != Cell.BLOCKED:</span><br><span class="line">            locations.append(MazeLocation(ml.row, ml.column - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> locations</span><br></pre></td></tr></table></figure></p>
<h5 id="DFS（depth-first-search）算法"><a href="#DFS（depth-first-search）算法" class="headerlink" title="DFS（depth-first search）算法"></a>DFS（depth-first search）算法</h5><p>我理解的 DFS 算法，就是“一条道儿走到黑”。只要当前的路径能走通就一直走下去，不去考虑途中其他可能的方案。一旦遇到障碍走入“死胡同”，则回退到上一个节点尝试之前未选择的路径。<br>最终到达目标地点后停止，或者一路回退到起点，则证明不存在可行的方案。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generic_search.py continued</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span><span class="params">(Generic[T])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container: List[T] = []</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span><span class="params">(self)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> self._container  <span class="comment"># not is true for empty container</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, item: T)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; T:</span></span><br><span class="line">        <span class="keyword">return</span> self._container.pop()  <span class="comment"># LIFO</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">return</span> repr(self._container)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(Generic[T])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, state: T, parent: Optional[Node], cost: float = <span class="number">0.0</span>, heuristic: float = <span class="number">0.0</span>)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.state: T = state</span><br><span class="line">        self.parent: Optional[Node] = parent</span><br><span class="line">        self.cost: float = cost</span><br><span class="line">        self.heuristic: float = heuristic</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other: Node)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> (self.cost + self.heuristic) &lt; (other.cost + other.heuristic)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]])</span> -&gt; Optional[Node[T]]:</span></span><br><span class="line">    <span class="comment"># frontier is where we've yet to go</span></span><br><span class="line">    frontier: Stack[Node[T]] = Stack()</span><br><span class="line">    frontier.push(Node(initial, <span class="keyword">None</span>))</span><br><span class="line">    <span class="comment"># explored is where we've been</span></span><br><span class="line">    explored: Set[T] = &#123;initial&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># keep going while there is more to explore</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> frontier.empty:</span><br><span class="line">        current_node: Node[T] = frontier.pop()</span><br><span class="line">        current_state: T = current_node.state</span><br><span class="line">        <span class="comment"># if we found the goal, we're done</span></span><br><span class="line">        <span class="keyword">if</span> goal_test(current_state):</span><br><span class="line">            <span class="keyword">return</span> current_node</span><br><span class="line">        <span class="comment"># check where we can go next and haven't explored</span></span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> successors(current_state):</span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> explored:  <span class="comment"># skip children we already explored</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            explored.add(child)</span><br><span class="line">            frontier.push(Node(child, current_node))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">None</span>  <span class="comment"># went through everything and never found goal</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">node_to_path</span><span class="params">(node: Node[T])</span> -&gt; List[T]:</span></span><br><span class="line">    path: List[T] = [node.state]</span><br><span class="line">    <span class="comment"># work backwards from end to front</span></span><br><span class="line">    <span class="keyword">while</span> node.parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">        node = node.parent</span><br><span class="line">        path.append(node.state)</span><br><span class="line">    path.reverse()</span><br><span class="line">    <span class="keyword">return</span> path</span><br></pre></td></tr></table></figure>
<p>其中 <code>Node</code> 类可以算作 <code>MazeLocation</code> 上的又一层封装，为其添加 <code>parent-child</code> 关系方便后续连接为路径。其 <code>cost</code> 和 <code>heuristic</code> 属性会在后面的 A* 算法中用到。</p>
<p><code>dfs</code> 函数中的 <code>frontier</code> 使用 <code>Stack</code> 数据结构记录每一步选择中出现的可行路径节点，其 <code>pop</code> 方法用于回溯到上一个节点。若 <code>frontier</code> 为空则说明已回溯到起点，未找到合适路径。<br><code>explored</code> 使用 <code>Set</code> 数据结构记录所有已经尝试过的路径选择，避免回溯时重复之前的路径。</p>
<p><code>node_to_path</code> 函数则可以从终点开始反向查找，将 Node 节点（即带有 parent-child 关系的 MazeLocation）逐步扩展连接成完整路径存放在列表中。</p>
<p>补充 <code>maze.py</code> 代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># maze.py continued</span></span><br><span class="line"><span class="keyword">from</span> generic_search <span class="keyword">import</span> dfs, node_to_path, Node</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mark</span><span class="params">(self, path: List[MazeLocation])</span>:</span></span><br><span class="line">        <span class="keyword">for</span> maze_location <span class="keyword">in</span> path:</span><br><span class="line">            self._grid[maze_location.row][maze_location.column] = Cell.PATH</span><br><span class="line">        self._grid[self.start.row][self.start.column] = Cell.START</span><br><span class="line">        self._grid[self.goal.row][self.goal.column] = Cell.GOAL</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clear</span><span class="params">(self, path: List[MazeLocation])</span>:</span></span><br><span class="line">        <span class="keyword">for</span> maze_location <span class="keyword">in</span> path:</span><br><span class="line">            self._grid[maze_location.row][maze_location.column] = Cell.EMPTY</span><br><span class="line">        self._grid[self.start.row][self.start.column] = Cell.START</span><br><span class="line">        self._grid[self.goal.row][self.goal.column] = Cell.GOAL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    m: Maze = Maze()</span><br><span class="line">    print(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># test DFS</span></span><br><span class="line">    solution1: Optional[Node[MazeLocation]] = dfs(m.start, m.goal_test,</span><br><span class="line">                                                  m.successors)</span><br><span class="line">    <span class="keyword">if</span> solution1 <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        print(<span class="string">"No solution found using depth-first search"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        path1: List[MazeLocation] = node_to_path(solution1)</span><br><span class="line">        m.mark(path1)</span><br><span class="line">        print(m)</span><br><span class="line">        m.clear(path1)</span><br></pre></td></tr></table></figure></p>
<p>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">SX   XX X</span><br><span class="line">  X</span><br><span class="line">  X</span><br><span class="line">X X</span><br><span class="line">      X  X</span><br><span class="line">        X</span><br><span class="line">    XX  X</span><br><span class="line"></span><br><span class="line">X   X</span><br><span class="line">   XX    G</span><br><span class="line"></span><br><span class="line">SX   XX X</span><br><span class="line">**X</span><br><span class="line"> *X</span><br><span class="line">X*X</span><br><span class="line">**    X  X</span><br><span class="line">*  *****X</span><br><span class="line">****XX *X</span><br><span class="line">     ***</span><br><span class="line">X   X*</span><br><span class="line">   XX****G</span><br></pre></td></tr></table></figure></p>
<h5 id="BFS（breadth-first-search）算法寻找最短路径"><a href="#BFS（breadth-first-search）算法寻找最短路径" class="headerlink" title="BFS（breadth-first search）算法寻找最短路径"></a>BFS（breadth-first search）算法寻找最短路径</h5><p>BFS 算法更倾向于一步一个脚印，每一步都要尝试过所有可能的方案，层层递进直到其中任何一种方案走通。<br>假如共有 100 种路径都可以到达迷宫终点，各条路径或长或短。BFS 每次都会在所有 100 种路径上各走一步，直到其中某一条路径刚好到达终点后停止。<br>由于对所有可行路径的尝试是同步进行的，因此该算法找到的路径总是最短的。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generic_search.py continued</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span><span class="params">(Generic[T])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container: Deque[T] = Deque()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span><span class="params">(self)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> self._container  <span class="comment"># not is true for empty container</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, item: T)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; T:</span></span><br><span class="line">        <span class="keyword">return</span> self._container.popleft()  <span class="comment"># FIFO</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">return</span> repr(self._container)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]])</span> -&gt; Optional[Node[T]]:</span></span><br><span class="line">    <span class="comment"># frontier is where we've yet to go</span></span><br><span class="line">    frontier: Queue[Node[T]] = Queue()</span><br><span class="line">    frontier.push(Node(initial, <span class="keyword">None</span>))</span><br><span class="line">    <span class="comment"># explored is where we've been</span></span><br><span class="line">    explored: Set[T] = &#123;initial&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># keep going while there is more to explore</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> frontier.empty:</span><br><span class="line">        current_node: Node[T] = frontier.pop()</span><br><span class="line">        current_state: T = current_node.state</span><br><span class="line">        <span class="comment"># if we found the goal, we're done</span></span><br><span class="line">        <span class="keyword">if</span> goal_test(current_state):</span><br><span class="line">            <span class="keyword">return</span> current_node</span><br><span class="line">        <span class="comment"># check where we can go next and haven't explored</span></span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> successors(current_state):</span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">in</span> explored:  <span class="comment"># skip children we already explored</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            explored.add(child)</span><br><span class="line">            frontier.push(Node(child, current_node))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">None</span>  <span class="comment"># went through everything and never found goal</span></span><br></pre></td></tr></table></figure></p>
<p>其中 <code>Queue</code> 数据结构底层使用 <code>Deque</code> 而不是 <code>List</code>，目的是提升 <code>popleft</code> 方法的效率。<br>相对于 DFS 中的 Stack 数据结构，Queue 的 <code>pop</code> 方法是从序列的最左侧（Stack 是从最右侧）弹出项目。<br>由此使得 BFS 可以从起点开始最大程度地尝试所有可行方案，即<strong>广度优先</strong>原则。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># maze.py continued</span></span><br><span class="line"><span class="comment"># test BFS</span></span><br><span class="line">    solution2: Optional[Node[MazeLocation]] = bfs(m.start, m.goal_test, m.successors)</span><br><span class="line">    <span class="keyword">if</span> solution2 <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        print(<span class="string">"No solution found using breadth-first search!"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        path2: List[MazeLocation] = node_to_path(solution2)</span><br><span class="line">        m.mark(path2)</span><br><span class="line">        print(m)</span><br><span class="line">        m.clear(path2)</span><br></pre></td></tr></table></figure>
<p>执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">S*******</span><br><span class="line"> X X X *XX</span><br><span class="line">********</span><br><span class="line">* X  X</span><br><span class="line">**********</span><br><span class="line">       X *</span><br><span class="line">XX *******</span><br><span class="line">   * X  X</span><br><span class="line">XXX*X ****</span><br><span class="line">  X****XXG</span><br><span class="line"></span><br><span class="line">S</span><br><span class="line">*X X X  XX</span><br><span class="line">*</span><br><span class="line">* X  X</span><br><span class="line">*</span><br><span class="line">***    X</span><br><span class="line">XX*****</span><br><span class="line">     X* X</span><br><span class="line">XXX X ****</span><br><span class="line">  X    XXG</span><br></pre></td></tr></table></figure></p>
<h5 id="A-算法寻找最优解"><a href="#A-算法寻找最优解" class="headerlink" title="A* 算法寻找最优解"></a>A* 算法寻找最优解</h5><p>粗略地说，DFS 可以较快地找到合适路径，BFS 则可以寻求最短路径（但时间花费较高）。</p>
<p>A* 算法则引入了 <a href="http://theory.stanford.edu/~amitp/GameProgramming/Heuristics.html" target="_blank" rel="noopener">heuristic</a> 概念，大概就是在做出决策前先根据一定的指导原则确定路径选择的优先级。即优先选择可能最短（离终点最近）的路径作为下一步的节点，而不是随机尝试所有可行的节点，以此来降低 BFS 导致的时间损耗。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generic_search.py continued</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span><span class="params">(Generic[T])</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._container: List[T] = []</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span><span class="params">(self)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> self._container  <span class="comment"># not is true for empty container</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, item: T)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        heappush(self._container, item)  <span class="comment"># in by priority</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; T:</span></span><br><span class="line">        <span class="keyword">return</span> heappop(self._container)  <span class="comment"># out by priority</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">return</span> repr(self._container)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">astar</span><span class="params">(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]], heuristic: Callable[[T], float])</span> -&gt; Optional[Node[T]]:</span></span><br><span class="line">    <span class="comment"># frontier is where we've yet to go</span></span><br><span class="line">    frontier: PriorityQueue[Node[T]] = PriorityQueue()</span><br><span class="line">    frontier.push(Node(initial, <span class="keyword">None</span>, <span class="number">0.0</span>, heuristic(initial)))</span><br><span class="line">    <span class="comment"># explored is where we've been</span></span><br><span class="line">    explored: Dict[T, float] = &#123;initial: <span class="number">0.0</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># keep going while there is more to explore</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> frontier.empty:</span><br><span class="line">        current_node: Node[T] = frontier.pop()</span><br><span class="line">        current_state: T = current_node.state</span><br><span class="line">        <span class="comment"># if we found the goal, we're done</span></span><br><span class="line">        <span class="keyword">if</span> goal_test(current_state):</span><br><span class="line">            <span class="keyword">return</span> current_node</span><br><span class="line">        <span class="comment"># check where we can go next and haven't explored</span></span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> successors(current_state):</span><br><span class="line">            new_cost: float = current_node.cost + <span class="number">1</span>  <span class="comment"># 1 assumes a grid, need a cost function for more sophisticated apps</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> child <span class="keyword">not</span> <span class="keyword">in</span> explored <span class="keyword">or</span> explored[child] &gt; new_cost:</span><br><span class="line">                explored[child] = new_cost</span><br><span class="line">                frontier.push(Node(child, current_node, new_cost, heuristic(child)))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">None</span>  <span class="comment"># went through everything and never found goal</span></span><br></pre></td></tr></table></figure></p>
<p>其中 <code>PriorityQueue</code> 数据结构使用 <code>heappop</code> 方法确保每次从队列中取出的数据项都是（对算法而言）<strong>优先级最高</strong>的。</p>
<p>下面 <code>maze.py</code> 中添加的 <code>manhattan_distance</code> 函数则以意向节点与目标节点的路线距离作为下一步路径选择的依据。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># maze.py continued</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manhattan_distance</span><span class="params">(goal: MazeLocation)</span> -&gt; Callable[[MazeLocation], float]:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(ml: MazeLocation)</span> -&gt; float:</span></span><br><span class="line">        xdist: int = abs(ml.column - goal.column)</span><br><span class="line">        ydist: int = abs(ml.row - goal.row)</span><br><span class="line">        <span class="keyword">return</span> (xdist + ydist)</span><br><span class="line">    <span class="keyword">return</span> distance</span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Test A*</span></span><br><span class="line">    distance: Callable[[MazeLocation], float] = manhattan_distance(m.goal)</span><br><span class="line">    solution3: Optional[Node[MazeLocation]] = astar(m.start, m.goal_test, m.successors, distance)</span><br><span class="line">    <span class="keyword">if</span> solution3 <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        print(<span class="string">"No solution found using A*!"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        path3: List[MazeLocation] = node_to_path(solution3)</span><br><span class="line">        m.mark(path3)</span><br><span class="line">        print(m)</span><br></pre></td></tr></table></figure></p>
<p>执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">S******X</span><br><span class="line"> X    ****</span><br><span class="line">*****    *</span><br><span class="line">*X X******</span><br><span class="line">****   X</span><br><span class="line"> XX*X</span><br><span class="line"> X** XX***</span><br><span class="line">X * ****X*</span><br><span class="line">XX***XX  *</span><br><span class="line">  X      G</span><br><span class="line"></span><br><span class="line">S      X</span><br><span class="line">*X</span><br><span class="line">*</span><br><span class="line">*X X</span><br><span class="line">****   X</span><br><span class="line"> XX*X</span><br><span class="line"> X * XX</span><br><span class="line">X  *    X</span><br><span class="line">XX * XX</span><br><span class="line">  X******G</span><br><span class="line"></span><br><span class="line">S      X</span><br><span class="line">*X</span><br><span class="line">*</span><br><span class="line">*X X</span><br><span class="line">*******X</span><br><span class="line"> XX X **</span><br><span class="line"> X   XX***</span><br><span class="line">X       X*</span><br><span class="line">XX   XX  *</span><br><span class="line">  X      G</span><br></pre></td></tr></table></figure></p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://www.manning.com/books/classic-computer-science-problems-in-python" target="_blank" rel="noopener">Classic Computer Science Problems in Python</a><br><a href="https://github.com/davecom/ClassicComputerScienceProblemsInPython" target="_blank" rel="noopener">davecom/ClassicComputerScienceProblemsInPython</a></p>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
            <a href="/tags/DataStructure/" rel="tag"># DataStructure</a>
          
            <a href="/tags/Algorithm/" rel="tag"># Algorithm</a>
          
            <a href="/tags/Advanced/" rel="tag"># Advanced</a>
          
            <a href="/tags/Program/" rel="tag"># Program</a>
          
            <a href="/tags/Search/" rel="tag"># Search</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/01/02/python-cookbook-class-and-object/" rel="next" title="Python Cookbook —— 类与对象">
                <i class="fa fa-chevron-left"></i> Python Cookbook —— 类与对象
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/06/python-design-patterns-mvc-pattern/" rel="prev" title="Python 设计模式——MVC模式">
                Python 设计模式——MVC模式 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="星舞" />
            
              <p class="site-author-name" itemprop="name">星舞</p>
              <p class="site-description motion-element" itemprop="description">Personal blogs about Linux / System Administration / Arduino / Programming / Python and etc. Just something I want to do and share.</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">178</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">260</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/rollingstarky" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:rollingstars380@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://plus.google.com/rollingstarky" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i>Google</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/rollingstarky" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.facebook.com/rollingstarky" target="_blank" title="FB Page"><i class="fa fa-fw fa-facebook"></i>FB Page</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://instagram.com/rollingstarky" target="_blank" title="Instagram"><i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#一、斐波那契数列"><span class="nav-number">1.</span> <span class="nav-text">一、斐波那契数列</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#递归函数"><span class="nav-number">1.1.</span> <span class="nav-text">递归函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Memoization"><span class="nav-number">1.2.</span> <span class="nav-text">Memoization</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lru-cache"><span class="nav-number">1.3.</span> <span class="nav-text">lru_cache</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#迭代式方案"><span class="nav-number">1.4.</span> <span class="nav-text">迭代式方案</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#生成器"><span class="nav-number">1.5.</span> <span class="nav-text">生成器</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二、汉诺塔问题"><span class="nav-number">2.</span> <span class="nav-text">二、汉诺塔问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三、DNA-检索"><span class="nav-number">3.</span> <span class="nav-text">三、DNA 检索</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Linear-search"><span class="nav-number">3.1.</span> <span class="nav-text">Linear search</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Binary-search"><span class="nav-number">3.2.</span> <span class="nav-text">Binary search</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#通用示例"><span class="nav-number">3.3.</span> <span class="nav-text">通用示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#四、迷宫问题"><span class="nav-number">4.</span> <span class="nav-text">四、迷宫问题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#DFS（depth-first-search）算法"><span class="nav-number">4.1.</span> <span class="nav-text">DFS（depth-first search）算法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#BFS（breadth-first-search）算法寻找最短路径"><span class="nav-number">4.2.</span> <span class="nav-text">BFS（breadth-first search）算法寻找最短路径</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A-算法寻找最优解"><span class="nav-number">4.3.</span> <span class="nav-text">A* 算法寻找最优解</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参考资料"><span class="nav-number">5.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">星舞</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">1.2m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点总阅读时长">19:59</span>
  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.0.5</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.5"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.5"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.5"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.5"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.5"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'tuf79KlfkPXu7L0sNNhh3LyS-gzGzoHsz',
        appKey: 'Oskj6RUWskJf5Ahzp75nOcgc',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("tuf79KlfkPXu7L0sNNhh3LyS-gzGzoHsz", "Oskj6RUWskJf5Ahzp75nOcgc");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var newcounter = new Counter();
              /* Set ACL */
              var acl = new AV.ACL();
              acl.setPublicReadAccess(true);
              acl.setPublicWriteAccess(true);
              newcounter.setACL(acl);
              /* End Set ACL */
              newcounter.set("title", title);
              newcounter.set("url", url);
              newcounter.set("time", 1);
              newcounter.save(null, {
                success: function(newcounter) {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                },
                error: function(newcounter, error) {
                  console.log('Failed to create');
                }
              });
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

</body>
</html>
