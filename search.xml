<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[The Rust programming language è¯»ä¹¦ç¬”è®°â€”â€”æ‰€æœ‰æƒä¸Ž Move æœºåˆ¶]]></title>
    <url>%2F2021%2F06%2F07%2Fthe-rust-programming-language-reading-notes-ownership-and-move%2F</url>
    <content type="text"><![CDATA[æ‰€æœ‰æƒæ¦‚å¿µæ˜¯ Rust è¯­è¨€çš„æ ¸å¿ƒåŠŸèƒ½ Rust æ²¡æœ‰åžƒåœ¾å›žæ”¶ï¼ˆGCï¼‰æœºåˆ¶ Rust é€šè¿‡æ‰€æœ‰æƒå’Œç›¸å…³å·¥å…·ä¿éšœå†…å­˜å®‰å…¨ æ‰€æœ‰è¯­è¨€éƒ½éœ€è¦ç®¡ç†è‡ªå·±åœ¨è¿è¡Œæ—¶ä½¿ç”¨çš„è®¡ç®—æœºå†…å­˜ç©ºé—´ã€‚ä½¿ç”¨åžƒåœ¾å›žæ”¶æœºåˆ¶çš„è¯­è¨€ï¼ˆJavaã€Pythonï¼‰ä¼šåœ¨è¿è¡Œæ—¶å®šæœŸæ£€æŸ¥å¹¶å›žæ”¶æ²¡æœ‰è¢«ç»§ç»­ä½¿ç”¨çš„å†…å­˜ï¼›å¦å¤–ä¸€äº›è¯­è¨€ï¼ˆCã€C++ï¼‰åˆ™éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨åœ°åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚ Rust é‡‡ç”¨ç¬¬ä¸‰ç§æ–¹å¼ï¼šå®ƒä½¿ç”¨åŒ…å«ç‰¹å®šè§„åˆ™çš„æ‰€æœ‰æƒç³»ç»Ÿæ¥ç®¡ç†å†…å­˜ã€‚è¿™å¥—è§„åˆ™å…è®¸ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ‰§è¡Œæ£€æŸ¥å·¥ä½œï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•çš„è¿è¡Œæ—¶å¼€é”€ã€‚ æ ˆä¸Žå †æ ˆå’Œå †éƒ½æ˜¯ä»£ç åœ¨è¿è¡Œæ—¶å¯ä»¥ä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚æ‰€æœ‰å­˜å‚¨åœ¨æ ˆä¸­çš„æ•°æ®å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªå·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ã€‚åœ¨ç¼–è¯‘æœŸæ— æ³•ç¡®å®šå¤§å°çš„æ•°æ®åªèƒ½å­˜æ”¾åœ¨å †ä¸­ã€‚ å †ç©ºé—´çš„ç®¡ç†è¾ƒä¸ºæ¾æ•£ã€‚å½“å¸Œæœ›å°†æ•°æ®æ”¾å…¥å †ä¸­æ—¶ï¼Œå¯ä»¥è¯·æ±‚ç‰¹å®šå¤§å°çš„ç©ºé—´ï¼Œæ“ä½œç³»ç»Ÿä¼šæ ¹æ®è¯·æ±‚åœ¨å †ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„å¯ç”¨ç©ºé—´ï¼Œå¹¶æŠŠæŒ‡å‘è¿™å—ç©ºé—´åœ°å€çš„æŒ‡é’ˆè¿”å›žç»™æˆ‘ä»¬ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåˆ†é…ã€‚ ç”±äºŽæŒ‡é’ˆï¼ˆå†…å­˜åœ°å€ï¼‰çš„å¤§å°æ˜¯å›ºå®šçš„ä¸”å¯ä»¥åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œå› æ­¤å¯ä»¥å°†æŒ‡é’ˆå­˜æ”¾åœ¨æ ˆä¸­ã€‚é€šè¿‡æŒ‡é’ˆæŒ‡å‘çš„åœ°å€è®¿é—®æŒ‡é’ˆæ‰€æŒ‡å‘çš„å…·ä½“æ•°æ®ã€‚ ç”±äºŽå¤šäº†æŒ‡é’ˆè·³è½¬çš„çŽ¯èŠ‚ï¼Œè®¿é—®å †ä¸Šçš„æ•°æ®è¦æ…¢äºŽè®¿é—®æ ˆä¸Šçš„æ•°æ®ã€‚è®¸å¤šç³»ç»Ÿç¼–ç¨‹è¯­è¨€éƒ½éœ€è¦ç¨‹åºå‘˜åŽ»è®°å½•ä»£ç ä¸­åˆ†é…çš„å †ç©ºé—´ï¼Œæœ€å°åŒ–å †ä¸Šçš„å†—ä½™ï¼Œå¹¶åŠæ—¶æ¸…ç†æ— ç”¨æ•°æ®ä»¥é¿å…è€—å°½å†…å­˜ç©ºé—´ã€‚æ‰€æœ‰æƒçš„æ¦‚å¿µå°±æ˜¯ä¸ºäº†å°†ä¸Šè¿°é—®é¢˜äº¤ç»™ Rust å¤„ç†ï¼Œå‡è½»ç¨‹åºå‘˜çš„è¿™éƒ¨åˆ†å¿ƒæ™ºè´Ÿæ‹…ã€‚ æ‰€æœ‰æƒè§„åˆ™ Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å˜é‡ä½œä¸ºå®ƒçš„æ‹¥æœ‰è€… åœ¨åŒä¸€æ—¶é—´å†…ï¼Œå€¼æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‹¥æœ‰è€… å½“æ‰€æœ‰è€…ç¦»å¼€è‡ªå·±çš„ä½œç”¨åŸŸæ—¶ï¼Œå®ƒæ‹¥æœ‰çš„å€¼å°±ä¼šè¢«é‡Šæ”¾æŽ‰ å˜é‡ä½œç”¨åŸŸä½œç”¨åŸŸæ˜¯ä¸€ä¸ªå¯¹è±¡åœ¨ç¨‹åºä¸­æœ‰æ•ˆçš„èŒƒå›´ã€‚ å¦‚ï¼š1234&#123; // å˜é‡ s è¿˜æœªå£°æ˜Žï¼Œå› æ­¤åœ¨è¿™é‡Œä¸å¯ç”¨ let s = "hello"; // ä»Žè¿™é‡Œå¼€å§‹å˜é‡ s å˜å¾—å¯ç”¨ // æ‰§è¡Œä¸Ž s ç›¸å…³çš„æ“ä½œ&#125; // ä½œç”¨åŸŸåˆ°è¿™é‡Œç»“æŸï¼Œå˜é‡ s ä¸å†å¯ç”¨ å˜é‡åœ¨è¿›å…¥ä½œç”¨åŸŸåŽå˜å¾—æœ‰æ•ˆ å˜é‡ä¼šä¿æŒè‡ªå·±çš„æœ‰æ•ˆæ€§ç›´åˆ°ç¦»å¼€è‡ªå·±çš„ä½œç”¨åŸŸ å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆå¦‚ let s = &quot;hello&quot;ï¼‰å±žäºŽè¢«ç¡¬ç¼–ç è¿›ç¨‹åºçš„å­—ç¬¦ä¸²å€¼ã€‚å¾ˆæ–¹ä¾¿ï¼Œä½†å¹¶ä¸é€‚ç”¨äºŽæ‰€æœ‰åœºæ™¯ã€‚ä¸€æ˜¯å› ä¸ºå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸å¯å˜çš„ï¼ŒäºŒæ˜¯å› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰å­—ç¬¦ä¸²çš„å€¼éƒ½èƒ½åœ¨ç¼–å†™ä»£ç æ—¶ç¡®å®šã€‚æ¯”å¦‚éœ€è¦èŽ·å–ç”¨æˆ·çš„è¾“å…¥å¹¶ä¿å­˜ã€‚ Rust æä¾›äº†ç¬¬äºŒç§å­—ç¬¦ä¸²ç±»åž‹ Stringã€‚String ä¼šåœ¨å †ä¸Šåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œå› æ­¤èƒ½å¤Ÿå¤„ç†æœªçŸ¥å¤§å°çš„æ–‡æœ¬ã€‚12345let mut s = String::from("hello");s.push_str(", world!"); // push_str() å‡½æ•°å‘ String ç©ºé—´çš„å°¾éƒ¨æ·»åŠ äº†ä¸€æ®µå­—ç¬¦ä¸²å­—é¢é‡println!("&#123;&#125;", s); // è¿™é‡Œä¼šè¾“å‡ºå®Œæ•´çš„ hello, world! å¯¹äºŽå­—ç¬¦ä¸²å­—é¢é‡è€Œè¨€ï¼Œç”±äºŽåœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å…¶å†…å®¹ï¼Œè¿™éƒ¨åˆ†ç¡¬ç¼–ç çš„æ–‡æœ¬è¢«ç›´æŽ¥åµŒå…¥åˆ°äº†å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è¿™ä¹Ÿæ˜¯è®¿é—®å­—ç¬¦ä¸²å­—é¢é‡å¼‚å¸¸é«˜æ•ˆçš„åŽŸå› ã€‚å¯¹äºŽ String ç±»åž‹è€Œè¨€ï¼Œä¸ºäº†æ”¯æŒä¸€ç§å¯å˜çš„ã€å¯å¢žé•¿çš„ç±»åž‹ï¼Œéœ€è¦åœ¨å †ä¸Šåˆ†é…ä¸€å—åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„å†…å­˜æ¥å­˜æ”¾æ•°æ®ã€‚å½“ä½¿ç”¨å®Œ String æ—¶ï¼Œåˆ™éœ€è¦é€šè¿‡æŸç§æ–¹å¼æ¥å°†è¿™äº›å†…å­˜å½’è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚ å¯¹äºŽæ‹¥æœ‰ GC æœºåˆ¶çš„è¯­è¨€ï¼ŒGC ä¼šæ›¿ä»£ç¨‹åºå‘˜è®°å½•å¹¶æ¸…ç†é‚£äº›ä¸å†ä½¿ç”¨çš„å†…å­˜ã€‚è€Œå¯¹äºŽæ²¡æœ‰ GC çš„è¯­è¨€ï¼Œè¯†åˆ«ä¸å†ä½¿ç”¨çš„å†…å­˜å¹¶è°ƒç”¨ä»£ç æ˜¾å¼é‡Šæ”¾çš„å·¥ä½œå°±éœ€è¦ç¨‹åºå‘˜æ¥å®Œæˆã€‚å‡å¦‚å¿˜è®°é‡Šæ”¾å†…å­˜ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼›å‡å¦‚è¿‡æ—©åœ°é‡Šæ”¾å†…å­˜ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªéžæ³•å˜é‡ï¼›å‡å¦‚é‡å¤é‡Šæ”¾åŒä¸€å—å†…å­˜ï¼Œå°±ä¼šäº§ç”Ÿæ— æ³•é¢„çŸ¥çš„åŽæžœã€‚ Rust æä¾›äº†å¦å¤–ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼šå†…å­˜ä¼šåœ¨æ‹¥æœ‰å®ƒçš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸåŽè‡ªåŠ¨åœ°è¿›è¡Œé‡Šæ”¾ã€‚1234&#123; // å˜é‡ s è¿˜æœªå£°æ˜Žï¼Œå› æ­¤åœ¨è¿™é‡Œä¸å¯ç”¨ let s = String::from("hello"); // ä»Žè¿™é‡Œå¼€å§‹å˜é‡ s å˜å¾—å¯ç”¨ // æ‰§è¡Œä¸Ž s ç›¸å…³çš„æ“ä½œ&#125; // ä½œç”¨åŸŸåˆ°è¿™é‡Œç»“æŸï¼Œå˜é‡ s å¤±æ•ˆ Rust ä¼šåœ¨ä½œç”¨åŸŸç»“æŸçš„åœ°æ–¹ï¼ˆå³ } å¤„ï¼‰è‡ªåŠ¨å›žæ”¶åˆ†é…ç»™å˜é‡ s çš„å†…å­˜ã€‚ å†…å­˜ä¸Žåˆ†é…å¯¹äºŽæ•´æ•°ç±»åž‹çš„æ•°æ®ï¼š12let x = 5;let y = x; ä¸Šè¿°ä»£ç å°†æ•´æ•°å€¼ 5 ç»‘å®šç»™å˜é‡ xï¼Œå†åˆ›å»ºä¸€ä¸ª x å€¼çš„æ‹·è´ï¼Œç»‘å®šç»™å˜é‡ yã€‚ç”±äºŽæ•´æ•°æ˜¯å·²çŸ¥å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œä¸¤ä¸ªå€¼ 5 ä¼šåŒæ—¶è¢«æŽ¨å…¥æ ˆä¸­ã€‚ å¯¹äºŽ String ç±»åž‹çš„æ•°æ®ï¼š12let s1 = String::from("hello");let s2 = s1; ç±»ä¼¼çš„ä»£ç ï¼Œè¿è¡Œæ–¹å¼å´å¹¶ä¸ä¸€è‡´ã€‚ String çš„å†…å­˜å¸ƒå±€å¦‚ä¸‹å›¾ï¼š å¯¹äºŽç»‘å®šç»™å˜é‡ s1 çš„ String æ¥è¯´ï¼Œè¯¥å­—ç¬¦ä¸²çš„æ–‡æœ¬å†…å®¹ï¼ˆhelloï¼‰ä¿å­˜åœ¨äº†å †ä¸Šï¼ŒåŒæ—¶åœ¨æ ˆä¸­ä¿å­˜ç€ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²å†…å®¹çš„æŒ‡é’ˆã€ä¸€ä¸ªé•¿åº¦å’Œä¸€ä¸ªå®¹é‡ä¿¡æ¯ã€‚ å½“å°† s1 èµ‹å€¼ç»™ s2 æ—¶ï¼Œä¾¿å¤åˆ¶äº†ä¸€æ¬¡ String çš„æ•°æ®ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¤åˆ¶äº†å®ƒå­˜å‚¨åœ¨æ ˆä¸Šçš„æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡å­—æ®µï¼Œè€ŒæŒ‡é’ˆæŒ‡å‘çš„å †ä¸Šçš„æ•°æ®å¹¶æ²¡æœ‰è¢«å¤åˆ¶ã€‚ å˜é‡ s1 å’Œ s2 çš„å†…å­˜å¸ƒå±€å¦‚ä¸‹å›¾ï¼š å‰é¢æåˆ°è¿‡ï¼Œå½“ä¸€ä¸ªå˜é‡ç¦»å¼€å½“å‰çš„ä½œç”¨åŸŸæ—¶ï¼ŒRust ä¼šè‡ªåŠ¨å°†å˜é‡ä½¿ç”¨çš„å †å†…å­˜é‡Šæ”¾å’Œå›žæ”¶ã€‚ä½†è‹¥æ˜¯æœ‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘äº†åŒä¸€ä¸ªåœ°å€ï¼Œå°±ä¼šå¯¼è‡´å¦‚ s2 å’Œ s1 ç¦»å¼€è‡ªå·±çš„ä½œç”¨åŸŸæ—¶ï¼ŒRust ä¼šå°è¯•é‡å¤é‡Šæ”¾ç›¸åŒçš„å†…å­˜ï¼Œè¿›è€Œæœ‰å¯èƒ½å¯¼è‡´æ­£åœ¨ä½¿ç”¨çš„æ•°æ®å‘ç”ŸæŸåã€‚ä¸ºäº†ç¡®ä¿å†…å­˜å®‰å…¨ï¼ŒåŒæ—¶ä¹Ÿé¿å…å¤åˆ¶åˆ†é…çš„å†…å­˜ï¼ŒRust åœ¨ä¸Šè¿°åœºæ™¯ä¸‹ä¼šç®€å•çš„å°† s1 åºŸå¼ƒã€‚å› æ­¤ä¹Ÿå°±ä¸éœ€è¦åœ¨ s1 ç¦»å¼€ä½œç”¨åŸŸåŽæ¸…ç†ä»»ä½•ä¸œè¥¿ã€‚è¿™ä¸€è¡Œä¸ºå³ä¸º Moveã€‚ è¯•å›¾åœ¨ s2 åˆ›å»ºå®Œæ¯•åŽè®¿é—® s1ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚12345fn main() &#123; let s1 = String::from("hello"); let s2 = s1; // å˜é‡ s1 åœ¨è¿™é‡Œè¢«åºŸå¼ƒ print!("&#123;&#125;, world", s1); // é”™è¯¯&#125; Rust ä¼šæŠ¥å‡º borrow of moved value: s1 é”™è¯¯ã€‚ Rust æ°¸è¿œä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®çš„æ·±åº¦æ‹·è´ã€‚ å¯¹äºŽæ ˆä¸Šæ•°æ®çš„å¤åˆ¶ï¼Œæ¯”å¦‚ï¼š1234let x = 5;let y = x;println!("x = &#123;&#125;, y = &#123;&#125;", x, y); ä¸Šé¢çš„ä»£ç æ˜¯å®Œå…¨åˆæ³•çš„ã€‚å› ä¸ºæ•´åž‹çš„æ•°æ®å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç¡®å®šè‡ªå·±çš„å¤§å°ï¼Œèƒ½å¤Ÿå°†æ•°æ®å®Œæ•´åœ°å­˜å‚¨åœ¨æ ˆä¸­ã€‚å¯¹äºŽè¿™äº›ç±»åž‹è€Œè¨€ï¼Œæ·±åº¦æ‹·è´ä¸Žæµ…åº¦æ‹·è´æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚ æ‰€æœ‰æƒä¸Žå‡½æ•°å°†å€¼ä¼ é€’ç»™å‡½æ•°åœ¨è¯­ä¹‰ä¸Šç±»ä¼¼äºŽå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ã€‚å°†å˜é‡ä¼ é€’ç»™å‡½æ•°å°†ä¼šè§¦å‘ç§»åŠ¨æˆ–å¤åˆ¶ã€‚ 123456789101112131415161718fn main() &#123; let s = String::from("hello"); //å˜é‡ s è¿›å…¥ä½œç”¨åŸŸ takes_ownership(s); // s çš„å€¼è¢«ç§»åŠ¨è¿›äº†å‡½æ•° // å˜é‡ s ä»Žè¿™é‡Œå¼€å§‹ä¸å†æœ‰æ•ˆ let x = 5; // å˜é‡ x è¿›å…¥ä½œç”¨åŸŸ makes_copy(x); // å˜é‡ x è¢«ä¼ é€’è¿›äº†å‡½æ•° // ä½† i32 ç±»åž‹ä¸å— Move æœºåˆ¶å½±å“ï¼Œå› æ­¤è¿™é‡Œ x ä¾æ—§å¯ç”¨&#125;fn takes_ownership(some_string: String) &#123; // some_string è¿›å…¥ä½œç”¨åŸŸ print!("&#123;&#125;", some_string);&#125; // some_string ç¦»å¼€ä½œç”¨åŸŸï¼Œå ç”¨çš„å†…å­˜è¢«é‡Šæ”¾fn makes_copy(some_integer: i32) &#123; print!("&#123;&#125;", some_integer);&#125; // some_integer ç¦»å¼€ä½œç”¨åŸŸï¼Œæ²¡æœ‰ç‰¹åˆ«çš„äº‹æƒ…å‘ç”Ÿ åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå°è¯•åœ¨è°ƒç”¨ takes_ownership åŽä½¿ç”¨å˜é‡ s ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ å‡½æ•°åœ¨è¿”å›žå€¼çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šå‘ç”Ÿæ‰€æœ‰æƒçš„è½¬ç§»ã€‚123456789101112131415fn main() &#123; let s1 = gives_ownership(); // gives_ownership å°†å®ƒçš„è¿”å›žå€¼ç§»åŠ¨è‡³å˜é‡ s1 ä¸­ let s2 = String::from("hello"); // å˜é‡ s2 è¿›å…¥ä½œç”¨åŸŸ let s3 = takes_and_gives_back(s2); // s2 è¢«ç§»åŠ¨è¿›å‡½æ•° takes_and_gives_backï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„è¿”å›žå€¼åˆè¢«ç§»åŠ¨åˆ°äº†å˜é‡ s3 ä¸Š&#125; // s3 å’Œ s1 åœ¨è¿™é‡Œç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«é”€æ¯ï¼Œè€Œ s2 å·²ç»ç§»åŠ¨äº†ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…fn gives_ownership() -&gt; String &#123; let some_string = String::from("hello"); // some_string è¿›å…¥ä½œç”¨åŸŸ some_string // some_string ä½œä¸ºè¿”å›žå€¼ç§»åŠ¨è‡³è°ƒç”¨æ–¹&#125;// takes_and_gives_back å°†å–å¾—ä¸€ä¸ª String çš„æ‰€æœ‰æƒå¹¶å°†å®ƒä½œä¸ºç»“æžœè¿”å›žfn takes_and_gives_back(a_string: String) -&gt; String &#123; a_string // a_string ä½œä¸ºè¿”å›žå€¼ç§»åŠ¨è‡³è°ƒç”¨æ–¹&#125; å˜é‡çš„æ‰€æœ‰æƒè½¬ç§»æ€»æ˜¯éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼šå°†ä¸€ä¸ªå€¼èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶å°±ä¼šè½¬ç§»æ‰€æœ‰æƒã€‚å½“ä¸€ä¸ªæŒæœ‰å †æ•°æ®çš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå®ƒçš„æ•°æ®å°±ä¼šè¢«æ¸…ç†å›žæ”¶ï¼Œé™¤éžè¿™äº›æ•°æ®çš„æ‰€æœ‰æƒè¢«ç§»åŠ¨åˆ°äº†å¦ä¸€ä¸ªå˜é‡ä¸Šã€‚ å¼•ç”¨ä¸Žå€Ÿç”¨å‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š12345678910fn main() &#123; let s1 = String::from("hello"); let (s2, len) = calculate_length(s1); print!("The length of '&#123;&#125;' is &#123;&#125;", s2, len);&#125;fn calculate_length(s: String) -&gt; (String, usize) &#123; let length = s.len(); (s, length)&#125; ç”±äºŽè°ƒç”¨ caculate_length ä¼šå¯¼è‡´ String ç§»åŠ¨åˆ°å‡½æ•°ä½“å†…éƒ¨ï¼Œæˆ‘ä»¬åˆéœ€è¦åœ¨è°ƒç”¨åŽç»§ç»­ä½¿ç”¨è¯¥ Stringï¼Œå› æ­¤ä¸å¾—ä¸é€šè¿‡å…ƒç»„å°† String ä½œä¸ºå…ƒç´ ç»§ç»­è¿”å›žã€‚ è¿™ç§å†™æ³•æœªå…è¿‡äºŽç¬¨æ‹™ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ–°çš„ calculate_length å‡½æ•°ä½¿ç”¨äº† String çš„å¼•ç”¨ä½œä¸ºå‚æ•°è€Œä¸ä¼šç›´æŽ¥è½¬ç§»å€¼çš„æ‰€æœ‰æƒã€‚ 123456789fn main() &#123; let s1 = String::from("hello"); let len = calculate_length(&amp;s1); print!("The length of '&#123;&#125;' is &#123;&#125;", s1, len);&#125;fn calculate_length(s: &amp;String) -&gt; usize &#123; s.len()&#125; åœ¨æ–°çš„ä»£ç ä¸­ï¼Œè°ƒç”¨ calculate_length å‡½æ•°æ—¶ä½¿ç”¨äº† &amp;s1 ä½œä¸ºå‚æ•°ï¼Œä¸”åœ¨è¯¥å‡½æ•°çš„å®šä¹‰ä¸­ä½¿ç”¨ &amp;String æ›¿ä»£äº† Stringã€‚&amp; ä»£è¡¨å¼•ç”¨ï¼Œå…è®¸åœ¨ä¸èŽ·å–æ‰€æœ‰æƒçš„æƒ…å†µä¸‹ä½¿ç”¨å€¼ã€‚ &amp;s1 è¯­æ³•å…è®¸åœ¨ä¸è½¬ç§»æ‰€æœ‰æƒçš„å‰æä¸‹åˆ›å»ºä¸€ä¸ªæŒ‡å‘ s1 å€¼çš„å¼•ç”¨ã€‚ç”±äºŽå¼•ç”¨ä¸æŒæœ‰å€¼çš„æ‰€æœ‰æƒï¼Œå½“å¼•ç”¨ç¦»å¼€å½“å‰ä½œç”¨åŸŸæ—¶ï¼Œå®ƒæŒ‡å‘çš„å€¼ä¹Ÿä¸ä¼šè¢«ä¸¢å¼ƒã€‚å½“ä¸€ä¸ªå‡½æ•°ä½¿ç”¨å¼•ç”¨è€Œä¸æ˜¯å€¼æœ¬èº«ä½œä¸ºå‚æ•°æ—¶ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ä¸ºäº†å½’è¿˜æ‰€æœ‰æƒè€Œç‰¹æ„åŽ»è¿”å›žå€¼ã€‚æ¯•ç«Ÿå¼•ç”¨æ ¹æœ¬æ²¡æœ‰å–å¾—æ‰€æœ‰æƒã€‚ è¿™ç§é€šè¿‡å¼•ç”¨ä¼ é€’å‚æ•°ç»™å‡½æ•°çš„æ–¹æ³•ä¹Ÿç§°ä½œå€Ÿç”¨ã€‚ å¯å˜å¼•ç”¨ä¸Žå˜é‡ç±»ä¼¼ï¼Œå¼•ç”¨é»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚Rust ä¸å…è®¸ä¿®æ”¹å¼•ç”¨æŒ‡å‘çš„å€¼ï¼ˆé™¤éžå£°æ˜Žä¸º mutï¼‰ã€‚ 123456789fn main() &#123; let mut s = String::from("hello"); change(&amp;mut s); print!("&#123;&#125;", s)&#125;fn change(some_string: &amp;mut String) &#123; some_string.push_str(", world");&#125; å¯¹äºŽç‰¹å®šä½œç”¨åŸŸä¸­çš„ç‰¹å®šæ•°æ®ï¼Œä¸€æ¬¡åªèƒ½å£°æ˜Žä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚æ¯”å¦‚ï¼š123456fn main() &#123; let mut s = String::from("hello"); let r1 = &amp;mut s; let r2 = &amp;mut s; println!("&#123;&#125;", r1)&#125; å°±ä¼šå‡ºçŽ° cannot borrow s as mutable more than once at a time ç¼–è¯‘é”™è¯¯ã€‚è¿™ä¸ªè§„åˆ™ä½¿å¾—å¼•ç”¨çš„å¯å˜æ€§åªèƒ½ä»¥ä¸€ç§å—åˆ°ä¸¥æ ¼é™åˆ¶çš„æ–¹å¼ä½¿ç”¨ã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œéµå¾ªè¿™æ¡é™åˆ¶æ€§è§„åˆ™å¯ä»¥åœ¨ç¼–è¯‘æ—¶é¿å…æ•°æ®ç«žäº‰ã€‚å³ä¸å…è®¸ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„æŒ‡é’ˆåŒæ—¶è®¿é—®ï¼ˆä¸”è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆä¼šå†™å…¥æ•°æ®ï¼‰åŒä¸€ç©ºé—´ã€‚æ•°æ®ç«žäº‰ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼Œå¾€å¾€éš¾ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œè·Ÿè¸ªï¼Œä¹Ÿå°±ä½¿å¾—å‡ºçŽ°çš„ bug æ›´åŠ éš¾ä»¥è¢«è¯Šæ–­å’Œä¿®å¤ã€‚ ä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶åˆ›å»ºå¯å˜å¼•ç”¨ã€‚ç¼–è¯‘æ—¶ä¼šæŠ¥å‡º cannot borrow s as immutable because it is also borrowed as mutable é”™è¯¯ã€‚1234567fn main() &#123; let mut s = String::from("hello"); let r1 = &amp;s; // æ²¡é—®é¢˜ let r2 = &amp;s; // æ²¡é—®é¢˜ let r3 = &amp;mut s; // é”™è¯¯ println!("&#123;&#125;", r2)&#125; ä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶åˆ›å»ºå¯å˜å¼•ç”¨ï¼Œä½†å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªä¸å¯å˜å¼•ç”¨ã€‚å› ä¸ºå¯¹æ•°æ®çš„åªè¯»æ“ä½œä¸ä¼šå½±å“åˆ°å…¶ä»–è¯»å–æ•°æ®çš„ç”¨æˆ·ã€‚ Rust ç¼–è¯‘å™¨å¯ä»¥ä¸ºç”¨æˆ·ææ—©ï¼ˆç¼–è¯‘æ—¶è€Œä¸æ˜¯è¿è¡Œæ—¶ï¼‰æš´éœ²é‚£äº›æ½œåœ¨çš„ bugï¼Œå¹¶ä¸”æ˜Žç¡®æŒ‡å‡ºå‡ºçŽ°é—®é¢˜çš„åœ°æ–¹ã€‚ç”¨æˆ·å°±ä¸å†éœ€è¦åŽ»è¿½è¸ªè°ƒè¯•ä¸ºä½•æ•°æ®ä¼šåœ¨è¿è¡Œæ—¶å‘ç”Ÿäº†éžé¢„æœŸçš„å˜åŒ–ã€‚ å‚è€ƒèµ„æ–™The Rust Programming Language]]></content>
      <categories>
        <category>Rust</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Reference</tag>
        <tag>Rust</tag>
        <tag>Ownership</tag>
        <tag>Move</tag>
        <tag>Pointer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The Rust programming language è¯»ä¹¦ç¬”è®°â€”â€”é€šç”¨ç¼–ç¨‹æ¦‚å¿µ]]></title>
    <url>%2F2021%2F06%2F04%2Fthe-rust-programming-language-reading-notes-common-concepts%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å˜é‡Rust ä¸­çš„å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚ å¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç æµ‹è¯•å˜é‡çš„ä¸å¯å˜æ€§ï¼š ä½¿ç”¨ cargo new variables å‘½ä»¤åˆ›å»ºæ–°çš„ Rust é¡¹ç›® è¿›å…¥æ–°åˆ›å»ºçš„ variables ç›®å½•ï¼Œç¼–è¾‘ src/main.rs æºä»£ç æ–‡ä»¶ 123456fn main() &#123; let x = 10; println!("The value is &#123;&#125;", x); x = 20; println!("The value is &#123;&#125;", x);&#125; è¿è¡Œ cargo run å‘½ä»¤ç¼–è¯‘å¹¶æ‰§è¡Œ Rust ç¨‹åºï¼Œå‡ºçŽ°å¦‚ä¸‹æŠ¥é”™ï¼š1error[E0384]: cannot assign twice to immutable variable `x` å³ Rust ç¼–è¯‘å™¨ä¸å…è®¸ç¨‹åºä»£ç å¯¹ä¸å¯å˜å˜é‡è¿›è¡ŒäºŒæ¬¡èµ‹å€¼ã€‚ å¯ä»¥é€šè¿‡ let mut å…³é”®å­—å£°æ˜Žå¯å˜å˜é‡ã€‚123456fn main() &#123; let mut x = 10; println!("The value is &#123;&#125;", x); x = 20; println!("The value is &#123;&#125;", x);&#125; 12345$ cargo run Finished dev [unoptimized + debuginfo] target(s) in 0.29s Running `target/debug/variables`The value is 10The value is 20 PSï¼šåœ¨ä½¿ç”¨é‡åž‹æ•°æ®ç»“æž„æ—¶ï¼Œé€‚å½“åœ°ä½¿ç”¨å¯å˜æ€§åŽ»ä¿®æ”¹ä¸€ä¸ªå®žä¾‹ï¼Œå¯èƒ½æ¯”é‡æ–°è¿”å›žä¸€ä¸ªæ–°åˆ†é…çš„å®žä¾‹æ›´æœ‰æ•ˆçŽ‡ï¼›è€Œæ•°æ®ç»“æž„æ›´ä¸ºè½»é‡æ—¶ï¼Œé‡‡ç”¨åå‡½æ•°å¼çš„é£Žæ ¼åˆ›å»ºæ–°å˜é‡æ¥è¿›è¡Œèµ‹å€¼ï¼Œå¯èƒ½ä¼šä½¿ä»£ç æ›´æ˜“äºŽç†è§£ã€‚ å¸¸é‡ ä½¿ç”¨ const è€Œä¸æ˜¯ let å…³é”®å­—å£°æ˜Žå¸¸é‡ å£°æ˜Žå¸¸é‡æ—¶å¿…é¡»æ˜¾å¼åœ°æ ‡æ³¨å€¼çš„ç±»åž‹ å¸¸é‡å¯ä»¥è¢«å£°æ˜Žåœ¨ä»»ä½•ä½œç”¨åŸŸä¸­ã€‚åœ¨ä¸€ä¸ªå€¼éœ€è¦è¢«ä¸åŒéƒ¨åˆ†çš„ä»£ç å…±åŒå¼•ç”¨æ—¶å¾ˆæœ‰ç”¨å¤„ æ— æ³•å°†ä¸€ä¸ªå‡½æ•°çš„è¿”å›žå€¼æˆ–å…¶ä»–éœ€è¦åœ¨è¿è¡Œæ—¶è®¡ç®—çš„å€¼ç»‘å®šåˆ°å¸¸é‡ä¸Š const PI: f32 = 3.1415; ShadowShadow çš„æ„æ€æ˜¯ï¼Œä¸€ä¸ªæ–°å£°æ˜Žçš„å˜é‡å¯ä»¥è¦†ç›–æŽ‰æ—§çš„åŒåå˜é‡ã€‚ 123456fn main() &#123; let x = 5; let x = x + 1; let x = x * 2; println!("The value is &#123;&#125;", x);&#125; 123 Finished dev [unoptimized + debuginfo] target(s) in 0.00s Running `target/debug/variables`The value is 12 Shadow æœºåˆ¶å…è®¸åœ¨å¤ç”¨å˜é‡åç§°çš„åŒæ—¶æ”¹å˜å˜é‡çš„ç±»åž‹ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±æ˜¯åˆæ³•çš„ï¼š12let spaces = " ";let sapces = spaces.len(); é€šè¿‡å¤ç”¨ spaces è¿™ä¸ªåå­—ï¼Œå°±ä¸éœ€è¦å†å£°æ˜Žè¯¸å¦‚ spaces_str å’Œ spaces_num ä¹‹ç±»çš„å˜é‡ã€‚ ä½†å¦‚æžœä½¿ç”¨ mut å…³é”®å­—æ¥æ¨¡æ‹Ÿä¸Šè¿°æ•ˆæžœå°±ä¼šæŠ¥é”™ã€‚12let mut spaces = " ";spaces = spaces.len(); å› ä¸ºç¼–è¯‘å™¨æ‹’ç»ä¿®æ”¹å˜é‡çš„ç±»åž‹ï¼Œå³ä¾¿è¯¥å˜é‡æ˜¯å¯å˜çš„ã€‚Shadow çš„æœºåˆ¶åœ¨äºŽä½¿ç”¨ let å…³é”®å­—é‡æ–°å£°æ˜Žäº†å˜é‡ã€‚ äºŒã€æ•°æ®ç±»åž‹Rust æ˜¯ä¸€é—¨é™æ€ç±»åž‹è¯­è¨€ï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­éœ€è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„å…·ä½“ç±»åž‹ã€‚ å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨æŽ¨å¯¼å‡ºå˜é‡ç±»åž‹ã€‚ä½†æ¯”å¦‚éœ€è¦å°† String ç±»åž‹è½¬æ¢ä¸ºæ•°å€¼ç±»åž‹æ—¶ï¼Œå°±å¿…é¡»æ˜¾å¼åœ°æ·»åŠ ç±»åž‹æ ‡æ³¨ï¼šlet guess: u32 = &quot;42&quot;.parse().expect(&quot;Not a number&quot;); æ ‡é‡ï¼ˆScalarï¼‰ç±»åž‹æ ‡é‡ç±»åž‹æ˜¯å•ä¸ªå€¼ç±»åž‹çš„ç»Ÿç§°ã€‚Rust å†…ç½® 4 ç§åŸºç¡€çš„æ ‡é‡ç±»åž‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼å’Œå­—ç¬¦ã€‚ æ•´æ•°ç±»åž‹ é•¿åº¦ æœ‰ç¬¦å· æ— ç¬¦å· 8 bit i8 u8 16 bit i16 u16 32 bit i32 u32 64 bit i64 u64 æœ‰æ— ç¬¦å·ä»£è¡¨äº†ä¸€ä¸ªæ•´æ•°ç±»åž‹æ˜¯å¦åŒ…å«è´Ÿæ•°ã€‚å³æœ‰ç¬¦å·çš„æ•´æ•°æ€»æ˜¯éœ€è¦ä¸€ä¸ª bit è¡¨ç¤ºå½“å‰æ•°å€¼æ˜¯å¦ä¸ºæ­£ã€‚å¯¹äºŽä¸€ä¸ª n bit çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œå…¶å–å€¼èŒƒå›´æ˜¯ - 2 ^ (n - 1) åˆ° 2 ^ (n - 1) - 1ï¼›é•¿åº¦ä¸º n bit çš„æ— ç¬¦å·æ•´æ•°ï¼Œå…¶å–å€¼èŒƒå›´åˆ™æ˜¯ 0 åˆ° 2 ^ n - 1ã€‚ æµ®ç‚¹æ•°ç±»åž‹åŒ…å« f32 å’Œ f64 ä¸¤ç§ç±»åž‹ã€‚Rust é»˜è®¤ä¼šå°†æœªæ ‡æ³¨ç±»åž‹çš„æµ®ç‚¹æ•°æŽ¨å¯¼ä¸º f64ã€‚æ•´æ•°ä¼šæŽ¨å¯¼ä¸º i32ã€‚ å­—ç¬¦ç±»åž‹Rust ä¸­ï¼Œchar ç±»åž‹ä½¿ç”¨å•å¼•å·æŒ‡å®šï¼Œå­—ç¬¦ä¸²ç±»åž‹ä½¿ç”¨åŒå¼•å·æŒ‡å®šã€‚ char ç±»åž‹å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œæ˜¯ä¸€ä¸ª Unicode æ ‡é‡å€¼ã€‚let smile = &#39;ðŸ˜€&#39;; å¤åˆç±»åž‹å¤åˆç±»åž‹å¯ä»¥å°†å¤šä¸ªä¸åŒç±»åž‹çš„å€¼ç»„åˆæˆä¸€ä¸ªç±»åž‹ã€‚Rust å†…ç½®ä¸¤ç§å¤åˆç±»åž‹ï¼Œå…ƒç»„å’Œæ•°ç»„ã€‚ å…ƒç»„ å…ƒç»„æ¯ä¸ªä½ç½®ä¸Šçš„å€¼éƒ½æœ‰ä¸€ä¸ªç±»åž‹ å…ƒç»„æ‹¥æœ‰å›ºå®šçš„é•¿åº¦ã€‚æ— æ³•åœ¨å£°æ˜Žç»“æŸåŽå¢žåŠ æˆ–å‡å°‘å…¶ä¸­çš„å…ƒç´ ã€‚ 123fn main() &#123; let tup: (i32, f64, u8) = (500, 6.4, 1);&#125; ä¸ºäº†ä»Žå…ƒç»„ä¸­èŽ·å–å•ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥è§£æž„ï¼ˆæ‹†åŒ…ï¼‰å…ƒç»„ã€‚12345fn main() &#123; let tup = (500, 6.4, 1); let (x, y, z) = tup; print!("The value of y is: &#123;&#125;", y);&#125; è¿˜å¯ä»¥é€šè¿‡ç´¢å¼•ä½¿ç”¨ç‚¹å·è®¿é—®å…ƒç»„ä¸­çš„å…ƒç´ ã€‚123456fn main() &#123; let x: (i32, f64, u8) = (500, 6.4, 1); let five_hundred = x.0; let six_point_four = x.1; let one = x.2;&#125; æ•°ç»„ æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»æ˜¯ç›¸åŒçš„ç±»åž‹ æ•°ç»„æ‹¥æœ‰å›ºå®šçš„é•¿åº¦ï¼Œä¸€æ—¦å£°æ˜Žå°±æ— æ³•æ›´æ”¹å¤§å° 12345678910111213141516fn main() &#123; let months = [ "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", ];&#125; æ•°ç»„çš„ç±»åž‹æ ‡æ³¨ï¼šlet a: [i32; 5] = [1, 2, 3, 4, 5]; åˆå§‹åŒ–å«æœ‰ç›¸åŒå…ƒç´ çš„æ•°ç»„ï¼šlet a = [3; 5];ç­‰ä»·äºŽ let a = [3, 3, 3, 3, 3]; æ•°ç»„ç”±ä¸€æ•´å—åˆ†é…åœ¨æ ˆä¸Šçš„å†…å­˜ç»„æˆï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚123456fn main() &#123; let a = [1, 2, 3, 4, 5]; let first = a[0]; let second = a[1];&#125; ä¸‰ã€å‡½æ•°å¿…é¡»æ˜¾å¼åœ°å£°æ˜Žæ¯ä¸ªå‚æ•°ï¼ˆå¦‚æžœæœ‰ï¼‰çš„æ•°æ®ç±»åž‹ã€‚12345678fn main() &#123; another_function(5, 6);&#125;fn another_function(x: i32, y: i32) &#123; print!("The value of x is: &#123;&#125;", x); print!("The value of y is: &#123;&#125;", y);&#125; Rust æ˜¯ä¸€é—¨åŸºäºŽè¡¨è¾¾å¼çš„è¯­è¨€ã€‚å®ƒå°†è¯­å¥ï¼ˆstatementï¼‰ä¸Žè¡¨è¾¾å¼ï¼ˆexpressionï¼‰åŒºåˆ†ä¸ºä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚ å¦‚ä½¿ç”¨ let å…³é”®å­—åˆ›å»ºå˜é‡å¹¶ç»‘å®šå€¼æ—¶çš„æŒ‡ä»¤å°±æ˜¯ä¸€æ¡è¯­å¥ï¼šlet y = 6;è¯­å¥ä¸ä¼šè¿”å›žå€¼ã€‚ åœ¨ C æˆ– Ruby è¯­è¨€é‡Œï¼Œèµ‹å€¼è¯­å¥ä¼šè¿”å›žæ‰€èµ‹çš„å€¼ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨ x = y =6 è¿™æ ·çš„è¯­å¥ï¼Œä½† Rust ä¸æ”¯æŒè¿™æ ·çš„è¯­æ³•ã€‚ è¡¨è¾¾å¼ä¼šè®¡ç®—å‡ºæŸä¸ªå€¼ä½œä¸ºç»“æžœè¿”å›žã€‚å¦‚ 5 + 6 å°±æ˜¯è¡¨è¾¾å¼ï¼ˆè¿”å›ž 11ï¼‰ï¼Œlet y = 6 ä¸­çš„æ•°å­— 6 ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼ˆè¿”å›ž 6 æœ¬èº«ï¼‰ã€‚è¡¨è¾¾å¼æœ¬èº«å¯ä»¥ä½œä¸ºè¯­å¥çš„ä¸€éƒ¨åˆ†ã€‚ç”¨æ¥åˆ›å»ºæ–°ä½œç”¨åŸŸçš„å¤§æ‹¬å·ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚ 123456789fn main() &#123; let x = 5; let y = &#123; let x = 3; x + 1 &#125;; println!("The value of y is: &#123;&#125;", y);&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œlet y = åŽé¢å¤§æ‹¬å·éƒ¨åˆ†çš„å†…å®¹å°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒä¼šå°†è®¡ç®—å‡ºçš„ç»“æžœ 4 ä½œä¸ºè¿”å›žå€¼ã€‚è¯¥è¿”å›žå€¼æŽ¥ç€é€šè¿‡èµ‹å€¼è¯­å¥ç»‘å®šç»™å˜é‡ yã€‚ç»“å°¾å¤„çš„ x + 1 å¹¶æ²¡æœ‰æ·»åŠ åˆ†å·ã€‚è‹¥åŠ ä¸Šåˆ†å·ï¼Œåˆ™è¿™æ®µä»£ç å°±å˜æˆäº†è¯­å¥è€Œä¸ä¼šè¿”å›žä»»ä½•å€¼ã€‚ å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒçš„ä»£ç è¿”å›žå€¼ã€‚ä½†éœ€è¦åœ¨ç®­å¤´åŽé¢å£°æ˜Žå€¼çš„ç±»åž‹ã€‚å¯ä»¥ä½¿ç”¨ return å…³é”®å­—æŒ‡å®šä¸€ä¸ªå€¼æå‰ä»Žå‡½æ•°ä¸­è¿”å›žï¼Œä½†å¤§å¤šæ•°å‡½æ•°éƒ½éšå¼åœ°è¿”å›žäº†æœ€åŽçš„è¡¨è¾¾å¼ã€‚12345678fn main() &#123; let x = plus_one(5); print!("The value of x is: &#123;&#125;", x);&#125;fn plus_one(x: i32) -&gt; i32 &#123; x + 1&#125; ä¸Šè¿°ä»£ç ä¼šè¾“å‡º 6ã€‚ä½†å¦‚æžœåœ¨ plus_one å‡½æ•°æœ«å°¾çš„ x + 1 å¤„åŠ ä¸Šåˆ†å·ï¼Œè¯¥è¡¨è¾¾å¼å°±ä¼šå˜æˆè¯­å¥ï¼ˆä¸è¿”å›žä»»ä½•å€¼ï¼‰ï¼Œæœ€ç»ˆåœ¨ç¼–è¯‘æ—¶æŠ¥å‡º mismatched types é”™è¯¯ã€‚åŽŸå› æ˜¯ plus_one çš„å£°æ˜Žä¸­æŒ‡å®šè¿”å›žå€¼ç±»åž‹ä¸º i32ï¼Œä½†ç”±äºŽè¯­å¥ä¸è¿”å›žä»»ä½•å€¼ï¼ŒRust é»˜è®¤è¿”å›žäº†ä¸€ä¸ªç©ºå…ƒç»„ï¼ˆ()ï¼‰ï¼Œå¯¼è‡´å®žé™…çš„è¿”å›žå€¼ç±»åž‹ä¸Žå‡½æ•°å®šä¹‰äº§ç”Ÿäº†å†²çªã€‚ å››ã€æŽ§åˆ¶æµif è¡¨è¾¾å¼if è¡¨è¾¾å¼å¿…é¡»äº§ç”Ÿä¸€ä¸ª bool ç±»åž‹çš„å€¼ï¼Œå¦åˆ™ä¼šè§¦å‘ç¼–è¯‘é”™è¯¯ã€‚123456fn main() &#123; let number = 3; if number &#123; print!("number was three"); &#125;&#125; åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œif è¡¨è¾¾å¼çš„è®¡ç®—ç»“æžœä¸º 3ï¼Œè€Œ Rust æœŸæœ›èŽ·å¾—ä¸€ä¸ª bool å€¼ï¼Œå› æ­¤ç¼–è¯‘æ—¶ä¼šçˆ†å‡º mismatched types é”™è¯¯ã€‚Rust ä¸ä¼šè‡ªåŠ¨å°è¯•å°†éžå¸ƒå°”å€¼è½¬æ¢ä¸ºå¸ƒå°”ç±»åž‹ã€‚ if æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å¯ä»¥åœ¨ let è¯­å¥å³ä¾§ä½¿ç”¨ if è¡¨è¾¾å¼æ¥å®Œæˆèµ‹å€¼ã€‚123456789fn main() &#123; let condition = true; let number = if condition &#123; 5 &#125; else &#123; 6 &#125;; print!("The value of number is &#123;&#125;", number);&#125; æ•´ä¸ª if è¡¨è¾¾å¼çš„å€¼å–å†³äºŽå…·ä½“å“ªä¸€ä¸ªä»£ç å—å¾—åˆ°äº†æ‰§è¡Œã€‚å› æ­¤ï¼Œæ‰€æœ‰ if åˆ†æ”¯å¯èƒ½è¿”å›žçš„å€¼éƒ½å¿…é¡»æ˜¯åŒä¸€ç§ç±»åž‹çš„ã€‚å¦åˆ™ä¼šè§¦å‘ç¼–è¯‘é”™è¯¯ã€‚123456789fn main() &#123; let condition = true; let number = if condition &#123; 5 &#125; else &#123; "six" // é”™è¯¯ï¼Œç±»åž‹ä¸åŒ¹é… &#125;; print!("The value of number is &#123;&#125;", number);&#125; å¾ªçŽ¯Rust æä¾›äº† 3 ç§å¾ªçŽ¯ï¼šloopã€whileã€forã€‚ ä»Ž loop å¾ªçŽ¯ä¸­è¿”å›žå€¼123456789101112fn main() &#123; let mut counter = 0; let result = loop &#123; counter += 1; if counter == 10 &#123; break counter * 2; &#125; &#125;; print!("The result is &#123;&#125;", result);&#125; break å…³é”®å­—ä¸­æ–­å¾ªçŽ¯å¹¶è¿”å›ž counter * 2ã€‚ while å¾ªçŽ¯1234567891011fn main() &#123; let mut number = 3; while number != 0 &#123; println!("&#123;&#125;!", number); number = number - 1; &#125; println!("LIFTOFF!!!");&#125; for å¾ªçŽ¯éåŽ†é›†åˆä¸­çš„å…ƒç´ 1234567fn main() &#123; let a = [10, 20, 30, 40, 50]; for element in a.iter() &#123; println!("the value is: &#123;&#125;", element); &#125;&#125; for å¾ªçŽ¯é‡æž„å‰é¢ä½¿ç”¨ while å¾ªçŽ¯çš„ä»£ç 123456fn main() &#123; for number in (1..4).rev() &#123; println!("&#123;&#125;!", number); &#125; println!("LIFTOFF!!!");&#125; å‚è€ƒèµ„æ–™The Rust Programming Language]]></content>
      <categories>
        <category>Rust</category>
      </categories>
      <tags>
        <tag>Development</tag>
        <tag>Function</tag>
        <tag>Programming</tag>
        <tag>Basic</tag>
        <tag>Rust</tag>
        <tag>Variable</tag>
        <tag>Loop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vim 8.1 æ‡’äººé…ç½®æ‰‹å†Œï¼ˆåŒ…å« C/C++ã€Pythonã€Rust è‡ªåŠ¨è¡¥å…¨ï¼ŒåŸºäºŽ coc.nvimï¼‰]]></title>
    <url>%2F2021%2F05%2F30%2Fvim-configuration-with-coc-support-rust-c-python-complete%2F</url>
    <content type="text"><![CDATA[å…ˆè¯´ç‚¹åºŸè¯ã€‚ æœ€è¿‘è£…äº† WSL2ï¼Œæƒ³ç€ä½œä¸º Win10 å†…ç½®çš„ Linux ç³»ç»Ÿï¼Œåº”è¯¥æ¯”ä¸€èˆ¬çš„è™šæ‹Ÿæœºè¦æ¥å¾—å¹³æ»‘ä¸€äº›ã€‚æ¯•ç«Ÿè™šæ‹Ÿæœºè¿˜è¦è£… Virtualboxï¼Œæ¯æ¬¡å¼€æœºè¿˜è¦å¤šç‚¹å‡ ä¸‹ï¼Œè¿˜è¦ç­‰å®ƒå¯åŠ¨ã€‚æ€•éº»çƒ¦ã€‚ã€‚ã€‚ å¯èƒ½ä¹ æƒ¯é—®é¢˜ï¼Œå–œæ¬¢åœ¨ Linux ä¸‹é…ç½®å¼€å‘çŽ¯å¢ƒï¼ˆå­¦ä¹ å†™ä»£ç ï¼‰ã€‚æ€»æ„Ÿè§‰ Windows ä¸Šç•¥æ˜¾ç£¨å½äº†ä¸€äº›ã€‚ä¹Ÿè®¸æˆ‘é“è¡Œä¸å¤Ÿã€‚ç¢°åˆ°éœ€è¦ç¼–è¯‘çš„ä¸œè¥¿ï¼Œä¸€å¥—å·¥å…·è£…èµ·æ¥è¿‡äºŽç¹çï¼Œç›´æŽ¥ sudo apt install gcc ä¸é¦™å—ã€‚ å¯æƒœ WSL æ²¡æœ‰æ¡Œé¢æ”¯æŒï¼Œè£…ä¸ä¸Š Vscodeã€‚å¯¹äºŽå·¥å…·çš„é€‰æ‹©ï¼Œæˆ‘çš„åŽŸåˆ™æ˜¯ç®€å•å¤Ÿç”¨å°±å¥½ï¼ŒVscode å³æ˜¯ç›®å‰æˆ‘çš„æœ€çˆ±ï¼ˆéžé‡åº¦ç¼–ç ï¼‰ã€‚å¼€ç®±å³ç”¨ï¼ŒåŠŸèƒ½æ»¡è¶³åŸºæœ¬éœ€æ±‚ã€‚æ— éžä»£ç é«˜äº®ã€è‡ªåŠ¨è¡¥å…¨ã€æŸ¥çœ‹å®šä¹‰ã€è¯­æ³•æ£€æŸ¥ã€ä»£ç æ ¼å¼åŒ–ï¼Œå†åŠ ä¸ªè·³è½¬ã€‚ äºŽæ˜¯å†³å®šåœ¨ Windows ç³»ç»Ÿä¸Šå®‰è£… Vscodeï¼Œå€ŸåŠ© Remote WSL æ’ä»¶â€œè¿œç¨‹â€ç¼–ç ã€‚å¯æƒœæœ‰ BUGï¼Œä¸€ç›´ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚Github ä¸Šæäº† issueï¼Œæ²¡äººç†ã€‚æ— å¥ˆè½¬å‘ Vimã€‚ ä¸€å¼€å§‹ç”¨çš„è¡¥å…¨æ’ä»¶æ˜¯ YouCompleteMeï¼Œè¿˜è¦ç¼–è¯‘ã€‚è™½ç„¶æ•²ä¸ªå‘½ä»¤å°±èƒ½è‡ªåŠ¨æ‰§è¡Œï¼Œä½†å…‰ Rust æ”¯æŒå°±åœ¨æœ¬åœ°ç»™æˆ‘æžäº†å°†è¿‘ 1G çš„æ–‡ä»¶ï¼Œä¸å¤ªèƒ½å¿ã€‚ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œè²Œä¼¼å·²ç»å¾ˆè€çš„æœºåˆ¶äº†ã€‚äºŽæ˜¯è½¬å‘è¾ƒæ–°ä¸€ç‚¹çš„ coc.nvimã€‚æ®è¯´æ”¯æŒå„ç§ LSPï¼ˆè¿™ä¸ªç¼©å†™ã€‚ã€‚ã€‚ï¼‰ï¼Œä¹Ÿä¸æ‡‚ï¼Œèƒ½ç”¨å°±è¡Œã€‚ åºŸè¯ç»“æŸã€‚ ä¸€ã€æ•ˆæžœæˆªå›¾ äºŒã€NERDTree æ–‡ä»¶æµè§ˆå™¨vim ç”¨çš„è‡ªå¸¦çš„ 8.1 ç‰ˆæœ¬ï¼Œæœ‰å†…ç½®çš„æ’ä»¶ç®¡ç†ã€‚ä¸€èˆ¬çš„æ’ä»¶å®‰è£…æµç¨‹æ˜¯ç›´æŽ¥å°†æ’ä»¶æºä»£ç  clone åˆ° ~/.vim/pack/vendor/start è·¯å¾„ä¸‹ï¼ˆæ²¡æœ‰å°±åˆ›å»ºï¼‰ï¼Œå†åœ¨ vim ä¸­è¿è¡Œ :helptags ~/.vim/pack/vendor/start/someplugin/doc å‘½ä»¤ç”Ÿæˆå¸®åŠ©æ–‡æ¡£ï¼ˆè¿™ä¸€æ­¥å¯é€‰ï¼‰ã€‚ vim ä¼šè‡ªåŠ¨æ£€æµ‹å·²ç»ä¸‹è½½çš„æ’ä»¶ã€‚vendor è·¯å¾„ä¸‹å¯ä»¥æœ‰ start å’Œ opt ä¸¤ä¸ªç›®å½•ï¼Œstart è·¯å¾„ä¸‹çš„æ’ä»¶ä¼šåœ¨ vim å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ï¼Œopt è·¯å¾„ä¸‹çš„æ’ä»¶åˆ™éœ€è¦é€šè¿‡ :packadd å‘½ä»¤æ‰‹åŠ¨åŠ è½½ã€‚ vendor ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–åç§°ï¼ŒåŒä½ç½®ä¸‹ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªç›¸åŒç»“æž„çš„ç›®å½•ï¼Œæ–¹ä¾¿å¯¹ä¸åŒç±»åž‹çš„æ’ä»¶åˆ†åˆ«è¿›è¡Œç®¡ç†ã€‚çœäº‹èµ·è§ï¼Œè¿™é‡Œæ‰€æœ‰çš„æ’ä»¶éƒ½æ”¾åœ¨ ~/.vim/pack/vendor/start ä¸‹é¢ã€‚ NERDTree æ–‡ä»¶æµè§ˆå™¨æ’ä»¶å®‰è£…ï¼š12cd ~/.vim/pack/vendor/startgit clone https://github.com/scrooloose/nerdtree åœ¨ ~/.vimrc æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š12345678" è¿›å…¥ vim æ—¶è‡ªåŠ¨å¼€å¯ NERDTreeautocmd VimEnter * NERDTree | wincmd p" è‹¥å…³é—­æŸä¸ª buff åŽ NERDTree æ˜¯ä»…å‰©çš„æœ€åŽä¸€ä¸ª buffï¼Œåˆ™è‡ªåŠ¨å…³é—­ NERDTreeautocmd BufEnter * if tabpagenr('$') == 1 &amp;&amp; winnr('$') == 1 &amp;&amp; exists('b:NERDTree') &amp;&amp; b:NERDTree.isTabTree() | quit | endif" ä½¿ç”¨ Ctrl+n å¿«æ·é”®æ‰“å¼€æˆ–å…³é—­ NERDTreennoremap &lt;C-n&gt; :NERDTreeToggle&lt;CR&gt; æ›´å¤šé…ç½®é€‰é¡¹å‚è€ƒ VimAwesome ä¸‰ã€vim-airline ä¸Žé…è‰²å®‰è£… vim-airline çŠ¶æ€æ ç¾ŽåŒ–æ’ä»¶ï¼šgit clone https://github.com/vim-airline/vim-airline å…³äºŽé…è‰²ï¼Œèåœé’èœå„æœ‰æ‰€çˆ±ã€‚æ‡’å¾—åŽ»ä¸€ä¸ªä¸€ä¸ªè¯•ã€‚å‡†å¤‡äº†ä¸¤å¥—ï¼Œvim-one æ·±è‰²å’Œ gruvbox æµ…è‰²ã€‚ vim-one æ’ä»¶å®‰è£…ï¼šgit clone https://github.com/rakr/vim-one æ·»åŠ é…ç½®ï¼š12345" æ·±è‰²èƒŒæ™¯set bg=dark" å¯ç”¨ one é…è‰²colorscheme one æ•ˆæžœæˆªå›¾ï¼š å®‰è£… gruvbox æ’ä»¶ï¼šgit clone https://github.com/morhetz/gruvbox ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆæ³¨é‡ŠæŽ‰ colorscheme oneï¼‰ï¼š123set bg=light" colorscheme oneautocmd vimenter * ++nested colorscheme gruvbox æ•ˆæžœæˆªå›¾ï¼š æ›´å¤æ‚çš„é…ç½®å¯è‡ªè¡Œåœ¨ VimAwesome æœç´¢å¯¹åº”çš„æ’ä»¶ï¼Œæˆ–è€…è¿›å…¥ç›¸åº”çš„ Github ä¸»é¡µæŸ¥çœ‹ã€‚ å››ã€coco.nvim ä»£ç è¡¥å…¨ä¸Žè¯­æ³•æ£€æŸ¥å®‰è£… nodejs &gt;= 10.12ï¼Œå®˜ç½‘ä¸Šå†™çš„æ˜¯é€šè¿‡ curl -sL install-node.now.sh/lts | bash å‘½ä»¤å®‰è£…ã€‚æˆ‘ä¸ªäººå»ºè®®ä½¿ç”¨ nvm å®‰è£…æœ€æ–°çš„ lts ç‰ˆæœ¬ã€‚æ­¤å¤„ä¸èµ˜è¿°ã€‚ å®‰è£… coc.nvim æ’ä»¶ï¼šgit clone https://github.com/neoclide/coc.nvim.git ä¸ºäº†å¾—åˆ°æŸç§ç¼–ç¨‹è¯­è¨€çš„è¡¥å…¨åŠŸèƒ½ï¼Œè¿˜éœ€è¦å®‰è£…å¯¹åº”è¯­è¨€çš„ coc æ‰©å±•ä»¥åŠä»£ç è¡¥å…¨åŽç«¯ï¼ˆLSPï¼‰ã€‚æ¯”å¦‚ C/C++ å¯¹åº”çš„ coc æ‰©å±•ä¸º coc-clangdï¼ŒLSP ä¸º clangdã€‚ä¸¤ä¸ªéƒ½éœ€è¦ã€‚ å®‰è£… coc æ‰©å±•çš„æ–¹æ³•éžå¸¸ç®€å•ï¼Œè¿›å…¥ vim åŽè¿è¡Œ :CocInstall extension_name å‘½ä»¤å³å¯ã€‚æ¯”å¦‚ä½¿ç”¨ :CocInstall coc-clangd å‘½ä»¤å®‰è£… coc-clangd æ‰©å±•ã€‚coc æ‰©å±•æˆ‘é‡åˆ°çš„éƒ½æ¯”è¾ƒå°ï¼Œå®‰è£…éžå¸¸è¿…é€Ÿï¼Œä¹Ÿä¼šå•ç‹¬å¼€ä¸€ä¸ªçª—å£æ˜¾ç¤ºè¿›åº¦ä¿¡æ¯ã€‚ coc æ‰©å±•å®‰è£…å®ŒæˆåŽï¼Œæ‰“å¼€å¯¹åº”çš„æºä»£ç æ–‡ä»¶ï¼Œæ¯”å¦‚ vim test.cï¼Œvim å°±ä¼šè‡ªåŠ¨åœ¨æœ¬åœ°çŽ¯å¢ƒä¸­å¯»æ‰¾å¯¹åº”çš„ LSPï¼ˆC/C++ è¯­è¨€æ˜¯ clangdï¼‰ã€‚ è‹¥ clangd æ­¤æ—¶å¹¶æœªå®‰è£…ï¼Œvim å°±ä¼šæç¤ºä½ è¿è¡ŒæŸä¸ªå‘½ä»¤ï¼ˆåœ¨ vim å†…éƒ¨ï¼‰è‡ªåŠ¨å®‰è£…è¯¥ä¾èµ–ã€‚è¿™é‡Œæœ‰ä¸ªå‘ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç½‘ç»œçš„é—®é¢˜ï¼Œæˆ‘å¤åˆ¶è¿è¡Œäº† vim æä¾›çš„å‘½ä»¤ï¼Œä¸€ç›´æ˜¾ç¤ºä¸‹è½½ä¸­ï¼Œå‡ ä¸ªå°æ—¶ä¸è§ä¸‹è½½å®Œæˆã€‚ã€‚ã€‚ å¥½åœ¨å¯ä»¥æ‰‹åŠ¨å®‰è£… clangdï¼Œé€€å‡º vim ç›´æŽ¥è¿è¡Œ sudo apt install clangd å³å¯ã€‚æ­¤æ—¶ coc.nvim å¯¹äºŽ C/C++ çš„è¡¥å…¨æ”¯æŒå³å®‰è£…é…ç½®å®Œæˆã€‚ Rust å’Œ Python è¯­è¨€æ”¯æŒå¯¹äºŽ Rust è¯­è¨€ï¼Œéœ€è¦å…ˆå®‰è£… coc-rust-analyzer æ‰©å±•ï¼š:CocInstall coc-rust-analyzerè¿™ä¸€æ­¥ç®€å•è¿…é€Ÿã€‚ å®‰è£… rust-srcï¼šrustup component add rust-src æŽ¥ç€è¿˜å¿…é¡»å®‰è£…é’ˆå¯¹ Rust çš„ LSPï¼ˆrust-analyzerï¼‰ã€‚é‰´äºŽå®‰è£… clangd æ—¶å‡ºçŽ°çš„æ›²æŠ˜ï¼Œæˆ‘å†³å®šæ‰‹åŠ¨å®‰è£… rust-analyzerã€‚è¯¡å¼‚çš„äº‹æƒ…å‘ç”Ÿäº†ã€‚æ‰‹åŠ¨å®‰è£…çš„å¯æ‰§è¡Œç¨‹åºä¸è¢« coc è¯†åˆ«ã€‚æ— å¥ˆä¸‹å°è¯• vim ä¸­çš„è‡ªåŠ¨å®‰è£…å±…ç„¶æˆåŠŸäº†ã€‚ã€‚ã€‚ æ–¹æ³•æ˜¯ç”¨ vim æ–°å»ºä»»æ„ä¸€ä¸ª rust æºæ–‡ä»¶ï¼ˆvim test.rsï¼‰ï¼Œvim ä¼šè‡ªåŠ¨å¼¹å‡ºæç¤ºï¼Œæ‰¾ä¸åˆ° rust-analyzerï¼Œæ˜¯å¦è‡ªåŠ¨å®‰è£…ï¼Œé€‰æ‹© Yes å³å¯ã€‚è¿™é‡Œçš„å®‰è£…è¿‡ç¨‹å±…ç„¶å¼‚ä¹Žå¯»å¸¸çš„å¿«ã€‚å®‰è£…å®ŒæˆåŽå¯èƒ½ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œä¼šå°è¯•åˆ›å»ºç´¢å¼•ã€‚å¤šæ‰“å¼€å‡ ä¸ªæ–‡ä»¶è¯•è¯•ã€‚ è‡³äºŽ Pythonï¼Œå®‰è£… coc-pyrightï¼š:CocInstall coc-pyright å°è±¡ä¸­å¹¶æ²¡æœ‰åšå…¶ä»–æ“ä½œï¼Œå¯¹äºŽ Python çš„æ”¯æŒå°±è‡ªåŠ¨ç”Ÿæ•ˆäº†ï¼Œä¹Ÿè®¸æ˜¯å®‰è£…æ‰©å±•çš„æ—¶å€™è‡ªåŠ¨å®‰è£…äº†å¯¹åº”çš„ LSPã€‚ å¯¹äºŽå…¶ä»–è¯­è¨€çš„æ”¯æŒï¼Œå¯å‚è€ƒ Using coc extensionsã€‚ coc.nvim ç¤ºä¾‹é…ç½®ï¼ˆä»Žå®˜æ–¹ Github ä¸Š copy çš„ï¼Œä¸»è¦æ˜¯ä¸€äº›å¿«æ·é”®çš„æ˜ å°„ï¼Œå¯æ ¹æ®éœ€æ±‚åˆ å‡ã€‚æ²¡ç»†çœ‹ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165" Set internal encoding of vim, not needed on neovim, since coc.nvim using some" unicode characters in the file autoload/float.vimset encoding=utf-8" TextEdit might fail if hidden is not set.set hidden" Some servers have issues with backup files, see #649.set nobackupset nowritebackup" Give more space for displaying messages.set cmdheight=2" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable" delays and poor user experience.set updatetime=300" Don't pass messages to |ins-completion-menu|.set shortmess+=c" Always show the signcolumn, otherwise it would shift the text each time" diagnostics appear/become resolved.if has("nvim-0.5.0") || has("patch-8.1.1564") " Recently vim can merge signcolumn and number column into one set signcolumn=numberelse set signcolumn=yesendif" Use tab for trigger completion with characters ahead and navigate." NOTE: Use command ':verbose imap &lt;tab&gt;' to make sure tab is not mapped by" other plugin before putting this into your config.inoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt; \ pumvisible() ? "\&lt;C-n&gt;" : \ &lt;SID&gt;check_back_space() ? "\&lt;TAB&gt;" : \ coc#refresh()inoremap &lt;expr&gt;&lt;S-TAB&gt; pumvisible() ? "\&lt;C-p&gt;" : "\&lt;C-h&gt;"function! s:check_back_space() abort let col = col('.') - 1 return !col || getline('.')[col - 1] =~# '\s'endfunction" Use &lt;c-space&gt; to trigger completion.if has('nvim') inoremap &lt;silent&gt;&lt;expr&gt; &lt;c-space&gt; coc#refresh()else inoremap &lt;silent&gt;&lt;expr&gt; &lt;c-@&gt; coc#refresh()endif" Make &lt;CR&gt; auto-select the first completion item and notify coc.nvim to" format on enter, &lt;cr&gt; could be remapped by other vim plugininoremap &lt;silent&gt;&lt;expr&gt; &lt;cr&gt; pumvisible() ? coc#_select_confirm() \: "\&lt;C-g&gt;u\&lt;CR&gt;\&lt;c-r&gt;=coc#on_enter()\&lt;CR&gt;"" Use `[g` and `]g` to navigate diagnostics" Use `:CocDiagnostics` to get all diagnostics of current buffer in location list.nmap &lt;silent&gt; [g &lt;Plug&gt;(coc-diagnostic-prev)nmap &lt;silent&gt; ]g &lt;Plug&gt;(coc-diagnostic-next)" GoTo code navigation.nmap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)nmap &lt;silent&gt; gy &lt;Plug&gt;(coc-type-definition)nmap &lt;silent&gt; gi &lt;Plug&gt;(coc-implementation)nmap &lt;silent&gt; gr &lt;Plug&gt;(coc-references)" Use K to show documentation in preview window.nnoremap &lt;silent&gt; K :call &lt;SID&gt;show_documentation()&lt;CR&gt;function! s:show_documentation() if (index(['vim','help'], &amp;filetype) &gt;= 0) execute 'h '.expand('&lt;cword&gt;') elseif (coc#rpc#ready()) call CocActionAsync('doHover') else execute '!' . &amp;keywordprg . " " . expand('&lt;cword&gt;') endifendfunction" Highlight the symbol and its references when holding the cursor.autocmd CursorHold * silent call CocActionAsync('highlight')" Symbol renaming.nmap &lt;leader&gt;rn &lt;Plug&gt;(coc-rename)" Formatting selected code.xmap &lt;leader&gt;f &lt;Plug&gt;(coc-format-selected)nmap &lt;leader&gt;f &lt;Plug&gt;(coc-format-selected)augroup mygroup autocmd! " Setup formatexpr specified filetype(s). autocmd FileType typescript,json setl formatexpr=CocAction('formatSelected') " Update signature help on jump placeholder. autocmd User CocJumpPlaceholder call CocActionAsync('showSignatureHelp')augroup end" Applying codeAction to the selected region." Example: `&lt;leader&gt;aap` for current paragraphxmap &lt;leader&gt;a &lt;Plug&gt;(coc-codeaction-selected)nmap &lt;leader&gt;a &lt;Plug&gt;(coc-codeaction-selected)" Remap keys for applying codeAction to the current buffer.nmap &lt;leader&gt;ac &lt;Plug&gt;(coc-codeaction)" Apply AutoFix to problem on the current line.nmap &lt;leader&gt;qf &lt;Plug&gt;(coc-fix-current)" Map function and class text objects" NOTE: Requires 'textDocument.documentSymbol' support from the language server.xmap if &lt;Plug&gt;(coc-funcobj-i)omap if &lt;Plug&gt;(coc-funcobj-i)xmap af &lt;Plug&gt;(coc-funcobj-a)omap af &lt;Plug&gt;(coc-funcobj-a)xmap ic &lt;Plug&gt;(coc-classobj-i)omap ic &lt;Plug&gt;(coc-classobj-i)xmap ac &lt;Plug&gt;(coc-classobj-a)omap ac &lt;Plug&gt;(coc-classobj-a)" Remap &lt;C-f&gt; and &lt;C-b&gt; for scroll float windows/popups.if has('nvim-0.4.0') || has('patch-8.2.0750') nnoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-f&gt; coc#float#has_scroll() ? coc#float#scroll(1) : "\&lt;C-f&gt;" nnoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-b&gt; coc#float#has_scroll() ? coc#float#scroll(0) : "\&lt;C-b&gt;" inoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-f&gt; coc#float#has_scroll() ? "\&lt;c-r&gt;=coc#float#scroll(1)\&lt;cr&gt;" : "\&lt;Right&gt;" inoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-b&gt; coc#float#has_scroll() ? "\&lt;c-r&gt;=coc#float#scroll(0)\&lt;cr&gt;" : "\&lt;Left&gt;" vnoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-f&gt; coc#float#has_scroll() ? coc#float#scroll(1) : "\&lt;C-f&gt;" vnoremap &lt;silent&gt;&lt;nowait&gt;&lt;expr&gt; &lt;C-b&gt; coc#float#has_scroll() ? coc#float#scroll(0) : "\&lt;C-b&gt;"endif" Use CTRL-S for selections ranges." Requires 'textDocument/selectionRange' support of language server.nmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)xmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)" Add `:Format` command to format current buffer.command! -nargs=0 Format :call CocAction('format')" Add `:Fold` command to fold current buffer.command! -nargs=? Fold :call CocAction('fold', &lt;f-args&gt;)" Add `:OR` command for organize imports of the current buffer.command! -nargs=0 OR :call CocAction('runCommand', 'editor.action.organizeImport')" Add (Neo)Vim's native statusline support." NOTE: Please see `:h coc-status` for integrations with external plugins that" provide custom statusline: lightline.vim, vim-airline.set statusline^=%&#123;coc#status()&#125;%&#123;get(b:,'coc_current_function','')&#125;" Mappings for CoCList" Show all diagnostics.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;a :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;" Manage extensions.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;e :&lt;C-u&gt;CocList extensions&lt;cr&gt;" Show commands.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;c :&lt;C-u&gt;CocList commands&lt;cr&gt;" Find symbol of current document.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;o :&lt;C-u&gt;CocList outline&lt;cr&gt;" Search workspace symbols.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;s :&lt;C-u&gt;CocList -I symbols&lt;cr&gt;" Do default action for next item.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;j :&lt;C-u&gt;CocNext&lt;CR&gt;" Do default action for previous item.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;k :&lt;C-u&gt;CocPrev&lt;CR&gt;" Resume latest coc list.nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;p :&lt;C-u&gt;CocListResume&lt;CR&gt; äº”ã€å½©è›‹smileåœ¨ vim ä¸­è¿è¡Œ :smile æ•ˆæžœï¼š 123456789101112131415161718192021222324252627:smile oooo$$$$$$$$$$$$oooo oo$$$$$$$$$$$$$$$$$$$$$$$$o oo$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$o o$ $$ o$ o $ oo o$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$o $$ $$ $$o$ oo $ $ &quot;$ o$$$$$$$$$ $$$$$$$$$$$$$ $$$$$$$$$o $$$o$$o$ &quot;$$$$$$o$ o$$$$$$$$$ $$$$$$$$$$$ $$$$$$$$$$o $$$$$$$$ $$$$$$$ $$$$$$$$$$$ $$$$$$$$$$$ $$$$$$$$$$$$$$$$$$$$$$$ $$$$$$$$$$$$$$$$$$$$$$$ $$$$$$$$$$$$$ $$$$$$$$$$$$$$ &quot;&quot;&quot;$$$ &quot;$$$&quot;&quot;&quot;&quot;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ &quot;$$$ $$$ o$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ &quot;$$$o o$$&quot; $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ $$$o $$$ $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&quot; &quot;$$$$$$ooooo$$$$o o$$$oooo$$$$$ $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ o$$$$$$$$$$$$$$$$$ $$$$$$$$&quot;$$$$ $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ $$$$&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot; &quot;&quot;&quot;&quot; $$$$ &quot;$$$$$$$$$$$$$$$$$$$$$$$$$$$$&quot; o$$$ &quot;$$$o &quot;&quot;&quot;$$$$$$$$$$$$$$$$$$&quot;$$&quot; $$$ $$$o &quot;$$&quot;&quot;$$$$$$&quot;&quot;&quot;&quot; o$$$ $$$$o o$$$&quot; &quot;$$$$o o$$$$$$o&quot;$$$$o o$$$$ &quot;$$$$$oo &quot;&quot;$$$$o$$$$$o o$$$$&quot;&quot; &quot;&quot;$$$$$oooo &quot;$$$o$$$$$$$$$&quot;&quot;&quot; &quot;&quot;$$$$$$$oo $$$$$$$$$$ &quot;&quot;&quot;&quot;$$$$$$$$$$$ $$$$$$$$$$$$ $$$$$$$$$$&quot; &quot;$$$&quot;&quot;&quot;&quot; Kill Sheep å°æ¸¸æˆé’ˆå¯¹ vim 8.2 ç‰ˆæœ¬ï¼Œå¯åœ¨ Windows ç³»ç»Ÿä¸­å®‰è£… gvim 8.2ã€‚ è¿›å…¥ C:\Users\xxx\vimfiles\pack\vendor\start è·¯å¾„ä¸‹ï¼ˆæ²¡æœ‰å°±åˆ›å»ºï¼‰ï¼Œclone æºä»£ç ï¼šgit clone https://github.com/vim/killersheep.git æ‰“å¼€ gvimï¼Œæœ€å¤§åŒ–ï¼Œè¿è¡Œ :KillKillKill å‘½ä»¤å³å¯è¿›å…¥æ¸¸æˆã€‚]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Configuration</tag>
        <tag>Editor</tag>
        <tag>Rust</tag>
        <tag>Vim</tag>
        <tag>IDE</tag>
        <tag>Completer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows Terminal ç¾ŽåŒ–ï¼ˆwsl2ã€zshã€å¤©æ°”ã€æ•°å­—æ—¶é’Ÿã€ASCII Logoã€å½©è‰²åŠ¨ç”»ï¼‰]]></title>
    <url>%2F2021%2F05%2F26%2Fwindows-terminal-beautify-wsl2-weather-digital-clock-splash-animation%2F</url>
    <content type="text"><![CDATA[ä¸Šæ¬¡ç”¨ WSLï¼ˆWindows Subsystem for Linuxï¼‰è¦è¿½æº¯åˆ°å¥½å‡ å¹´å‰äº†ã€‚å½“æ—¶ WSL åˆšå‡ºæ¥ä¸ä¹…ï¼ŒæŠ±ç€å°é²œçš„æ€åº¦è¯•ç€è£…äº†ï¼Œæƒ³ç€ä¸‡ä¸€èƒ½ç”¨ï¼Œå°±ä¸ç”¨è£…è™šæ‹Ÿæœºäº†ã€‚ ç»“æžœé‡åˆ°äº† BUGï¼Œå°±å†ä¹Ÿæ²¡ç”¨è¿‡ã€‚æœ€è¿‘æ‰å¬è¯´ WSL2 å·²ç»æœ‰äº†ï¼Œç±»ä¼¼è™šæ‹Ÿæœºçš„æœºåˆ¶ï¼Œå¥½ç”¨å¾ˆå¤šã€‚å†æ¬¡è£…æ¥è¯•è¯•ï¼Œç›®å‰è¿˜æ²¡é‡åˆ°å•¥é—®é¢˜ã€‚è®°å½•ä¸‹åˆå§‹çš„ç¾ŽåŒ–æ­¥éª¤ã€‚ ä¸€ã€æ•ˆæžœæˆªå›¾å¤©æ°”ã€æ—¥åŽ†ã€æ•°å­—æ—¶é’Ÿã€Linux å‘è¡Œç‰ˆçš„ logoã€ç³»ç»Ÿä¿¡æ¯ 123456789101112131415161718192021222324252627282930Weather report: Hangzhou May 2021 Su Mo Tu We Th Fr Sa â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” _`/&quot;&quot;.-. Rain shower, mist 1 â”‚ â”â”â”“â”â”â”“ â”â”â”“â”â”â”“ â”â”â”“â”â”³â”“ â”‚ ,\_( ). 21 Â°C 2 3 4 5 6 7 8 â”‚ â”ƒâ”ƒâ”ƒâ”£â”â”“â•¹â”ƒâ”ƒâ”ƒâ”£â”â”“ â”£â”â”›â”ƒâ”ƒâ”ƒ â”‚ /(___(__) â†“ 15 km/h 9 10 11 12 13 14 15 â”‚ â”—â”â”›â”—â”â”›â•¹â”—â”â”›â”—â”â”› â•¹ â•¹ â•¹ â”‚ â€˜ â€˜ â€˜ â€˜ 3 km 16 17 18 19 20 21 22 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â€˜ â€˜ â€˜ â€˜ 0.8 mm 23 24 25 26 27 28 29 30 31 _-`````-, ,- &apos;- . starky@xxxxxx .&apos; .- - | | - -. `. ---------------- /.&apos; / `. \ OS: Ubuntu 20.04.2 LTS on Windows 10 x86_64:/ : _... ..._ `` : Kernel: 5.4.72-microsoft-standard-WSL2:: : /._ .`:&apos;_.._\. || : Uptime: 38 mins:: `._ ./ ,` : \ . _.&apos;&apos; . Packages: 736 (dpkg)`:. / | -. \-. \_ / Shell: zsh 5.8 \:._ _/ .&apos; .@) \@) ` `\ ,.&apos; Terminal: /dev/pts/0 _/,--&apos; .- .\,-.`--`. CPU: Intel i7-10850H (12) @ 2.712GHz ,&apos;/&apos;&apos; (( \ ` ) Memory: 118MiB / 12466MiB (0%) /&apos;/&apos; \ `-&apos; ( CPU Usage: 1% &apos;/&apos;&apos; `._,-----&apos; Disk (/): 3.3G / 251G (2%) &apos;&apos;/&apos; .,---&apos; Battery1: 100% [Full] &apos;&apos;/&apos; ;: Local IP: xx.xx.xx.xx &apos;&apos;/&apos;&apos; &apos;&apos;/ Public IP: xx.xx.xx.xx &apos;&apos;/&apos;&apos;/&apos;&apos; &apos;/&apos;/&apos; `;GNU å¯åŠ¨åŠ¨ç”» åŠ¨å›¾ï¼ˆåŠ è½½æ…¢ï¼‰ äºŒã€å®‰è£… WSL2 å’Œ Windows Terminalå‚è€ƒå¾®è½¯å®˜æ–¹æ–‡æ¡£ Windows Subsystem for Linux Installation Guide for Windows 10 å¾ˆè¯¦ç»†ï¼Œä¸ç”¨å†çœ‹å…¶ä»–æ–‡ç« äº†ã€‚ ä¸‰ã€oh-my-zshè¿›å…¥ wslï¼Œå®‰è£… zshï¼šsudo apt updatesudo apt install zsh -y å®‰è£… oh-my-zshï¼šsh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot; å®‰è£… Powerline9k ä¸»é¢˜ï¼šgit clone https://github.com/bhilburn/powerlevel9k.git ~/.oh-my-zsh/custom/themes/powerlevel9k å¯ç”¨ Powerline9k ä¸»é¢˜ï¼šç¼–è¾‘ ~/.zshrc é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ ZSH_THEME é¡¹çš„å†…å®¹ä¸º ZSH_THEME=&quot;powerlevel9k/powerlevel9k&quot; å®‰è£…å­—ä½“ï¼šè®¿é—® nerd-fonts çš„ Github release é¡µï¼Œä¸‹è½½æŸç§å­—ä½“çš„åŽ‹ç¼©åŒ…ï¼ˆå¦‚ JetBrainsMono.zipï¼‰ï¼Œè§£åŽ‹åŽåœ¨ Windows ç³»ç»Ÿä¸Šå®‰è£…å­—ä½“æ–‡ä»¶ï¼ˆæœ‰äº›æ—¶å€™å¯èƒ½éœ€è¦ä½¿ç”¨ç®¡ç†å‘˜æƒé™å®‰è£…ï¼‰ ä¿®æ”¹ Windows Terminal çš„é»˜è®¤å­—ä½“ï¼š å››ã€oh-my-zh æ’ä»¶å®‰è£… zsh-autosuggestionsï¼šgit clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions å®‰è£… zsh-syntax-highlightingï¼šgit clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting å¯ç”¨æ’ä»¶ï¼ˆåŒ…å«é»˜è®¤æ’ä»¶ï¼‰ï¼šä¿®æ”¹ ~/.zshrc é…ç½®æ–‡ä»¶çš„ plugins é¡¹ï¼Œå†…å®¹å¦‚ä¸‹ï¼ˆå¯æŒ‰éœ€æ·»åŠ æˆ–åˆ å‡ï¼‰123456789101112131415plugins=( cargo command-not-found docker git golang npm nvm rust sudo systemd web-search zsh-autosuggestions zsh-syntax-highlighting) æ’ä»¶å®‰è£…å®ŒæˆåŽï¼Œå¦‚ä¸Šå›¾ä¸­çš„æƒ…å†µï¼Œç›´æŽ¥æŒ‰é”®ç›˜ä¸Šçš„å³æ–¹å‘é”®å³å¯è‡ªåŠ¨è¡¥å…¨å‘½ä»¤ã€‚ äº”ã€neofetch èŽ·å– Linux å‘è¡Œç‰ˆ ASCII logo å’Œç³»ç»Ÿä¿¡æ¯å®‰è£… neofetchï¼šsudo apt install neofetch æ•ˆæžœå¦‚ä¸‹ï¼š123456789101112131415161718192021222324$ neofetch --ascii_distro raspbian `.::///+:/-. --///+//-:`` starky@xxxxxx `+oooooooooooo: `+oooooooooooo: ---------------- /oooo++//ooooo: ooooo+//+ooooo. OS: Ubuntu 20.04.2 LTS on Windows 10 x86_64 `+ooooooo:-:oo- +o+::/ooooooo: Kernel: 5.4.72-microsoft-standard-WSL2 `:oooooooo+`` `.oooooooo+- Uptime: 11 mins `:++ooo/. :+ooo+/.` Packages: 736 (dpkg) ...` `.----.` ``.. Shell: zsh 5.8 .::::-``:::::::::.`-:::-` Terminal: /dev/pts/0 -:::-` .:::::::-` `-:::- CPU: Intel i7-10850H (12) @ 2.712GHz `::. `.--.` `` `.---.``.::` Memory: 107MiB / 12466MiB (0%) .::::::::` -::::::::` ` CPU Usage: 0% .::` .:::::::::- `::::::::::``::. Disk (/): 3.3G / 251G (2%)-:::` ::::::::::. ::::::::::.`:::- Battery1: 100% [Full]:::: -::::::::. `-:::::::: :::: Local IP: xx.xx.xx.xx-::- .-:::-.``....``.-::-. -::- Public IP: xx.xx.xx.xx .. `` .::::::::. `..`.. -:::-` -::::::::::` .:::::` :::::::` -::::::::::` :::::::. .::::::: -::::::::. :::::::: `-:::::` ..--.` ::::::. `...` `...--..` `...` .:::::::::: `.-::::-` neofetch é»˜è®¤ä¼šè¾“å‡ºå½“å‰ç³»ç»Ÿçš„ logoï¼Œè¿™é‡Œå†™ä¸ªè„šæœ¬ï¼ˆrandom_distro.shï¼‰éšæœºèŽ·å–æŸä¸ª Linux å‘è¡Œç‰ˆçš„ logoã€‚12345678# random_distro.shdistro_list=('Alpine' 'Anarchy' 'Android' 'Antergos' 'antiX' 'AOSC' 'ArcoLinux' 'ArchBox' 'ARCHlabs' 'ArchStrike' 'XFerience' 'ArchMerge' 'Arch' 'Artix' 'Arya' 'Bedrock' 'BlackArch' 'BLAG' 'BlankOn' 'BlueLight' 'bonsai' 'BSD' 'BunsenLabs' 'Calculate' 'Carbs' 'CentOS' 'Chakra' 'Chapeau' 'Chrom' 'Cleanjaro' 'ClearOS' 'Clear_Linux' 'Clover' 'Condres' 'Container_Linux' 'CRUX' 'Debian' 'Deepin' 'DesaOS' 'Devuan' 'DracOS' 'DragonFly' 'Drauger' 'Elementary' 'EndeavourOS' 'Endless' 'Exherbo' 'Fedora' 'Feren' 'FreeBSD' 'FreeMiNT' 'Frugalware' 'Funtoo' 'GalliumOS' 'Gentoo' 'Pentoo' 'GNU' 'GoboLinux' 'Grombyang' 'Guix' 'Haiku' 'Huayra' 'Hyperbola' 'janus' 'Kali' 'KaOS' 'KDE_neon' 'Kogaion' 'Korora' 'KSLinux' 'Kubuntu' 'LEDE' 'LFS' 'Linux_Lite' 'LMDE' 'Lubuntu' 'Lunar' 'macos' 'Mageia' 'Mandriva' 'Manjaro' 'Maui' 'Mer' 'Minix' 'LinuxMint' 'MX_Linux' 'Namib' 'Neptune' 'NetBSD' 'Netrunner' 'NixOS' 'Nurunner' 'NuTyX' 'OBRevenge' 'OpenBSD' 'OpenIndiana' 'OpenMandriva' 'OpenWrt' 'osmc' 'Oracle' 'Parabola' 'Pardus' 'Parrot' 'Parsix' 'TrueOS' 'PCLinuxOS' 'Peppermint' 'popos' 'Porteus' 'PostMarketOS' 'Puppy' 'PureOS' 'Qubes' 'Radix' 'Raspbian' 'Reborn_OS' 'Redstar' 'Redcore' 'Redhat' 'Refracted_Devuan' 'Rosa' 'sabotage' 'Sabayon' 'Sailfish' 'SalentOS' 'Scientific' 'Septor' 'SharkLinux' 'Siduction' 'SliTaz' 'SmartOS' 'Solus' 'Source_Mage' 'Sparky' 'Star' 'SteamOS' 'SunOS' 'openSUSE_Leap' 'openSUSE' 'SwagArch' 'Tails' 'Trisquel' 'Ubuntu-Budgie' 'Ubuntu-GNOME' 'Ubuntu-MATE' 'Ubuntu-Studio' 'Void' 'Obarun' 'windows10' 'Windows7' 'Xubuntu')length=$&#123;#distro_list[@]&#125;distro=$&#123;distro_list[$RANDOM % $length]&#125;neofetch --ascii_distro $distro è¿è¡Œ bash random_distro.sh å³å¯èŽ·å–éšæœºçš„ Linux å‘è¡Œç‰ˆ logoã€‚ ä¸ºäº†ä½¿è¯¥è„šæœ¬å¯ä»¥åœ¨ Terminal å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥æ·»åŠ å¦‚ä¸‹ä¸€æ¡å‘½ä»¤åˆ° ~/.zshrc é…ç½®æ–‡ä»¶æœ«å°¾ï¼šbash /path/to/random_distro.sh å…­ã€Shell è„šæœ¬æ˜¾ç¤ºå¤©æ°”å’Œæ•°å­—æ—¶é’Ÿweather-clock.sh è„šæœ¬ä»Žç½‘ä¸Šæ‰¾çš„ï¼Œæ²¡åšæ”¹åŠ¨ï¼ˆå‚è€ƒæ–‡ç«  Terminal splash screen with Weather, Calendar, Time &amp; Sysinfo?ï¼‰ã€‚ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136#!/bin/bash# NAME: now# PATH: $HOME/bin# DESC: Display current weather, calendar and time# CALL: Called from terminal or ~/.bashrc# DATE: Apr 6, 2017. Modified: May 24, 2019.# UPDT: 2019-05-24 If Weather unavailable nicely formatted error message.# NOTE: To display all available toilet fonts use this one-liner:# for i in $&#123;TOILET_FONT_PATH:=/usr/share/figlet&#125;/*.&#123;t,f&#125;lf; do j=$&#123;i##*/&#125;; toilet -d "$&#123;i%/*&#125;" -f "$j" "$&#123;j%.*&#125;"; done# Setup for 92 character wide terminalDateColumn=34 # Default is 27 for 80 character line, 34 for 92 character lineTimeColumn=61 # Default is 49 for " " " " 61 " " " "# Replace Edmonton with your city name, GPS, etc. See: curl wttr.in/:helpcurl wttr.in/Hangzhou?0 --silent --max-time 3 &gt; /tmp/now-weather# Timeout #. Increase for slow connection---^readarray aWeather &lt; /tmp/now-weatherrm -f /tmp/now-weather# Was valid weather report found or an error message?if [[ "$&#123;aWeather[0]&#125;" == "Weather report:"* ]] ; then WeatherSuccess=true echo "$&#123;aWeather[@]&#125;"else WeatherSuccess=false echo "+============================+" echo "| Weather unavailable now!!! |" echo "| Check reason with command: |" echo "| |" echo "| curl wttr.in/Edmonton?0 |" # Replace Edmonton with your city echo "| --silent --max-time 3 |" echo "+============================+" echo " "fiecho " " # Pad blank lines for calendar &amp; time to fit#--------- DATE -------------------------------------------------------------# calendar current month with today highlighted.# colors 00=bright white, 31=red, 32=green, 33=yellow, 34=blue, 35=purple,# 36=cyan, 37=whitetput sc # Save cursor position.# Move up 9 linesi=0while [ $((++i)) -lt 10 ]; do tput cuu1; doneif [[ "$WeatherSuccess" == true ]] ; then # Depending on length of your city name and country name you will: # 1. Comment out next three lines of code. Uncomment fourth code line. # 2. Change subtraction value and set number of print spaces to match # subtraction value. Then place comment on fourth code line. Column=$((DateColumn - 10)) tput cuf $Column # Move x column number # Blank out ", country" with x spaces printf " "else tput cuf $DateColumn # Position to column 27 for date displayfi# -h needed to turn off formating: https://askubuntu.com/questions/1013954/bash-substring-stringoffsetlength-error/1013960#1013960cal &gt; /tmp/terminal1# -h not supported in Ubuntu 18.04. Use second answer: https://askubuntu.com/a/1028566/307523tr -cd '\11\12\15\40\60-\136\140-\176' &lt; /tmp/terminal1 &gt; /tmp/terminalCalLineCnt=1Today=$(date +"%e")printf "\033[32m" # color green -- see list above.while IFS= read -r Cal; do printf "%s" "$Cal" if [[ $CalLineCnt -gt 2 ]] ; then # See if today is on current line &amp; invert background tput cub 22 for (( j=0 ; j &lt;= 18 ; j += 3 )) ; do Test=$&#123;Cal:$j:2&#125; # Current day on calendar line if [[ "$Test" == "$Today" ]] ; then printf "\033[7m" # Reverse: [ 7 m printf "%s" "$Today" printf "\033[0m" # Normal: [ 0 m printf "\033[32m" # color green -- see list above. tput cuf 1 else tput cuf 3 fi done fi tput cud1 # Down one line tput cuf $DateColumn # Move 27 columns right CalLineCnt=$((++CalLineCnt))done &lt; /tmp/terminalprintf "\033[00m" # color -- bright white (default)echo ""tput rc # Restore saved cursor position.#-------- TIME --------------------------------------------------------------tput sc # Save cursor position.# Move up 8 linesi=0while [ $((++i)) -lt 9 ]; do tput cuu1; donetput cuf $TimeColumn # Move 49 columns right# Do we have the toilet package?if hash toilet 2&gt;/dev/null; then echo " $(date +"%I:%M %P") " | \ toilet -f future --filter border &gt; /tmp/terminal# Do we have the figlet package?elif hash figlet 2&gt;/dev/null; then# echo $(date +"%I:%M %P") | figlet &gt; /tmp/terminal date +"%I:%M %P" | figlet &gt; /tmp/terminal# else use standard fontelse# echo $(date +"%I:%M %P") &gt; /tmp/terminal date +"%I:%M %P" &gt; /tmp/terminalfiwhile IFS= read -r Time; do printf "\033[01;36m" # color cyan printf "%s" "$Time" tput cud1 # Up one line tput cuf $TimeColumn # Move 49 columns rightdone &lt; /tmp/terminaltput rc # Restore saved cursor position.exit 0 è¿è¡Œæ•ˆæžœï¼š123456789$ bash weather-clock.shWeather report: Hangzhou May 2021 Su Mo Tu We Th Fr Sa â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” _`/&quot;&quot;.-. Rain shower, mist 1 â”‚ â”â”â”“â”â”â”“ â”â”â”“â”â”â”“ â”â”â”“â”â”³â”“ â”‚ ,\_( ). 21 Â°C 2 3 4 5 6 7 8 â”‚ â”ƒâ”ƒâ”ƒâ”£â”â”“â•¹â”ƒâ”ƒâ”ƒâ”—â”â”« â”£â”â”›â”ƒâ”ƒâ”ƒ â”‚ /(___(__) â†“ 15 km/h 9 10 11 12 13 14 15 â”‚ â”—â”â”›â”—â”â”›â•¹â”—â”â”›â”—â”â”› â•¹ â•¹ â•¹ â”‚ â€˜ â€˜ â€˜ â€˜ 3 km 16 17 18 19 20 21 22 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â€˜ â€˜ â€˜ â€˜ 0.8 mm 23 24 25 26 27 28 29 30 31 å…¶ä¸­èŽ·å–å¤©æ°”çš„å…³é”®ä»£ç ä¸º curl wttr.in/Hangzhou?0 --silent --max-time 3ï¼Œå¯è‡ªè¡Œæ”¹ä¸ºè‡ªå·±æ‰€åœ¨çš„åŸŽå¸‚ã€‚ åŒæ ·ï¼Œä¸ºäº†ä½¿ Terminal åœ¨å¯åŠ¨æ—¶èƒ½è‡ªåŠ¨è¿è¡Œè¯¥è„šæœ¬ï¼Œåœ¨ ~/.zshrc é…ç½®æ–‡ä»¶çš„æœ«å°¾ï¼ˆrandom-distro.sh ä¸Šé¢ä¸€è¡Œï¼‰æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šbash /path/to/weather-clock.sh PSï¼šæ•°å­—æ—¶é’Ÿçš„æ­£å¸¸æ˜¾ç¤ºéœ€è¦ä¾èµ– toilet è½¯ä»¶ã€‚å®‰è£… toiletï¼šsudo apt install toilet ä¸ƒã€pipe.sh ç”Ÿæˆ Terminal å¯åŠ¨åŠ¨ç”»èŽ·å– pipe.sh ç¨‹åºï¼šgit clone https://github.com/pipeseroni/pipes.sh.git æå–é¡¹ç›®ä¸­çš„ pipes.sh/pipes.sh æºæ–‡ä»¶åˆ°ä»»æ„è·¯å¾„ä¸‹ã€‚ä¸ºäº†ä½¿ Terminal åœ¨å¯åŠ¨æ—¶èƒ½è‡ªåŠ¨è¿è¡Œè¯¥è„šæœ¬ï¼Œåœ¨ ~/.zshrc é…ç½®æ–‡ä»¶çš„æœ«å°¾ï¼ˆweather-clock.sh ä¸Šé¢ä¸€è¡Œï¼‰æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šbash /path/to/pipes.sh -p 5 è¿è¡Œæ•ˆæžœï¼š æŒ‰ä¸‹ç©ºæ ¼é”®å¯ç»ˆæ­¢åŠ¨ç”»ã€‚ GIF ç‰ˆæœ¬ï¼š]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Shell</tag>
        <tag>Terminal</tag>
        <tag>Zsh</tag>
        <tag>Beautify</tag>
        <tag>Neofetch</tag>
        <tag>Ascii Art</tag>
        <tag>Weather</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Miniconda å’Œ poetry æ­å»º Python å¼€å‘çŽ¯å¢ƒï¼ˆæ”¯æŒå¤šç‰ˆæœ¬ã€ä¾èµ–ç®¡ç†ï¼‰]]></title>
    <url>%2F2021%2F05%2F19%2Fbuild-python-development-environment-with-miniconda-and-poetry%2F</url>
    <content type="text"><![CDATA[åŸºäºŽè‡ªå·±çš„æ—¥å¸¸ä¹ æƒ¯æµ‹è¯•æ•´ç†ï¼Œé€šè¿‡ Windows ç³»ç»Ÿæ¼”ç¤ºï¼ˆLinux ç³»ç»Ÿæ“ä½œæ­¥éª¤å¤§åŒå°å¼‚ï¼‰ã€‚Miniconda ç”¨æ¥æä¾› conda å‘½ä»¤ç®¡ç†å¤šä¸ª Python ç‰ˆæœ¬ï¼ˆå¦‚ Python 3.8ã€Python 3.9ï¼‰ï¼›poetry åˆ™ç”¨æ¥åˆ›å»ºåŸºäºŽé¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒï¼Œç»´æŠ¤å¯¹åº”çš„åŒ…ä¾èµ–å…³ç³»ã€‚ ä¸€ã€æ•ˆæžœæ¼”ç¤ºconda å‘½ä»¤æŸ¥çœ‹å®‰è£…çš„ Python ç‰ˆæœ¬ï¼š123456C:\Users\Administrator&gt;conda env list# conda environments:#base * C:\Users\xniu\Miniconda3python2.7.18 C:\Users\xniu\Miniconda3\envs\python2.7.18python3.9.4 C:\Users\xniu\Miniconda3\envs\python3.9.4 poetry æŸ¥çœ‹æŸä¸ªé¡¹ç›®çš„åŒ…ä¾èµ–å…³ç³»ï¼š12345678910111213141516(python3.9.4) C:\Users\Administrator\projects\auto-test&gt;poetry showcertifi 2020.12.5 Python package for providing Mozilla&apos;s CA Bundle.chardet 4.0.0 Universal encoding detector for Python 2 and 3idna 2.10 Internationalized Domain Names in Applications (IDNA)requests 2.25.1 Python HTTP for Humans.selenium 3.141.0 Python bindings for Seleniumurllib3 1.26.4 HTTP library with thread-safe connection pooling, file post, and more.(python3.9.4) C:\Users\Administrator\projects\auto-test&gt;poetry show -trequests 2.25.1 Python HTTP for Humans.|-- certifi &gt;=2017.4.17|-- chardet &gt;=3.0.2,&lt;5|-- idna &gt;=2.5,&lt;3`-- urllib3 &gt;=1.21.1,&lt;1.27selenium 3.141.0 Python bindings for Selenium`-- urllib3 * äºŒã€å®‰è£… MinicondaMiniconda è½¯ä»¶æä¾›äº† conda å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºåŸºäºŽä¸åŒ Python ç‰ˆæœ¬çš„è™šæ‹ŸçŽ¯å¢ƒã€‚ è®¿é—® Miniconda å®˜ç½‘ï¼Œä¸‹è½½å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…åŒ…å¹¶å®‰è£…ã€‚ å®‰è£…å®ŒæˆåŽï¼Œæ·»åŠ  conda å‘½ä»¤çš„è·¯å¾„ï¼ˆå®‰è£…ç›®å½•ä¸‹çš„ Scripts ç›®å½•ï¼‰åˆ° PATH çŽ¯å¢ƒå˜é‡ã€‚å…¶è·¯å¾„ä¸€èˆ¬ä¸º C:\Users\xxx\Miniconda3\Scripts\ã€‚ æ·»åŠ å®ŒæˆåŽï¼Œæ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤æç¤ºç¬¦ï¼Œè¿è¡Œ conda å‘½ä»¤çœ‹æ˜¯å¦æœ‰ååº”ã€‚ åˆ›å»ºåŸºäºŽä¸åŒ Python ç‰ˆæœ¬çš„è™šæ‹ŸçŽ¯å¢ƒconda create -n python3.9.4 python=3.9.4ä¸Šè¿°å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Python è™šæ‹ŸçŽ¯å¢ƒï¼Œå¹¶å®‰è£… Python 3.9.4ã€‚ å…¶ä¸­ -n é€‰é¡¹ç”¨äºŽæŒ‡å®šè¯¥è™šæ‹ŸçŽ¯å¢ƒçš„åç§°ï¼Œæ–¹ä¾¿åŽç»­é€šè¿‡ conda activate xxx å¯ç”¨è¯¥è™šæ‹ŸçŽ¯å¢ƒï¼›python=3.9.4 å‘½ä»¤ç”¨äºŽå®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Python ç¨‹åºã€‚ è™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºæˆåŠŸåŽï¼Œå³å¯ä½¿ç”¨ conda activate python3.9.4 å‘½ä»¤å¯ç”¨è¯¥è™šæ‹ŸçŽ¯å¢ƒã€‚æ­¤åŽåœ¨è¯¥å‘½ä»¤æç¤ºç¬¦çŽ¯å¢ƒä¸‹ä»»ä½• python å‘½ä»¤éƒ½ä¼šè‡ªåŠ¨ä½¿ç”¨ Python3.9.4 æ‰§è¡Œã€‚ conda env list å‘½ä»¤å¯ä»¥æŸ¥çœ‹çŽ°æœ‰çš„ Python è™šæ‹ŸçŽ¯å¢ƒã€‚ PSï¼šæ›´å¤š conda å‘½ä»¤å¯å‚è€ƒ Command referenceã€‚ ä¸‰ã€å®‰è£… poetrypoetry çš„å®‰è£…å¯å‚è€ƒ poetry å®˜æ–¹æ–‡æ¡£ã€‚å¯¹äºŽ Windows ç³»ç»Ÿå¯ç›´æŽ¥æ‰“å¼€ä¸€ä¸ª PowerShell çª—å£ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š(Invoke-WebRequest -Uri https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py -UseBasicParsing).Content | python - å®‰è£…æˆåŠŸåŽï¼Œpoetry å‘½ä»¤ä¼šè‡ªåŠ¨æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡ä¸­ã€‚ åˆ›å»ºåŸºäºŽé¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒæ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤æç¤ºç¬¦ï¼Œä½¿ç”¨ conda activate python3.9.4 å‘½ä»¤æ¿€æ´»æŸä¸ª Python ç‰ˆæœ¬ã€‚ è¿›å…¥åˆ°é¡¹ç›®è·¯å¾„ä¸‹ï¼Œè¿è¡Œ poetry init å‘½ä»¤åˆå§‹åŒ–é…ç½®ã€‚1234567891011121314151617181920212223242526272829303132(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry initThis command will guide you through creating your pyproject.toml config.Package name [test-poetry]:Version [0.1.0]:Description []:Author [None, n to skip]: nLicense []:Compatible Python versions [^3.9]:Would you like to define your main dependencies interactively? (yes/no) [yes] noWould you like to define your development dependencies interactively? (yes/no) [yes] noGenerated file[tool.poetry]name = &quot;test-poetry&quot;version = &quot;0.1.0&quot;description = &quot;&quot;authors = [&quot;Your Name &lt;you@example.com&gt;&quot;][tool.poetry.dependencies]python = &quot;^3.9&quot;[tool.poetry.dev-dependencies][build-system]requires = [&quot;poetry-core&gt;=1.0.0&quot;]build-backend = &quot;poetry.core.masonry.api&quot;Do you confirm generation? (yes/no) [yes] yes ä¸Šè¿°æ“ä½œä¼šåœ¨é¡¹ç›®ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»º pyproject.toml é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011121314[tool.poetry]name = "test-poetry"version = "0.1.0"description = ""authors = ["Your Name &lt;you@example.com&gt;"][tool.poetry.dependencies]python = "^3.9"[tool.poetry.dev-dependencies][build-system]requires = ["poetry-core&gt;=1.0.0"]build-backend = "poetry.core.masonry.api" ä½¿ç”¨ poetry shell å‘½ä»¤è‡ªåŠ¨åˆ›å»ºåŸºäºŽå½“å‰é¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒå¹¶æ¿€æ´»è¯¥çŽ¯å¢ƒï¼š12345(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry shellCreating virtualenv test-poetry-thSlgjIV-py3.9 in C:\Users\Administrator\AppData\Local\pypoetry\Cache\virtualenvsSpawning shell within C:\Users\Administrator\AppData\Local\pypoetry\Cache\virtualenvs\test-poetry-thSlgjIV-py3.9Microsoft Windows [Version 10.0.18363.1316](c) 2019 Microsoft Corporation. All rights reserved. è¿è¡Œ code . å‘½ä»¤ä½¿ç”¨ VSCode è½¯ä»¶æ‰“å¼€æœ¬é¡¹ç›®ï¼Œæ­¤æ—¶å³å¯åœ¨ IDE ä¸­åˆ‡æ¢åˆ°æ–°åˆ›å»ºçš„åŸºäºŽæœ¬é¡¹ç›®çš„è™šæ‹ŸçŽ¯å¢ƒï¼ˆVSCode å·²ç»å®‰è£…äº† Python æ’ä»¶ï¼‰ã€‚ å®‰è£…ä¾èµ–åŒ…poetry add xxx å‘½ä»¤å¯ä»¥ç”¨æ¥åœ¨å½“å‰çŽ¯å¢ƒä¸­å®‰è£…æŸä¸ªä¾èµ–åŒ…ï¼š123456789101112131415(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry add requestsUsing version ^2.25.1 for requestsUpdating dependenciesResolving dependencies...Writing lock filePackage operations: 5 installs, 0 updates, 0 removals â€¢ Installing certifi (2020.12.5) â€¢ Installing chardet (4.0.0) â€¢ Installing idna (2.10) â€¢ Installing urllib3 (1.26.4) â€¢ Installing requests (2.25.1) poetry add xxx -D å‘½ä»¤å¯ä»¥ç”¨æ¥å®‰è£…é’ˆå¯¹å¼€å‘çŽ¯å¢ƒçš„æŸä¸ªä¾èµ–åŒ…ï¼ˆç”¨ poetry remove å‘½ä»¤å¸è½½æ­¤ç±»åŒ…æ—¶ä¹Ÿéœ€è¦æŒ‡å®š -D é€‰é¡¹ï¼‰ï¼š12345678910111213(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry add autopep8 -DUsing version ^1.5.7 for autopep8Updating dependenciesResolving dependencies...Writing lock filePackage operations: 3 installs, 0 updates, 0 removals â€¢ Installing pycodestyle (2.7.0) â€¢ Installing toml (0.10.2) â€¢ Installing autopep8 (1.5.7) åŒæ—¶ï¼Œå®‰è£…çš„ä¾èµ–åŒ…ä¿¡æ¯ä¹Ÿä¼šè‡ªåŠ¨æ·»åŠ åˆ° pyproject.toml é…ç½®æ–‡ä»¶ä¸­ï¼š12345678910111213141516[tool.poetry]name = "test-poetry"version = "0.1.0"description = ""authors = ["Your Name &lt;you@example.com&gt;"][tool.poetry.dependencies]python = "^3.9"requests = "^2.25.1"[tool.poetry.dev-dependencies]autopep8 = "^1.5.7"[build-system]requires = ["poetry-core&gt;=1.0.0"]build-backend = "poetry.core.masonry.api" åŽç»­é…ç½®æ–°çš„çŽ¯å¢ƒæ—¶ï¼Œpyproject.toml å¯ä»¥å‘æŒ¥ç±»ä¼¼ requirements.txt æ–‡ä»¶çš„ä½œç”¨ã€‚å³å€ŸåŠ©æ­¤æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ peotry install å‘½ä»¤è‡ªåŠ¨å®‰è£…æ–‡ä»¶ä¸­åŒ…å«çš„ä¾èµ–é¡¹ã€‚ ç»´æŠ¤çŽ¯å¢ƒä¾èµ–ä½¿ç”¨ poetry show å‘½ä»¤æŸ¥çœ‹å½“å‰å®‰è£…çš„ä¾èµ–åŒ…åˆ—è¡¨ï¼š123456789(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry showautopep8 1.5.7 A tool that automatically formats Python code to conform to the PEP 8 style guidecertifi 2020.12.5 Python package for providing Mozilla&apos;s CA Bundle.chardet 4.0.0 Universal encoding detector for Python 2 and 3idna 2.10 Internationalized Domain Names in Applications (IDNA)pycodestyle 2.7.0 Python style guide checkerrequests 2.25.1 Python HTTP for Humans.toml 0.10.2 Python Library for Tom&apos;s Obvious, Minimal Languageurllib3 1.26.4 HTTP library with thread-safe connection pooling, file post, and more. ä½¿ç”¨ poetry show -t å‘½ä»¤æŸ¥çœ‹å½“å‰çŽ¯å¢ƒä¸­å„åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š123456789(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry show -tautopep8 1.5.7 A tool that automatically formats Python code to conform to the PEP 8 style guide|-- pycodestyle &gt;=2.7.0`-- toml *requests 2.25.1 Python HTTP for Humans.|-- certifi &gt;=2017.4.17|-- chardet &gt;=3.0.2,&lt;5|-- idna &gt;=2.5,&lt;3`-- urllib3 &gt;=1.21.1,&lt;1.27 è‹¥æ­¤æ—¶ä½¿ç”¨ poetry remove autopep8 -D å‘½ä»¤ç§»é™¤ autopep8ï¼Œåˆ™ä¹‹å‰è‡ªåŠ¨å®‰è£…çš„ pycodestyleã€toml ä¾èµ–é¡¹ä¹Ÿä¼šè¢«ç§»é™¤ã€‚1234567891011(python3.9.4) C:\Users\Administrator\projects\python\test-poetry&gt;poetry remove autopep8 -DUpdating dependenciesResolving dependencies...Writing lock filePackage operations: 0 installs, 0 updates, 3 removals â€¢ Removing autopep8 (1.5.7) â€¢ Removing pycodestyle (2.7.0) â€¢ Removing toml (0.10.2) PSï¼šæ›´å¤š poetry å‘½ä»¤å’Œç”¨æ³•å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šPoetry Commands]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>Poetry</tag>
        <tag>Miniconda</tag>
        <tag>Conda</tag>
        <tag>Package</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Djangoï¼ˆdrfï¼‰é…åˆ Vue Element å®žçŽ°æ–‡ä»¶ä¸Šä¼ ä¸‹è½½åŠŸèƒ½]]></title>
    <url>%2F2021%2F03%2F13%2Fdjango-drf-and-vue-element-file-upload-and-download%2F</url>
    <content type="text"><![CDATA[åŽå°ä»£ç Modelsç¼–è¾‘ models.py ä»£ç ï¼Œé€šè¿‡ FileField å­—æ®µè®°å½•æ–‡ä»¶ä¿¡æ¯ï¼š123456789from django.db import modelsclass FilesModel(models.Model): file = models.FileField(upload_to='uploads/') class Meta: db_table = 'files_storage' ordering = ['-id'] Serializerè¿™é‡Œä½¿ç”¨ Django REST framework å®žçŽ°åŽç«¯ REST APIï¼Œéœ€è¦åˆ›å»ºåºåˆ—åŒ–å™¨ serializers.pyï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789from rest_framework import serializers# files æ˜¯ app çš„åå­—from files import modelsclass FilesSerializer(serializers.ModelSerializer): class Meta: model = models.FilesModel fields = '__all__' Viewsç¼–è¾‘ views.py ä»£ç ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567from rest_framework.viewsets import ModelViewSetfrom files import models, serializersclass FileViewSet(ModelViewSet): queryset = models.FilesModel.objects.all() serializer_class = serializers.FilesSerializer Urlsåœ¨ files è·¯å¾„ä¸‹æ–°å»º urls.py æ–‡ä»¶ï¼Œå¡«å†™è·¯ç”±é…ç½®ï¼š12345678910from django.urls import include, pathfrom rest_framework import routersfrom files import viewsrouter = routers.DefaultRouter()router.register(r'files', views.FileViewSet)urlpatterns = [ path('', include(router.urls))] åœ¨é¡¹ç›®æ€»é…ç½®è·¯å¾„ä¸‹ï¼ˆsettings.py æ‰€åœ¨çš„è·¯å¾„ï¼‰ç¼–è¾‘æ ¹è·¯ç”±é…ç½®æ–‡ä»¶ urls.pyï¼š1234567from django.contrib import adminfrom django.urls import path, includeurlpatterns = [ path('admin/', admin.site.urls), path('storage/', include('files.urls'))] æµ‹è¯•åŽç«¯ APIè¿è¡ŒåŽå°æœåŠ¡ python manage.py runserver 0.0.0.0:8000ï¼Œè®¿é—® http://xx.xx.xx.xx:8000/storage/files/ï¼Œç•Œé¢å¦‚ä¸‹ï¼š æµ‹è¯•ä¸Šä¼ æ–‡ä»¶ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š å‰ç«¯ä»£ç ï¼ˆæ‰‹åŠ¨ä¸Šä¼ ï¼‰å€ŸåŠ© Element UI çš„ upload ç»„ä»¶ï¼ŒVue ä»£ç ï¼ˆindex.vueï¼‰å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930&lt;template&gt; &lt;div&gt; &lt;el-upload ref=&quot;upload&quot; drag action=&quot;http://xx.xx.xx.xx:8000/storage/files/&quot; :auto-upload=&quot;false&quot; :on-success=&quot;onSuccess&quot; &gt; &lt;i class=&quot;el-icon-upload&quot; /&gt; &lt;div class=&quot;el-upload__text&quot;&gt;å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–&lt;em&gt;ç‚¹å‡»ä¸Šä¼ &lt;/em&gt;&lt;/div&gt; &lt;/el-upload&gt; &lt;el-button style=&quot;margin-left: 10px;&quot; size=&quot;small&quot; type=&quot;success&quot; @click=&quot;submitUpload&quot;&gt;ä¸Šä¼ åˆ°æœåŠ¡å™¨&lt;/el-button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &apos;UploadDemo&apos;, methods: &#123; submitUpload() &#123; this.$refs.upload.submit() &#125;, onSuccess() &#123; this.$message.success(&apos;ä¸Šä¼ æˆåŠŸ&apos;) &#125; &#125;&#125;&lt;/script&gt; å…¶ä¸­ el-upload ç»„ä»¶çš„ action å±žæ€§ç”¨äºŽæŒ‡å®šåŽå° API çš„ URIï¼›:auto-upload å±žæ€§ç”¨äºŽè®¾ç½®æ˜¯å¦è‡ªåŠ¨ä¸Šä¼ ï¼ˆè¿™é‡Œè®¾ç½®ä¸º falseï¼Œæ‰‹åŠ¨è§¦å‘ä¸Šä¼ åŠ¨ä½œï¼‰ï¼›:on-success å±žæ€§ç”¨äºŽæŒ‡å®šä¸Šä¼ æˆåŠŸåŽè§¦å‘çš„æ–¹æ³•ã€‚ submitUpload() ä¸­çš„ this.$refs.upload.submit() æ–¹æ³•è§¦å‘æ–‡ä»¶ä¸Šä¼ åŠ¨ä½œã€‚ ç•Œé¢å¦‚ä¸‹ï¼š æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ï¼š åŽå°æ•°æ®å¦‚ä¸‹ï¼š12345678910[ &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/template.html", "id": 18 &#125;, &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/20171215091830_55126_hSnPtZR.png", "id": 17 &#125;] æ–‡ä»¶ä¸Šä¼ çš„åŒæ—¶æ·»åŠ å…¶ä»–æ•°æ®ä¿®æ”¹æ•°æ®åº“æ¨¡åž‹ç¼–è¾‘åŽç«¯ models.py æ–‡ä»¶ï¼Œæ·»åŠ å…¶ä»–å­—æ®µï¼š12345678910from django.db import modelsclass FilesModel(models.Model): name = models.CharField(max_length=20, default='') file = models.FileField(upload_to='uploads/') class Meta: db_table = 'files_storage' ordering = ['-id'] æ•°æ®åº“è¿ç§»åŽï¼Œé‡å¯åŽå° Web æœåŠ¡ã€‚ åŽå°æ•°æ®å¦‚ä¸‹ï¼š123456789101112[ &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/template.html", "id": 18, "name": "" &#125;, &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/20171215091830_55126_hSnPtZR.png", "id": 17, "name": "" &#125;] ä¿®æ”¹å‰ç«¯ä»£ç æ·»åŠ å…¶ä»–æ•°æ®çš„è¾“å…¥ç•Œé¢ï¼ŒåŒæ—¶å°†é™„åŠ æ•°æ®ç»‘å®šåˆ° el-upload ç»„ä»¶ä¸­ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142&lt;template&gt; &lt;div&gt; &lt;el-label&gt;åç§°&lt;/el-label&gt; &lt;el-input v-model=&quot;fileData.name&quot; style=&quot;width: 20%&quot; /&gt; &lt;el-upload ref=&quot;upload&quot; drag class=&quot;upload-demo&quot; action=&quot;http://xx.xx.xx.xx:8000/storage/files/&quot; :data=&quot;fileData&quot; :auto-upload=&quot;false&quot; :on-success=&quot;onSuccess&quot; style=&quot;padding: 30px&quot; &gt; &lt;i class=&quot;el-icon-upload&quot; /&gt; &lt;div class=&quot;el-upload__text&quot;&gt;å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–&lt;em&gt;ç‚¹å‡»ä¸Šä¼ &lt;/em&gt;&lt;/div&gt; &lt;/el-upload&gt; &lt;el-button style=&quot;margin-left: 10px;&quot; size=&quot;small&quot; type=&quot;success&quot; @click=&quot;submitUpload&quot;&gt;ä¸Šä¼ åˆ°æœåŠ¡å™¨&lt;/el-button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &apos;UploadDemo&apos;, data() &#123; return &#123; fileData: &#123; name: &apos;&apos; &#125; &#125; &#125;, methods: &#123; submitUpload() &#123; this.$refs.upload.submit() &#125;, onSuccess() &#123; this.$message.success(&apos;ä¸Šä¼ æˆåŠŸ&apos;) &#125; &#125;&#125;&lt;/script&gt; å…¶ä¸­ el-upload ç»„ä»¶çš„ :data å±žæ€§ç”¨äºŽæŒ‡å®šæ–‡ä»¶ä¸Šä¼ æ—¶é™„åŠ çš„æ•°æ®ï¼ˆç±»åž‹ä¸º JavaScript å¯¹è±¡ï¼‰ã€‚ æ–‡ä»¶ä¸Šä¼ æµ‹è¯•ï¼š ä¸Šä¼ å®Œæˆï¼ŒåŽå°æ•°æ®å¦‚ä¸‹ï¼š1234567891011121314151617[ &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/AnyDesk.exe", "id": 19, "name": "æµ‹è¯•æ–‡ä»¶" &#125;, &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/template.html", "id": 18, "name": "" &#125;, &#123; "file": "http://172.20.23.34:8000/storage/files/uploads/20171215091830_55126_hSnPtZR.png", "id": 17, "name": "" &#125;] æ–‡ä»¶ä¸‹è½½ä¿®æ”¹åŽå°è§†å›¾ä»£ç ï¼ˆviews.pyï¼‰ï¼Œæ·»åŠ æ–‡ä»¶ä¸‹è½½çš„ API å“åº”é€»è¾‘ï¼š 123456789101112131415from rest_framework.viewsets import ModelViewSetfrom files import models, serializersfrom rest_framework.decorators import actionfrom django.http import FileResponseclass FileViewSet(ModelViewSet): queryset = models.FilesModel.objects.all() serializer_class = serializers.FilesSerializer @action(methods=['get', 'post'], detail=True) def download(self, request, pk=None, *args, **kwargs): file_obj = self.get_object() response = FileResponse(open(file_obj.file.path, 'rb')) return response æ­¤æ—¶è®¿é—® http://xx.xx.xx.xx:8000/storage/files/[id]/download/ é“¾æŽ¥ï¼Œå³å¯ç›´æŽ¥ä¸‹è½½ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ 1234$ curl -o anydesk.exe 172.20.23.34:8000/storage/files/19/download/ % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 3584k 100 3584k 0 0 102M 0 --:--:-- --:--:-- --:--:-- 102M å‚è€ƒèµ„æ–™Element UI å®˜æ–¹æ–‡æ¡£Django å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Web</tag>
        <tag>Django</tag>
        <tag>Vue</tag>
        <tag>drf</tag>
        <tag>Element</tag>
        <tag>File</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºæœ¬ç®—æ³•é—®é¢˜çš„ Python è§£æ³•â€”â€”å›¾ï¼ˆGraphï¼‰é—®é¢˜]]></title>
    <url>%2F2021%2F02%2F20%2Fclassic-compute-problems-with-python-graph-problems%2F</url>
    <content type="text"><![CDATA[å›¾ï¼ˆGraphï¼‰æ˜¯ä¸€ç§ç”¨æ¥å¯¹æŸäº›çŽ°å®žé—®é¢˜è¿›è¡Œå»ºæ¨¡çš„æŠ½è±¡çš„æ•°å­¦ç»“æž„ï¼Œè¿™äº›é—®é¢˜ä»Žé€»è¾‘ä¸Šå¯ä»¥è¢«åˆ’åˆ†æˆä¸€ç³»åˆ—ç›¸äº’è¿žæŽ¥çš„èŠ‚ç‚¹ã€‚å…¶ä¸­çš„èŠ‚ç‚¹ç§°ä¸ºé¡¶ç‚¹ï¼ˆvertexï¼‰ï¼Œé¡¶ç‚¹ä¹‹é—´çš„è¿žæŽ¥ç§°ä¸ºè¾¹ï¼ˆedgeï¼‰ã€‚æ¯”å¦‚åœ°é“çº¿è·¯å°±å¯ä»¥çœ‹ä½œç”±å›¾è¡¨ç¤ºæˆçš„è¿è¾“ç½‘ç»œã€‚æ¯ä¸€ä¸ªé¡¶ç‚¹éƒ½ä»£è¡¨ä¸€ä¸ªåœ°é“ç«™ï¼Œè€Œé¡¶ç‚¹ä¹‹é—´çš„è¾¹åˆ™è¡¨ç¤ºä¸¤ä¸ªåœ°é“ç«™ä¹‹é—´çš„è·¯å¾„ã€‚å¦‚æžœæƒ³çŸ¥é“æŸä¸ªç«™ç‚¹åˆ°å¦ä¸€ä¸ªç«™ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œå›¾ç®—æ³•å°±èƒ½å‘æŒ¥ä½œç”¨ã€‚å®žé™…ä¸Šï¼Œå›¾ç®—æ³•å¯ä»¥è¢«åº”ç”¨åˆ°ä»»ä½•ç±»åž‹çš„ç½‘ç»œé—®é¢˜ä¸­ã€‚ map as graph 123456789101112131415# edge.pyfrom __future__ import annotationsfrom dataclasses import dataclass@dataclassclass Edge: u: int # the "from" vertex v: int # the "to" vertex def reversed(self) -&gt; Edge: return Edge(self.v, self.u) def __str__(self) -&gt; str: return f"&#123;self.u&#125; -&gt; &#123;self.v&#125;" ä¸Šé¢ä»£ç ä¸­çš„ Edge ç±»è¡¨ç¤ºä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è¿žæŽ¥ï¼ˆå³â€œè¾¹â€ï¼‰ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½ç”±æ•´æ•°ç´¢å¼•è¡¨ç¤ºã€‚å…¶ä¸­ u ç”¨æ¥è¡¨ç¤ºç¬¬ä¸€ä¸ªé¡¶ç‚¹ï¼Œv è¡¨ç¤ºç¬¬äºŒä¸ªé¡¶ç‚¹ã€‚è¿™é‡Œåªå…³æ³¨éžæ–¹å‘æ€§çš„ graphï¼Œedge æ˜¯åŒå‘çš„ã€‚è€Œåœ¨æœ‰å‘å›¾ï¼ˆdigraphï¼‰ä¸­ï¼Œedge å¯ä»¥æ˜¯å•å‘çš„ã€‚reversed() æ–¹æ³•ç”¨æ¥è¿”å›žå½“å‰ edge çš„é€†å‘å½¢å¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172# graph.pyfrom typing import TypeVar, Generic, List, Optionalfrom edge import EdgeV = TypeVar('V') # type of the vertices in the graphclass Graph(Generic[V]): def __init__(self, vertices: List[V] = []) -&gt; None: self._vertices: List[V] = vertices self._edges: List[List[Edge]] = [[] for _ in vertices] @property def vertex_count(self) -&gt; int: return len(self._vertices) # Number of vertices @property def edge_count(self) -&gt; int: return sum(map(len, self._edges)) # Number of edges # Add a vertex to the graph and return its index def add_vertex(self, vertex: V) -&gt; int: self._vertices.append(vertex) self._edges.append([]) # Add empty list for containing edges return self.vertex_count - 1 # Return index of added vertex # This is an undirected graph, # so we always add edges in both directions def add_edge(self, edge: Edge) -&gt; None: self._edges[edge.u].append(edge) self._edges[edge.v].append(edge.reversed()) # Add an edge using vertex indices (convenience method) def add_edge_by_indices(self, u: int, v: int) -&gt; None: edge: Edge = Edge(u, v) self.add_edge(edge) # Add an edge by looking up vertex indices (convenience method) def add_edge_by_vertices(self, first: V, second: V) -&gt; None: u: int = self._vertices.index(first) v: int = self._vertices.index(second) self.add_edge_by_indices(u, v) # Find the vertex at a specific index def vertex_at(self, index: int) -&gt; V: return self._vertices[index] # Find the index of a vertex in the graph def index_of(self, vertex: V) -&gt; int: return self._vertices.index(vertex) # Find the vertices that a vertex at some index is connected to def neighbors_for_index(self, index: int) -&gt; List[V]: return list(map(self.vertex_at, [e.v for e in self._edges[index]])) # Look up a vertice's index and find its neighbors (convenience method) def neighbors_for_vertex(self, vertex: V) -&gt; List[V]: return self.neighbors_for_index(self.index_of(vertex)) # Return all of the edges associated with a vertex at some index def edges_for_index(self, index: int) -&gt; List[Edge]: return self._edges[index] # Look up the index of a vertex and return its edges (convenience method) def edges_for_vertex(self, vertex: V) -&gt; List[Edge]: return self.edges_for_index(self.index_of(vertex)) # Make it easy to pretty-print a Graph def __str__(self) -&gt; str: desc: str = "" for i in range(self.vertex_count): desc += f"&#123;self.vertex_at(i)&#125; -&gt; &#123;self.neighbors_for_index(i)&#125;\n" return desc Graph ç±»èšç„¦äºŽ graph çš„æ ¸å¿ƒè§’è‰²ï¼Œå³å°†é¡¶ç‚¹ç”¨è¾¹è¿žæŽ¥èµ·æ¥ã€‚_vertices åˆ—è¡¨æ˜¯ Graph ç±»çš„æ ¸å¿ƒï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½ä¼šè¢«å­˜å‚¨åœ¨è¯¥åˆ—è¡¨ä¸­ã€‚ä½†æ˜¯ä¹‹åŽåœ¨å®žé™…å¼•ç”¨æ—¶ä¼šä½¿ç”¨é¡¶ç‚¹åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•ã€‚é¡¶ç‚¹æœ¬èº«æœ‰å¯èƒ½ä¼šæ˜¯éžå¸¸å¤æ‚çš„æ•°æ®ç±»åž‹ï¼Œä½†å…¶ç´¢å¼•ä¸€å®šä¼šæ˜¯ int ç±»åž‹ï¼Œç›¸å¯¹è€Œè¨€æ›´åŠ æ–¹ä¾¿ä½¿ç”¨ã€‚graph æ•°æ®ç±»åž‹å¯ä»¥ä½¿ç”¨ adjacency lists æ–¹å¼å®žçŽ°ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½æ‹¥æœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢åŒ…å«äº†è¿™ä¸ªé¡¶ç‚¹è¿žæŽ¥çš„å…¶ä»–é¡¶ç‚¹ã€‚è¿™é‡Œä½¿ç”¨äº†ç”± edge ç»„æˆçš„åˆ—è¡¨å†ç»„æˆçš„åˆ—è¡¨ï¼ˆ_edgesï¼‰ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½æ‹¥æœ‰ä¸€ä¸ªç”± edge ç»„æˆçš„åˆ—è¡¨ï¼Œè¿™äº› edge è¡¨ç¤ºè¯¥é¡¶ç‚¹ä¸Žå…¶ä»–é¡¶ç‚¹çš„è¿žæŽ¥å…³ç³»ã€‚ Graph ç±»ä¸­å®žçŽ°çš„æ–¹æ³•çš„ç®€å•ä»‹ç»ï¼š vertex_count å±žæ€§ï¼šèŽ·å– graph ä¸­é¡¶ç‚¹çš„æ•°é‡ edge_count å±žæ€§ï¼šèŽ·å– graph ä¸­è¾¹çš„æ•°é‡ add_vertex æ–¹æ³•ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„å­¤ç«‹çš„é¡¶ç‚¹å¹¶è¿”å›žå…¶ç´¢å¼• add_edge æ–¹æ³•ï¼šæ·»åŠ ä¸€æ¡è¾¹ï¼ˆåŒå‘ï¼Œå‚æ•°æ˜¯ Edge å¯¹è±¡ï¼‰ add_edge_by_indices æ–¹æ³•ï¼šé€šè¿‡é¡¶ç‚¹ç´¢å¼•æ·»åŠ æ–°çš„è¾¹ï¼ˆå‚æ•°æ˜¯è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹çš„ç´¢å¼• uã€vï¼‰ add_edge_by_vertices æ–¹æ³•ï¼šé€šè¿‡é¡¶ç‚¹æ·»åŠ æ–°çš„è¾¹ï¼ˆå‚æ•°æ˜¯è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹ï¼ˆVertexï¼‰å¯¹è±¡ï¼‰ vertex_at æ–¹æ³•ï¼šé€šè¿‡ç‰¹å®šçš„ç´¢å¼•æŸ¥è¯¢é¡¶ç‚¹ index_of æ–¹æ³•ï¼šæ ¹æ®é¡¶ç‚¹è¿”å›žå…¶ç´¢å¼• neighbors_for_index æ–¹æ³•ï¼šæ ¹æ®æŸä¸ªé¡¶ç‚¹çš„ç´¢å¼•èŽ·å–å…¶ä¸´è¿‘çš„é¡¶ç‚¹ï¼ˆå‚æ•°ä¸ºé¡¶ç‚¹ç´¢å¼•ï¼‰ neighbors_for_vertex æ–¹æ³•ï¼šæ ¹æ®æŸä¸ªé¡¶ç‚¹èŽ·å–å…¶ä¸´è¿‘çš„é¡¶ç‚¹ï¼ˆå‚æ•°ä¸ºé¡¶ç‚¹å¯¹è±¡ï¼‰ edges_for_index æ–¹æ³•ï¼šæ ¹æ®æŸä¸ªé¡¶ç‚¹çš„ç´¢å¼•èŽ·å–ä¸Žå…¶è¿žæŽ¥çš„è¾¹ï¼ˆå‚æ•°ä¸ºé¡¶ç‚¹ç´¢å¼•ï¼‰ edges_for_vertex æ–¹æ³•ï¼šæ ¹æ®æŸä¸ªé¡¶ç‚¹èŽ·å–ä¸Žå…¶è¿žæŽ¥çš„è¾¹ï¼ˆå‚æ•°ä¸ºé¡¶ç‚¹å¯¹è±¡ï¼‰ __str__ æ–¹æ³•ï¼šå‹å¥½çš„æ–¹å¼è¾“å‡ºæ•´ä¸ª graph è¡¥å……æµ‹è¯•ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132# graph.py continuedif __name__ == "__main__": # test basic Graph construction city_graph: Graph[str] = Graph(["Seattle", "San Francisco", "Los Angeles", "Riverside", "Phoenix", "Chicago", "Boston", "New York", "Atlanta", "Miami", "Dallas", "Houston", "Detroit", "Philadelphia", "Washington"]) city_graph.add_edge_by_vertices("Seattle", "Chicago") city_graph.add_edge_by_vertices("Seattle", "San Francisco") city_graph.add_edge_by_vertices("San Francisco", "Riverside") city_graph.add_edge_by_vertices("San Francisco", "Los Angeles") city_graph.add_edge_by_vertices("Los Angeles", "Riverside") city_graph.add_edge_by_vertices("Los Angeles", "Phoenix") city_graph.add_edge_by_vertices("Riverside", "Phoenix") city_graph.add_edge_by_vertices("Riverside", "Chicago") city_graph.add_edge_by_vertices("Phoenix", "Dallas") city_graph.add_edge_by_vertices("Phoenix", "Houston") city_graph.add_edge_by_vertices("Dallas", "Chicago") city_graph.add_edge_by_vertices("Dallas", "Atlanta") city_graph.add_edge_by_vertices("Dallas", "Houston") city_graph.add_edge_by_vertices("Houston", "Atlanta") city_graph.add_edge_by_vertices("Houston", "Miami") city_graph.add_edge_by_vertices("Atlanta", "Chicago") city_graph.add_edge_by_vertices("Atlanta", "Washington") city_graph.add_edge_by_vertices("Atlanta", "Miami") city_graph.add_edge_by_vertices("Miami", "Washington") city_graph.add_edge_by_vertices("Chicago", "Detroit") city_graph.add_edge_by_vertices("Detroit", "Boston") city_graph.add_edge_by_vertices("Detroit", "Washington") city_graph.add_edge_by_vertices("Detroit", "New York") city_graph.add_edge_by_vertices("Boston", "New York") city_graph.add_edge_by_vertices("New York", "Philadelphia") city_graph.add_edge_by_vertices("Philadelphia", "Washington") print(city_graph) è¿è¡Œç»“æžœï¼š123456789101112131415Seattle -&gt; ['Chicago', 'San Francisco']San Francisco -&gt; ['Seattle', 'Riverside', 'Los Angeles']Los Angeles -&gt; ['San Francisco', 'Riverside', 'Phoenix']Riverside -&gt; ['San Francisco', 'Los Angeles', 'Phoenix', 'Chicago']Phoenix -&gt; ['Los Angeles', 'Riverside', 'Dallas', 'Houston']Chicago -&gt; ['Seattle', 'Riverside', 'Dallas', 'Atlanta', 'Detroit']Boston -&gt; ['Detroit', 'New York']New York -&gt; ['Detroit', 'Boston', 'Philadelphia']Atlanta -&gt; ['Dallas', 'Houston', 'Chicago', 'Washington', 'Miami']Miami -&gt; ['Houston', 'Atlanta', 'Washington']Dallas -&gt; ['Phoenix', 'Chicago', 'Atlanta', 'Houston']Houston -&gt; ['Phoenix', 'Dallas', 'Atlanta', 'Miami']Detroit -&gt; ['Chicago', 'Boston', 'Washington', 'New York']Philadelphia -&gt; ['New York', 'Washington']Washington -&gt; ['Atlanta', 'Miami', 'Detroit', 'Philadelphia'] å¯»æ‰¾æœ€çŸ­è·¯å¾„åœ¨ graph ç†è®ºä¸­ï¼Œä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æ‰€æœ‰è¿žçº¿ï¼ˆè¾¹ï¼‰ç§°ä¸ºè·¯å¾„ã€‚å³ä»Žä¸€ä¸ªé¡¶ç‚¹åˆ°è¾¾å¦ä¸€ä¸ªé¡¶ç‚¹éœ€è¦èµ°è¿‡çš„æ‰€æœ‰è·¯å¾„ã€‚åœ¨ä¸€ä¸ªæœªåŠ æƒçš„ graph ä¸­ï¼ˆå³ä¸è€ƒè™‘è¾¹çš„é•¿åº¦ï¼‰ï¼Œå¯»æ‰¾æœ€çŸ­çš„è·¯å¾„æ„å‘³ç€ä»Žèµ·å§‹é¡¶ç‚¹åˆ°ç›®æ ‡é¡¶ç‚¹ä¹‹é—´ç»è¿‡çš„è¾¹æœ€å°‘ã€‚å¯ä»¥ä½¿ç”¨å®½åº¦ä¼˜å…ˆæœç´¢ï¼ˆbreadth-first search, BFSï¼‰ç®—æ³•æŸ¥æ‰¾ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚ï¼ˆBFS ç®—æ³•çš„å…·ä½“å®žçŽ°å¯å‚è€ƒ åŸºæœ¬ç®—æ³•é—®é¢˜çš„ Python è§£æ³•ï¼ˆé€’å½’ä¸Žæœç´¢ï¼‰ä¸­çš„è¿·å®«é—®é¢˜ï¼‰ã€‚ BFS éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162# generic_search.pyfrom __future__ import annotationsfrom typing import TypeVar, Generic, List, Callable, Deque, Set, OptionalT = TypeVar('T')class Node(Generic[T]): def __init__(self, state: T, parent: Optional[Node]) -&gt; None: self.state: T = state self.parent: Optional[Node] = parentclass Queue(Generic[T]): def __init__(self) -&gt; None: self._container: Deque[T] = Deque() @property def empty(self) -&gt; bool: return not self._container # not is true for empty container def push(self, item: T) -&gt; None: self._container.append(item) def pop(self) -&gt; T: return self._container.popleft() # FIFO def __repr__(self) -&gt; str: return repr(self._container)def bfs(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]]) -&gt; Optional[Node[T]]: # frontier is where we've yet to go frontier: Queue[Node[T]] = Queue() frontier.push(Node(initial, None)) # explored is where we've been explored: Set[T] = &#123;initial&#125; # keep going while there is more to explore while not frontier.empty: current_node: Node[T] = frontier.pop() current_state: T = current_node.state # if we found the goal, we're done if goal_test(current_state): return current_node # check where we can go next and haven't explored for child in successors(current_state): if child in explored: # skip children we already explored continue explored.add(child) frontier.push(Node(child, current_node)) return None # went through everything and never found goaldef node_to_path(node: Node[T]) -&gt; List[T]: path: List[T] = [node.state] # work backwards from end to front while node.parent is not None: node = node.parent path.append(node.state) path.reverse() return path ç»§ç»­è¡¥å…… graph.py ä»£ç å¦‚ä¸‹ï¼š123456789101112# graph.py continuedif __name__ == "__main__":# ... from generic_search import bfs, Node, node_to_path bfs_result: Optional[Node[V]] = bfs("Boston", lambda x: x == "Miami", city_graph.neighbors_for_vertex) if bfs_result is None: print("No solution found using breadth-first search!") else: path: List[V] = node_to_path(bfs_result) print("Path from Boston to Miami:") print(path) bfs() å‡½æ•°æŽ¥å—ä¸‰ä¸ªå‚æ•°ï¼šåˆå§‹çŠ¶æ€ã€ç”¨äºŽæ£€æµ‹å½“å‰çŠ¶æ€æ˜¯å¦ç¬¦åˆç›®æ ‡çŠ¶æ€çš„ Callableï¼ˆå¯è°ƒç”¨å¯¹è±¡ï¼‰ã€ç”¨äºŽå¯»æ‰¾è¾¾æˆç›®æ ‡çŠ¶æ€çš„è·¯å¾„çš„ Callableã€‚è‹¥éœ€è¦å¯»æ‰¾ Boston åˆ° Miami çš„æœ€çŸ­è·¯å¾„ï¼ˆä¸è€ƒè™‘åŠ æƒçš„æƒ…å†µï¼‰ï¼Œåˆ™åˆå§‹çŠ¶æ€ä¸ºé¡¶ç‚¹ â€œBostonâ€ï¼Œç”¨äºŽçŠ¶æ€æ£€æµ‹çš„ Callable åˆ™åˆ¤æ–­å½“å‰é¡¶ç‚¹æ˜¯å¦ä¸º â€œMiamiâ€ã€‚ è¿è¡Œæ•ˆæžœï¼š12Path from Boston to Miami:['Boston', 'Detroit', 'Washington', 'Miami'] åŠ æƒå›¾ä¹‹å‰çš„è®¡ç®—ä¸­ï¼Œæœ€çŸ­è·¯å¾„åªè€ƒè™‘ç»è¿‡çš„ç«™ç‚¹æœ€å°‘ï¼Œè€Œæœªå°†ç«™ç‚¹ä¹‹é—´çš„è·¯ç¨‹è®¡ç®—åœ¨å†…ã€‚è‹¥éœ€è¦å°†è·¯ç¨‹åŒ…å«è¿›åŽ»ï¼Œåˆ™å¯ä»¥ä¸º edge åŠ ä¸Šæƒé‡æ¥è¡¨ç¤ºè¯¥ edge å¯¹åº”çš„è·ç¦»ã€‚ ä¸ºäº†å®žçŽ°åŠ æƒçš„ graphï¼Œéœ€è¦å®žçŽ° Edge çš„å­ç±» WeightedEdge ä»¥åŠ Graph çš„å­ç±» WeightedGraphã€‚æ¯ä¸€ä¸ª WeightedEdge å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ float ç±»åž‹çš„å±žæ€§ç”¨æ¥è¡¨ç¤ºæƒé‡ã€‚123456789101112131415161718# weighted_edge.pyfrom __future__ import annotationsfrom dataclasses import dataclassfrom edge import Edge@dataclassclass WeightedEdge(Edge): weight: float def reversed(self) -&gt; WeightedEdge: return WeightedEdge(self.v, self.u, self.weight) # so that we can order edges by weight to find the minimum weight edge def __lt__(self, other: WeightedEdge) -&gt; bool: return self.weight &lt; other.weight def __str__(self) -&gt; str: return f"&#123;self.u&#125; &#123;self.weight&#125;&gt; &#123;self.v&#125;" WeightedEdge å­ç±»æ·»åŠ äº†ä¸€ä¸ª weight å±žæ€§ï¼Œé€šè¿‡ __lt__() æ–¹æ³•å®žçŽ°äº† &lt; æ“ä½œç¬¦ï¼Œä»¤ WeightedEdge å¯¹è±¡æˆä¸ºå¯æ¯”è¾ƒçš„ï¼Œä½¿å¾—è¿”å›ž weight æœ€å°çš„ edge æˆä¸ºå¯èƒ½ã€‚ 1234567891011121314151617181920212223242526272829303132# weighted_graph.pyfrom typing import TypeVar, Generic, List, Tuplefrom graph import Graphfrom weighted_edge import WeightedEdgeV = TypeVar('V') # type of the vertices in the graphclass WeightedGraph(Generic[V], Graph[V]): def __init__(self, vertices: List[V] = []) -&gt; None: self._vertices: List[V] = vertices self._edges: List[List[WeightedEdge]] = [[] for _ in vertices] def add_edge_by_indices(self, u: int, v: int, weight: float) -&gt; None: edge: WeightedEdge = WeightedEdge(u, v, weight) self.add_edge(edge) # call superclass version def add_edge_by_vertices(self, first: V, second: V, weight: float) -&gt; None: u: int = self._vertices.index(first) v: int = self._vertices.index(second) self.add_edge_by_indices(u, v, weight) def neighbors_for_index_with_weights(self, index: int) -&gt; List[Tuple[V, float]]: distance_tuples: List[Tuple[V, float]] = [] for edge in self.edges_for_index(index): distance_tuples.append((self.vertex_at(edge.v), edge.weight)) return distance_tuples def __str__(self) -&gt; str: desc: str = "" for i in range(self.vertex_count): desc += f"&#123;self.vertex_at(i)&#125; -&gt; &#123;self.neighbors_for_index_with_weights(i)&#125;\n" return desc WeightedGraph ç±»ç»§æ‰¿è‡ª Graphï¼Œåœ¨åŽŸæ¥çš„åŸºç¡€ä¸Šå¯¹æŸäº›éœ€è¦é€‚åº” weight å±žæ€§çš„æ–¹æ³•åšäº†å¯¹åº”çš„ä¿®æ”¹ã€‚ è¡¥å…… weighted_graph.py ä»£ç ï¼Œæµ‹è¯•è¿è¡Œæ•ˆæžœï¼š123456789101112131415161718192021222324252627282930313233343536# weighted_graph.py continuedif __name__ == "__main__": city_graph2: WeightedGraph[str] = WeightedGraph(["Seattle", "San Francisco", "Los Angeles", "Riverside", "Phoenix", "Chicago", "Boston", "New York", "Atlanta", "Miami", "Dallas", "Houston", "Detroit", "Philadelphia", "Washington"]) city_graph2.add_edge_by_vertices("Seattle", "Chicago", 1737) city_graph2.add_edge_by_vertices("Seattle", "San Francisco", 678) city_graph2.add_edge_by_vertices("San Francisco", "Riverside", 386) city_graph2.add_edge_by_vertices("San Francisco", "Los Angeles", 348) city_graph2.add_edge_by_vertices("Los Angeles", "Riverside", 50) city_graph2.add_edge_by_vertices("Los Angeles", "Phoenix", 357) city_graph2.add_edge_by_vertices("Riverside", "Phoenix", 307) city_graph2.add_edge_by_vertices("Riverside", "Chicago", 1704) city_graph2.add_edge_by_vertices("Phoenix", "Dallas", 887) city_graph2.add_edge_by_vertices("Phoenix", "Houston", 1015) city_graph2.add_edge_by_vertices("Dallas", "Chicago", 805) city_graph2.add_edge_by_vertices("Dallas", "Atlanta", 721) city_graph2.add_edge_by_vertices("Dallas", "Houston", 225) city_graph2.add_edge_by_vertices("Houston", "Atlanta", 702) city_graph2.add_edge_by_vertices("Houston", "Miami", 968) city_graph2.add_edge_by_vertices("Atlanta", "Chicago", 588) city_graph2.add_edge_by_vertices("Atlanta", "Washington", 543) city_graph2.add_edge_by_vertices("Atlanta", "Miami", 604) city_graph2.add_edge_by_vertices("Miami", "Washington", 923) city_graph2.add_edge_by_vertices("Chicago", "Detroit", 238) city_graph2.add_edge_by_vertices("Detroit", "Boston", 613) city_graph2.add_edge_by_vertices("Detroit", "Washington", 396) city_graph2.add_edge_by_vertices("Detroit", "New York", 482) city_graph2.add_edge_by_vertices("Boston", "New York", 190) city_graph2.add_edge_by_vertices("New York", "Philadelphia", 81) city_graph2.add_edge_by_vertices("Philadelphia", "Washington", 123) print(city_graph2) è¿è¡Œæ•ˆæžœï¼š123456789101112131415Seattle -&gt; [('Chicago', 1737), ('San Francisco', 678)]San Francisco -&gt; [('Seattle', 678), ('Riverside', 386), ('Los Angeles', 348)]Los Angeles -&gt; [('San Francisco', 348), ('Riverside', 50), ('Phoenix', 357)]Riverside -&gt; [('San Francisco', 386), ('Los Angeles', 50), ('Phoenix', 307), ('Chicago', 1704)]Phoenix -&gt; [('Los Angeles', 357), ('Riverside', 307), ('Dallas', 887), ('Houston', 1015)]Chicago -&gt; [('Seattle', 1737), ('Riverside', 1704), ('Dallas', 805), ('Atlanta', 588), ('Detroit', 238)]Boston -&gt; [('Detroit', 613), ('New York', 190)]New York -&gt; [('Detroit', 482), ('Boston', 190), ('Philadelphia', 81)]Atlanta -&gt; [('Dallas', 721), ('Houston', 702), ('Chicago', 588), ('Washington', 543), ('Miami', 604)]Miami -&gt; [('Houston', 968), ('Atlanta', 604), ('Washington', 923)]Dallas -&gt; [('Phoenix', 887), ('Chicago', 805), ('Atlanta', 721), ('Houston', 225)]Houston -&gt; [('Phoenix', 1015), ('Dallas', 225), ('Atlanta', 702), ('Miami', 968)]Detroit -&gt; [('Chicago', 238), ('Boston', 613), ('Washington', 396), ('New York', 482)]Philadelphia -&gt; [('New York', 81), ('Washington', 123)]Washington -&gt; [('Atlanta', 543), ('Miami', 923), ('Detroit', 396), ('Philadelphia', 123)] åœ¨åŠ æƒå›¾ä¸­æœç´¢æœ€çŸ­è·¯å¾„å¯»æ‰¾æŸä¸ªèµ·ç‚¹åŸŽå¸‚åˆ°å¦ä¸€ä¸ªåŸŽå¸‚çš„æ‰€æœ‰è·¯çº¿ä¸­èŠ±è´¹æœ€å°çš„ä¸€æ¡ï¼Œå±žäºŽå•æºå¤´æœ€çŸ­è·¯å¾„ï¼ˆsingle-source shortest pathï¼‰é—®é¢˜ï¼Œå³ä»ŽåŠ æƒå›¾ä¸­çš„æŸä¸ªé¡¶ç‚¹åˆ°ä»»æ„çš„å¦å¤–ä¸€ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ Dijkstra ç®—æ³• å¯ä»¥ç”¨æ¥è§£å†³å•æºå¤´æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚è¯¥ç®—æ³•ä»ŽæŸä¸ªèµ·å§‹é¡¶ç‚¹å¼€å§‹ï¼Œå¯ä»¥æ‰¾å‡ºåŠ æƒå›¾ä¸­æ‰€æœ‰å…¶ä»–é¡¶ç‚¹åˆ°èµ·å§‹é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ä»ŽæŸä¸ªé¡¶ç‚¹å¼€å§‹æŒ‰ç…§è¿œè¿‘å…³ç³»ä¾æ¬¡éåŽ†å®Œæ‰€æœ‰é¡¶ç‚¹å¹¶è®°å½•å…¶æ€»çš„èŠ±è´¹ï¼ˆä»Žèµ·å§‹é¡¶ç‚¹åˆ°å½“å‰é¡¶ç‚¹ï¼‰ï¼Œè‹¥é‡å¤å‡ºçŽ°çš„é¡¶ç‚¹èŠ±è´¹æ›´å°ï¼Œåˆ™ä»¤å…¶æ›¿æ¢å·²æœ‰çš„è®°å½•ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š å°†èµ·å§‹é¡¶ç‚¹åŠ å…¥åˆ°ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ ä»Žä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­å¼¹å‡ºä¸€ä¸ªé¡¶ç‚¹ï¼ˆä¸€å¼€å§‹å°±æ˜¯èµ·å§‹é¡¶ç‚¹ï¼‰ä½œä¸ºå½“å‰é¡¶ç‚¹ æŸ¥çœ‹ä¸Žå½“å‰é¡¶ç‚¹ä¸´è¿‘çš„æ‰€æœ‰é¡¶ç‚¹ï¼Œè‹¥æŸä¸€ä¸ªä¹‹å‰æ²¡æœ‰è¢«è®°å½•åˆ°ï¼Œæˆ–æŸä¸ªé¡¶ç‚¹æŒ‰ç…§å½“å‰è·¯å¾„çš„èŠ±è´¹ä½ŽäºŽå·²æœ‰çš„æœ€å°è®°å½•ï¼Œåˆ™è®°å½•å…¶åˆ°èµ·å§‹é¡¶ç‚¹çš„è·ç¦»ï¼ˆä½œä¸ºæ–°çš„æœ€å°è®°å½•ï¼‰åŠç”Ÿæˆè¯¥è·ç¦»çš„æœ€åŽä¸€æ¡è¾¹ï¼ˆè®°å½•è·¯å¾„ï¼‰ï¼Œå¹¶å°†è¯¥é¡¶ç‚¹ push åˆ°ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ï¼ˆä»¤å…¶ä½œä¸ºä¹‹åŽçš„â€œå½“å‰â€é¡¶ç‚¹ï¼‰ é‡å¤å‰é¢ä¸¤æ­¥ç›´åˆ°ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸ºç©º è¿”å›žæ‰€æœ‰é¡¶ç‚¹åˆ°èµ·å§‹é¡¶ç‚¹çš„æœ€å°è·ç¦»åŠè·¯å¾„ 12345678910111213141516171819202122# priority_queue.pyfrom typing import TypeVar, Generic, Listfrom heapq import heappush, heappopT = TypeVar('T')class PriorityQueue(Generic[T]): def __init__(self) -&gt; None: self._container: List[T] = [] @property def empty(self) -&gt; bool: return not self._container def push(self, item: T) -&gt; None: heappush(self._container, item) def pop(self) -&gt; T: return heappop(self._container) def __repr__(self) -&gt; str: return repr(self._container) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118# dijkstra.pyfrom __future__ import annotationsfrom typing import TypeVar, List, Optional, Tuple, Dictfrom dataclasses import dataclassfrom mst import WeightedPath, print_weighted_pathfrom weighted_graph import WeightedGraphfrom weighted_edge import WeightedEdgefrom priority_queue import PriorityQueueV = TypeVar('V') # type of the vertices in the graph@dataclassclass DijkstraNode: vertex: int distance: float def __lt__(self, other: DijkstraNode) -&gt; bool: return self.distance &lt; other.distance def __eq__(self, other: DijkstraNode) -&gt; bool: return self.distance == other.distancedef dijkstra(wg: WeightedGraph[V], root: V) -&gt; Tuple[List[Optional[float]], Dict[int, WeightedEdge]]: first: int = wg.index_of(root) # distances are unknown at first distances: List[Optional[float]] = [None] * wg.vertex_count distances[first] = 0 # the root is 0 away from the root path_dict: Dict[int, WeightedEdge] = &#123;&#125; # how we got to each vertex pq: PriorityQueue[DijkstraNode] = PriorityQueue() pq.push(DijkstraNode(first, 0)) while not pq.empty: u: int = pq.pop().vertex # explore the next closest vertex dist_u: float = distances[u] # should already have seen it # look at every edge/vertex from current vertex for we in wg.edges_for_index(u): # the old distance from starting vertex to this vertex dist_v: float = distances[we.v] # no old distance or found shorter path if dist_v is None or dist_v &gt; we.weight + dist_u: # update distance to this vertex distances[we.v] = we.weight + dist_u # update the edge on the shortest path to this vertex path_dict[we.v] = we # explore this vertex soon pq.push(DijkstraNode(we.v, we.weight + dist_u)) return distances, path_dict# Helper function to get easier access to dijkstra resultsdef distance_array_to_vertex_dict(wg: WeightedGraph[V], distances: List[Optional[float]]) -&gt; Dict[V, Optional[float]]: distance_dict: Dict[V, Optional[float]] = &#123;&#125; for i in range(len(distances)): distance_dict[wg.vertex_at(i)] = distances[i] return distance_dict# Takes a dictionary of edges to reach each node and returns a list of# edges that goes from `start` ot `end`def path_dict_to_path(start: int, end: int, path_dict: Dict[int, WeightedEdge]) -&gt; WeightedPath: if len(path_dict) == 0: return [] edge_path: WeightedPath = [] e: WeightedEdge = path_dict[end] edge_path.append(e) while e.u != start: e = path_dict[e.u] edge_path.append(e) return list(reversed(edge_path))if __name__ == "__main__": city_graph2: WeightedGraph[str] = WeightedGraph(["Seattle", "San Francisco", "Los Angeles", "Riverside", "Phoenix", "Chicago", "Boston", "New York", "Atlanta", "Miami", "Dallas", "Houston", "Detroit", "Philadelphia", "Washington"]) city_graph2.add_edge_by_vertices("Seattle", "Chicago", 1737) city_graph2.add_edge_by_vertices("Seattle", "San Francisco", 678) city_graph2.add_edge_by_vertices("San Francisco", "Riverside", 386) city_graph2.add_edge_by_vertices("San Francisco", "Los Angeles", 348) city_graph2.add_edge_by_vertices("Los Angeles", "Riverside", 50) city_graph2.add_edge_by_vertices("Los Angeles", "Phoenix", 357) city_graph2.add_edge_by_vertices("Riverside", "Phoenix", 307) city_graph2.add_edge_by_vertices("Riverside", "Chicago", 1704) city_graph2.add_edge_by_vertices("Phoenix", "Dallas", 887) city_graph2.add_edge_by_vertices("Phoenix", "Houston", 1015) city_graph2.add_edge_by_vertices("Dallas", "Chicago", 805) city_graph2.add_edge_by_vertices("Dallas", "Atlanta", 721) city_graph2.add_edge_by_vertices("Dallas", "Houston", 225) city_graph2.add_edge_by_vertices("Houston", "Atlanta", 702) city_graph2.add_edge_by_vertices("Houston", "Miami", 968) city_graph2.add_edge_by_vertices("Atlanta", "Chicago", 588) city_graph2.add_edge_by_vertices("Atlanta", "Washington", 543) city_graph2.add_edge_by_vertices("Atlanta", "Miami", 604) city_graph2.add_edge_by_vertices("Miami", "Washington", 923) city_graph2.add_edge_by_vertices("Chicago", "Detroit", 238) city_graph2.add_edge_by_vertices("Detroit", "Boston", 613) city_graph2.add_edge_by_vertices("Detroit", "Washington", 396) city_graph2.add_edge_by_vertices("Detroit", "New York", 482) city_graph2.add_edge_by_vertices("Boston", "New York", 190) city_graph2.add_edge_by_vertices("New York", "Philadelphia", 81) city_graph2.add_edge_by_vertices("Philadelphia", "Washington", 123) distances, path_dict = dijkstra(city_graph2, "Los Angeles") name_distance: Dict[str, Optional[int]] = distance_array_to_vertex_dict(city_graph2, distances) print("Distances from Los Angeles:") for key, value in name_distance.items(): print(f"&#123;key&#125; : &#123;value&#125;") print("") print("Shortest path from Los Angelges to Boston:") path: WeightedPath = path_dict_to_path(city_graph2.index_of("Los Angeles"), city_graph2.index_of("Boston"), path_dict) print_weighted_path(city_graph2, path) è¿è¡Œç»“æžœï¼š1234567891011121314151617181920212223Distances from Los Angeles:Seattle : 1026San Francisco : 348Los Angeles : 0Riverside : 50Phoenix : 357Chicago : 1754Boston : 2605New York : 2474Atlanta : 1965Miami : 2340Dallas : 1244Houston : 1372Detroit : 1992Philadelphia : 2511Washington : 2388Shortest path from Los Angelges to Boston:Los Angeles 50&gt; RiversideRiverside 1704&gt; ChicagoChicago 238&gt; DetroitDetroit 613&gt; BostonTotal Weight: 2605 å‚è€ƒèµ„æ–™Classic Computer Science Problems in Pythondavecom/ClassicComputerScienceProblemsInPython]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Algorithm</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Graph</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”åæ¨¡å¼]]></title>
    <url>%2F2021%2F02%2F03%2Fpython-design-patterns-anti-pattern%2F</url>
    <content type="text"><![CDATA[è½¯ä»¶è®¾è®¡æ¨¡å¼æä¾›äº†ä¸€å¥—è§„åˆ™æˆ–æ ‡å‡†ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘äººå‘˜åœ¨è®¾è®¡å±‚é¢è¿›è¡Œå†³ç­–ã€‚ä¸è‰¯çš„è®¾è®¡ä¸»è¦è¡¨çŽ°åœ¨å››ä¸ªæ–¹é¢ï¼š ä¸åŠ¨æ€§ï¼šå¼€å‘çš„åº”ç”¨ç¨‹åºéžå¸¸éš¾ä»¥é‡ç”¨ åˆšæ€§ï¼šä»»ä½•å°çš„æ›´æ”¹éœ€æ±‚éƒ½ä¼šå¯¼è‡´è½¯ä»¶çš„å¤ªå¤šéƒ¨åˆ†å¿…é¡»è¿›è¡Œç›¸åº”çš„æ”¹åŠ¨ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº« è„†å¼±æ€§ï¼šåº”ç”¨ç¨‹åºçš„ä»»ä½•æ›´æ”¹éƒ½ä¼šå¯¼è‡´çŽ°æœ‰ç³»ç»Ÿå˜å¾—éžå¸¸å®¹æ˜“å´©æºƒ ç²˜æ»žæ€§ï¼šç”±äºŽæž¶æž„å±‚é¢çš„ä¿®æ”¹éžå¸¸å›°éš¾ï¼Œä¿®æ”¹å¿…é¡»ç”±å¼€å‘äººå‘˜åœ¨ä»£ç å±‚é¢æˆ–çŽ¯å¢ƒæœ¬èº«ä¸­è¿›è¡Œ è½¯ä»¶å¼€å‘åæ¨¡å¼åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€ä¼šåç¦»æœ€åˆçš„ä»£ç ç»“æž„ï¼ŒåŽŸå› ä¸€èˆ¬æœ‰ï¼š å¼€å‘äººå‘˜çš„æƒ³æ³•ä¼šéšç€å¼€å‘è¿‡ç¨‹çš„æŽ¨è¿›è€Œå‘ç”Ÿå˜åŒ– ç”¨ä¾‹é€šå¸¸ä¼šéšç€å®¢æˆ·çš„åé¦ˆè€Œè¿›è¡Œæ›´æ”¹ æœ€åˆè®¾è®¡çš„æ•°æ®ç»“æž„å¯èƒ½ä¼šéšåŠŸèƒ½æˆ–å¯ä¼¸ç¼©æ€§ç­‰æ–¹é¢çš„è€ƒè™‘è€Œå‘ç”Ÿå˜åŒ– åŸºäºŽä¸Šè¿°åŽŸå› ï¼Œè½¯ä»¶é€šå¸¸éœ€è¦è¿›è¡Œé‡æž„ã€‚ æ„å¤§åˆ©é¢æ¡å¼ä»£ç  å…¸åž‹æˆå› åŒ…æ‹¬ï¼š å¯¹é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œåˆ†æžçš„æ— çŸ¥ æ²¡æœ‰è€ƒè™‘äº§å“çš„æž¶æž„æˆ–è®¾è®¡ å¿«é¤å¼æ€ç»´ é—®é¢˜ï¼š ç»“æž„çš„é‡ç”¨æ€§ä¼šé™åˆ°æœ€ä½Ž ç»´æŠ¤å·¥ä½œé‡è¿‡é«˜ è¿›è¡Œä¿®æ”¹æ—¶ï¼Œæ‰©å±•æ€§å’Œçµæ´»æ€§ä¼šé™ä½Ž é‡‘é”¤ é‡‘é”¤çš„æ„æ€æ˜¯ä¸€æŠŠé”¤å­æžå®šæ‰€æœ‰çš„é’‰å­ï¼ˆè§£å†³æ‰€æœ‰é—®é¢˜ï¼‰ã€‚è½¯ä»¶å¼€å‘äººå‘˜æˆ–å›¢é˜Ÿé€šå¸¸ä¼šæœ‰ä¸€ç§å€¾å‘ï¼Œä¸€å¤´æ‰Žè¿›ä¸€ä¸ªæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸ç®¡å…¶æ˜¯å¦æ»¡è¶³é€‚ç”¨æ€§ã€‚ å…¸åž‹æˆå› ï¼š æ¥è‡ªä¸äº†è§£å…·ä½“é—®é¢˜çš„é«˜å±‚çš„å»ºè®® æŸè§£å†³æ–¹æ¡ˆåœ¨è¿‡åŽ»å¤šæ¬¡éªŒè¯æœ‰æ•ˆï¼Œä½†å½“å‰é¡¹ç›®æœ‰ä¸åŒçš„èƒŒæ™¯å’Œè¦æ±‚ å…¬å¸å·²è¢«è¿™ç§æŠ€æœ¯â€œç»‘æž¶â€ï¼Œæˆ–å‘˜å·¥ä»¬å› ä¸ºé¡ºæ‰‹å¯¹è¿™ç§æŠ€æœ¯æƒ…æœ‰ç‹¬é’Ÿ é‡‘é”¤çš„å½±å“ï¼š ç—´è¿·äºŽä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå¹¶æŠŠå®ƒåº”ç”¨äºŽæ‰€æœ‰è½¯ä»¶é¡¹ç›® ä¸æ˜¯é€šè¿‡åŠŸèƒ½ï¼Œè€Œæ˜¯é€šè¿‡å¼€å‘ä¸­ä½¿ç”¨çš„æŠ€æœ¯æ¥æè¿°äº§å“ æ²¡æœ‰æ»¡è¶³éœ€æ±‚ï¼Œé€ æˆä¸Žç”¨æˆ·çš„é¢„æœŸä¸ç¬¦ ç†”å²©æµ ç†”å²©æµä¸Žè½¯ä»¶åº”ç”¨ä¸­çš„æ­»ä»£ç æˆ–ä¸€æ®µç”¨ä¸åˆ°çš„ä»£ç æœ‰å…³ï¼Œäººä»¬å®³æ€•ä¸€æ—¦å¯¹å…¶è¿›è¡Œä¿®æ”¹å°±ä¼šç ´åå…¶ä»–ä¸œè¥¿ã€‚éšç€æ—¶é—´çš„æµé€ï¼Œè¿™æ®µä»£ç ä¼šä¸€ç›´ç•™åœ¨è½¯ä»¶ä¸­å¹¶å›ºåŒ–å…¶ä½ç½®ï¼Œå°±åƒç†”å²©å˜æˆç¡¬å²©ä¸€æ ·ã€‚ ç†”å²©æµçš„æˆå› ï¼š åœ¨äº§å“ä¸­æœ‰å¤§é‡çš„è¯•é”™ä»£ç  ç”±ä¸€ä¸ªäººå•ç‹¬ç¼–å†™çš„ä»£ç ï¼Œæœªç»å®¡æŸ¥çš„æƒ…å†µä¸‹ç§»äº¤ç»™äº†å…¶ä»–å¼€å‘å›¢é˜Ÿ è½¯ä»¶æž¶æž„æˆ–è®¾è®¡çš„åˆå§‹æ€æƒ³æ˜¯é€šè¿‡ä»£ç åº“å®žçŽ°çš„ï¼Œä½†æ²¡æœ‰äººèƒ½ç†è§£ ç†”å²©æµçš„ç—‡çŠ¶ï¼š å¼€å‘çš„æµ‹è¯•å·¥ä½œå…·æœ‰å¾ˆä½Žçš„ä»£ç è¦†ç›–çŽ‡ ä»£ç ä¸­å«æœ‰èŽ«åå…¶å¦™çš„æ³¨é‡Š è¿‡æ—¶çš„æŽ¥å£ï¼Œæˆ–å¼€å‘äººå‘˜éœ€è¦å›´ç»•æ—¢æœ‰ä»£ç å±•å¼€å·¥ä½œ å¤åˆ¶ç²˜è´´å¼ç¼–ç¨‹ åŽŸå› ï¼š æ–°æ‰‹å¼€å‘è€…ä¸ä¹ æƒ¯ç¼–å†™ä»£ç æˆ–ä¸çŸ¥é“å¦‚ä½•å¼€å‘ å¿«é€Ÿä¿®å¤ bug æˆ–æ€¥å°±ç« å¼çš„å¼€å‘ ä»£ç é‡å¤ï¼Œæ— æ³•æ»¡è¶³è·¨æ¨¡å—æ ‡å‡†åŒ–ä»¥åŠä»£ç ç»“æž„åŒ–çš„è¦æ±‚ ç¼ºä¹é•¿è¿œæ‰“ç®—æˆ–æ·±è°‹è¿œè™‘ åŽæžœï¼š å¤šä¸ªè½¯ä»¶åº”ç”¨å­˜åœ¨åŒç§ç±»åž‹çš„é—®é¢˜ ç»´æŠ¤æˆæœ¬æ›´é«˜ï¼Œbug çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¼šå˜å¾—æ›´é•¿ è¾ƒå°‘çš„æ¨¡å—åŒ–ä»£ç åº“ï¼Œç›¸åŒçš„ä»£ç ä¼šæ•£è½äºŽå¤šå¤„ ç»§æ‰¿é—®é¢˜ è½¯ä»¶æž¶æž„åæ¨¡å¼é‡æ–°å‘æ˜Žè½®å­ åŽŸå› ï¼š ç¼ºä¹ä¸­å¤®æ–‡æ¡£æˆ–å­˜å‚¨åº“æ¥è®²è§£æž¶æž„çº§é—®é¢˜å’Œå­˜æ”¾å·²å®žçŽ°çš„è§£å†³æ–¹æ¡ˆ ç¤¾åŒºæˆ–å…¬å¸å†…çš„æŠ€æœ¯é¢†è¢–ä¹‹é—´ç¼ºä¹æ²Ÿé€š ç»„ç»‡ä¸­éµå¾ªçš„æµç¨‹æ˜¯ä»Žå¤´å¼€å§‹æž„å»ºçš„ åŽæžœï¼š è§£å†³ä¸€ä¸ªæ ‡å‡†é—®é¢˜çš„æ–¹æ¡ˆå¤ªå¤šï¼Œå…¶ä¸­æœ‰è®¸å¤šè€ƒè™‘å¾—å¹¶ä¸å‘¨å…¨ ä¼šè€—è´¹å·¥ç¨‹å›¢é˜Ÿæ›´å¤šçš„æ—¶é—´å’Œèµ„æºï¼Œå¯¼è‡´é¢„ç®—è¶…æ ‡ï¼Œå®Œæˆæ—¶é—´å»¶åŽ å°é—­çš„ç³»ç»Ÿæž¶æž„ã€é‡å¤åŠ³åŠ¨å’Œç³Ÿç³•çš„é£Žé™©ç®¡ç† ä¾›åº”å•†å¥—ç‰¢ åŽŸå› ï¼š ç†Ÿæ‚‰ä¾›åº”å•†å…¬å¸çš„æƒå¨äººå£«ä»¥åŠæŠ€æœ¯é‡‡è´­çš„å¯èƒ½æŠ˜æ‰£ åŸºäºŽè¥é”€å’Œé”€å”®ä¸šåŠ¡äººå‘˜è€Œä¸æ˜¯æŠ€æœ¯è¯„ä¼°é€‰æ‹©çš„æŠ€æœ¯ åœ¨å½“å‰é¡¹ç›®ä¸­ä½¿ç”¨ç»è¿‡éªŒè¯çš„æŠ€æœ¯ï¼Œå³ä½¿å®ƒä¸é€‚åˆå½“å‰é¡¹ç›®çš„éœ€è¦ æŠ€æœ¯äººå‘˜å·²ç»æŽ¥å—è¿‡ç›¸å…³æŠ€æœ¯çš„åŸ¹è®­ åŽæžœï¼š å…¬å¸äº§å“çš„å‘å¸ƒå‘¨æœŸå’Œç»´æŠ¤å‘¨æœŸç›´æŽ¥å–å†³äºŽä¾›åº”å•†çš„å‘å¸ƒæ—¶é—´ è¯¥äº§å“æ˜¯å›´ç»•è¯¥æŠ€æœ¯è€Œä¸æ˜¯æ ¹æ®å®¢æˆ·çš„è¦æ±‚å¼€æ”¾çš„ äº§å“ä¸Šå¸‚æ—¶é—´ä¸å¯é ï¼Œä¸èƒ½æ»¡è¶³å®¢æˆ·çš„æœŸæœ› å§”å‘˜ä¼šè®¾è®¡ åŽŸå› ï¼š æ ¹æ®ç»„ç»‡çš„æµç¨‹ï¼Œäº§å“çš„æž¶æž„æˆ–è®¾è®¡æ˜¯ç”±ä¼—å¤šçš„åˆ©ç›Šç›¸å…³è€…æ‰¹å‡†çš„ æ²¡æœ‰æŒ‡å®šå•ç‹¬çš„è”ç³»äººæˆ–è´Ÿè´£è®¾è®¡çš„æž¶æž„å¸ˆ ç”±è¥é”€æˆ–æŠ€æœ¯ä¸“å®¶ç¡®å®šè®¾è®¡ä¼˜å…ˆçº§ï¼Œè€Œä¸æ˜¯å®¢æˆ·åé¦ˆ ç—‡çŠ¶ï¼š å¼€å‘äººå‘˜å’Œæž¶æž„å¸ˆä¹‹é—´çš„è§‚ç‚¹å†²çªï¼Œå³ä½¿åœ¨è®¾è®¡å®ŒæˆåŽä¾æ—§å¦‚æ­¤ è¿‡äºŽå¤æ‚çš„è®¾è®¡ï¼Œå¾ˆéš¾è®°å½• è§„æ ¼æˆ–è®¾è®¡çš„ä»»ä½•æ”¹åŠ¨éƒ½éœ€è¦ç»è¿‡å¤šæ¬¡å®¡æŸ¥ï¼Œå¯¼è‡´å®žçŽ°å»¶è¿Ÿ]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºæœ¬ç®—æ³•é—®é¢˜çš„ Python è§£æ³•â€”â€”çº¦æŸæ»¡è¶³é—®é¢˜ï¼ˆCSPï¼‰]]></title>
    <url>%2F2021%2F02%2F03%2Fclassic-compute-problems-with-python-constraint-satisfaction-problems%2F</url>
    <content type="text"><![CDATA[ç”±è®¡ç®—å·¥å…·è§£å†³çš„å¾ˆå¤§ä¸€éƒ¨åˆ†é—®é¢˜éƒ½å¯ä»¥å½’ç±»ä¸ºçº¦æŸæ»¡è¶³é—®é¢˜ï¼ˆCSPs, constraint-satisfaction problemsï¼‰ã€‚CSP ä¸€èˆ¬åŒ…å«ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼šå˜é‡ï¼ˆvariablesï¼‰ã€åŸŸï¼ˆdomainsï¼‰å’Œçº¦æŸæ¡ä»¶ï¼ˆconstraintsï¼‰ã€‚ æ¯”å¦‚éœ€è¦åœ¨æ˜ŸæœŸäº”ä¸º Joeã€Maryã€Sue ä¸‰ä¸ªäººå®‰æŽ’ä¸€åœºä¼šè®®ï¼Œè¦æ±‚ Sue å¿…é¡»å’Œå¦å¤–çš„è‡³å°‘ä¸€ä¸ªäººåŒæ—¶åœ¨åœºã€‚é’ˆå¯¹æ­¤é—®é¢˜ï¼š Joeã€Maryã€Sue ä¸‰ä¸ªäººå³ä¸ºå˜é‡ï¼ˆvariablesï¼‰ æ¯ä¸ªäººï¼ˆå˜é‡ï¼‰å„è‡ªç©ºé—²çš„æ—¶é—´ç‚¹å³ä¸ºå¯¹åº”çš„åŸŸï¼ˆdomainsï¼‰ã€‚æ¯”å¦‚å˜é‡ Mary åœ¨ä¸‹åˆ 2 ç‚¹å’Œ 3 ç‚¹çš„æ—¶å€™æœ‰ç©ºï¼Œè¿™ä¸¤ä¸ªæ—¶é—´ç‚¹å³ä¸ºå˜é‡ Mary å¯¹åº”çš„åŸŸ çº¦æŸæ¡ä»¶ï¼ˆconstraintsï¼‰æœ‰ä¸¤ç‚¹ï¼šSue å¿…é¡»åœ¨åœºï¼›é™¤ Sue ä»¥å¤–è‡³å°‘è¿˜éœ€è¦å¦ä¸€äººåˆ°åœº æž„å»º CSP æ¡†æž¶çº¦æŸæ¡ä»¶é€šè¿‡ Constraint ç±»å®žçŽ°ã€‚è¯¥ç±»ä¸­åŒ…å«è¢«çº¦æŸçš„å˜é‡ä»¥åŠæµ‹è¯•å…¶æ˜¯å¦æ»¡è¶³çº¦æŸçš„ satisfied() æ–¹æ³•ã€‚ç¡®å®šæ˜¯å¦æ»¡è¶³çº¦æŸæ¡ä»¶æ˜¯é’ˆå¯¹æŸä¸ªç‰¹å®šçš„ CSP çš„æ ¸å¿ƒé€»è¾‘ï¼Œè¯¥ satisfied() æ–¹æ³•å¿…é¡»ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»è¦†ç›–åŽå‘æŒ¥å®žé™…ä½œç”¨ï¼Œä»¥æ»¡è¶³ä¸åŒé—®é¢˜çš„ä¸åŒçº¦æŸæ¡ä»¶ã€‚123456789101112131415# csp.pyfrom typing import Generic, TypeVar, Dict, List, Optionalfrom abc import ABC, abstractmethodV = TypeVar('V') # variable typeD = TypeVar('D') # domain typeclass Constraint(Generic[V, D], ABC): def __init__(self, variables: List[V]) -&gt; None: self.variables = variables @abstractmethod def satisfied(self, assignment: Dict[V, D]) -&gt; bool: pass çº¦æŸæ»¡è¶³æ¡†æž¶çš„æ ¸å¿ƒéƒ¨åˆ†ä»£ç æ˜¯ CSP ç±»ï¼Œè¯¥ç±»é›†ä¸­å¤„ç†å˜é‡ã€åŸŸå’Œçº¦æŸæ¡ä»¶ã€‚CSP çš„ç±»åž‹ä½¿ç”¨ Genericï¼Œç›®çš„æ˜¯ä½¿å…¶è¶³å¤Ÿçµæ´»ï¼Œèƒ½å¤Ÿå¤„ç†å„ç§ç±»åž‹çš„ variables å’Œ domainsã€‚å…¶ä¸­ variables æ˜¯ list ç±»åž‹ï¼Œdomains æ˜¯ç”± variable å’Œå¯¹åº”çš„ list ï¼ˆæ‰€æœ‰å¯èƒ½çš„å€¼ï¼‰å…³è”æˆçš„ dict ç±»åž‹ï¼Œconstraints åˆ™æ˜¯ç”± variable å’Œå¯¹åº”çš„ listï¼ˆçº¦æŸæ¡ä»¶åˆ—è¡¨ï¼‰å…³è”æˆçš„ dict ç±»åž‹ã€‚ __init__() åˆå§‹åŒ–æ–¹æ³•ä¼šåˆ›å»º constraints å­—å…¸ï¼Œå°† variables ä¸­çš„å€¼ä½œä¸ºé”®ï¼Œæ¯ä¸ªé”®å…³è”ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚add_constraint() æ–¹æ³•éåŽ† variables ä¸­çš„å€¼ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ constraints ä¸­çš„é”®ï¼‰ï¼Œå°†å¯¹åº”çš„ constraint æ·»åŠ åˆ° constraints å­—å…¸çš„è¯¥ variable é”®å…³è”çš„åˆ—è¡¨ä¸­ã€‚ä»Žè€Œå®Œæˆå¯¹ variablesã€domainsã€constraints ä¸‰ç±»æ•°æ®çš„åˆå§‹åŒ–ã€‚1234567891011121314151617# csp.pyclass CSP(Generic[V, D]): def __init__(self, variables: List[V], domains: Dict[V, List[D]]) -&gt; None: self.variables = variables self.domains = domains self.constraints: Dict[V, List[Constraint[V, D]]] = &#123;&#125; for variable in self.variables: self.constraints[variable] = [] if variable not in self.domains: raise LookupError("Every variable should have a domain assigned to it") def add_constraint(self, constraint: Constraint[V, D]) -&gt; None: for variable in constraint.variables: if variable not in self.variables: raise LookupError("Variable in constraint not in CSP") else: self.constraints[variable].append(constraint) consistent() æ–¹æ³•ç”¨äºŽæ£€æŸ¥ç»™å®šçš„ variable å¯¹åº”çš„æ¯ä¸€ä¸ªçº¦æŸæ¡ä»¶æ˜¯å¦ä¸€ä¸€ç¬¦åˆå½“å‰é¢„è®¾çš„æ–¹æ¡ˆã€‚è¿™ä¸ªä¸´æ—¶çš„æ–¹æ¡ˆç”¨ assignment è¡¨ç¤ºã€‚å³å…ˆæœ‰æŸä¸ª variableï¼Œç„¶åŽä¸ºå…¶é€‰æ‹©å¯¹åº”çš„ domain ä¸­çš„ä»»æ„ä¸€ä¸ªå€¼ä½œä¸ºä¸´æ—¶çš„ assignmentï¼Œå†æ£€æŸ¥è¯¥ assignment æ˜¯å¦ç¬¦åˆå¯¹åº”çš„ variable å…³è”çš„æ‰€æœ‰çº¦æŸæ¡ä»¶ã€‚123456# csp.pydef consistent(self, variable: V, assignment: Dict[V, D]) -&gt; bool: for constraint in self.constraints[variable]: if not constraint.satisfied(assignment): return False return True çº¦æŸæ»¡è¶³æ¡†æž¶è¿˜éœ€è¦ä¸€ä¸ªç®€å•çš„ backtracking æœç´¢ç”¨äºŽæŸ¥æ‰¾é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚Backtracking æ„å‘³ç€ä¸€æ—¦åœ¨æœç´¢è·¯å¾„çš„æŸä¸ªèŠ‚ç‚¹ä¸Šç»ˆæ­¢ï¼Œåˆ™è¿”å›žåˆ°ä¸Šä¸€ä¸ªå·²çŸ¥çš„æœç´¢èŠ‚ç‚¹ï¼Œé€‰æ‹©å¦ä¸€æ¡æœç´¢è·¯å¾„ã€‚æœ‰ç‚¹ç±»ä¼¼äºŽæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFS, depth-first searchï¼‰ã€‚12345678910111213141516def backtracking_search(self, assignment: Dict[V, D] = &#123;&#125;) -&gt; Optional[Dict[V, D]]: # assignment is complete if every variable is assigned if len(assignment) == len(self.variables): return assignment # get all variables in the CSP but not in the assignment unassigned: List[V] = [v for v in self.variables if v not in assignment] first: V = unassigned[0] for value in self.domains[first]: local_assignment = assignment.copy() local_assignment[first] = value if self.consistent(first, local_assignment): result: Optional[Dict[V, D]] = self.backtracking_search(local_assignment) if result is not None: return result return None é€æ¡åˆ†æžä»¥ä¸Šä»£ç ï¼š12if len(assignment) == len(self.variables): return assignment ä¸Šé¢çš„ backtracking æœç´¢é‡‡ç”¨äº†é€’å½’çš„å½¢å¼ï¼Œæ­¤ if è¯­å¥åˆ™æä¾›äº†ä¸€ç§é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ã€‚å³å½“æ‰€æœ‰ variable éƒ½è¢«èµ‹äºˆäº†åˆæ³•çš„å€¼æ—¶ï¼Œæ„å‘³ç€å…¶ä¸­ä¸€ç§æ­é…æ–¹æ¡ˆå·²è¢«æ‰¾åˆ°ï¼Œåˆ™åœæ­¢è¿›ä¸€æ­¥çš„æœç´¢ï¼Œè¿”å›žè¯¥æ­é…æ–¹æ¡ˆã€‚ 12unassigned: List[V] = [v for v in self.variables if v not in assignment]first: V = unassigned[0] å–å‡º variables ä¸­ç¬¬ä¸€ä¸ªè¿˜æœªè¢«èµ‹å€¼ï¼ˆæœªåšé€‰æ‹©ï¼‰çš„ variableï¼Œä½œä¸ºä¸‹ä¸€æ­¥ä¸­è¿›è¡Œèµ‹å€¼ï¼ˆåšå†³å®šï¼‰å’Œçº¦æŸæ¡ä»¶æµ‹è¯•çš„å¯¹è±¡ã€‚ 1234if self.consistent(first, local_assignment): result: Optional[Dict[V, D]] = self.backtracking_search(local_assignment) if result is not None: return result ä¸ºå‰é¢æœªèµ‹å€¼çš„æŸä¸ª variable â€œåšå†³å®šâ€ã€‚å°†å¯¹åº”çš„ domain ä¸­æ‰€æœ‰å­˜åœ¨çš„å€¼ä¾æ¬¡èµ‹å€¼ç»™è¯¥ variableï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ–¹æ¡ˆï¼ˆlocal_assignmentï¼‰ã€‚è‹¥è¯¥æ–¹æ¡ˆç¬¦åˆæ‰€æœ‰çš„çº¦æŸæ¡ä»¶ï¼ˆé€šè¿‡ consistent() æ–¹æ³•æ£€æµ‹ï¼‰ï¼Œåˆ™å€ŸåŠ©é€’å½’è¿›è¡Œä¸‹ä¸€è½®å¯¹å¦ä¸€ä¸ª variable çš„èµ‹å€¼ï¼Œç›´åˆ°è§¦å‘ç»ˆæ­¢æ¡ä»¶ï¼ˆæ‰€æœ‰ variable éƒ½è¢«èµ‹å€¼ï¼‰ã€‚ return None è‹¥é’ˆå¯¹æŸä¸ªç‰¹å®šçš„ variableï¼Œå·²ç»æ£€æŸ¥å®Œ domain ä¸­åŒ…å«çš„æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œä»æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„æ–¹æ¡ˆï¼Œåˆ™è¿”å›ž None è¡¨ç¤ºæ²¡æœ‰è§£å†³ã€‚è¿™ä¼šå¯¼è‡´ backtracking æœç´¢ç»“æŸæœ¬è½® for å¾ªçŽ¯ï¼Œè¿”å›žåˆ°é€’å½’çš„ä¸Šä¸€å±‚ä¸­çš„ for å¾ªçŽ¯ï¼Œå°è¯•ä¸ºä¸Šä¸€æ­¥ä¸­å·²èµ‹å€¼çš„ variable åšå‡ºä¸åŒçš„å†³å®šï¼Œå¹¶ç»§ç»­é€’å½’ï¼ˆæˆ–å›žæº¯ï¼‰ä¸‹åŽ»ã€‚ åœ°å›¾ä¸Šè‰²é—®é¢˜å‡å¦‚æœ‰ä¸€å¼ æ¾³å¤§åˆ©äºšåœ°å›¾ï¼Œéœ€è¦æŒ‰å·žè¿›è¡Œä¸Šè‰²ã€‚è¦æ±‚æ‰€æœ‰ç›¸é‚»çš„å·žä¸èƒ½æœ‰ç›¸åŒçš„é¢œè‰²ã€‚ å€ŸåŠ©å‰é¢æž„å»ºçš„çº¦æŸç¬¦åˆæ¡†æž¶ï¼Œå®žçŽ°ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647# map_coloring.pyfrom csp import Constraint, CSPfrom typing import Dict, List, Optionalclass MapColoringConstraint(Constraint[str, str]): def __init__(self, place1: str, place2: str) -&gt; None: super().__init__([place1, place2]) self.place1 = place1 self.place2 = place2 def satisfied(self, assignment: Dict[str, str]) -&gt; bool: # if either place is not in the assignment, then it is not # yet possible for their colors to be conflicting if self.place1 not in assignment or self.place2 not in assignment: return True # check the color assigned to place1 is not the same as the # color assigned to place2 return assignment[self.place1] != assignment[self.place2]if __name__ == "__main__": variables: List[str] = ["Western Australia", "Northern Territory", "South Australia", "Queensland", "New South Wales", "Victoria", "Tasmania"] domains: Dict[str, List[str]] = &#123;&#125; for variable in variables: domains[variable] = ["red", "green", "blue"] csp: CSP[str, str] = CSP(variables, domains) csp.add_constraint(MapColoringConstraint("Western Australia", "Northern Territory")) csp.add_constraint(MapColoringConstraint("Western Australia", "South Australia")) csp.add_constraint(MapColoringConstraint("South Australia", "Northern Territory")) csp.add_constraint(MapColoringConstraint("Queensland", "Northern Territory")) csp.add_constraint(MapColoringConstraint("Queensland", "South Australia")) csp.add_constraint(MapColoringConstraint("Queensland", "New South Wales")) csp.add_constraint(MapColoringConstraint("New South Wales", "South Australia")) csp.add_constraint(MapColoringConstraint("Victoria", "South Australia")) csp.add_constraint(MapColoringConstraint("Victoria", "New South Wales")) csp.add_constraint(MapColoringConstraint("Victoria", "Tasmania")) solution: Optional[Dict[str, str]] = csp.backtracking_search() if solution is None: print("No solution found") else: print(solution)# =&gt; &#123;'Western Australia': 'red', 'Northern Territory': 'green', 'South# Australia': 'blue', 'Queensland': 'red', 'New South Wales': 'green',# 'Victoria': 'red', 'Tasmania': 'green'&#125; ç®€å•æ¢³ç†ä¸€ä¸‹ç¨‹åºé€»è¾‘ï¼š åœ¨ä¸Šè¿° CSP ä¸­ï¼Œåœ°å›¾ä¸­çš„ 7 ä¸ªå·žå³ä¸º variablesï¼ˆä¸ºæ–¹ä¾¿ï¼Œä»¥ aã€bã€cã€dã€eã€fã€g ä»£æ›¿ï¼‰variables = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;] æ¯ä¸ªå·žéƒ½å¯ä»¥æ¶‚æˆçº¢ç»¿è“ä¸‰ç§é¢œè‰²ï¼ˆå‡è®¾ç”¨ 1ã€2ã€3 æŒ‡ä»£ï¼‰ä¸­çš„ä»»ä½•ä¸€ç§ï¼Œå„ variable å¯¹åº”çš„æ‰€æœ‰é¢œè‰²å³ç»„æˆå¯¹åº” variable çš„ domainï¼šdomains = {&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [1, 2, 3], &#39;c&#39;: [1, 2, 3], &#39;d&#39;: [1, 2, 3], &#39;e&#39;: [1, 2, 3], &#39;f&#39;: [1, 2, 3], &#39;g&#39;: [1, 2, 3]} constraints çš„é€»è¾‘åœ¨ MapColoringConstraints ç±»ä¸­å®žçŽ°ï¼Œå³å·²ç»æ¶‚è‰²çš„ç›¸é‚»çš„ä¸¤ä¸ªå·žè‰²å½©é¡»ä¸ä¸€è‡´ã€‚æ¯”å¦‚ a ä¸Ž b ç›¸é‚»ï¼Œåˆ™è¯¥ constraint çš„è¡¨ç¤ºå¦‚ä¸‹ï¼šMapColoringConstraint(&#39;a&#39;, &#39;b&#39;)è€Œæ‰€æœ‰çš„ constraints éƒ½ä¼šå…³è”åˆ°å¯¹åº”çš„ä»¥ variable ä¸ºé”®çš„å­—å…¸ä¸­ã€‚å³è‹¥ a åŒæ—¶ä¸Ž b å’Œ c ç›¸é‚»ï¼Œåˆ™å˜é‡ a çš„ constraints è¡¨ç¤ºä¸ºï¼š{&#39;a&#39;: [MapColoringConstraint(&#39;a&#39;, &#39;b&#39;), MapColoringConstraint(&#39;a&#39;, &#39;c&#39;)]} backtrack_search() æ–¹æ³•çš„æ‰§è¡Œæµç¨‹ä¸ºï¼š åœ¨ variables ä¸­å–ç¬¬ä¸€ä¸ªæœªè¢«èµ‹å€¼ï¼ˆæ¶‚è‰²ï¼‰çš„ variableï¼Œä¸ºå…¶èµ‹äºˆå¯¹åº” domain ä¸­çš„æŸä¸ªæ•°å€¼ä½œä¸ºä¸´æ—¶æ–¹æ¡ˆ ç”¨è¯¥ variable å¯¹åº”çš„æ‰€æœ‰ constraints æµ‹è¯•ä¸Šè¿°ä¸´æ—¶æ–¹æ¡ˆçš„å¯è¡Œæ€§ã€‚è‹¥ç¬¦åˆè¦æ±‚ï¼Œåˆ™å€ŸåŠ©é€’å½’å¼€å¯ä¸‹ä¸€è½®å¾ªçŽ¯ï¼Œç»§ç»­ä¸ºå¦ä¸€ä¸ªæœªè¢«èµ‹å€¼ï¼ˆæ¶‚è‰²ï¼‰çš„ variable èµ‹å€¼ è‹¥ä¸ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç»§ç»­æœ¬è½®å¾ªçŽ¯ï¼Œä¸ºæœ¬ variable èµ‹äºˆ domain ä¸­çš„å¦ä¸€ä¸ªå€¼ è‹¥å¯¹åº” domain ä¸­çš„æ‰€æœ‰å€¼èµ‹äºˆ variable åŽéƒ½ä¸èƒ½ç¬¦åˆçº¦æŸè¦æ±‚ï¼Œåˆ™è¿”å›ž Noneã€‚æœ¬è½®å¾ªçŽ¯ç»“æŸï¼Œå›žåˆ°é€’å½’çš„ä¸Šä¸€è½®ç»§ç»­å¾ªçŽ¯ï¼Œä¸ºä¸Šä¸€è½®ä¸­å·²èµ‹å€¼çš„ variable èµ‹äºˆä¸åŒçš„å€¼ï¼Œå»¶ç»­é€’å½’æ“ä½œ è‹¥æ‰€æœ‰ variable éƒ½å·²è¢«èµ‹å€¼ï¼Œåˆ™è¿”å›ž variable åŠå…¶å¯¹åº”çš„å€¼ä½œä¸ºæœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼›è‹¥æ‰€æœ‰å¾ªçŽ¯ï¼ˆé€’å½’/å›žæº¯ï¼‰ç»“æŸï¼Œè¿”å›žç»“æžœæœ€ç»ˆä¸º Noneï¼Œåˆ™è¡¨ç¤ºæ— æ³•æ‰¾åˆ°åˆç†çš„è§£å†³æ–¹æ¡ˆ å›½é™…è±¡æ£‹çš„å…«çŽ‹åŽé—®é¢˜å›½é™…è±¡æ£‹çš„æ£‹ç›˜ç”± 8x8 çš„æ–¹æ ¼ç»„æˆï¼Œæ£‹å­è½äºŽæ–¹æ ¼ä¸Šã€‚è€Œæ£‹å­çŽ‹åŽèƒ½å¤ŸåƒæŽ‰å¤„äºŽåŒä¸€è¡Œã€åŒä¸€åˆ—ã€åŒä¸€æ–œçº¿ä¸Šçš„ä»»ä½•ä¸€ä¸ªæ•Œæ–¹æ£‹å­ã€‚å…«çŽ‹åŽé—®é¢˜æ˜¯æŒ‡éœ€è¦å°† 8 ä¸ªçŽ‹åŽæ”¾ç½®åˆ°å›½é™…è±¡æ£‹æ£‹ç›˜ä¸Šä¸”å½¼æ­¤ä¹‹é—´ä¸ä¼šäº§ç”Ÿå†²çªï¼ˆå³ä¸ä¼šæœ‰ä»»æ„ä¸¤æžšæ£‹å­ä½äºŽåŒä¸€è¡Œã€åŒä¸€åˆ—æˆ–è€…åŒä¸€æ–œçº¿ä¸Šï¼‰ã€‚ å…¶ä¸­ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹å›¾ï¼š å®žçŽ°ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637from csp import Constraint, CSPfrom typing import Dict, List, Optionalclass QueensConstraint(Constraint[int, int]): def __init__(self, columns: List[int]) -&gt; None: super().__init__(columns) self.columns = columns def satisfied(self, assignment: Dict[int, int]) -&gt; bool: # q1c = queen 1 column, q1r = queen 1 row for q1c, q1r in assignment.items(): # q2c = queen 2 column for q2c in range(q1c + 1, len(self.columns) + 1): if q2c in assignment: q2r = assignment[q2c] if q1r == q2r: # same row? return False if abs(q1r - q2r) == abs(q1c - q2c): # same diagonal? return False return Trueif __name__ == "__main__": columns: List[int] = [1, 2, 3, 4, 5, 6, 7, 8] rows: Dict[int, List[int]] = &#123;&#125; for column in columns: rows[column] = [1, 2, 3, 4, 5, 6, 7, 8] csp: CSP[int, int] = CSP(columns, rows) csp.add_constraint(QueensConstraint(columns)) solution: Optional[Dict[int, int]] = csp.backtracking_search() if solution is None: print("No solution found!") else: print(solution)# =&gt; &#123;1: 1, 2: 5, 3: 8, 4: 6, 5: 3, 6: 7, 7: 2, 8: 4&#125; ç®€å•è§£é‡Šä¸‹ satisfied() æ–¹æ³•ä¸­çš„ä¸¤ä¸ª for å¾ªçŽ¯ã€‚assignment é‡‡ç”¨ç±»ä¼¼ {1: 1, 2: 5, 3: 8, 4: 6, 5: 3, 6: 7, 7: 2, 8: 4} çš„å­—å…¸ç±»åž‹ï¼ˆä¸€å¼€å§‹ä¼šçŸ­ä¸€äº›ï¼‰ï¼Œä¸Šè¿°ä¸¤ä¸ª for å¾ªçŽ¯çš„ä½œç”¨åœ¨äºŽï¼Œå…ˆä»¥æ£‹ç›˜ä¸Šçš„ç¬¬ä¸€åˆ—ä¸ºæ ‡å‡†ï¼Œè‹¥ç¬¬ä¸€åˆ—ä¸Žå‰©ä½™çš„å‡ åˆ—ä¸å­˜åœ¨å†²çªï¼Œåˆ™åŽ»æŽ‰ç¬¬ä¸€åˆ—ï¼Œå†æ¯”è¾ƒç¬¬äºŒåˆ—ä¸Žå‰©ä½™çš„å‡ åˆ—æ˜¯å¦å­˜åœ¨å†²çªï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä¸€æ—¦å‡ºçŽ°ä»»ä½•å†²çªï¼Œåˆ™è¿”å›ž Falseã€‚ å‚è€ƒèµ„æ–™Classic Computer Science Problems in Pythondavecom/ClassicComputerScienceProblemsInPython]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Algorithm</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>CSP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”è§‚å¯Ÿè€…æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F29%2Fpython-design-patterns-observer-pattern%2F</url>
    <content type="text"><![CDATA[è¡Œä¸ºåž‹æ¨¡å¼ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼åˆ›å»ºåž‹æ¨¡å¼ï¼ˆæ¯”å¦‚å•ä¾‹æ¨¡å¼ï¼‰æ˜¯åŸºäºŽå¯¹è±¡çš„åˆ›å»ºæœºåˆ¶çš„ï¼Œè¿™äº›æ¨¡å¼éš”ç¦»äº†å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ï¼Œä½¿å¾—å®žçŽ°è¿™äº›ç»†èŠ‚çš„ä»£ç èƒ½å¤Ÿä¸Žè¦åˆ›å»ºçš„å¯¹è±¡ç±»åž‹ç›¸äº’ç‹¬ç«‹ã€‚ç»“æž„åž‹æ¨¡å¼ï¼ˆæ¯”å¦‚é—¨é¢æ¨¡å¼ï¼‰ç”¨äºŽè®¾è®¡å¯¹è±¡å’Œç±»çš„ç»“æž„ï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿç›¸äº’åä½œä»¥å½¢æˆæ›´å¤§çš„ç»“æž„ã€‚é‡ç‚¹æ˜¯ç»“æž„çš„ç®€åŒ–ä»¥åŠè¯†åˆ«ç±»å’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚è¡Œä¸ºåž‹æ¨¡å¼ï¼ˆæ¯”å¦‚è§‚å¯Ÿè€…æ¨¡å¼ï¼‰ä¸»è¦å…³æ³¨çš„æ˜¯å¯¹è±¡çš„è´£ä»»ï¼Œå¤„ç†å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä»¥å®žçŽ°æ›´å¤æ‚çš„åŠŸèƒ½ã€‚å¯¹è±¡ä¹‹é—´åº”è¯¥å¯ä»¥å½¼æ­¤äº¤äº’ï¼Œä¸”åº”è¯¥æ˜¯æ¾è€¦åˆçš„ã€‚ åœ¨è§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼ä¸­ï¼Œå¯¹è±¡ï¼ˆä¸»é¢˜ï¼‰ç»´æŠ¤äº†ä¸€ä¸ªä¾èµ–ï¼ˆè§‚å¯Ÿè€…ï¼‰åˆ—è¡¨ï¼Œä»¥ä¾¿ä¸»é¢˜å¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…å®šä¹‰çš„ä»»ä½•æ–¹æ³•é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å®ƒæ‰€å‘ç”Ÿçš„å˜åŒ–ã€‚ åœ¨åˆ†å¸ƒå¼åº”ç”¨ä¸­ï¼Œå¤šä¸ªæœåŠ¡é€šå¸¸æ˜¯é€šè¿‡å½¼æ­¤äº¤äº’æ¥å®žçŽ°æ›´å¤§åž‹çš„æ“ä½œçš„ã€‚æœåŠ¡å¯ä»¥æ‰§è¡Œå¤šç§æ“ä½œï¼Œä½†å®ƒä»¬æ‰§è¡Œçš„æ“ä½œä¼šç›´æŽ¥æˆ–å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºŽå…¶äº¤äº’çš„æœåŠ¡å¯¹è±¡çš„çŠ¶æ€ã€‚æ¯”å¦‚ç”¨æˆ·æ³¨å†Œçš„ç¤ºä¾‹ï¼Œå…¶ä¸­ç”¨æˆ·æœåŠ¡è´Ÿè´£å“åº”ç”¨æˆ·åœ¨ç½‘ç«™ä¸Šçš„å„ç§æ“ä½œã€‚å‡è®¾æœ‰å¦ä¸€ä¸ªç”µå­é‚®ä»¶çš„æœåŠ¡ï¼Œå…¶ä½œç”¨æ˜¯ç›‘è§†ç”¨æˆ·çš„çŠ¶æ€å¹¶å‘ç”¨æˆ·å‘é€ç”µå­é‚®ä»¶ã€‚è‹¥ç”¨æˆ·åˆšåˆšæ³¨å†Œï¼Œåˆ™ç”¨æˆ·æœåŠ¡å°†è°ƒç”¨ç”µå­é‚®ä»¶æœåŠ¡çš„æ–¹æ³•ï¼Œå‘ç”¨æˆ·å‘é€é‚®ä»¶è¿›è¡Œè´¦æˆ·éªŒè¯ã€‚è‹¥è´¦æˆ·ç»è¿‡äº†éªŒè¯ï¼Œä½†ä¿¡ç”¨åº¦è¾ƒä½Žï¼Œåˆ™ç”µå­é‚®ä»¶æœåŠ¡å°†ç›‘è§†ç”¨æˆ·æœåŠ¡å¹¶å‘ç”¨æˆ·å‘é€ä¿¡ç”¨åº¦è¿‡ä½Žçš„ç”µå­é‚®ä»¶è­¦æŠ¥ã€‚ å› æ­¤ï¼Œè‹¥åº”ç”¨ä¸­å­˜åœ¨ä¸€ä¸ªè®¸å¤šå…¶ä»–æœåŠ¡æ‰€ä¾èµ–çš„æ ¸å¿ƒæœåŠ¡ï¼Œè¯¥æ ¸å¿ƒæœåŠ¡å°±ä¼šæˆä¸ºè§‚å¯Ÿè€…å¿…é¡»è§‚å¯Ÿ/ç›‘è§†å˜åŒ–çš„ä¸»é¢˜ã€‚å½“ä¸»é¢˜å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…åº”è¯¥æ”¹å˜è‡ªèº«å¯¹è±¡çŠ¶æ€ï¼Œæˆ–è€…é‡‡å–æŸäº›åŠ¨ä½œã€‚ä»Žå±žæœåŠ¡ç›‘è§†æ ¸å¿ƒæœåŠ¡çš„çŠ¶æ€å˜åŒ–æ˜¯è§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼çš„ç»å…¸æƒ…å¢ƒã€‚ è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸»è¦ç›®æ ‡ å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œä½¿å¾—å¯¹è±¡ä¸­çš„ä»»ä½•æ›´æ”¹éƒ½å°†è‡ªåŠ¨é€šçŸ¥ç»™å…¶ä»–ä¾èµ–å¯¹è±¡ å°è£…äº†ä¸»é¢˜çš„æ ¸å¿ƒç»„ä»¶ è§‚å¯Ÿè€…æ¨¡å¼çš„åŸºæœ¬å®žçŽ° 12345678910111213141516171819202122232425262728293031323334class Subject: def __init__(self): self.__observers = [] def register(self, observer): self.__observers.append(observer) def notifyAll(self, *args, **kwargs): for observer in self.__observers: observer.notify(subject, *args, **kwargs)class Observer1: def __init__(self, subject): subject.register(self) def notify(self, subject, *args): print(type(self).__name__, ':: Got', args, 'From', subject)class Observer2: def __init__(self, subject): subject.register(self) def notify(self, subject, *args): print(type(self).__name__, ':: Got', args, 'From', subject)subject = Subject()observer1 = Observer1(subject)observer2 = Observer2(subject)subject.notifyAll('notification')# =&gt; Observer1 :: Got ('notification',) From &lt;__main__.Subject object at 0x7f9a1276fa60&gt;# =&gt; Observer2 :: Got ('notification',) From &lt;__main__.Subject object at 0x7f9a1276fa60&gt; çŽ°å®žä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485class NewsPublisher: def __init__(self): self.__subscribers = [] self.__latestNews = None def attach(self, subscriber): self.__subscribers.append(subscriber) def detach(self): return self.__subscribers.pop() def subscribers(self): return [type(x).__name__ for x in self.__subscribers] def notifySubscribers(self): for sub in self.__subscribers: sub.update() def addNews(self, news): self.__latestNews = news def getNews(self): return "Got News: " + self.__latestNewsfrom abc import ABCMeta, abstractmethodclass Subscriber(metaclass=ABCMeta): @abstractmethod def update(self): passclass SMSSubscriber(Subscriber): def __init__(self, publisher): self.publisher = publisher self.publisher.attach(self) def update(self): print(type(self).__name__, self.publisher.getNews())class EmailSubscriber(Subscriber): def __init__(self, publisher): self.publisher = publisher self.publisher.attach(self) def update(self): print(type(self).__name__, self.publisher.getNews())class AnyOtherSubscriber: def __init__(self, publisher): self.publisher = publisher self.publisher.attach(self) def update(self): print(type(self).__name__, self.publisher.getNews())if __name__ == '__main__': news_publisher = NewsPublisher() for Subscriber in [SMSSubscriber, EmailSubscriber, AnyOtherSubscriber]: Subscriber(news_publisher) print("\nSubscribers: ", news_publisher.subscribers()) news_publisher.addNews('Hello World') news_publisher.notifySubscribers() print("\nDetached: ", type(news_publisher.detach()).__name__) print("\nSubscribers: ", news_publisher.subscribers()) news_publisher.addNews('My second news') news_publisher.notifySubscribers()# =&gt; Subscribers: ['SMSSubscriber', 'EmailSubscriber', 'AnyOtherSubscriber']# =&gt; SMSSubscriber Got News: Hello World# =&gt; EmailSubscriber Got News: Hello World# =&gt; AnyOtherSubscriber Got News: Hello World# =&gt; Detached: AnyOtherSubscriber# =&gt; Subscribers: ['SMSSubscriber', 'EmailSubscriber']# =&gt; SMSSubscriber Got News: My second news# =&gt; EmailSubscriber Got News: My second news æ¾è€¦åˆä¸Žè§‚å¯Ÿè€…æ¨¡å¼æ¾è€¦åˆæž¶æž„çš„ç‰¹æ€§ï¼š é™ä½Žäº†ä¸€ä¸ªå…ƒç´ å†…å‘ç”Ÿçš„æ›´æ”¹å¯èƒ½å¯¹å…¶ä»–å…ƒç´ äº§ç”Ÿæ„å¤–å½±å“çš„é£Žé™© ä½¿å¾—æµ‹è¯•ã€ç»´æŠ¤å’Œæ•…éšœæŽ’é™¤å·¥ä½œæ›´åŠ ç®€å• ç³»ç»Ÿå¯ä»¥è½»æ¾åœ°åˆ†è§£ä¸ºå¯å®šä¹‰çš„å…ƒç´  è§‚å¯Ÿè€…æ¨¡å¼æä¾›äº†ä¸€ç§å®žçŽ°ä¸»ä½“å’Œè§‚å¯Ÿè€…æ¾è€¦åˆçš„å¯¹è±¡è®¾è®¡æ¨¡å¼ï¼š ä¸»é¢˜å¯¹è§‚å¯Ÿè€…å”¯ä¸€çš„äº†è§£å°±æ˜¯å®ƒå®žçŽ°çš„ä¸€ä¸ªç‰¹å®šçš„æŽ¥å£ å¯ä»¥éšæ—¶æ·»åŠ ä»»æ„çš„æ–°è§‚å¯Ÿè€… æ·»åŠ æ–°è§‚å¯Ÿè€…æ—¶ï¼Œå®Œå…¨æ— éœ€ä¿®æ”¹ä¸»é¢˜ è§‚å¯Ÿè€…æˆ–ä¸»é¢˜æ²¡æœ‰ç»‘å®šåœ¨ä¸€èµ·ï¼Œå¯ä»¥å½¼æ­¤ç‹¬ç«‹ä½¿ç”¨ã€‚è§‚å¯Ÿè€…å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é‡å¤ä½¿ç”¨ ä¸»é¢˜æˆ–è§‚å¯Ÿè€…ä¸­çš„å˜åŒ–ä¸ä¼šç›¸äº’å½±å“ è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š ä½¿å¾—å½¼æ­¤äº¤äº’çš„å¯¹è±¡ä¹‹é—´ä¿æŒæ¾è€¦åˆ ä½¿å¾—å¯ä»¥åœ¨æ— éœ€å¯¹ä¸»é¢˜æˆ–è§‚å¯Ÿè€…è¿›è¡Œä»»ä½•ä¿®æ”¹çš„æƒ…å†µä¸‹é«˜æ•ˆåœ°å‘é€æ•°æ®åˆ°å…¶ä»–å¯¹è±¡ å¯ä»¥éšæ—¶æ·»åŠ /åˆ é™¤è§‚å¯Ÿè€… ç¼ºç‚¹ï¼š è§‚å¯Ÿè€…æŽ¥å£å¿…é¡»ç”±å…·ä½“è§‚å¯Ÿè€…å®žçŽ°ï¼Œæ¶‰åŠç»§æ‰¿ï¼Œä¸”æ— æ³•è¿›è¡Œç»„åˆ è‹¥å®žçŽ°ä¸å½“çš„è¯ï¼Œè§‚å¯Ÿè€…å¯èƒ½ä¼šå¢žåŠ å¤æ‚æ€§ï¼Œå¯¼è‡´æ€§èƒ½é™ä½Ž åœ¨è½¯ä»¶åº”ç”¨ä¸­ï¼Œé€šçŸ¥æœ‰æ—¶æ˜¯ä¸å¯é çš„ï¼Œå¹¶å¯¼è‡´ç«žäº‰æ¡ä»¶ä¸ä¸€è‡´]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”æ¨¡æ¿æ–¹æ³•æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F29%2Fpython-design-patterns-template-pattern%2F</url>
    <content type="text"><![CDATA[è¡Œä¸ºæ¨¡å¼ä¸»è¦å…³æ³¨å¯¹è±¡çš„å“åº”æ€§ï¼Œå¤„ç†å¯¹è±¡ä¹‹é—´çš„äº¤äº’ä»¥å®žçŽ°æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚æ¨¡æ¿æ–¹æ³•æ¨¡å¼å³ä¸ºä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ã€‚æ¯”å¦‚å¯ä»¥å°†åˆ¶ä½œé¥®æ–™çš„æ­¥éª¤å®šä¹‰ä¸ºæ¨¡æ¿æ–¹æ³•ä¸­çš„ç®—æ³•ï¼Œå­ç±»å°±èƒ½ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¥å®žçŽ°æ²èŒ¶çš„æ­¥éª¤ã€‚ä¸”æ­¥éª¤çš„æ”¹å˜ï¼ˆå³å­ç±»çš„å…·ä½“å®žçŽ°ï¼‰å¹¶ä¸ä¼šå½±å“åŽŸå§‹ç®—æ³•çš„ç»“æž„ã€‚è¿™æ ·æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„å­ç±»å°±å¯ä»¥é€šè¿‡è¦†ç›–æ¥åˆ›å»ºä¸åŒçš„è¡Œä¸ºã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼é€‚ç”¨äºŽä»¥ä¸‹åœºæ™¯ï¼š å½“å¤šä¸ªç®—æ³•æˆ–ç±»å®žçŽ°ç±»ä¼¼æˆ–ç›¸åŒé€»è¾‘çš„æ—¶å€™ åœ¨å­ç±»ä¸­å®žçŽ°ç®—æ³•æœ‰åŠ©äºŽå‡å°‘é‡å¤ä»£ç çš„æ—¶å€™ å­ç±»å¯ä»¥é€šè¿‡è¦†ç›–å®žçŽ°å¤šç§ä¸åŒè¡Œä¸ºçš„æ—¶å€™ æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä¸»è¦æ„å›¾ï¼š ä½¿ç”¨åŸºæœ¬æ“ä½œå®šä¹‰ç®—æ³•çš„æ¡†æž¶ é‡æ–°å®šä¹‰å­ç±»çš„æŸäº›æ“ä½œï¼Œæ— éœ€ä¿®æ”¹ç®—æ³•çš„ç»“æž„ å®žçŽ°ä»£ç é‡ç”¨å¹¶é¿å…é‡å¤å·¥ä½œ åˆ©ç”¨é€šç”¨æŽ¥å£æˆ–åŠŸèƒ½å®žçŽ° AbstractClassï¼šåœ¨æŠ½è±¡æ–¹æ³•çš„å¸®åŠ©ä¸‹å®šä¹‰ç®—æ³•çš„æ“ä½œæˆ–æ­¥éª¤ã€‚è¿™äº›æ­¥éª¤å°†è¢«å…·ä½“çš„å­ç±»è¦†ç›– template_method()ï¼šå®šä¹‰ç®—æ³•çš„æ¡†æž¶ã€‚åœ¨æ¨¡æ¿æ–¹æ³•ä¸­è°ƒç”¨æŠ½è±¡æ–¹æ³•å®šä¹‰çš„æ­¥éª¤ä»¥å½¢æˆåºåˆ—æˆ–ç®—æ³• ConcreteClassï¼šå®žçŽ°éœ€è¦ç®—æ³•å­ç±»å…³æ³¨çš„ç‰¹å®šæ­¥éª¤ 12345678910111213141516171819202122232425262728293031323334353637from abc import ABCMeta, abstractmethodclass Compiler(metaclass=ABCMeta): @abstractmethod def collectSource(self): pass @abstractmethod def compileToObject(self): pass @abstractmethod def run(self): pass def compileAndRun(self): self.collectSource() self.compileToObject() self.run()class iOSCompiler(Compiler): def collectSource(self): print("Collecting Swift Source Code") def compileToObject(self): print("Compiling Swift code to LLVM bitcode") def run(self): print("Program runing on runtime environment")iOS = iOSCompiler()iOS.compileAndRun()# =&gt; Collecting Swift Source Code# =&gt; Compiling Swift code to LLVM bitcode# =&gt; Program runing on runtime environment çŽ°å®žä¸­çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384from abc import abstractmethod, ABCMetaclass Trip(metaclass=ABCMeta): @abstractmethod def setTransport(self): pass @abstractmethod def day1(self): pass @abstractmethod def day2(self): pass @abstractmethod def day3(self): pass @abstractmethod def returnHome(self): pass def itinerary(self): self.setTransport() self.day1() self.day2() self.day3() self.returnHome()class VeniceTrip(Trip): def setTransport(self): print("Take a boat and find your way in the Grand Canal") def day1(self): print("Visit St Mark's Basilica in St Mark's Square") def day2(self): print("Appreciate Doge's Palace") def day3(self): print("Enjoy the food near the Rialto Bridge") def returnHome(self): print("Get souovenirs for friends and get back")class MaldivesTrip(Trip): def setTransport(self): print("On foot, on any island, Wow!") def day1(self): print("Enjoy the marine life of Banana Reef") def day2(self): print("Go for the water sports and snorkelling") def day3(self): print("Relax on the beach and enjoy the sun") def returnHome(self): print("Don't feel like leaving the beach..")class TravelAgency: def arrange_trip(self): choice = input("What kind of place you'd like to go historical or to a beach? ") if choice == 'historical': self.trip = VeniceTrip() self.trip.itinerary() if choice == 'beach': self.trip = MaldivesTrip() self.trip.itinerary()TravelAgency().arrange_trip()# =&gt; What kind of place you'd like to go historical or to a beach? beach# =&gt; On foot, on any island, Wow!# =&gt; Enjoy the marine life of Banana Reef# =&gt; Go for the water sports and snorkelling# =&gt; Relax on the beach and enjoy the sun# =&gt; Don't feel like leaving the beach.. æŠ½è±¡ç±» Trip æ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œå®šä¹‰äº†ä¸åŒæ—¥å­ä½¿ç”¨çš„äº¤é€šæ–¹å¼å’Œå‚è§‚åœ°ç‚¹ç­‰ç»†èŠ‚ setTransport æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç”± ConcreteClass å®žçŽ°ï¼Œä½œç”¨æ˜¯è®¾ç½®äº¤é€šæ–¹å¼ day1()ã€day2()ã€day3() æŠ½è±¡æ–¹æ³•å®šä¹‰äº†ç‰¹å®šæ—¥æœŸæ‰€å‚è§‚çš„åœ°ç‚¹ itinerary() æ¨¡æ¿æ–¹æ³•åˆ™ç”¨äºŽåˆ›å»ºå®Œæ•´çš„è¡Œç¨‹ VeniceTrip ç±»å’Œ MaldivesTrip ç±»æ˜¯ Trip æŽ¥å£çš„å…·ä½“å®žçŽ° æ¨¡æ¿æ–¹æ³•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ä¼˜ç‚¹ï¼š æ²¡æœ‰ä»£ç é‡å¤ ä½¿ç”¨ç»§æ‰¿è€Œä¸æ˜¯åˆæˆï¼Œåªæœ‰ä¸ºæ•°ä¸å¤šçš„å‡ ä¸ªæ–¹æ³•éœ€è¦é‡å†™ çµæ´»æ€§ï¼Œå…è®¸å­ç±»å†³å®šå¦‚ä½•å®žçŽ°ç®—æ³•ä¸­çš„æ­¥éª¤ ç¼ºç‚¹ï¼š è°ƒè¯•å’Œç†è§£æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æµç¨‹åºåˆ—æ—¶å¯èƒ½ä¼šä»¤äººå›°æƒ‘ æ¨¡æ¿æ¡†æž¶çš„ç»´æŠ¤å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä»»ä½•å±‚æ¬¡ï¼ˆåº•å±‚æˆ–é«˜å±‚ï¼‰çš„å˜æ›´éƒ½å¯èƒ½å¯¹å®žçŽ°é€ æˆå¹²æ‰°]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”çŠ¶æ€æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F26%2Fpython-design-patterns-state-pattern%2F</url>
    <content type="text"><![CDATA[è¡Œä¸ºæ¨¡å¼å…³æ³¨çš„æ˜¯å¯¹è±¡çš„å“åº”æ€§ï¼Œå®ƒä»¬é€šè¿‡å¯¹è±¡ä¹‹é—´çš„äº¤äº’ä»¥å®žçŽ°æ›´å¤æ‚çš„åŠŸèƒ½ã€‚çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥åŸºäºŽå…¶å†…éƒ¨çŠ¶æ€å°è£…å¤šä¸ªè¡Œä¸ºã€‚æ¯”å¦‚æ ¹æ®æ”¶éŸ³æœºçš„åŸºæœ¬çŠ¶æ€ï¼ˆAM/FMï¼‰ï¼Œå½“è°ƒè°åˆ° AM æˆ– FM é¢‘é“æ—¶ï¼Œæ‰«æé¢‘é“çš„è¡Œä¸ºå°±ä¼šç›¸åº”åœ°å‘ç”ŸåŠ¨æ€çš„æ”¹å˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839from abc import abstractmethod, ABCMetaclass State(metaclass=ABCMeta): @abstractmethod def handle(self): passclass ConcreteStateB(State): def handle(self): print("ConcreteStateB")class ConcreteStateA(State): def handle(self): print("ConcreteStateA")class Context(State): def __init__(self): self.state = None def getState(self): return self.state def setState(self, state): self.state = state def handle(self): self.state.handle()context = Context()stateA = ConcreteStateA()stateB = ConcreteStateB()context.setState(stateA)context.handle()# =&gt; ConcreteStateA Stateï¼šå®šä¹‰ Handle() æŠ½è±¡æ–¹æ³•çš„æŽ¥å£ã€‚éœ€è¦é€šè¿‡ ConcreteState ç±»å®žçŽ° ConcreteStateï¼šå®žçŽ° Handle() æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®çŠ¶æ€å˜åŒ–å®šä¹‰æ‰§è¡Œçš„å®žé™…æ“ä½œ Contextï¼šæŽ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç»´æŠ¤ç€å¯¹è±¡å½“å‰çŠ¶æ€çš„å¼•ç”¨ï¼Œä»¥æ ¹æ®è¯·æ±‚è°ƒç”¨å…·ä½“çš„è¡Œä¸º ç®€å•ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041from abc import abstractmethod, ABCMetaclass State(metaclass=ABCMeta): @abstractmethod def doThis(self): passclass StartState(State): def doThis(self): print("TV Switching ON...")class StopState(State): def doThis(self): print("TV Switching OFF...")class TVContext(State): def __init__(self): self.state = None def getState(self): return self.state def setState(self, state): self.state = state def doThis(self): self.state.doThis()context = TVContext()context.getState()start = StartState()stop = StopState()context.setState(stop)context.doThis()# =&gt; TV Switching OFF... çœŸå®žç”¨ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960class ComputerState: name = "state" allowed = [] def switch(self, state): if state.name in self.allowed: print("current:", self, " =&gt; switching to", state.name) self.__class__ = state else: print("Current:", self, " =&gt; switching to", state.name, "not possible.") def __str__(self): return self.nameclass Off(ComputerState): name = "off" allowed = ['on']class On(ComputerState): name = "on" allowed = ['off', 'suspend', 'hibernate']class Suspend(ComputerState): name = "suspend" allowed = ['on']class Hibernate(ComputerState): name = "hibernate" allowed = ['on']class Computer: def __init__(self): self.state = Off() def change(self, state): self.state.switch(state)if __name__ == '__main__': comp = Computer() comp.change(On) comp.change(Off) comp.change(On) comp.change(Suspend) comp.change(Hibernate) comp.change(On) comp.change(Hibernate)# =&gt; current: off =&gt; switching to on# =&gt; current: on =&gt; switching to off# =&gt; current: off =&gt; switching to on# =&gt; current: on =&gt; switching to suspend# =&gt; Current: suspend =&gt; switching to hibernate not possible.# =&gt; current: suspend =&gt; switching to on# =&gt; current: on =&gt; switching to Hibernate çŠ¶æ€æ¨¡å¼çš„ä¼˜ç‚¹ åœ¨çŠ¶æ€è®¾è®¡æ¨¡å¼ä¸­ï¼Œå¯¹è±¡çš„è¡Œä¸ºæ˜¯å…¶çŠ¶æ€çš„å‡½æ•°ç»“æžœï¼Œä¸”è¡Œä¸ºåœ¨è¿è¡Œæ—¶ä¾æ—§çŠ¶æ€è€Œæ”¹å˜ã€‚è¿™æ¶ˆé™¤äº†å¯¹ if/else æˆ– switch/case æ¡ä»¶é€»è¾‘çš„ä¾èµ– ä½¿ç”¨çŠ¶æ€æ¨¡å¼ï¼Œå®žçŽ°å¤šæ€è¡Œä¸ºæ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå¹¶ä¸”æ˜“äºŽæ·»åŠ çŠ¶æ€æ¥æ”¯æŒé¢å¤–çš„è¡Œä¸º çŠ¶æ€æ¨¡å¼æé«˜äº†èšåˆæ€§ï¼Œé’ˆå¯¹çŠ¶æ€çš„è¡Œä¸ºè¢«èšåˆåˆ° ConcreteState ç±»ä¸­ï¼Œæ”¾ç½®åœ¨ä»£ç çš„åŒä¸€ä¸ªåœ°æ–¹ çŠ¶æ€æ¨¡å¼ä¸ä»…æ”¹å–„äº†æ‰©å±•åº”ç”¨ç¨‹åºè¡Œä¸ºæ—¶çš„çµæ´»æ€§ï¼Œä¸”æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ä¸€ä¸ª ConcreteState ç±»å³å¯¹åº”ä¸€ç§è¡Œä¸º çŠ¶æ€æ¨¡å¼çš„ç¼ºç‚¹ ç±»çˆ†ç‚¸ï¼šç”±äºŽæ¯ä¸ªçŠ¶æ€éƒ½éœ€è¦åœ¨ ConcreteState ä¸­å®šä¹‰ï¼Œå¯èƒ½å¯¼è‡´åˆ›å»ºå¤ªå¤šåŠŸèƒ½è¾ƒä¸ºå•ä¸€çš„ç±»ã€‚æ—¢å¢žåŠ äº†ä»£ç é‡ï¼Œåˆä½¿å¾—çŠ¶æ€æœºçš„ç»“æž„æ›´åŠ éš¾ä»¥å®¡æŸ¥ éšç€æ–°è¡Œä¸ºçš„å¼•å…¥ï¼ŒContext ç±»éœ€è¦è¿›è¡Œç›¸åº”çš„æ›´æ–°ä»¥å¤„ç†æ¯ä¸ªè¡Œä¸ºï¼Œä½¿å¾—ä¸Šä¸‹æ–‡è¡Œä¸ºæ›´å®¹æ˜“å—åˆ°æ¯ä¸ªæ–°è¡Œä¸ºçš„å½±å“]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Patterns</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”å‘½ä»¤æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F26%2Fpython-design-patterns-command-pattern%2F</url>
    <content type="text"><![CDATA[å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ã€‚å¯ä»¥ç”¨æ¥å®žçŽ°æ¯”å¦‚å®‰è£…è½¯ä»¶æ—¶çš„å®‰è£…å‘å¯¼åŠŸèƒ½ï¼Œé€šå¸¸å®‰è£…å‘å¯¼ä¼šé€šè¿‡å¤šä¸ªæ­¥éª¤æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©äº†è§£ç”¨æˆ·çš„åå¥½ã€‚å®‰è£…å‘å¯¼é¦–å…ˆå¯åŠ¨ä¸€ä¸ªåä¸º Command çš„å¯¹è±¡ï¼Œç”¨äºŽå­˜å‚¨åœ¨å‘å¯¼çš„å¤šä¸ªæ­¥éª¤ä¸­ç”¨æˆ·æŒ‡å®šçš„é€‰é¡¹ã€‚å½“ç”¨æˆ·åœ¨æœ€åŽä¸€ä¸ªæ­¥éª¤ä¸­ç‚¹å‡»å®ŒæˆæŒ‰é’®æ—¶ï¼ŒCommand å¯¹è±¡å°±ä¼šè¿è¡Œ execute() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè€ƒå¯Ÿæ‰€æœ‰å­˜å‚¨çš„é€‰é¡¹å¹¶å®Œæˆç›¸åº”çš„å®‰è£…è¿‡ç¨‹ã€‚ å‘½ä»¤æ¨¡å¼é€šå¸¸åŒ…å«ä»¥ä¸‹æœ¯è¯­ï¼š Command å¯¹è±¡äº†è§£ Receiver å¯¹è±¡çš„æƒ…å†µï¼Œå¹¶èƒ½è°ƒç”¨å…¶æ–¹æ³• è°ƒç”¨è€…ï¼ˆInvokerï¼‰æ–¹æ³•çš„å‚æ•°å€¼å­˜å‚¨åœ¨ Command å¯¹è±¡ä¸­ è°ƒç”¨è€…çŸ¥é“å¦‚ä½•æ‰§è¡Œå‘½ä»¤ å®¢æˆ·ç«¯ï¼ˆClientï¼‰ç”¨æ¥åˆ›å»º Command å¯¹è±¡å¹¶è®¾ç½®å…¶æŽ¥æ”¶è€… å‘½ä»¤æ¨¡å¼çš„ä¸»è¦æ„å›¾ï¼š å°†è¯·æ±‚å°è£…ä¸ºå¯¹è±¡ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·ç«¯è¿›è¡Œå‚æ•°åŒ– å…è®¸å°†è¯·æ±‚ä¿å­˜åœ¨é˜Ÿåˆ—ä¸­ æä¾›é¢å‘å¯¹è±¡çš„å›žè°ƒ å‘½ä»¤æ¨¡å¼çš„é€‚ç”¨åœºæ™¯ï¼š æ ¹æ®éœ€è¦æ‰§è¡Œçš„æ“ä½œå¯¹å¯¹è±¡è¿›è¡Œå‚æ•°åŒ– å°†æ“ä½œæ·»åŠ åˆ°é˜Ÿåˆ—å¹¶åœ¨ä¸åŒåœ°ç‚¹æ‰§è¡Œè¯·æ±‚ åˆ›å»ºä¸€ä¸ªç»“æž„æ ¹æ®è¾ƒå°çš„æ“ä½œæ¥å®Œæˆé«˜çº§æ“ä½œ ä»£ç ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from abc import ABCMeta, abstractmethodclass Order(metaclass=ABCMeta): @abstractmethod def execute(self): passclass BuyStockOrder(Order): def __init__(self, stock): self.stock = stock def execute(self): self.stock.buy()class SellStockOrder(Order): def __init__(self, stock): self.stock = stock def execute(self): self.stock.sell()class Agent: def __init__(self): self.__orderQueue = [] def placeOrder(self, order): self.__orderQueue.append(order) order.execute()class StockTrade: def buy(self): print("You will buy stocks") def sell(self): print("You will sell stocks")if __name__ == '__main__': stock = StockTrade() buyStock = BuyStockOrder(stock) sellStock = SellStockOrder(stock) agent = Agent() agent.placeOrder(buyStock) agent.placeOrder(sellStock)# =&gt; You will buy stocks# =&gt; You will sell stocks Order ç±» -&gt; Command å¯¹è±¡ BuyStockOrder å’Œ SellStockOrder ç±» -&gt; ConcreteCommand å¯¹è±¡ï¼Œä¸ºäº¤æ˜“ç³»ç»Ÿå®šä¹‰é€‚å½“çš„æ“ä½œ StockTrade ç±» -&gt; Receiver å¯¹è±¡ï¼Œå®šä¹‰äº†å¤šä¸ªæ–¹æ³•ï¼ˆåŠ¨ä½œï¼‰å¯ä»¥è¢« ConcreteCommand è°ƒç”¨ä»¥ä¹°å…¥æˆ–å–å‡ºè‚¡ç¥¨ Agent ç±» -&gt; Invoker å¯¹è±¡ï¼Œä½œä¸ºå®¢æˆ·ç«¯å’Œ StockTrade çš„ä¸­ä»‹ï¼Œæ‰§è¡Œå®¢æˆ·ä¸‹è¾¾çš„è®¢å• å‘½ä»¤æ¨¡å¼çš„ä¼˜ç‚¹ï¼š å°†è°ƒç”¨æ“ä½œçš„ç±»ä¸ŽçŸ¥é“å¦‚ä½•æ‰§è¡Œè¯¥æ“ä½œçš„ç±»è§£è€¦ å€ŸåŠ©é˜Ÿåˆ—ç³»ç»Ÿï¼Œå¯ä»¥åˆ›å»ºä¸€ç³»åˆ—å‘½ä»¤ æ·»åŠ æ–°å‘½ä»¤æ›´åŠ å®¹æ˜“ï¼Œæ— éœ€æ›´æ”¹çŽ°æœ‰ä»£ç  å¯ä»¥ä½¿ç”¨å‘½ä»¤æ¨¡å¼å®šä¹‰å›žæ»šç³»ç»Ÿ å‘½ä»¤æ¨¡å¼çš„ç¼ºç‚¹ï¼š ä¸ºäº†å®žçŽ°ç›®æ ‡ï¼Œéœ€è¦å¤§é‡çš„ç±»å’Œå¯¹è±¡è¿›è¡Œåä½œ æ¯ä¸ªå•ç‹¬çš„å‘½ä»¤éƒ½æ˜¯ä¸€ä¸ª ConcreteCommand ç±»ï¼Œå¢žåŠ äº†å®žçŽ°å’Œç»´æŠ¤çš„æˆæœ¬]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Patterns</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”ä»£ç†æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F25%2Fpython-design-patterns-proxy-pattern%2F</url>
    <content type="text"><![CDATA[ä»£ç†é€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªä»‹äºŽå¯»æ±‚æ–¹å’Œæä¾›æ–¹ä¹‹é—´çš„ä¸­ä»‹ç³»ç»Ÿã€‚å¯»æ±‚å‘æ˜¯å‘å‡ºè¯·æ±‚çš„ä¸€æ–¹ï¼Œè€Œæä¾›æ–¹åˆ™æ˜¯æ ¹æ®è¯·æ±‚æä¾›èµ„æºçš„ä¸€æ–¹ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼Œä»£ç†é€šå¸¸æ˜¯å°è£…å®žé™…æœåŠ¡å¯¹è±¡çš„è£…é¥°å™¨æˆ–ä»£ç†äººï¼Œå¯ä»¥ä¸ºå…¶åŒ…è£…çš„å¯¹è±¡æä¾›é™„åŠ åŠŸèƒ½åŒæ—¶æ— éœ€æ”¹å˜å¯¹è±¡æœ¬èº«çš„ä»£ç ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†è€…æˆ–å ä½ç¬¦ï¼Œä»Žè€ŒæŽ§åˆ¶å¯¹å®žé™…å¯¹è±¡çš„è®¿é—®ã€‚ ä»£ç†è®¾è®¡æ¨¡å¼çš„ä¸»è¦å·¥ä½œï¼š ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä»£ç†ï¼Œå®žçŽ°å¯¹åŽŸå§‹å¯¹è±¡çš„è®¿é—®æŽ§åˆ¶ å¯ä»¥ç”¨ä½œä¸€ä¸ªä¸­é—´å±‚æˆ–æŽ¥å£ï¼Œä»¥æ”¯æŒåˆ†å¸ƒå¼è®¿é—® é€šè¿‡å¢žåŠ ä»£ç†ï¼Œä¿æŠ¤çœŸæ­£çš„ç»„ä»¶ä¸å—æ„å¤–å½±å“ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162# agent.pyfrom abc import ABCMeta, abstractmethodclass Payment(metaclass=ABCMeta): @abstractmethod def do_pay(self): passclass Bank(Payment): def __init__(self): self.card = None self.account = None def __getAccount(self): self.account = self.card return self.account def __hasFunds(self): print("Bank:: Checking if Account ", self.__getAccount(), " has enough funds") return True def setCard(self, card): self.card = card def do_pay(self): if self.__hasFunds(): print("Bank:: Paying the merhant") return True else: print("Bank:: Sorry, not enough funds") return Falseclass DebitCard(Payment): def __init__(self): self.bank = Bank() def do_pay(self): card = input("Proxy:: Punch in Card Number: ") self.bank.setCard(card) return self.bank.do_pay()class You: def __init__(self): print("You:: Let's buy the Denim shirt") self.debitCard = DebitCard() self.isPurchased = None def make_payment(self): self.isPurchased = self.debitCard.do_pay() def __del__(self): if self.isPurchased: print("You:: Denim shirt is Mine :-)") else: print("You:: I should earn more :(")you = You()you.make_payment() 123456$ python agent.pyYou:: Let's buy the Denim shirtProxy:: Punch in Card Number: 12345Bank:: Checking if Account 12345 has enough fundsBank:: Paying the merhantYou:: Denim shirt is Mine :-) å…³äºŽç±» Youï¼ˆå¯¹åº” UML å›¾ä¸­çš„ clientï¼‰çš„è§£é‡Šï¼š è¯¥ç±»ç”¨äºŽå®žçŽ°å®¢æˆ·ç«¯çš„è¡Œä¸º __init__() ä¼šè°ƒç”¨ä»£ç†å¹¶å°†å…¶å®žä¾‹åŒ– make_payment() æ–¹æ³•è¡¨ç¤ºè´­ä¹°åŠ¨ä½œï¼Œä¼šåœ¨å†…éƒ¨è°ƒç”¨ä»£ç†çš„ä»˜æ¬¾æ–¹æ³• å…³äºŽç±» Bankï¼ˆå¯¹åº” UML å›¾ä¸­çš„ RealSubjectï¼‰çš„è§£é‡Šï¼š è¯¥ç±»å®žé™…å®Œæˆä»Žé¡¾å®¢è´¦æˆ·å‘å•†å®¶åˆ’è´¦çš„åŠ¨ä½œï¼ˆdo_pay()ï¼‰ è¯¥ç±»æä¾›äº†å¤šä¸ªæ–¹æ³•æ¥å¤„ç†æœ‰å…³ä»˜æ¬¾çš„ä¸€ç³»åˆ—é€»è¾‘ï¼ˆ__getAccount()ã€__hasFunds()ã€do_pay() ç­‰ï¼‰ é€šè¿‡ setCard() æ–¹æ³•ä»Žä»£ç†å¤„èŽ·å–å€Ÿè®°å¡ä¿¡æ¯ å…³äºŽ DebitCard ç±»ï¼ˆå¯¹åº” UML å›¾ä¸­çš„ Proxyï¼‰çš„è§£é‡Šï¼š è¯¥ç±»ç”¨äºŽå®žçŽ°ä»£ç†çš„è¡Œä¸ºï¼Œå……å½“çœŸå®žä¸»é¢˜ï¼ˆé“¶è¡Œï¼‰çš„ä»£ç† é¡¾å®¢éœ€è¦ä»˜æ¬¾æ—¶ï¼Œæ— éœ€è·‘åŽ»é“¶è¡Œææ¬¾å†å›žåˆ°å•†å®¶æ”¯ä»˜ï¼Œè€Œæ˜¯è°ƒç”¨ DebitCard çš„ do_pay() æ–¹æ³• DebitCard ç±»åœ¨å†…éƒ¨æŽ§åˆ¶çœŸå®žä¸»é¢˜ï¼ˆBankï¼‰çš„åˆ›å»ºï¼Œå¹¶å‘é“¶è¡Œæä¾›å€Ÿè®°å¡çš„è¯¦ç»†ä¿¡æ¯ Bank å¯¹è±¡åœ¨å†…éƒ¨å¯¹è´¦æˆ·è¿›è¡Œæ£€æŸ¥å¹¶å®Œæˆæ”¯ä»˜åŠ¨ä½œ ä»£ç†æ¨¡å¼çš„ä¼˜ç‚¹ å¯ä»¥é€šè¿‡ç¼“å­˜ç¬¨é‡çš„å¯¹è±¡æˆ–é¢‘ç¹è®¿é—®çš„å¯¹è±¡æ¥æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ å¯ä»¥æä¾›å¯¹äºŽçœŸå®žå¯¹è±¡çš„è®¿é—®æŽˆæƒ è¿œç¨‹ä»£ç†è¿˜ä¾¿äºŽä¸Žè¿œç¨‹æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œå¹¶ç›‘è§†ç³»ç»Ÿ é—¨é¢æ¨¡å¼ä¸Žä»£ç†æ¨¡å¼çš„æ¯”è¾ƒ ä»£ç†æ¨¡å¼ é—¨é¢æ¨¡å¼ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä»£ç†æˆ–å ä½ç¬¦ï¼Œä»¥æŽ§åˆ¶å¯¹åŽŸå§‹å¯¹è±¡çš„è®¿é—® ä¸ºç±»çš„å¤§åž‹å­ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªç®€å•çš„æŽ¥å£ ä»£ç†å¯¹è±¡å…·æœ‰ä¸Žç›®æ ‡å¯¹è±¡ç›¸åŒçš„æŽ¥å£ï¼Œå¹¶ä¿å­˜ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ å®žçŽ°äº†å­ç³»ç»Ÿä¹‹é—´é€šä¿¡å’Œä¾èµ–æ€§çš„æœ€å°åŒ– å……å½“å®¢æˆ·ç«¯å’Œè¢«å°è£…çš„å¯¹è±¡ä¹‹é—´çš„ä¸­ä»‹ æä¾›äº†å•ä¸€çš„ç®€å•æŽ¥å£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Patterns</tag>
        <tag>Proxy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”é—¨é¢æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F25%2Fpython-design-patterns-facade-pattern%2F</url>
    <content type="text"><![CDATA[é—¨é¢ï¼ˆfacadeï¼‰æŒ‡å»ºç­‘ç‰©çš„è¡¨é¢ï¼Œå°¤å…¶æ˜¯æœ€æœ‰å¸å¼•åŠ›çš„é‚£ä¸€é¢ã€‚å½“äººä»¬ä»Žå»ºç­‘ç‰©æ—è¾¹ç»è¿‡æ—¶ï¼Œå¯ä»¥æ¬£èµå…¶å¤–éƒ¨é¢è²Œï¼Œè€Œä¸å¿…äº†è§£å…¶æœ¬èº«ç»“æž„çš„å¤æ‚æ€§ã€‚é—¨é¢åœ¨éšè—å†…éƒ¨å¤æ‚æ€§çš„åŒæ—¶ï¼Œä¹Ÿä¸ºå®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå¯ä»¥è½»æ¾è®¿é—®çš„æŽ¥å£ã€‚ æ¯”å¦‚éœ€è¦åˆ°æŸä¸ªå•†åº—ä¹°ä¸œè¥¿ï¼Œä½†å¯¹äºŽè¯¥å•†åº—çš„å¸ƒå±€å¹¶ä¸æ¸…æ¥šã€‚å¯ä»¥ç›´æŽ¥æ‰¾åº—ä¸»è¯´æ˜Žéœ€è¦å“ªäº›ä¸œè¥¿ï¼Œç”±åº—ä¸»å°†è¿™äº›å•†å“æ‰¾åˆ°å¹¶æä¾›ç»™é¡¾å®¢ã€‚å³åº—ä¸»ä½œä¸ºè´­ç‰©çš„æŽ¥å£ï¼Œé¡¾å®¢æ— éœ€äº†è§£å…·ä½“å•†å“çš„ä½ç½®ã€‚ é—¨é¢è®¾è®¡æ¨¡å¼çš„ç‰¹ç‚¹ï¼š ä¸ºå­ç³»ç»Ÿçš„ä¸€ç»„æŽ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„é«˜çº§æŽ¥å£ï¼Œå¸®åŠ©å®¢æˆ·ç«¯ä»¥æ›´ç®€å•çš„æ–¹å¼ä½¿ç”¨è¿™äº›å­ç³»ç»Ÿ é—¨é¢å¹¶ä¸æ˜¯å°è£…å­ç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹åº•å±‚å­ç³»ç»Ÿè¿›è¡Œç»„åˆã€‚å³ç”¨å•ä¸ªæŽ¥å£å¯¹è±¡è¡¨ç¤ºå¤æ‚çš„å­ç³»ç»Ÿ é—¨é¢ ä¸€ä¸ªæŽ¥å£ï¼ŒçŸ¥é“æŸä¸ªè¯·æ±‚åº”è¯¥äº¤ç”±é‚£ä¸ªå­ç³»ç»Ÿå¤„ç† é€šè¿‡ç»„åˆçš„æ–¹å¼å°†å®¢æˆ·ç«¯çš„è¯·æ±‚å§”æ´¾ç»™ç›¸åº”çš„å­ç³»ç»Ÿå¯¹è±¡ ç³»ç»Ÿ å®žçŽ°å­ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œç”±ä¸€ç»„è´Ÿè´£ä¸åŒä»»åŠ¡çš„ç±»æ¥è¡¨ç¤º å¤„ç†é—¨é¢å¯¹è±¡åˆ†é…çš„å·¥ä½œï¼Œä½†å¹¶ä¸çŸ¥é“é—¨é¢ä¹Ÿä¸å¼•ç”¨å®ƒ å®¢æˆ·ç«¯ ä¼šå®žä¾‹åŒ–é—¨é¢ ä¼šå‘é—¨é¢æå‡ºè¯·æ±‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990class EventManager: def __init__(self): print("Event Manager:: Let me talk to the folks\n") def arrange(self): self.hotelier = Hotelier() self.hotelier.bookHotel() self.florist = Florist() self.florist.setFlowerRequirements() self.caterer = Caterer() self.caterer.setCuisine() self.musician = Musician() self.musician.setMusicType()class Hotelier: def __init__(self): print("Arranging the Hotel for Marriage? --") def __isAvailable(self): print("Is the Hotel free for the event on given day?") return True def bookHotel(self): if self.__isAvailable(): print("Registered the Booking\n\n")class Florist: def __init__(self): print("Flower Decorations for the Event? --") def setFlowerRequirements(self): print("Carnations, Roses and Lilies would be used for Decorations\n\n")class Caterer: def __init__(self): print("Food Arrangements for the Event --") def setCuisine(self): print("Chinese &amp; Continental Cuisine to be served\n\n")class Musician: def __init__(self): print("Musical Arrangements for the Marriage --") def setMusicType(self): print("Jazz and Classical will be played\n\n")class You: def __init__(self): print("You:: Whoa! Marriage Arrangements??!!!") def asskEventManager(self): print("You:: Let's Contact the Event Manager\n\n") em = EventManager() em.arrange() def __del__(self): print("You:: Thanks to Event Manager, all preparations done!")you = You()you.asskEventManager()# =&gt; You:: Whoa! Marriage Arrangements??!!!# =&gt; You:: Let's Contact the Event Manager# =&gt; Event Manager:: Let me talk to the folks# =&gt; Arranging the Hotel for Marriage? --# =&gt; Is the Hotel free for the event on given day?# =&gt; Registered the Booking# =&gt; Flower Decorations for the Event? --# =&gt; Carnations, Roses and Lilies would be used for Decorations# =&gt; Food Arrangements for the Event --# =&gt; Chinese &amp; Continental Cuisine to be served# =&gt; Musical Arrangements for the Marriage --# =&gt; Jazz and Classical will be played# =&gt; You:: Thanks to Event Manager, all preparations done! æœ€å°‘çŸ¥è¯†åŽŸåˆ™é—¨é¢èƒ½å¤Ÿå°†å®¢æˆ·ç«¯ä¸Žå®žçŽ°å…·ä½“åŠŸèƒ½çš„å­ç³»ç»Ÿè§£è€¦ï¼Œå…¶èƒŒåŽçš„è®¾è®¡åŽŸç†å³æœ€å°‘çŸ¥è¯†åŽŸåˆ™ã€‚ åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œå¯¹äºŽåˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡ï¼Œéƒ½åº”è¯¥è€ƒå¯Ÿä¸Žä¹‹äº¤äº’çš„ç±»çš„æ•°é‡ï¼Œä»¥åŠäº¤äº’çš„æ–¹å¼ é¿å…åˆ›å»ºè®¸å¤šå½¼æ­¤ç´§å¯†è€¦åˆçš„ç±»ã€‚è‹¥ç±»ä¹‹é—´å­˜åœ¨å¤§é‡çš„ä¾èµ–å…³ç³»ï¼Œç³»ç»Ÿå°±ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œåº”åšå†³é¿å…]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Patterns</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”å·¥åŽ‚æ¨¡å¼]]></title>
    <url>%2F2020%2F12%2F22%2Fpython-design-patterns-factory-pattern%2F</url>
    <content type="text"><![CDATA[åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œå·¥åŽ‚è¡¨ç¤ºä¸€ä¸ªè´Ÿè´£åˆ›å»ºå…¶ä»–ç±»åž‹çš„å¯¹è±¡çš„ç±»ã€‚é€šå¸¸ä½œä¸ºå·¥åŽ‚çš„ç±»ä¼šå®žçŽ°å¤šä¸ªå…³è”çš„æ–¹æ³•ï¼Œå®¢æˆ·ç«¯é€šè¿‡æŸäº›å‚æ•°è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œå·¥åŽ‚åˆ™è´Ÿè´£åˆ›å»ºå¯¹åº”ç±»åž‹çš„å¯¹è±¡å¹¶è¿”å›žç»™å®¢æˆ·ç«¯ã€‚ å·¥åŽ‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼š æ¾è€¦åˆã€‚å¯¹è±¡çš„åˆ›å»ºç‹¬ç«‹äºŽç±»çš„å®žçŽ° å®¢æˆ·ç«¯æ— éœ€äº†è§£åˆ›å»ºå¯¹è±¡çš„ç±»ï¼Œåªéœ€çŸ¥é“éœ€è¦ä¼ é€’çš„æŽ¥å£ã€æ–¹æ³•å’Œå‚æ•°å³å¯ã€‚ç®€åŒ–äº†å®¢æˆ·ç«¯çš„å®žçŽ° å¯ä»¥è½»æ¾åœ°åœ¨å·¥åŽ‚ä¸­æ·»åŠ å…¶ä»–ç±»æ¥åˆ›å»ºå…¶ä»–ç±»åž‹çš„å¯¹è±¡ï¼Œæ— éœ€æ›´æ”¹å®¢æˆ·ç«¯ä»£ç  å·¥åŽ‚å¯ä»¥é‡ç”¨çŽ°æœ‰çš„å¯¹è±¡ ç®€å•å·¥åŽ‚æ¨¡å¼123456789101112131415161718192021222324252627from abc import ABCMeta, abstractmethodclass Animal(metaclass=ABCMeta): @abstractmethod def do_say(self): passclass Dog(Animal): def do_say(self): print("Bhow Bhow")class Cat(Animal): def do_say(self): print("Meow Meow")class ForestFactory: def make_sound(self, object_type): return eval(object_type)().do_say()if __name__ == '__main__': ff = ForestFactory() animal = input("Which animal should make sound, Dog or Cat\n") ff.make_sound(animal) 12345678$ python make_sound.pyWhich animal should make sound, Dog or CatDogBhow Bhow$ python make_sound.pyWhich animal should make sound, Dog or CatCatMeow Meow å·¥åŽ‚æ–¹æ³•æ¨¡å¼å·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„ç‰¹ç‚¹ï¼š å®šä¹‰ä¸€ä¸ªæŽ¥å£æ¥åˆ›å»ºå¯¹è±¡ï¼Œä½†å·¥åŽ‚æœ¬èº«å¹¶ä¸è´Ÿè´£åˆ›å»ºåŠ¨ä½œï¼Œè€Œæ˜¯ç”±å…¶å­ç±»å†³å®šå®žä¾‹åŒ–å“ªäº›ç±» å·¥åŽ‚æ–¹æ³•çš„åˆ›å»ºæ˜¯é€šè¿‡ç»§æ‰¿è€Œä¸æ˜¯é€šè¿‡å®žä¾‹åŒ–æ¥å®Œæˆçš„ å·¥åŽ‚æ–¹æ³•ä½¿è®¾è®¡æ›´å…·æœ‰å®šåˆ¶æ€§ã€‚å¯ä»¥è¿”å›žç›¸åŒçš„å®žä¾‹æˆ–å­ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162from abc import ABCMeta, abstractmethodclass Section(metaclass=ABCMeta): @abstractmethod def describe(self): passclass PersonalSection(Section): def describe(self): print("Personal Section")class AlbumSection(Section): def describe(self): print("Album Section")class PatentSection(Section): def describe(self): print("Patent Section")class PublicationSection(Section): def describe(self): print("Publication Section")class Profile(metaclass=ABCMeta): def __init__(self): self.sections = [] self.createProfile() @abstractmethod def createProfile(self): pass def getSections(self): return self.sections def addSections(self, section): self.sections.append(section)class linkedin(Profile): def createProfile(self): self.addSections(PersonalSection()) self.addSections(PatentSection()) self.addSections(PublicationSection())class facebook(Profile): def createProfile(self): self.addSections(PersonalSection()) self.addSections(AlbumSection())if __name__ == '__main__': profile_type = input("Which Profile you'd like to create?\n[LinkedIn or FaceBook] ") profile = eval(profile_type.lower())() print("Creating Profile...", type(profile).__name__) print("Profile has sections --", profile.getSections()) 12345$ python profile.pyWhich Profile you'd like to create?[LinkedIn or FaceBook] LinkedInCreating Profile... linkedinProfile has sections -- [&lt;__main__.PersonalSection object at 0x7f3d25e53c70&gt;, &lt;__main__.PatentSection object at 0x7f3d25e53ca0&gt;, &lt;__main__.PublicationSection object at 0x7f3d25e53df0&gt;] Profile æŠ½è±¡ç±»ä»£è¡¨ Creatorï¼Œæä¾›äº† createProfile() å·¥åŽ‚æ–¹æ³•ï¼Œç”¨äºŽåˆ›å»ºå¸¦æœ‰é€‚å½“æ¿å—çš„ä¸ªäººä¿¡æ¯ç•Œé¢ã€‚ä½† Profile å¹¶ä¸æ¸…æ¥šæŸä¸ªç‰¹å®šç•Œé¢åº”è¯¥å…·æœ‰å“ªäº›æ¿å—ï¼Œå¦‚ Facebook éœ€è¦æä¾›ä¸ªäººä¿¡æ¯æ¿å—å’Œç›¸å†ŒåŒºã€‚createProfile() å·¥åŽ‚æ–¹æ³•å®žé™…æ˜¯ç”± Profile çš„å­ç±»åŽ»å®žçŽ°çš„ã€‚ ä¸¤ä¸ª Profile çš„å­ç±» linkedin å’Œ facebook ä»£è¡¨ ConcreteCreatorï¼Œæ¯ä¸ªç±»éƒ½å®žçŽ°äº† createProfile æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨è¿è¡Œæ—¶åˆ›å»ºå¤šä¸ªæ¿å—ï¼ˆConcreteProductsï¼‰ã€‚ å·¥åŽ‚æ–¹æ³•æ¨¡å¼çš„ä¼˜ç‚¹ å¼ºå¤§çš„çµæ´»æ€§ï¼Œä»£ç æ›´åŠ é€šç”¨ã€‚å®žçŽ°å“ªäº›ç±»å–å†³äºŽæŽ¥å£ï¼ˆProductï¼‰ï¼Œè€Œä¸æ˜¯ ConcreteProduct ç±» æ¾è€¦åˆã€‚åˆ›å»ºå¯¹è±¡çš„ä»£ç ä¸Žä½¿ç”¨å¯¹è±¡çš„ä»£ç æ˜¯åˆ†ç¦»çš„ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦å…³å¿ƒä¼ é€’å“ªäº›å‚æ•°ä»¥åŠéœ€è¦å®žä¾‹åŒ–å“ªäº›ç±» æŠ½è±¡å·¥åŽ‚æ¨¡å¼æŠ½è±¡å·¥åŽ‚æ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæŽ¥å£æ¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„å¯¹è±¡ï¼Œè€Œæ— éœ€æŒ‡å®šå…·ä½“çš„ç±»ã€‚å› æ­¤å¯ä»¥å¸®åŠ©å®¢æˆ·ç«¯ä¸€æ¬¡ä½¿ç”¨æ¥è‡ªä¸€ä¸ªäº§å“/ç³»åˆ—çš„å¤šä¸ªå¯¹è±¡ã€‚æ¯”å¦‚æ­£åœ¨å¼€å‘çš„åº”ç”¨æ˜¯å¹³å°æ— å…³çš„ï¼Œåˆ™éœ€è¦å¯¹ä¸åŒå¹³å°ä¸‹çš„å„ç§ä¾èµ–é¡¹ï¼ˆåŒ…æ‹¬æ“ä½œç³»ç»Ÿã€æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ç­‰ï¼‰è¿›è¡ŒæŠ½è±¡å¤„ç†ï¼Œç”±æŠ½è±¡å·¥åŽ‚ä¸ºå„ä¸ªå¹³å°åˆ›å»ºæ‰€éœ€çš„æœåŠ¡ï¼Œå®¢æˆ·ç«¯å°±ä¸å¿…ç›´æŽ¥åˆ›å»ºå¹³å°å¯¹è±¡äº†ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576from abc import ABCMeta, abstractmethodclass PizzaFactory(metaclass=ABCMeta): @abstractmethod def createVegPizza(self): pass @abstractmethod def createNonVegPizza(self): passclass IndianPizzaFactory(PizzaFactory): def createVegPizza(self): return DeluxVeggiePizza() def createNonVegPizza(self): return ChickenPizza()class USPizzaFactory(PizzaFactory): def createVegPizza(self): return MexicanVegPizza() def createNonVegPizza(self): return HamPizza()class VegPizza(metaclass=ABCMeta): @abstractmethod def prepare(self, VegPizza): passclass NonVegPizza(metaclass=ABCMeta): @abstractmethod def serve(self, VegPizza): passclass DeluxVeggiePizza(VegPizza): def prepare(self): print("Prepare ", type(self).__name__)class ChickenPizza(NonVegPizza): def serve(self, VegPizza): print(type(self).__name__, " is served with Chicken on ", type(VegPizza).__name__)class MexicanVegPizza(VegPizza): def prepare(self): print("Prepare ", type(self).__name__)class HamPizza(NonVegPizza): def serve(self, VegPizza): print(type(self).__name__, " is served with Ham on ", type(VegPizza).__name__)class PizzaStore: def makePizzas(self): for factory in [IndianPizzaFactory(), USPizzaFactory()]: self.factory = factory self.NonVegPizza = self.factory.createNonVegPizza() self.VegPizza = self.factory.createVegPizza() self.VegPizza.prepare() self.NonVegPizza.serve(self.VegPizza)pizza = PizzaStore()pizza.makePizzas()# =&gt; Prepare DeluxVeggiePizza# =&gt; ChickenPizza is served with Chicken on DeluxVeggiePizza# =&gt; Prepare MexicanVegPizza# =&gt; HamPizza is served with Ham on MexicanVegPizza å·¥åŽ‚æ–¹æ³•ä¸ŽæŠ½è±¡å·¥åŽ‚æ–¹æ³•çš„æ¯”è¾ƒ å·¥åŽ‚æ–¹æ³• æŠ½è±¡å·¥åŽ‚æ–¹æ³• å‘å®¢æˆ·ç«¯å¼€æ”¾äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ–¹æ³• åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå·¥åŽ‚æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç³»åˆ—çš„ç›¸å…³å¯¹è±¡ ä½¿ç”¨ç»§æ‰¿å’Œå­ç±»å†³å®šè¦åˆ›å»ºå“ªä¸ªå¯¹è±¡ ä½¿ç”¨ç»„åˆå°†åˆ›å»ºå¯¹è±¡çš„ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–ç±» å·¥åŽ‚æ–¹æ³•ç”¨äºŽåˆ›å»ºä¸€ä¸ªäº§å“ æŠ½è±¡å·¥åŽ‚æ–¹æ³•ç”¨äºŽåˆ›å»ºç›¸å…³äº§å“çš„ç³»åˆ—]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
        <tag>Factory</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django models è¯¦è§£ä¹‹èšåˆæŸ¥è¯¢ï¼ˆaggregateï¼‰ä¸Žåˆ†ç»„æŸ¥è¯¢ï¼ˆannotateï¼‰]]></title>
    <url>%2F2020%2F12%2F22%2Fdjango-models-aggregate-and-annotate%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æµ‹è¯•ä»£ç åŠæ•°æ®models.py ä»£ç  12345678910111213from django.db import modelsclass Author(models.Model): name = models.CharField(max_length=100) age = models.IntegerField()class Book(models.Model): name = models.CharField(max_length=300) price = models.DecimalField(max_digits=10, decimal_places=2) authors = models.ManyToManyField(Author) pubdate = models.DateField() æµ‹è¯•æ•°æ® authorsï¼š12345678910111213141516171819202122[ &#123; "id": 1, "name": "è·¯äººç”²", "age": 10 &#125;, &#123; "id": 2, "name": "è·¯äººä¹™", "age": 18 &#125;, &#123; "id": 3, "name": "è·¯äººä¸™", "age": 28 &#125;, &#123; "id": 4, "name": "è·¯äººä¸", "age": 50 &#125;] booksï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980[ &#123; "id": 1, "name": "äººä¹‹åˆ", "price": "38.80", "pubdate": "2020-12-01", "authors": [ 1 ] &#125;, &#123; "id": 2, "name": "æ€§æœ¬å–„", "price": "28.40", "pubdate": "2020-06-01", "authors": [ 2 ] &#125;, &#123; "id": 3, "name": "æ€§ç›¸è¿‘", "price": "15.20", "pubdate": "2019-10-01", "authors": [ 3 ] &#125;, &#123; "id": 4, "name": "ä¹ ç›¸è¿œ", "price": "35.20", "pubdate": "2019-07-01", "authors": [ 4 ] &#125;, &#123; "id": 5, "name": "è‹Ÿä¸æ•™", "price": "5.20", "pubdate": "2018-07-01", "authors": [ 1, 3, 4 ] &#125;, &#123; "id": 6, "name": "æ€§ä¹ƒè¿", "price": "55.20", "pubdate": "2018-12-01", "authors": [ 2, 3, 4 ] &#125;, &#123; "id": 7, "name": "æ•™ä¹‹é“", "price": "33.20", "pubdate": "2018-12-23", "authors": [ 2, 3 ] &#125;, &#123; "id": 8, "name": "è´µä»¥ä¸“", "price": "27.20", "pubdate": "2017-12-23", "authors": [ 1, 4 ] &#125;] äºŒã€å¸¸ç”¨èšåˆæ“ä½œèŽ·å–æ‰€æœ‰ä¹¦ç±çš„æ•°é‡ï¼š12&gt;&gt;&gt; Book.objects.count()8 èŽ·å–ç”±è·¯äººç”²å‚ä¸Žè‘—ä½œçš„æ‰€æœ‰ä¹¦ç±çš„æ•°é‡ï¼š12&gt;&gt;&gt; Book.objects.filter(authors__name__contains='è·¯äººç”²').count()3 èŽ·å–æ‰€æœ‰ä¹¦ç±çš„å¹³å‡ä»·æ ¼ï¼š12&gt;&gt;&gt; Book.objects.all().aggregate(Avg('price'))&#123;'price__avg': Decimal('29.800000')&#125; èŽ·å–æ‰€æœ‰ä¹¦ç±ä¸­çš„æœ€é«˜ä»·æ ¼ï¼š12&gt;&gt;&gt; Book.objects.all().aggregate(Max('price'))&#123;'price__max': Decimal('55.20')&#125; æ¶‰åŠåˆ°ä¸€å¯¹å¤šæˆ–å¤šå¯¹å¤šå…³ç³»çš„èšåˆæŸ¥è¯¢è®¡ç®—æ¯ä¸€ä½ä½œè€…å„è‡ªå‚ä¸Žå†™ä½œäº†å¤šå°‘æœ¬ä¹¦ï¼š12345678&gt;&gt;&gt; from django.db.models import Count&gt;&gt;&gt; authors=Author.objects.annotate(num_books=Count('book'))&gt;&gt;&gt; authors&lt;QuerySet [&lt;Author: Author object (1)&gt;, &lt;Author: Author object (2)&gt;, &lt;Author: Author object (3)&gt;, &lt;Author: Author object (4)&gt;]&gt;&gt;&gt;&gt; authors[0].num_books3&gt;&gt;&gt; authors.values_list('name', 'num_books')&lt;QuerySet [('è·¯äººç”²', 3), ('è·¯äººä¹™', 3), ('è·¯äººä¸™', 4), ('è·¯äººä¸', 4)]&gt; å³ä½œè€…åŒ…å«è·¯äººç”²çš„ä¹¦ç±æœ‰3æœ¬ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ è®¡ç®—æ¯ä¸€ä½ä½œè€…å„è‡ªå‚ä¸Žå†™ä½œçš„ä¹¦ç±æ•°é‡ï¼Œæ ¹æ®ä¹¦ç±å‡ºç‰ˆå¹´ä»½æ˜¯å¦åœ¨2020å¹´ä»¥å‰åˆ†ç•Œï¼š12345678910&gt;&gt;&gt; from django.db.models import Q&gt;&gt;&gt; before_2020 = Count('book', filter=Q(book__pubdate__lt='2020-01-01'))&gt;&gt;&gt; after_2020 = Count('book', filter=Q(book__pubdate__gt='2020-01-01'))&gt;&gt;&gt; authors = Author.objects.annotate(before_2020=before_2020).annotate(after_2020=after_2020)&gt;&gt;&gt; authors&lt;QuerySet [&lt;Author: Author object (1)&gt;, &lt;Author: Author object (2)&gt;, &lt;Author: Author object (3)&gt;, &lt;Author: Author object (4)&gt;]&gt;&gt;&gt;&gt; authors[0].before_20202&gt;&gt;&gt; authors.values_list('name', 'before_2020', 'after_2020')&lt;QuerySet [('è·¯äººç”²', 2, 1), ('è·¯äººä¹™', 2, 1), ('è·¯äººä¸™', 4, 0), ('è·¯äººä¸', 4, 0)]&gt; å³ä½œè€…åŒ…å«è·¯äººç”²çš„ä¹¦ç±ï¼Œ2020å¹´ä»¥å‰å‡ºç‰ˆçš„æœ‰2æœ¬ï¼Œ2020å¹´ä»¥åŽå‡ºç‰ˆçš„æœ‰1æœ¬ã€‚ä»¥æ­¤ç±»æŽ¨ã€‚ èŽ·å–æ¯ä¸€ä½ä½œè€…å„è‡ªå‚ä¸Žè‘—ä½œçš„ä¹¦ç±æ•°é‡ï¼Œå°†è¾“å‡ºç»“æžœæŒ‰ä¹¦ç±æ•°é‡ç”±å¤§åˆ°å°çš„é¡ºåºæŽ’åºï¼š12345&gt;&gt;&gt; authors = Author.objects.annotate(num_books=Count('book')).order_by('-num_books')&gt;&gt;&gt; authors&lt;QuerySet [&lt;Author: Author object (3)&gt;, &lt;Author: Author object (4)&gt;, &lt;Author: Author object (1)&gt;, &lt;Author: Author object (2)&gt;]&gt;&gt;&gt;&gt; authors.values_list('name', 'num_books')&lt;QuerySet [('è·¯äººä¸™', 4), ('è·¯äººä¸', 4), ('è·¯äººç”²', 3), ('è·¯äººä¹™', 3)]&gt; ä¸‰ã€aggregateåœ¨èšåˆæŸ¥è¯¢ä¸­ï¼ŒDjango æ”¯æŒé€šè¿‡ aggregate() æ–¹æ³•ä»Žæ•´ä¸ª QuerySet ä¸­è®¡ç®—å‡ºä¸€ä¸ªæ±‡æ€»æ•°æ®ã€‚å¦‚èŽ·å–æ‰€æœ‰ä¹¦ç±çš„å¹³å‡ä»·æ ¼ï¼š123&gt;&gt;&gt; from django.db.models import Avg&gt;&gt;&gt; Book.objects.all().aggregate(Avg('price'))&#123;'price__avg': Decimal('29.800000')&#125; ä¸Šè¿°è¯­å¥ä¸­çš„ all() å¯ä»¥çœç•¥ã€‚aggregate() çš„å‚æ•°è¡¨ç¤ºæˆ‘ä»¬æƒ³è¦åšèšåˆè®¡ç®—çš„é‚£ä¸€åˆ—æ•°æ®ï¼Œå…¶ä¸­çš„ &#39;price&#39; å³è¡¨ç¤º Book æ¨¡åž‹çš„ price å­—æ®µã€‚ aggregate() å¯¹äºŽ QuerySet æ¥è¯´æ˜¯ä¸€ç§ç»ˆæ­¢è¯­å¥ï¼Œä¼šè¿”å›žå­—å…¸å½¢å¼çš„é”®å€¼å¯¹ä½œä¸ºè®¡ç®—ç»“æžœã€‚å…¶ä¸­çš„é”®ä¼šæ ¹æ®èšåˆçš„å­—æ®µè‡ªåŠ¨ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼š12&gt;&gt;&gt; Book.objects.all().aggregate(average_price=Avg('price'))&#123;'average_price': Decimal('29.800000')&#125; å¦‚æžœæƒ³è¦åŒæ—¶å®Œæˆå¤šä¸ªèšåˆæŸ¥è¯¢æ“ä½œï¼Œå¯ä»¥ä¸º aggregate() æ·»åŠ å¤šä¸ªå‚æ•°ï¼š123&gt;&gt; from django.db.models import Avg, Max, Min&gt;&gt;&gt; Book.objects.aggregate(Avg('price'), Max('price'), Min('price'))&#123;'price__avg': Decimal('29.800000'), 'price__max': Decimal('55.20'), 'price__min': Decimal('5.20')&#125; å››ã€annotateå€ŸåŠ© annotate() æ–¹æ³•ï¼ŒDjango å¯ä»¥ä»Ž QuerySet çš„æ¯ä¸€ä¸ªå¯¹è±¡ä¸­è®¡ç®—å‡ºå¯¹åº”çš„ç‹¬ç«‹çš„æ±‡æ€»æ•°æ®ã€‚æ¯”å¦‚æƒ³èŽ·å¾— Book æ¨¡åž‹ä¸­æ¯ä¸€æœ¬ä¹¦çš„ä½œè€…çš„æ•°é‡ï¼š12345678&gt;&gt;&gt; from django.db.models import Count&gt;&gt;&gt; q = Book.objects.annotate(num_authors=Count('authors'))&gt;&gt;&gt; q&lt;QuerySet [&lt;Book: Book object (1)&gt;, &lt;Book: Book object (2)&gt;, &lt;Book: Book object (3)&gt;, &lt;Book: Book object (4)&gt;, &lt;Book: Book object (5)&gt;, &lt;Book: Book object (6)&gt;, &lt;Book: Book object (7)&gt;, &lt;Book: Book object (8)&gt;]&gt;&gt;&gt;&gt; q[0].num_authors1&gt;&gt;&gt; q.values_list('name', 'num_authors')&lt;QuerySet [('äººä¹‹åˆ', 1), ('æ€§æœ¬å–„', 1), ('æ€§ç›¸è¿‘', 1), ('ä¹ ç›¸è¿œ', 1), ('è‹Ÿä¸æ•™', 3), ('æ€§ä¹ƒè¿', 3), ('æ•™ä¹‹é“', 2), ('è´µä»¥ä¸“', 2)]&gt; ä¸åŒäºŽ aggregate()ï¼Œannotate() å¯¹äºŽ QuerySet æ¥è¯´å¹¶ä¸æ˜¯ç»ˆæ­¢è¯­å¥ï¼Œannotate() æ–¹æ³•çš„è¾“å‡ºç»“æžœä»æ˜¯ QuerySet å¯¹è±¡ã€‚è¯¥å¯¹è±¡å¯ä»¥ç»§ç»­æ‰§è¡Œè¢« QuerySet æ”¯æŒçš„ä»»æ„æ“ä½œï¼Œå¦‚ filter()ã€order_by() ç­‰ï¼Œç”šè‡³å¦ä¸€ä¸ª annotate()ã€‚ äº”ã€join &amp; aggregateæŸäº›æƒ…å†µä¸‹ï¼Œä½ æƒ³è¦èšåˆçš„å­—æ®µå¹¶ä¸å±žäºŽå½“å‰æ­£åœ¨æŸ¥è¯¢çš„æ¨¡åž‹ï¼Œè€Œæ˜¯å±žäºŽå…³è”äºŽå½“å‰æ¨¡åž‹çš„å¦ä¸€ä¸ªæ¨¡åž‹ã€‚åœ¨å¯¹è¿™äº›å­—æ®µè¿›è¡ŒèšåˆæŸ¥è¯¢æ—¶ï¼ŒDjango å…è®¸ä½¿ç”¨ä¸Ž filter() ä¸­ç›¸åŒçš„ç”¨äºŽæŒ‡å®šå…³è”å­—æ®µçš„åŒä¸‹åˆ’çº¿è¯­æ³•ã€‚ æ¯”å¦‚æƒ³è¦èŽ·å–æ¯ä¸€ä½ä½œè€…æ‰€è‘—ä¹¦ç±çš„ä»·æ ¼åŒºé—´ï¼š1234&gt;&gt;&gt; from django.db.models import Max, Min&gt;&gt;&gt; authors = Author.objects.annotate(min_price=Min('book__price'), max_price=Max('book__price'))&gt;&gt;&gt; authors.values_list('name', 'min_price', 'max_price')&lt;QuerySet [('è·¯äººç”²', Decimal('5.20'), Decimal('38.80')), ('è·¯äººä¹™', Decimal('28.40'), Decimal('55.20')), ('è·¯äººä¸™', Decimal('5.20'), Decimal('55.20')), ('è·¯äººä¸', Decimal('5.20'), Decimal('55.20'))]&gt; å³ä½œè€…ä¸ºè·¯äººç”²çš„ä¹¦ç±ä¸­ï¼Œæœ€ä½Žçš„ä»·æ ¼ä¸º 5.20ï¼Œæœ€é«˜çš„ä»·æ ¼ä¸º 38.80ã€‚ å…­ã€filter() æˆ– order_by() åº”ç”¨åˆ° annotate()å¦‚æŸ¥æ‰¾æ‰€æœ‰å¤šäººåˆè‘—ï¼ˆä½œè€…æ•°é‡å¤§äºŽ 1ï¼‰çš„ä¹¦ç±åˆ—è¡¨ï¼š12345&gt;&gt;&gt; books = Book.objects.annotate(num_authors=Count('authors')).filter(num_authors__gt=1)&gt;&gt;&gt; books&lt;QuerySet [&lt;Book: Book object (5)&gt;, &lt;Book: Book object (6)&gt;, &lt;Book: Book object (7)&gt;, &lt;Book: Book object (8)&gt;]&gt;&gt;&gt;&gt; books.values_list('name', 'num_authors')&lt;QuerySet [('è‹Ÿä¸æ•™', 3), ('æ€§ä¹ƒè¿', 3), ('æ•™ä¹‹é“', 2), ('è´µä»¥ä¸“', 2)]&gt; æ ¹æ®ä½œè€…æ•°é‡å¯¹å…¨éƒ¨ä¹¦ç±è¿›è¡ŒæŽ’åºï¼š12345&gt;&gt;&gt; books = Book.objects.annotate(num_authors=Count('authors')).order_by('num_authors')&gt;&gt;&gt; books&lt;QuerySet [&lt;Book: Book object (2)&gt;, &lt;Book: Book object (4)&gt;, &lt;Book: Book object (1)&gt;, &lt;Book: Book object (3)&gt;, &lt;Book: Book object (8)&gt;, &lt;Book: Book object (7)&gt;, &lt;Book: Book object (5)&gt;, &lt;Book: Book object (6)&gt;]&gt;&gt;&gt;&gt; books.values_list('name', 'num_authors')&lt;QuerySet [('æ€§æœ¬å–„', 1), ('ä¹ ç›¸è¿œ', 1), ('äººä¹‹åˆ', 1), ('æ€§ç›¸è¿‘', 1), ('æ•™ä¹‹é“', 2), ('è´µä»¥ä¸“', 2), ('è‹Ÿä¸æ•™', 3), ('æ€§ä¹ƒè¿', 3)]&gt; å‚è€ƒèµ„æ–™Django å®˜æ–¹æ–‡æ¡£ â€”â€” Aggregation]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Web</tag>
        <tag>Django</tag>
        <tag>Models</tag>
        <tag>Aggregate</tag>
        <tag>Annotate</tag>
        <tag>Backend</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue.js æˆªèŽ· Ctrl+S ç»„åˆé”®ä»¥åŠè‡ªåŠ¨ä¿å­˜ï¼ˆæäº¤ï¼‰åŠŸèƒ½çš„å®žçŽ°]]></title>
    <url>%2F2020%2F12%2F14%2Fvue-js-add-auto-save-and-ctrl-s%2F</url>
    <content type="text"><![CDATA[é»˜è®¤æƒ…å†µä¸‹ï¼ŒChrome ä¸­æŒ‰ä¸‹ Ctrl+S ç»„åˆé”®ä¼šè¿›å…¥â€œä¿å­˜ç½‘é¡µâ€ç•Œé¢ï¼Œå¹¶ä¸ä¼šä¸Žç½‘é¡µä¸­çš„å…·ä½“å†…å®¹åšäº¤äº’ã€‚ æœ€è¿‘åœ¨åšä¸€ä¸ªå‰ç«¯åŸºäºŽ Vue çš„åœ¨çº¿æ–‡æ¡£ï¼Œå¸Œæœ›ç½‘é¡µä¸­æŒ‰ä¸‹ Ctrl+S ç»„åˆä»¶å°±èƒ½è§¦å‘æäº¤åŠ¨ä½œï¼Œå°†å‰ç«¯æ•°æ®çš„æ”¹åŠ¨å­˜å‚¨åˆ°åŽç«¯æ•°æ®åº“ä¸­ã€‚å¹¶ä¸”ä¸ç®¡ç”¨æˆ·æ˜¯å¦æ“ä½œï¼Œæ¯éš”ç‰¹å®šæ—¶é—´ä¹Ÿä¼šè‡ªåŠ¨æäº¤æ–‡æ¡£çš„å½“å‰å†…å®¹åˆ°åŽç«¯ï¼Œå®žçŽ°è‡ªåŠ¨ä¿å­˜çš„åŠŸèƒ½ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334&lt;template&gt; &lt;button @click=&quot;save(&apos;button&apos;)&quot;&gt;ä¿å­˜&lt;/button&gt;&lt;/template&gt;&lt;script&gt;export default &#123; mounted() &#123; document.addEventListener(&apos;keydown&apos;, this.saveContent) this.timer = setInterval(() =&gt; &#123; this.save(&apos;timer&apos;) &#125;, 10 * 1000) &#125;, beforeDestroy() &#123; document.removeEventListener(&apos;keydown&apos;, this.saveContent) clearInterval(this.timer) &#125;, methods: &#123; save(type) &#123; console.log(`content saved by $&#123;type&#125;`) &#125;, saveContent(e) &#123; var key = window.event.keyCode ? window.event.keyCode : window.event.which if (key === 83 &amp;&amp; e.ctrlKey) &#123; this.save(&apos;hot key&apos;) e.preventDefault() &#125; &#125; &#125;&#125;&lt;/script&gt;]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Frontend</tag>
        <tag>JavaScript</tag>
        <tag>Vue.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”å•ä¾‹æ¨¡å¼]]></title>
    <url>%2F2020%2F11%2F27%2Fpython-design-patterns-singleton%2F</url>
    <content type="text"><![CDATA[å•ä¾‹æ¨¡å¼å³ç¡®ä¿ç±»æœ‰ä¸”åªæœ‰ä¸€ä¸ªç‰¹å®šç±»åž‹çš„å¯¹è±¡ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ç‚¹ã€‚å› æ­¤é€šå¸¸ç”¨äºŽæ—¥å¿—è®°å½•ã€æ•°æ®åº“æ“ä½œã€æ‰“å°æœºåŽå°å¤„ç†ç¨‹åºç­‰ã€‚è¿™äº›ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åªç”Ÿæˆä¸€ä¸ªå®žä¾‹ï¼Œé¿å…å¯¹åŒä¸€èµ„æºäº§ç”Ÿç›¸äº’å†²çªçš„è¯·æ±‚ã€‚ ç‰¹ç‚¹ï¼š ç¡®ä¿ç±»æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»º ä¸ºå”¯ä¸€å¯¹è±¡æä¾›è®¿é—®ç‚¹ï¼Œä»¤å…¶å¯è¢«å…¨å±€è®¿é—® æŽ§åˆ¶å…±äº«èµ„æºçš„å¹¶è¡Œè®¿é—® ç»å…¸å•ä¾‹æ¨¡å¼1234567891011121314151617181920212223class Singleton(object): def __new__(cls, name): if not hasattr(cls, 'instance'): cls.instance = super().__new__(cls) return cls.instance def __init__(self, name): self.name = names1 = Singleton('Singleton1')print(s1)# =&gt; &lt;__main__.Singleton object at 0x7efc1b006220&gt;print(s1.name)# =&gt; Singleton1s2 = Singleton('Singleton2')print(s2)# =&gt; &lt;__main__.Singleton object at 0x7efc1b006220&gt;print(s2.name)# =&gt; Singleton2print(s1.name)# =&gt; Singleton2 åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡å®šä¹‰ __new__ æ–¹æ³•æŽ§åˆ¶å¯¹è±¡çš„åˆ›å»ºã€‚æ–¹æ³• hasattr åˆ™ç”¨äºŽæ£€æŸ¥å¯¹è±¡ cls æ˜¯å¦å…·æœ‰ instance å±žæ€§ï¼ˆå³ç¡®è®¤è¯¥ç±»æ˜¯å¦å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚è‹¥ instance å±žæ€§ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨ super().__new__() æ–¹æ³•åˆ›å»ºæ–°çš„å®žä¾‹ï¼›è‹¥ instance å±žæ€§å­˜åœ¨ï¼Œåˆ™åˆ†é…å·²æœ‰çš„å®žä¾‹ç»™å˜é‡ã€‚å› æ­¤å½“ s2 = Singleton(&#39;Singleton2&#39;) æ‰§è¡Œæ—¶ï¼Œhasattr å‘çŽ°å¯¹è±¡å®žä¾‹å·²å­˜åœ¨ï¼ˆs1ï¼‰ï¼Œå› æ­¤ç›´æŽ¥å°†å·²æœ‰çš„å¯¹è±¡åˆ†é…ç»™ s2ã€‚s1 å’Œ s2 å®žé™…æ˜¯åŒä¸€ä¸ªå¯¹è±¡å®žä¾‹ã€‚ Monostateï¼ˆå•æ€ï¼‰æ¨¡å¼Monostate æ¨¡å¼å³ç±»çš„æ‰€æœ‰å®žä¾‹å¯¹è±¡å…±äº«ç›¸åŒçš„çŠ¶æ€ã€‚123456789101112131415class Borg: __shared_state = &#123;&#125; def __init__(self): self.__dict__ = self.__shared_stateb = Borg()b1 = Borg()print(b is b1) # =&gt; Falseb.x = 4print(b.x) # =&gt; 4print(b1.x) # =&gt; 4b1.x = 6print(b1.x) # =&gt; 6print(b.x) # =&gt; 6 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡å°†ç±»å˜é‡ __shared_state èµ‹å€¼ç»™å®žä¾‹å˜é‡ __dict__ï¼ˆ__dict__ å˜é‡ç”¨äºŽå­˜å‚¨å®žä¾‹å¯¹è±¡çš„å±žæ€§ç­‰çŠ¶æ€ï¼‰ï¼Œä½¿å¾—ç±»ç”Ÿæˆçš„æ‰€æœ‰å¯¹è±¡å®žä¾‹éƒ½å…±äº«åŒä¸€çŠ¶æ€ã€‚å³ b å’Œ b1 æ˜¯ Borg ç±»åˆ›å»ºçš„ä¸åŒçš„å®žä¾‹å¯¹è±¡ï¼Œä½†ç”¨äºŽä¿å­˜å®žä¾‹çŠ¶æ€çš„ b.__dict__ å’Œ b1.__dict__ å´æ˜¯ç›¸åŒçš„ï¼ˆå³éƒ½æ˜¯ Borg.__shared_stateï¼‰ã€‚å› æ­¤ b çš„å±žæ€§ x è‹¥å‘ç”Ÿæ”¹å˜ï¼ŒåŒæ ·çš„å˜åŒ–ä¹Ÿä¼šä½“çŽ°åˆ° b1 ä¸­ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ __new__ æ–¹æ³•æ¥å®žçŽ° Borg æ¨¡å¼ï¼š1234567891011121314151617181920class Borg: __shared_state = &#123;&#125; def __new__(cls, name): obj = super().__new__(cls) obj.__dict__ = cls.__shared_state return obj def __init__(self, name): self.name = nameb1 = Borg('Borg1')print(b1.name) # =&gt; Borg1b2 = Borg('Borg2')print(b2.name) # =&gt; Borg2print(b1.name) # =&gt; Borg2b1.name = 'Borg'print(b1.name) # =&gt; Borgprint(b2.name) # =&gt; Borgprint(b1 is b2) # =&gt; False é€šè¿‡å…ƒç±»å®žçŽ°å•ä¾‹æ¨¡å¼1234567891011121314151617181920class MetaSingleton(type): def __init__(self, *args, **kwargs): self.__instance = None def __call__(self, *args, **kwargs): if not self.__instance: self.__instance = super().__call__(*args, **kwargs) return self.__instanceclass Logger(metaclass=MetaSingleton): passlogger1 = Logger()logger2 = Logger()print(logger1, logger2)# =&gt; &lt;__main__.Logger object at 0x7fac8af577c0&gt; &lt;__main__.Logger object at# 0x7fac8af577c0&gt;print(logger1 is logger2) # =&gt; True å•ä¾‹æ¨¡å¼çš„å®žé™…åº”ç”¨DB æ“ä½œ1234567891011121314151617181920212223242526272829import sqlite3class MetaSingleton(type): def __init__(self, *args, **kwargs): self.__instance = None def __call__(self, *args, **kwargs): if not self.__instance: self.__instance = super().__call__(*args, **kwargs) return self.__instanceclass Database(metaclass=MetaSingleton): connection = None def connect(self): if self.connection is None: self.connection = sqlite3.connect("db.sqlite3") self.cursorobj = self.connection.cursor() return self.cursorobjdb1 = Database().connect()db2 = Database().connect()print(db1, db2)# =&gt; &lt;sqlite3.Cursor object at 0x7f810d6f8260&gt; &lt;sqlite3.Cursor object at# 0x7f810d6f8260&gt;print(db1 is db2)# =&gt; True ç›‘æŽ§æœåŠ¡12345678910111213141516171819202122232425262728293031323334353637383940414243class HealthCheck: _instance = None def __new__(cls, *args, **kwargs): if not HealthCheck._instance: HealthCheck._instance = super().__new__(cls, *args, **kwargs) return HealthCheck._instance def __init__(self): self._servers = [] def addServer(self): self._servers.append("Server 1") self._servers.append("Server 2") self._servers.append("Server 3") self._servers.append("Server 4") def changeServer(self): self._servers.pop() self._servers.append("Server 5")hc1 = HealthCheck()hc2 = HealthCheck()hc1.addServer()print("Schedule health check for servers (1) ...")for i in range(4): print("Checking ", hc1._servers[i])hc2.changeServer()print("Schedule health check for servers (2) ...")for i in range(4): print("Checking ", hc2._servers[i])# =&gt; Schedule health check for servers (1) ...# =&gt; Checking Server 1# =&gt; Checking Server 2# =&gt; Checking Server 3# =&gt; Checking Server 4# =&gt; Schedule health check for servers (2) ...# =&gt; Checking Server 1# =&gt; Checking Server 2# =&gt; Checking Server 3# =&gt; Checking Server 5]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>DesignPattern</tag>
        <tag>Project</tag>
        <tag>MetaClass</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django REST framework ä½¿ç”¨ MongoDB ä½œä¸ºæ•°æ®åº“åŽç«¯]]></title>
    <url>%2F2020%2F11%2F27%2Fpython-django-rest-framework-and-mongodb%2F</url>
    <content type="text"><![CDATA[æƒ³å†™ä¸ªå‰åŽç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œéœ€è¦åœ¨æ•°æ®åº“ä¸­å­˜å‚¨éžå¸¸å¤æ‚çš„ JSON æ ¼å¼ï¼ˆåŒ…å«å¤šå±‚åµŒå¥—ï¼‰çš„æ•°æ®ï¼Œåˆä¸æƒ³å°† JSON æ•°æ®è½¬ä¸ºæ–‡æœ¬åŽä»¥ Text çš„æ ¼å¼å­˜åˆ° Mysql æ•°æ®åº“ä¸­ã€‚ å› æ­¤æƒ³å°è¯•ä¸‹æ–‡æ¡£åž‹æ•°æ®åº“ MongoDBï¼Œå…¶ç”¨æ¥å­˜æ”¾æ•°æ®çš„æ–‡æ¡£ç»“æž„ï¼Œæœ¬èº«å°±æ˜¯éžå¸¸ç±»ä¼¼ JSON å¯¹è±¡çš„ BSONï¼ˆBinary JSONï¼‰ã€‚ ä½† Django çš„å®˜æ–¹ç‰ˆæœ¬ç›®å‰è¿˜æœªæ”¯æŒ NoSQL æ•°æ®åº“ï¼ˆå‚è€ƒ FAQï¼‰ï¼ŒMongoDB å®˜æ–¹æ–‡æ¡£å»ºè®®å€ŸåŠ© Djongo ç»„ä»¶å®Œæˆåˆ°åŽŸç”Ÿ Django ORM çš„å¯¹æŽ¥ã€‚Djongo å®žé™…ä¸Šæ˜¯ä¸€ä¸ª SQL åˆ° MongoDB çš„ç¿»è¯‘å™¨ã€‚é€šè¿‡ Django çš„ admin åº”ç”¨å¯ä»¥å‘ MongoDB ä¸­æ·»åŠ æˆ–ä¿®æ”¹æ–‡æ¡£ï¼Œå…¶ä»– Django æ¨¡å—å¦‚ contribã€authã€session ç­‰ä¹Ÿå¯ä»¥åœ¨ä¸åšä»»ä½•æ”¹åŠ¨çš„æƒ…å†µä¸‹æ­£å¸¸ä½¿ç”¨ã€‚ é¡¹ç›®åˆå§‹åŒ–å®‰è£…éœ€è¦ç”¨åˆ°çš„ Python æ¨¡å—ï¼Œåˆå§‹åŒ–é¡¹ç›®ï¼š1234$ pip install djongo djangorestframework$ django-admin startproject mongo_test$ cd mongo_test$ django-admin startapp blogs ä¿®æ”¹é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆmongo_test/settings.pyï¼‰ï¼Œæ·»åŠ æ•°æ®åº“é…ç½®ï¼š12345678...DATABASES = &#123; 'default': &#123; 'ENGINE': 'djongo', 'NAME': 'mongo_test', &#125;&#125;... æ•°æ®åº“è¿ç§»ï¼Œåˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼Œè¿è¡Œ WEB æœåŠ¡ï¼š123$ python manage.py migrate$ python manage.py createsuperuser$ python manage.py runserver 0.0.0.0:8000 è®¿é—® http://127.0.0.1:8000/admin ï¼Œè¿›å…¥ Django ç®¡ç†å‘˜åŽå°ï¼Œå„éƒ¨åˆ†åŠŸèƒ½ä½¿ç”¨æ­£å¸¸ï¼š æ­¤æ—¶è®¿é—® MongoDB æ•°æ®åº“ï¼Œå¯ä»¥æŸ¥è¯¢åˆ°å­˜å…¥çš„æ•°æ®ï¼š123456789101112131415161718192021222324252627282930313233343536// mongo shell&gt; show dbsadmin 0.000GBapscheduler 0.000GBconfig 0.000GBlocal 0.000GBmongo_test 0.000GB&gt; use mongo_testswitched to db mongo_test&gt; show collections;__schema__auth_groupauth_group_permissionsauth_permissionauth_userauth_user_groupsauth_user_user_permissionsdjango_admin_logdjango_content_typedjango_migrationsdjango_session&gt; db.auth_user.find().pretty()&#123; &quot;_id&quot; : ObjectId(&quot;5fc0a6a4e7b96c382fa9ccd8&quot;), &quot;id&quot; : 1, &quot;password&quot; : &quot;pbkdf2_sha256$180000$XL0v3lLCM1RW$rnw4qzoTUtwgc5EoKfB4yaaVEu1jTid8yuBVl0Y6P5Q=&quot;, &quot;last_login&quot; : ISODate(&quot;2020-11-27T07:11:55.492Z&quot;), &quot;is_superuser&quot; : true, &quot;username&quot; : &quot;admin&quot;, &quot;first_name&quot; : &quot;&quot;, &quot;last_name&quot; : &quot;&quot;, &quot;email&quot; : &quot;&quot;, &quot;is_staff&quot; : true, &quot;is_active&quot; : true, &quot;date_joined&quot; : ISODate(&quot;2020-11-27T07:11:31.955Z&quot;)&#125; Django REST frameworkåœ¨é…ç½®æ–‡ä»¶ mongo_test/settings.py ä¸­çš„ INSTALLED_APPS é…ç½®é¡¹ä¸‹æ·»åŠ  rest_framework å’Œ blogs ä¸¤ä¸ªåº”ç”¨ï¼š123456789101112...INSTALLED_APPS = [ 'django.contrib.admin', 'django.contrib.auth', 'django.contrib.contenttypes', 'django.contrib.sessions', 'django.contrib.messages', 'django.contrib.staticfiles', 'rest_framework', 'blogs']... æ•°æ®åº“æ¨¡åž‹ï¼ˆModelsï¼‰ç¼–è¾‘ blogs/models.py æ–‡ä»¶ï¼Œåˆ›å»ºæ•°æ®åº“æ¨¡åž‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789from djongo import modelsclass Blog(models.Model): title = models.CharField(max_length=50) content = models.TextField() class Meta: db_table = 'mongo_blog' åºåˆ—åŒ–å™¨ï¼ˆSerializersï¼‰åˆ›å»º blogs/serializers.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678from blogs.models import Blogfrom rest_framework.serializers import ModelSerializerclass BlogSerializer(ModelSerializer): class Meta: model = Blog fields = '__all__' è§†å›¾ï¼ˆViewsï¼‰ç¼–è¾‘ blogs/views.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678from blogs.models import Blogfrom blogs.serializers import BlogSerializerfrom rest_framework.viewsets import ModelViewSetclass BlogViewSet(ModelViewSet): queryset = Blog.objects.all() serializer_class = BlogSerializer è·¯ç”±ï¼ˆURLsï¼‰åˆ›å»º blogs/urls.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678910from django.urls import include, pathfrom rest_framework import routersfrom blogs import viewsrouter = routers.DefaultRouter()router.register(r'blog', views.BlogViewSet)urlpatterns = [ path('', include(router.urls))] æ ¹è·¯ç”±ç¼–è¾‘é¡¹ç›®è·¯ç”±é…ç½®æ–‡ä»¶ mongo_test/urls.pyï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567from django.contrib import adminfrom django.urls import path, includeurlpatterns = [ path('admin/', admin.site.urls), path('', include('blogs.urls')),] è®¿é—® http://127.0.0.1/blog ï¼Œåˆ©ç”¨ POST æ–¹æ³•æ–°å¢žæ•°æ®ä»¥æµ‹è¯• REST API è¿è¡Œæ•ˆæžœï¼š ç»“æžœçˆ†å‡º TypeError é”™è¯¯ï¼ˆint() argument must be a string, a bytes-like object or a number, not &#39;ObjectId&#39;ï¼‰ï¼š é‡æ–°è®¿é—® http://127.0.0.1:8000/blog ï¼Œå‘çŽ°æ–°å¢žçš„æ•°æ®å·²æ·»åŠ åˆ°æ•°æ®åº“ä¸­ï¼Œåªæ˜¯ id é¡¹ä¸º nullï¼š1234567[ &#123; "id": null, "title": "Blog", "content": "This is a TEST Blog" &#125;] å¯¼è‡´åŸºäºŽ REST API çš„ CRUD æ“ä½œéƒ½æ˜¯ä¸èƒ½æ­£å¸¸æ‰§è¡Œçš„ã€‚ ObjectIdå®žé™…ä¸ŠæŒ‰ç…§ä¸Šè¿°æ–¹å¼å­˜å…¥æ•°æ®åº“çš„æ•°æ®æ˜¯ä»¥ä¸‹æ ¼å¼ï¼š1234567// mongo shell&gt; db.mongo_blog.findOne()&#123; &quot;_id&quot; : ObjectId(&quot;5fc0ae2ea7795c8c4ddae815&quot;), &quot;title&quot; : &quot;Blog&quot;, &quot;content&quot; : &quot;This is a TEST Blog&quot;&#125; ä¿®æ”¹æ•°æ®åº“æ¨¡åž‹ï¼ˆblogs/models.pyï¼‰ï¼Œä»¤å…¶åŒ…å« _id å­—æ®µï¼š12345678910from djongo import modelsclass Blog(models.Model): _id = models.ObjectIdField() title = models.CharField(max_length=50) content = models.TextField() class Meta: db_table = 'mongo_blog' åˆ·æ–° http://127.0.0.1:8000/blog é¡µé¢ï¼Œæ­¤æ—¶æ•°æ®æ˜¾ç¤ºæ­£å¸¸ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ POST æ–¹æ³•æ­£å¸¸æ·»åŠ æ•°æ®ï¼ˆ_id é¡¹ç•™ç©ºï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰ï¼š Retrieveä¸Šè¿°å®žçŽ°ä»æœ‰éƒ¨åˆ†é—®é¢˜ï¼Œå®žé™…ä¸Šåªæœ‰æ–°å€¼æ•°æ®ï¼ˆCreateï¼‰å’ŒèŽ·å–æ•°æ®åˆ—è¡¨ï¼ˆListï¼‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚è€Œ CRUD ä¸­çš„ Retrieveã€Updateã€Delete éƒ½ä¼šæŠ¥å‡º 404 é”™è¯¯ã€‚å³æ— æ³•é€šè¿‡ _id èŽ·å–å¯¹åº”çš„æ•°æ®å¯¹è±¡ã€‚ æ¯”å¦‚è®¿é—® http://127.0.0.1:8000/blog/5fc0b18e60870125f0ed846d/ ï¼š åŽŸå› æ˜¯ MongoDB ä¸­çš„ _id æ˜¯ OjbectId ç±»åž‹ï¼Œä¸Ž Django REST framework ç”¨äºŽæ£€ç´¢çš„ _id ç±»åž‹ä¸ä¸€è‡´ï¼Œå¯¼è‡´æ— æ³•é€šè¿‡ _id æ‰¾åˆ°å¯¹åº”çš„å¯¹è±¡ã€‚éœ€è¦åœ¨ä¸­é—´åšä¸€æ­¥è½¬æ¢å·¥ä½œï¼ˆå°†å­—ç¬¦ä¸²å½¢å¼çš„ _id è½¬æ¢ä¸º ObjectId å½¢å¼ï¼‰ã€‚12345// mongo shell&gt; db.mongo_blog.find(&#123;&quot;_id&quot;: &quot;5fc0b18e60870125f0ed846d&quot;&#125;)&gt;&gt; db.mongo_blog.find(&#123;&quot;_id&quot;: ObjectId(&quot;5fc0b18e60870125f0ed846d&quot;)&#125;)&#123; &quot;_id&quot; : ObjectId(&quot;5fc0b18e60870125f0ed846d&quot;), &quot;title&quot; : &quot;Blog2&quot;, &quot;content&quot; : &quot;This is another Blog&quot; &#125; æŸ¥çœ‹ ModelViewSet æºä»£ç é€šè¿‡æŸ¥çœ‹ ModelViewSet çš„æºä»£ç ï¼Œå‘çŽ°åŽå°å¯¹ Retrieve æ“ä½œçš„å“åº”é€»è¾‘æ˜¯ç”±mixinx.RetrieveModelMixin ç±»å®žçŽ°çš„ï¼Œå…¶ä¸­èŽ·å–æŸä¸ªç‰¹å®šå¯¹è±¡çš„å‡½æ•°æ˜¯ self.get_object()ï¼š12345678class RetrieveModelMixin: """ Retrieve a model instance. """ def retrieve(self, request, *args, **kwargs): instance = self.get_object() serializer = self.get_serializer(instance) return Response(serializer.data) è¿›ä¸€æ­¥æŸ¥æ‰¾ï¼Œå‘çŽ° get_object() å‡½æ•°æ˜¯åœ¨ generics.GenericAPIVie ç±»ä¸­å®žçŽ°çš„ï¼Œå…¶ä»£ç ä¸ºï¼š12345678910111213141516171819202122232425262728class GenericAPIView(views.APIView): def get_object(self): &quot;&quot;&quot; Returns the object the view is displaying. You may want to override this if you need to provide non-standard queryset lookups. Eg if objects are referenced using multiple keyword arguments in the url conf. &quot;&quot;&quot; queryset = self.filter_queryset(self.get_queryset()) # Perform the lookup filtering. lookup_url_kwarg = self.lookup_url_kwarg or self.lookup_field assert lookup_url_kwarg in self.kwargs, ( &apos;Expected view %s to be called with a URL keyword argument &apos; &apos;named &quot;%s&quot;. Fix your URL conf, or set the `.lookup_field` &apos; &apos;attribute on the view correctly.&apos; % (self.__class__.__name__, lookup_url_kwarg) ) filter_kwargs = &#123;self.lookup_field: self.kwargs[lookup_url_kwarg]&#125; obj = get_object_or_404(queryset, **filter_kwargs) # May raise a permission denied self.check_object_permissions(self.request, obj) return obj å…¶ä¸­æœ€å…³é”®çš„ä¸¤å¥ä¸ºï¼š12filter_kwargs = &#123;self.lookup_field: self.kwargs[lookup_url_kwarg]&#125;obj = get_object_or_404(queryset, **filter_kwargs) {self.lookup_field: self.kwargs[lookup_url_kwarg]} å†³å®šäº†æœ€ç»ˆ MongoDB ä¼šä»¥æ€Žæ ·çš„æ–¹å¼å’Œæ¡ä»¶æ£€ç´¢æŸä¸ªå¯¹è±¡ã€‚ å®žçŽ°è‡ªå·±çš„ ModelViewSetç»¼ä¸Šï¼Œä¸ºäº†è®© CURD æ“ä½œä¸­çš„ URD èƒ½å¤Ÿé€šè¿‡ _idï¼ˆObjectIdï¼‰æ£€ç´¢èŽ·å–ç‰¹å®šå¯¹è±¡ï¼Œå¯ä»¥å®žçŽ°è‡ªå·±çš„ ModelViewSet ç±»ï¼Œé‡å†™ get_object() æ–¹æ³•ã€‚ æ–°å»º blogs/mongo_viewset.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829from bson import ObjectIdfrom django.shortcuts import get_object_or_404from rest_framework.viewsets import ModelViewSetclass MongoModelViewSet(ModelViewSet): def get_object(self): queryset = self.filter_queryset(self.get_queryset()) # Perform the lookup filtering. lookup_url_kwarg = self.lookup_url_kwarg or self.lookup_field assert lookup_url_kwarg in self.kwargs, ( 'Expected view %s to be called with a URL keyword argument ' 'named "%s". Fix your URL conf, or set the `.lookup_field` ' 'attribute on the view correctly.' % (self.__class__.__name__, lookup_url_kwarg) ) if self.lookup_field == '_id': filter_kwargs = &#123;self.lookup_field: ObjectId(self.kwargs[self.lookup_field])&#125; else: filter_kwargs = &#123;self.lookup_field: self.kwargs[self.lookup_url_kwarg]&#125; obj = get_object_or_404(queryset, **filter_kwargs) # May raise a permission denied self.check_object_permissions(self.request, obj) return obj æœ€ä¸»è¦çš„æ”¹åŠ¨å³ï¼š1234if self.lookup_field == &apos;_id&apos;: filter_kwargs = &#123;self.lookup_field: ObjectId(self.kwargs[self.lookup_field])&#125;else: filter_kwargs = &#123;self.lookup_field: self.kwargs[self.lookup_url_kwarg]&#125; è§†å›¾ä»£ç  blogs/views.py æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š123456789from blogs.models import Blogfrom blogs.serializers import BlogSerializerfrom blogs.mongo_viewset import MongoModelViewSetclass BlogViewSet(MongoModelViewSet): queryset = Blog.objects.all() serializer_class = BlogSerializer lookup_field = '_id' æ­¤æ—¶è®¿é—® http://172.20.23.34:8000/blog/5fc0b18e60870125f0ed846d/ å³å¯æ­£å¸¸æ˜¾ç¤ºï¼Œå³èƒ½å¤Ÿé€šè¿‡ _idï¼ˆObjectIdï¼‰èŽ·å–å¯¹åº”çš„æ•°æ®å¯¹è±¡ã€‚ ç”±æ­¤ CRUD æ“ä½œå…¨éƒ¨å¯ä»¥æ­£å¸¸æ”¯æŒã€‚]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>Backend</tag>
        <tag>REST</tag>
        <tag>MongoDB</tag>
        <tag>NoSQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®° â€”â€” è£…é¥°å™¨å’Œé—­åŒ…]]></title>
    <url>%2F2020%2F11%2F19%2Ffluent-python-decorator-and-closure%2F</url>
    <content type="text"><![CDATA[è£…é¥°å™¨å‡½æ•°è£…é¥°å™¨ç”¨äºŽåœ¨æºç ä¸­â€œæ ‡è®°â€å‡½æ•°ï¼Œä»¥æŸç§æ–¹å¼å¢žå¼ºå‡½æ•°çš„è¡Œä¸ºã€‚å®ƒæ˜¯ä¸€ç§ä»¥å¦ä¸€ä¸ªå‡½æ•°ï¼ˆè¢«è£…é¥°çš„å‡½æ•°ï¼‰ä¸ºå‚æ•°çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œå¯èƒ½ä¼šå¤„ç†è¢«è£…é¥°çš„å‡½æ•°å¹¶å°†å…¶è¿”å›žï¼Œæˆ–è€…å°†å…¶æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå‡½æ•°ã€‚ è£…é¥°å™¨ä¸¥æ ¼æ¥è¯´åªæ˜¯è¯­æ³•ç³–ã€‚å‡å¦‚æœ‰ä¸ªåä¸º decorate çš„è£…é¥°å™¨ï¼š123@decoratedef target(): print('running target()') ä¸Šè¿°ä»£ç æ•ˆæžœç­‰åŒäºŽå¦‚ä¸‹å†™æ³•ï¼š1234def target(): print('running target()')target = decorate(target) å³åŽŸæ¥çš„ target å‡½æ•°ä¼šè¢«æ›¿æ¢ä¸º decorate(target) è¿”å›žçš„å‡½æ•°ã€‚12345678910111213&gt;&gt;&gt; def deco(func):... def inner():... print('running inner()')... return inner...&gt;&gt;&gt; @deco... def target():... print('running target()')...&gt;&gt;&gt; target()running inner()&gt;&gt;&gt; target&lt;function deco.&lt;locals&gt;.inner at 0x7ff01bad9a60&gt; å¦‚ä¸Šè¿°ä»£ç ï¼Œdeco è¿”å›ž inner å‡½æ•°å¯¹è±¡ï¼Œä½¿ç”¨ deco è£…é¥° targetï¼Œè°ƒç”¨è¢«è£…é¥°çš„ target å®žé™…ä¼šè¿è¡Œ innerã€‚target å¯¹è±¡å˜ä¸º inner çš„å¼•ç”¨ã€‚ è£…é¥°å™¨æœ‰å¦‚ä¸‹ä¸¤å¤§ç‰¹æ€§ï¼š èƒ½æŠŠè¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢æˆå…¶ä»–å‡½æ•° è£…é¥°å™¨åœ¨åŠ è½½æ¨¡å—æ—¶ç«‹å³æ‰§è¡Œ è£…é¥°å™¨ä½•æ—¶æ‰§è¡Œè£…é¥°å™¨ä¼šåœ¨è¢«è£…é¥°çš„å‡½æ•°å®šä¹‰ä¹‹åŽç«‹å³è¿è¡Œï¼Œè¿™é€šå¸¸æ˜¯åœ¨ Python åŠ è½½æ¨¡å—æ—¶ã€‚ å‚è€ƒå¦‚ä¸‹ registration.py æ¨¡å—ï¼š123456789101112131415161718192021222324252627registry = []def register(func): print(f'running register(&#123;func&#125;)') registry.append(func) return func@registerdef f1(): print('running f1()')@registerdef f2(): print('running f2()')def f3(): print('running f3()')def main(): print('running main()') print('registry -&gt;', registry) f1() f2() f3()if __name__ == '__main__': main() è¿è¡ŒåŽè¾“å‡ºå¦‚ä¸‹ï¼š1234567running register(&lt;function f1 at 0x7fbc852d43a0&gt;)running register(&lt;function f2 at 0x7fbc852d4430&gt;)running main()registry -&gt; [&lt;function f1 at 0x7fbc852d43a0&gt;, &lt;function f2 at 0x7fbc852d4430&gt;]running f1()running f2()running f3() Python åŠ è½½æ¨¡å—åŽï¼Œè£…é¥°å™¨ register ä¼šåœ¨å…¶ä»–å‡½æ•°ä¹‹å‰è¿è¡Œï¼Œå°†è¢«è£…é¥°çš„å‡½æ•°ï¼ˆf1 å’Œ f2ï¼‰çš„å¼•ç”¨æ·»åŠ åˆ° registry åˆ—è¡¨ä¸­ã€‚åŽŸæœ¬çš„å‡½æ•° f1 å’Œ f2ï¼Œä»¥åŠæœªè¢«è£…é¥°çš„ f3ï¼Œåˆ™åªåœ¨ main æ˜Žç¡®è°ƒç”¨å®ƒä»¬æ—¶æ‰æ‰§è¡Œã€‚ å¦‚æžœå¯¼å…¥ registration.py æ¨¡å—ï¼ˆä¸ä½œä¸ºè„šæœ¬è¿è¡Œï¼‰ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š123&gt;&gt;&gt; import registrationrunning register(&lt;function f1 at 0x7f8fbd8c3b80&gt;)running register(&lt;function f2 at 0x7f8fbd8c3c10&gt;) å‡½æ•°è£…é¥°å™¨åœ¨å¯¼å…¥æ¨¡å—æ—¶ç«‹å³æ‰§è¡Œï¼Œè€Œè¢«è£…é¥°çš„å‡½æ•°åªåœ¨æ˜Žç¡®è°ƒç”¨æ—¶æ‰§è¡Œã€‚çªå‡ºäº†å¯¼å…¥æ—¶å’Œè¿è¡Œæ—¶ä¹‹é—´çš„åŒºåˆ«ã€‚ å˜é‡ä½œç”¨åŸŸè§„åˆ™æµ‹è¯•å¦‚ä¸‹å‡½æ•°ï¼Œå®ƒè¯»å–ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œä¸€ä¸ªæ˜¯å±€éƒ¨å˜é‡ aï¼Œæ˜¯å‡½æ•°çš„å‚æ•°ï¼›å¦ä¸€ä¸ªæ˜¯æœªè¢«å®šä¹‰çš„å˜é‡ bï¼š12345678910&gt;&gt;&gt; def f1(a):... print(a)... print(b)...&gt;&gt;&gt; f1(3)3Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "&lt;stdin&gt;", line 3, in f1NameError: name 'b' is not defined è¿è¡Œæ—¶å˜é‡ a çš„å€¼æ­£å¸¸è¾“å‡ºï¼ŒæŽ¥ç€æŠ¥å‡º name â€˜bâ€™ is not definedã€‚ è‹¥å…ˆç»™å…¨å±€å˜é‡ b èµ‹å€¼ï¼Œå†è°ƒç”¨ f1 å‡½æ•°ï¼Œå°±ä¸ä¼šæŠ¥é”™ï¼š1234&gt;&gt;&gt; b = 6&gt;&gt;&gt; f1(3)36 ä½†å¦‚ä¸‹ä»£ç çš„ç»“æžœå¯èƒ½ä¼šè®©äººæ„æƒ³ä¸åˆ°ï¼š123456789101112&gt;&gt;&gt; b=6&gt;&gt;&gt; def f2(a):... print(a)... print(b)... b = 9...&gt;&gt;&gt; f2(3)3Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "&lt;stdin&gt;", line 3, in f2UnboundLocalError: local variable 'b' referenced before assignment ä»£ç è¿è¡ŒåŽé¦–å…ˆè¾“å‡ºäº† 3ï¼ˆprint(a)ï¼‰ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªè¯­å¥ print(b) æ‰§è¡ŒæŠ¥é”™ã€‚æŒ‰ç…§ç›´è§‰ç¬¬äºŒä¸ª print è¯­å¥åº”è¯¥è¾“å‡º 6ï¼Œå› ä¸ºå…¨å±€å˜é‡ b å·²ç»åœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰èµ‹å€¼ï¼Œå±€éƒ¨å˜é‡ b çš„èµ‹å€¼åŠ¨ä½œä¹Ÿæ˜¯åœ¨ print è¯­å¥åŽé¢ã€‚ äº‹å®žä¸Šæ˜¯ï¼ŒPython åœ¨ç¼–è¯‘å‡½æ•°å®šä¹‰ä½“æ—¶ï¼Œä¼šåˆ¤æ–­ b æ˜¯å±€éƒ¨å˜é‡ï¼ŒPython ä¼šå°è¯•ä»Žæœ¬åœ°çŽ¯å¢ƒèŽ·å– bã€‚è°ƒç”¨ f2(3) æ—¶ï¼Œf2 çš„å®šä¹‰ä½“å°è¯•èŽ·å–å±€éƒ¨å˜é‡ b çš„å€¼ï¼Œå‘çŽ° b æ²¡æœ‰ç»‘å®šåŽæŠ¥é”™ã€‚ å¦‚æžœåœ¨å‡½æ•°å†…éƒ¨èµ‹å€¼æ—¶æƒ³è®©è§£é‡Šå™¨æŠŠ b å½“æˆå…¨å±€å˜é‡ï¼Œéœ€è¦ä½¿ç”¨ global å£°æ˜Žï¼š123456789101112131415161718&gt;&gt;&gt; b = 6&gt;&gt;&gt; def f3(a):... global b... print(a)... print(b)... b = 9...&gt;&gt;&gt; f3(3)36&gt;&gt;&gt; b9&gt;&gt;&gt; f3(3)39&gt;&gt;&gt; b = 30&gt;&gt;&gt; b30 é—­åŒ…é—­åŒ…æŒ‡å»¶ä¼¸äº†ä½œç”¨åŸŸçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å®šä¹‰ä½“ä¸­å¼•ç”¨ã€ä¸åœ¨å®šä¹‰ä½“ä¸­å®šä¹‰çš„éžå…¨å±€å˜é‡ã€‚ è®¡ç®—ç§»åŠ¨å¹³å‡å€¼ï¼ˆä¸æ–­å¢žåŠ çš„ç³»åˆ—å€¼çš„å‡å€¼ï¼‰çš„ç±»ï¼š123456789# average_oo.pyclass Averager: def __init__(self): self.series = [] def __call__(self, new_value): self.series.append(new_value) total = sum(self.series) return total/len(self.series) æ•ˆæžœå¦‚ä¸‹ï¼š12345678&gt;&gt;&gt; from average_oo import Averager&gt;&gt;&gt; avg = Averager()&gt;&gt;&gt; avg(10)10.0&gt;&gt;&gt; avg(11)10.5&gt;&gt;&gt; avg(12)11.0 ä»¥ä¸‹ä»£ç æ˜¯åŒæ ·åŠŸèƒ½çš„å‡½æ•°å¼å®žçŽ°ï¼š123456789def make_averager(): series = [] def averager(new_value): series.append(new_value) total = sum(series) return total / len(series) return averager 12345678&gt;&gt;&gt; from average import make_averager&gt;&gt;&gt; avg = make_averager()&gt;&gt;&gt; avg(10)10.0&gt;&gt;&gt; avg(11)10.5&gt;&gt;&gt; avg(12)11.0 ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼ŒAverager ç±»çš„å®žä¾‹ avg å­˜å‚¨åŽ†å²å€¼çš„ä½ç½®å¾ˆæ˜Žæ˜¾ï¼šé€šè¿‡ self.series å®žä¾‹å±žæ€§ã€‚ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œseries æ˜¯ make_averager å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œä½†è°ƒç”¨ avg(10) æ—¶ï¼Œmake_averager å‡½æ•°å·²ç»è¿”å›žï¼Œå®ƒçš„æœ¬åœ°ä½œç”¨åŸŸä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚ åœ¨ averager å‡½æ•°ä¸­ï¼Œseries æ˜¯è‡ªç”±å˜é‡ï¼ˆfree variableï¼‰ï¼ŒæŒ‡æœªåœ¨æœ¬åœ°ä½œç”¨åŸŸä¸­ç»‘å®šçš„å˜é‡ã€‚ é—­åŒ…æ˜¯ä¸€ç§å‡½æ•°ï¼Œå®ƒä¼šä¿ç•™å®šä¹‰å‡½æ•°æ—¶å­˜åœ¨çš„è‡ªç”±å˜é‡çš„ç»‘å®šã€‚è¿™æ ·åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå³ä¾¿å®šä¹‰ä½œç”¨åŸŸä¸å¯ç”¨äº†ï¼Œé€šè¿‡é—­åŒ…ä»èƒ½ä½¿ç”¨é‚£äº›ç»‘å®šã€‚ nolocalå‰é¢å®žçŽ° make_averager å‡½æ•°çš„æ–¹å¼æ•ˆçŽ‡å¹¶ä¸é«˜ï¼ŒæŠŠæ‰€æœ‰å€¼å­˜å‚¨åœ¨åŽ†å²åˆ—è¡¨ä¸­ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨ averager æ—¶ä½¿ç”¨ sum æ±‚å’Œã€‚æ›´å¥½çš„å®žçŽ°æ–¹å¼æ˜¯ï¼Œåªå­˜å‚¨ç›®å‰çš„æ€»å’Œä»¥åŠå…ƒç´ ä¸ªæ•°ï¼Œåªä½¿ç”¨è¿™ä¸¤ä¸ªå€¼è®¡ç®—å‡å€¼ã€‚1234567891011# average2.pydef make_averager(): count = 0 total = 0 def averager(new_value): count += 1 total += new_value return total / count return averager ä¸Šè¿°ä»£ç è¿è¡ŒåŽä¼šæŠ¥å‡ºå¦‚ä¸‹é”™è¯¯ï¼š12345678&gt;&gt;&gt; from average2 import make_averager&gt;&gt;&gt; avg = make_averager()&gt;&gt;&gt; avg(10)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "/home/starky/program/python/algorithm/average2.py", line 6, in averager count += 1UnboundLocalError: local variable 'count' referenced before assignment åŽŸå› åœ¨äºŽï¼Œå½“ count æ˜¯æ•°å­—æˆ–å…¶ä»–ä»»ä½•ä¸å¯å˜ç±»åž‹æ—¶ï¼Œcount += 1 çš„ä½œç”¨ç­‰åŒäºŽ count = count + 1ã€‚å¯¼è‡´åœ¨ averager çš„å®šä¹‰ä½“ä¸­ä¸º count èµ‹å€¼äº†ï¼Œå°† count å˜æˆäº†å±€éƒ¨å˜é‡ã€‚total å˜é‡ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¹‹å‰çš„ series å˜é‡æ²¡æœ‰å‡ºçŽ°æ­¤é—®é¢˜ï¼ŒåŽŸå› æ˜¯åªè°ƒç”¨äº† series.appendï¼Œåˆ—è¡¨ä½œä¸ºå¯å˜å¯¹è±¡ï¼Œå¹¶ä¸å­˜åœ¨é‡æ–°èµ‹å€¼çš„æƒ…å†µã€‚ Python 3 ä¸­å¼•å…¥äº† nolocal å£°æ˜Žï¼Œå…¶ä½œç”¨æ˜¯æŠŠå˜é‡æ ‡è®°ä¸ºè‡ªç”±å˜é‡ã€‚ä¸º nolocal å£°æ˜Žçš„å˜é‡èµ‹äºˆæ–°å€¼åŽï¼Œé—­åŒ…ä¸­ä¿å­˜çš„ç»‘å®šä¹Ÿä¼šæ›´æ–°ã€‚1234567891011def make_averager(): count = 0 total = 0 def averager(new_value): nonlocal count, total count += 1 total += new_value return total / count return averager å®žçŽ°ä¸€ä¸ªç®€å•çš„è£…é¥°å™¨1234567891011121314151617181920212223242526import timedef clock(func): def clocked(*args): t0 = time.perf_counter() result = func(*args) elapsed = time.perf_counter() - t0 name = func.__name__ arg_str = ', '.join(repr(arg) for arg in args) print('[%0.8fs] %s(%s) -&gt; %r' % (elapsed, name, arg_str, result)) return result return clocked@clockdef snooze(seconds): time.sleep(seconds)@clockdef factorial(n): return 1 if n &lt; 2 else n * factorial(n - 1)if __name__ == '__main__': print('*' * 40, 'Calling snooze(.123)') snooze(.123) print('*' * 40, 'Calling factorial(6)') print('6! =', factorial(6)) æ‰§è¡Œç»“æžœå¦‚ä¸‹ï¼š12345678910**************************************** Calling snooze(.123)[0.12318703s] snooze(0.123) -&gt; None**************************************** Calling factorial(6)[0.00000168s] factorial(1) -&gt; 1[0.00003647s] factorial(2) -&gt; 2[0.00006038s] factorial(3) -&gt; 6[0.00008216s] factorial(4) -&gt; 24[0.00010411s] factorial(5) -&gt; 120[0.00012920s] factorial(6) -&gt; 7206! = 720 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š123@clockdef factorial(n): return 1 if n &lt; 2 else n * factorial(n - 1) ç­‰åŒäºŽï¼š123def factorial(n): return 1 if n &lt; 2 else n * factorial(n - 1)factorial = clock(factorial) factorial ä¼šä½œä¸º func å‚æ•°ä¼ é€’ç»™ clockï¼Œè¿”å›ž clocked å‡½æ•°ã€‚Python è§£é‡Šå™¨åœ¨èƒŒåŽä¼šæŠŠ clocked èµ‹å€¼ç»™ factorialã€‚æ­¤åŽï¼Œæ¯æ¬¡è°ƒç”¨ factorial(n)ï¼Œå®žé™…æ‰§è¡Œçš„éƒ½æ˜¯ clocked(n)ã€‚æ€»ä½“æ­¥éª¤å¦‚ä¸‹ï¼š è®°å½•åˆå§‹æ—¶é—´ t0 è°ƒç”¨åŽŸæ¥çš„ factorial å‡½æ•°ï¼Œä¿å­˜ç»“æžœ è®¡ç®—æ‰§è¡Œçš„æ—¶é—´ æ ¼å¼åŒ–æ”¶é›†åˆ°çš„æ•°æ® è¿”å›žç¬¬äºŒæ­¥ä¿å­˜çš„ç»“æžœ ä»¥ä¸Šå³è£…é¥°å™¨çš„å…¸åž‹è¡Œä¸ºï¼šå°†è¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢ä¸ºæ–°å‡½æ•°ï¼ŒäºŒè€…æŽ¥æ”¶åŒæ ·çš„å‚æ•°ï¼Œï¼ˆé€šå¸¸ï¼‰è¿”å›žè¢«è£…é¥°å‡½æ•°æœ¬è¯¥è¿”å›žçš„å€¼ï¼Œå¹¶åšäº›é¢å¤–çš„æ“ä½œã€‚ å‚æ•°åŒ–è£…é¥°å™¨å‚æ•°åŒ–çš„æ³¨å†Œè£…é¥°å™¨ ä¸ºäº†ä¾¿äºŽå¯ç”¨æˆ–ç¦ç”¨ register çš„å‡½æ•°æ³¨å†ŒåŠŸèƒ½ï¼Œå¯ä»¥ä¸ºå…¶æä¾›ä¸€ä¸ªå¯é€‰çš„ active å‚æ•°ï¼Œè®¾ä¸º False æ—¶ï¼Œä¸æ³¨å†Œè¢«è£…é¥°çš„å‡½æ•°ã€‚ä»Žæ¦‚å¿µä¸Šè®²ï¼Œè¿™ä¸ªæ–°çš„ register å‡½æ•°ä¸æ˜¯è£…é¥°å™¨ï¼Œè€Œæ˜¯è£…é¥°å™¨å·¥åŽ‚å‡½æ•°ï¼Œç”¨æ¥è¿”å›žçœŸæ­£çš„è£…é¥°å™¨ã€‚123456789101112131415161718192021222324# registration_param.pyregistry = set()def register(active=True): def decorate(func): print('running register(active=%s)-&gt;decorate(%s)' % (active, func)) if active: registry.add(func) else: registry.discard(func) return func return decorate@register(active=False)def f1(): print('running f1()')@register()def f2(): print('running f2()')def f3(): print('running f3()') è¿è¡Œæ•ˆæžœï¼š12345&gt;&gt;&gt; import registration_paramrunning register(active=False)-&gt;decorate(&lt;function f1 at 0x7fa801b1bc10&gt;)running register(active=True)-&gt;decorate(&lt;function f2 at 0x7fa801b1bca0&gt;)&gt;&gt;&gt; registration_param.registry&#123;&lt;function f2 at 0x7fa801b1bca0&gt;&#125; decorate æ˜¯è£…é¥°å™¨ï¼Œå¿…é¡»è¿”å›žä¸€ä¸ªå‡½æ•°ã€‚register æ˜¯è£…é¥°å™¨å·¥åŽ‚å‡½æ•°ï¼Œè¿”å›ž decorateã€‚åªæœ‰ active å‚æ•°çš„å€¼ä¸º True æ—¶æ‰æ³¨å†Œ funcï¼›è‹¥ active ä¸ä¸ºçœŸï¼Œä¸” func åœ¨ registry ä¸­ï¼Œåˆ™å°† func ç§»é™¤ã€‚@register å·¥åŽ‚å‡½æ•°å¿…é¡»ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œä¼ å…¥æ‰€éœ€å‚æ•°ï¼ˆæˆ– @register()ï¼‰ã€‚ è‹¥ä¸ä½¿ç”¨ @ å¥æ³•ï¼Œä¹Ÿå¯ä»¥åƒå¸¸è§„å‡½æ•°é‚£æ ·ä½¿ç”¨ registerï¼š123456789101112131415&gt;&gt;&gt; from registration_param import *running register(active=False)-&gt;decorate(&lt;function f1 at 0x7fc32e6d0b80&gt;)running register(active=True)-&gt;decorate(&lt;function f2 at 0x7fc32e6d0c10&gt;)&gt;&gt;&gt; registry&#123;&lt;function f2 at 0x7fc32e6d0c10&gt;&#125;&gt;&gt;&gt; register()(f3)running register(active=True)-&gt;decorate(&lt;function f3 at 0x7fc32e6d0af0&gt;)&lt;function f3 at 0x7fc32e6d0af0&gt;&gt;&gt;&gt; registry&#123;&lt;function f2 at 0x7fc32e6d0c10&gt;, &lt;function f3 at 0x7fc32e6d0af0&gt;&#125;&gt;&gt;&gt; register(active=False)(f2)running register(active=False)-&gt;decorate(&lt;function f2 at 0x7fc32e6d0c10&gt;)&lt;function f2 at 0x7fc32e6d0c10&gt;&gt;&gt;&gt; registry&#123;&lt;function f3 at 0x7fc32e6d0af0&gt;&#125; å‚æ•°åŒ–çš„ clock è£…é¥°å™¨12345678910111213141516171819202122232425262728293031# clock_param.pyimport timeDEFAULT_FMT = '[&#123;elapsed:0.8f&#125;s] &#123;name&#125;(&#123;args&#125;) -&gt; &#123;result&#125;'def clock(fmt=DEFAULT_FMT): def decorate(func): def clocked(*_args): t0 = time.time() _result = func(*_args) elapsed = time.time() - t0 name = func.__name__ args = ', '.join(repr(arg) for arg in _args) result = repr(_result) print(fmt.format(**locals())) return _result return clocked return decorateif __name__ == '__main__': @clock() def snooze(seconds): time.sleep(seconds) for i in range(3): snooze(.123)# =&gt; [0.12320948s] snooze(0.123) -&gt; None# =&gt; [0.12319684s] snooze(0.123) -&gt; None# =&gt; [0.12318802s] snooze(0.123) -&gt; None 1234567891011121314# clock_param2.pyimport timefrom clock_param import clock@clock('&#123;name&#125;(&#123;args&#125;) dt=&#123;elapsed:0.3f&#125;s')def snooze(seconds): time.sleep(seconds)for i in range(3): snooze(.123)# =&gt; snooze(0.123) dt=0.123s# =&gt; snooze(0.123) dt=0.123s# =&gt; snooze(0.123) dt=0.123s æ ‡å‡†åº“ä¸­çš„è£…é¥°å™¨â€”â€”å•åˆ†æ´¾æ³›å‡½æ•°å‡è®¾éœ€è¦å¼€å‘ä¸€ä¸ªè°ƒè¯• Web åº”ç”¨çš„å·¥å…·ï¼Œèƒ½å¤Ÿç”Ÿæˆ HTML æ¥æ˜¾ç¤ºä¸åŒç±»åž‹çš„ Python å¯¹è±¡ã€‚12345import htmldef htmlize(obj): content = html.escape(repr(obj)) return '&lt;pre&gt;&#123;&#125;&lt;/pre&gt;'.format(content) ä¸Šè¿°å‡½æ•°é€‚ç”¨äºŽä»»ä½• Python ç±»åž‹ã€‚ä½†å¦‚æžœæƒ³åšè¿›ä¸€æ­¥æ‰©å±•ï¼Œä½¿å…¶èƒ½å¤Ÿç”¨ä¸åŒçš„æ–¹å¼æ˜¾ç¤ºä¸åŒçš„ç±»åž‹ï¼š strï¼šæŠŠå†…éƒ¨æ¢è¡Œç¬¦æ›¿æ¢ä¸º â€˜\\nâ€™ï¼Œä½¿ç”¨ è¿›è¡Œæ ¼å¼åŒ– intï¼šä»¥åè¿›åˆ¶å’Œåå…­è¿›åˆ¶æ˜¾ç¤ºæ•°å­— listï¼šè¾“å‡º HTML åˆ—è¡¨ï¼Œæ ¹æ®å„ä¸ªå…ƒç´ çš„ç±»åž‹è¿›è¡Œæ ¼å¼åŒ– Python ä¸æ”¯æŒé‡è½½æ–¹æ³•æˆ–å‡½æ•°ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨ä¸åŒçš„ç­¾åå®šä¹‰ htmlize çš„å˜ä½“ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ä¸åŒçš„æ–¹å¼å¤„ç†ä¸åŒçš„æ•°æ®ç±»åž‹ã€‚ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯å°† htmlize å˜æˆä¸€ä¸ªåˆ†æ´¾å‡½æ•°ï¼Œä½¿ç”¨ä¸€ç³»åˆ— if/elif/elif è°ƒç”¨ä¸“é—¨çš„å‡½æ•°ï¼Œå¦‚ htmlize_strã€htmlize_int ç­‰ã€‚ä½†è¿™æ ·ä¸ä¾¿äºŽæ¨¡å—çš„æ‰©å±•ï¼Œä¸”æ˜¾å¾—ç¬¨æ‹™ã€‚åˆ†æ´¾å‡½æ•° htmlize ä¼šéšç€æ—¶é—´æŽ¨ç§»å˜å¾—å¾ˆå¤§ï¼Œä¸Žå„ä¸ªä¸“é—¨å‡½æ•°ä¹‹é—´çš„è€¦åˆä¹Ÿå¾ˆç´§å¯†ã€‚ Python ä¸­çš„ functools.singledispatch è£…é¥°å™¨å¯ä»¥æŠŠæ•´ä½“æ–¹æ¡ˆæ‹†åˆ†ä¸ºç­‰å¤šä¸ªæ¨¡å—ï¼Œç”šè‡³å¯ä»¥ä¸ºæ— æ³•ä¿®æ”¹çš„ç±»æä¾›ä¸“é—¨å‡½æ•°ã€‚ä½¿ç”¨ @singledispatch è£…é¥°çš„æ™®é€šå‡½æ•°ä¼šå˜æˆæ³›å‡½æ•°ï¼ˆgeneric functionï¼‰ï¼Œæ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»åž‹ä»¥ä¸åŒæ–¹å¼æ‰§è¡Œç›¸åŒæ“ä½œçš„ä¸€ç»„å‡½æ•°ã€‚ 12345678910111213141516171819202122232425# htmlize.pyfrom functools import singledispatchfrom collections import abcimport numbersimport html@singledispatchdef htmlize(obj): content = html.escape(repr(obj)) return '&lt;pre&gt;&#123;&#125;&lt;/pre&gt;'.format(content)@htmlize.register(str)def _(text): content = html.escape(text).replace('\n', '&lt;br&gt;\n') return '&lt;p&gt;&#123;0&#125;&lt;/p&gt;'.format(content)@htmlize.register(numbers.Integral)def _(n): return '&lt;pre&gt;&#123;0&#125; (0x&#123;0:x&#125;)&lt;/pre&gt;'.format(n)@htmlize.register(tuple)@htmlize.register(abc.MutableSequence)def _(seq): inner = '&lt;/li&gt;\n&lt;li&gt;'.join(htmlize(item) for item in seq) return '&lt;ul&gt;\n&lt;li&gt;' + inner + '&lt;/li&gt;\n&lt;/ul&gt;' 123456789101112131415&gt;&gt;&gt; from htmlize import htmlize&gt;&gt;&gt; htmlize(&#123;1, 2, 3&#125;)'&lt;pre&gt;&#123;1, 2, 3&#125;&lt;/pre&gt;'&gt;&gt;&gt; htmlize(abs)'&lt;pre&gt;&amp;lt;built-in function abs&amp;gt;&lt;/pre&gt;'&gt;&gt;&gt; htmlize('Heimlich &amp; Co.\n- a game')'&lt;p&gt;Heimlich &amp;amp; Co.&lt;br&gt;\n- a game&lt;/p&gt;'&gt;&gt;&gt; htmlize(42)'&lt;pre&gt;42 (0x2a)&lt;/pre&gt;'&gt;&gt;&gt; print(htmlize(['alpha', 66, &#123;3, 2, 1&#125;]))&lt;ul&gt;&lt;li&gt;&lt;p&gt;alpha&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;pre&gt;66 (0x42)&lt;/pre&gt;&lt;/li&gt;&lt;li&gt;&lt;pre&gt;&#123;1, 2, 3&#125;&lt;/pre&gt;&lt;/li&gt;&lt;/ul&gt; @singledispatch æ ‡è®°å¤„ç† object ç±»åž‹çš„åŸºå‡½æ•°ã€‚å„ä¸ªä¸“é—¨å‡½æ•°ä½¿ç”¨ @&lt;base_function&gt;.register(&lt;type&gt;) è£…é¥°ã€‚ä¸ºæ¯ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»åž‹æ³¨å†Œä¸€ä¸ªå‡½æ•°ï¼Œnumbers.Integral æ˜¯ int çš„æŠ½è±¡åŸºç±»ã€‚åªè¦å¯èƒ½ï¼Œæ³¨å†Œçš„ä¸“é—¨å‡½æ•°åº”è¯¥å°½é‡å¤„ç†æŠ½è±¡åŸºç±»ï¼ˆå¦‚ numbers.Integral å’Œ abc.MutableSequenceï¼‰ï¼Œä¸è¦å¤„ç†å…·ä½“å®žçŽ°ï¼ˆå¦‚ int å’Œ listï¼‰ã€‚è¿™æ ·ä»£ç æ”¯æŒçš„å…¼å®¹ç±»åž‹ä¼šæ›´å¹¿æ³›ï¼ˆæ”¯æŒæŠ½è±¡åŸºç±»çŽ°æœ‰çš„å’Œæœªæ¥çš„å…·ä½“å­ç±»ï¼‰ï¼Œæ¯”å¦‚ç”¨æˆ·å¯èƒ½é€šè¿‡å­ç±»åŒ– numbers.Integral å®žçŽ°å›ºå®šä½æ•°çš„ int ç±»åž‹ã€‚å¯ä»¥å æ”¾å¤šä¸ª register è£…é¥°å™¨ï¼Œè®©åŒä¸€ä¸ªå‡½æ•°æ”¯æŒä¸åŒç±»åž‹ã€‚ @singledispatch å¯ä»¥åœ¨ç³»ç»Ÿçš„ä»»ä½•åœ°æ–¹å’Œä»»ä½•æ¨¡å—ä¸­æ³¨å†Œä¸“é—¨å‡½æ•°ï¼Œè¿˜å¯ä»¥ä¸ºä¸æ˜¯è‡ªå·±ç¼–å†™çš„æˆ–è€…ä¸èƒ½ä¿®æ”¹çš„ç±»æ·»åŠ è‡ªå®šä¹‰å‡½æ•°ã€‚ å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Function</tag>
        <tag>Closure</tag>
        <tag>Decorator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Cookbook â€”â€” å…ƒç¼–ç¨‹]]></title>
    <url>%2F2020%2F11%2F19%2Fpython-cookbook-metaprogramming%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å‡½æ•°è£…é¥°å™¨1234567891011121314151617181920212223242526import timefrom functools import wrapsdef timethis(func): ''' Decorator that reports the execution time. ''' @wraps(func) def wrapper(*args, **kwargs): start = time.time() result = func(*args, **kwargs) elapsed = time.time() - start print(func.__name__, elapsed) return result return wrapper@timethisdef countdown(n): while n &gt; 0: n -= 1countdown(1000000)# =&gt; countdown 0.29901695251464844 è£…é¥°å™¨è´Ÿè´£æŽ¥æ”¶æŸä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ä½œä¸ºè¾“å‡ºã€‚ä¸‹é¢çš„ä»£ç ï¼š123@timethisdef countdown(n): ... å®žé™…ä¸Šç­‰åŒäºŽ123def countdown(n): ...countdown = timethis(countdown) è£…é¥°å™¨å†…éƒ¨é€šå¸¸è¦å®šä¹‰ä¸€ä¸ªæŽ¥æ”¶ä»»æ„å‚æ•°ï¼ˆ*args, **kwargsï¼‰çš„å‡½æ•°ï¼Œå³ wrapper()ã€‚åœ¨ wrapper å‡½æ•°é‡Œï¼Œè°ƒç”¨åŽŸå§‹çš„ä½œä¸ºå‚æ•°ä¼ å…¥çš„å‡½æ•°ï¼ˆfuncï¼‰å¹¶èŽ·å–å…¶ç»“æžœï¼Œå†æ ¹æ®éœ€æ±‚æ·»åŠ ä¸Šæ‰§è¡Œå…¶ä»–æ“ä½œçš„ä»£ç ï¼ˆæ¯”å¦‚è®¡æ—¶ã€æ—¥å¿—ç­‰ï¼‰ã€‚æœ€åŽæ–°åˆ›å»ºçš„ wrapper å‡½æ•°è¢«è¿”å›žå¹¶æ›¿æ¢æŽ‰è¢«è£…é¥°çš„å‡½æ•°ï¼ˆcountdownï¼‰ï¼Œä»Žè€Œåœ¨ä¸æ”¹å˜è¢«è£…é¥°å‡½æ•°è‡ªèº«ä»£ç çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¶æ·»åŠ é¢å¤–çš„è¡Œä¸ºã€‚ äºŒã€å¸¦å‚æ•°çš„è£…é¥°å™¨12345678910111213141516171819202122232425262728293031323334353637383940from functools import wrapsimport loggingdef logged(level, name=None, message=None): &apos;&apos;&apos; Add logging to a function. level is the logging level, name is the logger name, and message is the log message. &apos;&apos;&apos; logging.basicConfig( level=logging.DEBUG, format=&apos;%(asctime)s - %(name)s - %(levelname)s - %(message)s&apos;) def decorate(func): logname = name if name else func.__module__ log = logging.getLogger(logname) logmsg = message if message else func.__name__ @wraps(func) def wrapper(*args, **kwargs): log.log(level, logmsg) return func(*args, **kwargs) return wrapper return decorate# Example use@logged(logging.WARNING)def spam(): pass@logged(logging.INFO, name=&apos;Example&apos;, message=&apos;This is log message&apos;)def foo(): passspam()foo()# =&gt; 2019-10-24 09:22:25,780 - __main__ - WARNING - spam# =&gt; 2019-10-24 09:22:25,783 - Example - INFO - This is log message æœ€å¤–å±‚çš„å‡½æ•° logged() ç”¨äºŽæŽ¥æ”¶ä¼ å…¥è£…é¥°å™¨çš„å‚æ•°ï¼Œå¹¶ä½¿è¿™äº›å‚æ•°èƒ½å¤Ÿè¢«è£…é¥°å™¨ä¸­çš„å†…éƒ¨å‡½æ•°ï¼ˆdecorate()ï¼‰è®¿é—®ã€‚å†…éƒ¨å‡½æ•° decorate åˆ™ç”¨äºŽå®žçŽ°è£…é¥°å™¨çš„â€œæ ¸å¿ƒé€»è¾‘â€ï¼Œå³æŽ¥æ”¶æŸä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°çš„å†…éƒ¨å‡½æ•°ï¼ˆwrapperï¼‰æ·»åŠ æŸäº›è¡Œä¸ºï¼Œå†å°†è¿™ä¸ªæ–°çš„å‡½æ•°è¿”å›žä½œä¸ºè¢«è£…é¥°å‡½æ•°çš„æ›¿ä»£å“ã€‚ åœ¨ç±»ä¸­å®šä¹‰çš„è£…é¥°å™¨1234567891011121314151617181920212223242526272829303132333435363738from functools import wrapsclass A: # Decorator as an instance method def decorator1(self, func): @wraps(func) def wrapper(*args, **kwargs): print('Decorator 1') return func(*args, **kwargs) return wrapper #Decorator as a class method @classmethod def decorator2(cls, func): @wraps(func) def wrapper(*args, **kwargs): print('Decorator 2') return func(*args, **kwargs) return wrapper# As an instance methoda = A()@a.decorator1def spam(): passspam()# =&gt; Decorator 1# As a class method@A.decorator2def grok(): passgrok()# =&gt; Decorator 2 åˆ©ç”¨è£…é¥°å™¨å‘åŽŸå‡½æ•°ä¸­æ·»åŠ å‚æ•°123456789101112131415161718192021222324from functools import wrapsimport inspectdef optional_debug(func): if 'debug' in inspect.getfullargspec(func).args: raise TypeError('debug argument already defined') @wraps(func) def wrapper(*args, debug=False, **kwargs): if debug: print('Calling', func.__name__) return func(*args, **kwargs) return wrapper@optional_debugdef add(x, y): print(x + y)add(2, 3)# =&gt; 5add(2, 3, debug=True)# =&gt; Calling add# =&gt; 5 è£…é¥°å™¨ä¿®æ”¹ç±»çš„å®šä¹‰1234567891011121314151617181920212223242526def log_getattribute(cls): orig_getattribute = cls.__getattribute__ def new_getattribute(self, name): print('getting: ', name) return orig_getattribute(self, name) cls.__getattribute__ = new_getattribute return cls@log_getattributeclass A: def __init__(self, x): self.x = x def spam(self): passa = A(42)print(a.x)a.spam()# =&gt; getting: x# =&gt; 42# =&gt; getting: spam ç±»è£…é¥°å™¨å¯ä»¥ç”¨æ¥é‡å†™ç±»çš„éƒ¨åˆ†å®šä¹‰ä»¥ä¿®æ”¹å…¶è¡Œä¸ºï¼Œä½œä¸ºä¸€ç§ç›´è§‚çš„ç±»ç»§æ‰¿æˆ–å…ƒç±»çš„æ›¿ä»£æ–¹å¼ã€‚æ¯”å¦‚ä¸Šè¿°åŠŸèƒ½ä¹Ÿå¯ä»¥é€šè¿‡ç±»ç»§æ‰¿æ¥å®žçŽ°ï¼š1234567891011121314151617class LoggedGetattribute: def __getattribute__(self, name): print('getting: ', name) return super().__getattribute__(name)class A(LoggedGetattribute): def __init__(self, x): self.x = x def spam(self): passa = A(42)print(a.x)a.spam() åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç±»è£…é¥°å™¨çš„æ–¹æ¡ˆè¦æ›´ä¸ºç›´è§‚ä¸€äº›ï¼Œå¹¶ä¸ä¼šå‘ç»§æ‰¿å±‚çº§ä¸­å¼•å…¥æ–°çš„ä¾èµ–ã€‚åŒæ—¶ç”±äºŽä¸ä½¿ç”¨ super() å‡½æ•°ï¼Œé€Ÿåº¦ä¹Ÿç¨å¿«ä¸€ç‚¹ã€‚ ä½¿ç”¨å…ƒç±»æŽ§åˆ¶å®žä¾‹çš„åˆ›å»ºPython ä¸­çš„ç±»å¯ä»¥åƒå‡½æ•°é‚£æ ·è°ƒç”¨ï¼ŒåŒæ—¶åˆ›å»ºå®žä¾‹å¯¹è±¡ï¼š1234567class Spam: def __init__(self, name): self.name = namea = Spam('Guido')b = Spam('Diana') å¦‚æžœå¼€å‘äººå‘˜æƒ³è¦è‡ªå®šä¹‰åˆ›å»ºå®žä¾‹çš„è¡Œä¸ºï¼Œå¯ä»¥é€šè¿‡å…ƒç±»é‡æ–°å®žçŽ°ä¸€é __call__() æ–¹æ³•ã€‚å‡è®¾åœ¨è°ƒç”¨ç±»æ—¶ä¸åˆ›å»ºä»»ä½•å®žä¾‹ï¼š1234567891011121314 class NoInstance(type): def __call__(self, *args, **kwargs): raise TypeError("Can't instantiate directly")class Spam(metaclass=NoInstance): @staticmethod def grok(x): print('Spam.grok')Spam.grok(42) # Spam.groks = Spam()# TypeError: Can't instantiate directly å…ƒç±»å®žçŽ°å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼å³ç±»åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå•ä¸€çš„ç±»ç¡®ä¿åªç”Ÿæˆå”¯ä¸€çš„å®žä¾‹å¯¹è±¡ã€‚1234567891011121314151617# singleton.pyclass Singleton(type): def __init__(self, *args, **kwargs): self.__instance = None super().__init__(*args, **kwargs) def __call__(self, *args, **kwargs): if self.__instance is None: self.__instance = super().__call__(*args, **kwargs) return self.__instance else: return self.__instanceclass Spam(metaclass=Singleton): def __init__(self): print('Creating Spam') 123456789&gt;&gt;&gt; from singleton import *&gt;&gt;&gt; a = Spam()Creating Spam&gt;&gt;&gt; b = Spam()&gt;&gt;&gt; a is bTrue&gt;&gt;&gt; c = Spam()&gt;&gt;&gt; a is cTrue å¼ºåˆ¶æ£€æŸ¥ç±»å®šä¹‰ä¸­çš„ä»£ç è§„èŒƒå¯ä»¥å€ŸåŠ©å…ƒç±»ç›‘æŽ§æ™®é€šç±»çš„å®šä¹‰ä»£ç ã€‚é€šå¸¸çš„æ–¹å¼æ˜¯å®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ª type çš„å…ƒç±»å¹¶é‡å†™å…¶ __new__() æˆ– __init__() æ–¹æ³•ã€‚123456class MyMeta(type): def __new__(cls, clsname, bases, clsdict): # clsname is name of class being defined # bases is tuple of base classes # clsdict is class dictionary return super().__new__(cls, clsname, bases, clsdict) 123456class MyMeta(type): def __init__(self, clsname, bases, clsdict): # clsname is name of class being defined # bases is tuple of base classes # clsdict is class dictionary return super().__init__(clsname, bases, clsdict) ä¸ºäº†ä½¿ç”¨å…ƒç±»ï¼Œé€šå¸¸ä¼šå…ˆå®šä¹‰ä¸€ä¸ªä¾›å…¶ä»–å¯¹è±¡ç»§æ‰¿çš„åŸºç±»ï¼š12345678class Root(metaclass=MyMeta): passclass A(Root): passclass B(Root): pass å…ƒç±»çš„é‡è¦ç‰¹æ€§åœ¨äºŽï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨ç±»å®šä¹‰æ—¶æ£€æŸ¥ç±»çš„å†…å®¹ã€‚åœ¨é‡å†™çš„ __init__() æ–¹æ³•å†…éƒ¨ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ£€æŸ¥ class dictionaryã€base class æˆ–è€…å…¶ä»–ä¸Žç±»å®šä¹‰ç›¸å…³çš„å†…å®¹ã€‚æ­¤å¤–ï¼Œå½“å…ƒç±»æŒ‡å®šç»™æŸä¸ªæ™®é€šç±»ä»¥åŽï¼Œè¯¥æ™®é€šç±»çš„æ‰€æœ‰å­ç±»ä¹Ÿéƒ½ä¼šç»§æ‰¿å…ƒç±»çš„å®šä¹‰ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨äºŽæ£€æŸ¥ä»£ç è§„èŒƒçš„å…ƒç±»ï¼Œç¡®ä¿æ–¹æ³•çš„å‘½åé‡ŒåªåŒ…å«å°å†™å­—æ¯ï¼š123456789101112131415161718192021class NoMixedCaseMeta(type): def __new__(cls, clsname, bases, clsdict): for name in clsdict: if name.lower() != name: raise TypeError('Bad attribute name: ' + name) return super().__new__(cls, clsname, bases, clsdict)class Root(metaclass=NoMixedCaseMeta): passclass A(Root): def foo_bar(self): passclass B(Root): def fooBar(self): pass# TypeError: Bad attribute name: fooBar å…ƒç±»çš„å®šä¹‰ä¸­é‡å†™ __new__() è¿˜æ˜¯ __init__() æ–¹æ³•å–å†³äºŽä½ æƒ³ä»¥ä½•ç§æ–¹å¼äº§å‡ºç±»ã€‚__new__() æ–¹æ³•ç”Ÿæ•ˆäºŽç±»åˆ›å»ºä¹‹å‰ï¼Œé€šå¸¸ç”¨äºŽå¯¹ç±»çš„å®šä¹‰è¿›è¡Œæ”¹åŠ¨ï¼ˆé€šè¿‡ä¿®æ”¹ class dictionary çš„å†…å®¹ï¼‰ï¼›__init__() æ–¹æ³•ç”Ÿæ•ˆäºŽç±»åˆ›å»ºä¹‹åŽï¼Œé€šå¸¸æ˜¯ä¸Žå·²ç»ç”Ÿæˆçš„ç±»å¯¹è±¡è¿›è¡Œäº¤äº’ã€‚æ¯”å¦‚ super() å‡½æ•°åªåœ¨ç±»å®žä¾‹è¢«åˆ›å»ºåŽæ‰èƒ½èµ·ä½œç”¨ã€‚ ä»¥ç¼–ç¨‹çš„æ–¹å¼å®šä¹‰ç±»å¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼åˆ›å»ºç±»ï¼Œæ¯”å¦‚ä»Žå­—ç¬¦ä¸²ä¸­äº§å‡ºç±»çš„æºä»£ç ã€‚types.new_class() å‡½æ•°å¯ä»¥ç”¨æ¥åˆå§‹åŒ–æ–°çš„ç±»å¯¹è±¡ï¼Œåªéœ€è¦å‘å…¶æä¾›ç±»åã€çˆ¶ç±»ï¼ˆä»¥å…ƒç»„çš„å½¢å¼ï¼‰ã€å…³é”®å­—å‚æ•°å’Œä¸€ä¸ªç”¨æ¥æ›´æ–° class dictionary çš„å›žè°ƒå‡½æ•°ã€‚1234567891011121314151617181920212223242526# Methodsdef __init__(self, name, shares, price): self.name = name self.shares = shares self.price = pricedef cost(self): return self.shares * self.pricecls_dict = &#123; '__init__': __init__, 'cost': cost,&#125;# Make a classimport typesStock = types.new_class('Stock', (), &#123;&#125;, lambda ns: ns.update(cls_dict))Stock.__module__ = __name__s = Stock('ACME', 50, 91.1)print(s)# =&gt; &lt;__main__.Stock object at 0x7f0e3b62edc0&gt;print(s.cost())# =&gt; 4555.0 é€šå¸¸å½¢å¼çš„ç±»å®šä¹‰ä»£ç ï¼š12class Spam(Base, debug=True, typecheck=False): ... è½¬æ¢æˆå¯¹åº”çš„ type.new_class() å½¢å¼çš„ä»£ç ï¼š123Spam = types.new_class('Spam', (Base,), &#123;'debug': True, 'typecheck': False&#125;, lambda ns: ns.update(cls_dict)) ä»Žä»£ç ä¸­äº§å‡ºç±»å¯¹è±¡åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæ¯”å¦‚ collections.nametupe() å‡½æ•°ï¼š1234&gt;&gt;&gt; import collections&gt;&gt;&gt; Stock = collections.namedtuple('Stock', ['name', 'shares', 'price'])&gt;&gt;&gt; Stock&lt;class '__main__.Stock'&gt; ä¸‹é¢æ˜¯ä¸€ä¸ªç±»ä¼¼ namedtuple åŠŸèƒ½çš„å®žçŽ°ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435import operatorimport typesimport sysdef named_tuple(classname, fieldnames): # Populate a dictionary of field property accessors cls_dict = &#123; name: property(operator.itemgetter(n)) for n, name in enumerate(fieldnames) &#125; # Make a __new__ function and add to the class dict def __new__(cls, *args): if len(args) != len(fieldnames): raise TypeError('Expected &#123;&#125; arguments'.format(len(fieldnames))) return tuple.__new__(cls, args) cls_dict['__new__'] = __new__ # Make the class cls = types.new_class(classname, (tuple,), &#123;&#125;, lambda ns: ns.update(cls_dict)) cls.__module__ = sys._getframe(1).f_globals['__name__'] return clsPoint = named_tuple('Point', ['x', 'y'])print(Point)# =&gt; &lt;class '__main__.Point'&gt;p = Point(4, 5)print(p.x)# =&gt; 4print(p.y)# =&gt; 5p.x = 2# =&gt; AttributeError: can't set attribute åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ç±»æˆå‘˜åœ¨ç±»å®šä¹‰æ—¶å®Œæˆåˆå§‹åŒ–æˆ–å…¶ä»–è®¾ç½®åŠ¨ä½œï¼Œæ˜¯å…ƒç±»çš„ç»å…¸ç”¨æ³•ï¼ˆå…ƒç±»åœ¨ç±»å®šä¹‰æ—¶è§¦å‘ï¼‰ã€‚12345678910111213141516171819202122232425262728293031323334import operatorclass StructTupleMeta(type): def __init__(cls, *args, **kwargs): super().__init__(*args, **kwargs) for n, name in enumerate(cls._fields): setattr(cls, name, property(operator.itemgetter(n)))class StructTuple(tuple, metaclass=StructTupleMeta): _fields = [] def __new__(cls, *args): if len(args) != len(cls._fields): raise ValueError('&#123;&#125; arguments required'.format(len(cls._fields))) return super().__new__(cls, args)class Stock(StructTuple): _fields = ['name', 'shares', 'price']class Point(StructTuple): _fields = ['x', 'y']s = Stock('ACME', 50, 91.1)print(s)# =&gt; ('ACME', 50, 91.1)print(s[0])# =&gt; ACMEprint(s.name)# =&gt; ACMEs.shares = 23# =&gt; AttributeError: can't set attribute åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒStructTupleMeta å…ƒç±»ä»Ž _fields ç±»å±žæ€§ä¸­è¯»å–å±žæ€§ååˆ—è¡¨å¹¶å°†å…¶è½¬æ¢æˆå±žæ€§æ–¹æ³•ã€‚operator.itemgetter() å‡½æ•°è´Ÿè´£åˆ›å»ºè®¿é—®æ–¹æ³•ï¼ˆaccessor functionï¼‰ï¼Œproperty() å‡½æ•°è´Ÿè´£å°†å®ƒä»¬è½¬æ¢æˆå±žæ€§ï¼ˆpropertyï¼‰ã€‚ StructTuple ç±»ç”¨ä½œä¾›å…¶ä»–ç±»ç»§æ‰¿çš„åŸºç±»ã€‚å…¶ä¸­çš„ __new__() æ–¹æ³•è´Ÿè´£åˆ›å»ºæ–°çš„å®žä¾‹å¯¹è±¡ã€‚ä¸åŒäºŽ __init__()ï¼Œ__new__() æ–¹æ³•ä¼šåœ¨å®žä¾‹åˆ›å»ºä¹‹å‰è§¦å‘ï¼Œç”±äºŽ tuple æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œåˆ›å»ºä¹‹åŽå³æ— æ³•è¢«ä¿®æ”¹ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨ __new__()ã€‚ å‚è€ƒèµ„æ–™Python Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
        <tag>MetaProgramming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®° â€”â€” ä½¿ç”¨ä¸€ç­‰å‡½æ•°å®žçŽ°è®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2020%2F11%2F08%2Ffluent-python-first-class-function-and-design-patterns%2F</url>
    <content type="text"><![CDATA[ç»å…¸çš„ç­–ç•¥æ¨¡å¼ â€œç­–ç•¥æ¨¡å¼â€ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸€å°è£…ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ä»¥ç‹¬ç«‹äºŽä½¿ç”¨å®ƒçš„å¯¹è±¡è€Œå˜åŒ– ç”µå•†é¢†åŸŸæœ‰ä¸ªæ˜Žæ˜¾çš„åŠŸèƒ½å¯ä»¥ä½¿ç”¨â€œç­–ç•¥â€æ¨¡å¼ï¼Œå³æ ¹æ®å®¢æˆ·çš„å±žæ€§æˆ–è®¢å•ä¸­çš„å•†å“è®¡ç®—æŠ˜æ‰£ã€‚å‡å¦‚æœ‰å¦‚ä¸‹æŠ˜æ‰£è§„åˆ™ï¼š æœ‰ 1000 æˆ–ä»¥ä¸Šç§¯åˆ†çš„é¡¾å®¢ï¼Œæ¯ä¸ªè®¢å•äº« 5% æŠ˜æ‰£ åŒä¸€è®¢å•ä¸­ï¼Œå•ä¸ªå•†å“æ•°é‡è¾¾åˆ° 20 ä¸ªæˆ–ä»¥ä¸Šï¼Œäº« 10% æŠ˜æ‰£ è®¢å•ä¸­çš„ä¸åŒå•†å“è¾¾åˆ° 10 ä¸ªæˆ–ä»¥ä¸Šï¼Œäº« 7% æŠ˜æ‰£ å¦‚ä¸Šè¿° UML å›¾ï¼Œä¸Šä¸‹æ–‡æä¾›æœåŠ¡ï¼Œä¼šæŠŠä¸€äº›è®¡ç®—å§”æ‰˜ç»™å®žçŽ°ä¸åŒç®—æ³•çš„å¯äº’æ¢ç»„ä»¶ã€‚æœ¬ä¾‹ä¸­æ˜¯è®¢å• Orderï¼Œä¼šæ ¹æ®ä¸åŒç®—æ³•è®¡ç®—ä¿ƒé”€æŠ˜æ‰£ï¼›ç­–ç•¥æŒ‡å®žçŽ°ä¸åŒç®—æ³•çš„ç»„ä»¶å…±ç”¨çš„æŽ¥å£ã€‚æœ¬ä¾‹ä¸­æ˜¯åä¸º Promotion çš„æŠ½è±¡ç±»ï¼›å…·ä½“ç­–ç•¥å³â€œç­–ç•¥â€çš„å…·ä½“å­ç±»ï¼ŒFidelityPromoã€BulkPromo å’Œ LargeOrderPromo æ˜¯è¿™é‡Œå®žçŽ°çš„ä¸‰ä¸ªå…·ä½“ç­–ç•¥ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768from abc import ABC, abstractmethodfrom collections import namedtupleCustomer = namedtuple('Customer', 'name fidelity')class LineItem: def __init__(self, product, quantity, price): self.product = product self.quantity = quantity self.price = price def total(self): return self.price * self.quantityclass Order: # ä¸Šä¸‹æ–‡ def __init__(self, customer, cart, promotion=None): self.customer = customer self.cart = list(cart) self.promotion = promotion def total(self): if not hasattr(self, '__total'): self.__total = sum(item.total() for item in self.cart) return self.__total def due(self): if self.promotion is None: discount = 0 else: discount = self.promotion.discount(self) return self.total() - discount def __repr__(self): fmt = '&lt;Order total: &#123;:.2f&#125; due: &#123;:.2f&#125;&gt;' return fmt.format(self.total(), self.due())class Promotion(ABC): # ç­–ç•¥ï¼šæŠ½è±¡åŸºç±» @abstractmethod def discount(self, order): """è¿”å›žæŠ˜æ‰£é‡‘é¢"""class FidelityPromo(Promotion): """ä¸ºç§¯åˆ†ä¸º1000æˆ–ä»¥ä¸Šçš„é¡¾å®¢æä¾›5%æŠ˜æ‰£""" def discount(self, order): return order.total() * .05 if order.customer.fidelity &gt;= 1000 else 0class BulkItemPromo(Promotion): """å•ä¸ªå•†å“ä¸º20ä¸ªæˆ–ä»¥ä¸Šæ—¶æä¾›10%æŠ˜æ‰£""" def discount(self, order): discount = 0 for item in order.cart: if item.quantity &gt;= 20: discount += item.total() * .1 return discountclass LargeOrderPromo(Promotion): """è®¢å•ä¸­çš„ä¸åŒå•†å“è¾¾åˆ°10ä¸ªæˆ–ä»¥ä¸Šæ—¶æä¾›7%æŠ˜æ‰£""" def discount(self, order): distinct_items = &#123;item.product for item in order.cart&#125; if len(distinct_items) &gt;= 10: return order.total() * .07 return 0 æ‰§è¡Œæ•ˆæžœï¼š1234567891011121314&gt;&gt;&gt; from order import *&gt;&gt;&gt; joe = Customer('John Doe', 0)&gt;&gt;&gt; ann = Customer('Ann Smith', 1100)&gt;&gt;&gt; cart = [LineItem('banana', 4, .5), LineItem('apple', 10, 1.5), LineItem('watermellon', 5, 5.0)]&gt;&gt;&gt; Order(joe, cart, FidelityPromo())&lt;Order total: 42.00 due: 42.00&gt;&gt;&gt;&gt; Order(ann, cart, FidelityPromo())&lt;Order total: 42.00 due: 39.90&gt;&gt;&gt;&gt; banana_cart = [LineItem('banana', 30, .5), LineItem('apple', 10, 1.5)]&gt;&gt;&gt; Order(joe, banana_cart, BulkItemPromo())&lt;Order total: 30.00 due: 28.50&gt;&gt;&gt;&gt; long_order = [LineItem(str(item_code), 1, 1.0) for item_code in range(10)]&gt;&gt;&gt; Order(joe, long_order, LargeOrderPromo())&lt;Order total: 10.00 due: 9.30&gt; ä½¿ç”¨å‡½æ•°å®žçŽ°ç­–ç•¥æ¨¡å¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from collections import namedtupleCustomer = namedtuple('Customer', 'name fidelity')class LineItem: def __init__(self, product, quantity, price): self.product = product self.quantity = quantity self.price = price def total(self): return self.price * self.quantityclass Order: def __init__(self, customer, cart, promotion=None): self.customer = customer self.cart = list(cart) self.promotion = promotion def total(self): if not hasattr(self, '__total'): self.__total = sum(item.total() for item in self.cart) return self.__total def due(self): if self.promotion is None: discount = 0 else: discount = self.promotion(self) return self.total() - discount def __repr__(self): fmt = '&lt;Order total: &#123;:.2f&#125; due: &#123;:.2f&#125;&gt;' return fmt.format(self.total(), self.due())def fidelity_promo(order): return order.total() * .05 if order.customer.fidelity &gt;= 1000 else 0def bulk_item_promo(order): discount = 0 for item in order.cart: if item.quantity &gt;= 20: discount += item.total() * .1 return discountdef large_order_promo(order): distince_items = &#123;item.product for item in order.cart&#125; if len(distince_items) &gt;= 10: return order.total() * .07 return 0 è®¡ç®—æŠ˜æ‰£åªéœ€è°ƒç”¨ self.promotion() å‡½æ•°ï¼Œæ— éœ€æ¶‰åŠåˆ°æŠ½è±¡ç±»ã€‚å„ä¸ªç­–ç•¥éƒ½æ˜¯ç”±å‡½æ•°å®žçŽ°çš„ã€‚ä¸ºäº†æŠŠæŠ˜æ‰£ç­–ç•¥åº”ç”¨åˆ° Order å®žä¾‹ä¸Šï¼Œåªéœ€æŠŠä¿ƒé”€å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ æ‰§è¡Œæ•ˆæžœï¼š1234567891011121314&gt;&gt;&gt; from order_fun import *&gt;&gt;&gt; joe = Customer('John Doe', 0)&gt;&gt;&gt; ann = Customer('Ann Smith', 1100)&gt;&gt;&gt; cart = [LineItem('banana', 4, .5), LineItem('apple', 10, 1.5), LineItem('watermellon', 5, 5.0)]&gt;&gt;&gt; Order(joe, cart, fidelity_promo)&lt;Order total: 42.00 due: 42.00&gt;&gt;&gt;&gt; Order(ann, cart, fidelity_promo)&lt;Order total: 42.00 due: 39.90&gt;&gt;&gt;&gt; banana_cart = [LineItem('banana', 30, .5), LineItem('apple', 10, 1.5)]&gt;&gt;&gt; Order(joe, banana_cart, bulk_item_promo)&lt;Order total: 30.00 due: 28.50&gt;&gt;&gt;&gt; long_order = [LineItem(str(item_code), 1, 1.0) for item_code in range(10)]&gt;&gt;&gt; Order(joe, long_order, large_order_promo)&lt;Order total: 10.00 due: 9.30&gt; å…·ä½“ç­–ç•¥ä¸€èˆ¬æ²¡æœ‰å†…éƒ¨çŠ¶æ€ï¼Œåªæ˜¯å¤„ç†ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ã€‚å› æ­¤ä¸€å®šè¦ä½¿ç”¨æ™®é€šçš„å‡½æ•°ï¼Œè€Œæ— éœ€ç¼–å†™åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„ç±»ï¼Œå†åŽ»å®žçŽ°å¦ä¸€ä¸ªç±»å£°æ˜Žçš„å•å‡½æ•°æŽ¥å£ã€‚å‡½æ•°æ¯”ç”¨æˆ·è‡ªå®šä¹‰ç±»çš„å®žä¾‹æ›´ä¸ºè½»é‡ï¼Œå„ä¸ªç­–ç•¥å‡½æ•°åœ¨ Python ç¼–è¯‘æ¨¡å—æ—¶åªä¼šåˆ›å»ºä¸€æ¬¡ã€‚å³æ™®é€šçš„å‡½æ•°æ˜¯å¯å…±äº«çš„å¯¹è±¡ï¼Œå¯ä»¥åŒæ—¶åœ¨å¤šä¸ªä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚ é€‰æ‹©æœ€ä½³ç­–ç•¥åœ¨ä¸Šè¿°ä»£ç çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ  best_promo å‡½æ•°è®¡ç®—æ‰€æœ‰æŠ˜æ‰£ï¼Œå¹¶è¿”å›žé¢åº¦æœ€å¤§çš„ã€‚1234promos = [fidelity_promo, bulk_item_promo, large_order_promo]def best_promo(order): return max(promo(order) for promo in promos) ä¸Žå…¶ä»–å‡ ä¸ª *_promo å‡½æ•°ä¸€æ ·ï¼Œbest_promo å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª Order å®žä¾‹ã€‚ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æŠŠ order ä¼ ç»™ promos åˆ—è¡¨ä¸­çš„å„ä¸ªå‡½æ•°ï¼Œè¿”å›žæŠ˜æ‰£é¢åº¦æœ€å¤§çš„ä¿ƒé”€ç­–ç•¥ã€‚è™½ç„¶ä¸Šè¿°ä»£ç å¯ç”¨ä¸”æ˜“äºŽé˜…è¯»ï¼Œä½†è‹¥æƒ³æ·»åŠ æ–°çš„ä¿ƒé”€ç­–ç•¥ï¼Œé™¤äº†å®šä¹‰æ–°çš„æŠ˜æ‰£å‡½æ•°ä»¥å¤–ï¼Œè¿˜åº”æ³¨æ„è®°å¾—æŠŠæ–°å®šä¹‰çš„å‡½æ•°æ·»åŠ åˆ° promos åˆ—è¡¨ä¸­ã€‚ å¯ä»¥ä½¿ç”¨å†…ç½®çš„ globals() å‡½æ•°æ‰¾å‡ºæ¨¡å—ä¸­çš„å…¨éƒ¨ç­–ç•¥ã€‚globals() å‡½æ•°ä¼šè¿”å›žä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«é’ˆå¯¹å½“å‰æ¨¡å—çš„å…¨å±€ç¬¦å·è¡¨ï¼ˆå¯¹å‡½æ•°æˆ–æ–¹æ³•æ¥è¯´ï¼Œâ€œå½“å‰æ¨¡å—â€æŒ‡çš„æ˜¯å®šä¹‰å®ƒä»¬çš„æ¨¡å—ï¼Œè€Œä¸æ˜¯è°ƒç”¨å®ƒä»¬çš„æ¨¡å—ï¼‰ã€‚123456promos = [globals()[name] for name in globals() if name.endswith('_promo') and name != 'best_promo']def best_promo(order): return max(promo(order) for promo in promos) åŠ¨æ€æ”¶é›†ä¿ƒé”€æŠ˜æ‰£å‡½æ•°æ›´ä¸ºæ˜¾å¼çš„ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨ç®€å•çš„è£…é¥°å™¨ã€‚å‚è€ƒä¸‹ä¸€ç« èŠ‚ã€‚ ä½¿ç”¨è£…é¥°å™¨æ”¹è¿›ç­–ç•¥æ¨¡å¼ä½¿ç”¨æ³¨å†Œè£…é¥°å™¨å¯ä»¥æ”¹è¿›å‰é¢çš„ç”µå•†ä¿ƒé”€æŠ˜æ‰£ç¤ºä¾‹ã€‚ä¹‹å‰çš„ä¸»è¦é—®é¢˜æ˜¯ï¼Œå®šä¹‰ä½“ä¸­æœ‰å‡½æ•°åç§°ï¼Œä½† best_promo ç”¨æ¥åˆ¤æ–­å“ªä¸ªæŠ˜æ‰£å¹…åº¦æœ€å¤§çš„ promos åˆ—è¡¨ä¸­ä¹Ÿæœ‰å‡½æ•°åç§°ã€‚è¿™ç§é‡å¤å¯¼è‡´æ–°å¢žæŠ˜æ‰£å‡½æ•°åŽå¯èƒ½ä¼šå¿˜è®°æŠŠå®ƒæ·»åŠ åˆ° promos åˆ—è¡¨ä¸­ï¼Œå¯¼è‡´ best_promos å¿½ç•¥æ–°ç­–ç•¥ä¸”ä¸æŠ¥é”™ï¼Œä¸ºç³»ç»Ÿå¼•å…¥äº†ä¸æ˜“å¯Ÿè§‰çš„ç¼ºé™·ã€‚ 123456789101112131415161718192021222324252627promos = []def promotion(promo_func): promos.append(promo_func) return promo_func@promotiondef fidelity(order): return order.total() * .05 if order.customer.fidelity &gt;= 1000 else 0@promotiondef bulk_item(order): discount = 0 for item in order.cart: if item.quantity &gt;= 20: discount += item.total() * .1 return discount@promotiondef large_order(order): discount_items = &#123;item.product for item in order.cart&#125; if len(discount_items) &gt;= 10: return order.total() * .07 return 0def best_promo(order): return max(promo(order) for promo in promos) promos åˆ—è¡¨èµ·åˆæ˜¯ç©ºçš„ï¼Œpromotion æŠŠ promo_func æ·»åŠ åˆ° promos åˆ—è¡¨ä¸­ï¼Œç„¶åŽåŽŸå°ä¸åŠ¨åœ°å°†å…¶è¿”å›žã€‚å³è¢« @promotion è£…é¥°çš„å‡½æ•°éƒ½ä¼šæå‰æ·»åŠ åˆ° promos åˆ—è¡¨ä¸­ï¼ˆè£…é¥°å™¨åœ¨è¢«è£…é¥°çš„å‡½æ•°å®šä¹‰ä¹‹åŽï¼ˆé€šå¸¸æ˜¯åœ¨å¯¼å…¥æ—¶ï¼‰ç«‹å³è¿è¡Œï¼‰ã€‚ ç›¸æ¯”äºŽä¹‹å‰çš„æ–¹æ¡ˆï¼Œæ­¤æ–¹æ¡ˆæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š ä¿ƒé”€å‡½æ•°æ— éœ€ä½¿ç”¨ç‰¹æ®Šçš„åç§°ï¼ˆå³ä¸ç”¨ä»¥ _promo ç»“å°¾ï¼‰ @promotion è£…é¥°å™¨çªå‡ºäº†è¢«è£…é¥°çš„å‡½æ•°çš„ä½œç”¨ï¼Œè¿˜ä¾¿äºŽä¸´æ—¶ç¦ç”¨æŸä¸ªä¿ƒé”€ç­–ç•¥ï¼šåªéœ€æŠŠè£…é¥°å™¨æ³¨é‡ŠæŽ‰ ä¿ƒé”€æŠ˜æ‰£ç­–ç•¥å¯ä»¥åœ¨å…¶ä»–æ¨¡å—ä¸­å®šä¹‰ï¼Œåªè¦ä½¿ç”¨ @promotion è£…é¥°å³å¯ å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Functional</tag>
        <tag>DesignPattern</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®° â€”â€” å­—å…¸ä¸Žé›†åˆ]]></title>
    <url>%2F2020%2F11%2F08%2Ffluent-python-dicts-and-sets%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æ˜ å°„ç±»åž‹æ ‡å‡†åº“é‡Œçš„æ‰€æœ‰æ˜ å°„ç±»åž‹éƒ½æ˜¯åˆ©ç”¨ dict å®žçŽ°çš„ï¼Œå®ƒä»¬æœ‰ä¸ªå…±åŒçš„é™åˆ¶ï¼šå…¶ä¸­çš„é”®å¿…é¡»æ˜¯å¯æ•£åˆ—çš„æ•°æ®ç±»åž‹ã€‚å…³äºŽå¯æ•£åˆ—çš„æ•°æ®ç±»åž‹çš„å®šä¹‰ï¼šè‹¥æŸå¯¹è±¡æ˜¯å¯æ•£åˆ—çš„ï¼Œåˆ™å®ƒçš„æ•£åˆ—å€¼åœ¨å…¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­æ˜¯ä¿æŒä¸å˜çš„ã€‚è¯¥å¯¹è±¡éœ€è¦å®žçŽ° __hash__ æ–¹æ³•å’Œ __qe__ æ–¹æ³•ï¼ˆè·Ÿå…¶ä»–é”®åšæ¯”è¾ƒï¼‰ã€‚å¦‚æžœä¸¤ä¸ªå¯æ•£åˆ—å¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆä»–ä»¬çš„æ•£åˆ—å€¼ä¸€å®šç›¸ç­‰ã€‚ ä¸å¯å˜æ•°æ®ç±»åž‹ä¸­çš„ strã€bytes å’Œæ•°å­—éƒ½æ˜¯å¯æ•£åˆ—ç±»åž‹ã€‚è™½ç„¶å…ƒç»„æœ¬èº«æ˜¯ä¸å¯å˜åºåˆ—ï¼Œä½†å…ƒç»„ä¸­çš„å…ƒç´ æœ‰å¯èƒ½æ˜¯å…¶ä»–å¯å˜ç±»åž‹çš„å¼•ç”¨ã€‚åªæœ‰å½“ä¸€ä¸ªå…ƒç»„ä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯å¯æ•£åˆ—ç±»åž‹çš„æƒ…å†µä¸‹ï¼Œè¯¥å…ƒç»„æ‰æ˜¯å¯æ•£åˆ—çš„ã€‚12345678&gt;&gt;&gt; tt = (1, 2, (30, 40))&gt;&gt;&gt; hash(tt)-3907003130834322577&gt;&gt;&gt; tl = (1, 2, [30, 40])&gt;&gt;&gt; hash(tl)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: unhashable type: 'list' ä¸€èˆ¬ç”¨æˆ·è‡ªå®šä¹‰ç±»åž‹çš„å¯¹è±¡éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œå› æ­¤è¿™äº›å¯¹è±¡åœ¨æ¯”è¾ƒæ—¶éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚è‹¥æŸä¸ªå¯¹è±¡å®žçŽ°äº† __eq__ æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ–¹æ³•ä¸­ç”¨åˆ°äº†è¯¥å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œåˆ™åªæœ‰å½“è¿™äº›å†…éƒ¨çŠ¶æ€éƒ½æ˜¯ä¸å¯å˜ç±»åž‹çš„æƒ…å†µä¸‹ï¼Œè¯¥å¯¹è±¡æ‰æ˜¯å¯æ•£åˆ—çš„ã€‚ äºŒã€å­—å…¸æŽ¨å¯¼123456789101112&gt;&gt;&gt; DIAL_CODES = [... (86, 'China'),... (91, 'India'),... (1, 'America'),... (55, 'Brazil'),... (7, 'Russia')... ]&gt;&gt;&gt; country_code = &#123;country: code for code, country in DIAL_CODES&#125;&gt;&gt;&gt; country_code&#123;'China': 86, 'India': 91, 'America': 1, 'Brazil': 55, 'Russia': 7&#125;&gt;&gt;&gt; &#123;code: country.upper() for country, code in country_code.items() if code &lt; 66&#125;&#123;1: 'AMERICA', 55: 'BRAZIL', 7: 'RUSSIA'&#125; ä¸‰ã€setdefault å¤„ç†æ‰¾ä¸åˆ°çš„é”®ä»¥ä¸‹ä»£ç çš„å†™æ³•ï¼š1my_dict.setdefault(key, []).append(new_value) å…¶æ•ˆæžœç­‰åŒäºŽå¦‚ä¸‹ä»£ç ï¼š123if key not in my_dict: my_dict[key] = []my_dict[key].append(new_value) éƒ½æ˜¯èŽ·å– my_dict ä¸­ key é”®å¯¹åº”çš„å€¼ï¼ˆå¦‚æžœè¯¥ key ä¸å­˜åœ¨ï¼Œåˆ™æ–°å¢ž key å¹¶ä»¤å…¶å€¼ä¸º []ï¼‰ï¼Œç„¶åŽå‘ key å¯¹åº”çš„å€¼ï¼ˆåˆ—è¡¨ï¼‰ä¸­æ·»åŠ æ–°å…ƒç´ ã€‚åªä¸è¿‡åŽè€…è‡³å°‘è¦è¿›è¡Œä¸¤æ¬¡é”®æŸ¥è¯¢ï¼ˆå¦‚æžœé”®ä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œä¸‰æ¬¡é”®æŸ¥è¯¢ï¼‰ï¼Œè€Œä½¿ç”¨ setdefault åªéœ€è¦ä¸€æ¬¡é”®æŸ¥è¯¢å°±å¯ä»¥å®Œæˆæ•´ä¸ªæ“ä½œã€‚setdefault åœ¨èŽ·å– key é”®å¯¹åº”çš„å€¼æ—¶ï¼Œå¦‚æžœè¯¥ key ä¸å­˜åœ¨ï¼Œåˆ™æŠŠ key å’Œç©ºåˆ—è¡¨ç›´æŽ¥æ”¾è¿›æ˜ å°„å¹¶è¿”å›žç©ºåˆ—è¡¨ï¼Œå› è€Œä¸éœ€è¦æ‰§è¡Œç¬¬äºŒæ¬¡é”®å€¼æŸ¥æ‰¾ã€‚ å››ã€å¼¹æ€§é”®æŸ¥è¯¢defaultdictcollections.defaultdict å¯ä»¥åšåˆ°å³ä¾¿æŸä¸ªé”®åœ¨æ˜ å°„é‡Œä¸å­˜åœ¨ï¼Œä¹Ÿèƒ½å¤Ÿåœ¨è¯»å–è¿™ä¸ªé”®çš„æ—¶å€™å¾—åˆ°ä¸€ä¸ªé»˜è®¤å€¼ã€‚åªéœ€è¦ç”¨æˆ·åœ¨åˆå§‹åŒ– defaultdict å¯¹è±¡æ—¶ï¼Œä¸ºå…¶æŒ‡å®šä¸€ä¸ªåˆ›å»ºé»˜è®¤å€¼çš„æ–¹æ³•ã€‚å³åœ¨å®žä¾‹åŒ– defaultdict çš„æ—¶å€™ï¼Œå‘æž„é€ æ–¹æ³•æä¾›ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨ __getitem__ ç¢°åˆ°æ‰¾ä¸åˆ°çš„é”®çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œè®© __getitem__ è¿”å›žæŸç§é»˜è®¤å€¼ã€‚ å¦‚ dd = defaultdict(list)ã€‚è‹¥é”® new-key åœ¨ dd ä¸­ä¸å­˜åœ¨ï¼Œè¡¨è¾¾å¼ dd[&#39;new-key&#39;] ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š è°ƒç”¨ list() åˆ›å»ºä¸€ä¸ªæ–°åˆ—è¡¨ æŠŠæ–°åˆ—è¡¨ä½œä¸ºå€¼ï¼Œnew-key ä½œä¸ºé”®å­˜æ”¾åˆ° dd ä¸­ è¿”å›žæ–°åˆ—è¡¨çš„å¼•ç”¨ è¿™ä¸ªç”¨æ¥ç”Ÿæˆé»˜è®¤å€¼å¾—å¯è°ƒç”¨å¯¹è±¡ï¼ˆlist()ï¼‰å­˜æ”¾åœ¨åä¸º default_factory çš„å®žä¾‹å±žæ€§é‡Œã€‚è‹¥åˆ›å»º defaultdict çš„æ—¶å€™æ²¡æœ‰æŒ‡å®š default_factoryï¼Œåˆ™æŸ¥è¯¢ä¸å­˜åœ¨çš„é”®ä¼šè§¦å‘ KeyErrorã€‚è¿™äº›ç‰¹æ€§èƒŒåŽä¾èµ–çš„æ˜¯ __missing__ ç‰¹æ®Šæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ®Šæ–¹æ³•æ˜¯æ‰€æœ‰æ˜ å°„ç±»åž‹éƒ½å¯ä»¥é€‰æ‹©æ€§åœ°åŽ»æ”¯æŒçš„ã€‚ missingæ‰€æœ‰çš„æ˜ å°„ç±»åž‹å¤„ç†æ‰¾ä¸åˆ°çš„é”®çš„æ—¶å€™ï¼Œéƒ½ä¼šæ¶‰åŠåˆ° __missing__ æ–¹æ³•ã€‚è™½ç„¶åŸºç±» dict å¹¶æ²¡æœ‰å®šä¹‰è¿™ä¸ªæ–¹æ³•ï¼Œä½†å¦‚æžœæœ‰ä¸€ä¸ªç±»ç»§æ‰¿äº† dictï¼Œè¯¥ç±»æä¾› __missing__ æ–¹æ³•ï¼Œåˆ™ __getitem__ æ‰¾ä¸åˆ°é”®çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ __missing__ è€Œä¸ä¼šæŠ›å‡º KeyError å¼‚å¸¸ã€‚ __missing__ æ–¹æ³•åªä¼šè¢« __getitem__ è°ƒç”¨ï¼ˆæ¯”å¦‚åœ¨è¡¨è¾¾å¼ d[k] ä¸­ï¼‰ã€‚æä¾› __missing__ æ–¹æ³•å¯¹ get æˆ– __contains__ æ–¹æ³•çš„ä½¿ç”¨æ²¡æœ‰å½±å“ã€‚ å¦‚éœ€è¦å®žçŽ°ä¸€ç§è‡ªå®šä¹‰çš„æ˜ å°„ç±»åž‹ï¼Œåœ¨æŸ¥è¯¢çš„æ—¶å€™å°†æ˜ å°„é‡Œçš„é”®éƒ½è½¬æ¢æˆ strã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314class StrKeyDict(dict): def __missing__(self, key): if isinstance(key, str): raise KeyError(key) return self[str(key)] def get(self, key, default=None): try: return self[key] except KeyError: return default def __contains__(self, key): return key in self.keys() or str(key) in self.keys() è¿è¡Œç»“æžœå¦‚ä¸‹ï¼š123456789101112131415161718192021222324&gt;&gt;&gt; from strkeydict import StrKeyDict&gt;&gt;&gt; d = StrKeyDict([('2', 'two'), ('4', 'four')])&gt;&gt;&gt; d['2']'two'&gt;&gt;&gt; d[4]'four'&gt;&gt;&gt; d[1]Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "/home/starky/program/python/algorithm/strkeydict.py", line 5, in __missing__ return self[str(key)] File "/home/starky/program/python/algorithm/strkeydict.py", line 4, in __missing__ raise KeyError(key)KeyError: '1'&gt;&gt;&gt; d.get('2')'two'&gt;&gt;&gt; d.get(4)'four'&gt;&gt;&gt; d.get(1, 'N/A')'N/A'&gt;&gt;&gt; 2 in dTrue&gt;&gt;&gt; 1 in dFalse StrKeyDict ç»§æ‰¿è‡ª dictï¼Œå¦‚æžœæ‰¾ä¸åˆ°çš„é”®æœ¬èº«æ˜¯å­—ç¬¦ä¸²ï¼ŒæŠ›å‡º KeyError å¼‚å¸¸ï¼›å¦‚æžœæ‰¾ä¸åˆ°çš„é”®ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²åŽå†è¿›è¡ŒæŸ¥æ‰¾ã€‚get æ–¹æ³•æŠŠæŸ¥æ‰¾å·¥ä½œç”¨ self[key] çš„å½¢å¼å§”æ‰˜ç»™ __getitem__ï¼Œè¿™æ ·åœ¨ç¡®å®šæŸ¥æ‰¾å¤±è´¥ä¹‹å‰ï¼Œè¿˜èƒ½é€šè¿‡ __missing__ åœ¨ç»™æŸä¸ªé”®ä¸€ä¸ªæœºä¼šã€‚ isinstance(key, str) åœ¨ __missing__ ä¸­æ˜¯å¿…é¡»çš„ï¼Œè‹¥ str(k) ä¸æ˜¯ä¸€ä¸ªå­˜åœ¨çš„é”®ï¼Œä»£ç å°±ä¼šé™·å…¥æ— é™é€’å½’ã€‚å› ä¸º __missing__ æœ€åŽä¸€è¡Œä¸­çš„ self[str(key)] ä¼šè°ƒç”¨ __getitem__ï¼Œè€Œ str(key) åˆä¸å­˜åœ¨ï¼Œåˆ™ __missing__ åˆä¼šè¢«è°ƒç”¨ã€‚ __contains__ æ–¹æ³•ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºä»Ž dict ç»§æ‰¿åˆ°çš„ __contians__ æ–¹æ³•ä¸ä¼šåœ¨æ‰¾ä¸åˆ°é”®æ—¶è°ƒç”¨ __missing__ æ–¹æ³•ã€‚ ä¸å¯å˜ Mapæ ‡å‡†åº“é‡Œæ‰€æœ‰çš„æ˜ å°„ç±»åž‹éƒ½æ˜¯å¯å˜çš„ã€‚ä»Ž Python 3.3 å¼€å§‹ï¼Œtypes æ¨¡å—å¼•å…¥äº†ä¸€ä¸ªåä¸º MappingProxyType çš„å°è£…ç±»ï¼Œå¯ä»¥ä»Žæ™®é€šæ˜ å°„åˆ›å»ºä¸€ä¸ªåªè¯»çš„æ˜ å°„è§†å›¾ã€‚12345678910111213141516&gt;&gt;&gt; from types import MappingProxyType&gt;&gt;&gt; d = &#123;1: 'A'&#125;&gt;&gt;&gt; d_proxy = MappingProxyType(d)&gt;&gt;&gt; d_proxymappingproxy(&#123;1: 'A'&#125;)&gt;&gt;&gt; d_proxy[1]'A'&gt;&gt;&gt; d_proxy[2] = 'x'Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: 'mappingproxy' object does not support item assignment&gt;&gt;&gt; d[2] = 'B'&gt;&gt;&gt; d_proxymappingproxy(&#123;1: 'A', 2: 'B'&#125;)&gt;&gt;&gt; d_proxy[2]'B' é›†åˆé›†åˆçš„æœ¬è´¨æ˜¯è®¸å¤šå”¯ä¸€å¯¹è±¡çš„èšé›†ï¼Œå¯ç”¨äºŽåŽ»é‡ï¼š123&gt;&gt;&gt; l = ['spam', 'spam', 'eggs', 'spam']&gt;&gt;&gt; set(l)&#123;'spam', 'eggs'&#125; é™¤äº†ä¿è¯å”¯ä¸€æ€§ï¼Œé›†åˆè¿˜å®žçŽ°äº†å¾ˆå¤šåŸºç¡€çš„ä¸­ç¼€è¿ç®—ç¬¦ã€‚æ¯”å¦‚ a | b æ±‚å¹¶é›†ï¼Œa &amp; b æ±‚äº¤é›†ï¼Œa - b æ±‚å·®é›†ç­‰ã€‚åˆç†ä½¿ç”¨è¿™äº›è¿ç®—ç¬¦å¯ä»¥çœåŽ»ä¸å¿…è¦çš„å¾ªçŽ¯å’Œé€»è¾‘æ“ä½œï¼Œä½¿ä»£ç è¡Œæ•°æ›´å°‘ä¸”æ›´æ˜“è¯»ã€‚ æ¯”å¦‚æœ‰ä¸€ä¸ªç”µå­é‚®ä»¶åœ°å€çš„é›†åˆ haystackï¼Œè¿˜è¦ç»´æŠ¤ä¸€ä¸ªè¾ƒå°çš„ç”µå­é‚®ä»¶é›†åˆ needlesï¼Œç„¶åŽæ±‚å‡º needles ä¸­æœ‰å¤šå°‘åœ°å€åŒæ—¶ä¹Ÿå‡ºçŽ°åœ¨äº† heystack é‡Œã€‚æ±‚ needles çš„å…ƒç´ åœ¨ heystack ä¸­å‡ºçŽ°çš„æ¬¡æ•°ï¼Œä¸¤ä¸ªå˜é‡éƒ½æ˜¯é›†åˆç±»åž‹ï¼Œåˆ™åªç”¨ä¸€è¡Œä»£ç å³å¯å®žçŽ°ï¼š1found = len(needles &amp; haystack) è‹¥ä¸ä½¿ç”¨äº¤é›†æ“ä½œçš„è¯ï¼Œåˆ™éœ€è¦é€šè¿‡ä»¥ä¸‹ä»£ç å®žçŽ°ï¼š123for n in needles: if n in haystack: found += 1 æ•£åˆ—è¡¨æ•£åˆ—è¡¨ï¼ˆHash Mapï¼‰æ˜¯ä¸€ç§ç¨€ç–æ•°ç»„ï¼ˆå³æ€»æ˜¯æœ‰ç©ºç™½å…ƒç´ çš„æ•°ç»„ï¼‰ï¼Œæ•£åˆ—è¡¨ä¸­çš„å•å…ƒé€šå¸¸å«åšè¡¨å…ƒï¼ˆbucketï¼‰ã€‚åœ¨ dict èƒŒåŽçš„æ•£åˆ—è¡¨ä¸­ï¼Œæ¯ä¸ªé”®å€¼å¯¹éƒ½å ç”¨ä¸€ä¸ªè¡¨å…ƒï¼Œæ¯ä¸ªè¡¨å…ƒéƒ½åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¯¹é”®çš„å¼•ç”¨å’Œå¯¹å€¼çš„å¼•ç”¨ã€‚å› ä¸ºæ‰€æœ‰è¡¨å…ƒçš„å¤§å°ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡åç§»é‡æ¥è¯»å–æŸä¸ªè¡¨å…ƒã€‚ Python ä¼šä¿è¯å¤§æ¦‚ä¸‰åˆ†ä¹‹ä¸€çš„è¡¨å…ƒæ˜¯ç©ºçš„ï¼Œå½“å¿«è¦è¾¾åˆ°è¿™ä¸ªé˜ˆå€¼æ—¶ï¼ŒåŽŸæœ‰çš„æ•£åˆ—è¡¨ä¼šè¢«å¤åˆ¶åˆ°ä¸€ä¸ªæ›´å¤§çš„ç©ºé—´é‡Œã€‚æŠŠå¯¹è±¡å­˜å…¥æ•£åˆ—è¡¨ä¸­ä¹‹å‰ï¼Œéœ€è¦å…ˆè®¡ç®—è¯¥å…ƒç´ é”®çš„æ•£åˆ—å€¼ã€‚ å†…ç½®çš„ hash() å‡½æ•°å¯ç”¨äºŽè®¡ç®—æ‰€æœ‰å†…ç½®ç±»åž‹å¯¹è±¡çš„æ•£åˆ—å€¼ã€‚è‹¥è‡ªå®šä¹‰å¯¹è±¡è°ƒç”¨ hash()ï¼Œå®žé™…ä¸Šè¿è¡Œçš„æ˜¯è‡ªå®šä¹‰çš„ __hash__ æ–¹æ³•ã€‚è‹¥ä¸¤ä¸ªå¯¹è±¡æ¯”è¾ƒæ—¶å¤§å°ç›¸ç­‰ï¼Œåˆ™å®ƒä»¬çš„æ•£åˆ—å€¼ä¹Ÿå¿…é¡»ç›¸ç­‰ã€‚å³ 1 == 1.0 ä¸ºçœŸï¼Œåˆ™ hash(1) == hash(1.0) ä¹Ÿå¿…é¡»ä¸ºçœŸã€‚ ä¸ºäº†è®©æ•£åˆ—å€¼èƒ½å¤Ÿä½œä¸ºæ•£åˆ—è¡¨ç´¢å¼•ä½¿ç”¨ï¼Œè¿™äº›æ•£åˆ—å€¼å¿…é¡»åœ¨ç´¢å¼•ç©ºé—´å†…å°½é‡åˆ†æ•£å¼€ã€‚æ„å‘³ç€åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œè¶Šæ˜¯ç›¸ä¼¼ä½†ä¸ç›¸ç­‰çš„å¯¹è±¡ï¼Œå…¶æ•£åˆ—å€¼å·®åˆ«ä¹Ÿè¶Šå¤§ã€‚123456&gt;&gt;&gt; hash(1.0001)230584300921345&gt;&gt;&gt; hash(1.0002)461168601842689&gt;&gt;&gt; hash(1.0003)691752902764033 æ•£åˆ—è¡¨ç®—æ³•ä¸ºäº†èŽ·å– my_dict[search_key] èƒŒåŽçš„å€¼ï¼ŒPython é¦–å…ˆä¼šè°ƒç”¨ hash(search_key) æ¥è®¡ç®— search_key çš„æ•£åˆ—å€¼ï¼Œå°†è¯¥å€¼æœ€ä½Žçš„å‡ ä½æ•°å­—ä½œä¸ºåç§»é‡ï¼ˆå…·ä½“å‡ ä½ä½œä¸ºåç§»é‡ï¼Œéœ€ä¾æ®å½“å‰æ•£åˆ—è¡¨çš„å¤§å°ï¼‰ï¼Œåœ¨æ•£åˆ—è¡¨é‡ŒæŸ¥æ‰¾è¡¨å…ƒã€‚è‹¥æŸ¥æ‰¾å‡ºçš„è¡¨å…ƒä¸ºç©ºï¼Œåˆ™æŠ›å‡º KeyError å¼‚å¸¸ã€‚è‹¥è¡¨å…ƒéžç©ºï¼Œè¯¥è¡¨å…ƒä¸­ä¼šæœ‰ä¸€å¯¹ found_key: found_valueã€‚Python ä¼šæ£€æŸ¥ search_key == found_key æ˜¯å¦ä¸ºçœŸï¼Œè‹¥ä¸ºçœŸåˆ™è¿”å›ž found_valueã€‚è‹¥ search_key ä¸Ž found_key ä¸åŒ¹é…ï¼Œè¿™ç§æƒ…å†µç§°ä¸ºæ•£åˆ—å†²çªã€‚ç®—æ³•ä¼šåœ¨æ•£åˆ—å€¼ä¸­å¦å¤–å†å–å‡ ä½æ•°å­—ï¼Œç”¨ç‰¹æ®Šæ–¹æ³•å¤„ç†ä¸€ä¸‹ï¼ŒæŠŠæ–°å¾—åˆ°çš„æ•°å­—ä½œä¸ºç´¢å¼•ç»§ç»­å¯»æ‰¾è¡¨å…ƒå¹¶é‡å¤ä»¥ä¸Šæ­¥éª¤ã€‚ å­—å…¸çš„ç‰¹æ€§é”®å¿…é¡»æ˜¯å¯æ•£åˆ—çš„å¯æ•£åˆ—å¯¹è±¡æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªè¦æ±‚ï¼š æ”¯æŒ hash() å‡½æ•°ï¼Œä¸”é€šè¿‡ __hash__() å¾—åˆ°çš„æ•£åˆ—å€¼æ˜¯ä¸å˜çš„ æ”¯æŒé€šè¿‡ __eq__() æ–¹æ³•æ£€æµ‹ç›¸ç­‰æ€§ è‹¥ a == b ä¸ºçœŸï¼Œåˆ™ hash(a) == hash(b) ä¹Ÿä¸ºçœŸ æ‰€æœ‰ç”¨æˆ·è‡ªå®šä¹‰å¯¹è±¡é»˜è®¤éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œå…¶æ•£åˆ—å€¼æœ‰ id() èŽ·å–ï¼Œä¸”éƒ½ä¸ç›¸ç­‰ã€‚ å­—å…¸åœ¨å†…å­˜ä¸Šå¼€é”€å·¨å¤§å­—å…¸ä½¿ç”¨äº†æ•£åˆ—è¡¨ï¼Œæ•£åˆ—è¡¨åˆå¿…é¡»æ˜¯ç¨€ç–çš„ï¼Œä»Žè€Œå¯¼è‡´å­—å…¸åœ¨ç©ºé—´çš„ä½¿ç”¨ä¸Šæ•ˆçŽ‡ä½Žä¸‹ã€‚è‹¥éœ€è¦å­˜æ”¾æ•°é‡å·¨å¤§çš„è®°å½•ï¼Œæ”¾åœ¨ç”±å…ƒç»„æˆ–å…·åå…ƒç»„æž„æˆçš„åˆ—è¡¨ä¸­ä¼šæ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚ç”¨å…ƒç»„å–ä»£å­—å…¸å­˜å‚¨è®°å½•ï¼Œä¸€æ˜¯é¿å…äº†æ•£åˆ—è¡¨æ‰€è€—è´¹çš„ç©ºé—´ï¼ŒäºŒæ˜¯æ— éœ€æŠŠè®°å½•ä¸­å­—æ®µçš„åå­—åœ¨æ¯ä¸ªå…ƒç´ é‡Œéƒ½å­˜ä¸€éï¼Œä»Žè€ŒèŠ‚çœç©ºé—´ã€‚åœ¨ç”¨æˆ·è‡ªå®šä¹‰ç±»åž‹ä¸­ï¼Œ__slots__ å±žæ€§å¯ä»¥æ”¹å˜å®žä¾‹å±žæ€§çš„å­˜å‚¨æ–¹å¼ï¼Œç”± dict å˜ä¸º tupleã€‚ å­—å…¸çš„é”®æŸ¥è¯¢å¾ˆå¿«dict çš„å®žçŽ°æ˜¯å…¸åž‹çš„ç©ºé—´æ¢æ—¶é—´ã€‚å­—å…¸ç±»åž‹æœ‰ç€å·¨å¤§çš„å†…å­˜å¼€é”€ï¼Œä½†æ˜¯å®ƒæä¾›äº†æ— è§†æ•°æ®é‡å¤§å°çš„å¿«é€Ÿè®¿é—®ã€‚ é”®çš„æ¬¡åºå–å†³äºŽæ·»åŠ é¡ºåº é›†åˆçš„ç‰¹æ€§é›†åˆé‡Œçš„å…ƒç´ å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ é›†åˆå¾ˆæ¶ˆè€—å†…å­˜ å¯ä»¥å¾ˆé«˜æ•ˆåœ°åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨äºŽæŸä¸ªé›†åˆä¸­ å…ƒç´ çš„æ¬¡åºå–å†³äºŽè¢«æ·»åŠ åˆ°é›†åˆé‡Œçš„æ¬¡åº å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Program</tag>
        <tag>Dict</tag>
        <tag>Map</tag>
        <tag>Hash</tag>
        <tag>Set</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®° â€”â€” å¯è¿­ä»£å¯¹è±¡ã€è¿­ä»£å™¨å’Œç”Ÿæˆå™¨]]></title>
    <url>%2F2020%2F10%2F18%2Ffluent-python-iterator-and-generator%2F</url>
    <content type="text"><![CDATA[è¿­ä»£æ˜¯æ•°æ®å¤„ç†çš„åŸºçŸ³ã€‚æ‰«æå†…å­˜ä¸­æ”¾ä¸ä¸‹çš„æ•°æ®é›†æ—¶ï¼Œé€šå¸¸éœ€è¦ä¸€ç§æƒ°æ€§èŽ·å–æ•°æ®é¡¹çš„æ–¹å¼ï¼Œå³æŒ‰éœ€ä¸€æ¬¡èŽ·å–ä¸€ä¸ªæ•°æ®é¡¹ã€‚è¿™å°±æ˜¯è¿­ä»£å™¨æ¨¡å¼ã€‚ åœ¨ Python ä¸­ï¼Œæ‰€æœ‰åºåˆ—ç±»åž‹éƒ½æ”¯æŒè¿­ä»£ã€‚åœ¨è¯­è¨€å†…éƒ¨ï¼Œè¿­ä»£å™¨ç”¨äºŽæ”¯æŒä»¥ä¸‹æ“ä½œï¼š for å¾ªçŽ¯ æž„å»ºå’Œæ‰©å±•åºåˆ—ç±»åž‹ é€è¡ŒéåŽ†æ–‡æœ¬æ–‡ä»¶ åˆ—è¡¨æŽ¨å¯¼ã€å­—å…¸æŽ¨å¯¼å’Œé›†åˆæŽ¨å¯¼ å…ƒç»„æ‹†åŒ… è°ƒç”¨å‡½æ•°æ—¶ï¼Œä½¿ç”¨ * æ‹†åŒ…å®žå‚ å¯è¿­ä»£å¯¹è±¡ä»¥ä¸‹ä»£ç å®žçŽ°äº†ä¸€ä¸ª Sentence ç±»ï¼Œé€šè¿‡ç´¢å¼•ä»Žæ–‡æœ¬ä¸­æå–å•è¯ï¼š123456789101112131415161718import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __getitem__(self, index): return self.words[index] def __len__(self): return len(self.words) def __repr__(self): return f'Sentence(&#123;reprlib.repr(self.text)&#125;)' æ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516&gt;&gt;&gt; from sentence import Sentence&gt;&gt;&gt; s = Sentence('"The time has come," the Walrus said,')&gt;&gt;&gt; sSentence('"The time ha... Walrus said,')&gt;&gt;&gt; for word in s:... print(word)...ThetimehascometheWalrussaid&gt;&gt;&gt; list(s)['The', 'time', 'has', 'come', 'the', 'Walrus', 'said'] ä¸Šé¢åˆ›å»ºçš„ Sentence å®žä¾‹æ˜¯å¯è¿­ä»£çš„ã€‚å› æ­¤è¯¥å®žä¾‹å¯¹è±¡å¯è¢« for å¾ªçŽ¯è°ƒç”¨ã€å¯ä»¥ç”¨äºŽæž„å»ºåˆ—è¡¨ç­‰ã€‚ è¿­ä»£çš„æœºåˆ¶Python è§£é‡Šå™¨éœ€è¦è¿­ä»£å¯¹è±¡ x æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ iter(x)ã€‚å…¶ä½œç”¨å¦‚ä¸‹ï¼š æ£€æŸ¥å¯¹è±¡æ˜¯å¦å®žçŽ°äº† __iter__ æ–¹æ³•ï¼Œå¦‚å·²å®žçŽ°åˆ™è°ƒç”¨ __iter__ï¼Œè¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ è‹¥å¯¹è±¡æ²¡æœ‰å®žçŽ° __iter__ æ–¹æ³•ï¼Œä½†å®žçŽ°äº† __getitem__ æ–¹æ³•ï¼ŒPython ä¼šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå°è¯•æŒ‰é¡ºåºï¼ˆä»Žç´¢å¼• 0 å¼€å§‹ï¼‰èŽ·å–å…ƒç´  è‹¥ä¸Šè¿°å°è¯•å¤±è´¥ï¼ŒæŠ›å‡º TypeError å¼‚å¸¸ï¼ˆX object is not iterableï¼‰ æ‰€æœ‰ Python åºåˆ—éƒ½å®žçŽ°äº† __iter__ æ–¹æ³•ï¼Œå› æ­¤éƒ½æ”¯æŒè¿­ä»£æ“ä½œã€‚ å¯è¿­ä»£å¯¹è±¡ä¸Žè¿­ä»£å™¨çš„å¯¹æ¯”å¯è¿­ä»£å¯¹è±¡æŒ‡é€šè¿‡ iter å‡½æ•°è°ƒç”¨å¯ä»¥èŽ·å–è¿­ä»£å™¨çš„å¯¹è±¡ã€‚å³å¯¹è±¡å®žçŽ°äº†èƒ½å¤Ÿè¿”å›žè¿­ä»£å™¨çš„ __iter__ æ–¹æ³•ï¼Œè¯¥å¯¹è±¡å°±æ˜¯å¯è¿­ä»£çš„ï¼›æˆ–è€…å®žçŽ°äº† __getitem__ æ–¹æ³•ï¼Œä¸”å…¶å‚æ•°æ˜¯ä»Ž 0 å¼€å§‹çš„ç´¢å¼•ï¼Œåˆ™å¯¹è±¡ä¹Ÿå¯ä»¥è¿­ä»£ã€‚ ä¸€ä¸ªç®€å•çš„ for å¾ªçŽ¯èƒŒåŽä¹Ÿæ˜¯æœ‰è¿­ä»£å™¨çš„ä½œç”¨çš„ï¼š1234567&gt;&gt;&gt; s = 'ABC'&gt;&gt;&gt; for char in s:... print(char)...ABC ä½¿ç”¨ while å¾ªçŽ¯æ¨¡æ‹Ÿæ•ˆæžœå¦‚ä¸‹ï¼š123456789101112&gt;&gt;&gt; s = 'ABC'&gt;&gt;&gt; it = iter(s)&gt;&gt;&gt; while True:... try:... print(next(it))... except StopIteration:... del it... break...ABC ä½¿ç”¨å¯è¿­ä»£çš„å¯¹è±¡ï¼ˆå­—ç¬¦ä¸² sï¼‰åˆ›å»ºè¿­ä»£å™¨ it ä¸æ–­åœ¨è¿­ä»£å™¨ it ä¸Šè°ƒç”¨ next å‡½æ•°ï¼ŒèŽ·å–ä¸‹ä¸€ä¸ªå­—ç¬¦ è‹¥å·²èŽ·å–åˆ°æœ€åŽä¸€ä¸ªå­—ç¬¦ï¼Œè¿­ä»£å™¨æŠ›å‡º StopIteration å¼‚å¸¸ æ•èŽ· StopIteration å¼‚å¸¸ï¼Œé‡Šæ”¾ it å¯¹è±¡ï¼Œé€€å‡ºå¾ªçŽ¯ Python è¯­è¨€å†…éƒ¨ä¼šè‡ªåŠ¨å¤„ç† for å¾ªçŽ¯å’Œå…¶ä»–è¿­ä»£ä¸Šä¸‹æ–‡ï¼ˆå¦‚åˆ—è¡¨æŽ¨å¯¼ç­‰ï¼‰ä¸­çš„ StopIteration å¼‚å¸¸ã€‚ è¿­ä»£å™¨ï¼ˆå¦‚å‰é¢çš„ itï¼‰å®žçŽ°äº†æ— å‚æ•°çš„ __next__ æ–¹æ³•ï¼Œè¿”å›žåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼›è‹¥æ²¡æœ‰å…ƒç´ äº†ï¼Œåˆ™æŠ›å‡º StopIteration å¼‚å¸¸ã€‚Python ä¸­çš„è¿­ä»£å™¨è¿˜å®žçŽ°äº† __iter__ æ–¹æ³•ï¼Œè¿”å›žè¯¥è¿­ä»£å™¨æœ¬èº«ï¼ˆå³ç¡®ä¿è¿­ä»£å™¨æœ¬èº«ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼‰ å…¸åž‹çš„è¿­ä»£å™¨å…³äºŽå¯è¿­ä»£å¯¹è±¡ä¸Žè¿­ä»£å™¨ä¹‹é—´çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __repr__(self): return f'Sentence(&#123;reprlib.repr(self.text)&#125;)' def __iter__(self): return SentenceIterator(self.words)class SentenceIterator: def __init__(self, words): self.words = words self.index = 0 def __next__(self): try: word = self.words[self.index] except IndexError: raise StopIteration() self.index += 1 return word def __iter__(self): return self æ ¹æ®è¿­ä»£å™¨åè®®ï¼Œå¯è¿­ä»£å¯¹è±¡ Sentence ä¸­çš„ __iter__ æ–¹æ³•ä¼šå®žä¾‹åŒ–å¹¶è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼ˆSentenceIteratorï¼‰ï¼Œè€Œ SentenceIterator ä½œä¸ºè¿­ä»£å™¨å®žçŽ°äº† __next__ å’Œ __iter__ æ–¹æ³•ã€‚ æž„å»ºå¯è¿­ä»£å¯¹è±¡æ—¶å‡ºçŽ°é”™è¯¯çš„åŽŸå› ç»å¸¸æ˜¯æ··æ·†äº†å¯è¿­ä»£å¯¹è±¡ä¸Žè¿­ä»£å™¨ã€‚å¯è¿­ä»£å¯¹è±¡é€šè¿‡å†…éƒ¨çš„ __iter__ æ–¹æ³•è¿”å›žä¸€ä¸ªå®žä¾‹åŒ–çš„è¿­ä»£å™¨å¯¹è±¡ï¼›è€Œè¿­ä»£å™¨è¦å®žçŽ° __next__ æ–¹æ³•è¿”å›žå•ä¸ªå…ƒç´ ï¼Œæ­¤å¤–è¿˜éœ€è¦å®žçŽ° __iter__ æ–¹æ³•è¿”å›žè¿­ä»£å™¨æœ¬èº«ã€‚ ç”Ÿæˆå™¨å‡½æ•°1234567891011121314151617181920212223242526272829303132import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __repr__(self): return f'Sentence(&#123;reprlib.repr(self.text)&#125;)' def __iter__(self): return SentenceIterator(self.words)class SentenceIterator: def __init__(self, words): self.words = words self.index = 0 def __next__(self): try: word = self.words[self.index] except IndexError: raise StopIteration() self.index += 1 return word def __iter__(self): return self å®žçŽ°å¯è¿­ä»£å¯¹è±¡ï¼Œç›¸è¾ƒäºŽä¹‹å‰çš„ä»£ç ï¼Œç¬¦åˆ Python ä¹ æƒ¯çš„æ–¹å¼æ˜¯ç”¨ç”Ÿæˆå™¨å‡½æ•°æ›¿æ¢æ‰‹åŠ¨å®žçŽ°çš„è¿­ä»£å™¨ SentenceIterator ç±»ã€‚ åªè¦ Python å‡½æ•°çš„å®šä¹‰ä½“ä¸­æœ‰ yield å…³é”®å­—ï¼Œåˆ™è¯¥å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°ã€‚è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¼šè¿”å›žä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚1234567891011121314151617181920212223242526&gt;&gt;&gt; def gen_123():... yield 1... yield 2... yield 3...&gt;&gt;&gt; gen_123&lt;function gen_123 at 0x7f63e57f0f80&gt;&gt;&gt;&gt; gen_123()&lt;generator object gen_123 at 0x7f63e57dc950&gt;&gt;&gt;&gt; for i in gen_123():... print(i)...123&gt;&gt;&gt; g = gen_123()&gt;&gt;&gt; next(g)1&gt;&gt;&gt; next(g)2&gt;&gt;&gt; next(g)3&gt;&gt;&gt; next(g)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration æŠŠç”Ÿæˆå™¨å¯¹è±¡ä¼ é€’ç»™ next() å‡½æ•°æ—¶ï¼Œå…¶è¡Œä¸ºä¸Žè¿­ä»£å™¨ä¸€è‡´ã€‚ æƒ°æ€§æ±‚å€¼re.finditer æ˜¯ re.findall å‡½æ•°çš„æƒ°æ€§ç‰ˆæœ¬ï¼Œè¿”å›žçš„ä¸æ˜¯ç»“æžœåˆ—è¡¨è€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼ŒæŒ‰éœ€ç”Ÿæˆ re.MatchObject å®žä¾‹ã€‚å³åªåœ¨éœ€è¦æ—¶æ‰ç”Ÿæˆä¸‹ä¸€ä¸ªå•è¯ã€‚ 123456789101112131415import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text): self.text = text def __repr__(self): return f'Sentence(&#123;reprlib.repr(self.text)&#125;)' def __iter__(self): for match in RE_WORD.finditer(self.text): yield match.group() finditer å‡½æ•°è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼ŒåŒ…å« self.text ä¸­åŒ¹é… RE_WORD çš„å•è¯ï¼Œäº§å‡º MatchObject å®žä¾‹ã€‚match.group() æ–¹æ³•ä»Ž MatchObject å®žä¾‹ä¸­æå–åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„å…·ä½“æ–‡æœ¬ã€‚ ç”Ÿæˆå™¨å‡½æ•°å·²æžå¤§åœ°ç®€åŒ–äº†ä»£ç ï¼Œä½†ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼èƒ½å¤ŸæŠŠä»£ç å˜å¾—æ›´ä¸ºç®€çŸ­ã€‚123456789101112131415161718&gt;&gt;&gt; def gen_AB():... print('start')... yield 'A'... print('continue')... yield 'B'... print('end.')...&gt;&gt;&gt; res = (x * 3 for x in gen_AB())&gt;&gt;&gt; res&lt;generator object &lt;genexpr&gt; at 0x7f4619324ad0&gt;&gt;&gt;&gt; for i in res:... print('--&gt;', i)...start--&gt; AAAcontinue--&gt; BBBend. å¯ä»¥çœ‹å‡ºï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼ä¼šäº§å‡ºç”Ÿæˆå™¨ã€‚1234567891011121314import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text): self.text = text def __repr__(self): return f'Sentence(&#123;reprlib.repr(self.text)&#125;)' def __iter__(self): return (match.group() for match in RE_WORD.finditer(self.text)) æ ‡å‡†åº“ä¸­çš„ç”Ÿæˆå™¨å‡½æ•°ç”¨äºŽè¿‡æ»¤çš„ç”Ÿæˆå™¨å‡½æ•° æ¨¡å— å‡½æ•° è¯´æ˜Ž itertools compress(it, selector_it) å¹¶è¡Œå¤„ç†ä¸¤ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚è‹¥ selector_it ä¸­çš„å…ƒç´ æ˜¯çœŸå€¼ï¼Œäº§å‡º it ä¸­å¯¹åº”çš„å…ƒç´  itertools dropwhile(predicate, it) æŠŠå¯è¿­ä»£å¯¹è±¡ it ä¸­çš„å…ƒç´ ä¼ ç»™ predicateï¼Œè·³è¿‡ predicate(item) ä¸ºçœŸå€¼çš„å…ƒç´ ï¼Œåœ¨ predicate(item) ä¸ºå‡æ—¶åœæ­¢ï¼Œäº§å‡ºå‰©ä½™ï¼ˆæœªè·³è¿‡ï¼‰çš„æ‰€æœ‰å…ƒç´ ï¼ˆä¸å†ç»§ç»­æ£€æŸ¥ï¼‰ å†…ç½® filter(predicate, it) æŠŠ it ä¸­çš„å„ä¸ªå…ƒç´ ä¼ ç»™ predicateï¼Œè‹¥ predicate(item) è¿”å›žçœŸå€¼ï¼Œäº§å‡ºå¯¹åº”å…ƒç´  itertools filterfalse(predicate, it) ä¸Ž filter å‡½æ•°ç±»ä¼¼ï¼Œä¸è¿‡ predicate(item) è¿”å›žå‡å€¼æ—¶äº§å‡ºå¯¹åº”å…ƒç´  itertools takewhile(predicate, it) predicate(item) è¿”å›žçœŸå€¼æ—¶äº§å‡ºå¯¹åº”å…ƒç´ ï¼Œç„¶åŽç«‹å³åœæ­¢ä¸å†ç»§ç»­æ£€æŸ¥ itertools islice(it, stop) æˆ– islice(it, start, stop, step=1) äº§å‡º it çš„åˆ‡ç‰‡ï¼Œä½œç”¨ç±»ä¼¼äºŽ s[:stop] æˆ– s[start:stop:stepï¼Œä¸è¿‡ it å¯ä»¥æ˜¯ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼Œä¸”å®žçŽ°çš„æ˜¯æƒ°æ€§æ“ä½œ 12345678910111213141516&gt;&gt;&gt; def vowel(c):... return c.lower() in 'aeiou'...&gt;&gt;&gt; list(filter(vowel, 'Aardvark'))['A', 'a', 'a']&gt;&gt;&gt; import itertools&gt;&gt;&gt; list(itertools.filterfalse(vowel, 'Aardvark'))['r', 'd', 'v', 'r', 'k']&gt;&gt;&gt; list(itertools.dropwhile(vowel, 'Aardvark'))['r', 'd', 'v', 'a', 'r', 'k']&gt;&gt;&gt; list(itertools.compress('Aardvark', (1,0,1,1,0,1)))['A', 'r', 'd', 'a']&gt;&gt;&gt; list(itertools.islice('Aardvark', 4))['A', 'a', 'r', 'd']&gt;&gt;&gt; list(itertools.islice('Aardvark', 1, 7, 2))['a', 'd', 'a'] ç”¨äºŽæ˜ å°„çš„ç”Ÿæˆå™¨å‡½æ•° æ¨¡å— å‡½æ•° è¯´æ˜Ž itertools accumulate(it, [func]) äº§å‡ºç´¯ç§¯çš„æ€»å’Œã€‚è‹¥æä¾›äº† funcï¼Œåˆ™æŠŠ it ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œå†æŠŠè®¡ç®—ç»“æžœè¿žåŒä¸‹ä¸€ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œäº§å‡ºç»“æžœ å†…ç½® enumerate(it, start=0) äº§å‡ºç”±ä¸¤ä¸ªå…ƒç´ æž„æˆçš„å…ƒç»„ï¼Œç»“æž„æ˜¯ (index, item)ã€‚å…¶ä¸­ index ä»Ž start å¼€å§‹è®¡æ•°ï¼Œitem åˆ™ä»Ž it ä¸­èŽ·å– å†…ç½® map(func, it1, [it2, ..., itN]) æŠŠ it ä¸­çš„å„ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œäº§å‡ºç»“æžœï¼›è‹¥ä¼ å…¥ N ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œåˆ™ func å¿…é¡»èƒ½æŽ¥å— N ä¸ªå‚æ•°ï¼Œä¸”å¹¶è¡Œå¤„ç†å„ä¸ªå¯è¿­ä»£å¯¹è±¡ 123456789101112131415&gt;&gt;&gt; list(enumerate('albatroz', 1))[(1, 'a'), (2, 'l'), (3, 'b'), (4, 'a'), (5, 't'), (6, 'r'), (7, 'o'), (8, 'z')]&gt;&gt;&gt; import operator&gt;&gt;&gt; list(map(operator.mul, range(11), range(11)))[0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100]&gt;&gt;&gt; list(map(operator.mul, range(11), [2, 4, 8]))[0, 4, 16]&gt;&gt;&gt; list(map(lambda a, b: (a, b), range(11), [2, 4, 8]))[(0, 2), (1, 4), (2, 8)]&gt;&gt;&gt; import itertools&gt;&gt;&gt; sample = [5, 4, 2, 8, 7, 6, 3, 0, 9, 1]&gt;&gt;&gt; list(itertools.accumulate(sample))[5, 9, 11, 19, 26, 32, 35, 35, 44, 45]&gt;&gt;&gt; list(itertools.accumulate(sample, max))[5, 5, 5, 8, 8, 8, 8, 8, 9, 9] åˆå¹¶å¤šä¸ªå¯è¿­ä»£å¯¹è±¡çš„ç”Ÿæˆå™¨å‡½æ•° æ¨¡å— å‡½æ•° è¯´æ˜Ž itertools chain(it1, ..., itN) å…ˆäº§å‡º it1 ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œç„¶åŽäº§å‡º it2 ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œæ— ç¼è¿žæŽ¥ itertools chain.from_iterable(it) äº§å‡º it ç”Ÿæˆçš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ ï¼Œä¸€ä¸ªæŽ¥ä¸€ä¸ªæ— ç¼è¿žæŽ¥ï¼›it ä¸­çš„å…ƒç´ åº”è¯¥ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼ˆå³ it æ˜¯åµŒå¥—äº†å¯è¿­ä»£å¯¹è±¡çš„å¯è¿­ä»£å¯¹è±¡ï¼‰ itertools product(it1, ..., itN, repeat=1) è®¡ç®—ç¬›å¡å°”ç§¯ã€‚ä»Žè¾“å…¥çš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­èŽ·å–å…ƒç´ ï¼Œåˆå¹¶æˆ N ä¸ªå…ƒç´ ç»„æˆçš„å…ƒç»„ï¼Œä¸ŽåµŒå¥—çš„ for å¾ªçŽ¯æ•ˆæžœä¸€æ ·ã€‚repeat æŒ‡æ˜Žé‡å¤å¤„ç†å¤šå°‘æ¬¡è¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡ å†…ç½® zip(it1, ..., itN) å¹¶è¡Œä»Žè¾“å…¥çš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­èŽ·å–å…ƒç´ ï¼Œäº§å‡ºç”± N ä¸ªå…ƒç´ ç»„æˆçš„å…ƒç»„ã€‚åªè¦å…¶ä¸­ä»»ä½•ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡åˆ°å¤´äº†ï¼Œå°±ç›´æŽ¥åœæ­¢ itertools zip_longest(it1, ..., itN, fillvalue=None) å¹¶è¡Œä»Žè¾“å…¥çš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­èŽ·å–å…ƒç´ ï¼Œäº§å‡ºç”± N ä¸ªå…ƒç´ ç»„æˆçš„å…ƒç»„ï¼Œç­‰åˆ°æœ€é•¿çš„å¯è¿­ä»£å¯¹è±¡åˆ°å¤´åŽæ‰åœæ­¢ã€‚ç©ºç¼ºçš„å€¼ç”¨ fillvalue å¡«å…… 123456789101112131415&gt;&gt;&gt; import itertools&gt;&gt;&gt; list(itertools.chain('ABC', range(2)))['A', 'B', 'C', 0, 1]&gt;&gt;&gt; list(itertools.chain(enumerate('ABC')))[(0, 'A'), (1, 'B'), (2, 'C')]&gt;&gt;&gt; list(itertools.chain.from_iterable(enumerate('ABC')))[0, 'A', 1, 'B', 2, 'C']&gt;&gt;&gt; list(zip('ABC', range(5)))[('A', 0), ('B', 1), ('C', 2)]&gt;&gt;&gt; list(zip('ABC', range(5), [10, 20, 30, 40]))[('A', 0, 10), ('B', 1, 20), ('C', 2, 30)]&gt;&gt;&gt; list(itertools.zip_longest('ABC', range(5)))[('A', 0), ('B', 1), ('C', 2), (None, 3), (None, 4)]&gt;&gt;&gt; list(itertools.zip_longest('ABC', range(5), fillvalue='?'))[('A', 0), ('B', 1), ('C', 2), ('?', 3), ('?', 4)] 123456789&gt;&gt;&gt; list(itertools.product('ABC', range(2)))[('A', 0), ('A', 1), ('B', 0), ('B', 1), ('C', 0), ('C', 1)]&gt;&gt;&gt; suits = 'spades hearts diamonds clubs'.split()&gt;&gt;&gt; list(itertools.product('AK', suits))[('A', 'spades'), ('A', 'hearts'), ('A', 'diamonds'), ('A', 'clubs'), ('K', 'spades'), ('K', 'hearts'), ('K', 'diamonds'), ('K', 'clubs')]&gt;&gt;&gt; list(itertools.product('ABC'))[('A',), ('B',), ('C',)]&gt;&gt;&gt; list(itertools.product('ABC', repeat=2))[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'B'), ('B', 'C'), ('C', 'A'), ('C', 'B'), ('C', 'C')] æŠŠè¾“å…¥çš„å„ä¸ªå…ƒç´ æ‰©å±•æˆå¤šä¸ªè¾“å‡ºå…ƒç´ çš„ç”Ÿæˆå™¨å‡½æ•°|æ¨¡å—|å‡½æ•°|è¯´æ˜Ž||-|-|-||itertools|combinations(it, out_len)|æŠŠå¯è¿­ä»£å¯¹è±¡ it äº§å‡ºçš„ out_len ä¸ªå…ƒç´ ç»„åˆåœ¨ä¸€èµ·äº§å‡º||itertools|combinations_with_replacement(it, out_len)|æŠŠ it äº§å‡ºçš„ out_len ä¸ªå…ƒç´ ç»„åˆåœ¨ä¸€èµ·äº§å‡ºï¼ŒåŒ…å«ç›¸åŒå…ƒç´ çš„ç»„åˆ||itertools|count(start=0, step=1)|ä»Ž start å¼€å§‹ä¸æ–­äº§å‡ºæ•°å­—ï¼ŒæŒ‰ step æŒ‡å®šçš„æ­¥å¹…å¢žåŠ ||itertools|cycle(it)|ä»Ž it ä¸­äº§å‡ºå„ä¸ªå…ƒç´ ï¼Œå­˜å‚¨å„ä¸ªå…ƒç´ çš„å‰¯æœ¬ï¼Œç„¶åŽæŒ‰é¡ºåºé‡å¤ä¸æ–­åœ°äº§å‡ºå„ä¸ªå…ƒç´ ||itertools|permutations(it, out_len=None)|æŠŠ out_len ä¸ª it äº§å‡ºçš„å…ƒç´ æŽ’åˆ—åœ¨ä¸€èµ·ï¼Œç„¶åŽäº§å‡ºè¿™äº›æŽ’åˆ—ï¼›out_len çš„é»˜è®¤å€¼ç­‰äºŽ len(list(it))||itertools|repeat(item, [times])|é‡å¤ä¸æ–­åœ°äº§å‡ºæŒ‡å®šçš„å…ƒç´ ï¼Œé™¤éžæä¾› times æŒ‡å®šæ¬¡æ•°| 123456789101112131415161718&gt;&gt;&gt; import itertools&gt;&gt;&gt; ct = itertools.count()&gt;&gt;&gt; next(ct)0&gt;&gt;&gt; next(ct), next(ct), next(ct)(1, 2, 3)&gt;&gt;&gt; list(itertools.islice(itertools.count(1, .3), 3))[1, 1.3, 1.6]&gt;&gt;&gt; cy = itertools.cycle('ABC')&gt;&gt;&gt; next(cy)'A'&gt;&gt;&gt; list(itertools.islice(cy, 7))['B', 'C', 'A', 'B', 'C', 'A', 'B']&gt;&gt;&gt; rp = itertools.repeat(7)&gt;&gt;&gt; next(rp), next(rp)(7, 7)&gt;&gt;&gt; list(itertools.repeat(8, 4))[8, 8, 8, 8] 123456789&gt;&gt;&gt; import itertools&gt;&gt;&gt; list(itertools.combinations('ABC', 2))[('A', 'B'), ('A', 'C'), ('B', 'C')]&gt;&gt;&gt; list(itertools.combinations_with_replacement('ABC', 2))[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'B'), ('B', 'C'), ('C', 'C')]&gt;&gt;&gt; list(itertools.permutations('ABC', 2))[('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'C'), ('C', 'A'), ('C', 'B')]&gt;&gt;&gt; list(itertools.product('ABC', repeat=2))[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'B'), ('B', 'C'), ('C', 'A'), ('C', 'B'), ('C', 'C')] ç”¨äºŽé‡æ–°æŽ’åˆ—å…ƒç´ çš„ç”Ÿæˆå™¨å‡½æ•°|æ¨¡å—|å‡½æ•°|è¯´æ˜Ž||-|-|-||itertools|groupby(it, key=None)|äº§å‡ºç”±ä¸¤ä¸ªå…ƒç´ ç»„æˆçš„å…ƒç´ ï¼Œå½¢å¼ä¸º (key, group)ï¼Œå…¶ä¸­ key æ˜¯åˆ†ç»„æ ‡å‡†ï¼Œgroup æ˜¯ç”Ÿæˆå™¨ï¼Œç”¨äºŽäº§å‡ºåˆ†ç»„é‡Œçš„å…ƒç´ ||å†…ç½®|reversed(seq)|ä»ŽåŽå‘å‰ï¼Œå€’åºäº§å‡º seq ä¸­çš„å…ƒç´ ï¼›seq å¿…é¡»æ˜¯åºåˆ—ï¼Œæˆ–è€…å®žçŽ°äº† __reversed__ ç‰¹æ®Šæ–¹æ³•çš„å¯¹è±¡||itertools|tee(it, n=2)|äº§å‡ºä¸€ä¸ªæœ‰ n ä¸ªç”Ÿæˆå™¨ç»„æˆçš„å…ƒç»„ï¼Œæ¯ä¸ªç”Ÿæˆå™¨éƒ½å¯ä»¥ç‹¬ç«‹åœ°äº§å‡ºè¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ | 1234567891011121314151617181920212223242526&gt;&gt;&gt; import itertools&gt;&gt;&gt; animals = ['duck', 'eagle', 'rat', 'giraffe', 'bear', 'bat', 'dolphin', 'shark', 'lion']&gt;&gt;&gt; animals.sort(key=len)&gt;&gt;&gt; animals['rat', 'bat', 'duck', 'bear', 'lion', 'eagle', 'shark', 'giraffe', 'dolphin']&gt;&gt;&gt; for length, group in itertools.groupby(animals, len):... print(length, '-&gt;', list(group))...3 -&gt; ['rat', 'bat']4 -&gt; ['duck', 'bear', 'lion']5 -&gt; ['eagle', 'shark']7 -&gt; ['giraffe', 'dolphin']&gt;&gt;&gt;&gt;&gt;&gt; g1, g2 = itertools.tee('ABC')&gt;&gt;&gt; next(g1)'A'&gt;&gt;&gt; next(g2)'A'&gt;&gt;&gt; next(g2)'B'&gt;&gt;&gt; list(g1)['B', 'C']&gt;&gt;&gt; list(g2)['C']&gt;&gt;&gt; list(zip(*itertools.tee('ABC')))[('A', 'A'), ('B', 'B'), ('C', 'C')] PSï¼šitertools.groupby å‡å®šè¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡å·²æŒ‰ç…§åˆ†ç»„æ ‡å‡†å®ŒæˆæŽ’åº è¯»å–è¿­ä»£å™¨ï¼Œè¿”å›žå•ä¸ªå€¼çš„å‡½æ•° æ¨¡å— å‡½æ•° è¯´æ˜Ž å†…ç½® all(it) it ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸå€¼æ—¶è¿”å›ž Trueï¼Œå¦åˆ™è¿”å›ž Falseï¼›all([]) è¿”å›ž True å†…ç½® any(it) åªè¦ it ä¸­æœ‰å…ƒç´ ä¸ºçœŸå€¼å°±è¿”å›ž Trueï¼Œå¦åˆ™è¿”å›ž Falseï¼›any([]) è¿”å›ž False å†…ç½® max(it, [key=], [default=]) è¿”å›ž it ä¸­å€¼æœ€å¤§çš„å…ƒç´ ï¼›key æ˜¯æŽ’åºå‡½æ•°ï¼Œä¸Ž sorted ä¸­çš„ä¸€æ ·ï¼›è‹¥å¯è¿­ä»£å¯¹è±¡ä¸ºç©ºï¼Œè¿”å›ž default å†…ç½® min(it, [key=], [default=]) è¿”å›ž it ä¸­å€¼æœ€å°çš„å…ƒç´ ï¼›key æ˜¯æŽ’åºå‡½æ•°ï¼›è‹¥å¯è¿­ä»£å¯¹è±¡ä¸ºç©ºï¼Œè¿”å›ž default functools reduce(func, it, [initial]) æŠŠå‰ä¸¤ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œç„¶åŽæŠŠè®¡ç®—ç»“æžœå’Œç¬¬ä¸‰ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œè¿”å›žæœ€åŽçš„ç»“æžœã€‚è‹¥æä¾›äº† initialï¼Œåˆ™å°†å…¶ä½œä¸ºç¬¬ä¸€ä¸ªå…ƒç´ ä¼ å…¥ å†…ç½® sum(it, start=0) it ä¸­æ‰€æœ‰å…ƒç´ çš„æ€»å’Œï¼Œè‹¥æä¾›å¯é€‰çš„ startï¼Œä¼šæŠŠå®ƒä¹ŸåŠ ä¸Š 1234567891011121314&gt;&gt;&gt; all([1, 2, 3])True&gt;&gt;&gt; all([1, 0, 3])False&gt;&gt;&gt; all([])True&gt;&gt;&gt; any([1, 2, 3])True&gt;&gt;&gt; any([1, 0, 3])True&gt;&gt;&gt; any([0, 0.0])False&gt;&gt;&gt; any([])False 123456&gt;&gt;&gt; import functools&gt;&gt;&gt; functools.reduce(lambda a, b: a * b, range(1, 6))120&gt;&gt;&gt; import operator&gt;&gt;&gt; functools.reduce(operator.mul, range(1, 6))120 å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Functional</tag>
        <tag>Generator</tag>
        <tag>Iterator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¸Žæ•°æ®ç»“æž„ â€”â€” åŸºäºŽæ•°ç»„çš„åºåˆ—ç±»åž‹]]></title>
    <url>%2F2020%2F10%2F13%2Fpython-and-data-structure-array-based-list%2F</url>
    <content type="text"><![CDATA[Python ä¸­çš„åºåˆ—ç±»åž‹åŒ…å«å†…ç½®çš„ listã€tupleã€str ç­‰ï¼Œå®ƒä»¬æœ‰å¾ˆå¤šæ˜Žæ˜¾çš„å…±åŒç‚¹ã€‚æ¯”å¦‚éƒ½æ”¯æŒé€šè¿‡ç´¢å¼•è¯­æ³•ï¼ˆseq[k]ï¼‰èŽ·å–åºåˆ—ä¸­çš„æŸä¸ªç‰¹å®šå…ƒç´ ï¼›åº•å±‚çš„ç»“æž„éƒ½æ˜¯ç”¨æ•°ç»„æ¥å®žçŽ°çš„ã€‚ Low-Level Arrayè®¡ç®—æœºç³»ç»Ÿä¸€èˆ¬éƒ½åŒ…å«æœ‰æ•°é‡åºžå¤§çš„å†…å­˜ç©ºé—´ï¼Œä¸ºäº†è·Ÿè¸ªå…·ä½“æŸæ®µæ•°æ®å®žé™…çš„å­˜å‚¨ä½ç½®ï¼Œè®¡ç®—æœºåŠ å…¥äº†ç§°ä¸ºå†…å­˜åœ°å€ï¼ˆmemory addressï¼‰çš„æŠ½è±¡å½¢å¼ã€‚æ¯ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´éƒ½ä¼šå…³è”ä¸€ä¸ªç‹¬ç‰¹çš„æ•°å­—ä½œä¸ºå…¶åœ°å€ã€‚ è®¡ç®—æœºçš„å†…å­˜ä¸º random access memory (RAM)ï¼Œå³ä»»æ„ä¸€ä¸ª byte å†…å­˜çš„è¯»å–ä¸Žå†™å…¥è€—è´¹çš„æ—¶é—´éƒ½æ˜¯ O(1)ã€‚ é€šå¸¸æ¥è¯´ï¼Œç¼–ç¨‹è¯­è¨€ä¼šè·Ÿè¸ªæ¯ä¸€ä¸ªæ ‡è¯†ç¬¦åŠå…¶å¯¹åº”çš„å€¼çš„ä½ç½®ï¼ˆå†…å­˜åœ°å€ï¼‰ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œä¸€ç»„ç›¸å…³è”çš„å˜é‡åˆ™å¯ä»¥ä¿å­˜åœ¨ä¸€æ®µè¿žç»­çš„å†…å­˜ä¸­ï¼Œå³æ•°ç»„ï¼ˆarrayï¼‰ã€‚æ¯”å¦‚å­—ç¬¦ä¸²å®žé™…ä¸Šæ˜¯ç”±ç‹¬ç«‹çš„å­—ç¬¦ç»„æˆçš„æœ‰åºçš„åºåˆ—ï¼š æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å æ®åŒæ ·å¤§å°çš„å­˜å‚¨ç©ºé—´ï¼Œä½¿å¾—ä»»æ„ä¸€ä¸ªå…ƒç´ çš„è®¿é—®å’Œæ›´æ–°éƒ½å¯ä»¥é€šè¿‡ç´¢å¼•ä»¥å¸¸é‡çš„æ—¶é—´å®Œæˆã€‚ å­˜å‚¨å¼•ç”¨çš„æ•°ç»„å‡å¦‚éœ€è¦ç”¨æ•°ç»„ä¿å­˜å¦‚ä¸‹çš„ä¸€ä¸ªå§“ååˆ—è¡¨ï¼š[Rene, Joseph, Janet, Jonas, Helen, Virginia, ...] ä½¿ç”¨æ•°ç»„çš„è¯ï¼Œåˆ™éœ€è¦ç¡®ä¿æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å æ®åŒæ ·çš„å†…å­˜å¤§å°ã€‚ä½†å­—ç¬¦ä¸²æœ¬èº«å…·æœ‰å·®å¼‚å¾ˆå¤§çš„é•¿åº¦ã€‚å½“ç„¶å¯ä»¥å°è¯•ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½åˆ†é…è¶³å¤Ÿå¤§çš„å†…å­˜ç©ºé—´ï¼Œä¿è¯å³ä½¿æœ€é•¿çš„å­—ç¬¦ä¸²ä¹Ÿä¸ä¼šè¶…å‡ºï¼Œä½†è¿™æ ·å¿…ç„¶ä¼šå¯¼è‡´å†…å­˜çš„æµªè´¹ã€‚ Python çš„æ–¹æ¡ˆæ˜¯åœ¨ list æˆ– tuple ä¸­ä¸ä¿å­˜å­—ç¬¦ä¸²å¯¹è±¡æœ¬èº«è€Œæ˜¯ä¿å­˜å…¶å¼•ç”¨ã€‚å³åˆ—è¡¨ä¸­åªæ˜¯åŒ…å«ä¸€ç³»åˆ—å†…å­˜åœ°å€ï¼Œæ¯ä¸€ä¸ªåœ°å€éƒ½æŒ‡å‘å¯¹åº”å…ƒç´ å®žé™…çš„å­˜å‚¨ä½ç½®ã€‚ å³ä¾¿æ¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤§å°å¹¶ä¸ç›¸åŒï¼Œåˆ—è¡¨ä¸­ä¿å­˜çš„å­—ç¬¦ä¸²çš„å†…å­˜åœ°å€å´éƒ½æ˜¯å›ºå®šçš„ï¼ˆ64bitï¼‰ã€‚ ç”±äºŽ list å’Œ tuple ä¸­ä¿å­˜çš„æ˜¯å¼•ç”¨ï¼Œå¯¼è‡´åŒä¸€ä¸ªå¯¹è±¡æœ‰å¯èƒ½æˆä¸ºå¤šä¸ª list ä¸­æŸä¸ªå…ƒç´ çš„å®žä½“ã€‚æ¯”å¦‚å¯¹æŸä¸ª list æ‰§è¡Œåˆ†ç‰‡æ“ä½œåŽï¼Œåˆ†ç‰‡ä¸­çš„å…ƒç´ å®žé™…ä¸Šå’Œæ¯åˆ—è¡¨ä¸­å¯¹åº”çš„å…ƒç´ æŒ‡å‘åŒæ ·çš„å¯¹è±¡ã€‚å¦‚ temp = primes[3:6]ï¼š è‹¥å¯¹åˆ†ç‰‡ä¸­çš„æŸä¸ªå…ƒç´ é‡æ–°èµ‹å€¼ï¼Œåˆ™ç›´æŽ¥å°†è¯¥å…ƒç´ æ›¿æ¢ä¸ºæ–°çš„å†…å­˜åœ°å€ï¼ˆæŒ‡å‘æ–°å¯¹è±¡ï¼‰å³å¯ï¼Œå¦‚æ‰§è¡Œ temp[2] = 15ï¼š ä¸€ä¸ªæ›´æ˜¾è‘—çš„ä¾‹å­å¦‚ counters = [0] * 8ï¼Œç”Ÿæˆçš„ counters åˆ—è¡¨ä¸­çš„ 8 ä¸ªæ•°å­— 0 å®žé™…ä¸Šéƒ½æŒ‡å‘äº†åŒä¸€ä¸ªæ•°å­—å¯¹è±¡ã€‚è¿™ç§æ–¹å¼åˆçœ‹ä¸ŠåŽ»å¾ˆå®¹æ˜“å‡ºçŽ°æ··ä¹±ï¼Œä½†æ˜¯å¾—ç›ŠäºŽæ•°å­—æœ¬èº«æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå³ä½¿ä¸ºæ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ é‡æ–°èµ‹å€¼ï¼ˆæ¯”å¦‚ counters[2] = 1ï¼‰ï¼Œä¹Ÿåªæ˜¯å°†å½“å‰ä½ç½®ä¿å­˜çš„å¯¹æ•°å­— 0 çš„å¼•ç”¨æ›¿æ¢ä¸ºæŒ‡å‘æ–°çš„æ•°å­— 1 çš„å¼•ç”¨ã€‚è€ŒåŽŸæ•°å­— 0 æœ¬èº«ä¸å‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œå³æ•°ç»„ä¸­æŒ‡å‘æ•°å­— 0 çš„å…¶ä»–å…ƒç´ ä¸å—ä»»ä½•å½±å“ã€‚ å­˜å‚¨æ•°å€¼çš„æ•°ç»„å‰é¢æåˆ°è¿‡å­—ç¬¦ä¸²æ˜¯ä¸€ç§å­˜å‚¨ä¸€ç³»åˆ—å­—ç¬¦ï¼ˆè€Œä¸æ˜¯è¿™äº›å­—ç¬¦çš„åœ°å€ï¼‰çš„åºåˆ—ï¼Œè¿™ç§æ›´ç›´æŽ¥çš„å½¢å¼ç§°ä¸º compact arrayã€‚å®ƒç›¸å¯¹äºŽå‰é¢çš„å­˜å‚¨å¼•ç”¨çš„æ•°ç»„æœ‰ç€æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œä¸”éœ€è¦æ›´å°‘çš„å†…å­˜ã€‚ æ¯”å¦‚å­˜å‚¨ä¸€ä¸ªåŒ…å«ä¸€ç™¾ä¸‡ä¸ª 64-bit æ•´æ•°çš„åºåˆ—ï¼Œç†è®ºä¸Šåªéœ€è¦ 64 MB çš„å†…å­˜ã€‚å®žé™…ä¸Š Python é‡Œçš„ list éœ€è¦ 4 åˆ° 5 å€çš„å®¹é‡åŽ»å‚¨å­˜è¿™äº›å€¼ã€‚æ­¤å¤–å¯¹äºŽè®¡ç®—è€Œè¨€ï¼Œcompact array å°†æœ‰å…³è”çš„æ•°æ®ç›´æŽ¥ä¿å­˜åœ¨ä¸€æ®µè¿žç»­çš„å†…å­˜ä¸­ï¼Œå®¹æ˜“èŽ·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚ åŠ¨æ€æ•°ç»„åœ¨åˆ›å»º low-level æ•°ç»„æ—¶ï¼Œå…¶å¤§å°å¿…é¡»ç²¾ç¡®åœ°ã€æ˜¾å¼åœ°å£°æ˜Žï¼Œä»Žè€Œä½¿ç³»ç»Ÿå¯ä»¥ä¸ºå…¶åˆ†é…é€‚å½“çš„å†…å­˜ç©ºé—´ã€‚ä½†æ˜¯è¿™äº›å†…å­˜é™„è¿‘çš„ç©ºé—´æœ‰å¯èƒ½æä¾›ç»™å…¶ä»–æ•°æ®ç”¨äºŽå‚¨å­˜ï¼Œå› æ­¤æ•°ç»„åœ¨åˆå§‹åŒ–åŽå…¶å®¹é‡ä¸€èˆ¬æ˜¯å›ºå®šçš„ï¼Œå…¶ä¸­ä¿å­˜çš„å…ƒç´ çš„æ•°é‡ä¸èƒ½è¶…è¶Šè¿™ä¸ªé™åˆ¶ã€‚ Python çš„ list ç±»é‡‡ç”¨äº†ä¸€ç§ç§°ä¸º dynamic array çš„æœºåˆ¶ï¼Œä½¿å…¶çœ‹ä¸ŠåŽ»æ²¡æœ‰é•¿åº¦çš„é™åˆ¶ï¼Œå…¶å®¹é‡å¯ä»¥éšç€å…ƒç´ çš„æ·»åŠ ä¸æ–­åœ°å¢žé•¿ã€‚list å®žä¾‹ä¼šåœ¨åº•å±‚ç»´æŠ¤ç€ä¸€ä¸ªå®¹é‡æ¯”å½“å‰ list æ›´å¤§çš„æ•°ç»„ï¼Œè¿™ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„ä½¿å¾—ä¸º list æ·»åŠ å…ƒç´ å˜å¾—æ–¹ä¾¿å¾ˆå¤šã€‚å½“å…ƒç´ æ•°é‡æŒç»­å¢žé•¿ç›´åˆ°æ•°ç»„ä¸­é¢„ç•™çš„ç©ºé—´ä¹Ÿè¦è¢«ç”¨å°½æ—¶ï¼Œlist ä¼šç”³è¯·ä¸€ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„æ›¿ä»£ä¹‹å‰å®¹é‡è¾ƒå°çš„æ•°ç»„ï¼Œæ—§çš„æ•°ç»„åˆ™è¢«ç³»ç»Ÿå›žæ”¶ã€‚ æµ‹è¯•ä»£ç ï¼š123456789import sysdata = []for count in range(20): data.append(None) length = len(data) size = sys.getsizeof(data) print('Length: &#123;0:3d&#125;; Size in bytes: &#123;1:4d&#125;'.format(length, size)) è¾“å‡ºç»“æžœï¼š1234567891011121314151617181920Length: 1; Size in bytes: 88Length: 2; Size in bytes: 88Length: 3; Size in bytes: 88Length: 4; Size in bytes: 88Length: 5; Size in bytes: 120Length: 6; Size in bytes: 120Length: 7; Size in bytes: 120Length: 8; Size in bytes: 120Length: 9; Size in bytes: 184Length: 10; Size in bytes: 184Length: 11; Size in bytes: 184Length: 12; Size in bytes: 184Length: 13; Size in bytes: 184Length: 14; Size in bytes: 184Length: 15; Size in bytes: 184Length: 16; Size in bytes: 184Length: 17; Size in bytes: 256Length: 18; Size in bytes: 256Length: 19; Size in bytes: 256Length: 20; Size in bytes: 256 å¯ä»¥çœ‹å‡ºéšç€æ•°ç»„é•¿åº¦çš„å¢žåŠ ï¼Œå…¶å æ®çš„å†…å­˜ç©ºé—´ä¸æ˜¯æˆæ¯”ä¾‹è€Œæ˜¯åˆ†æ®µåœ°è¿›è¡Œæ‰©å±•çš„ã€‚ åŠ¨æ€æ•°ç»„çš„ Python å®žçŽ°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import ctypesclass DynamicArray: def __init__(self): self._n = 0 self._capacity = 1 self._A = self._make_array(self._capacity) def __len__(self): return self._n def __getitem__(self, k): if not 0 &lt;= k &lt; self._n: raise IndexError('invalid index') return self._A[k] def append(self, obj): if self._n == self._capacity: self._resize(2 * self._capacity) self._A[self._n] = obj self._n += 1 def _resize(self, c): B = self._make_array(c) for k in range(self._n): B[k] = self._A[k] self._A = B self._capacity = c def _make_array(self, c): return (c * ctypes.py_object)() def insert(self, k, value): if self._n == self._capacity: self._resize(2 * self._capacity) for j in range(self._n, k, -1): self._A[j] = self._A[j - 1] self._A[k] = value self._n += 1 def remove(self, value): for k in range(self._n): if self._A[k] == value: for j in range(k, self._n - 1): self._A[j] = self._A[j + 1] self._A[self._n - 1] = None self._n -= 1 return raise ValueError('value not found') Python ä¸­ List çš„æ€§èƒ½ æ“ä½œ æ—¶é—´ len(data) O(1) data[j] O(1) data.count(value) O(n) data.index(value) O(k + 1)ï¼Œk æŒ‡ä»Žå·¦èµ· value ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ä½ç½® value in data O(k + 1)ï¼Œk æŒ‡ä»Žå·¦èµ· value ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ä½ç½® data1 == data2 O(k + 1)ï¼Œæ­¤å¤„ k æŒ‡ä»Žå·¦èµ·ç¬¬ä¸€æ¬¡å‡ºçŽ°ä¸åŒå…ƒç´ çš„ä½ç½® data[j:k] O(k - j + 1)ï¼Œj å’Œ k æŒ‡åˆ†ç‰‡çš„èµ·æ­¢ä½ç½® data1 + data2 O(n1 + n2) c * data O(cn) data[j] = val O(1) data.append(value) O(1) data.insert(k, value) O(n - k + 1) data.pop() O(1) data.pop(k) O(n - k) data1 += data2 O(n2) data.reverse() O(n) data.sort() O(nlogn) å‚è€ƒèµ„æ–™Data Structures and Algorithms in Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>List</tag>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¸Žæ•°æ®ç»“æž„ â€”â€” é“¾è¡¨åŠå…¶åº”ç”¨]]></title>
    <url>%2F2020%2F10%2F13%2Fpython-and-data-structure-linked-list%2F</url>
    <content type="text"><![CDATA[list çš„å±€é™Python çš„ list ç±»æ˜¯ç»è¿‡é«˜åº¦ä¼˜åŒ–çš„ï¼Œåœ¨éœ€è¦å­˜å‚¨æ•°æ®æ—¶æ˜¯ä¸€ä¸ªå¾ˆä¼˜ç§€çš„é€‰æ‹©ã€‚ä½†ä»æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„çš„åŠ£åŠ¿ï¼š åŠ¨æ€æ•°ç»„çš„é•¿åº¦é€šå¸¸ä¼šå¤§äºŽå®žé™…å­˜å‚¨çš„å…ƒç´ çš„æ•°é‡ å½“å­˜å‚¨çš„å…ƒç´ æ•°é‡ä¸æ–­å¢žé•¿æ—¶ï¼ŒåŠ¨æ€æ•°ç»„æ‰©å±•è¾¹ç•Œçš„æ€§èƒ½è¾ƒä½Ž é è¿‘æ•°ç»„ä¸­é—´ä½ç½®çš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ€§èƒ½ç›¸å¯¹è¾ƒä½Ž åŸºäºŽæ•°ç»„çš„åºåˆ—å’Œé“¾è¡¨éƒ½èƒ½å¤Ÿä»¥ç‰¹å®šé¡ºåºå­˜å‚¨å…ƒç´ ï¼Œä½†æ˜¯å„è‡ªå®žçŽ°çš„æ–¹å¼å·®å¼‚å¾ˆå¤§ã€‚æ•°ç»„æä¾›äº†ä¸€ç§æ›´ä¸ºâ€œä¸­å¿ƒåŒ–â€çš„è¡¨ç¤ºæ–¹å¼ï¼Œç”¨ä¸€å¤§æ®µè¿žç»­çš„å†…å­˜å­˜å‚¨å¤šä¸ªå…ƒç´ çš„å¼•ç”¨ï¼›è€Œé“¾è¡¨åˆ™æ›´ä¸ºâ€œåˆ†æ•£åŒ–â€ï¼Œå°†æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸ºè½»é‡çš„èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤ç€åŒ…å«å…ƒç´ æœ¬èº«åŠä¸€ä¸ªæˆ–å¤šä¸ªç›¸é‚»èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œé€šè¿‡å¼•ç”¨å°†å¤šä¸ªèŠ‚ç‚¹æœ€ç»ˆè¿žæŽ¥æˆçº¿æ€§é¡ºåºçš„åºåˆ—ã€‚ é“¾è¡¨æ— æ³•é«˜æ•ˆåœ°é€šè¿‡æ•°å­—ç´¢å¼•è¯»å–å…¶ä¸­å…ƒç´ çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥é¿å…å‰é¢æåˆ°è¿‡çš„åŸºäºŽæ•°ç»„çš„åºåˆ—çš„ä¸‰ç‚¹åŠ£åŠ¿ã€‚ å•é“¾è¡¨å•é“¾è¡¨æ˜¯æœ€ç®€å•çš„ä¸€ç§å½¢å¼ï¼Œç»„æˆçº¿æ€§åºåˆ—çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«å…ƒç´ æœ¬èº«åŠä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ã€‚ ç¬¬ä¸€ä¸ªå’Œæœ€åŽä¸€ä¸ªèŠ‚ç‚¹åˆ†åˆ«ç§°ä¸º head å’Œ tailã€‚ä»Ž head èŠ‚ç‚¹å¼€å§‹ï¼Œè·Ÿéšæ¯ä¸ªèŠ‚ç‚¹çš„ next å¼•ç”¨ä»Žé¦–èŠ‚ç‚¹ä¸€ç›´ç§»åŠ¨åˆ°å°¾éƒ¨èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå³ä¸ºé“¾è¡¨éåŽ†ã€‚ å‘é“¾è¡¨å¤´éƒ¨æ’å…¥æ–°å…ƒç´ çš„æ­¥éª¤ï¼š åˆ›å»ºåŒ…å«æ–°å…ƒç´ çš„æ–°çš„èŠ‚ç‚¹å¯¹è±¡ å°†æ–°èŠ‚ç‚¹çš„ next å¼•ç”¨æŒ‡å‘å½“å‰çš„ head èŠ‚ç‚¹ å°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºé“¾è¡¨çš„æ–° head èŠ‚ç‚¹ å‘é“¾è¡¨å°¾éƒ¨æ’å…¥æ–°å…ƒç´ çš„æ­¥éª¤ï¼š åˆ›å»ºä¸€ä¸ªåŒ…å«æ–°å…ƒç´ çš„æ–°çš„èŠ‚ç‚¹ å°†æ–°èŠ‚ç‚¹çš„ next å¼•ç”¨æŒ‡å‘ None ä½œä¸ºæ–°çš„ tail èŠ‚ç‚¹ å°†å½“å‰ tail èŠ‚ç‚¹çš„ next å¼•ç”¨æ”¹ä¸ºæŒ‡å‘ä¸Šé¢çš„æ–°èŠ‚ç‚¹ é€šè¿‡å•é“¾è¡¨å®žçŽ° Stack æ•°æ®ç»“æž„12345678910111213141516171819202122232425262728293031323334353637383940# linkstack.pyclass EmptyError(Exception): passclass Node: __slots__ = '_element', '_next' def __init__(self, element, next): self._element = element self._next = nextclass LinkedStack: def __init__(self): self._head = None self._size = 0 def __len__(self): return self._size def is_empty(self): return self._size == 0 def push(self, e): self._head = Node(e, self._head) self._size += 1 def top(self): if self.is_empty(): raise EmptyError('Stack is empty') return self._head._element def pop(self): if self.is_empty(): raise EmptyError('Stack is empty') answer = self._head._element self._head = self._head._next self._size -= 1 return answer è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516171819&gt;&gt;&gt; from linkstack import LinkedStack&gt;&gt;&gt; s = LinkedStack()&gt;&gt;&gt; s.push(1)&gt;&gt;&gt; s.push(2)&gt;&gt;&gt; s.push(3)&gt;&gt;&gt; len(s)3&gt;&gt;&gt; s.pop()3&gt;&gt;&gt; s.pop()2&gt;&gt;&gt; s.pop()1&gt;&gt;&gt; s.pop()Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "/home/starky/program/python/algorithm/linkstack.py", line 35, in pop raise EmptyError('Stack is empty')linkstack.EmptyError: Stack is empty æ€§èƒ½ æ“ä½œ æ—¶é—´ S.push(e) O(1) S.pop() O(1) S.top() O(1) len(S) O(1) S.is_empty() O(1) å•é“¾è¡¨å®žçŽ° Queue æ•°æ®ç»“æž„1234567891011121314151617181920212223242526272829303132333435363738394041424344454647class Node: __slots__ = '_element', '_next' def __init__(self, element, next): self._element = element self._next = nextclass EmptyError(Exception): passclass LinkedQueue: def __init__(self): self._head = None self._tail = None self._size = 0 def __len__(self): return self._size def is_empty(self): return self._size == 0 def first(self): if self.is_empty(): raise EmptyError('Queue is empty') return self._head._element def dequeue(self): if self.is_empty(): raise EmptyError('Queue is empty') answer = self._head._element self._head = self._head._next self._size -= 1 if self.is_empty(): self._tail = None return answer def enqueue(self, e): newest = Node(e, None) if self.is_empty(): self._head = newest else: self._tail._next = newest self._tail = newest self._size += 1 è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516171819&gt;&gt;&gt; from linkqueue import LinkedQueue&gt;&gt;&gt; q = LinkedQueue()&gt;&gt;&gt; q.enqueue(1)&gt;&gt;&gt; q.enqueue(2)&gt;&gt;&gt; q.enqueue(3)&gt;&gt;&gt; len(q)3&gt;&gt;&gt; q.dequeue()1&gt;&gt;&gt; q.dequeue()2&gt;&gt;&gt; q.dequeue()3&gt;&gt;&gt; q.dequeue()Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "/home/starky/program/python/algorithm/linkqueue.py", line 32, in dequeue raise EmptyError('Queue is empty')linkqueue.EmptyError: Queue is empty åŒé“¾è¡¨ å›¾ä¸­çš„ header å’Œ trailer èŠ‚ç‚¹å®žé™…ä¸Šä¸ä¿å­˜ä»»ä½•å…ƒç´ ï¼Œè¿™äº›â€œdummyâ€èŠ‚ç‚¹ç§°ä¸º sentinelsã€‚ç›®çš„æ˜¯ä¿è¯é€»è¾‘çš„ä¸€è‡´æ€§ï¼Œå³ä»»ä½•æƒ…å†µä¸‹æ’å…¥æ–°èŠ‚ç‚¹ï¼Œéƒ½èƒ½ç¡®ä¿å…¶å·¦å³ä¸¤è¾¹è‡³å°‘å„æœ‰ä¸€ä¸ªæ—§èŠ‚ç‚¹ã€‚ æ’å…¥æ–°èŠ‚ç‚¹ç¤ºæ„å›¾ï¼š ä»£ç å®žçŽ°ï¼š12345678910111213141516171819202122232425262728293031323334353637383940# doublylinked.pyclass Node: __slots__ = '_element', '_prev', '_next' def __init__(self, element, prev, next): self._element = element self._prev = prev self._next = nextclass DoublyLinkedBase: def __init__(self): self._header = Node(None, None, None) self._trailer = Node(None, None, None) self._header._next = self._trailer self._trailer._prev = self._header self._size = 0 def __len__(self): return self._size def is_empty(self): return self._size == 0 def _insert_between(self, e, predecessor, successor): newest = Node(e, predecessor, successor) predecessor._next = newest successor._prev = newest self._size += 1 return newest def _delete_node(self, node): predecessor = node._prev successor = node._next predecessor._next = successor successor._prev = predecessor self._size -= 1 element = node._element node._prev = node._next = node._element = None return element åŒé“¾è¡¨å®žçŽ° Deque æ•°æ®ç»“æž„12345678910111213141516171819202122232425262728293031323334# linkdeque.pyfrom doublylinked import DoublyLinkedBaseclass EmptyError(Exception): passclass LinkedDeque(DoublyLinkedBase): def first(self): if self.is_empty(): raise EmptyError("Deque is empty") return self._header._next._element def last(self): if self.is_empty(): raise Empty("Deque is empty") return self._trailer._prev._element def insert_first(self, e): self._insert_between(e, self._header, self._header._next) def insert_last(self, e): self._insert_between(e, self._trailer._prev, self._trailer) def delete_first(self): if self.is_empty(): raise EmptyError("Deque is empty") return self._delete_node(self._header._next) def delete_last(self): if self.is_empty(): raise EmptyError("Deque is empty") return self._delete_node(self._trailer._prev) è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š1234567891011121314&gt;&gt;&gt; from linkdeque import LinkedDeque&gt;&gt;&gt; dq = LinkedDeque()&gt;&gt;&gt; dq.insert_first(2)&gt;&gt;&gt; dq.insert_first(1)&gt;&gt;&gt; dq.insert_last(3)&gt;&gt;&gt; dq.insert_last(4)&gt;&gt;&gt; len(dq)4&gt;&gt;&gt; dq.delete_first()1&gt;&gt;&gt; dq.delete_last()4&gt;&gt;&gt; len(dq)2 Link-Based vs. Array-BasedArray-Based åºåˆ—çš„ä¼˜åŠ¿ï¼š æä¾› O(1) æ—¶é—´ä¸‹åŸºäºŽæ•´æ•°ç´¢å¼•ï¼ˆindexï¼‰å¯¹å…ƒç´ çš„è®¿é—®ã€‚è€Œé“¾è¡¨è®¿é—®ç¬¬ k ä¸ªå…ƒç´ åˆ™éœ€è¦ O(k) æ—¶é—´ï¼ˆä»Žé“¾è¡¨å¤´éƒ¨å¼€å§‹éåŽ†ï¼‰ åœ¨ä¸è€ƒè™‘åŠ¨æ€æ•°ç»„è¾¹ç•Œæ‰©å±•çš„æƒ…å†µä¸‹ï¼Œå„ç§æ“ä½œåœ¨åŸºäºŽæ•°ç»„çš„åºåˆ—ä¸­æ€§èƒ½æ›´é«˜ï¼ˆæ­¥éª¤ç›¸å¯¹è¾ƒå°‘ï¼‰ï¼Œè™½ç„¶æ•´ä½“ä¸Šå’Œé“¾è¡¨ä¸€æ ·æ—¶é—´éƒ½æ˜¯ O(1) ä¸Žé“¾è¡¨ç»“æž„ç›¸æ¯”ï¼ŒåŸºäºŽæ•°ç»„çš„åºåˆ—éœ€è¦æ›´å°‘çš„å†…å­˜ã€‚åŸºäºŽæ•°ç»„æˆ–é“¾è¡¨çš„åºåˆ—å®žé™…ä¸Šä¿å­˜çš„éƒ½æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤è¿™éƒ¨åˆ†å æ®çš„å†…å­˜ç©ºé—´æ˜¯ä¸€è‡´çš„ã€‚æ•°ç»„åœ¨æœ€å·®çš„æƒ…å†µä¸‹ï¼ˆå³åˆšåˆšæ‰©å±•è¿‡è¾¹ç•Œçš„åŠ¨æ€æ•°ç»„ï¼‰éœ€è¦ä¸º 2n ä¸ªå¯¹è±¡å¼•ç”¨æ”¶é›†å†…å­˜ï¼›è€Œå•é“¾è¡¨æœ¬èº«å°±éœ€è¦ä¸º 2n ä¸ªå¯¹è±¡å¼•ç”¨æä¾›ç©ºé—´ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«å…ƒç´ æœ¬èº«å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼‰ï¼ŒåŒé“¾è¡¨åˆ™ä¸º 3n Link-Based åºåˆ—çš„ä¼˜åŠ¿ï¼š é“¾è¡¨ç»“æž„èƒ½å¤Ÿæ”¯æŒä»»æ„ä½ç½®ä¸‹æ’å…¥å’Œåˆ é™¤æ“ä½œåªè€—è´¹ O(1) æ—¶é—´ã€‚è€ŒåŸºäºŽæ•°ç»„çš„åºåˆ—åœ¨å°¾éƒ¨æ’å…¥å’Œåˆ é™¤å…ƒç´ æ˜¯å¸¸æ•°æ—¶é—´ï¼Œåœ¨ä»»æ„ç´¢å¼•ä¸º k çš„ä½ç½®æ’å…¥æˆ–ç§»é™¤å…ƒç´ åˆ™éœ€è¦ O(n - k + 1) æ—¶é—´ã€‚ å‚è€ƒèµ„æ–™Data Structures and Algorithms in Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>List</tag>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®° â€”â€” å¯¹è±¡å¼•ç”¨ã€å¯å˜æ€§åŠå…¶å½±å“]]></title>
    <url>%2F2020%2F10%2F12%2Ffluent-python-object-reference-and-mutation%2F</url>
    <content type="text"><![CDATA[åˆ«åPython ä¸­çš„å˜é‡ç±»ä¼¼äºŽ Java ä¸­çš„å¼•ç”¨å¼å˜é‡ï¼Œå¯ä»¥ç†è§£ä¸ºé™„åŠ åœ¨å¯¹è±¡ä¸Šçš„â€œæ ‡æ³¨â€ã€‚ æ¯”å¦‚ä¸‹é¢ä»£ç ä¸­çš„å˜é‡ a å’Œ b å®žé™…ä¸ŠæŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨ï¼š12345&gt;&gt;&gt; a = [1, 2, 3]&gt;&gt;&gt; b = a&gt;&gt;&gt; a.append(4)&gt;&gt;&gt; b[1, 2, 3, 4] å¯¹äºŽå¼•ç”¨å¼å˜é‡çš„èµ‹å€¼ï¼Œâ€œæŠŠå˜é‡åˆ†é…ç»™å¯¹è±¡â€çš„è¯´æ³•æ›´ä¸ºåˆç†ã€‚å³èµ‹å€¼è¯­å¥çš„å³è¾¹å…ˆæ‰§è¡Œï¼Œå³ä¾§äº§ç”Ÿçš„å¯¹è±¡åœ¨èµ‹å€¼å‰å°±å·²ç»åˆ›å»ºäº†ã€‚ å°è¯•è¿è¡Œä»¥ä¸‹ä»£ç ï¼š12345678910111213&gt;&gt;&gt; class Gizmo:... def __init__(self):... print(f'Gizmo id: &#123;id(self)&#125;')...&gt;&gt;&gt; x = Gizmo()Gizmo id: 140497327120880&gt;&gt;&gt; y = Gizmo() * 10Gizmo id: 140497327319840Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: unsupported operand type(s) for *: 'Gizmo' and 'int'&gt;&gt;&gt; dir()['Gizmo', '__annotations__', '__builtins__', '__doc__', '__loader__', '__name__', '__package__', '__spec__', 'x'] è¾“å‡ºçš„ Gizmo id: ... æ˜¯åˆ›å»º Gizmo å®žä¾‹æ—¶çš„å‰¯ä½œç”¨ã€‚å› æ­¤ y = Gizmo() * 10 å®žé™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Gizmo å®žä¾‹ï¼Œä½†ç»ä¸ä¼šåˆ›å»ºå˜é‡ yã€‚å› ä¸ºèµ‹å€¼è¯­å¥å³ä¾§åœ¨æ±‚å€¼æ—¶æŠ›å‡ºäº†å¼‚å¸¸ã€‚å› æ­¤åœ¨èµ‹å€¼è¯­å¥ä¸­ï¼Œå¯¹è±¡åœ¨å³è¾¹åˆ›å»ºæˆ–èŽ·å–ï¼Œä¹‹åŽå·¦è¾¹çš„å˜é‡æ‰ä¼šç»‘å®šç»™å¯¹è±¡ã€‚ç±»ä¼¼äºŽç»™å¯¹è±¡è´´æ ‡ç­¾ï¼Œè´´çš„å¤šä¸ªæ ‡ç­¾å°±æ˜¯åˆ«åã€‚ ç›¸ç­‰æ€§ä¸¤ä¸ªå˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼š123456789&gt;&gt;&gt; charles = &#123;'name': 'Charles L. Dodgson', 'born': 1832&#125;&gt;&gt;&gt; lewis = charles&gt;&gt;&gt; lewis is charlesTrue&gt;&gt;&gt; id(charles), id(lewis)(140497326642048, 140497326642048)&gt;&gt;&gt; lewis['balance'] = 950&gt;&gt;&gt; charles&#123;'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950&#125; lewis æ˜¯ charles çš„åˆ«åï¼Œä¸¤è€…æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚ alex ç»‘å®šå…·æœ‰åŒæ ·å†…å®¹çš„å¦ä¸€ä¸ªå¯¹è±¡ï¼š12345&gt;&gt;&gt; alex = &#123;'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950&#125;&gt;&gt;&gt; alex == charlesTrue&gt;&gt;&gt; alex is charlesFalse åˆ™ alex æŒ‡ä»£çš„å¯¹è±¡ä¸Žèµ‹å€¼ç»™ charles çš„å¯¹è±¡å†…å®¹ä¸€æ ·ï¼Œä½†ä¸¤è€…ç»‘å®šçš„æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚ æ¯ä¸ªå˜é‡éƒ½æœ‰æ ‡è¯†ã€ç±»åž‹å’Œå€¼ã€‚å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå…¶æ ‡è¯†ç»ä¸ä¼šå˜ã€‚å¯ä»¥å°†æ ‡è¯†ç†è§£ä¸ºå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚is è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ ‡è¯†ï¼Œid() å‡½æ•°è¿”å›žå¯¹è±¡æ ‡è¯†çš„æ•´æ•°è¡¨ç¤ºã€‚ == ä¸Ž is çš„é€‰æ‹©== ç”¨äºŽæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å€¼ï¼ˆå¯¹è±¡ä¸­ä¿å­˜çš„æ•°æ®ï¼‰ï¼Œè€Œ is æ¯”è¾ƒå¯¹è±¡çš„æ ‡è¯†ã€‚é€šå¸¸åœ¨æ¯”è¾ƒæ—¶å…³æ³¨çš„æ˜¯å€¼è€Œä¸æ˜¯æ ‡è¯†ï¼Œå› æ­¤ == å‡ºçŽ°çš„å‡ çŽ‡æ¯” is è¦é«˜ã€‚ ä½†åœ¨å˜é‡å’Œå•ä¾‹å€¼ä¹‹é—´æ¯”è¾ƒæ—¶ï¼Œåº”ä½¿ç”¨ isã€‚æ¯”å¦‚ç”¨ is æ£€æŸ¥å˜é‡ç»‘å®šçš„å€¼æ˜¯ä¸æ˜¯ Noneï¼šx is None æˆ– x is not Noneã€‚åŽŸå› æ˜¯ is è¿ç®—ç¬¦æ¯” == é€Ÿåº¦æ›´å¿«ã€‚å› ä¸ºå®ƒä¸èƒ½é‡è½½ï¼ŒPython ä¸ç”¨å¯»æ‰¾å¹¶è°ƒç”¨ç‰¹æ®Šæ–¹æ³•ï¼Œè€Œæ˜¯ç›´æŽ¥æ¯”è¾ƒä¸¤ä¸ªæ•´æ•° IDã€‚è€Œ a == b æ˜¯ a.__eq__(b) çš„è¯­æ³•ç³–ã€‚å¤šæ•°å†…ç½®ç±»åž‹ä½¿ç”¨æ›´æœ‰æ„ä¹‰çš„æ–¹å¼è¦†ç›–äº† __eq__ æ–¹æ³•ï¼Œå› æ­¤ç›¸ç­‰æ€§æµ‹è¯•å¯èƒ½æ¶‰åŠå¤§é‡å¤„ç†å·¥ä½œã€‚ å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§å…ƒç»„ä¸­ä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚å³ä¾¿å…ƒç»„æœ¬èº«ä¸å¯å˜ï¼Œè‹¥å…ƒç´ å¼•ç”¨çš„å¯¹è±¡æ˜¯å¯å˜çš„ï¼Œåˆ™è¯¥å…ƒç´ ä¾ç„¶å¯å˜ã€‚å³å…ƒç»„çš„ä¸å¯å˜æ€§æŒ‡çš„æ˜¯ tuple æ•°æ®ç»“æž„çš„ç‰©ç†å†…å®¹ï¼ˆå³ä¿å­˜çš„å¼•ç”¨ï¼‰ä¸å¯å˜ï¼Œä¸Žå¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æ— å…³ã€‚ 12345678910111213&gt;&gt;&gt; t1 = (1, 2, [30, 40])&gt;&gt;&gt; t2 = (1, 2, [30, 40])&gt;&gt;&gt; t1 == t2True&gt;&gt;&gt; id(t1[-1])140497326641856&gt;&gt;&gt; t1[-1].append(99)&gt;&gt;&gt; t1(1, 2, [30, 40, 99])&gt;&gt;&gt; id(t1[-1])140497326641856&gt;&gt;&gt; t1 == t2False å…ƒç»„çš„å€¼ä¼šéšç€å…¶ä¸­å…ƒç´ å¼•ç”¨çš„å¯å˜å¯¹è±¡çš„å˜åŒ–è€Œå˜åŒ–ã€‚å…ƒç»„ä¸­ä¸å¯å˜çš„æ˜¯å…ƒç´ çš„æ ‡è¯†ã€‚ æµ…å¤åˆ¶ä¸Žæ·±å¤åˆ¶èµ‹å€¼åˆ—è¡¨ï¼ˆæˆ–å¤šæ•°å†…ç½®çš„å…¶ä»–å¯å˜é›†åˆï¼‰æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ç±»åž‹æž„é€ æ–¹æ³•ã€‚12345678&gt;&gt;&gt; l1 = [3, [55, 44], (7, 8, 9)]&gt;&gt;&gt; l2 = list(l1)&gt;&gt;&gt; l2[3, [55, 44], (7, 8, 9)]&gt;&gt;&gt; l2 == l1True&gt;&gt;&gt; l2 is l1False list(l1) ä¼šåˆ›å»º l1 çš„å‰¯æœ¬ã€‚å‰¯æœ¬ä¸Žæºåˆ—è¡¨ç›¸ç­‰ï¼Œä½†ä¸¤è€…å®žé™…æŒ‡å‘ä¸åŒçš„å¯¹è±¡ã€‚è¿˜å¯ä»¥ä½¿ç”¨åŒæ ·æ•ˆæžœçš„ l2 = l1[:] è¯­å¥ã€‚ ä½†æ˜¯ï¼Œlist æž„é€ æ–¹æ³•å’Œ [:] åšçš„éƒ½æ˜¯æµ…å¤åˆ¶ï¼Œå³åªå¤åˆ¶æœ€å¤–å±‚çš„å®¹å™¨ï¼Œå‰¯æœ¬ä¸­çš„å…ƒç´ æ˜¯æºå®¹å™¨ä¸­å…ƒç´ çš„å¼•ç”¨ã€‚è‹¥æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œåˆ™æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œè¿˜å¯ä»¥èŠ‚çœå†…å­˜ï¼›è‹¥å®¹å™¨ä¸­å­˜åœ¨å¯å˜çš„å…ƒç´ ï¼Œåˆ™æœ‰å¯èƒ½å¯¼è‡´æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚12345678910111213141516171819202122&gt;&gt;&gt; l1 = [3, [66, 55, 44], (7, 8, 9)]&gt;&gt;&gt; l2 = list(l1)&gt;&gt;&gt; l1.append(100)&gt;&gt;&gt; l1[3, [66, 55, 44], (7, 8, 9), 100]&gt;&gt;&gt; l2[3, [66, 55, 44], (7, 8, 9)]&gt;&gt;&gt; l1[1].remove(55)&gt;&gt;&gt; l1[3, [66, 44], (7, 8, 9), 100]&gt;&gt;&gt; l2[3, [66, 44], (7, 8, 9)]&gt;&gt;&gt; l2[1] += [33, 22]&gt;&gt;&gt; l1[3, [66, 44, 33, 22], (7, 8, 9), 100]&gt;&gt;&gt; l2[3, [66, 44, 33, 22], (7, 8, 9)]&gt;&gt;&gt; l2[2] += (10, 11)&gt;&gt;&gt; l2[3, [66, 44, 33, 22], (7, 8, 9, 10, 11)]&gt;&gt;&gt; l1[3, [66, 44, 33, 22], (7, 8, 9), 100] l2 æ˜¯ l1 çš„æµ…å¤åˆ¶å‰¯æœ¬ï¼Œä½†æ˜¯äºŒè€…å¼•ç”¨åŒä¸€ä¸ªåˆ—è¡¨ [66, 55, 44] å’ŒåŒä¸€ä¸ªå…ƒç»„ (7, 8, 9) æŠŠ 100 è¿½åŠ åˆ° l1 ä¸­ï¼Œå¯¹ l2 æ²¡æœ‰ä»»ä½•å½±å“ æŠŠå†…éƒ¨åˆ—è¡¨ l1[1] ä¸­çš„ 55 ç§»é™¤ï¼Œl2 ä¹Ÿä¼šå‡ºçŽ°åŒæ ·çš„æ”¹åŠ¨ã€‚åŽŸå› æ˜¯ l2[1] ä¸Ž l1[1] ç»‘å®šçš„æ˜¯åŒä¸€ä¸ªåˆ—è¡¨ åŒæ ·çš„ï¼Œl2[1] å¼•ç”¨çš„åˆ—è¡¨é€šè¿‡ += è¿ç®—ç¬¦å°±åœ°ä¿®æ”¹åˆ—è¡¨ï¼Œè¿™æ ·çš„ä¿®æ”¹ä¹Ÿä¼šåœ¨ l1[1] ä¸­ä½“çŽ° å¯¹å…ƒç»„æ¥è¯´ï¼Œ+= è¿ç®—ç¬¦ä¼šåˆ›å»ºä¸€ä¸ªæ–°å…ƒç»„é‡æ–°ç»‘å®šç»™å˜é‡ l2[2]ï¼Œç­‰åŒäºŽ l2[2] = l2[2] + (10, 11)ï¼Œå› æ­¤æœ€ç»ˆçŠ¶æ€ä¸‹ l1 å’Œ l2 ä¸­çš„å…ƒç»„ä¸å†æ˜¯åŒä¸€ä¸ªå¯¹è±¡ å¯¹è‡ªå®šä¹‰å¯¹è±¡åšæ·±å¤åˆ¶å’Œæµ…å¤åˆ¶12345678910111213# bus.pyclass Bus: def __init__(self, passengers=None): if passengers is None: self.passengers = [] else: self.passengers = list(passengers) def pick(self, name): self.passengers.append(name) def drop(self, name): self.passengers.remove(name) 1234567891011121314&gt;&gt;&gt; from bus import Bus&gt;&gt;&gt; import copy&gt;&gt;&gt; bus1 = Bus(['Alice', 'Bill', 'Claire', 'David'])&gt;&gt;&gt; bus2 = copy.copy(bus1)&gt;&gt;&gt; bus3 = copy.deepcopy(bus1)&gt;&gt;&gt; id(bus1), id(bus2), id(bus3)(140247402065344, 140247402153680, 140247380561296)&gt;&gt;&gt; bus1.drop('Bill')&gt;&gt;&gt; bus2.passengers['Alice', 'Claire', 'David']&gt;&gt;&gt; id(bus1.passengers), id(bus2.passengers), id(bus3.passengers)(140247380615936, 140247380615936, 140247401717056)&gt;&gt;&gt; bus3.passengers['Alice', 'Bill', 'Claire', 'David'] ä½¿ç”¨ copy å’Œ deepcopy åˆ›å»º 3 ä¸ªä¸åŒçš„ Bus å®žä¾‹ã€‚bus1 ä¸­çš„ Bill ä¸‹è½¦åŽï¼Œbus2 ä¸­ä¹Ÿæ²¡æœ‰ä»–äº†ã€‚åŽŸå› æ˜¯ bus2 æ˜¯ bus1 çš„æµ…å¤åˆ¶å‰¯æœ¬ï¼Œä»–ä»¬å…±äº«åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡ã€‚bus3 æ˜¯ bus1 çš„æ·±å¤åˆ¶å‰¯æœ¬ï¼Œå…¶ passengers å±žæ€§æŒ‡å‘å¦ä¸€ä¸ªä¸åŒçš„åˆ—è¡¨å¯¹è±¡ã€‚ å‡½æ•°å‚æ•°ä½œä¸ºå¼•ç”¨Python å”¯ä¸€æ”¯æŒçš„å‚æ•°ä¼ é€’æ¨¡å¼æ˜¯å…±äº«ä¼ å‚ï¼Œå¤šæ•°é¢å‘å¯¹è±¡è¯­è¨€éƒ½é‡‡ç”¨è¿™ä¸€æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸­ï¼Œå‡½æ•°å†…éƒ¨çš„å½¢å‚æ˜¯å®žå‚çš„åˆ«åã€‚ä¸Šè¿°æ–¹æ¡ˆå¯¼è‡´å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹ä½œä¸ºå‚æ•°ä¼ å…¥çš„å¯å˜å¯¹è±¡ï¼Œè™½ç„¶æ— æ³•ä¿®æ”¹é‚£äº›å¯¹è±¡çš„æ ‡è¯†ï¼ˆå³ä¸èƒ½æŠŠä¸€ä¸ªå¯¹è±¡æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚ å¦‚ä¸‹é¢è¿™ä¸ªç®€å•çš„å‡½æ•°ï¼Œåœ¨å‚æ•°ä¸Šè°ƒç”¨ +=ï¼Œåˆ†åˆ«å°†æ•°å­—ã€åˆ—è¡¨ã€å…ƒç»„ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š1234567891011121314151617181920&gt;&gt;&gt; def f(a, b):... a += b... return a...&gt;&gt;&gt; x = 1&gt;&gt;&gt; y = 2&gt;&gt;&gt; f(x, y)3&gt;&gt;&gt; a = [1, 2]&gt;&gt;&gt; b = [3, 4]&gt;&gt;&gt; f(a, b)[1, 2, 3, 4]&gt;&gt;&gt; a, b([1, 2, 3, 4], [3, 4])&gt;&gt;&gt; t = (10, 20)&gt;&gt;&gt; u = (30, 40)&gt;&gt;&gt; f(t, u)(10, 20, 30, 40)&gt;&gt;&gt; t, u((10, 20), (30, 40)) ä¸å¯å˜çš„æ•°å­— x å’Œå…ƒç»„ t éƒ½æ²¡å˜ï¼Œè€Œå¯å˜å¯¹è±¡åˆ—è¡¨ a å˜äº†ã€‚ å¯å˜ç±»åž‹ä½œä¸ºå‚æ•°é»˜è®¤å€¼å‡½æ•°çš„å¯é€‰å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œä½†æ˜¯åº”å°½é‡é¿å…ä½¿ç”¨å¯å˜å¯¹è±¡ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼ã€‚ 123456789class HauntedBus: def __init__(self, passengers=[]): self.passengers = passengers def pick(self, name): self.passengers.append(name) def drop(self, name): self.passengers.remove(name) 123456789101112131415161718&gt;&gt;&gt; from hauntedbus import HauntedBus&gt;&gt;&gt; bus1 = HauntedBus(['Alice', 'Bill'])&gt;&gt;&gt; bus1.passengers['Alice', 'Bill']&gt;&gt;&gt; bus2 = HauntedBus()&gt;&gt;&gt; bus2.pick('Carrie')&gt;&gt;&gt; bus2.passengers['Carrie']&gt;&gt;&gt; bus3 = HauntedBus()&gt;&gt;&gt; bus3.passengers['Carrie']&gt;&gt;&gt; bus3.pick('Dave')&gt;&gt;&gt; bus2.passengers['Carrie', 'Dave']&gt;&gt;&gt; bus2.passengers is bus3.passengersTrue&gt;&gt;&gt; bus1.passengers['Alice', 'Bill'] ä¸Šè¿°çš„ä»£ç è¡¨æ˜Žï¼Œbus2.passengers å’Œ bus3.passengers æŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œ bus1.passengers æ˜¯ä¸åŒçš„åˆ—è¡¨ã€‚å³æ²¡æœ‰æŒ‡å®šåˆå§‹ä¹˜å®¢çš„ HauntedBus å®žä¾‹ä¼šå…±äº«åŒä¸€ä¸ªä¹˜å®¢åˆ—è¡¨ã€‚è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºŽï¼Œå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æ˜¯åœ¨å®šä¹‰å‡½æ•°æ—¶è®¡ç®—çš„ï¼Œå› æ­¤è¯¥é»˜è®¤å€¼æˆä¸ºäº†å‡½æ•°å¯¹è±¡çš„å±žæ€§ã€‚å› æ­¤ self.passengers å˜æˆäº† passengers å‚æ•°é»˜è®¤å€¼ï¼ˆå¯å˜çš„åˆ—è¡¨å¯¹è±¡ï¼‰çš„åˆ«åï¼Œå¯¼è‡´åŽç»­çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šå—åˆ°å½±å“ã€‚1234&gt;&gt;&gt; HauntedBus.__init__.__defaults__(['Carrie', 'Dave'],)&gt;&gt;&gt; HauntedBus.__init__.__defaults__[0] is bus2.passengersTrue å‡½æ•°å¯¹å¯å˜å‚æ•°çš„ä¿®æ”¹å¦‚æžœå®šä¹‰çš„å‡½æ•°æŽ¥æ”¶å¯å˜å‚æ•°ï¼Œåº”è°¨æ…Žè€ƒè™‘è°ƒç”¨æ–¹æ˜¯å¦æœŸæœ›ä¿®æ”¹ä¼ å…¥çš„å‚æ•°ã€‚æ¯”å¦‚å‡½æ•°æŽ¥æ”¶ä¸€ä¸ªå­—å…¸ï¼Œä¸”åœ¨å¤„ç†è¿‡ç¨‹ä¸­è¦ä¿®æ”¹å®ƒï¼Œåˆ™è¯¥å‰¯ä½œç”¨æ˜¯å¦è¦ä½“çŽ°åˆ°å‡½æ•°å¤–éƒ¨ï¼Ÿ å¦‚ä¸‹é¢çš„ TwilightBus å®žä¾‹ï¼š123456789101112class TwilightBus: def __init__(self, passengers=None): if passengers is None: self.passengers = [] else: self.passengers = passengers def pick(self, name): self.passengers.append(name) def drop(self, name): self.passengers.remove(name) 1234567&gt;&gt;&gt; from twilightbus import TwilightBus&gt;&gt;&gt; basketball_team = ['Sue', 'Tina', 'Maya', 'Diana', 'Pat']&gt;&gt;&gt; bus = TwilightBus(basketball_team)&gt;&gt;&gt; bus.drop('Tina')&gt;&gt;&gt; bus.drop('Pat')&gt;&gt;&gt; basketball_team['Sue', 'Maya', 'Diana'] basketball_team ä¸­æœ‰ 5 åå­¦ç”Ÿï¼Œä½¿ç”¨è¿™é˜Ÿå­¦ç”Ÿå®žä¾‹åŒ– TwilightBusã€‚ä¸¤ä¸ªå­¦ç”Ÿä»Ž bus ä¸‹è½¦åŽï¼Œè¿™ä¸¤äººå°±ä»Žç¯®çƒé˜Ÿï¼ˆbasketball_teamï¼‰ä¸­æ¶ˆå¤±äº†ã€‚ ä»£ç ä¸­ self.passengers = passengers èµ‹å€¼è¯­å¥æŠŠ self.passengers å˜æˆ passengers çš„åˆ«åï¼Œè€ŒåŽè€…æ˜¯ä¼ ç»™ __init__ æ–¹æ³•çš„å®žå‚ï¼ˆå³ basketball_teamï¼‰çš„åˆ«åã€‚å¯¼è‡´åœ¨ self.passengers ä¸Šè°ƒç”¨ .remove() å’Œ .append() æ–¹æ³•å®žé™…ä¸Šä¼šä¿®æ”¹ä¼ ç»™æž„é€ æ–¹æ³•çš„åˆ—è¡¨ï¼ˆbasketball_teamï¼‰ã€‚æ­£ç¡®çš„åšäº‹æ˜¯ï¼Œæ ¡è½¦ç»´æŠ¤è‡ªå·±çš„ä¹˜å®¢åˆ—è¡¨ã€‚å³åœ¨ __init__ ä¸­ï¼Œåº”è¯¥æŠŠ passengers å‚æ•°å€¼çš„å‰¯æœ¬èµ‹å€¼ç»™ self.passengersã€‚12345def __init__(self, passengers=None): if passengers is None: self.passengers = [] else: self.passengers = list(passengers) å°ç»“å˜é‡ä¿å­˜çš„æ˜¯å¼•ç”¨ï¼Œæ­¤ç§è¡Œä¸ºå¯¹ Python ç¼–ç¨‹æœ‰å¾ˆå¤šå®žé™…å½±å“ï¼š ç®€å•çš„èµ‹å€¼æ“ä½œä¸ä¼šåˆ›å»ºå‰¯æœ¬ å¯¹äºŽ += æˆ– *= çš„å¢žé‡èµ‹å€¼ï¼Œè‹¥å·¦è¾¹å˜é‡ç»‘å®šçš„æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œåˆ™ä¼šåˆ›å»ºæ–°å¯¹è±¡ï¼›è‹¥å·¦è¾¹æ˜¯å¯å˜å¯¹è±¡ï¼Œåˆ™å°±åœ°ä¿®æ”¹è¯¥å¯å˜å¯¹è±¡ ä¸ºçŽ°æœ‰å˜é‡èµ‹äºˆæ–°å€¼ï¼Œä¸ä¼šç›´æŽ¥ä¿®æ”¹ä¹‹å‰ç»‘å®šçš„å˜é‡å€¼ã€‚è€Œæ˜¯åˆ›å»ºæ–°çš„å¯¹è±¡å¹¶ç»‘å®šç»™å˜é‡ï¼ˆé‡æ–°ç»‘å®šï¼‰ å‡½æ•°å‚æ•°ä»¥åˆ«åçš„å½¢å¼ä¼ é€’ï¼Œæ„å‘³ç€å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹é€šè¿‡å‚æ•°ä¼ å…¥çš„å¯å˜å¯¹è±¡ã€‚é™¤éžåœ¨æœ¬åœ°åˆ›å»ºå¯å˜å¯¹è±¡çš„å‰¯æœ¬ ä½¿ç”¨å¯å˜ç±»åž‹ä½œç”¨å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æœ‰ä¸€å®šé£Žé™©ã€‚è‹¥å°±åœ°ä¿®æ”¹äº†å‚æ•°ï¼Œåˆ™é»˜è®¤å€¼ä¹Ÿä¼šæ”¹å˜ï¼Œè¿›è€Œå½±å“ä»¥åŽä½¿ç”¨é»˜è®¤å€¼çš„è°ƒç”¨ å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Mutation</tag>
        <tag>Reference</tag>
        <tag>Object</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fluent Python ç¬”è®°â€”â€”åºåˆ—ç±»åž‹åŠå…¶ä¸°å¯Œçš„æ“ä½œ]]></title>
    <url>%2F2020%2F10%2F12%2Ffluent-python-list-and-its-operation%2F</url>
    <content type="text"><![CDATA[åºåˆ—çš„åˆ†ç±»Python æ ‡å‡†åº“ç”¨ C è¯­è¨€å®žçŽ°äº†ä¸°å¯Œçš„åºåˆ—ç±»åž‹çš„æ•°æ®ç»“æž„ï¼Œå¦‚ï¼š å®¹å™¨åºåˆ—ï¼ˆèƒ½å­˜æ”¾ä¸åŒç±»åž‹çš„æ•°æ®ï¼‰ï¼šlistã€tupleã€collections.deque ç­‰ æ‰å¹³åºåˆ—ï¼ˆåªå®¹çº³åŒä¸€ç±»åž‹çš„æ•°æ®ï¼‰ï¼šstrã€bytesã€bytearrayã€memoryviewã€array.array 12&gt;&gt;&gt; a_list = [1, '2', True, [1, 2, 3], 4.5]&gt;&gt;&gt; a_str = 'helloworld' å®¹å™¨åºåˆ—å­˜æ”¾çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰å¹³åºåˆ—å­˜æ”¾çš„æ˜¯å€¼ã€‚å³æ‰å¹³åºåˆ—æ˜¯ä¸€æ®µè¿žç»­çš„å†…å­˜ç©ºé—´ã€‚123456789&gt;&gt;&gt; a_list = [1, '2', True, [1, 2, 3], 4.5]&gt;&gt;&gt; embedded_list = a_list[3]&gt;&gt;&gt; embedded_list[1, 2, 3]&gt;&gt;&gt; embedded_list.append(4)&gt;&gt;&gt; embedded_list[1, 2, 3, 4]&gt;&gt;&gt; a_list[1, '2', True, [1, 2, 3, 4], 4.5] åºåˆ—è¿˜å¯ä»¥æŒ‰ç…§æ˜¯å¦å¯å˜ï¼ˆèƒ½å¤Ÿè¢«ä¿®æ”¹ï¼‰è¿›è¡Œåˆ†ç±»ï¼š å¯å˜åºåˆ—ï¼šlistã€bytearrayã€array.arrayã€collections.dequeã€memoryview ä¸å¯å˜åºåˆ—ï¼štupleã€strã€bytes 123456789&gt;&gt;&gt; a_list = [1, 2, 3]&gt;&gt;&gt; a_list[0] = 2&gt;&gt;&gt; a_list[2, 2, 3]&gt;&gt;&gt; a_tuple = (1, 2, 3)&gt;&gt;&gt; a_tuple[0] = 2Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: 'tuple' object does not support item assignment åˆ—è¡¨æŽ¨å¯¼for å¾ªçŽ¯ï¼š1234567&gt;&gt;&gt; symbols = '!@#$%'&gt;&gt;&gt; codes = []&gt;&gt;&gt; for symbol in symbols:... codes.append(ord(symbol))...&gt;&gt;&gt; codes[33, 64, 35, 36, 37] åˆ—è¡¨æŽ¨å¯¼ï¼š1234&gt;&gt;&gt; symbols = '!@#$%'&gt;&gt;&gt; codes = [ord(symbol) for symbol in symbols]&gt;&gt;&gt; codes[33, 64, 35, 36, 37] é€šå¸¸çš„åŽŸåˆ™æ˜¯ï¼Œåªç”¨åˆ—è¡¨æŽ¨å¯¼åˆ›å»ºæ–°çš„åˆ—è¡¨ï¼Œå¹¶å°½é‡ä¿æŒç®€çŸ­ã€‚ åˆ—è¡¨æŽ¨å¯¼ï¼ˆåŒ…æ‹¬é›†åˆæŽ¨å¯¼ã€å­—å…¸æŽ¨å¯¼ï¼‰ã€ç”Ÿæˆå™¨è¡¨è¾¾å¼åœ¨ Python3 ä¸­æœ‰è‡ªå·±çš„å±€éƒ¨ä½œç”¨åŸŸã€‚123456&gt;&gt;&gt; x = 'ABC'&gt;&gt;&gt; dummy = [ord(x) for x in x]&gt;&gt;&gt; x'ABC'&gt;&gt;&gt; dummy[65, 66, 67] åˆ—è¡¨æŽ¨å¯¼ä¸Ž filter/map çš„æ¯”è¾ƒï¼š1234567&gt;&gt;&gt; symbols = '$Â¢Â£Â¥â‚¬Â¤'&gt;&gt;&gt; beyond_ascii = [ord(s) for s in symbols if ord(s) &gt; 127]&gt;&gt;&gt; beyond_ascii[162, 163, 165, 8364, 164]&gt;&gt;&gt; beyond_ascii = list(filter(lambda c: c &gt; 127, map(ord, symbols)))&gt;&gt;&gt; beyond_ascii[162, 163, 165, 8364, 164] ä½œä¸ºè®°å½•çš„å…ƒç»„å…ƒç»„å…¶å®žæ˜¯ä¸€ç§æ•°æ®è®°å½•ï¼ˆRecordï¼‰ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¯¹åº”è®°å½•ä¸­ä¸€ä¸ªå­—æ®µçš„æ•°æ®ï¼Œå­—æ®µåœ¨å…ƒç»„ä¸­çš„ä½ç½®åˆ™å¯ä»¥ç”¨æ¥åŒºåˆ†å…¶å«ä¹‰ã€‚123456789&gt;&gt;&gt; lax_coordinates = (33.9425, -118.408056)&gt;&gt;&gt; city, year, pop, area = ('Tokyo', 2003, 32450, 8014)&gt;&gt;&gt; traveler_ids = [('USA', '31195855'), ('BRA', 'CE342567'), ('ESP', 'XDA205856')]&gt;&gt;&gt; for country, _ in traveler_ids:... print(country)...USABRAESP å…ƒç»„æ‹†åŒ…å…ƒç»„æ‹†åŒ…å¯ä»¥åº”ç”¨åˆ°ä»»ä½•å¯è¿­ä»£å¯¹è±¡ä¸Šï¼Œå”¯ä¸€çš„è¦æ±‚å³å¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ æ•°é‡ä¸ŽæŽ¥æ”¶è¿™äº›å…ƒç´ çš„ç©ºæ¡£æ•°ä¸€è‡´ï¼ˆé™¤éžç”¨ * å¿½ç•¥å¤šä½™çš„å…ƒç´ ï¼‰ã€‚ å…ƒç»„æ‹†åŒ…ï¼ˆå¹³è¡Œèµ‹å€¼ï¼‰ï¼š123456&gt;&gt;&gt; lax_coordinates = (33.9425, -118.408056)&gt;&gt;&gt; latitude, longitude = lax_coordinates&gt;&gt;&gt; latitude33.9425&gt;&gt;&gt; longitude-118.408056 ä¸ä½¿ç”¨ä¸­é—´å˜é‡äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼š1234567&gt;&gt;&gt; a = 1&gt;&gt;&gt; b = 2&gt;&gt;&gt; a, b = b, a&gt;&gt;&gt; a2&gt;&gt;&gt; b1 ä½¿ç”¨ * è¿ç®—ç¬¦æŠŠä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ‹†å¼€ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼š12345&gt;&gt;&gt; divmod(20, 8)(2, 4)&gt;&gt;&gt; t = (20, 8)&gt;&gt;&gt; divmod(*t)(2, 4) å…ƒç»„æ‹†åŒ…å¯ä»¥æ–¹ä¾¿ä¸€ä¸ªå‡½æ•°ä»¥å…ƒç»„çš„æ–¹å¼è¿”å›žå¤šä¸ªå€¼ï¼Œè°ƒç”¨å‡½æ•°çš„ä»£ç å°±å¯ä»¥è½»æ¾åœ°ï¼ˆæœ‰é€‰æ‹©åœ°ï¼‰æŽ¥å—è¿™äº›å€¼ã€‚1234&gt;&gt;&gt; import os&gt;&gt;&gt; _, filename = os.path.split('/home/luciano/.ssh/idrsa.pub')&gt;&gt;&gt; filename'idrsa.pub' ç”¨ * å¤„ç†å¤šä½™çš„å…ƒç´ ï¼š123456789101112&gt;&gt;&gt; a, b, *rest = range(5)&gt;&gt;&gt; a, b, rest(0, 1, [2, 3, 4])&gt;&gt;&gt; a, b, *rest = range(3)&gt;&gt;&gt; a, b, rest(0, 1, [2])&gt;&gt;&gt; a, b, *rest = range(2)&gt;&gt;&gt; a, b, rest(0, 1, [])&gt;&gt;&gt; a, *body, c, d = range(5)&gt;&gt;&gt; a, body, c, d(0, [1, 2], 3, 4) å…·åå…ƒç»„collections.namedtuple å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¸¦å­—æ®µåçš„å…ƒç»„å’Œä¸€ä¸ªæœ‰åå­—çš„ç±»ï¼Œä¾¿äºŽå¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•ã€‚å…¶ç±»å®žä¾‹æ¶ˆè€—çš„å†…å­˜ä¸Žå…ƒç»„æ˜¯ä¸€æ ·çš„ï¼Œè·Ÿæ™®é€šçš„å¯¹è±¡å®žä¾‹ç›¸æ¯”æ›´å°ä¸€äº›ï¼ˆä¸ç”¨ __dict__ å­˜æ”¾å®žä¾‹çš„å±žæ€§ï¼‰ã€‚1234567891011&gt;&gt;&gt; from collections import namedtuple&gt;&gt;&gt; City = namedtuple('City', 'name country population coordinates')&gt;&gt;&gt; tokyo = City('Tokyo', 'JP', 36.933, (35.689722, 139.691667))&gt;&gt;&gt; tokyoCity(name='Tokyo', country='JP', population=36.933, coordinates=(35.689722, 139.691667))&gt;&gt;&gt; tokyo.population36.933&gt;&gt;&gt; tokyo.coordinates(35.689722, 139.691667)&gt;&gt;&gt; tokyo[1]'JP' åˆ›å»ºå…·åå…ƒç»„éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç±»åï¼Œç¬¬äºŒä¸ªæ˜¯ç±»çš„å„ä¸ªå­—æ®µçš„åç§°ã€‚åŽè€…å¯ä»¥æ˜¯å¤šä¸ªå­—ç¬¦ä¸²ç»„æˆçš„å¯è¿­ä»£å¯¹è±¡æˆ–ç”±ç©ºæ ¼åˆ†éš”å¼€çš„å­—æ®µåç»„æˆçš„å­—ç¬¦ä¸²ã€‚å¯ä»¥é€šè¿‡å­—æ®µåæˆ–ä½ç½®èŽ·å–æŸä¸ªå­—æ®µçš„ä¿¡æ¯ã€‚ å…·åå…ƒç»„çš„ _fields å±žæ€§åŒ…å«ç”±è¿™ä¸ªç±»ä¸­æ‰€æœ‰å­—æ®µåç§°ç»„æˆçš„å…ƒç»„ï¼›_asdict() æ–¹æ³•å¯ä»¥æŠŠå…·åå…ƒç»„ä»¥ collections.OrderedDict çš„å½¢å¼è¿”å›žã€‚ åˆ‡ç‰‡å…³äºŽåˆ‡ç‰‡å’ŒåŒºé—´å¿½ç•¥æœ€åŽä¸€ä¸ªå…ƒç´ åœ¨åˆ‡ç‰‡å’ŒåŒºé—´æ“ä½œé‡Œä¸åŒ…å«æœ€åŽä¸€ä¸ªå…ƒç´ æ˜¯ Python çš„é£Žæ ¼ï¼ŒåŒæ—¶ä¹Ÿç¬¦åˆ C å’Œå…¶ä»–ä»¥ 0 ä¸ºèµ·å§‹ä¸‹æ ‡çš„è¯­è¨€çš„ä¹ æƒ¯ã€‚éƒ¨åˆ†åŽŸå› å¦‚ä¸‹ï¼š å½“åªæœ‰æœ€åŽä¸€ä¸ªä½ç½®ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å¿«é€Ÿçœ‹å‡ºåŒºé—´é‡ŒåŒ…å«å¤šå°‘ä¸ªå…ƒç´ ï¼šrange(3) å’Œ my_list[:3] éƒ½è¿”å›ž 3 ä¸ªå…ƒç´  èµ·æ­¢ä½ç½®éƒ½å¯è§æ—¶ï¼Œå¯ä»¥å¿«é€Ÿç®—å‡ºåŒºé—´çš„é•¿åº¦ï¼ˆstop - startï¼‰ï¼Œå¦‚åˆ‡ç‰‡ my_list[3:6] å³åŒ…å« 6 - 3 = 3 ä¸ªå…ƒç´  å¯ä»¥åˆ©ç”¨ä»»æ„ä¸€ä¸ªä¸‹æ ‡æŠŠåºåˆ—åˆ†å‰²æˆä¸é‡å çš„ä¸¤éƒ¨åˆ†ï¼ˆmy_list[:x] å’Œ my_list[x:]ï¼‰ stepå¯ä»¥ç”¨ s[a:b:c] çš„å½¢å¼å¯¹ s åœ¨ a å’Œ b ä¹‹é—´ä»¥ c ä¸ºé—´éš”å–å€¼ã€‚c å€¼è¿˜å¯ä»¥ä¸ºè´Ÿï¼Œè¡¨ç¤ºåå‘å–å€¼ã€‚1234567&gt;&gt;&gt; s = 'bicycle'&gt;&gt;&gt; s[::3]'bye'&gt;&gt;&gt; s[::-1]'elcycib'&gt;&gt;&gt; s[::-2]'eccb' å¯¹ seq[start:stop:step] æ±‚å€¼æ—¶ï¼ŒPython ä¼šè°ƒç”¨ seq.__getitem__(slice(start, stop, step))ã€‚ å¯¹åˆ‡ç‰‡èµ‹å€¼å¦‚æžœæŠŠåˆ‡ç‰‡æ”¾åœ¨èµ‹å€¼è¯­å¥å·¦è¾¹ï¼Œæˆ–æŠŠå®ƒä½œä¸º del æ“ä½œçš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥å¯¹åˆ‡ç‰‡æ‰€å±žçš„åºåˆ—è¿›è¡Œæ‹¼æŽ¥ã€åˆ‡é™¤æˆ–å°±åœ°ä¿®æ”¹ç­‰æ“ä½œã€‚123456789101112131415&gt;&gt;&gt; l = list(range(10))&gt;&gt;&gt; l[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]&gt;&gt;&gt; l[2:5] = [20, 30]&gt;&gt;&gt; l[0, 1, 20, 30, 5, 6, 7, 8, 9]&gt;&gt;&gt; del l[5:7]&gt;&gt;&gt; l[0, 1, 20, 30, 5, 8, 9]&gt;&gt;&gt; l[3::2] = [11, 22]&gt;&gt;&gt; l[0, 1, 20, 11, 5, 22, 9]&gt;&gt;&gt; l[2:5] = [100]&gt;&gt;&gt; l[0, 1, 100, 22, 9] éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¯¹åˆ‡ç‰‡è¿›è¡Œèµ‹å€¼æ“ä½œæ—¶ï¼Œèµ‹å€¼è¯­å¥çš„å³ä¾§å¿…é¡»æ˜¯ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚ å¯¹åºåˆ—ä½¿ç”¨ + å’Œ *Python ç¨‹åºå‘˜ä¸€èˆ¬é»˜è®¤åºåˆ—éƒ½ä¼šæ”¯æŒ + å’Œ * çš„æ‹¼æŽ¥æ“ä½œã€‚åœ¨æ‹¼æŽ¥è¿‡ç¨‹ä¸­ï¼Œä¸¤ä¸ªè¢«æ“ä½œçš„åºåˆ—ä¸ä¼šå‘ç”Ÿä»»ä½•æ”¹åŠ¨ï¼ŒPython ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…å«æ‹¼æŽ¥ç»“æžœçš„åºåˆ—ã€‚12345&gt;&gt;&gt; l = [1, 2, 3]&gt;&gt;&gt; l * 5[1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3]&gt;&gt;&gt; 5 * 'abcd''abcdabcdabcdabcdabcd' å¦‚æžœ a * n è¯­å¥ä¸­åºåˆ— a é‡Œçš„å…ƒç´ æ˜¯å¯¹å…¶ä»–å¯å˜å¯¹è±¡çš„å¼•ç”¨çš„è¯ï¼Œè¿™ä¸ªå¼å­çš„ç»“æžœå¯èƒ½ä¼šå‡ºä¹Žæ„æ–™ã€‚æ¯”å¦‚ç”¨ my_list = [[]] * 3 æ¥åˆå§‹åŒ–ä¸€ä¸ªæœ‰åˆ—è¡¨ç»„æˆçš„åˆ—è¡¨ï¼Œå®žé™…ä¸Šå¾—åˆ°çš„åˆ—è¡¨é‡ŒåŒ…å«çš„ä¸‰ä¸ªå…ƒç´ æ˜¯ä¸‰ä¸ªå¼•ç”¨ï¼Œä¸”è¿™ä¸‰ä¸ªå¼•ç”¨éƒ½æŒ‡å‘åŒä¸€åˆ—è¡¨ã€‚123456&gt;&gt;&gt; weird_board = [['-'] * 3] * 3&gt;&gt;&gt; weird_board[['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']]&gt;&gt;&gt; weird_board[1][2] = 'O'&gt;&gt;&gt; weird_board[['-', '-', 'O'], ['-', '-', 'O'], ['-', '-', 'O']] å…¶é”™è¯¯çš„æœ¬è´¨ç­‰åŒäºŽå¦‚ä¸‹ä»£ç ï¼š12345678&gt;&gt;&gt; row = ['-'] * 3&gt;&gt;&gt; board = []&gt;&gt;&gt; for i in range(3):... board.append(row)...&gt;&gt;&gt; board[1][2] = 'O'&gt;&gt;&gt; board[['-', '-', 'O'], ['-', '-', 'O'], ['-', '-', 'O']] å³è¿½åŠ åŒä¸€ä¸ªè¡Œå¯¹è±¡ï¼ˆrowï¼‰åˆ°æ¸¸æˆå¸ï¼ˆboardï¼‰ æ­£ç¡®çš„åšæ³•ä»£ç å¦‚ä¸‹ï¼š123456&gt;&gt;&gt; board = [['-'] * 3 for i in range(3)]&gt;&gt;&gt; board[['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']]&gt;&gt;&gt; board[1][2] = 'O'&gt;&gt;&gt; board[['-', '-', '-'], ['-', '-', 'O'], ['-', '-', '-']] ç­‰åŒäºŽå¦‚ä¸‹ä»£ç ï¼š12345678910&gt;&gt;&gt; board = []&gt;&gt;&gt; for i in range(3):... row = ['-'] * 3... board.append(row)...&gt;&gt;&gt; board[['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']]&gt;&gt;&gt; board[1][2] = 'O'&gt;&gt;&gt; board[['-', '-', '-'], ['-', '-', 'O'], ['-', '-', '-']] å³æ¯æ¬¡è¿­ä»£ä¸­éƒ½æ–°å»ºäº†ä¸€ä¸ªåˆ—è¡¨ï¼Œä½œä¸ºæ–°çš„ä¸€è¡Œï¼ˆrowï¼‰è¿½åŠ åˆ°æ¸¸æˆæ¿å­ï¼ˆboardï¼‰ åºåˆ—çš„å¢žé‡èµ‹å€¼å¢žé‡èµ‹å€¼è¿ç®—ç¬¦ += å’Œ *= çš„è¡Œä¸ºå–å†³äºŽç¬¬ä¸€ä¸ªæ“ä½œå¯¹è±¡ã€‚+= è°ƒç”¨çš„ç‰¹æ®Šæ–¹æ³•æ˜¯ __iadd__ï¼ˆè‡ªå¢žï¼‰ã€‚å¦‚æžœæŸä¸ªç±»æ²¡æœ‰å®žçŽ°è¯¥æ–¹æ³•ï¼ŒPython ä¼šé€€ä¸€æ­¥è°ƒç”¨ __add__ã€‚ å¦‚ a += b å°±ä¼šè°ƒç”¨ a ä¸­å®žçŽ°çš„ __iadd__ æ–¹æ³•ï¼ŒåŒæ—¶å¯¹äºŽå¯å˜åºåˆ—ï¼ˆå¦‚ listã€bytearrayã€array.arrayï¼‰ï¼Œè¯¥æ–¹æ³•çš„è¡Œä¸ºç±»ä¼¼äºŽ a.extend(b)ï¼Œåœ¨ a ä¸Šå°±åœ°æ”¹åŠ¨ã€‚å¦‚ a æ²¡æœ‰å®žçŽ° __iadd__ï¼Œa += b çš„æ•ˆæžœå°±ç±»ä¼¼äºŽ a = a + bï¼Œè®¡ç®— a + b å¾—åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå†æŠŠè¿™ä¸ªå¯¹è±¡èµ‹å€¼ç»™ aã€‚ *= å¯¹åº”çš„æ˜¯ __imul__ã€‚1234567891011121314&gt;&gt;&gt; l = [1, 2, 3]&gt;&gt;&gt; id(l)2888988078920&gt;&gt;&gt; l *= 2&gt;&gt;&gt; l[1, 2, 3, 1, 2, 3]&gt;&gt;&gt; id(l)2888988078920&gt;&gt;&gt; t = (1, 2, 3)&gt;&gt;&gt; id(t)2888988799688&gt;&gt;&gt; t *= 2&gt;&gt;&gt; id(t)2888988107592 ä½œä¸ºå¯å˜å¯¹è±¡çš„åˆ—è¡¨è¿ç”¨å¢žé‡ä¹˜æ³•åŽï¼ŒID æ²¡å˜ï¼›è€Œä½œä¸ºä¸å¯å˜å¯¹è±¡çš„å…ƒç»„è¿ç”¨å¢žé‡ä¹˜æ³•åŽï¼Œæ–°çš„å…ƒç»„è¢«åˆ›å»ºã€‚ å› æ­¤å¯¹äºŽä¸å¯å˜åºåˆ—åšé‡å¤æ‹¼æŽ¥æ“ä½œæ•ˆçŽ‡ä¼šå¾ˆä½Žï¼Œæ¯æ¬¡éƒ½ä¼šæœ‰ä¸€ä¸ªæ–°å¯¹è±¡ã€‚ä½†å­—ç¬¦ä¸²é™¤å¤–ï¼Œç”±äºŽå¯¹å­—ç¬¦ä¸²åš += ç­‰æ“ä½œå¤ªæ™®éï¼ŒCPython ä¸“é—¨åšäº†ä¼˜åŒ–ã€‚åœ¨ä¸ºå­—ç¬¦ä¸²åˆå§‹åŒ–å†…å­˜æ—¶ï¼Œç¨‹åºä¼šé¢„ç•™é¢å¤–çš„å¯æ‰©å±•ç©ºé—´ã€‚ list.sort ä¸Ž sortedlist.sort æ–¹æ³•ä¼šå°±åœ°æŽ’åºåˆ—è¡¨ï¼Œå³åœ¨åŽŸåˆ—è¡¨çš„åŸºç¡€ä¸Šå®ŒæˆæŽ’åºï¼Œä¸ä¼šå†å¦å¤–å¤åˆ¶ä¸€ä»½ã€‚ä¹Ÿå› æ­¤å…¶è¿”å›žå€¼ä¸º Noneã€‚å†…ç½®çš„ sorted å‡½æ•°åˆ™ä¼šæ–°å»ºä¸€ä¸ªåˆ—è¡¨ä½œä¸ºè¿”å›žå€¼ã€‚å®ƒå¯ä»¥æŽ¥æ”¶ä»»ä½•å½¢å¼çš„å¯è¿­ä»£å¯¹è±¡ï¼ˆåŒ…å«ä¸å¯å˜åºåˆ—å’Œç”Ÿæˆå™¨ï¼‰ï¼Œæœ€åŽè¿”å›žçš„å§‹ç»ˆæ˜¯æŽ’åºå¥½çš„åˆ—è¡¨ã€‚123456789101112&gt;&gt;&gt; fruits = ['grape', 'raspberry', 'apple', 'banana']&gt;&gt;&gt; sorted(fruits)['apple', 'banana', 'grape', 'raspberry']&gt;&gt;&gt; fruits['grape', 'raspberry', 'apple', 'banana']&gt;&gt;&gt; sorted(fruits, key=len)['grape', 'apple', 'banana', 'raspberry']&gt;&gt;&gt; fruits['grape', 'raspberry', 'apple', 'banana']&gt;&gt;&gt; fruits.sort()&gt;&gt;&gt; fruits['apple', 'banana', 'grape', 'raspberry'] å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>List</tag>
        <tag>Array</tag>
        <tag>Slice</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¸­çš„ç‰¹æ®Šæ–¹æ³•åŠå…¶åº”ç”¨]]></title>
    <url>%2F2020%2F09%2F19%2Fmagic-methods-in-python%2F</url>
    <content type="text"><![CDATA[Python ä¸­çš„ç‰¹æ®Šæ–¹æ³•ä¸»è¦æ˜¯ä¸ºäº†è¢«è§£é‡Šå™¨è°ƒç”¨çš„ï¼Œå› æ­¤åº”è¯¥å°½é‡ä½¿ç”¨ len(my_object) è€Œä¸æ˜¯ my_object.__len__() è¿™ç§å†™æ³•ã€‚åœ¨æ‰§è¡Œ len(my_object) æ—¶ï¼ŒPython è§£é‡Šå™¨ä¼šè‡ªè¡Œè°ƒç”¨ my_object ä¸­å®žçŽ°çš„ __len__ æ–¹æ³•ã€‚ é™¤éžæœ‰å¤§é‡çš„å…ƒç¼–ç¨‹å­˜åœ¨ï¼Œç›´æŽ¥è°ƒç”¨ç‰¹æ®Šæ–¹æ³•çš„é¢‘çŽ‡åº”è¿œå°äºŽå®žçŽ°å®ƒä»¬çš„æ¬¡æ•°ã€‚ æ¨¡æ‹Ÿæ•°å€¼ç±»åž‹å¯ä»¥é€šè¿‡åœ¨è‡ªå®šä¹‰å¯¹è±¡ä¸­å®žçŽ° __add__ å’Œ __mul__ ç­‰ç‰¹æ®Šæ–¹æ³• ï¼Œä»¤å…¶æ”¯æŒ +ã€* ç­‰è¿ç®—ç¬¦ã€‚å¦‚ä¸‹é¢çš„æ¨¡æ‹Ÿå‘é‡çš„ Vector ç±»ï¼š12345678910111213141516171819202122# vector.pyfrom math import hypotclass Vector: def __init__(self, x=0, y=0): self.x = x self.y = y def __repr__(self): return f'Vector(&#123;self.x&#125;, &#123;self.y&#125;)' def __abs__(self): return hypot(self.x, self.y) def __bool__(self): return bool(self.x or self.y) def __add__(self, other): return Vector(self.x + other.x, self.y + other.y) def __mul__(self, scalar): return Vector(self.x * scalar, self.y * scalar) è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910&gt;&gt;&gt; from vector import Vector&gt;&gt;&gt; v1 = Vector(2, 4)&gt;&gt;&gt; v2 = Vector(2, 1)&gt;&gt;&gt; v1 + v2Vector(4, 5)&gt;&gt;&gt; v = Vector(3, 4)&gt;&gt;&gt; abs(v)5.0&gt;&gt;&gt; v * 3Vector(9, 12) å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºPython æœ‰ä¸€ä¸ª repr å†…ç½®å‡½æ•°ï¼Œèƒ½æŠŠä¸€ä¸ªå¯¹è±¡ç”¨å­—ç¬¦ä¸²çš„å½¢å¼è¡¨ç¤ºå‡ºæ¥ã€‚å®žé™…ä¸Šè¿™ç§å­—ç¬¦ä¸²è¡¨è¾¾æ˜¯é€šè¿‡å¯¹è±¡å†…éƒ¨çš„ __repr__ ç‰¹æ®Šæ–¹æ³•å®šä¹‰çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨æŽ§åˆ¶å°é‡ŒæŸ¥çœ‹æŸä¸ªå¯¹è±¡æ—¶ï¼Œè¾“å‡ºçš„å­—ç¬¦ä¸²ä¸€èˆ¬æ˜¯ &lt;xxx object at 0x7fc99d6ab2e0&gt; è¿™ç§å½¢å¼ã€‚ __repr__ è¿”å›žçš„å­—ç¬¦ä¸²åº”è¯¥å‡†ç¡®ã€æ— æ­§ä¹‰ï¼Œå¹¶å°½å¯èƒ½è¡¨ç¤ºå‡ºè¯¥å¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚æ¯”å¦‚å‰é¢çš„ Vector å¯¹è±¡ï¼Œå…¶ __repr__ ä¸­å®šä¹‰çš„å­—ç¬¦ä¸²å½¢å¼ç±»ä¼¼äºŽ Vector(3, 4)ï¼Œå’Œå¯¹è±¡åˆå§‹åŒ–çš„è¯­æ³•éžå¸¸è¿‘ä¼¼ã€‚ __repr__ å’Œ __str__ çš„åŒºåˆ«åœ¨äºŽï¼Œ__str__ æ˜¯åœ¨å‘å¯¹è±¡åº”ç”¨ str() å‡½æ•°ï¼ˆæˆ–è€…ç”¨ print å‡½æ•°æ‰“å°æŸä¸ªå¯¹è±¡ï¼‰æ—¶è¢«è°ƒç”¨ã€‚å…¶è¿”å›žçš„å­—ç¬¦ä¸²å¯¹ç»ˆç«¯ç”¨æˆ·æ›´å‹å¥½ã€‚å¦‚æžœåªæƒ³å®žçŽ°å…¶ä¸­ä¸€ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œ__repr__ åº”è¯¥æ˜¯æ›´ä¼˜çš„é€‰æ‹©ã€‚åœ¨å¯¹è±¡æ²¡æœ‰å®žçŽ° __str__ æ–¹æ³•çš„æƒ…å†µä¸‹ï¼ŒPython è§£é‡Šå™¨ä¼šç”¨ __repr__ ä»£æ›¿ã€‚ 1234567# myclass.pyclass MyClass: def __repr__(self): return 'MyClass' def __str__(self): return 'This is an instance of MyClass' 123456&gt;&gt;&gt; from myclass import MyClass&gt;&gt;&gt; my = MyClass()&gt;&gt;&gt; myMyClass&gt;&gt;&gt; print(my)This is an instance of MyClass è‡ªå®šä¹‰å¸ƒå°”å€¼Python é‡Œæœ‰ bool ç±»åž‹ï¼Œä½†å®žé™…ä¸Šä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ç”¨åœ¨éœ€è¦ bool ç±»åž‹çš„ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚ if æˆ– while è¯­å¥ï¼‰ä¸­ã€‚ä¸ºäº†åˆ¤æ–­æŸä¸ªå€¼ x çš„çœŸå‡ï¼ŒPython ä¼šè°ƒç”¨ bool(x) è¿”å›ž True æˆ– Falseã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè‡ªå®šä¹‰ç±»çš„å®žä¾‹æ€»æ˜¯ä¸ºçœŸã€‚é™¤éžè¿™ä¸ªç±»å¯¹äºŽ __bool__ æˆ– __len__ æ–¹æ³•æœ‰è‡ªå·±çš„å®žçŽ°ã€‚bool(x) å®žé™…ä¸Šè°ƒç”¨äº†å¯¹è±¡ x ä¸­çš„ __bool__ æ–¹æ³•ã€‚å¦‚ä¸å­˜åœ¨ __bool__ æ–¹æ³•ï¼Œåˆ™ bool(x) ä¼šå°è¯•è°ƒç”¨ x.__len__()ï¼Œè¿”å›ž 0 åˆ™ä¸º Falseï¼Œå¦åˆ™ä¸º Trueã€‚ 12345678910# boolclass.pyclass BoolClass: def __init__(self): self.list = [] def add(self, item): self.list.append(item) def __len__(self): return len(self.list) 1234567891011&gt;&gt;&gt; from boolclass import BoolClass&gt;&gt;&gt; b = BoolClass()&gt;&gt;&gt; len(b)0&gt;&gt;&gt; bool(b)False&gt;&gt;&gt; b.add(1)&gt;&gt;&gt; len(b)1&gt;&gt;&gt; bool(b)True 12345678910111213# boolclass.pyclass BoolClass: def __init__(self): self.list = [] def add(self, item): self.list.append(item) def __len__(self): return len(self.list) def __bool__(self): return bool(sum(self.list)) 123456789101112&gt;&gt;&gt; from boolclass import BoolClass&gt;&gt;&gt; b = BoolClass()&gt;&gt;&gt; b.add(1)&gt;&gt;&gt; len(b)1&gt;&gt;&gt; bool(b)True&gt;&gt;&gt; b.add(-1)&gt;&gt;&gt; len(b)2&gt;&gt;&gt; bool(b)False å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>OOP</tag>
        <tag>Object</tag>
        <tag>Methods</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScriptï¼ˆECMAScript 6ï¼‰â€”â€” å¼‚æ­¥ç¼–ç¨‹]]></title>
    <url>%2F2020%2F09%2F19%2Funderstanding-javascript-ecmascript-6-async-programming%2F</url>
    <content type="text"><![CDATA[JavaScript ä½œä¸ºä¸»è¦é¢å‘ Web ç¼–ç¨‹è€Œåˆ›å»ºçš„è¯­è¨€ï¼Œå…¶è¯žç”ŸåˆæœŸå³å…·æœ‰äº†åº”å¯¹å¼‚æ­¥çš„ç”¨æˆ·äº¤äº’ï¼ˆå¦‚ç‚¹å‡»é¼ æ ‡ã€æŒ‰ä¸‹é”®ç›˜ç­‰ï¼‰çš„èƒ½åŠ›ã€‚åŽç»­çš„ Node.js å¼•å…¥äº† callbacks ä½œä¸ºé™¤äº‹ä»¶æ¨¡åž‹ä»¥å¤–çš„å¦ä¸€ç§å®žçŽ°å¼‚æ­¥ç¼–ç¨‹çš„æ–¹å¼ï¼Œè€Œä¹‹åŽçš„ Promise åˆä½¿å¾— JavaScript å¤„ç†å¼‚æ­¥éœ€æ±‚çš„èƒ½åŠ›æ›´ä¸ºå¼ºå¤§ã€‚ ä¸€ã€å¼‚æ­¥ç¼–ç¨‹åŸºç¡€Event Modelå½“ç”¨æˆ·ç‚¹å‡»é¼ æ ‡æˆ–æŒ‰ä¸‹é”®ç›˜ä¸Šçš„æŸä¸ªæŒ‰é”®æ—¶ï¼Œä¸€ä¸ªå¯¹åº”çš„ç‰¹æ®Šäº‹ä»¶ï¼ˆæ¯”å¦‚ onclickï¼‰è§¦å‘ï¼Œè¯¥äº‹ä»¶å…³è”çš„ä¸€ç³»åˆ—å“åº”åŠ¨ä½œå³è¢«æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­æœ€ç»ˆè¢«æ‰§è¡Œã€‚è¿™æ˜¯ JavaScript ä¸­æœ€åŸºæœ¬çš„å¼‚æ­¥ç¼–ç¨‹æ–¹å¼ã€‚1234567&lt;button id="my-btn"&gt;Click Me&lt;/button&gt; &lt;script&gt; let button = document.getElementById("my-btn") button.onclick = function(event) &#123; console.log("Clicked") &#125; &lt;/script&gt; callbackcallback æ¨¡å¼ä¸ŽåŸºäºŽäº‹ä»¶æ¨¡åž‹çš„å¼‚æ­¥ç¼–ç¨‹ç±»ä¼¼ï¼Œå¼‚æ­¥ä»£ç éƒ½æ˜¯åœ¨åŽç»­çš„æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹æ‰§è¡Œã€‚ä¸åŒçš„æ˜¯ï¼Œå…¶å¼‚æ­¥æ‰§è¡Œçš„æ“ä½œï¼ˆå‡½æ•°ï¼‰éœ€è¦ä½œä¸ºå‚æ•°ä¼ é€’ã€‚12345678910111213let fs = require("fs")fs.readFile("example.txt", &#123; encoding: "utf8" &#125;, function(err, contents)&#123; if (err) &#123; throw err &#125; console.log(contents)&#125;)console.log("Hi!")// Hi!// This is an example text file ä¸Šé¢çš„ä¾‹å­ä½¿ç”¨äº†ç»å…¸çš„ Node.js error-first å›žè°ƒå‡½æ•°æ¨¡å¼ã€‚readFile() å‡½æ•°ä»Žç¡¬ç›˜è¯»å–æŸä¸ªæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶è¯»å–å®Œæˆä¹‹åŽæ‰§è¡Œ callback å‡½æ•°ã€‚å¦‚æžœè¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼ é€’ç»™å›žè°ƒå‡½æ•°çš„ err å‚æ•°ä¸ºé”™è¯¯å¯¹è±¡ï¼›æœªå‘ç”Ÿé”™è¯¯åˆ™ content å‚æ•°ä¸­åŒ…å«äº†è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚ åœ¨ callback æ¨¡å¼ä¸­ï¼ŒreadFile() ä¼šç«‹å³å¼€å§‹æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶è¯»å–çš„è¿›åº¦å¼€å¯ä¹‹åŽæš‚åœã€‚ç´§æŽ¥ç€ readFile() åŽé¢çš„ console.log(&quot;Hi!&quot;) ä¼šç«‹å³æ‰§è¡Œå¹¶è¾“å‡º Hi! åˆ°å±å¹•ä¸Šï¼ˆæ­¤æ—¶ readFile() å¤„äºŽæš‚åœçŠ¶æ€ï¼Œå›žè°ƒå‡½æ•°ä¸­çš„ console.log(contents) ä¹Ÿå¹¶æœªæ‰§è¡Œï¼‰ã€‚æ–‡ä»¶è¯»å–ç»“æŸåŽï¼Œä¸€ä¸ªæ–°çš„ä»»åŠ¡ï¼ˆå³ callback å‡½æ•°ä»¥åŠä¼ é€’ç»™å®ƒçš„å‚æ•°ï¼‰è¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ç»ˆè¢«æ‰§è¡Œã€‚ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°ï¼ŒHi! è¦å…ˆäºŽ contents è¢«æ‰“å°ã€‚ callback æ¨¡å¼çš„é—®é¢˜åœ¨äºŽï¼Œå½“æœ‰è¿‡å¤šçš„ callback å‡½æ•°åµŒå¥—æ—¶ï¼Œä¼šå‡ºçŽ°ç§°ä¸º callback hell çš„æƒ…å†µï¼š123456789101112131415161718192021method1(function(err, result) &#123; if (err) &#123; throw err; &#125; method2(function(err, result) &#123; if (err) &#123; throw err; &#125; method3(function(err, result) &#123; if (err) &#123; throw err; &#125; method4(function(err, result) &#123; if (err) &#123; throw err; &#125; method5(result); &#125;); &#125;); &#125;);&#125;); äºŒã€Promiseé™¤äº†å‰é¢æåˆ°çš„ callback hell ä¼šä½¿ä»£ç å˜å¾—è¿‡äºŽç¹æ‚ä»¥è‡³äºŽéš¾ä»¥ç†è§£å’Œè°ƒè¯•ä¹‹å¤–ï¼Œcallback æ¨¡å¼å¯¹äºŽå¤„ç†æŸäº›è¾ƒå¤æ‚çš„é€»è¾‘ä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ã€‚æ¯”å¦‚å¸Œæœ›ä¸¤ä¸ªå¼‚æ­¥æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œåœ¨åŒæ–¹éƒ½å®Œæˆä¹‹åŽæé†’ç”¨æˆ·ï¼›æˆ–è€…ä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡åŒæ—¶å¼€å§‹ä½†æ˜¯åªèŽ·å–ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®ŒåŽçš„ç»“æžœã€‚åœ¨è¿™äº›æƒ…æ™¯ä¸‹ï¼Œå°±éœ€è¦åŒæ—¶è¿½è¸ªå¤šä¸ª callback å‡½æ•°çš„çŠ¶æ€ã€‚promise åˆ™é’ˆå¯¹ä»¥ä¸Šæƒ…å†µåšäº†ç›¸åº”çš„æå‡ã€‚ promise æ˜¯ä¸€ç§å¯¹åº”å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æžœçš„â€œå ä½ç¬¦â€ã€‚12// readFile â€œä¿è¯â€ä¼šåœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹å®Œæˆlet promise = readFile("example.txt") readFile() å¹¶ä¸ä¼šç«‹å³å¼€å§‹è¯»å–æ–‡ä»¶ã€‚ç›¸åï¼Œå®ƒä¼šç›´æŽ¥è¿”å›žä¸€ä¸ª promise å¯¹è±¡è¡¨ç¤ºå¼‚æ­¥çš„è¯»å–æ“ä½œï¼Œæ–¹ä¾¿åœ¨åŽç»­çš„ä»£ç ä¸­é€šè¿‡è¿™ä¸ª promise å¯¹è±¡è®¿é—®è¯»å–ä»»åŠ¡çš„ç»“æžœã€‚è¯¥ promise ä»£è¡¨çš„ç»“æžœæ˜¯å¦å¯ç”¨å–å†³äºŽå…¶ç”Ÿå‘½å‘¨æœŸæ‰€å¤„çš„é˜¶æ®µã€‚ Promise ç”Ÿå‘½å‘¨æœŸpromise çš„ç”Ÿå‘½å‘¨æœŸèµ·å§‹äºŽ pending (unsettled) çŠ¶æ€ï¼Œè¡¨æ˜Žå¯¹åº”çš„å¼‚æ­¥æ“ä½œè¿˜æœªå®Œæˆã€‚æ¯”å¦‚å‰é¢çš„ let promise = readFile(&quot;example.txt&quot;)ï¼Œåœ¨ readFile() å‡½æ•°è¿”å›žåŽ promise å°±ç«‹å³è¿›å…¥äº† pending çŠ¶æ€ã€‚è€Œå¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæ—¶ï¼Œpromise åˆ™è¿›å…¥ settled çŠ¶æ€ï¼Œå…·ä½“åŒ…å«ä¸¤ç§æƒ…å†µï¼š Fulfilledï¼špromise å¯¹åº”çš„å¼‚æ­¥æ“ä½œæˆåŠŸæ‰§è¡Œå®Œæ¯• Rejectedï¼špromise å¯¹åº”çš„å¼‚æ­¥æ“ä½œæœªæ‰§è¡Œå®Œæ¯•ï¼ˆå‡ºçŽ°é”™è¯¯æˆ–å…¶ä»–æƒ…å†µï¼‰ å†…éƒ¨å±žæ€§ [[PromiseState]] ç”¨æ¥æ ‡è®°å…¶ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼ˆå¦‚ pendingã€fulfilledã€rejectedï¼‰ï¼Œè¯¥å±žæ€§ä¸å¯¹ promise å¯¹è±¡å¤–éƒ¨æš´éœ²ï¼Œå› æ­¤ä¸å¯ä»¥äººä¸ºä¿®æ”¹ promise å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯å¯ä»¥åœ¨ promise çš„çŠ¶æ€æ”¹å˜æ—¶é€šè¿‡ then() æ–¹æ³•è‡ªåŠ¨è§¦å‘ä¸€ç³»åˆ—åŠ¨ä½œã€‚ æ‰€æœ‰çš„ promise å¯¹è±¡éƒ½å…·æœ‰ then() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æŽ¥æ”¶ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå½“ promise çŠ¶æ€ä¸º fulfilled æ—¶è°ƒç”¨çš„å‡½æ•°ï¼Œæ‰€æœ‰ä¸Žå¼‚æ­¥æ“ä½œç›¸å…³çš„æ•°æ®éƒ½ä¼šè¢«ä¼ é€’ç»™è¯¥å‡½æ•°ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºå½“ promise çŠ¶æ€ä¸º rejected æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ã€‚123456789101112131415161718192021222324let promise = readFile("example.txt");promise.then(function(contents) &#123; // fulfillment console.log(contents)&#125;, function(err) &#123; // rejection console.error(err.message)&#125;);promise.then(function(contents) &#123; // fulfillment console.log(contents);&#125;);promise.then(null, function(err) &#123; // rejection console.error(err.message);&#125;);promise.catch(function(err) &#123; // rejectionconsole.error(err.message);&#125;); åˆ›å»º Promisepromise å¯ä»¥ä½¿ç”¨ Promise æž„é€ å™¨åˆ›å»ºï¼Œè¯¥æž„é€ å™¨æŽ¥æ”¶ä¸€ä¸ªç§°ä¸º executor çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼ŒåŒ…å«äº†åˆå§‹åŒ– promise çš„ä»£ç ã€‚executor æŽ¥æ”¶ resolve()ã€reject() ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œresolve() å°†åœ¨ executor æ‰§è¡ŒæˆåŠŸåŽè°ƒç”¨ï¼Œä¼ é€’ promise å·²åšå¥½å‡†å¤‡çš„ä¿¡å·ï¼›executor æ‰§è¡Œå¤±è´¥äº†åˆ™è°ƒç”¨ reject()ã€‚ ä¸€ä¸ª Promise çš„å®Œæ•´ç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627282930let fs = require("fs")function readFile(filename) &#123; return new Promise(function(resolve, reject) &#123; fs.readFile(filename, &#123; encoding: "utf8" &#125;, function(err, contents) &#123; // check for errors if (err) &#123; reject(err) return &#125; // the read succeeded resolve(contents) &#125;) &#125;)&#125;let promise = readFile("example.txt")// listen for both fulfillment and rejectionpromise.then(function(contents) &#123; // fulfillment console.log(contents)&#125;, function(err) &#123; // rejection console.error(err.message)&#125;)console.log("Hi!")// Hi!// This is an example text file Promise çš„æ‰§è¡Œæµç¨‹å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334console.log("At code start")var delayedPromise = new Promise((resolve, reject) =&gt; &#123; console.log("delayedPromise executor") setTimeout(() =&gt; &#123; console.log("Resolving delayedPromise") resolve("Hello") &#125;, 1000)&#125;)console.log("After creating delayedPromise")delayedPromise.then(contents =&gt; &#123; console.log("delayedPromise resolve handled with", contents)&#125;)const immediatePromise = new Promise((resolve, reject) =&gt; &#123; console.log("immediatePromise executor") resolve("World")&#125;)immediatePromise.then(contents =&gt; &#123; console.log("immediatePromise resolve handled with", contents)&#125;)console.log("At code end")// At code start// delayedPromise executor// After creating delayedPromise// immediatePromise executor// At code end// immediatePromise resolve handled with World// Resolving delayedPromise// delayedPromise resolve handled with Hello å…·ä½“çš„æ‰§è¡Œé€»è¾‘ä¸ºï¼š ä»£ç å¼€å§‹æ‰§è¡Œï¼Œé€šè¿‡ Promise æž„é€ å™¨åˆ›å»ºä¸€ä¸ª delayedPromiseï¼Œå…¶ä¸­çš„ console.log() å’Œ setTimeout()ï¼ˆä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å¼‚æ­¥æ“ä½œï¼‰å‡½æ•°ç«‹å³æ‰§è¡Œ delayedPromise åˆ›å»ºä¹‹åŽï¼Œå…¶æœ€ç»ˆçš„ç»“æžœå’ŒçŠ¶æ€ï¼ˆæ˜¯å¦æˆåŠŸæ‰§è¡Œï¼‰ä¸èƒ½ç«‹å³çŸ¥æ™“ï¼Œå› æ­¤å¤„äºŽ pending çŠ¶æ€ è°ƒç”¨ delayedPromise çš„ then æ–¹æ³•ï¼Œå°†ä¸€ä¸ªå½“ promise æˆåŠŸ resolve åŽæ‰æ‰§è¡Œçš„ callback å‡½æ•°æ”¾åˆ°æ‰§è¡Œè®¡åˆ’ä¸­ ç»§ç»­åˆ›å»ºå¦ä¸€ä¸ª immediatePromiseï¼Œè¯¥ promise ä¼šåœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­ç«‹å³ resolveï¼Œå› æ­¤å…¶åˆ›å»ºå®ŒæˆåŽå³å¤„äºŽ resolved çŠ¶æ€ è°ƒç”¨ immediatePromise çš„ then æ–¹æ³•ï¼Œæ³¨å†Œä¸€ä¸ªå½“ promise æˆåŠŸ resolve åŽæ‰æ‰§è¡Œçš„ callback å‡½æ•° ä»Žæœ€ç»ˆçš„ç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œå³ä¾¿ immediatePromise åœ¨åˆ›å»ºåŽå³å¤„äºŽ resolved çŠ¶æ€ï¼ŒAt code end å®žé™…ä¸Šæ˜¯å…ˆäºŽå‰é¢çš„ immediatePromise.then() è¾“å‡ºçš„ã€‚åŽŸå› æ˜¯ promise è¢«è®¾è®¡æˆä¸“é—¨é’ˆå¯¹å¼‚æ­¥æ“ä½œï¼Œthen() æ–¹æ³•ä¸­çš„ callback ä¼šæ°¸è¿œåœ¨å½“å‰äº‹ä»¶å¾ªçŽ¯ä¸­æ‰€æœ‰ä»£ç æ‰§è¡Œå®ŒåŽæ‰å¼€å§‹è§¦å‘ã€‚ å› æ­¤å®žé™…çš„æ‰§è¡Œé¡ºåºä¸ºï¼šAt code start -&gt; åˆ›å»º delayedPromise -&gt; é€šè¿‡ then() æ³¨å†Œ delayPromise çŠ¶æ€ä¸º resolved æ—¶è§¦å‘çš„ callback -&gt; åˆ›å»º immediatePromise -&gt; é€šè¿‡ then() æ³¨å†Œ immediatePromise çŠ¶æ€ä¸º resolved æ—¶è§¦å‘çš„ callback -&gt; At code end -&gt; immediatePromise å…ˆ resolvedï¼Œå…¶å…³è”çš„ callback æ‰§è¡Œ -&gt; delayedPromise resolvedï¼Œå…¶å…³è”çš„ callback æ‰§è¡Œ ä¸‰ã€Chaining Promisesæˆªæ­¢åˆ°å‰é¢çš„ä»‹ç»ï¼Œpromise çœ‹èµ·æ¥åªä¸è¿‡åœ¨ callback çš„åŸºç¡€ä¸Šåšäº†ä¸€ç‚¹ç‚¹æœ‰é™çš„æå‡ã€‚å®žé™… promise æ”¯æŒå¤šç§å½¢å¼çš„è¿žæŽ¥ï¼Œè¶³ä»¥å®Œæˆæ›´åŠ å¤æ‚çš„å¼‚æ­¥é€»è¾‘ã€‚ æ¯æ¬¡å¯¹ promise çš„ then() æˆ– catch() æ–¹æ³•çš„è°ƒç”¨ï¼Œå®žé™…ä¸Šéƒ½ä¼šåˆ›å»ºå’Œè¿”å›žå¦ä¸€ä¸ª promise å¯¹è±¡ã€‚ç¬¬äºŒä¸ª promise å¯¹è±¡åªæœ‰åœ¨ç¬¬ä¸€ä¸ª promise fulfilled æˆ– rejected åŽæ‰ä¼šè¢« resolveã€‚123456789101112let p1 = new Promise(function(resolve, reject) &#123; resolve(42)&#125;)p1.then(function(value) &#123; console.log(value)&#125;).then(function() &#123; console.log("Finished")&#125;)// 42// Finished unchained ç‰ˆæœ¬ï¼š1234567891011let p1 = new Promise(function(resolve, reject) &#123; resolve(42)&#125;)let p2 = p1.then(function(value) &#123; console.log(value)&#125;)p2.then(function() &#123; console.log("Finished")&#125;) p2.then() ä¹Ÿä¼šè¿”å›žä¸€ä¸ª promise å¯¹è±¡ï¼Œåªä¸è¿‡å®ƒæ²¡æœ‰åœ¨ä»£ç ä¸­ä½¿ç”¨ã€‚ é”™è¯¯æ•èŽ·Promise chaining å…è®¸ç”¨æˆ·æ•èŽ·ä¹‹å‰çš„ promise ä¸­å‡ºçŽ°çš„é”™è¯¯ã€‚12345678910let p1 = new Promise(function(resolve, reject) &#123; resolve(42)&#125;)p1.then(function(value) &#123; throw new Error("Boom!")&#125;).catch(function(error) &#123; console.log(error.message)&#125;)// Boom! p1 çš„ fulfillment handler æŠ›å‡ºå¼‚å¸¸ï¼Œç¬¬äºŒä¸ª promise çš„ catch() æ–¹æ³•é€šè¿‡å®ƒçš„ rejection handler æŽ¥æ”¶åˆ°è¯¥å¼‚å¸¸ã€‚åŒæ ·çš„æ–¹å¼ä¹Ÿé€‚ç”¨äºŽ rejection handler æŠ›å‡ºå¼‚å¸¸ï¼š123456789101112let p1 = new Promise(function(resolve, reject) &#123; throw new Error("Explosion!")&#125;)p1.catch(function(error) &#123; console.log(error.message) throw new Error("Boom!")&#125;).catch(function(error) &#123; console.log(error.message)&#125;)// Explosion!// Boom! executor æŠ›å‡ºå¼‚å¸¸è§¦å‘ p1 çš„ rejection handlerï¼Œè¯¥ handler åˆæŠ›å‡ºå¦ä¸€ä¸ªå¼‚å¸¸è§¦å‘ç¬¬äºŒä¸ª promise çš„ rejection handlerã€‚ Promise Chain ä¸­çš„è¿”å›žå€¼Promise Chain ä¸­å¦ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§å³åœ¨ä¸¤ä¸ª promise ä¹‹é—´ä¼ é€’æ•°æ®ã€‚ä¹‹å‰çš„ä»£ç ä¸­ï¼Œå¯ä»¥é€šè¿‡ executor ä¸­çš„ resovle() å‡½æ•°å°†å€¼ä¼ é€’ç»™è¯¥ promise çš„ fulfillment handlerã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸º fulfillment handler æŒ‡å®šä¸€ä¸ªè¿”å›žå€¼ï¼Œå°†è¯¥å€¼æ²¿ç€ promise chain ä¼ é€’ã€‚12345678910111213let p1 = new Promise(function(resolve, reject) &#123; resolve(42)&#125;)p1.then(function(value) &#123; console.log(value) return value + 1&#125;).then(function(value) &#123; console.log(value)&#125;)// 42// 43 åŒæ ·çš„æ“ä½œä¹Ÿå¯ä»¥ç”¨åœ¨ rejection handler ä¸Šï¼š12345678910111213let p1 = new Promise(function(resolve, reject) &#123; reject(42)&#125;)p1.catch(function(value) &#123; console.log(value) return value + 1&#125;).then(function(value) &#123; console.log(value)&#125;)// 42// 43 å››ã€å“åº”å¤šä¸ª Promiseä¹‹å‰çš„ä»£ç ä¸­éƒ½æ˜¯ä¸€æ¬¡åªå“åº”ä¸€ä¸ª promiseï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦ç›‘æŽ§å¤šä¸ª promise çš„çŠ¶æ€å¹¶å†³å®šä¹‹åŽçš„åŠ¨ä½œã€‚ECMAScript 6 æä¾›äº†ä¸¤ç§æ–¹æ³•ï¼ˆPromise.all() å’Œ Promise.raceï¼‰åº”å¯¹è¿™äº›æƒ…å†µã€‚ Promise.all()Promise.all() æ–¹æ³•åªæŽ¥æ”¶ä¸€ä¸ªåŒ…å«æ‰€æœ‰éœ€è¦ç›‘æŽ§çš„ promise çš„å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”åªæœ‰å½“è¿™äº›éœ€è¦ç›‘æŽ§çš„ promise å…¨éƒ¨ resolved æ—¶ï¼ŒPromise.all() è¿”å›žçš„ promise æ‰ä¼š resolvedã€‚1234567891011121314151617181920let p1 = new Promise(function(resolve, reject) &#123; resolve(42)&#125;)let p2 = new Promise(function(resolve, reject) &#123; resolve(43)&#125;)let p3 = new Promise(function(resolve, reject) &#123; resolve(44)&#125;)let p4 = Promise.all([p1, p2, p3])p4.then(function(value) &#123; console.log(Array.isArray(value)) // true console.log(value[0]) // 42 console.log(value[1]) // 43 console.log(value[2]) // 44&#125;) Promise.all() åˆ›å»ºäº† promise p4ã€‚åªæœ‰å½“åˆ—è¡¨ä¸­çš„ promise p1ï¼Œp2ï¼Œp3 å…¨éƒ¨ fulfilled ä¹‹åŽï¼Œp4 æœ€ç»ˆæ‰ä¼š fulfilledã€‚å‰é¢ 3 ä¸ª promise resolve çš„æ•°å­—ç»„æˆåˆ—è¡¨ä¼ é€’ç»™ p4 çš„ fulfillment handlerï¼Œè¿™äº›æ•°å­—ä¸Žç”Ÿäº§å®ƒä»¬çš„ promise çš„ä½ç½®æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ å¦‚æžœä»»æ„ä¸€ä¸ªä¼ å…¥ Promise.all() çš„ promise çŠ¶æ€æ˜¯ rejectedï¼Œåˆ™ Promise.all() è¿”å›žçš„ promise ä¹Ÿä¼šç«‹å³ rejectedï¼Œä¸ä¼šç­‰å¾…å…¶ä»– promise ç»“æŸã€‚1234567891011121314151617let p1 = new Promise(function(resolve, reject) &#123; resovle(42)&#125;)let p2 = new Promise(function(resolve, reject) &#123; reject(43)&#125;)let p3 = new Promise(function(resolve, reject) &#123; resolve(44)&#125;)let p4 = Promise.all([p1, p2, p3])p4.catch(function(value) &#123; console.log(Array.isArray(value)) // false console.log(value) // 43&#125;) åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œp2 çš„çŠ¶æ€ä¸º rejectedï¼Œp4 çš„ rejection handler ä¼šç«‹å³è°ƒç”¨ï¼Œä¸ä¼šç­‰å¾… p1 å’Œ p3 æ‰§è¡Œå®Œæ¯•ï¼ˆp1 å’Œ p3 æœ€ç»ˆä¼šæ‰§è¡Œå®Œæ¯•ï¼Œåªæ˜¯ p4 ä¸ä¼šç­‰å®ƒä»¬ï¼‰ã€‚ Promise.race()Promise.race() åŒæ ·æŽ¥æ”¶ä¸€ä¸ªåŒ…å«éœ€è¦ç›‘æŽ§çš„å¤šä¸ª promise çš„å¯è¿­ä»£å¯¹è±¡ï¼Œè¿”å›žä¸€ä¸ªæ–°çš„ promiseã€‚ä½†æ˜¯ä¸åŒäºŽ Promise.all() ä¼šç­‰å¾…æ‰€æœ‰ç›‘æŽ§ä¸­çš„ promise resolvedï¼ŒPromise.race() ä¼šåœ¨åˆ—è¡¨ä¸­ä»»æ„ä¸€ä¸ª promise resolve åŽç«‹å³è¿”å›žã€‚123456789101112131415161718192021let p1 = new Promise(function(resolve, reject) &#123; setTimeout(resolve, 500, 42)&#125;)let p2 = new Promise(function(resolve, reject) &#123; setTimeout(resolve, 100, 43)&#125;)let p3 = new Promise(function(resolve, reject) &#123; setTimeout(resolve, 200, 44)&#125;)let p4 = Promise.race([p1, p2, p3])p4.then(function(value) &#123; console.log(value)&#125;)// 43 ä¼ é€’ç»™ Promise.race() çš„ promise åƒæ˜¯å¤„åœ¨ä¸€ä¸ªèµ›é“ä¸­ï¼Œçœ‹å“ªä¸€ä¸ªå…ˆæ‰§è¡Œå®Œæ¯•ã€‚å¦‚æžœç¬¬ä¸€ä¸ªè¿è¡Œå®Œçš„ promise çŠ¶æ€ä¸º fulfilledï¼Œåˆ™æœ€åŽè¿”å›žçš„ promise çŠ¶æ€ä¸º fulfilledï¼›å¦‚æžœç¬¬ä¸€ä¸ªè¿è¡Œå®Œçš„ promise çŠ¶æ€ä¸º rejectedï¼Œåˆ™æœ€åŽè¿”å›žçš„ promise çŠ¶æ€ä¸º rejectedã€‚ å‚è€ƒèµ„æ–™Understanding ECMAScript 6Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>JavaScript</tag>
        <tag>Async</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript è§£å¯† â€”â€” æ•°ç»„ï¼ˆArrayï¼‰åŠå…¶å‡½æ•°å¼æ“ä½œ]]></title>
    <url>%2F2020%2F08%2F21%2Fsecrets-of-javascript-array%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åˆ›å»ºæ•°ç»„1234567891011const ninjas = ["Kuma", "Hattori", "Yagyu"]const samurai = new Array("Oda", "Tomoe")console.log(ninjas.length) // 3console.log(ninjas[ninjas.length-1]) // Yagyuconsole.log(ninjas[4]) // undefinedninjas[4] = "Ishi"console.log(ninjas.length) // 5console.log(ninjas) // [ 'Kuma', 'Hattori', 'Yagyu', &lt;1 empty item&gt;, 'Ishi' ]ninjas.length = 2console.log(ninjas) // [ 'Kuma', 'Hattori' ] æ•°ç»„å¯ä»¥ä½¿ç”¨ [] å­—é¢é‡æˆ– Array() æž„é€ å™¨åˆ›å»º å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚ç´¢å¼•ä»Ž 0 åˆ° array.length - 1 æ•°ç»„çš„ length å±žæ€§è¡¨ç¤ºæ•°ç»„çš„å¤§å°ï¼ˆå³å…ƒç´ çš„ä¸ªæ•°ï¼‰ã€‚è¯»å–è¶…å‡ºç´¢å¼•èŒƒå›´çš„å…ƒç´ ï¼Œä¼šå¾—åˆ° undefined ç»™è¶…å‡ºç´¢å¼•èŒƒå›´çš„å…ƒç´ èµ‹å€¼ï¼Œä¼šè‡ªåŠ¨æ‰©å±•æ•°ç»„ å°†æ•°ç»„çš„ length å±žæ€§æ”¹ä¸ºä¸€ä¸ªè¾ƒå°çš„å€¼ï¼Œä¼šè‡ªåŠ¨åˆ é™¤æº¢å‡ºçš„å…ƒç´  äºŒã€æ·»åŠ å’Œç§»é™¤å…ƒç´  pushï¼šå‘æ•°ç»„å°¾éƒ¨æ·»åŠ å…ƒç´  unshiftï¼šå‘æ•°ç»„å¤´éƒ¨æ·»åŠ å…ƒç´  popï¼šä»Žæ•°ç»„å°¾éƒ¨å¼¹å‡ºå…ƒç´  shiftï¼šä»Žæ•°ç»„å¤´éƒ¨å¼¹å‡ºå…ƒç´  123456789101112131415const ninjas = []ninjas.push("Kuma")ninjas.push("Hattori")console.log(ninjas) // [ 'Kuma', 'Hattori' ]ninjas.unshift("Yagyu")console.log(ninjas) // [ 'Yagyu', 'Kuma', 'Hattori' ]const lastNinja = ninjas.pop()console.log(lastNinja) // Hattoriconsole.log(ninjas) // [ 'Yagyu', 'Kuma' ]const firstNinja = ninjas.shift()console.log(firstNinja) // Yagyuconsole.log(ninjas) // [ 'Kuma' ] ä»Žä»»æ„ä½ç½®æ·»åŠ æˆ–ç§»é™¤å…ƒç´ delete1234const ninjas = ["Yagyu", "Kuma", "Hattori", "Fuma"]delete ninjas[1]console.log(ninjas) // [ 'Yagyu', &lt;1 empty item&gt;, 'Hattori', 'Fuma' ]console.log(ninjas.length) // 4 ç”¨ delete åˆ é™¤æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå®žé™…ä¸Šç­‰äºŽç”¨ undefined æ›¿æ¢æŽ‰äº†åˆ é™¤çš„å…ƒç´ ï¼Œå¯¼è‡´æ•°ç»„ä¸­çš„å¯¹åº”ä½ç½®å‡ºçŽ°ä¸€ä¸ªâ€œæ´žâ€ï¼ˆundefinedï¼‰ï¼Œæ•°ç»„ä»ä¿æŒåŽŸæ¥çš„é•¿åº¦ã€‚å› æ­¤ä¸ç¬¦åˆæœ€åˆçš„ç›®çš„ã€‚ splice12345678910const ninjas = ["Yagyu", "Kuma", "Hattori", "Fuma"]var removedItems = ninjas.splice(1, 1)console.log(removedItems) // [ 'Kuma' ]console.log(ninjas.length) // 3console.log(ninjas) // [ 'Yagyu', 'Hattori', 'Fuma' ]removedItems = ninjas.splice(1, 2, "Mochizuki", "Yoshi", "Momochi")console.log(removedItems) // [ 'Hattori', 'Fuma' ]console.log(ninjas) // [ 'Yagyu', 'Mochizuki', 'Yoshi', 'Momochi' ]console.log(ninjas.length) // 4 ç§»é™¤å…ƒç´ æ—¶ï¼Œsplice æ–¹æ³•æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¢«ç§»é™¤ç‰‡æ®µçš„èµ·ç‚¹çš„ç´¢å¼•å’Œç‰‡æ®µçš„é•¿åº¦ï¼Œè¿”å›žç§»é™¤çš„å…ƒç´ ã€‚ splice æ–¹æ³•è¿˜å¯ç”¨äºŽåœ¨æ•°ç»„çš„æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ã€‚å¦‚ä¸Šé¢ä»£ç ä¸­çš„ splice(1, 2, &quot;Mochizuki&quot;, &quot;Yoshi&quot;, &quot;Momochi&quot;) å³è¡¨ç¤ºä»Žç´¢å¼• 1 å¼€å§‹ç§»é™¤ 2 ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨è¯¥ä½ç½®å¤„æ·»åŠ  &quot;Mochizuki&quot;ã€&quot;Yoshi&quot;ã€&quot;Momochi&quot; ä¸‰ä¸ªå…ƒç´ ã€‚ ä¸‰ã€æ•°ç»„çš„ä¸€èˆ¬æ“ä½œéåŽ†æ•°ç»„for1234567const ninjas = ["Yagyu", "Kuma", "Hattori"]for(let i = 0; i &lt; ninjas.length; i++)&#123; console.log(ninjas[i])&#125;// Yagyu// Kuma// Hattori forEach12345678const ninjas = ["Yagyu", "Kuma", "Hattori"]ninjas.forEach(ninja =&gt; &#123; console.log(ninja)&#125;)// Yagyu// Kuma// Hattori MappingforEach12345678910111213const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi", weapon: "katana"&#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const weapons = []ninjas.forEach(ninja =&gt; &#123; weapons.push(ninja.weapon)&#125;)console.log(weapons)// [ 'shuriken', 'katana', 'wakizashi' ] map123456789const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi", weapon: "katana"&#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const weapons = ninjas.map(ninja =&gt; ninja.weapon)console.log(weapons)// [ 'shuriken', 'katana', 'wakizashi' ] map å°†å…¶ callback å‡½æ•°ï¼ˆå³ ninja =&gt; ninja.weaponï¼‰åº”ç”¨åˆ°æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶ä»¥ callback å‡½æ•°çš„è¿”å›žå€¼ ninja.weapon ä¸ºå…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ä½œä¸º map çš„è¿”å›žå€¼ã€‚ Testingevery1234567891011const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi" &#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const allNinjasAreNamed = ninjas.every(ninja =&gt; "name" in ninja)console.log(allNinjasAreNamed) // trueconst allNinjasAreArmed = ninjas.every(ninja =&gt; "weapon" in ninja)console.log(allNinjasAreArmed) // false every æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ª callback å‡½æ•°ï¼Œå°†å…¶åº”ç”¨åˆ°æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚è‹¥æ‰€æœ‰çš„ callback æ‰§è¡ŒåŽçš„è¿”å›žå€¼éƒ½ä¸º trueï¼Œåˆ™ every è¿”å›ž trueï¼›å¦åˆ™ every è¿”å›ž falseã€‚ some1234567891011const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi" &#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const allNinjasAreNamed = ninjas.every(ninja =&gt; "name" in ninja)console.log(allNinjasAreNamed) // trueconst allNinjasAreArmed = ninjas.some(ninja =&gt; "weapon" in ninja)console.log(allNinjasAreArmed) // true some æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ª callback å‡½æ•°ï¼Œå°†å…¶åº”ç”¨åˆ°æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚è‹¥è‡³å°‘æœ‰ä¸€ä¸ªæ•°ç»„å…ƒç´ åº”ç”¨ callback å‡½æ•°åŽè¿”å›ž trueï¼Œåˆ™ some è¿”å›ž trueï¼›å¦åˆ™ some è¿”å›ž falseã€‚ å³ every å¯ä»¥æ£€æŸ¥æ•°ç»„çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½æ»¡è¶³ä¸€ä¸ªç‰¹å®šçš„æ¡ä»¶ï¼Œè¯¥æ¡ä»¶ç”± callback å‡½æ•°æŒ‡å®šã€‚è€Œ some ç”¨äºŽæ£€æŸ¥æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªæ•°ç»„å…ƒç´ æ»¡è¶³æŸä¸ªç‰¹å®šæ¡ä»¶ã€‚ Searchingfind1234567891011121314151617const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi" &#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const ninjaWithWakizashi = ninjas.find(ninja =&gt; &#123; return ninja.weapon === "wakizashi"&#125;)console.log(ninjaWithWakizashi)// &#123; name: 'Kuma', weapon: 'wakizashi' &#125;const ninjaWithKatana = ninjas.find(ninja =&gt; &#123; return ninja.weapon === "katana"&#125;)console.log(ninjaWithKatana)// undefined find æ–¹æ³•ä¼šä»¥ callback å‡½æ•°ä¸ºè§„åˆ™æœç´¢æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œè¿”å›žæ»¡è¶³æ¡ä»¶ï¼ˆcallback è¿”å›ž trueï¼‰çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚è‹¥æ‰€æœ‰å…ƒç´ éƒ½ä¸æ»¡è¶³ï¼Œåˆ™è¿”å›ž undefinedã€‚ filter123456789101112const ninjas = [ &#123;name: "Yagyu", weapon: "shuriken"&#125;, &#123;name: "Yoshi" &#125;, &#123;name: "Kuma", weapon: "wakizashi"&#125;]const armedNinjas = ninjas.filter(ninja =&gt; "weapon" in ninja)console.log(armedNinjas)// [// &#123; name: 'Yagyu', weapon: 'shuriken' &#125;,// &#123; name: 'Kuma', weapon: 'wakizashi' &#125;// ] filter æ–¹æ³•åˆ™ç”¨æ¥ä»¥ callback å‡½æ•°ä¸ºè§„åˆ™æœç´¢å¤šä¸ªæ•°ç»„å…ƒç´ ï¼Œç¬¦åˆæ¡ä»¶ï¼ˆcallback è¿”å›ž trueï¼‰çš„å¤šä¸ªå…ƒç´ ä»¥æ–°æ•°ç»„çš„å½¢å¼è¿”å›žã€‚ Finding index1234567const ninjas = ["Yagyu", "Yoshi", "Kuma", "Yoshi"]console.log(ninjas.indexOf("Yoshi")) // 1console.log(ninjas.lastIndexOf("Yoshi")) // 3const yoshiIndex = ninjas.findIndex(ninja =&gt; ninja === "Yoshi")console.log(yoshiIndex) // 1 Sortingsort æ–¹æ³•çš„å¸¸è§å½¢å¼ï¼šarray.sort((a, b) =&gt; a - b) ä¼ é€’ç»™ sort çš„ callback å‡½æ•°ï¼ˆå¦‚ä¸Šé¢çš„ (a, b) =&gt; a - bï¼‰å³ä¸ºå…·ä½“çš„æŽ’åºè§„åˆ™ï¼Œå¯èƒ½è¾¾åˆ°çš„æ•ˆæžœå¦‚ä¸‹ï¼š callback å‡½æ•°çš„è¿”å›žå€¼å°äºŽ 0ï¼Œåˆ™ a æŽ’åœ¨ b å‰é¢ callback å‡½æ•°çš„è¿”å›žå€¼ç­‰äºŽ 0ï¼Œåˆ™ a ä¸Ž b åœ¨æŽ’åºä¸Šæƒé‡ç›¸åŒ callback å‡½æ•°çš„è¿”å›žå€¼å¤§äºŽ 0ï¼Œåˆ™ a æŽ’åœ¨ b åŽé¢ 1234567891011121314const ninjas = [&#123;name: "Yoshi"&#125;, &#123;name: "Hattori"&#125;, &#123;name: "Kuma"&#125;]ninjas.sort(function(ninja1, ninja2)&#123; if(ninja1.name &lt; ninja2.name) &#123; return -1 &#125; if(ninja1.name &gt; ninja2.name) &#123; return 1 &#125; return 0&#125;)console.log(ninjas)// [ &#123; name: 'Hattori' &#125;, &#123; name: 'Kuma' &#125;, &#123; name: 'Yoshi' &#125; ]ninjas.sort((ninja1, ninja2) =&gt; ninja1.name.length - ninja2.name.length)console.log(ninjas)// [ &#123; name: 'Kuma' &#125;, &#123; name: 'Yoshi' &#125;, &#123; name: 'Hattori' &#125; ] AggregatingforEach12345678const numbers = [1, 2, 3, 4]let sum = 0numbers.forEach(number =&gt; &#123; sum += number&#125;)console.log(sum) // 10 reduce1234const numbers = [1, 2, 3, 4]const sum = numbers.reduce((aggregated, number) =&gt; aggregated + number, 0)console.log(sum) // 10 å‚è€ƒèµ„æ–™Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>DataStructure</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>JavaScript</tag>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å€ŸåŠ© ldap3 è‡ªå®šä¹‰æ”¯æŒ LDAP åŸŸè´¦å·çš„è®¤è¯åŽç«¯]]></title>
    <url>%2F2020%2F08%2F19%2Fdjango-add-ldap-authentication-backend-with-ldap3%2F</url>
    <content type="text"><![CDATA[ä¸€ã€é¡¹ç›®åˆå§‹åŒ– pip install django ldap3 django-admin startproject auth_demo cd auth_demo django-admin startapp authldap python manage.py migrate äºŒã€ç¼–å†™è‡ªå®šä¹‰è®¤è¯åŽç«¯Django çš„è®¤è¯ç³»ç»Ÿæ”¯æŒçš„è‡ªå®šä¹‰æ’ä»¶ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®žçŽ°äº† get_user(user_id) å’Œ authenticate(request, **credentials) æ–¹æ³•çš„ç±»ã€‚å…¶ä¸­ get_user æŽ¥æ”¶ user_idï¼ˆå¯ä»¥æ˜¯ç”¨æˆ·åã€ID ç­‰ï¼Œä½†å¿…é¡»ä¸º user å¯¹è±¡çš„ä¸»é”®ï¼‰è¿”å›žåŒ¹é…çš„ç”¨æˆ·å¯¹è±¡æˆ– Noneï¼›authenticate æŽ¥æ”¶ request å‚æ•°ä»¥åŠè®¤è¯ä¿¡æ¯ï¼Œæ ¹æ®æœ€ç»ˆçš„è®¤è¯ç»“æžœè¿”å›žç”¨æˆ·å¯¹è±¡ï¼ˆè®¤è¯é€šè¿‡ï¼‰æˆ– Noneï¼ˆè®¤è¯ä¸é€šè¿‡ï¼‰ã€‚ auth_demo/authldap/authbackends.pyï¼š12345678910111213141516171819202122232425262728293031323334353637# auth_demo/authldap/authbackends.pyfrom django.contrib.auth.backends import BaseBackendfrom django.contrib.auth.models import Userimport ldap3# æ›¿æ¢ä¸ºå®žé™…çš„åŸŸæŽ§ IPLDAP_HOST = 'xx.xx.xx.xx'class LdapBackend(BaseBackend): def authenticate(self, request, username=None, password=None): if ldap_auth(username, password): try: user = User.objects.get(username=username) except User.DoesNotExist: user = User(username=username) if username.endswith('admin'): user.is_staff = True user.is_superuser = True user.save() return user return None def get_user(self, user_id): try: return User.objects.get(pk=user_id) except User.DoesNotExist: return None# @example.com æ”¹ä¸ºè‡ªå·±åŸŸçŽ¯å¢ƒçš„åŸŸådef ldap_auth(username, password): username = username + '@example.com'\ if '@' not in username else username server = ldap3.Server(LDAP_HOST, port=636, use_ssl=True) conn = ldap3.Connection(server, username, password) return conn.bind() ä»£ç ä¸­çš„ ldap_auth å‡½æ•°ç”¨äºŽæ‰§è¡Œ LDAP è®¤è¯ï¼Œå°† Django æ”¶åˆ°çš„è®¤è¯ä¿¡æ¯ä¼ é€’ç»™ LDAP æœåŠ¡å™¨ï¼Œé€šè¿‡ Connection å¯¹è±¡çš„ bind() æ–¹æ³•ç¡®è®¤ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ã€‚æ­£ç¡®è¿”å›ž Trueï¼Œä¸æ­£ç¡®åˆ™è¿”å›ž Falseã€‚ LDAP è®¤è¯é€šè¿‡åŽï¼Œå†æ£€æŸ¥ User æ•°æ®åº“è¡¨ä¸­æ˜¯å¦å·²åŒ…å«è¯¥ç”¨æˆ·ã€‚è‹¥è¯¥ç”¨æˆ·å­˜åœ¨ï¼Œåˆ™ç›´æŽ¥è¿”å›žå¯¹åº”çš„ User å¯¹è±¡ï¼›è‹¥è¯¥ç”¨æˆ·ä¸å­˜åœ¨ï¼ˆç¬¬ä¸€æ¬¡ç™»å½•ï¼‰ï¼Œåˆ™å…ˆåœ¨ User ä¸­åˆ›å»ºåŒåçš„æ–°ç”¨æˆ·å¹¶æ·»åŠ æƒé™ç­‰ï¼Œä¿å­˜åŽè¿”å›žåˆšåˆ›å»ºçš„ User å¯¹è±¡ã€‚ å‡è®¾æ‰€æœ‰éœ€è¦æ·»åŠ  Django ç®¡ç†å‘˜æƒé™çš„è´¦å·åå­—éƒ½ä»¥ admin ç»“å°¾ã€‚ã€‚ã€‚ é…ç½®è®¤è¯åŽç«¯Django è®¤è¯æ—¶ä½¿ç”¨çš„æ’ä»¶åˆ—è¡¨ç”± settings.py ä¸­çš„ AUTHENTICATION_BACKENDS å­—æ®µæŒ‡å®šï¼Œé»˜è®¤å€¼ä¸º [&#39;django.contrib.auth.backends.ModelBackend&#39;]ã€‚å› æ­¤ä¸ºäº†ç”¨ä¸Šå‰é¢åˆ›å»ºçš„è‡ªå®šä¹‰è®¤è¯åŽç«¯ï¼Œéœ€åœ¨ auth_demo/auth_demo/settings.py é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š1234AUTHENTICATION_BACKENDS = [ 'auth_ldap.authbackends.LdapBackend', 'django.contrib.auth.backends.ModelBackend' ] ä¸‰ã€æµ‹è¯• è¿è¡Œ python manage.py runserver 0.0.0.0:8000 å¯åŠ¨ Web æœåŠ¡ åœ¨åŸŸä¸­åˆ›å»º testaccount å’Œ testaccount-admin æµ‹è¯•è´¦å· è®¿é—® http://xx.xx.xx.xx:8000/admin è¿›å…¥ Django åŽå°ï¼Œç”¨æµ‹è¯•è´¦å·ç™»å½• æ•ˆæžœå¦‚ä¸‹ï¼š å››ã€åˆå§‹åŒ–ç”¨æˆ·ç»„é¦–å…ˆæ¢³ç†ä¸‹ä¹‹å‰ä»£ç çš„é€»è¾‘æµç¨‹ï¼š Django åŽå°èŽ·å–å‰ç«¯ä¼ å…¥çš„è®¤è¯ä¿¡æ¯ï¼Œå¹¶è½¬å‘ç»™ LDAP æœåŠ¡å™¨è¿›è¡Œè®¤è¯ è®¤è¯æˆåŠŸä¸”è¯¥ç”¨æˆ·ä¸åœ¨æ•°æ®åº“ä¸­ï¼ˆé¦–æ¬¡ç™»å½•ï¼‰ï¼Œåˆ™åˆ›å»ºå¯¹åº”çš„ç”¨æˆ·å¹¶å°†å…¶è¿”å›žï¼›è¯¥ç”¨æˆ·å·²å­˜åœ¨åˆ™ç›´æŽ¥è¿”å›ž åˆ›å»ºç”¨æˆ·æ—¶ï¼Œè‹¥ç”¨æˆ·åä»¥ admin ç»“å°¾ï¼Œåˆ™é¢å¤–å‘å…¶æ·»åŠ  staff æƒé™å’Œç®¡ç†å‘˜æƒé™ è®¤è¯å¤±è´¥è¿”å›ž None å‡è®¾åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°ç”¨æˆ·æ—¶ï¼Œéœ€è¦æ ¹æ®ä¸€å®šçš„è§„åˆ™å¯¹ç”¨æˆ·çš„å±žç»„è¿›è¡Œåˆå§‹åŒ–ï¼ˆæ¯”å¦‚åç§°ä»¥ admin ç»“å°¾çš„ç”¨æˆ·è‡ªåŠ¨æ·»åŠ åˆ° admin ç»„ä¸­ï¼‰ã€‚æœ€ç»ˆçš„ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# auth_demo/authldap/authbackends.pyfrom django.contrib.auth.backends import BaseBackendfrom django.contrib.auth.models import User, Groupimport ldap3# æ›¿æ¢ä¸ºå®žé™…çš„åŸŸæŽ§ IPLDAP_HOST = &apos;xx.xx.xx.xx&apos;class LdapBackend(BaseBackend): def authenticate(self, request, username=None, password=None): if ldap_auth(username, password): try: user = User.objects.get(username=username) except User.DoesNotExist: user = User(username=username) user.save() if username.endswith(&apos;admin&apos;): user.is_staff = True user.is_superuser = True add_group(user) user.save() return user return None def get_user(self, user_id): try: return User.objects.get(pk=user_id) except User.DoesNotExist: return None# @example.com æ”¹ä¸ºè‡ªå·±åŸŸçŽ¯å¢ƒçš„åŸŸådef ldap_auth(username, password): username = username + &apos;@example.com&apos;\ if &apos;@&apos; not in username else username server = ldap3.Server(LDAP_HOST, port=636, use_ssl=True) conn = ldap3.Connection(server, username, password) return conn.bind()def add_group(user, groupname=&apos;admin&apos;): try: group = Group.objects.get(name=groupname) except Group.DoesNotExist: group = Group(name=groupname) group.save() group.user_set.add(user) group.save() åˆ é™¤ä¸Šä¸€æ­¥ä¸­æ•°æ®åº“é‡Œæ–°å»ºçš„ testaccount-admin è´¦å·ï¼Œé‡æ–°ç™»å½•æµ‹è¯•ã€‚åˆ™ LDAP è®¤è¯æˆåŠŸåŽï¼ŒDjango åŽå°ä¼šåœ¨æ•°æ®åº“ä¸­æ–°å»º testaccount-admin è´¦å·å¹¶å°†å…¶æ·»åŠ è‡³ admin ç”¨æˆ·ç»„ä¸­ï¼ˆå¦‚ admin ç»„ä¸å­˜åœ¨åˆ™æ–°å»ºè¯¥ç”¨æˆ·ç»„ï¼‰ã€‚å³åœ¨æ–°å»ºè´¦å·çš„åŒæ—¶åˆå§‹åŒ–å…¶å±žç»„ã€‚ å‚è€ƒèµ„æ–™Customizing authentication in Django]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>Authentication</tag>
        <tag>LDAP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue.js é€šè¿‡ Event Bus å®žçŽ° Components é—´çš„äº‹ä»¶é€šä¿¡ï¼ˆå®žä¾‹ï¼‰]]></title>
    <url>%2F2020%2F08%2F19%2Fvue-js-event-bus-for-communication-between-components%2F</url>
    <content type="text"><![CDATA[ä¸€ã€çŽ¯å¢ƒé…ç½® vue create productapp --default npm install bootstrap@4.0.0 npm install --save core-js äºŒã€æºä»£ç productapp/src/main.jsï¼š123456789101112131415import Vue from 'vue'import App from './App.vue'import "../node_modules/bootstrap/dist/css/bootstrap.min.css"Vue.config.productionTip = falsenew Vue(&#123; render: h =&gt; h(App), provide: function () &#123; return &#123; eventBus: new Vue() &#125; &#125;&#125;).$mount('#app') productapp/src/App.vueï¼š123456789101112131415161718192021&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-8 m-3&quot;&gt; &lt;product-display&gt;&lt;/product-display&gt; &lt;/div&gt; &lt;div class=&quot;col m-3&quot;&gt; &lt;product-editor&gt;&lt;/product-editor&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import ProductDisplay from &quot;./components/ProductDisplay&quot;;import ProductEditor from &quot;./components/ProductEditor&quot;;export default &#123; name: &quot;App&quot;, components: &#123; ProductDisplay, ProductEditor &#125;&#125;;&lt;/script&gt; productapp/src/components/ProductDisplay.vueï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;template&gt; &lt;div&gt; &lt;table class=&quot;table table-sm table-striped table-bordered&quot;&gt; &lt;tr&gt; &lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;&lt;th&gt;&lt;/th&gt; &lt;/tr&gt; &lt;tbody&gt; &lt;tr v-for=&quot;p in products&quot; v-bind:key=&quot;p.id&quot;&gt; &lt;td&gt;&#123;&#123; p.id &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.name &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.price &#125;&#125;&lt;/td&gt; &lt;td&gt; &lt;button class=&quot;btn btn-sm btn-primary&quot; @click=&quot;editProduct(p)&quot;&gt; Edit &lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import Vue from &quot;vue&quot;; export default &#123; data: function () &#123; return &#123; products: [ &#123; id: 1, name: &quot;Kayak&quot;, price: 275 &#125;, &#123; id: 2, name: &quot;Lifejacket&quot;, price: 48.95 &#125;, &#123; id: 3, name: &quot;Soccer Ball&quot;, price: 19.50 &#125;, &#123; id: 4, name: &quot;Corner Flags&quot;, price: 39.95 &#125;, &#123; id: 5, name: &quot;Stadium&quot;, price: 79500 &#125;] &#125; &#125;, methods: &#123; editProduct(product) &#123; this.eventBus.$emit(&quot;edit&quot;, product); &#125;, processComplete(product) &#123; let index = this.products.findIndex(p =&gt; p.id == product.id); if (index == -1) &#123; return; &#125; else &#123; Vue.set(this.products, index, product); &#125; &#125; &#125;, inject: [&quot;eventBus&quot;], created() &#123; this.eventBus.$on(&quot;complete&quot;, this.processComplete); &#125; &#125;&lt;/script&gt; productapp/src/components/ProductEditor.vueï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;template&gt; &lt;div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label&gt;ID&lt;/label&gt; &lt;input v-model.number=&quot;product.id&quot; class=&quot;form-control&quot; /&gt; &lt;label&gt;Name&lt;/label&gt; &lt;input v-model=&quot;product.name&quot; class=&quot;form-control&quot; /&gt; &lt;label&gt;Price&lt;/label&gt; &lt;input v-model.number=&quot;product.price&quot; class=&quot;form-control&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;text-center&quot;&gt; &lt;button class=&quot;btn btn-primary&quot; @click=&quot;save&quot;&gt;Save&lt;/button&gt; &lt;button class=&quot;btn btn-secondary&quot; @click=&quot;cancel&quot;&gt;Cancel&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function() &#123; return &#123; product: &#123;&#125; &#125;; &#125;, methods: &#123; startEdit(product) &#123; this.product = &#123; id: product.id, name: product.name, price: product.price &#125;; &#125;, save() &#123; this.eventBus.$emit(&quot;complete&quot;, this.product); console.log(`Edit Complete: $&#123;JSON.stringify(this.product)&#125;`); this.product = &#123;&#125; &#125;, cancel() &#123; this.product = &#123;&#125;; &#125; &#125;, inject: [&quot;eventBus&quot;], created() &#123; this.eventBus.$on(&quot;edit&quot;, this.startEdit); &#125;&#125;;&lt;/script&gt; ä¸‰ã€è¿è¡Œæ•ˆæžœ å‚è€ƒèµ„æ–™Pro Vue.js 2]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Vue</tag>
        <tag>Frontend</tag>
        <tag>JavaScript</tag>
        <tag>Components</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django REST framework æ¨¡åž‹ä¸­ Many-to-many å…³ç³»çš„åºåˆ—åŒ–]]></title>
    <url>%2F2020%2F08%2F19%2Fdjango-rest-framework-many-to-many-relations%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æ¨¡åž‹12345678910111213141516171819# blogs/models.pyfrom django.db import modelsclass TagModel(models.Model): tag = models.CharField(max_length=20, unique=True) description = models.CharField(max_length=100) class Meta: db_table = 'blog_tags'class PostModel(models.Model): title = models.CharField(max_length=50) update_date = models.DateTimeField(auto_now=True) tags = models.ManyToManyField(TagModel) class Meta: db_table = 'blog_posts' äºŒã€Serializers123456789101112131415# blogs/serializers.pyfrom rest_framework import serializersfrom blogs.models import TagModel, PostModelclass TagSerializer(serializers.ModelSerializer): class Meta: model = TagModel fields = '__all__'class PostSerializer(serializers.ModelSerializer): class Meta: model = PostModel fields = '__all__' ä¸‰ã€è§†å›¾1234567891011121314# blogs/views.pyfrom rest_framework.viewsets import ModelViewSetfrom blogs.models import TagModel, PostModelfrom blogs.serializers import TagSerializer, PostSerializerclass TagViewSet(ModelViewSet): queryset = TagModel.objects.all() serializer_class = TagSerializerclass PostViewSet(ModelViewSet): queryset = PostModel.objects.all() serializer_class = PostSerializer å››ã€URLs123456789101112# blogs/urls.pyfrom django.urls import include, pathfrom rest_framework import routersfrom blogs.views import TagViewSet, PostViewSetrouter = routers.DefaultRouter()router.register(r'tags', TagViewSet)router.register(r'posts', PostViewSet)urlpatterns = [ path('', include(router.urls))] ä¿®æ”¹é¡¹ç›®æ€»ä½“çš„ URL é…ç½® urls.pyï¼š1234567from django.contrib import adminfrom django.urls import path, includeurlpatterns = [ path('admin/', admin.site.urls), path('blog/', include('blogs.urls'))] äº”ã€æ•ˆæžœ123456789101112131415161718# GET http://127.0.0.1:8002/blog/tags/[ &#123; &quot;description&quot;: &quot;Technique for python programming&quot;, &quot;id&quot;: 1, &quot;tag&quot;: &quot;Python&quot; &#125;, &#123; &quot;description&quot;: &quot;Shell programming tricks&quot;, &quot;id&quot;: 2, &quot;tag&quot;: &quot;Shell&quot; &#125;, &#123; &quot;description&quot;: &quot;Linux system administration&quot;, &quot;id&quot;: 3, &quot;tag&quot;: &quot;Linux&quot; &#125;] 123456789101112# GET http://127.0.0.1:8002/blog/posts/[ &#123; &quot;id&quot;: 1, &quot;tags&quot;: [ 1, 3 ], &quot;title&quot;: &quot;Python for linux administration&quot;, &quot;update_date&quot;: &quot;2020-08-11T07:01:50.893976Z&quot; &#125;] å…­ã€è‡ªå®šä¹‰åºåˆ—åŒ–æ–¹å¼ä¸ºäº†åœ¨èŽ·å– posts åˆ—è¡¨æ—¶ï¼Œæ¯æ¡ post ä¸­çš„ tags ä¸ä»…ä»…æ˜¾ç¤º idï¼Œè¿˜æ˜¾ç¤ºå¯¹åº”çš„æ ‡ç­¾åç§°ã€‚ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223# blogs/serializers.pyfrom rest_framework import serializersfrom blogs.models import TagModel, PostModelclass TagSerializer(serializers.ModelSerializer): class Meta: model = TagModel fields = '__all__'class TagsReadOnly(serializers.ModelSerializer): class Meta: model = TagModel fields = ['id', 'tag']class PostSerializer(serializers.ModelSerializer): tags = TagsReadOnly(many=True) class Meta: model = PostModel fields = '__all__' æ•ˆæžœï¼š123456789101112131415161718# GET http://127.0.0.1:8002/blog/posts/[ &#123; &quot;id&quot;: 1, &quot;tags&quot;: [ &#123; &quot;id&quot;: 1, &quot;tag&quot;: &quot;Python&quot; &#125;, &#123; &quot;id&quot;: 3, &quot;tag&quot;: &quot;Linux&quot; &#125; ], &quot;title&quot;: &quot;Python for linux administration&quot;, &quot;update_date&quot;: &quot;2020-08-11T07:01:50.893976Z&quot; &#125;] ä½†æ­¤æ—¶è‹¥ä½¿ç”¨ POST æˆ– PUT æ–¹æ³•æ–°å¢žæˆ–æ›´æ–°æ•°æ®ï¼Œä¼šæŠ¥å‡ºå¦‚ä¸‹é”™è¯¯ï¼ˆå³åœ¨æ–°å¢žæˆ–ä¿®æ”¹ post çš„åŒæ—¶ï¼Œä¼šå°è¯•åˆ›å»ºå…³è”çš„ tagsï¼Œä½†è¿™äº› tags æœ¬å°±å·²ç»å­˜åœ¨ï¼Œä»Žè€Œå¯¼è‡´å†²çªï¼‰ï¼š123456789&#123; "tags": [ &#123; "tag": [ "tag model with this tag already exists." ] &#125; ]&#125; æµ‹è¯• POST å’Œ PUT åŠ¨ä½œæ—¶ä½¿ç”¨çš„ JSON æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š123456789&#123; "tags": [ &#123; "id": 1, "tag": "Python" &#125; ], "title": "An interesting post"&#125; ä¸ºäº†ä½¿ posts æŽ¥å£åœ¨æŽ¥æ”¶æ•°æ®æ—¶æ”¯æŒåˆ—è¡¨ç±»åž‹çš„ tagsï¼ˆç±»ä¼¼ &quot;tags&quot;: [1, 2, 3] è¿™ç§ï¼‰ä¸”èƒ½å¤ŸæˆåŠŸæ›´æ–°ï¼Œå¯ä»¥é€‰æ‹©è¦†ç›– PostSerializer çš„ to_internal_value å’Œ create æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829303132333435# blogs/serializers.pyfrom rest_framework import serializersfrom blogs.models import TagModel, PostModelclass TagSerializer(serializers.ModelSerializer): class Meta: model = TagModel fields = '__all__'class TagsReadOnly(serializers.ModelSerializer): class Meta: model = TagModel fields = ['id', 'tag']class PostSerializer(serializers.ModelSerializer): tags = TagsReadOnly(many=True) class Meta: model = PostModel fields = '__all__' def to_internal_value(self, data): return data def create(self, validated_data): tags_data = validated_data.pop('tags') post = PostModel.objects.create(**validated_data) tags = [TagModel.objects.get( pk=id) for id in tags_data] post.tags.set(tags) post.save() return post å…¶ä¸­ to_internal_value æ–¹æ³•ç”¨äºŽéªŒè¯å‰ç«¯ä¼ å…¥çš„æ•°æ®ï¼ˆä¸Šè¿°ä»£ç ä¸­ä¸åšä»»ä½•éªŒè¯ï¼‰ï¼›create æ–¹æ³•ç”¨äºŽæ–°å¢žæˆ–æ›´æ–°åŽå°æ•°æ®ã€‚ æ­¤æ—¶å†å‘ posts æŽ¥å£ POST æˆ– PUT æ•°æ®æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼š1234&#123; "tags": [1, 2, 3], "title": "An interesting post"&#125;]]></content>
      <tags>
        <tag>Python</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>REST</tag>
        <tag>API</tag>
        <tag>Relations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScriptï¼ˆECMAScript 6ï¼‰â€”â€” Proxy ä¸Ž Reflection API]]></title>
    <url>%2F2020%2F08%2F19%2Funderstanding-javascript-ecmascript6-proxy-and-reflection-api%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åˆ›å»º Proxy12345678910let target = &#123;&#125;let proxy = new Proxy(target, &#123;&#125;)proxy.name = "proxy"console.log(proxy.name) // proxyconsole.log(target.name) // proxytarget.name = "target"console.log(proxy.name) // targetconsole.log(target.name) // target åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”± Proxy æž„é€ å™¨åˆ›å»ºçš„ proxy å¯¹è±¡ä¼šå°†è‡ªèº«çš„æ‰€æœ‰æ“ä½œç›´æŽ¥è½¬å‘ç»™ targetã€‚å½“ proxy.name è¢«èµ‹å€¼ä¸º &quot;proxy&quot; æ—¶ï¼Œtarget å¯¹è±¡ä¹Ÿä¼šåˆ›å»º name å±žæ€§å¹¶èŽ·å¾—åŒæ ·çš„å€¼ã€‚å®žé™…ä¸Š proxy å¯¹è±¡æœ¬èº«å¹¶ä¸åˆ›å»ºå’Œå­˜å‚¨ name å±žæ€§ï¼Œå®ƒåªæ˜¯è½¬å‘å¯¹åº”çš„æ“ä½œç»™ targetã€‚ ç±»ä¼¼çš„ï¼Œproxy.name ä¸Ž target.name çš„å€¼å§‹ç»ˆä¿æŒä¸€è‡´ï¼Œå› ä¸ºå®ƒä»¬å®žé™…ä¸Šéƒ½æŒ‡å‘äº† target.nameã€‚è¿™ä¹Ÿæ„å‘³ç€ç»™ target.name èµ‹äºˆä¸€ä¸ªæ–°çš„å€¼æ—¶ï¼Œè¯¥å˜åŒ–ä¹Ÿä¼šåæ˜ åˆ° proxy.name ä¸Šã€‚ ä½¿ç”¨ set Trap éªŒè¯å±žæ€§Proxy å…è®¸å¼€å‘è€…ä¸»åŠ¨æ‹¦æˆªæœ¬è¯¥è½¬å‘ç»™ target å¯¹è±¡çš„åº•å±‚æ“ä½œï¼Œè¿™äº›æ‹¦æˆªè¡Œä¸ºé€šè¿‡ trap å®žçŽ°ã€‚æ¯ä¸ª trap éƒ½å¯ä»¥è¦†ç›– JavaScript å¯¹è±¡çš„æŸäº›å†…ç½®è¡Œä¸ºï¼Œå³ proxy å…è®¸é€šè¿‡ trap æ‹¦æˆªå¹¶ä¿®æ”¹æŒ‡å‘ target å¯¹è±¡çš„æ“ä½œã€‚ å‡è®¾éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°æ·»åŠ çš„å±žæ€§å€¼åªèƒ½æ˜¯æ•°å­—ç±»åž‹çš„å¯¹è±¡ï¼Œå°±å¯ä»¥å€ŸåŠ© set trap è¦†ç›–é»˜è®¤çš„èµ‹å€¼è¡Œä¸ºã€‚ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425let target = &#123; name: "target"&#125;let proxy = new Proxy(target, &#123; set(trapTarget, key, value, receiver) &#123; if (!trapTarget.hasOwnProperty(key)) &#123; if (isNaN(value)) &#123; throw new TypeError("New property must be a number.") &#125; &#125; return Reflect.set(trapTarget, key, value, receiver) &#125;&#125;)proxy.count = 1console.log(proxy.count) // 1console.log(target.count) // 1proxy.name = "proxy"console.log(proxy.name) // proxyconsole.log(target.name) // proxyproxy.anotherName = "proxy"// TypeError: New property must be a number. set trap ä¸­çš„å››ä¸ªå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š trapTargetï¼šæŽ¥æ”¶æ–°å±žæ€§çš„å¯¹è±¡ï¼ˆå³ proxy æŒ‡å‘çš„ targetï¼‰ keyï¼šæ–°å±žæ€§å¯¹åº”çš„ key valueï¼šæ–°å±žæ€§å¯¹åº”çš„ value receiverï¼šé€šå¸¸ä¸º proxy è‡ªèº« Reflect.set() æ˜¯ä¸Ž set trap ç›¸å¯¹åº”çš„åŽŸå§‹æ–¹æ³•ï¼Œè¡¨ç¤ºè¢«è¦†ç›–å‰çš„é»˜è®¤çš„èµ‹å€¼è¡Œä¸ºã€‚ ä½¿ç”¨ get Trap ä»¤ç¨‹åºè¯»å–ä¸å­˜åœ¨å±žæ€§æ—¶æŠ¥é”™JavaScript åœ¨è¯»å–ä¸å­˜åœ¨çš„å±žæ€§æ—¶å¹¶ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›ž undefinedã€‚12let target = &#123;&#125;console.log(target.name) // undefined å¯ä»¥å€ŸåŠ© get trap ä¿®æ”¹è¯»å–å¯¹è±¡å±žæ€§æ—¶çš„é»˜è®¤è¡Œä¸ºï¼š1234567891011121314let proxy = new Proxy(&#123;&#125;, &#123; get(trapTarget, key, receiver) &#123; if (!(key in receiver)) &#123; throw new TypeError("Property " + key + " doesn't exist.") &#125; return Reflect.get(trapTarget, key, receiver) &#125;&#125;)proxy.name = "proxy"console.log(proxy.name) // proxyconsole.log(proxy.nme)// TypeError: Property nme doesn't exist. é€šè¿‡ deleteProperty Trap é˜²æ­¢åˆ é™¤å±žæ€§JavaScript ä¸­ä½¿ç”¨ delete æ“ä½œç¬¦åˆ é™¤å¯¹è±¡çš„å±žæ€§ï¼š123456789101112131415let target = &#123; name: "target", value: 42&#125;Object.defineProperty(target, "name", &#123; configurable: false &#125;)console.log("value" in target) // truelet result1 = delete target.valueconsole.log(result1) // trueconsole.log("value" in target) // falselet result2 = delete target.nameconsole.log(result2) // falseconsole.log("name" in target) // true ä½¿ç”¨ deleteProxy Trap é˜²æ­¢å±žæ€§è¢«æ„å¤–åˆ é™¤ï¼š123456789101112131415161718192021222324let target = &#123; name: "target", value: 42&#125;let proxy = new Proxy(target, &#123; deleteProperty(trapTarget, key) &#123; if (key === "value") &#123; return false &#125; else &#123; return Reflect.deleteProperty(trapTarget, key) &#125; &#125;&#125;)console.log("value" in proxy) // truelet result1 = delete proxy.valueconsole.log(result1) // falseconsole.log("value" in proxy) // truelet result2 = delete proxy.nameconsole.log(result2) // trueconsole.log("name" in proxy) // false äºŒã€Proxy çš„çŽ°å®žåº”ç”¨logging12345678910111213141516171819202122function makeLoggable(target) &#123; return new Proxy(target, &#123; get: (target, property) =&gt; &#123; console.log("Reading " + property) return target[property] &#125;, set: (target, property, value) =&gt; &#123; console.log("Writing value " + value + " to " + property) target[property] = value &#125; &#125;)&#125;let ninja = &#123; name: "Yoshi" &#125;ninja = makeLoggable(ninja)console.log(ninja.name)ninja.weapon = "sword"// Reading name// Yoshi// Writing value sword to weapon æ€§èƒ½æµ‹è¯•123456789101112131415161718192021function isPrime(number) &#123; if (number &lt; 2) &#123; return false &#125; for (let i = 2; i &lt; number; i++) &#123; if (number % i === 0) &#123; return false &#125; &#125; return true&#125;isPrime = new Proxy(isPrime, &#123; apply: (target, thisArg, args) =&gt; &#123; console.time("isPrime") const result = target.apply(thisArg, args) console.timeEnd("isPrime") return result &#125;&#125;)console.log(isPrime(1358765377))// isPrime: 6815.107ms// true è‡ªåŠ¨æ·»åŠ å±žæ€§12345678910111213141516171819202122function Folder() &#123; return new Proxy(&#123;&#125;, &#123; get: (target, property) =&gt; &#123; console.log("Reading " + property) if(!(property in target)) &#123; target[property] = new Folder() &#125; return target[property] &#125; &#125;)&#125;const rootFolder = new Folder()rootFolder.ninjasDir.firstNinjaDir.ninjaFile = "yoshi.txt"// Reading ninjasDir// Reading firstNinjaDirconsole.log(rootFolder.ninjasDir.firstNinjaDir.ninjaFile)// Reading ninjasDir// Reading firstNinjaDir// Reading ninjaFile// yoshi.txt å‚è€ƒèµ„æ–™Understanding ECMAScript 6Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>JavaScript</tag>
        <tag>Proxy</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript è§£å¯† â€”â€” ç†è§£å¯¹è±¡]]></title>
    <url>%2F2020%2F08%2F06%2Fsecrets-of-javascript-understanding-objects%2F</url>
    <content type="text"><![CDATA[ä¸€ã€prototypesPrototype æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­å®šä¹‰çš„å±žæ€§å’ŒåŠŸèƒ½å¯ä»¥è‡ªåŠ¨è¢«å…¶ä»–å¯¹è±¡è®¿é—®ã€‚Prototype å¯ä»¥å‘æŒ¥ç±»ä¼¼äºŽä¼ ç»Ÿçš„ OO è¯­è¨€ä¸­ç±»çš„ä½œç”¨ï¼Œäº‹å®žä¸Š JavaScript ä¸­çš„ prototype ä¸»è¦ç”¨é€”å°±æ˜¯ç¼–å†™ OO å½¢å¼çš„ä»£ç ã€‚ åœ¨ JavaScript ä¸­ï¼Œå¯¹è±¡è¡¨ç¤ºä¸€ç³»åˆ—å·²å‘½åçš„å±žæ€§åŠå…¶å±žæ€§å€¼çš„åˆé›†ã€‚12345let obj = &#123; prop1: 1, // å±žæ€§å€¼ä¸ºåŸºæœ¬ç±»åž‹ prop2: function () &#123;&#125;, // å±žæ€§å€¼ä¸ºå‡½æ•° prop3: &#123;&#125; // å±žæ€§å€¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡&#125; å…³è”åˆ°æŸä¸ªå¯¹è±¡ä¸Šçš„å±žæ€§å¯ä»¥å¾ˆå®¹æ˜“åœ°è¢«ä¿®æ”¹æˆ–åˆ é™¤ã€‚123456789101112let obj = &#123; prop1: 1, // å±žæ€§å€¼ä¸ºåŸºæœ¬ç±»åž‹ prop2: function () &#123;&#125;, // å±žæ€§å€¼ä¸ºå‡½æ•° prop3: &#123;&#125; // å±žæ€§å€¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡&#125;obj.prop1 = [] // å°† prop1 å±žæ€§çš„å€¼æ”¹ä¸ºå…¶ä»–ç±»åž‹delete obj.prop2 // åˆ é™¤æŸä¸ªå±žæ€§obj.prop4 = "Hello" // æ·»åŠ ä¸€ä¸ªæ–°çš„å±žæ€§console.log(obj)// &#123; prop1: [], prop3: &#123;&#125;, prop4: 'Hello' &#125; æ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥æ‹¥æœ‰ä¸€ä¸ª prototype çš„å¼•ç”¨ï¼Œåœ¨å¯¹è±¡æœ¬èº«ä¸åŒ…å«æŸä¸ªå±žæ€§æ—¶ï¼Œå¯ä»¥ç”± prototype å¯¹è±¡åŽ»å¯»æ‰¾è¯¥å±žæ€§ã€‚12345678910111213141516171819const yoshi = &#123; skulk: true &#125;const hattori = &#123; sneak: true &#125;const kuma = &#123; creep: true &#125;console.log("skulk" in yoshi) // trueconsole.log("sneak" in yoshi) // falseconsole.log("creep" in yoshi) // false// é€šè¿‡ setPrototypeOf æ–¹æ³•å°† hattori è®¾ç½®ä¸º// yoshi å¯¹è±¡çš„ prototypeï¼Œyoshi æ­¤æ—¶å¯ä»¥è®¿é—® sneak å±žæ€§Object.setPrototypeOf(yoshi, hattori)console.log("sneak" in yoshi) // trueconsole.log("creep" in yoshi) // false// å°† kuma è®¾ç½®ä¸º hattori å¯¹è±¡çš„ prototypeï¼Œ// yoshi æ­¤æ—¶å¯ä»¥è®¿é—® creep å±žæ€§Object.setPrototypeOf(hattori, kuma)console.log("sneak" in yoshi) // trueconsole.log("creep" in yoshi) // true prototype ä¸Žå¯¹è±¡æž„å»ºJavaScript ä¸­ï¼Œæœ€ç®€å•çš„åˆ›å»ºæ–°å¯¹è±¡çš„è¯­æ³•å¦‚ä¸‹ï¼š123456const warrior = &#123;&#125;warrior.name = 'Saito'warrior.occupation = 'marksman'console.log(warrior)// &#123; name: 'Saito', occupation: 'marksman' &#125; å¯¹äºŽæœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹èƒŒæ™¯çš„äººæ¥è¯´ï¼Œä¸Šè¿°æ–¹å¼çœ‹ä¸ŠåŽ»ç¼ºå°‘äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚æ²¡æœ‰ä¸€ä¸ªç”¨æ¥åˆå§‹åŒ–å¯¹è±¡çš„ç±»æž„é€ å™¨ã€‚æ­¤å¤–å¦‚æžœéœ€è¦åŒæ—¶åˆ›å»ºå¤šä¸ªç›¸åŒç±»åž‹çš„å¯¹è±¡ï¼Œæ‰‹åŠ¨åœ°ä¸€ä¸ªä¸€ä¸ªä¸ºå¯¹è±¡å…³è”å±žæ€§åˆ™å·¥ä½œé‡å¤ªå¤§ä¸”å®¹æ˜“å‡ºé—®é¢˜ã€‚ å’Œå…¶ä»–å¸¸è§çš„ OO è¯­è¨€ç±»ä¼¼ï¼ŒJavaScript ä¹Ÿæ˜¯ä½¿ç”¨ new å…³é”®å­—é€šè¿‡æž„é€ å™¨åˆå§‹åŒ–å¯¹è±¡ã€‚åªä¸è¿‡è¯¥è¿‡ç¨‹ä¸­è¢«æœªå‡ºçŽ°ç±»çš„å®šä¹‰ï¼Œnew å…³é”®å­—å®žé™…ä¸Šè°ƒç”¨çš„æ˜¯æž„é€ å™¨å‡½æ•°ã€‚123456789101112131415function Ninja() &#123;&#125;// æ¯ä¸ªå‡½æ•°éƒ½åŒ…å«ä¸€ä¸ªå†…ç½®çš„ prototype å¯¹è±¡ï¼Œå¯ä»¥è¢«éšæ„ä¿®æ”¹Ninja.prototype.swingSword = function () &#123; return true&#125;// ä½œä¸ºå‡½æ•°è°ƒç”¨ Ninja()ï¼Œä¸ä¼šåˆ›å»ºä»»ä½•å¯¹è±¡const ninja1 = Ninja()console.log(ninja1) // undefined// ä½œä¸ºæž„é€ å™¨è°ƒç”¨ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡è¢«åˆ›å»ºä¸”ä½œä¸ºæž„é€ å™¨å‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼ˆthisï¼‰ï¼Œ// æž„é€ å™¨å‡½æ•°çš„ prototype æˆä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„ prototypeconst ninja2 = new Ninja()console.log(ninja2) // Ninja &#123;&#125;console.log(ninja2.swingSword()) // true å½“æŸä¸ªå‡½æ•°ä½œä¸ºæž„é€ å™¨å‡½æ•°ä½¿ç”¨æ—¶ï¼Œæž„é€ å™¨å‡½æ•°çš„ prototype å°†æˆä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„ prototypeã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”¨ swingSword æ–¹æ³•æ‰©å±•äº† Ninja.prototypeï¼Œå½“ ninja2 å¯¹è±¡è¢«åˆ›å»ºåŽï¼Œå…¶ prototype å°±è¢«è®¾ç½®æˆ Ninja çš„ prototypeã€‚å› æ­¤ï¼Œå½“åŽé¢æˆ‘ä»¬è®¿é—® ninja2 å¯¹è±¡çš„ swingSword å±žæ€§æ—¶ï¼Œå¯¹äºŽå±žæ€§å€¼çš„æœç´¢æœ€ç»ˆä¼ é€’ç»™ Ninja çš„ prototype å¯¹è±¡ã€‚æ­¤å¤–ï¼Œæ‰€æœ‰é€šè¿‡ Ninja æž„é€ å™¨åˆ›å»ºçš„å¯¹è±¡éƒ½å¯ä»¥è®¿é—® swingSword æ–¹æ³•ã€‚ å®žä¾‹å±žæ€§å½“å‡½æ•°é€šè¿‡ new å…³é”®å­—ä½œä¸ºæž„é€ å™¨è°ƒç”¨æ—¶ï¼Œå…¶æœ¬èº«å³æˆä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„ä¸Šä¸‹æ–‡ã€‚é™¤äº†é€šè¿‡ prototype æš´éœ²å±žæ€§å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ this å…³é”®å­—åœ¨æž„é€ å™¨å‡½æ•°ä¸­åˆå§‹åŒ–å¯¹è±¡å®žä¾‹ã€‚12345678910111213141516function Ninja() &#123; this.swung = false // instance method this.swingSword = function () &#123; return !this.swung &#125;&#125;// prototype methodNinja.prototype.swingSword = function () &#123; return this.swung&#125;const ninja = new Ninja()console.log(ninja.swingSword()) // true ä¸Šé¢ä»£ç çš„æ‰§è¡Œç»“æžœè¡¨æ˜Žï¼Œå®žä¾‹æ–¹æ³•ä¼šè¦†ç›–åŒåçš„ prototype æ–¹æ³•ã€‚ åœ¨æž„é€ å™¨å‡½æ•°ä¸­ï¼Œthis å…³é”®å­—æŒ‡å‘é€šè¿‡ new åˆ›å»ºçš„å¯¹è±¡ã€‚å› æ­¤æž„é€ å™¨ä¸­æ·»åŠ çš„å±žæ€§ä¼šç›´æŽ¥åœ¨æ–°çš„ ninja å¯¹è±¡ä¸­åˆ›å»ºã€‚å½“æˆ‘ä»¬éœ€è¦è®¿é—® ninja å¯¹è±¡çš„ swingSword å±žæ€§æ—¶ï¼Œæœ¬å°±æ²¡æœ‰å¿…è¦å†ä»Ž prototype ä¸­æœç´¢ã€‚ninja å¯¹è±¡æœ¬èº«å·²ç»æœ‰äº†é€šè¿‡æž„é€ å™¨åˆ›å»ºçš„åŒåçš„å®žä¾‹å±žæ€§ã€‚ ç®€å•æ¥è¯´ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½åŒ…å«è‡ªå·±ç‰ˆæœ¬çš„é€šè¿‡æž„é€ å™¨åˆ›å»ºçš„å±žæ€§ï¼ŒåŒæ—¶ä¹Ÿéƒ½èƒ½å¤Ÿè®¿é—® prototype çš„å±žæ€§ï¼ˆåå­—ç›¸åŒæ—¶å®žä¾‹å±žæ€§ä¼˜å…ˆï¼‰ã€‚ Side effects123456789101112131415161718192021222324252627282930// å®šä¹‰ä¸€ä¸ªæž„é€ å™¨å‡½æ•°ï¼Œå…·æœ‰ swung å±žæ€§function Ninja() &#123; this.swung = true&#125;// é€šè¿‡ new è°ƒç”¨æž„é€ å™¨å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ª Ninja çš„å®žä¾‹const ninja1 = new Ninja()// åœ¨ ninja1 å®žä¾‹åˆ›å»ºä¹‹åŽï¼Œä¸º prototype æ·»åŠ  swingSword æ–¹æ³•Ninja.prototype.swingSword = function() &#123; return this.swung&#125;// å³ä¾¿ swingSword æ–¹æ³•æ˜¯åŽé¢æ·»åŠ åˆ° prototype çš„ï¼Œninja1 å®žä¾‹ä»èƒ½è®¿é—®console.log(ninja1.swingSword()) // true// å®Œå…¨è¦†ç›– Ninja çš„ prototypeNinja.prototype = &#123; pierce: function() &#123; return true &#125;&#125;// Ninja çš„ prototype è¢«å®Œå…¨æ›¿æ¢åŽï¼Œninja1 å®žä¾‹ä»èƒ½è®¿é—® swingSword æ–¹æ³•console.log(ninja1.swingSword()) // true// å†æ¬¡æ–°å»º ninja2 å®žä¾‹ï¼Œæ­¤æ—¶è¯¥å®žä¾‹ä¸èƒ½è®¿é—® swingSword ä½†å¯ä»¥è®¿é—® pierce æ–¹æ³•const ninja2 = new Ninja()console.log(ninja2.pierce()) // trueconsole.log(ninja2.swingSword) // undefined ä»Žä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæž„é€ å™¨å‡½æ•°çš„ prototype å¯ä»¥éšæ„è¢«æ›¿æ¢ï¼Œä½†ä¹‹å‰å·²ç»ç”Ÿæˆçš„å¯¹è±¡å®žä¾‹ä»æŒ‡å‘æ—§çš„ prototypeã€‚ Object typing123456789function Ninja() &#123;&#125;const ninja = new Ninja()console.log(typeof ninja) // objectconsole.log(ninja instanceof Ninja) // trueconsole.log(ninja.constructor === Ninja) // trueconst ninja2 = new ninja.constructor()console.log(ninja2 instanceof Ninja) // true instanceof æ“ä½œç¬¦å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®å®šæŸä¸ªå¯¹è±¡å®žä¾‹æ˜¯å¦ç”±æŸä¸ªç‰¹å®šçš„æž„é€ å™¨åˆ›å»ºã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å€ŸåŠ©èƒ½å¤Ÿè¢«æ‰€æœ‰å®žä¾‹è®¿é—®çš„ constructor å±žæ€§ï¼Œå› ä¸ºè¯¥å±žæ€§ä¸€å®šæŒ‡å‘åŽŸå§‹çš„æž„é€ å™¨å‡½æ•°ã€‚åˆå› ä¸º constructor å±žæ€§æ˜¯å¯¹åŽŸå§‹æž„é€ å™¨çš„å¼•ç”¨ï¼Œå®ƒå› æ­¤ä¹Ÿå¯ä»¥ç”¨æ¥å®žä¾‹åŒ–æ–°çš„å¯¹è±¡ã€‚ äºŒã€ç»§æ‰¿é€šè¿‡ prototype å®žçŽ°ç»§æ‰¿12345678910function Person() &#123;&#125;Person.prototype.dance = function() &#123;&#125;function Ninja() &#123;&#125;Ninja.prototype = new Person()const ninja = new Ninja()console.log(ninja instanceof Ninja) // trueconsole.log(ninja instanceof Person) // trueconsole.log(typeof ninja.dance) // function å½“æˆ‘ä»¬é€šè¿‡ ninja å¯¹è±¡è®¿é—® dance æ–¹æ³•æ—¶ï¼ŒJavaScript è¿è¡Œæ—¶é¦–å…ˆè¯•ç€æ£€æŸ¥ ninja å¯¹è±¡æœ¬èº«ã€‚ninja æœ¬èº«å¹¶ä¸åŒ…å« dance å±žæ€§ï¼Œå› æ­¤ ninja å¯¹è±¡çš„ prototypeï¼ˆå³ person å¯¹è±¡ï¼‰ç»§ç»­è¢«æœç´¢ã€‚person å¯¹è±¡ä¹Ÿä¸åŒ…å« dance å±žæ€§ï¼Œæœ€ç»ˆ person å¯¹è±¡çš„ prototype è¢«æœç´¢æ£€æŸ¥ï¼Œdance æ–¹æ³•è¢«æ‰¾åˆ°ã€‚è¿™å°±æ˜¯ JavaScript ä¸­å®žçŽ°ç»§æ‰¿çš„æ–¹å¼ã€‚ è¦†ç›– constructor å±žæ€§å¼•å‘çš„é—®é¢˜åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„ Person å¯¹è±¡ä½œä¸º Ninja æž„é€ å™¨çš„ prototypeï¼Œä»¤ Ninja æˆä¸º Person çš„å­ç±»ã€‚è¿™ç§æ–¹å¼ä¼šå¯¼è‡´åŽŸå§‹çš„ Ninja prototype è¢«æ›¿æ¢ï¼Œå³ä¸¢å¤± constructor å±žæ€§ã€‚è€Œ constructor å±žæ€§å¯¹äºŽåˆ¤æ–­å¯¹è±¡çš„èµ·æºéžå¸¸é‡è¦ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ Object.defineProperty æ–¹æ³•ä¸ºæ–°çš„ Ninja.prototype æ·»åŠ  constructor å±žæ€§ï¼Œå°†å…¶å€¼è®¾ç½®ä¸º Ninjaï¼š1234567891011121314function Person() &#123;&#125;Person.prototype.dance = function() &#123;&#125;function Ninja() &#123;&#125;Ninja.prototype = new Person()Object.defineProperty(Ninja.prototype, "constructor", &#123; enumerable: false, value: Ninja, writable: true&#125;)var ninja = new Ninja()console.log(ninja.constructor === Ninja) // true ä¸‰ã€ES6 ä¸­çš„ classES6 ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ class å…³é”®å­—ï¼Œä¸ºåˆ›å»ºå¯¹è±¡ã€å®žçŽ°ç»§æ‰¿æä¾›äº†ä¸€ç§æ›´ä¸ºä¼˜é›…çš„æ–¹å¼ï¼Œä¸å¿…å†è‡ªå·±é€šè¿‡ prototype æ‰‹åŠ¨å®žçŽ°ã€‚12345678910111213class Ninja&#123; constructor(name) &#123; this.name = name &#125; swingSword() &#123; return true &#125;&#125;var ninja = new Ninja("Yoshi")console.log(ninja instanceof Ninja) // trueconsole.log(ninja.name) // Yoshiconsole.log(ninja.swingSword()) // true class å…³é”®å­—å®žé™…ä¸Šæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œä¸Šè¿°ä»£ç ç­‰åŒäºŽ ES5 ä¸­çš„å¦‚ä¸‹ä»£ç ï¼š123456789101112function Ninja(name) &#123; this.name = name&#125;Ninja.prototype.swingSword = function() &#123; return true&#125;var ninja = new Ninja('Yoshi')console.log(ninja instanceof Ninja) // trueconsole.log(ninja.name) // Yoshiconsole.log(ninja.swingSword()) // true static methods12345678910111213141516171819class Ninja&#123; constructor(name, level) &#123; this.name = name this.level = level &#125; swingSword() &#123; return true &#125; static compare(ninja1, ninja2) &#123; return ninja1.level - ninja2.level &#125;&#125;var ninja1 = new Ninja("Yoshi", 4)var ninja2 = new Ninja("Hattori", 3)console.log("compare" in ninja1 || "compare" in ninja2) // falseconsole.log(Ninja.compare(ninja1, ninja2) &gt; 0) // trueconsole.log("swingSword" in Ninja) // false compare è¿™ç§ static methods æ˜¯ç±»çº§åˆ«çš„ä»£ç ï¼Œåœ¨ ES6 ä¹‹å‰çš„ä»£ç ä¸­ï¼Œå¯ä»¥è¿™æ ·å®žçŽ°ï¼š12function Ninja() &#123;&#125;Ninja.compare = function(ninja1, ninja2) &#123; ... &#125; ç»§æ‰¿1234567891011121314151617181920212223242526272829303132class Person &#123; constructor(name) &#123; this.name = name &#125; dance() &#123; return true &#125;&#125;class Ninja extends Person &#123; constructor(name, weapon) &#123; super(name) this.weapon = weapon &#125; wieldWeapon() &#123; return true &#125;&#125;var person = new Person("Bob")console.log(person instanceof Person) // trueconsole.log(person.dance()) // trueconsole.log(person.name) // Bobconsole.log(person instanceof Ninja) // falseconsole.log(person.wieldWeapon) // undefinedvar ninja = new Ninja("Yoshi", "Wakizashi")console.log(ninja instanceof Ninja) // trueconsole.log(ninja.wieldWeapon()) // trueconsole.log(ninja instanceof Person) // trueconsole.log(ninja.name) // Yoshiconsole.log(ninja.dance()) // true å‚è€ƒèµ„æ–™Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>JavaScript</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
        <tag>Inherit</tag>
        <tag>Object</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScriptï¼ˆECMAScript 6ï¼‰â€”â€” Sets ä¸Ž Maps]]></title>
    <url>%2F2020%2F08%2F05%2Funderstanding-javascript-ecmascript-6-sets-and-maps%2F</url>
    <content type="text"><![CDATA[ä¸€ã€ECMAScript 5 ä¸­çš„ Sets å’Œ Mapsåœ¨ ECMAScript 5 ä¸­ï¼Œé€šå¸¸ä½¿ç”¨å¯¹è±¡å±žæ€§æ¥æ¨¡æ‹Ÿ set å’Œ map æ•°æ®ç±»åž‹ï¼š1234567var set = Object.create(null)set.foo = trueif (set.foo) &#123; // code to execute&#125; ç”¨å¯¹è±¡å±žæ€§ä½œä¸º set ä¸­çš„éžé‡å¤é”®å€¼ï¼Œå°†å€¼è®¾ç½®ä¸º true è¡¨æ˜Žå…¶å­˜åœ¨æ€§ã€‚ 12345var map = Object.create(null)map.foo = "bar"var value = map.fooconsole.log(value) // bar ä¸åŒäºŽ setï¼Œmap å¸¸å¸¸éœ€è¦èŽ·å–å…¶ä¸­ä¿å­˜çš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…ç”¨äºŽæ£€æŸ¥ key æ˜¯å¦å­˜åœ¨ã€‚ å­˜åœ¨çš„é—®é¢˜ç”¨å¯¹è±¡ä½œä¸º set å’Œ map é€‚ç”¨äºŽç®€å•çš„åœºæ™¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯¹è±¡å±žæ€§ä¼šæ˜¾éœ²å‡ºä¸€å®šçš„å±€é™æ€§ã€‚æ¯”å¦‚æ‰€æœ‰çš„å¯¹è±¡å±žæ€§éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œå› æ­¤åŒä¸€ä¸ªå¯¹è±¡ä¸­ç»ä¸èƒ½åŒ…å«å¤šä¸ªï¼ˆè½¬æ¢æˆå­—ç¬¦ä¸²åŽï¼‰ä¸€è‡´çš„é”®ã€‚1234var map = Object.create(null)map[5] = "foo"console.log(map["5"]) // foo æ•°å­—ç±»åž‹çš„é”® 5 å®žé™…ä¸Šåœ¨å†…éƒ¨ä¼šè¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸² &quot;5&quot;ï¼Œå› æ­¤ map[5] å’Œ map[&quot;5&quot;] æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå€¼ã€‚ åˆæ¯”å¦‚ï¼š123456var map = Object.create(null)var key1 = &#123;&#125;var key2 = &#123;&#125;map[key1] = "foo"console.log(map[key2]) // foo ä¸Šé¢ä»£ç ä¸­çš„ map[key1] å’Œ map[key2] ä¹Ÿæ˜¯æŒ‡å‘åŒä¸€å€¼çš„ã€‚å› ä¸ºå¯¹è±¡ key1 å’Œ key2 è½¬æ¢ä¸ºå­—ç¬¦ä¸²åŽçš„å€¼åŒä¸º &quot;[object Object]&quot;ã€‚ äºŒã€ECMAScript 6 ä¸­çš„ SetsECMAScript 6 ä¸­æ·»åŠ äº† Set ç±»åž‹ï¼Œå³ä¸€ä¸ªåŒ…å«ä¸é‡å¤çš„æœ‰åºå€¼çš„åˆ—è¡¨ã€‚12345678910111213let set = new Set()set.add(5)set.add("5")console.log(set) // Set &#123; 5, '5' &#125;let set2 = new Set()let key1 = &#123;&#125;let key2 = &#123;&#125;set2.add(key1)set2.add(key2)console.log(set2.size) // 2 ä½¿ç”¨ set åŽ»é‡ï¼š123456789101112let set = new Set()set.add(5)set.add("5")set.add(5)console.log(set) // Set &#123; 5, '5' &#125;let set2 = new Set([1, 2, 3, 4, 5, 5, 5, 5])console.log(set2) // Set &#123; 1, 2, 3, 4, 5 &#125;console.log(set2.has(2)) // trueconsole.log(set2.has(6)) // false forEachï¼š1234567891011let set = new Set([1, 2])set.forEach(function(value, key, ownerSet) &#123; console.log(key + " " + value) console.log(ownerSet === set)&#125;)// 1 1// true// 2 2// true å¦‚æžœéœ€è¦åœ¨ forEach() çš„å›žè°ƒå‡½æ•°ä¸­ä½¿ç”¨ thisï¼Œå¯ä»¥å°† this ä½œä¸º forEach() çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼š12345678910111213141516let set = new Set([1, 2])let processor = &#123; output(value) &#123; console.log(value) &#125;, process(dataSet) &#123; dataSet.forEach(function(value) &#123; this.output(value) &#125;, this) &#125;&#125;processor.process(set)// 1// 2 Set ä¸Ž Array çš„äº’æ¢ï¼š1234567let set = new Set([1, 2, 3, 3, 3, 4, 5])console.log(set)// Set &#123; 1, 2, 3, 4, 5 &#125;let array = [...set]console.log(array)// [ 1, 2, 3, 4, 5 ] 12345678function removeDuplicates(items) &#123; return [...new Set(items)]&#125;let numbers = [1, 2, 3, 3, 3, 4, 5]let noDuplicates = removeDuplicates(numbers)console.log(noDuplicates)// [ 1, 2, 3, 4, 5 ] ä¸‰ã€ECMAScript 6 ä¸­çš„ Maps123456let map = new Map()map.set("title", "Understanding ECMAScript 6")map.set("year", 2016)console.log(map.get("title")) // Understanding ECMAScript 6console.log(map.get("year")) // 2016 å¯ä»¥ä½¿ç”¨å¯¹è±¡ä½œä¸º Map ä¸­çš„é”®ï¼Œè¿™äº›é”®ä¸ä¼šè½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ï¼Œä¸”éƒ½æ˜¯å”¯ä¸€çš„ï¼š123456789let map = new Map()let key1 = &#123;&#125;let key2 = &#123;&#125;map.set(key1, 5)map.set(key2, 42)console.log(map.get(key1)) // 5console.log(map.get(key2)) // 42 Map æ–¹æ³•ï¼š1234567891011121314151617let map = new Map()map.set("name", "Nicholas")map.set("age", 25)console.log(map.size) // 2console.log(map.has("name")) // trueconsole.log(map.get("name")) // Nicholasmap.delete("name")console.log(map.has("name")) // falseconsole.log(map.get("name")) // undefinedconsole.log(map.size) // 1map.clear()console.log(map.has("age")) // falseconsole.log(map.get("age")) // undefinedconsole.log(map.size) // 0 forEachï¼š12345678910let map = new Map([["name", "Nicholas"], ["age", 25]])map.forEach(function(value, key, ownerMap) &#123; console.log(key + " " + value) console.log(ownerMap === map)&#125;)// name Nicholas// true// age 25// true å‚è€ƒèµ„æ–™Understanding ECMAScript 6]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>JavaScript</tag>
        <tag>EMCAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScriptï¼ˆECMAScript 6ï¼‰â€”â€” æ‰©å±•çš„å¯¹è±¡]]></title>
    <url>%2F2020%2F08%2F05%2Funderstanding-javascript-ecmascript-6-expanded-object%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å¯¹è±¡å­—é¢é‡å¯¹è±¡å­—é¢é‡ï¼ˆobject literalï¼‰æ˜¯ JavaScript ä¸­æœ€å¸¸è§çš„æ¨¡å¼ä¹‹ä¸€ï¼ŒJSON å³åŸºäºŽå®ƒçš„è¯­æ³•ã€‚ åœ¨ ECMAScript 5 åŠæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œå¯¹è±¡å­—é¢é‡å³ä¸€ç³»åˆ—ç®€å•çš„é”®å€¼å¯¹çš„é›†åˆï¼š123456789function createPerson(name, age) &#123; return &#123; name: name, age: age &#125;;&#125;console.log(createPerson('Jack', 16))// &#123; name: 'Jack', age: 16 &#125; è€Œåœ¨ ECMAScript 6 ä¸­ï¼Œåˆ™å¯ä»¥é€šè¿‡ property initializer çš„ç®€å†™è¯­æ³•çœç•¥ä¸Šè¿°ä»£ç ä¸­çš„éƒ¨åˆ†é‡å¤å†…å®¹ï¼š123456789function createPerson(name, age) &#123; return &#123; name, age &#125;&#125;console.log(createPerson('Jack', 16))// &#123; name: 'Jack', age: 16 &#125; å¦‚æžœä¸€ä¸ªå¯¹è±¡å­—é¢é‡åªç»™å‡ºåå­—è€Œæ²¡æœ‰å€¼ï¼Œåˆ™ JavaScript å¼•æ“Žä¼šåœ¨å‘¨å›´çš„ä½œç”¨åŸŸä¸­å¯»æ‰¾åŒåçš„å˜é‡ï¼Œå°†å…¶å€¼èµ‹å€¼ç»™å¯¹è±¡å­—é¢é‡ä¸­å¯¹åº”çš„åå­—ã€‚ æ–¹æ³•ç®€åŒ–ECMAScript 6 åŒæ ·ç®€åŒ–äº†å°†æ–¹æ³•å…³è”ç»™æŸä¸ªå¯¹è±¡å­—é¢é‡çš„è¯­æ³•ã€‚ ECMAScript 5 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³•ï¼š123456789var person = &#123; name: "Nicholas", sayName: function() &#123; console.log(this.name) &#125;&#125;;person.sayName()// Nicholas ECMAScript 6 åˆ™æ”¯æŒæ›´ç®€å•çš„è¯­æ³•ï¼š123456789var person = &#123; name: "Nicholas", sayName() &#123; console.log(this.name) &#125;&#125;;person.sayName()// Nicholas Computed Property Namesåœ¨ ECMAScript 5 å’Œæ—©æœŸç‰ˆæœ¬ä¸­ï¼Œå…è®¸åœ¨å¯¹è±¡å®žä¾‹ä¸Šä½¿ç”¨ç”±ä¸­æ‹¬å·ï¼ˆ[]ï¼‰åŒ…å›´çš„è®¡ç®—å±žæ€§ã€‚ç›¸å¯¹äºŽç”±ç‚¹ï¼ˆ.ï¼‰æŒ‡ç¤ºçš„å±žæ€§ï¼Œç”±ä¸­æ‹¬å·åŒ…è£¹çš„å±žæ€§å¯ä»¥ä½¿ç”¨å˜é‡æˆ–è€…æœ‰å¯èƒ½å¯¼è‡´è¯­æ³•é”™è¯¯çš„å­—ç¬¦ä¸²ä½œä¸ºå±žæ€§åã€‚1234567891011var person = &#123;&#125;var lastName = "last name"person["first name"] = "Nicholas"person[lastName] = "Zakas"person.age = 16console.log(person["first name"])console.log(person[lastName])// Nicholas// Zakas ECMAScript 6 ä¸­è®¡ç®—å±žæ€§çš„è¯­æ³•åˆ™æ›´åŠ çµæ´»ï¼š1234567891011let lastName = "last name"let person = &#123; "first name": "Nicholas", [lastName]: "Zakas"&#125;console.log(person["first name"])console.log(person[lastName])// Nicholas// Zakas ç”šè‡³å¯ä»¥åœ¨ä¸­æ‹¬å·ä¸­ä½¿ç”¨è¡¨è¾¾å¼ä½œä¸ºè®¡ç®—å±žæ€§åï¼š1234567891011var suffix = " name"var person = &#123; ["first" + suffix]: "Nicholas", ["last" + suffix]: "Zakas"&#125;console.log(person["first name"])console.log(person["last name"])// Nicholas// Zakas äºŒã€æ–°æ–¹æ³•Object.is()åœ¨ JavaScript ä¸­æ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨ç›¸ç­‰æ“ä½œç¬¦ï¼ˆ==ï¼‰æˆ–ç›¸åŒæ“ä½œç¬¦ï¼ˆ===ï¼‰ã€‚å¤§éƒ¨åˆ†å¼€å‘è€…ä¼šå€¾å‘äºŽä½¿ç”¨åŽè€…ã€‚ä½† === æ“ä½œç¬¦å¹¶éžå®Œå…¨å‡†ç¡®ï¼Œæ¯”å¦‚ +0 å’Œ -0 ä¼šè¢«è®¤ä¸ºç›¸åŒï¼Œè€Œ NaN === NaN ä¼šè¿”å›ž falseã€‚ ECMAScript 6 ä¸­å¼•å…¥äº† Object.is() æ–¹æ³•å¯ä»¥è§£å†³ === ä¸­å­˜åœ¨çš„ä¸å‡†ç¡®çš„é—®é¢˜ã€‚1234567891011121314console.log(+0 == -0) // trueconsole.log(+0 === -0) // trueconsole.log(Object.is(+0, -0)) // falseconsole.log(NaN == NaN) // falseconsole.log(NaN === NaN) // falseconsole.log(Object.is(NaN, NaN)) // trueconsole.log(5 == 5) // trueconsole.log(5 == "5") // trueconsole.log(5 === 5) // trueconsole.log(5 === "5") // falseconsole.log(Object.is(5, 5)) // trueconsole.log(Object.is(5, "5")) // false Object.assign()Mixins æ˜¯ JavaScript ä¸­æœ€æµè¡Œçš„æž„å»ºå¯¹è±¡çš„æ–¹å¼ä¹‹ä¸€ã€‚é€šè¿‡ mixinï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥æŽ¥æ”¶å¦ä¸€ä¸ªå¯¹è±¡ä¸­å®šä¹‰çš„å±žæ€§å’Œæ–¹æ³•ã€‚å…¶åº•å±‚åŽŸç†ç±»ä¼¼äºŽå¦‚ä¸‹ä»£ç ï¼š1234567891011121314151617181920function mixin(receiver, supplier) &#123; Object.keys(supplier).forEach(function(key) &#123; receiver[key] = supplier[key] &#125;) return receiver&#125;let person1 = &#123; name: "Jack", age: 16&#125;let person2 = &#123; name: "Rose", gender: "F"&#125;mixin(person1, person2)console.log(person1)// &#123; name: 'Rose', age: 16, gender: 'F' &#125; mixin() å‡½æ•°éåŽ† supplier å¯¹è±¡çš„å±žæ€§ï¼Œå°†å®ƒä»¬å¤åˆ¶ç»™ receiverï¼ˆæ³¨æ„æ˜¯æµ…å¤åˆ¶ï¼Œå³å½“å±žæ€§å€¼æ˜¯å¯¹è±¡æ—¶ï¼Œå¤åˆ¶çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼‰ã€‚è¿™å…è®¸ receiver ä¸é€šè¿‡ç»§æ‰¿å°±èƒ½èŽ·å–åˆ°æ–°çš„å±žæ€§ã€‚ é‰´äºŽ mixin æ¨¡å¼éžå¸¸å¸¸ç”¨ï¼ŒECMAScript 6 ä¸­æ·»åŠ äº†åŒæ ·è¡Œä¸ºçš„ Object.assign() æ–¹æ³•ã€‚1234567891011function EventTarget() &#123; /*...*/ &#125;EventTarget.prototype = &#123; constructor: EventTarget, emit: function() &#123; /*...*/ &#125;, on: function() &#123; /*...*/ &#125;&#125;var myObject = &#123;&#125;Object.assign(myObject, EventTarget.prototype)myObject.emit("somethingChanged") ä¸‰ã€PrototypesPrototypes æ˜¯ JavaScript ä¸­ç»§æ‰¿çš„åŸºç¡€ã€‚ ä¿®æ”¹å¯¹è±¡çš„ Prototypeé€šå¸¸æŸä¸ªå¯¹è±¡çš„ prototype ç”±æž„é€ å™¨æˆ– Object.create() æ–¹æ³•æŒ‡å®šã€‚ECMAScript 5 ä¸­æ·»åŠ äº† Object.getPrototypeOf() æ–¹æ³•å¯ä»¥èŽ·å–ä»»æ„å¯¹è±¡çš„ prototypeï¼Œä½† prototype åœ¨å¯¹è±¡å®žä¾‹åŒ–ä¹‹åŽå°±æ— æ³•å†å˜æ›´äº†ã€‚ ECMAScript 6 ä¸­æ·»åŠ äº† Object.setPrototypeOf() æ–¹æ³•å¯ä»¥ç”¨æ¥å˜æ›´ä»»æ„å¯¹è±¡çš„ prototypeã€‚123456789101112131415161718192021let person = &#123; getGreeting() &#123; return "Hello" &#125;&#125;let dog = &#123; getGreeting() &#123; return "Woof" &#125;&#125;// prototype is personlet friend = Object.create(person)console.log(friend.getGreeting()) // "Hello"console.log(Object.getPrototypeOf(friend) === person) // true// set prototype to dogObject.setPrototypeOf(friend, dog)console.log(friend.getGreeting()) // "Woof"console.log(Object.getPrototypeOf(friend) === dog) // true é€šè¿‡ super è®¿é—® Prototypesuper æ˜¯ä¸€ä¸ªæŒ‡å‘å½“å‰å¯¹è±¡çš„ prototype çš„æŒ‡é’ˆï¼Œå³ Object.getPrototypeOf(this) çš„å€¼ã€‚12345678910111213141516171819let person = &#123; getGreeting() &#123; return "Hello" &#125;&#125;let friend = &#123; getGreeting() &#123; return super.getGreeting() + ", hi" &#125;&#125;Object.setPrototypeOf(friend, person)// prototype is friendlet relative = Object.create(friend)console.log(person.getGreeting()) // "Hello"console.log(friend.getGreeting()) // "Hello, hi"console.log(relative.getGreeting()) // "Hello, hi" å‚è€ƒèµ„æ–™Understanding ECMAScript 6]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Frontend</tag>
        <tag>JavaScript</tag>
        <tag>OOP</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScriptï¼ˆECMAScript 6ï¼‰â€”â€” åŸºäºŽ destructuring çš„æ•°æ®è®¿é—®]]></title>
    <url>%2F2020%2F08%2F05%2Funderstanding-javascript-ecmascript-6-destructuring%2F</url>
    <content type="text"><![CDATA[åœ¨ ECMAScript 5 åŠæ—©æœŸç‰ˆæœ¬ä¸­ï¼Œä»Žå¯¹è±¡å’Œæ•°ç»„ä¸­èŽ·å–æ•°æ®ä¼šå¯¼è‡´å¾ˆå¤šå†—ä½™ä»£ç ï¼š12345678910let options = &#123; repeat: true, save: false&#125;let repeat = options.repeat, save = options.saveconsole.log(repeat, save)// true false Object Destrcturing123456789let node = &#123; type: "Identifier", name: "foo"&#125;let &#123; type, name &#125; = nodeconsole.log(type, name)// Identifier foo destructuring ä¹Ÿå¯ä»¥ä¸ºå·²ç»åˆå§‹åŒ–è¿‡çš„å˜é‡èµ‹å€¼ï¼š1234567891011let node = &#123; type: "Identifier", name: "foo"&#125;let type = "Literal", name = 5;(&#123; type, name &#125; = node)console.log(type, name)// Identifier foo ({ type, name } = node) å¤–é¢çš„å°æ‹¬å·æ˜¯å¿…é¡»çš„ã€‚åªæœ‰å¤§æ‹¬å·çš„è¯ï¼Œå¤§æ‹¬å·ä¼šè¢«çœ‹æˆè¯­å¥å—ï¼Œè€Œè¯­å¥å—ä¸èƒ½ä½äºŽç­‰å·å·¦è¾¹ã€‚ destructuring èµ‹å€¼è¯­å¥å¯ä»¥å‡ºçŽ°åœ¨ä»£ç çš„ä»»ä½•ä½ç½®ï¼š12345678910111213let node = &#123; type: "Identifier", name: "foo"&#125;let type = "Literal", name = 5;function outputInfo(value) &#123; console.log(value === node)&#125;outputInfo(&#123; type, name &#125; = node) // trueconsole.log(type, name) // Identifier foo é»˜è®¤å€¼123456789let node = &#123; type: "Identifier", name: "foo"&#125;let &#123; type, name, value &#125; = nodeconsole.log(type, name, value)// Identifier foo undefined 123456789let node = &#123; type: "Identifier", name: "foo"&#125;let &#123; type, name, value = true &#125; = nodeconsole.log(type, name, value)// Identifier foo true åµŒå¥—å¯¹è±¡çš„ destructuring12345678910111213141516171819let node = &#123; type: "Identifier", name: "foo", loc: &#123; start: &#123; line: 1, column: 1 &#125;, end: &#123; line: 1, column: 4 &#125; &#125;&#125;let &#123; loc: &#123; start &#125;&#125; = nodeconsole.log(start.line, start.column)// 1 1 Array Destructuring1234567let colors = ["red", "green", "blue"]let [ firstColor, secondColor ] = colorsconsole.log(firstColor, secondColor) // red greenlet [ , , thirdColor ] = colorsconsole.log(thirdColor) // blue ECMAScript 5 ä¸­çš„å˜é‡äº’æ¢ï¼š1234567let a = 1, b = 2, tmp;tmp = aa = bb = tmpconsole.log(a, b) // 2 1 ECMAScript 6 ä¸­çš„å˜é‡äº’æ¢ï¼š12345let a = 1, b = 2;[ a, b ] = [ b, a ]console.log(a, b) // 2 1 åµŒå¥—æ•°ç»„ï¼š12345let colors = [ "red", [ "green", "lightgreen" ], "blue" ]let [ firstColor, [ secondColor ] ] = colorsconsole.log(firstColor, secondColor) // red green Rest Itemsï¼š12345678let colors = [ "red", "green", "blue" ]let [ firstColor, ...restColors ] = colorsconsole.log(firstColor) // "red"console.log(restColors.length) // 2console.log(restColors[0]) // greenconsole.log(restColors[1]) // blue åœ¨ ECMAScript 5 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ concat() æ–¹æ³•åˆ›å»ºæŸä¸ªæ•°ç»„çš„å…‹éš†ï¼š12345var colors = [ "red", "green", "blue" ]var clonedColors = colors.concat()console.log(clonedColors)// [ 'red', 'green', 'blue' ] ECMAScript 6 ä¸­åˆ™å¯ä»¥ä½¿ç”¨ rest items è¯­æ³•åˆ›å»ºå…‹éš†ï¼š12345let colors = [ "red", "green", "blue" ]let [ ...clonedColors ] = colorsconsole.log(clonedColors)// [ 'red', 'green', 'blue' ] å‚è€ƒèµ„æ–™Understanding ECMAScript 6]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>JavaScript</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python å¯†ç å­¦å®žè·µ â€”â€” å‡¯æ’’å¯†ç ]]></title>
    <url>%2F2020%2F08%2F05%2Fpython-cryptography-caesar-cipher%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åŽŸç†å‡¯æ’’å¯†ç  æ˜¯å¯†ç å­¦ä¸­çš„ä¸€ç§ç®€å•çš„æ›¿æ¢åŠ å¯†æŠ€æœ¯ã€‚æ˜Žæ–‡ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½ä¼šæ›¿æ¢ä¸ºå…¶æŒ‰ç…§å­—æ¯è¡¨é¡ºåºå‘å·¦ï¼ˆæˆ–å‘å³ï¼‰åç§»ä¸€å®šé‡åŽå¾—åˆ°çš„æ–°å­—æ¯ï¼Œä½œä¸ºåŠ å¯†åŽå¯†æ–‡ã€‚å¦‚å½“åç§»é‡ä¸º 3 æ—¶ï¼Œæ˜Žæ–‡ä¸­æ‰€æœ‰çš„å­—æ¯ A å°†è¢«æ›¿æ¢æˆå­—æ¯ Dï¼ŒB æ›¿æ¢æˆ Eï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ è‹¥æ”¶åˆ°å¯†æ–‡çš„åŒæ—¶å·²çŸ¥åŠ å¯†æ—¶ä½¿ç”¨çš„åç§»é‡ï¼Œå°±å¯ä»¥å¿«é€Ÿåœ°é€šè¿‡é€†è¿ç®—èŽ·å–åˆ°æœ€åˆçš„æ˜Žæ–‡ã€‚ ä¸‹é¢ä¸¤å¼ å›¾å±•ç¤ºäº†å½“åç§»é‡ä¸º 8 æ—¶æ˜Žæ–‡å­—æ¯ä¸Žå¯†æ–‡å­—æ¯çš„å¯¹åº”å…³ç³»ï¼ˆå›¾ä¸€å³å‡¯æ’’å¯†ç è½®ç›˜ï¼Œå¤–å±‚ä¸ºæ˜Žæ–‡ï¼Œå†…å±‚ä¸ºå¯†æ–‡ï¼Œå¯æ—‹è½¬ä»¥æ”¹å˜åç§»é‡ï¼‰ä»¥åŠå®žé™…çš„åŠ å¯†è¿‡ç¨‹ï¼ˆå›¾äºŒï¼‰ï¼š PSï¼šå¯¹ä¸€æ®µæ˜Žæ–‡æ¶ˆæ¯è¿žç»­åº”ç”¨å¤šä¸ªä¸åŒçš„åç§»é‡è¿›è¡Œå‡¯æ’’å¯†ç è§„åˆ™çš„åŠ å¯†ï¼Œå¹¶ä¸ä¼šå¢žå¼ºå®‰å…¨ç­‰çº§ã€‚å³è½®ç›˜çš„å¤šæ¬¡æ—‹è½¬ï¼Œå®žé™…ä¸Šç­‰åŒäºŽæŠµæ¶ˆåŽçš„ä¸€æ¬¡æ—‹è½¬ã€‚å¤šæ¬¡åº”ç”¨çš„ä¸åŒåç§»é‡ï¼Œæœ€ç»ˆç­‰åŒäºŽæŠµæ¶ˆåŽçš„ä¸€æ¬¡åç§»é‡ï¼Œå¯¹äºŽæš´åŠ›ç ´è§£æ¥è¯´å¹¶ä¸ä¼šå¢žåŠ å¤æ‚åº¦ã€‚å¦‚ç¬¬ä¸€æ¬¡å¯¹æ˜Žæ–‡å®žæ–½åç§» 3 ä½çš„å‡¯æ’’åŠ å¯†ï¼Œå†å¯¹ç”Ÿæˆçš„å¯†æ–‡å®žæ–½åç§» 10 ä½çš„åŠ å¯†ï¼Œå®žé™…ä¸Šç›¸å½“äºŽå¯¹æœ€åˆçš„æ˜Žæ–‡å®žæ–½äº†åç§» 13 ä½çš„åŠ å¯†ã€‚ äºŒã€Python å®žçŽ°å‡¯æ’’å¯†ç æºä»£ç ï¼š1234567891011121314while True: key = input("Please input a key number (like 13):\n") or 13 mode = input("\nPlease input mode (encrypt or decrypt):\n") or "encrypt" symbols = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890 !?.' # æ ¹æ®æ•°å­— key å¯¹å­—æ¯è¡¨ symbols è¿›è¡Œåç§»æ“ä½œï¼Œå½¢æˆå¯†æ–‡å­—æ¯è¡¨ ciphers ciphers = symbols[int(key):] + symbols[:int(key)] # æ ¹æ®åŠ å¯†ä¸Žè§£å¯†åŠ¨ä½œï¼Œç”Ÿæˆæ˜Žæ–‡å­—æ¯åˆ°å¯†æ–‡å­—æ¯ï¼ˆæˆ–å¯†æ–‡åˆ°æ˜Žæ–‡ï¼‰çš„å¯¹åº”å…³ç³» transtab = str.maketrans(symbols, ciphers) if mode == 'encrypt' else str.maketrans(ciphers, symbols) message = input("\nPlease input plaintext or ciphertext:\n") # å®Œæˆæ˜Žæ–‡åˆ°å¯†æ–‡ï¼ˆæˆ–å¯†æ–‡åˆ°æ˜Žæ–‡ï¼‰çš„è½¬æ¢ result = message.translate(transtab) print(f"\nThe result is: &#123;result&#125;\n\n") è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516171819202122Please input a key number (like 13):13Please input mode (encrypt or decrypt):encryptPlease input plaintext or ciphertext:This is my secret message.The result is: guv6Jv6Jz!J6rp5r7Jzr66ntrMPlease input a key number (like 13):13Please input mode (encrypt or decrypt):decryptPlease input plaintext or ciphertext:guv6Jv6Jz!J6rp5r7Jzr66ntrMThe result is: This is my secret message. ä¸‰ã€Python å¯¹å‡¯æ’’å¯†ç çš„çˆ†ç ´å³åœ¨åŠ å¯†ç”¨çš„ key å€¼æœªçŸ¥çš„æƒ…å†µä¸‹ï¼Œå°è¯•æ‰€æœ‰å¯èƒ½çš„ key å€¼ï¼ˆ0 åˆ°å­—æ¯è¡¨é•¿åº¦å‡ä¸€ï¼‰å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œè¾“å‡ºä»¥æŸ¥çœ‹è§£å¯†å‡ºçš„æ˜Žæ–‡æ˜¯å¦æœ‰æ„ä¹‰ã€‚ æºä»£ç ï¼š1234567891011symbols = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890 !?.'ciphertext = input("Please input ciphertext:\n")for key in range(len(symbols)): ciphers = symbols[key:] + symbols[:key] transtab = str.maketrans(ciphers, symbols) plaintext = ciphertext.translate(transtab) print(f'Key #&#123;key&#125;: &#123;plaintext&#125;') è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516171819Please input ciphertext:guv6Jv6Jz!J6rp5r7Jzr66ntrMKey #0: guv6Jv6Jz!J6rp5r7Jzr66ntrMKey #1: ftu5Iu5Iy I5qo4q6Iyq55msqLKey #2: est4Ht4Hx0H4pn3p5Hxp44lrpKKey #3: drs3Gs3Gw9G3om2o4Gwo33kqoJKey #4: cqr2Fr2Fv8F2nl1n3Fvn22jpnIKey #5: bpq1Eq1Eu7E1mkzm2Eum11iomHKey #6: aopzDpzDt6Dzljyl1DtlzzhnlGKey #7: ZnoyCoyCs5CykixkzCskyygmkFKey #8: YmnxBnxBr4BxjhwjyBrjxxfljEKey #9: XlmwAmwAq3AwigvixAqiwwekiDKey #10: Wklv.lv.p2.vhfuhw.phvvdjhCKey #11: Vjku?ku?o1?ugetgv?oguucigBKey #12: Uijt!jt!nz!tfdsfu!nfttbhfAKey #13: This is my secret message.Key #14: Sghr0hr0lx0rdbqds0ldrrZfd?Key #15: Rfgq9gq9kw9qcapcr9kcqqYec!... å‚è€ƒèµ„æ–™Cracking Codes with Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Security</tag>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Cryptography</tag>
        <tag>Cipher</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Tricks â€”â€” ä½¿ç”¨ pywinrm è¿œç¨‹æŽ§åˆ¶ Windows ä¸»æœº]]></title>
    <url>%2F2020%2F07%2F20%2Fpython-tricks-remote-control-windows-machines-with-pywinrm%2F</url>
    <content type="text"><![CDATA[WinRM å³ Windows Remote Managementï¼Œæ˜¯å¾®è½¯å¯¹äºŽ WS-Management è¿œç¨‹ç®¡ç†åè®®çš„å®žçŽ°ã€‚ ä¸€ã€å—æŽ§ç«¯é…ç½® WinRM æœåŠ¡æ–¹å¼ä¸€ï¼šcmd å‘½ä»¤è¡Œï¼ˆç®¡ç†å‘˜ï¼‰ å¯ç”¨ WinRM è¿œç¨‹æœåŠ¡ï¼šwinrm quickconfig æŸ¥çœ‹ WinRM æœåŠ¡ç›‘å¬çŠ¶æ€ï¼šwinrm e winrm/config/listener 12345678910C:\Windows\system32&gt;winrm e winrm/config/listenerListener [Source="GPO"] Address = * Transport = HTTP Port = 5985 Hostname Enabled = true URLPrefix = wsman CertificateThumbprint ListeningOn = 127.0.0.1, 169.254.52.7, xx.xx.xx.xx, ::1, fe80::3989:dd91:e6b3:6f41%15, fe80::fd01:a9fd:c410:3407%12 å…è®¸ä½¿ç”¨ Basic è®¤è¯æ–¹å¼ï¼šwinrm set winrm/config/service/auth @{Basic=&quot;true&quot;} 12345678winrm set winrm/config/service/auth @&#123;Basic="true"&#125;Auth Basic = true [Source="GPO"] Kerberos = true Negotiate = true Certificate = false CredSSP = false CbtHardeningLevel = Relaxed å…è®¸ WinRM ä½¿ç”¨éžåŠ å¯†çš„è¿žæŽ¥ï¼šwinrm set winrm/config/service @{AllowUnencrypted=&quot;true&quot;} æ–¹å¼äºŒï¼šbat è„šæœ¬123call winrm quickconfig -quietcall winrm set winrm/config/service/auth @&#123;Basic="true"&#125;call winrm set winrm/config/service @&#123;AllowUnencrypted="true"&#125; æ–¹å¼ä¸‰ï¼šç»„ç­–ç•¥å®šä½åˆ°è®¡ç®—æœºé…ç½® -&gt; ç­–ç•¥ -&gt; ç®¡ç†æ¨¡æ¿ -&gt; Windows ç»„ä»¶ -&gt; Windows è¿œç¨‹ç®¡ç†(WinRM) -&gt; WinRM æœåŠ¡ã€‚å¯ç”¨å…è®¸é€šè¿‡ WinRM è¿›è¡Œè¿œç¨‹æœåŠ¡å™¨ç®¡ç†ã€å…è®¸åŸºæœ¬èº«ä»½éªŒè¯ã€å…è®¸æœªåŠ å¯†é€šä¿¡ã€‚ å»ºè®®åŒæ—¶å¯ç”¨æœåŠ¡ä¸Žé˜²ç«å¢™ç­–ç•¥ï¼šè®¡ç®—æœºé…ç½® -&gt; ç­–ç•¥ -&gt; Windows è®¾ç½® -&gt; å®‰å…¨è®¾ç½® -&gt; ç³»ç»ŸæœåŠ¡ -&gt; Windows Remote Management (WS-Management)ï¼Œå¯åŠ¨æ¨¡å¼ä¸ºè‡ªåŠ¨ã€‚ è®¡ç®—æœºé…ç½® -&gt; ç­–ç•¥ -&gt; Windows è®¾ç½® -&gt; å®‰å…¨è®¾ç½® -&gt; é«˜çº§å®‰å…¨ Windows é˜²ç«å¢™ -&gt; é«˜çº§å®‰å…¨ Windows é˜²ç«å¢™ - XXX -&gt; å…¥ç«™è§„åˆ™ï¼Œå¼€æ”¾ 5985ï¼ˆHTTPï¼‰å’Œ 5986ï¼ˆHTTPSï¼‰ç«¯å£ã€‚ äºŒã€Python ä½¿ç”¨ pywinrm è¿žæŽ¥ WinRM æœåŠ¡å®‰è£… pywinrm åº“ï¼špip install pywinrm æ‰§è¡Œ cmd å‘½ä»¤ï¼š12345&gt;&gt;&gt; import winrm&gt;&gt;&gt; session = winrm.Session('xx.xx.xx.xx', auth=('Administrator', 'admin_password'))&gt;&gt;&gt; cmd = session.run_cmd('ipconfig')&gt;&gt;&gt; cmd.std_outb'\r\nWindows IP Configuration\r\n\r\n\r\nEthernet adapter \xd2\xd4\xcc\xab\xcd\xf8:\r\n\r\n Connection-specific DNS Suffix . : example.com\r\n Link-local IPv6 Address . . . . . : fe80::3989:dd91:e6b3:6f41%15\r\n IPv4 Address. . . . . . . . . . . : xx.xx.xx.xx\r\n Subnet Mask . . . . . . . . . . . : 255.255.255.0\r\n Default Gateway . . . . . . . . . : 172.20.23.254\r\n\r\nEthernet adapter \xd2\xd4\xcc\xab\xcd\xf8 2:\r\n\r\n Media State . . . . . . . . . . . : Media disconnected\r\n Connection-specific DNS Suffix . : \r\n' æ‰§è¡Œ Powershell å‘½ä»¤ï¼š12345&gt;&gt;&gt; import winrm&gt;&gt;&gt; session = winrm.Session('xx.xx.xx.xx', auth=('Administrator', 'admin_password'))&gt;&gt;&gt; ps = session.run_ps('Get-Disk')&gt;&gt;&gt; ps.std_outb'\r\nNumber Friendly Name Serial Number HealthStatus OperationalStatus Total Size Partition \r\n Style \r\n------ ------------- ------------- ------------ ----------------- ---------- ----------\r\n0 ST500DM002... Z3TFS1S3 Healthy Online 465.76 GB MBR \r\n\r\n\r\n']]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Windows</tag>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Remote</tag>
        <tag>WinRM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python å¯†ç å­¦å®žè·µ â€”â€” ç†è§£å“ˆå¸Œï¼ˆHashï¼‰ç®—æ³•]]></title>
    <url>%2F2020%2F07%2F03%2Fpractical-cryptography-in-python-hash-algorithm%2F</url>
    <content type="text"><![CDATA[Hash æ˜¯å¯†ç å­¦å®‰å…¨æ€§çš„åŸºçŸ³ï¼Œå®ƒå¼•å…¥äº†å•å‘å‡½æ•°ï¼ˆone-way functionï¼‰å’ŒæŒ‡çº¹ï¼ˆfingerprintï¼‰çš„æ¦‚å¿µã€‚å³ï¼š å¯¹äºŽä»»æ„è¾“å…¥ï¼Œéƒ½å¯ä»¥äº§ç”Ÿç›¸åŒçš„ã€å”¯ä¸€çš„è¾“å‡ºå€¼ è¾“å‡ºå€¼ä¸­ä¸åŒ…å«è¾“å…¥å€¼çš„ä»»ä½•çº¿ç´¢ ä¸€ã€ä¿å¯†æ€§ï¼ˆconfidentialityï¼‰ä¸Žå®Œæ•´æ€§ï¼ˆintegrityï¼‰ç®€å•æ¥è¯´ï¼Œä¿¡æ¯çš„ä¿å¯†æ€§ç¡®ä¿é™¤æŽˆæƒäººå‘˜ä»¥å¤–çš„ä»»ä½•äººéƒ½æ— æ³•è¯»å–è¯¥æ¶ˆæ¯ï¼Œä¿¡æ¯çš„å®Œæ•´æ€§åˆ™ç¡®ä¿é™¤æŽˆæƒäººå‘˜ä»¥å¤–çš„ä»»ä½•äººéƒ½æ— æ³•ä¿®æ”¹è¯¥æ¶ˆæ¯ã€‚å¾ˆå¤šæ—¶å€™ä¸€æ®µåŠ å¯†çš„æ¶ˆæ¯æ— æ³•è¢«ä»–äººè¯»å–å’Œç†è§£ï¼ˆä¿å¯†æ€§ï¼‰ï¼Œå¹¶ä¸æ„å‘³ç€è¯¥å¯†æ–‡ä¸ä¼šåœ¨ä¼ æ’­è¿‡ç¨‹ä¸­è¢«æˆªå–å’Œæ¶æ„ä¿®æ”¹ï¼ˆå®Œæ•´æ€§ï¼‰ã€‚ ä¿¡æ¯æ‘˜è¦ï¼ˆmessage digestï¼‰æˆ–æŒ‡çº¹ï¼ˆfingerprintï¼‰æŠ€æœ¯å³ç”¨äºŽéªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚ ä¿¡æ¯æ‘˜è¦éœ€æ»¡è¶³çš„åŸºæœ¬æ¡ä»¶ä¸ºï¼š ç›¸åŒçš„æ–‡æ¡£æ°¸è¿œä¼šç”Ÿæˆç›¸åŒçš„æ‘˜è¦ï¼ˆèƒ½å¤Ÿä½œä¸ºèº«ä»½çº¿ç´¢ï¼‰ ç”Ÿæˆçš„æ‘˜è¦â€œæ„Ÿè§‰â€æ˜¯éšæœºçš„ï¼Œå³æ‘˜è¦ä¸­ä¸åŒ…å«åŽŸå§‹æ–‡æ¡£çš„ä»»ä½•ä¿¡æ¯ï¼ˆæ— æ³•è¢«ç ´è§£ï¼‰ ä¿¡æ¯æ‘˜è¦ä¹Ÿè¢«ç§°ä½œæŒ‡çº¹ï¼Œå³å¯ä»¥ä»£è¡¨æŸä»½æ–‡æ¡£â€œèº«ä»½â€çš„ä¸€å°æ®µæ•°æ®ï¼Œç±»ä¼¼äºŽäººç±»çš„æŒ‡çº¹ã€‚æ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡æŒ‡çº¹éªŒè¯å…¶èº«ä»½ï¼Œä½†è¯¥æŒ‡çº¹å¹¶ä¸åŒ…å«å…¶èº«ä½“çš„æ‰€æœ‰ä¿¡æ¯ã€‚æ–‡æ¡£çš„æŒ‡çº¹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿å¿«é€Ÿçš„é€šè¿‡æ–‡æ¡£å†…å®¹è®¡ç®—å¾—å‡ºä¸€å°æ®µå”¯ä¸€çš„æŒ‡çº¹æ•°æ®ä½œä¸ºå…¶èº«ä»½è¯æ˜Žï¼Œä½†æ˜¯åªæœ‰æŒ‡çº¹æ•°æ®å°±å‡ ä¹Žä¸å¯èƒ½å¾—å‡ºåŽŸå§‹æ–‡æ¡£çš„å†…å®¹ã€‚ å¯¹äºŽä¸¤ä»½æ–‡æ¡£ï¼Œåªéœ€è¦æ¯”å¯¹å…¶ä¿¡æ¯æ‘˜è¦ï¼ˆæŒ‡çº¹ï¼‰æ˜¯å¦ä¸€è‡´ï¼Œå°±å¯ä»¥ç¡®ä¿å…¶å†…å®¹æ˜¯å¦ç›¸åŒï¼Œåœ¨ä¼ æ’­è¿‡ç¨‹ä¸­æ˜¯å¦è¢«äººæ¶æ„ä¿®æ”¹ã€‚åŒæ—¶è¯¥æŒ‡çº¹ä¿¡æ¯ä¹Ÿä¸ä¼šé€ æˆåŽŸå§‹æ–‡æ¡£æœ¬å†…å®¹çš„æ³„éœ²ã€‚ äºŒã€MD5MD5 æ˜¯ä¸€ç§æ¯”è¾ƒå¤è€çš„å“ˆå¸Œç®—æ³•ï¼Œå…¶åå­—ä¸­çš„ MD å³ä»£è¡¨ message digestã€‚å®ƒå¯ä»¥ä»Žä»»æ„å¤§å°çš„æ–‡æ¡£è®¡ç®—å‡ºä¸€ä¸ªå”¯ä¸€çš„ 16 å­—èŠ‚é•¿åº¦çš„æ‘˜è¦æ•°æ®ã€‚ PSï¼šé‰´äºŽ MD5 è¾ƒæ‚ ä¹…çš„åŽ†å²å’Œä¸å¤Ÿé•¿çš„æ‘˜è¦é•¿åº¦ï¼Œä¸æŽ¨èåœ¨å®‰å…¨æ€§å¾ˆæ•æ„Ÿçš„åœºæ™¯ä¸­ä½¿ç”¨è¯¥ç®—æ³•ã€‚1234567891011121314151617&gt;&gt;&gt; from hashlib import md5&gt;&gt;&gt; md5(b'alice').hexdigest()'6384e2b2184bcbf58eccf10ca7a6563c'&gt;&gt;&gt; md5(b'bob').hexdigest()'9f9d51bc70ef21ca5c14f307980a29d8'&gt;&gt;&gt; md5(b'balice').hexdigest()'6760742ebf884c998752b4e082b78224'&gt;&gt;&gt; md5(b'cob').hexdigest()'386685f06beecb9f35db2e22da429ec9'&gt;&gt;&gt; md5(b'a').hexdigest()'0cc175b9c0f1b6a831c399e269772661'&gt;&gt;&gt; md5(b'aa').hexdigest()'4124bc0a9335c27f086f24ba207a4912'&gt;&gt;&gt; md5(b'aa' * 100000).hexdigest()'561b1994f6baacd6e5eaf4baaa12849f'&gt;&gt;&gt; md5(b'alice').hexdigest()'6384e2b2184bcbf58eccf10ca7a6563c' ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹ä¸åŒçš„è¾“å…¥å†…å®¹ï¼ˆå³ä¾¿ç›¸ä¼¼åº¦å¾ˆé«˜ï¼Œæ¯”å¦‚ bob å’Œ cobï¼‰ï¼Œæ‘˜è¦ç®—æ³•ç”Ÿæˆçš„è¾“å‡ºæ˜¯å‘æ•£çš„ï¼Œå½¼æ­¤ä¹‹é—´æ²¡æœ‰ç›¸ä¼¼æ€§ï¼Œåƒæ˜¯éšæœºç”Ÿæˆçš„ç»“æžœã€‚ä½†æ˜¯å¯¹äºŽä»»æ„ç›¸åŒçš„è¾“å…¥ï¼Œç”Ÿæˆçš„æ‘˜è¦æ•°æ®åˆ™éƒ½æ˜¯ç¡®å®šçš„ã€å”¯ä¸€çš„ã€‚ ä¸‰ã€å“ˆå¸Œç®—æ³•çš„è§„åˆ™ä¸€èˆ¬æˆ‘ä»¬æåˆ°å“ˆå¸Œç®—æ³•ï¼Œéƒ½ä¼šå…³è”åˆ°å¯†ç å­¦ã€å®‰å…¨æ€§ç­‰åœºæ™¯ä¸­ï¼Œå®žé™…ä¸Šæˆ‘ä»¬å¾ˆæ—©å°±æŽ¥è§¦äº†ä¸€ç§å®Œå…¨â€œéžå¯†ç å­¦â€çš„å“ˆå¸Œåœºæ™¯ã€‚æ¯”å¦‚å°æ—¶å€™è·Ÿè€å¸ˆå­¦ä¹ åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ã€‚ã€‚ã€‚ä»Žæœ¬è´¨ä¸Šçœ‹ï¼Œå“ˆå¸Œå‡½æ•°çš„ç›®çš„æ˜¯å°†å·¨å¤§ï¼ˆç”šè‡³æ— ç©·å¤§ï¼‰æ•°é‡çš„äº‹ç‰©æ˜ å°„åˆ°ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„æ•°æ®é›†ä¸­ã€‚æ¯”å¦‚ MD5ï¼Œä¸ç®¡è¾“å…¥çš„æ–‡æ¡£æœ‰å¤šå¤§ï¼Œæœ€ç»ˆéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå›ºå®šé•¿åº¦ï¼ˆ16 å­—èŠ‚ï¼‰çš„åå…­è¿›åˆ¶æ•°å­—ä½œä¸ºæŒ‡çº¹ã€‚è¿™å°±æ„å‘³ç€ MD5 çš„è¾“å…¥é›†åˆï¼Œå®žé™…ä¸Šæ˜¯å¤§äºŽå…¶è¾“å‡ºé›†åˆçš„ã€‚å³åªè¦è¾“å…¥æ–‡æ¡£çš„é›†åˆè¶³å¤Ÿå¤§ï¼ˆå¾ˆå¤§å¾ˆå¤§ï¼‰ï¼Œå°±æœ‰å¯èƒ½å‡ºçŽ°é‡å¤çš„æŒ‡çº¹ä¿¡æ¯ã€‚ è¿™å’Œåˆ¤æ–­æ•°å­—å¥‡å¶æ˜¯ç›¸é€šçš„ã€‚ä¸ç®¡æŸä¸ªæ•°å­—æœ‰å¤šå¤§å¤šå¥‡ç‰¹ï¼Œæˆ‘ä»¬æ°¸è¿œå¯ä»¥å°†å®ƒâ€œåŽ‹ç¼©â€æˆå¥‡æ•°æˆ–å¶æ•°ï¼Œç”¨ 1 bit çš„ 1 æˆ– 0 è¡¨ç¤ºå°±å¯ä»¥ã€‚ä½†æ˜¯åªè¯´æ˜ŽæŸä¸ªæœªçŸ¥æ•°å­—æ˜¯å¥‡æ•°ï¼ˆæˆ–å¶æ•°ï¼‰ï¼Œæˆ‘ä»¬å°±æ— æ³•çŒœå‡ºè¯¥æ•°å­—çš„å‡†ç¡®å€¼ã€‚ ä¸Šé¢çš„é€»è¾‘éªŒè¯äº†å“ˆå¸Œå‡½æ•°å…±æœ‰çš„ 3 ä¸ªç‰¹æ€§ï¼š consistencyï¼ˆä¸€è‡´æ€§ï¼‰ï¼šç›¸åŒçš„è¾“å…¥åªä¼šç”Ÿæˆç›¸åŒçš„è¾“å‡ºä¿¡æ¯ compressionï¼ˆåŽ‹ç¼©ï¼‰ï¼šå¯ä»¥å°†ä½“é‡å¾ˆå¤§çš„è¾“å…¥åŽ‹ç¼©æˆä¸€ä¸ªå›ºå®šå¤§å°çš„è¾“å‡º lossinessï¼ˆæœ‰æŸçš„ï¼‰ï¼šåªé€šè¿‡æ£€æŸ¥è¾“å‡ºæ— æ³•åå‘è®¡ç®—å‡ºè¾“å…¥å€¼ ä½†æ˜¯å¯¹äºŽä¸€ä¸ªæ»¡è¶³å¯†ç å­¦å®‰å…¨çš„å“ˆå¸Œå‡½æ•°è€Œè¨€ï¼Œé™¤ä»¥ä¸Šä¸‰ç‚¹ä»¥å¤–è¿˜éœ€è¦å…·æœ‰å¦‚ä¸‹å±žæ€§ï¼š Preimage resistance Second-preimage resistance Collision resistance Preimage Resistanceå“ˆå¸Œå‡½æ•°çš„ preimage æ˜¯æŒ‡èƒ½å¤Ÿç”ŸæˆåŒä¸€ä¸ªç‰¹å®šæŒ‡çº¹çš„æ‰€æœ‰è¾“å…¥çš„åˆé›†ã€‚å³å¯¹äºŽæŸä¸ªå“ˆå¸Œå‡½æ•° H ä¸Žæ‘˜è¦ kï¼Œæ‰€æœ‰èƒ½å¤Ÿç”Ÿæˆ k çš„è¾“å…¥å€¼ x ï¼ˆæ»¡è¶³ H(x) = kï¼‰å…±åŒç»„æˆäº† H ä¸Ž k çš„ preimageã€‚ preimage resistance çš„æ„ä¹‰å³ä¸ºï¼Œåœ¨ä»…ä»…åªæ˜¯çŸ¥æ™“æŸä¸ªæ‘˜è¦çš„å‰æä¸‹ï¼Œé€šè¿‡æœ‰é™çš„è®¡ç®—æ— æ³•èŽ·å–å…¶ preimage ä¸­çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ ã€‚å³åªé€šè¿‡ç»“æžœæ— æ³•çŸ¥æ™“è¾“å…¥ã€‚æ‘˜è¦ä¸­ä¸åŒ…å«åŽŸå§‹æ–‡æ¡£çš„ä»»ä½•ä¿¡æ¯ï¼ˆlossinessï¼‰ï¼Œæ— æ³•é€šè¿‡é€†å‘è¿ç®—çš„æ–¹å¼ç”±æ‘˜è¦åæŽ¨å‡ºåŽŸå§‹è¾“å…¥ã€‚åªèƒ½éšæœºåœ°å°è¯•ä»»æ„è¾“å…¥ï¼Œä»¥æœŸç¢°å·§å¾—åˆ°åŒæ ·çš„æ‘˜è¦ä¿¡æ¯ï¼ˆæš´åŠ›ç ´è§£ï¼‰ã€‚ å› æ­¤å‰é¢æåˆ°çš„å¥‡å¶å‡½æ•°å°±ä¸èƒ½ä½œä¸ºä¸€ä¸ªå®‰å…¨çš„å“ˆå¸Œå‡½æ•°ä½¿ç”¨ã€‚å‡è®¾ä½¿ç”¨å¥‡å¶ä½œä¸ºå“ˆå¸Œå‡½æ•°ï¼ˆå¥‡æ•°è¾“å‡º 1ï¼Œå¶æ•°è¾“å‡º 0ï¼‰ï¼Œåˆ™å¯¹äºŽæ‘˜è¦ 1ï¼Œæ€»å¯ä»¥å¾ˆè½»æ˜“çš„åœ¨ preimageï¼ˆæ­¤å¤„æ˜¯å…¨ä½“å¥‡æ•°ï¼‰ä¸­æ‰¾åˆ°ä»»æ„å¤šä¸ªæ‘˜è¦åŒä¸º 1 çš„å…ƒç´ ã€‚è¿™æ„å‘³ç€åŽŸå§‹è¾“å…¥å¯ä»¥è½»æ˜“è¢«ä¿®æ”¹è€Œä¸å½±å“æŒ‡çº¹æ•°æ®ï¼Œåˆ™è¯¥æŒ‡çº¹ä½œä¸ºä¿¡æ¯å®Œæ•´æ€§çš„éªŒè¯æ¡ä»¶å°±å¤±åŽ»äº†æ„ä¹‰ã€‚ ä½†æ˜¯å¯¹äºŽè¾ƒå®‰å…¨çš„å“ˆå¸Œç®—æ³•å¦‚ MD5ï¼Œç”± MD5(x) = ca8a0fb205782051bd49f02eae17c9ee å°±æ— æ³•åœ¨æœ‰é™çš„è®¡ç®—å†…æ‰¾åˆ°ç¡®å®šçš„ x çš„å€¼ã€‚MD5 ç”Ÿæˆ 16 å­—èŠ‚ï¼ˆ16 * 8 = 128bitï¼‰é•¿åº¦çš„æ‘˜è¦ï¼Œå…¶ä¸­å¯ä»¥åŒ…å« 2^128 ç§ä¸åŒçš„æ•°å­—ç»„åˆã€‚å› æ­¤ä½¿ç”¨æš´åŠ›ç ´è§£çš„è¯ï¼Œæœ€å¤šéœ€è¦å°è¯• 2^128 = 340282366920938463463374607431768211456 æ¬¡ï¼å‡è®¾æ¯ç§’é’Ÿå¯ä»¥å°è¯•ä¸€ç™¾ä¸‡æ¡è¾“å…¥ï¼Œä»éœ€è¦ 10^26 å¹´å®Œæˆæ‰€æœ‰éªŒè¯æ“ä½œï¼ Second-Preimage Resistance ä¸Ž Collision Resistancesecond-primage resistance æ˜¯æŒ‡å³ä¾¿çŸ¥æ™“æŸä¸ªåŽŸå§‹æ–‡æ¡£ä»¥åŠç”±è¯¥æ–‡æ¡£ç”Ÿæˆçš„æ‘˜è¦æ•°æ®ï¼Œä»å¾ˆéš¾è®¡ç®—å¯ä»¥å‡ºç”ŸæˆåŒæ ·æ‘˜è¦çš„å¦ä¸€ä¸ªä¸åŒçš„æ–‡æ¡£ã€‚å³åœ¨å·²çŸ¥ MD5(alice) = 384e2b2184bcbf58eccf10ca7a6563c çš„æƒ…å†µä¸‹ï¼Œä»æ— æ³•æ‰¾å‡ºé™¤ alice ä»¥å¤–çš„å¦ä¸€ä¸ªè¾“å…¥ç”ŸæˆåŒæ ·çš„æ‘˜è¦ã€‚ä¸ºäº†å¯»æ±‚å¯ä»¥æ›¿æ¢æŽ‰ alice çš„å¦ä¸€ä¸ªå€¼ï¼ŒåŒæ—¶ä¸å½±å“æ‘˜è¦è®¤è¯ï¼Œè¾¾åˆ°æ··æ·†çš„ç›®çš„ï¼Œæœ€ç»ˆä»éœ€ä½¿ç”¨æš´åŠ›ç ´è§£çš„æ–¹å¼ã€‚ collision resistance æ˜¯æŒ‡å¾ˆéš¾æ‰¾å‡ºä»»æ„ä¸¤ä¸ªç”Ÿæˆç›¸åŒæ‘˜è¦ï¼ˆç›¸åŒè€Œéžç‰¹å®šï¼‰çš„è¾“å…¥å€¼ã€‚å¯ä»¥å‚è€ƒâ€œç”Ÿæ—¥é—®é¢˜â€ï¼Œå³åœ¨ä¸€ä¸ªç­çº§ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªç”Ÿæ—¥ä¸ºåŒä¸€å¤©çš„å­¦ç”Ÿçš„æ¦‚çŽ‡è¿œæ¯”å­˜åœ¨ä¸€ä¸ªç”Ÿæ—¥ä¸ºç‰¹å®šæ—¥æœŸçš„å­¦ç”Ÿçš„æ¦‚çŽ‡å¤§å¾—å¤šã€‚ collision resistance çš„æ„ä¹‰åœ¨äºŽï¼Œæ— æ³•æ•…æ„æ‰¾å‡ºä¸¤å¥—ç¬¦åˆåŒä¸€æŒ‡çº¹çš„è¾“å…¥ä»¥è¾¾åˆ°æ··æ·†çš„ç›®çš„ã€‚æ¯”å¦‚ MD5 ç®—æ³•ï¼š12345&gt;&gt;&gt; from hashlib import md5&gt;&gt;&gt; md5('bob').hexdigest()'9f9d51bc70ef21ca5c14f307980a29d8'&gt;&gt;&gt; md5('cob').hexdigest()'386685f06beecb9f35db2e22da429ec9' å¯¹äºŽå¾ˆç›¸ä¼¼çš„è¾“å…¥ bob å’Œ cobï¼Œå…¶æŒ‡çº¹ä¿¡æ¯çš„å·®å¼‚å´éžå¸¸å¤§ï¼Œæ²¡æœ‰ä»»ä½•å¯ä¾›é¢„æµ‹çš„è§„å¾‹ã€‚è¿™å¾—ç›ŠäºŽä¸€ç§ç§°ä¸º avalanche property çš„ç‰¹æ€§ï¼šè¾“å…¥çš„å¾®å°å˜åŒ–æ€»å¯ä»¥åœ¨è¾“å‡ºä¸­äº§ç”Ÿå·¨å¤§çš„æ— æ³•é¢„æµ‹çš„å·®å¼‚ã€‚ ç”±å‰é¢æåˆ°çš„ç”Ÿæ—¥é—®é¢˜å¯çŸ¥ï¼Œæ‰¾å‡ºä¸¤ä¸ªç”Ÿæˆç›¸åŒæŒ‡çº¹çš„å…ƒç´ è¿œæ¯”æ‰¾å‡ºæŸä¸ªå¯ä»¥ç”Ÿæˆç‰¹å®šæŒ‡çº¹çš„å…ƒç´ è¦å®¹æ˜“çš„å¤šã€‚ä»¥ MD5 ç®—æ³•çš„æš´åŠ›ç ´è§£ä¸ºä¾‹ï¼ŒåŽè€…å¾€å¾€éœ€è¦åš 2^128 æ¬¡å°è¯•ï¼Œè€Œå‰è€…åªéœ€è¦ 2^64 æ¬¡å°è¯•ã€‚çŽ°å®žä¸­ MD5 çš„ collision resistance è¿œéžæƒ³è±¡ä¸­é‚£ä¹ˆä¼˜å¼‚ï¼Œç”šè‡³å­˜åœ¨ä¸€ç§éžæš´åŠ›ç ´è§£çš„æ–¹å¼ èƒ½å¤Ÿåœ¨ä¸€å°æ—¶ä»¥å†…æ”»ç ´ MD5 çš„ collision resistanceã€‚æ‰€ä»¥å°½é‡ä¸è¦ä½¿ç”¨ MD5 è¿™ä¸ªå·²ç»ä¸å†ç»´æŠ¤è¶…è¿‡ 10 å¹´ã€å®‰å…¨æ¼æ´žå­˜åœ¨ 20 å¹´çš„å¤è€ç®—æ³•ã€‚ å‚è€ƒèµ„æ–™Practical Cryptography in Python: Learning Correct Cryptography by Example]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Security</tag>
        <tag>Python</tag>
        <tag>Algorithm</tag>
        <tag>Program</tag>
        <tag>Hash</tag>
        <tag>Cryptography</tag>
        <tag>Digest</tag>
        <tag>MD5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript è§£å¯† â€”â€” å‡½æ•°åˆæ­¥]]></title>
    <url>%2F2020%2F06%2F04%2Funderstanding-javascript-function-as-first-class-object%2F</url>
    <content type="text"><![CDATA[ä¸€ã€First-class objectsåœ¨ç†è§£å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡å‰ï¼Œå…ˆåˆ—ä¸¾ä¸‹ JavaScript ä¸­å¯¹è±¡æ”¯æŒçš„æ“ä½œï¼š å¯ä»¥é€šè¿‡ {} å­—é¢é‡åˆ›å»º å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡ã€æ•°ç»„é¡¹ï¼Œå¯ä»¥ä½œä¸ºå…¶ä»–å¯¹è±¡çš„å±žæ€§ 123var ninja = &#123;&#125; // èµ‹å€¼ç»™å˜é‡ninjaArray.push(&#123;&#125;) // ä½œä¸ºæ•°ç»„é¡¹ninja.data = &#123;&#125; // ä½œä¸ºå…¶ä»–å¯¹è±¡çš„å±žæ€§ å¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°æˆ–è¿”å›žå€¼ å¯ä»¥æ‹¥æœ‰æ”¯æŒåŠ¨æ€åˆ›å»ºä¸Žèµ‹å€¼çš„å±žæ€§1234567891011function hide(ninja) &#123; ninja.visibility = false&#125;hide(&#123;&#125;) // å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°function returnNewNinja() &#123; return &#123;&#125; // å¯¹è±¡ä½œä¸ºå‡½æ•°è¿”å›žå€¼&#125;var ninja = &#123;&#125;ninja.name = "Hanzo" // åŠ¨æ€åˆ›å»ºçš„å±žæ€§ å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡JavaScript ä¸­çš„å‡½æ•°æ‹¥æœ‰ä½œä¸ºå¯¹è±¡çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå› æ­¤å¯ä»¥åƒå¯¹å¾…ä»»ä½•å…¶ä»–å¯¹è±¡ä¸€æ ·å¯¹å…¶è¿›è¡Œä½¿ç”¨ã€‚ é€šè¿‡å­—é¢é‡åˆ›å»ºï¼š function ninjaFunction() {} å°†å‡½æ•°èµ‹å€¼ç»™å˜é‡ï¼švar ninjaFunction = function() {} æ•°ç»„ä¸­åŠ å…¥å‡½æ•°ä½œä¸ºæ•°æ®é¡¹ï¼šninjaArray.push(function() {}) å‡½æ•°ä½œä¸ºå¯¹è±¡çš„å±žæ€§ï¼šninja.data = function() {} å‡½æ•°ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°æˆ–è¿”å›žå€¼ 12345678function call(ninjaFunction) &#123; ninjaFunction()&#125;call(function() &#123;&#125;) // å‡½æ•°ä½œä¸ºå‚æ•°function returnNewNinjaFunction() &#123; return function() &#123;&#125; // å‡½æ•°ä½œä¸ºè¿”å›žå€¼&#125; å‡½æ•°å¯ä»¥æ‹¥æœ‰æ”¯æŒåŠ¨æ€åˆ›å»ºå’Œèµ‹å€¼çš„å±žæ€§ 12var ninjaFunction = function () &#123;&#125;ninjaFunction.name = "Hanzo" å‡½æ•°å³å¯¹è±¡ï¼Œåªä¸è¿‡æ‹¥æœ‰ä¸€é¡¹é¢å¤–çš„ç‰¹æ€§ï¼ˆèƒ½å¤Ÿè¢«è°ƒç”¨ï¼‰ä»¥å®Œæˆä¸€äº›ç‰¹å®šçš„åŠ¨ä½œã€‚ä»»ä½•å¯ä»¥å¯¹å¯¹è±¡åšå‡ºçš„æ“ä½œï¼ŒåŒæ ·å¯ä»¥åº”ç”¨åœ¨å‡½æ•°èº«ä¸Šã€‚ Callback functionså›žè°ƒå‡½æ•°å³åœ¨åŽç»­çš„æŸä¸ªæŒ‡å®šçš„æ—¶é—´èŠ‚ç‚¹è¢«å…¶ä»–ä»£ç è°ƒç”¨ï¼ˆcall backï¼‰çš„å‡½æ•°ã€‚12345678910111213141516var text = "Domo arigato"function useless(ninjaCallback) &#123; console.log("In useless function") return ninjaCallback()&#125;function getText() &#123; console.log("In getText function") return text&#125;console.log(useless(getText))// In useless function// In getText function// Domo arigato æˆ–è€…12345678var text = 'Domo arigato'function useless(ninjaCallback) &#123; return ninjaCallback()&#125;console.log(useless(function() &#123; return text &#125;))// Domo arigato å›žè°ƒå‡½æ•°åœ¨æ•°ç»„æŽ’åºä¸­çš„ä½¿ç”¨ï¼š1234var values = [0, 3, 2, 5, 7, 4, 8, 1]values.sort(function(value1, value2)&#123; return value1 - value2&#125;) Self-memoizing functionsmemoization æ˜¯æŒ‡æž„å»ºä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥å°†ä¹‹å‰è®¡ç®—è¿‡çš„å€¼ç¼“å­˜åœ¨è‡ªå·±å†…éƒ¨ï¼Œä¹‹åŽå†åšåŒæ ·çš„è®¡ç®—æ—¶åˆ™å¯ä»¥ç›´æŽ¥è¯»å–ç¼“å­˜çš„å€¼è€Œä¸å¿…é‡æ–°è®¡ç®—ã€‚12345678910111213141516171819202122function isPrime(value) &#123; if (!isPrime.answers) &#123; isPrime.answers = &#123;&#125; &#125; if (isPrime.answers[value] !== undefined) &#123; return isPrime.answers[value] &#125; var prime = value !== 1 for (var i = 2; i &lt; value; i++) &#123; if (value % i === 0) &#123; prime = false break &#125; &#125; return isPrime.answers[value] = prime&#125;console.log(isPrime(5))console.log(isPrime.answers)// true// &#123; '5': true &#125; äºŒã€å‡½æ•°å®šä¹‰JavaScript æä¾›ä»¥ä¸‹å‡ ç§å®šä¹‰å‡½æ•°çš„æ–¹å¼ï¼š å‡½æ•°å£°æ˜Žï¼ˆè¡¨è¾¾å¼ï¼‰ï¼šfunction myFun() { return 1 } Arrow functionï¼šmyArg =&gt; myArg * 2 å‡½æ•°æž„é€ å™¨ï¼šnew Function(&#39;a&#39;, &#39;b&#39;, &#39;return a + b&#39;) ç”Ÿæˆå™¨å‡½æ•°ï¼šfunction* myGen() { yield 1 } å‡½æ•°å£°æ˜Žæ˜¯æœ€åŸºç¡€çš„å®šä¹‰å‡½æ•°çš„æ–¹å¼ï¼Œå…¶åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š1234function myFunctionName(myFirstArg, mySecondArg) &#123; myStatement1 myStatement2&#125; å‡½æ•°å£°æ˜Žä»£ç å¯ä»¥å‡ºçŽ°åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼š123456function ninja() &#123; function hiddenNinja() &#123; return "ninja here" &#125; return hiddenNinja()&#125; å‡½æ•°è¡¨è¾¾å¼ä½œä¸º JavaScript ä¸­çš„ä¸€ç­‰å¯¹è±¡ï¼Œå‡½æ•°å¯ä»¥é€šè¿‡å­—é¢é‡åˆ›å»ºï¼Œå¯ä»¥èµ‹å€¼ç»™å˜é‡å’Œå¯¹è±¡å±žæ€§ï¼Œå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°æˆ–è¿”å›žå€¼ã€‚ä¹Ÿå› æ­¤å¯ä»¥å°†å…¶ä½œä¸ºè¡¨è¾¾å¼ä½¿ç”¨ï¼Œå³æˆä¸ºå…¶ä»–ä»£ç è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼ˆæ¯”å¦‚æ”¾åœ¨èµ‹å€¼è¯­å¥çš„ç­‰å·å³è¾¹ã€å……å½“å‚æ•°æˆ–è¿”å›žå€¼ç­‰ï¼‰12345var myFunc = function() &#123;&#125;myFunc(function() &#123; // ä½œä¸ºå‚æ•° return function() &#123;&#125; // ä½œä¸ºè¿”å›žå€¼&#125;) å‡½æ•°è¡¨è¾¾å¼ç”šè‡³å¯ä»¥æ”¾ç½®åœ¨é€šå¸¸åº”è¯¥ä½¿ç”¨å‡½æ•°æ ‡è¯†ç¬¦çš„åœ°æ–¹ï¼Œåœ¨å£°æ˜Žçš„åŒæ—¶ç«‹å³å®Œæˆè°ƒç”¨ï¼Œç§°ä¸º immediate functionï¼š1234567myFunctionName(3) // æ™®é€šè°ƒç”¨(function() &#123;&#125;)(3) // immediate call+function () &#123;&#125; ()-function () &#123;&#125; ()!function () &#123;&#125; ()~function () &#123;&#125; () Arrow functionåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œarrow function å¯ä»¥çœ‹ä½œå¯¹æ™®é€šå‡½æ•°è¡¨è¾¾å¼çš„ç®€åŒ–ã€‚å¦‚ä¹‹å‰çš„æŽ’åºç¤ºä¾‹ï¼š1234var values = [0, 3, 2, 5, 7, 4, 8, 1]values.sort(function(value1, value2)&#123; return value1 - value2&#125;) ä½¿ç”¨ arrow function åˆ™å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12var values = [0, 3, 2, 5, 7, 4, 8, 1]values.sort((value1, value2) =&gt; value1 - value2) arrow function æœ€ç®€å•çš„è¯­æ³•å½¢å¼ä¸º param =&gt; expressionï¼Œä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹å¦‚ä¸‹ï¼š12var greet = name =&gt; "Greetings, " + nameconsole.log(greet('Oishi')) // Greetings, Oishi æ›´å¤æ‚ä¸€ç‚¹çš„å½¢å¼å¦‚ï¼š123456var greet = name =&gt; &#123; var helloString = 'Greetings, ' return helloString + name&#125;console.log(greet('Oishi')) // Greetings, Oishi å‚æ•°Rest prarmeters12345678function multiMax(first, ...remainingNumbers)&#123; var sorted = remainingNumbers.sort(function(a, b)&#123; return b - a &#125;) return first * sorted[0]&#125;console.log(multiMax(3, 1, 2, 3)) // 9 Default parameters123456function performAction(ninja, action = "skulking") &#123; return ninja + " " + action&#125;console.log(performAction("Fuma")) // Fuma skulkingconsole.log(performAction("Yagyu", "sneaking")) // Yagyu sneaking ç”šè‡³å¯ä»¥è¿™æ ·å†™ï¼š12345function performAction(ninja, action = "skulking", message = ninja + " " + action) &#123; return message&#125;console.log(performAction("Yoshi")) // Yoshi skulking ä¸‰ã€å‡½æ•°è°ƒç”¨ä½œä¸ºâ€œå‡½æ•°â€è°ƒç”¨1234567function ninja(name) &#123; console.log(name) &#125;ninja('Hattori') // Hattorivar samurai = function(name) &#123; console.log(name) &#125;samurai('Hattori'); // Hattori(function(name) &#123; console.log(name) &#125;)('Hattori') // Hattori ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼š123var ninja = &#123;&#125;ninja.skulk = function() &#123;&#125;ninja.skulk() ä½œä¸ºæ–¹æ³•è°ƒç”¨ä¸Žä½œä¸ºå‡½æ•°è°ƒç”¨çš„åŒºåˆ«ï¼š1234567891011121314151617function whatsMyContext() &#123; return this&#125;console.log(whatsMyContext() === global) // truevar getMyThis = whatsMyContextconsole.log(getMyThis() === global) // truevar ninja1 = &#123; getMyThis: whatsMyContext&#125;console.log(ninja1.getMyThis() === ninja1) // truevar ninja2 = &#123; getMyThis: whatsMyContext&#125;console.log(ninja2.getMyThis() === ninja2) // true ä½œä¸ºæž„é€ å™¨å‡½æ•°ï¼š12function whatsMyContext()&#123; return this &#125;new whatsMyContext() æ³¨æ„ä¸Žå‡½æ•°æž„é€ å™¨ï¼ˆå¦‚ new Function(&#39;a&#39;, &#39;b&#39;, &#39;return a + b&#39;) ï¼‰çš„åŒºåˆ«ï¼šå‡½æ•°æž„é€ å™¨ç”¨æ¥ä»Žå­—ç¬¦ä¸²ä¸­åŠ¨æ€åœ°åˆ›å»ºå‡½æ•°ï¼Œè€Œæž„é€ å™¨å‡½æ•°åˆ™ç”¨æ¥åˆ›å»ºå¯¹è±¡å®žä¾‹ã€‚ æž„é€ å™¨å‡½æ•°åœ¨è°ƒç”¨æ—¶ä¸€èˆ¬ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š åˆ›å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡ æ–°åˆ›å»ºçš„å¯¹è±¡ç»‘å®šç»™ this å‚æ•°ä¼ é€’ç»™æž„é€ å™¨ï¼Œæˆä¸ºæž„é€ å™¨å‡½æ•°çš„ä¸Šä¸‹æ–‡ æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸º new æ“ä½œçš„è¿”å›žå€¼è¢«è¿”å›ž 1234567891011function Ninja() &#123; this.skulk = function() &#123; return this &#125;&#125;var ninja1 = new Ninja()console.log(ninja1.skulk() === ninja1) // truevar ninja2 = new Ninja()console.log(ninja2.skulk() === ninja2) // true è‹¥æž„é€ å™¨å‡½æ•°çš„å®šä¹‰ä¸­æœ¬èº«å…·æœ‰è¿”å›žå€¼ï¼Œåˆ™åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š è‹¥æž„é€ å™¨çš„å®šä¹‰ä¸­è¿”å›žäº†ä¸€ä¸ªéžå¯¹è±¡å€¼ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ç­‰ï¼‰ï¼Œåˆ™è¯¥è¿”å›žå€¼è¢«å¿½ç•¥ï¼Œç”±æž„é€ å™¨åˆ›å»ºçš„ this å¯¹è±¡è¢«è¿”å›žä½œä¸º new è¡¨è¾¾å¼çš„å€¼ è‹¥æž„é€ å™¨çš„å®šä¹‰ä¸­è¿”å›žäº†ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¯¥å¯¹è±¡ä½œä¸º new è¡¨è¾¾å¼çš„å€¼ï¼Œç”±æž„é€ å™¨åˆ›å»ºçš„ this å¯¹è±¡åˆ™è¢«å¿½ç•¥12345678910function Ninja() &#123; this.skulk = function() &#123; return true &#125; return 1&#125;var ninja = new Ninja()console.log(ninja) // Ninja &#123; skulk: [Function] &#125;console.log(ninja.skulk()) // true 123456789101112var puppet = &#123; rules: false&#125;function Emperor() &#123; this.rules = true return puppet&#125;var emperor = new Emperor()console.log(emperor) // &#123; rules: false &#125;console.log(emperor.rules) // false apply å’Œ call æ–¹æ³•ï¼š12345678910111213141516function juggle() &#123; var result = 0 for (var n = 0; n &lt; arguments.length; n++) &#123; result += arguments[n] &#125; this.result = result&#125;var ninja1 = &#123;&#125;var ninja2 = &#123;&#125;juggle.apply(ninja1, [1,2,3,4])juggle.call(ninja2, 5,6,7,8)console.log(ninja1.result) // 10console.log(ninja2.result) // 26 å‚è€ƒèµ„æ–™Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Functional</tag>
        <tag>Development</tag>
        <tag>JavaScript</tag>
        <tag>Function</tag>
        <tag>ECMAScript6</tag>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript è§£å¯† â€”â€” å‡½æ•°è¿›é˜¶ï¼ˆé—­åŒ…ä¸Žç”Ÿæˆå™¨ï¼‰]]></title>
    <url>%2F2020%2F06%2F04%2Funderstanding-javascript-closure-and-generator%2F</url>
    <content type="text"><![CDATA[ä¸€ã€é—­åŒ…ç®€å•æ¥è¯´ï¼Œé—­åŒ…ï¼ˆclosureï¼‰å…è®¸å‡½æ•°è®¿é—®å’Œæ“ä½œä½äºŽè‡ªèº«å¤–éƒ¨çš„å˜é‡ã€‚å€ŸåŠ©é—­åŒ…çš„ç‰¹æ€§ï¼Œå‡½æ•°å¯ä»¥è®¿é—®ä»»ä½•å˜é‡åŠå…¶ä»–å‡½æ•°ï¼Œåªè¦è¿™äº›æ•°æ®åœ¨è¯¥å‡½æ•°å®šä¹‰æ—¶ä½äºŽå…¶ä½œç”¨åŸŸå†…éƒ¨ã€‚1234567891011121314151617var outerValue = "samurai"var laterfunction outerFunction() &#123; var innerValue = "ninja" function innerFunction() &#123; console.log(outerValue) console.log(innerValue) &#125; later = innerFunction&#125;outerFunction()later()// samurai// ninja å‚è€ƒä¸Šé¢çš„ä»£ç ï¼ŒæŒ‰ç…§é€šå¸¸çš„ç†è§£ï¼š å˜é‡ outerValue å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå› æ­¤å…¶å¯ä»¥ä»Žç¨‹åºçš„ä»»æ„ä½ç½®è®¿é—® outerFunction æ‰§è¡Œï¼Œå°† innerFunction å…³è”ç»™å…¨å±€å˜é‡ later å½“ laterï¼ˆinnerFunctionï¼‰æ‰§è¡Œæ—¶ï¼ŒouterFunction å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œå…¶å†…éƒ¨çš„ä½œç”¨åŸŸç†åº”å¤±æ•ˆï¼Œæ— æ³•è¢« later è®¿é—® innerValue ç”±äºŽåœ¨ outerFunction å†…éƒ¨å®šä¹‰ï¼Œåˆ™ later è®¿é—® innerValue æ—¶å…¶å€¼åº”è¯¥ä¸º undefined å®žé™…ä¸Šç¨‹åºè¾“å‡ºçš„ innerValue çš„å€¼ä¸º ninjaï¼Œå³ outerFunction å†…éƒ¨å®šä¹‰çš„ innerValue å¯ä»¥è¢« later è®¿é—®ã€‚è¿™å°±æ˜¯é—­åŒ…æ‰€äº§ç”Ÿçš„æ•ˆæžœã€‚ å½“æˆ‘ä»¬åœ¨ outerFunction å†…éƒ¨å£°æ˜Ž innerFunction æ—¶ï¼Œä¸€ä¸ªåŒ…å«å½“å‰ä½œç”¨åŸŸï¼ˆâ€œå½“å‰â€æŒ‡çš„æ˜¯å†…éƒ¨å‡½æ•°å®šä¹‰çš„æ—¶åˆ»ï¼‰ä¸­æ‰€æœ‰å˜é‡çš„é—­åŒ…åŒæ—¶è¢«åˆ›å»ºã€‚æœ€ç»ˆ innerFunction æ‰§è¡Œæ—¶ï¼Œå³ä¾¿å…¶å£°æ˜Žæ—¶çš„åŽŸå§‹ä½œç”¨åŸŸå·²ç»æ¶ˆå¤±ï¼ŒinnerFunction è¿˜æ˜¯å¯ä»¥é€šè¿‡é—­åŒ…è®¿é—®å…¶åŽŸå§‹ä½œç”¨åŸŸã€‚é—­åŒ…åƒæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªâ€œä¿æŠ¤å±‚â€å°†å‡½æ•°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸå°é—­èµ·æ¥ï¼Œåªè¦è¯¥å‡½æ•°çš„ç”Ÿå‘½å‘¨æœŸæœªç»“æŸï¼Œâ€œä¿æŠ¤å±‚â€å†…çš„ä½œç”¨åŸŸå°±ä¸€ç›´å¯ä»¥è¢«è®¿é—®ã€‚ äºŒã€é—­åŒ…çš„çŽ°å®žåº”ç”¨æ¨¡æ‹Ÿç§æœ‰å˜é‡ç§æœ‰å˜é‡å³ä»Žå¯¹è±¡å¤–éƒ¨ä¸å¯è§çš„å˜é‡ï¼Œå¯ä»¥å‘ç”¨æˆ·éšè—å¯¹è±¡å†…éƒ¨ä¸å¿…è¦çš„å®žçŽ°ç»†èŠ‚ã€‚JavaScript æ²¡æœ‰å¯¹ç§æœ‰å˜é‡çš„åŽŸç”Ÿæ”¯æŒï¼Œä½†æ˜¯é€šè¿‡é—­åŒ…å¯ä»¥å®žçŽ°ç±»ä¼¼çš„åŠŸèƒ½ã€‚123456789101112131415161718function Ninja() &#123; var feints = 0 this.getFeints = function() &#123; return feints &#125; this.feint = function() &#123; feints++ &#125;&#125;var ninja1 = new Ninja()ninja1.feint()console.log(ninja1.feints) // undefinedconsole.log(ninja1.getFeints()) // 1var ninja2 = new Ninja()console.log(ninja2.getFeints()) // 0 åœ¨å›žè°ƒå‡½æ•°ä¸­ä½¿ç”¨é—­åŒ…12345678910111213141516&lt;button id="box1"&gt;First Button&lt;/button&gt; &lt;script&gt; function animateIt(elementId) &#123; var elem = document.getElementById(elementId) var tick = 100 var timer = setInterval(function() &#123; if (tick &lt; 1000) &#123; elem.style.width = tick + "px" tick += 10 &#125; else &#123; clearInterval(timer) &#125; &#125;, 100) &#125; animateIt("box1") &lt;/script&gt; åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¸€ä¸ªåŒ¿åå‡½æ•°ä½œä¸ºå‚æ•°ï¼ˆå›žè°ƒå‡½æ•°ï¼‰ä¼ é€’ç»™ setIntervalï¼Œä»¤æŒ‡å®šå…ƒç´ çš„å®½åº¦èƒ½å¤Ÿéšæ—¶é—´å¢žé•¿ä»¥å½¢æˆåŠ¨ç”»æ•ˆæžœã€‚è¯¥åŒ¿åå‡½æ•°å€ŸåŠ©é—­åŒ…èƒ½å¤Ÿè®¿é—®å¤–éƒ¨å®šä¹‰çš„ elemã€tickã€timer ä¸‰ä¸ªå‚æ•°ï¼ŒæŽ§åˆ¶åŠ¨ç”»çš„è¿›åº¦ã€‚è¿™ä¸‰ä¸ªå‚æ•°å®šä¹‰åœ¨ animateIt å†…éƒ¨é€šè¿‡é—­åŒ…è¢«å›žè°ƒå‡½æ•°è®¿é—®ï¼Œè€Œä¸æ˜¯ç›´æŽ¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å®šä¹‰ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ª animateIt å‡½æ•°ä¾æ¬¡è¿è¡Œæ—¶å¼•èµ·å†²çªã€‚ ä¸‰ã€ç”Ÿæˆå™¨ç”Ÿæˆå™¨æ˜¯ä¸€ç§å¯ä»¥ç”Ÿæˆä¸€ç³»åˆ—å€¼çš„ç‰¹æ®Šå‡½æ•°ï¼Œåªä¸è¿‡è¿™äº›å€¼ä¸æ˜¯åŒæ—¶äº§ç”Ÿçš„ï¼Œéœ€è¦ç”¨æˆ·æ˜¾å¼åœ°åŽ»è¯·æ±‚æ–°å€¼ï¼ˆé€šè¿‡ forã€next ç­‰ï¼‰ã€‚12345678910111213function* WeaponGenerator() &#123; yield "Katana" yield "Wakizashi" yield "Kusarigama"&#125;for(let weapon of WeaponGenerator()) &#123; console.log(weapon)&#125;// Katana// Wakizashi// Kusarigama è°ƒç”¨ç”Ÿæˆå™¨å¹¶ä¸æ„å‘³ç€ä¼šé€æ­¥æ‰§è¡Œç”Ÿæˆå™¨å‡½æ•°çš„å®šä¹‰ä»£ç ï¼Œè€Œæ˜¯ä¼šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼ˆiteratorï¼‰å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªè¿­ä»£å™¨å¯¹è±¡ä¸Žç”Ÿæˆå™¨è¿›è¡Œäº¤äº’ï¼ˆå¦‚è¯·æ±‚æ–°çš„å€¼ï¼‰ã€‚123456789101112131415161718function* WeaponGenerator() &#123; yield "Katana" yield "Wakizashi"&#125;const weaponsIterator = WeaponGenerator()const result1 = weaponsIterator.next()console.log(typeof result1, result1.value, result1.done)// object Katana falseconst result2 = weaponsIterator.next()console.log(typeof result2, result2.value, result2.done)// object Wakizashi falseconst result3 = weaponsIterator.next()console.log(typeof result3, result3.value, result3.done)// object undefined true ä½¿ç”¨ while éåŽ†ç”Ÿæˆå™¨ï¼š12345678910111213function* WeaponGenerator() &#123; yield "Katana" yield "Wakizashi"&#125;const weaponsIterator = WeaponGenerator()let itemwhile(!(item = weaponsIterator.next()).done) &#123; console.log(item.value)&#125;// Katana// Wakizashi ç”Ÿæˆå™¨åµŒå¥—ï¼š12345678910111213141516171819function* WarriorGenerator() &#123; yield "Sun Tzu" yield* NinjaGenerator() yield "Genghis Khan"&#125;function* NinjaGenerator() &#123; yield "Hattori" yield "Yoshi"&#125;for(let warrior of WarriorGenerator()) &#123; console.log(warrior)&#125;// Sun Tzu// Hattori// Yoshi// Genghis Khan ç”Ÿæˆå™¨çš„åº”ç”¨ç”Ÿæˆ ID123456789101112131415function* IdGenerator() &#123; let id = 0 while (true) &#123; yield ++id &#125;&#125;const idIterator = IdGenerator()const ninja1 = &#123; id: idIterator.next().value &#125;const ninja2 = &#123; id: idIterator.next().value &#125;const ninja3 = &#123; id: idIterator.next().value &#125;console.log(ninja1.id) // 1console.log(ninja2.id) // 2console.log(ninja3.id) // 3 éåŽ†DOM ä½¿ç”¨é€’å½’å‡½æ•°ï¼š123456789101112131415161718192021&lt;div id="subTree"&gt; &lt;form&gt; &lt;input type="text" /&gt; &lt;/form&gt; &lt;p&gt;Paragraph&lt;/p&gt; &lt;span&gt;Span&lt;/span&gt;&lt;/div&gt; &lt;script&gt; function traverseDOM(element, callback) &#123; callback(element) element = element.firstElementChild while (element) &#123; traverseDOM(element, callback) element = element.nextElementSibling &#125; &#125; const subTree = document.getElementById("subTree") traverseDOM(subTree, function(element) &#123; console.log(element.nodeName) &#125;) &lt;/script&gt; ä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆæ— éœ€å€ŸåŠ© callbackï¼‰ï¼š12345678910111213141516171819202122&lt;div id="subTree"&gt; &lt;form&gt; &lt;input type="text" /&gt; &lt;/form&gt; &lt;p&gt;Paragraph&lt;/p&gt; &lt;span&gt;Span&lt;/span&gt;&lt;/div&gt; &lt;script&gt; function* DomTraversal(element) &#123; yield element element = element.firstElementChild while (element) &#123; yield* DomTraversal(element) element = element.nextElementSibling &#125; &#125; const subTree = document.getElementById("subTree") for(let element of DomTraversal(subTree)) &#123; console.log(element.nodeName) &#125; &lt;/script&gt; é€šè¿‡ next æ–¹æ³•å‘ç”Ÿæˆå™¨å‘é€å€¼ç”Ÿæˆå™¨ä¸ä»…å¯ä»¥é€šè¿‡ yield è¡¨è¾¾å¼ç”Ÿæˆä¸€ç³»åˆ—å€¼ï¼Œè¿˜å¯ä»¥æŽ¥å—ç”¨æˆ·ä¼ å…¥æ•°æ®ï¼Œå½¢æˆä¸€ç§åŒå‘çš„é€šä¿¡ã€‚1234567891011function* NinjaGenerator(action) &#123; const imposter = yield ("Hattori " + action) yield ("Yoshi (" + imposter + ") " + action)&#125;const ninjaIterator = NinjaGenerator("skulk")const result1 = ninjaIterator.next()console.log(result1.value) // Hattori skulkconst result2 = ninjaIterator.next("Hanzo")console.log(result2.value) // Yoshi (Hanzo) skulk å…·ä½“çš„æ‰§è¡Œæµç¨‹ä¸ºï¼š ç¬¬ä¸€ä¸ª ninjaIterator.next() å‘ç”Ÿæˆå™¨è¯·æ±‚æ–°å€¼ï¼ŒèŽ·å–åˆ°ç¬¬ä¸€ä¸ª yield å³ä¾§çš„å€¼ &quot;Hattori &quot; + actionï¼ŒåŒæ—¶åœ¨ yield (&quot;Hattori &quot; + action) è¡¨è¾¾å¼å¤„æŒ‚èµ·æ‰§è¡Œæµç¨‹ ç¬¬äºŒä¸ª ninjaIterator.next(&quot;Hanzo&quot;) ç»§ç»­å‘ç”Ÿæˆå™¨è¯·æ±‚æ–°å€¼ï¼ŒåŒæ—¶è¿˜å‘é€äº†å‚æ•° Hanzo ç»™ç”Ÿæˆå™¨ï¼Œè¯¥å‚æ•°åˆšå¥½ç”¨ä½œå‰é¢æŒ‚èµ·çš„ yield (&quot;Hattori &quot; + action) è¡¨è¾¾å¼çš„ç»“æžœï¼Œä½¿å¾— imposter çš„å€¼æˆä¸º Hanzo æœ€ç»ˆ ninjaIterator.next(&quot;Hanzo&quot;) è¯·æ±‚èŽ·å¾—ç¬¬äºŒä¸ª yield å³ä¾§ &quot;Yoshi (&quot; + imposter + &quot;) &quot; + action çš„å€¼ï¼Œå³ Yoshi (Hanzo) skulk å‚è€ƒèµ„æ–™Secrets of the JavaScript Ninja, Second Edition]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Functional</tag>
        <tag>Development</tag>
        <tag>JavaScript</tag>
        <tag>Function</tag>
        <tag>ECMAScript6</tag>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å€ŸåŠ© Celery å®žçŽ°è®¡åˆ’ä»»åŠ¡æŽ’æœŸåŠè°ƒåº¦ç³»ç»Ÿï¼ˆdjango-celery-beatï¼‰]]></title>
    <url>%2F2020%2F05%2F08%2Ftask-schedule-system-with-django-celery-beat%2F</url>
    <content type="text"><![CDATA[ä¸€ã€çŽ¯å¢ƒæ­å»ºé…ç½®è¿è¡ŒçŽ¯å¢ƒï¼š123$ python -m venv env$ source ./env/bin/activate$ pip install django-celery-beat django-celery-results redis é¡¹ç›®åˆå§‹åŒ–ï¼š123$ django-admin startproject schedule_task$ cd schedule_task$ django-admin startapp schedules ä¿®æ”¹ schedule_task/settings.py é…ç½®æ–‡ä»¶ï¼Œå°† ALLOWED_HOSTS = [] æ”¹ä¸º ALLOWED_HOSTS = [&#39;*&#39;]è¿è¡Œ web æœåŠ¡ï¼š $ python manage.py runserver 0.0.0.0:8000 äºŒã€å¯ç”¨ schedule-celery-beat å’Œ schedule-celery-resultsåœ¨ schedule_task/settings.py æ–‡ä»¶ä¸­çš„ INSTALLED_APPS é…ç½®é¡¹ä¸‹ï¼Œæ·»åŠ å¦‚ä¸‹ä¸‰ä¸ªåº”ç”¨ï¼š123456INSTALLED_APPS = [ ... 'schedules', 'django_celery_results', 'django_celery_beat'] å…¶ä¸­ django_celery_results ç”¨äºŽåœ¨æ•°æ®åº“ä¸­å­˜å‚¨ Celery ä»»åŠ¡æ‰§è¡Œçš„ç»“æžœã€‚django_celery_beat åˆ™ç”¨äºŽåœ¨æ•°æ®åº“ä¸­è®°å½•é¢„å…ˆå®šä¹‰å¥½çš„ä»»åŠ¡æ‰§è¡Œè§„åˆ™ï¼ˆæ¯”å¦‚æ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰ï¼Œä»¥åŠä¸Žè¿™äº›è§„åˆ™å…³è”çš„å¾…æ‰§è¡Œçš„å…·ä½“ä»»åŠ¡ã€‚ æ•°æ®åº“è¿ç§»ï¼Œåˆ›å»ºè¶…çº§ç”¨æˆ·ï¼š12$ python manage.py migrate$ python manage.py createsuperuser ä¸‰ã€ç³»ç»ŸåŽå°å¯åŠ¨ web æœåŠ¡ï¼Œç”¨ä¸Šä¸€æ­¥ä¸­åˆ›å»ºçš„è¶…çº§ç”¨æˆ·ç™»å½•åŽå°ç®¡ç†ç³»ç»Ÿï¼šhttp://127.0.0.1:8000/admin ã€‚ç•Œé¢å¦‚ä¸‹ï¼š ç•Œé¢ä¸­ CELERY RESULTS ä¸º django_celery_results åˆ›å»ºçš„ç”¨äºŽä¿å­˜ä»»åŠ¡ç»“æžœçš„æ•°æ®åº“è¡¨ã€‚ PERIODIC TASKS ä¸‹é¢åˆ™æ˜¯ç”± django_celery_beat åˆ›å»ºçš„ç”¨äºŽä¿å­˜ Celery ä»»åŠ¡åŠå…¶æ‰§è¡Œè§„åˆ™çš„å‡ å¼ æ•°æ®åº“è¡¨ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š Clockedï¼šå®šä¹‰åœ¨å…·ä½“æŸä¸ªæ—¶é—´ç‚¹è§¦å‘çš„æ‰§è¡Œè§„åˆ™ Crontabsï¼šç±»ä¼¼äºŽ Linux ç³»ç»Ÿä¸‹ crontab çš„è¯­æ³• Intervalsï¼šå®šä¹‰ä»»åŠ¡é‡å¤æ‰§è¡Œçš„æ—¶é—´é—´éš” Periodic tasksï¼šå…·ä½“æŸä¸ªå¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œéœ€è¦ä¸Žå…¶ä»–è¡¨ï¼ˆClockedã€Crontabsã€Intervalsã€Solar eventsï¼‰ä¸­å®šä¹‰çš„æ‰§è¡Œè§„åˆ™ç›¸å…³è” Solar eventsï¼šæ ¹æ®æ—¥å‡å’Œæ—¥è½ç­‰å¤ªé˜³è¿è¡Œè½¨è¿¹ç¡®å®šæ‰§è¡Œè§„åˆ™ å¦‚å®šä¹‰ä¸€ä¸ªæ¯éš” 10 ç§’æ‰§è¡Œä¸€æ¬¡çš„è§„åˆ™ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š å››ã€åˆ›å»º Celery ä»»åŠ¡Celery ä»»åŠ¡éœ€è¦åœ¨æºä»£ç ä¸­æ‰‹åŠ¨åˆ›å»ºï¼Œå…·ä½“å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ Using Celery With Djangoï¼Œç®€è¦æ­¥éª¤å¦‚ä¸‹ï¼š schedule_task/schedule_task/celery.pyï¼š123456789101112131415# schedule_task/schedule_task/celery.pyfrom __future__ import absolute_import, unicode_literalsimport osfrom celery import Celery# set the default Django settings module for the 'celery' program.os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'schedule_task.settings')app = Celery('schedule_task')# - namespace='CELERY' means all celery-related configuration keys# should have a `CELERY_` prefix.app.config_from_object('django.conf:settings', namespace='CELERY')# Load task modules from all registered Django app configs.app.autodiscover_tasks() schedule_task/schedule_task/__init__.pyï¼š12345678# schedule_task/schedule_task/__init__.pyfrom __future__ import absolute_import, unicode_literals# This will make sure the app is always imported when# Django starts so that shared_task will use this app.from .celery import app as celery_app__all__ = ('celery_app',) schedule_tasks/schedules/tasks.pyï¼š1234567# schedule_tasks/schedules/tasks.pyfrom __future__ import absolute_import, unicode_literalsfrom celery import shared_task@shared_task(bind=True)def debug_task(self): return f'Hello Celery, the task id is: &#123;self.request.id&#125;' ä½¿ç”¨ Redis ä½œä¸º Message Brokerï¼ŒDjango é»˜è®¤é…ç½®çš„æ•°æ®åº“ä½œä¸º Result Backendï¼ŒDatabaseScheduler ä½œä¸º Celery çš„ä»»åŠ¡è°ƒåº¦å™¨ï¼š schedule_task/schedule_task/settings.pyï¼š12345# schedule_task/schedule_task/settings.py# ...CELERY_RESULT_BACKEND = 'django-db'CELERY_BROKER_URL = 'redis://127.0.0.1:6379/0'CELERY_BEAT_SCHEDULER = 'django_celery_beat.schedulers:DatabaseScheduler' æ­¤æ—¶å¯è¿›å…¥ç³»ç»Ÿç®¡ç†åŽå°ï¼Œå°†ä»»åŠ¡ debug_task å…³è”ç»™æ¯éš” 10s æ‰§è¡Œçš„è§„åˆ™ï¼š åªéœ€è¦å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œé€‰æ‹©ç›¸å…³è”çš„ä»»åŠ¡å’Œ Schedule å³å¯ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œå®šä¹‰è®¡åˆ’ä»»åŠ¡çš„å…¶ä»–å‚æ•°ï¼Œå¦‚ï¼š ç”Ÿæ•ˆæ—¶é—´ æ˜¯å¦åªæ‰§è¡Œä¸€æ¬¡ ä¼ é€’ç»™ä»»åŠ¡çš„å‚æ•° å¤±æ•ˆæ—¶é—´ äº”ã€è¿è¡Œæµ‹è¯•ä¸ºäº†ä½¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼Œéœ€è¦åŒæ—¶å¼€å¯ä¸‰ä¸ªæœåŠ¡ï¼š web æœåŠ¡ï¼špython manage.py runserver 0.0.0.0:8000 Celery Workerï¼šcelery -A schedule_task worker -l info Celery Beatï¼šcelery -A schedule_task beat -l info æœåŠ¡æˆåŠŸè¿è¡ŒåŽï¼Œè¾“å‡ºä¿¡æ¯å¦‚ä¸‹ Celery Beat æŒç»­ç›‘æµ‹æ•°æ®åº“ä¸­å­˜å‚¨çš„è®¡åˆ’ä»»åŠ¡ä¿¡æ¯ï¼Œå°†æ»¡è¶³è§¦å‘æ¡ä»¶çš„ä»»åŠ¡ä¼ é€’ç»™ Celery Worker æ‰§è¡Œï¼š 12345678910111213141516171819$ celery -A schedule_task beat -l infocelery beat v4.4.2 (cliffs) is starting.__ - ... __ - _LocalTime -&gt; 2020-05-08 03:44:41Configuration -&gt; . broker -&gt; redis://127.0.0.1:6379/0 . loader -&gt; celery.loaders.app.AppLoader . scheduler -&gt; django_celery_beat.schedulers.DatabaseScheduler . logfile -&gt; [stderr]@%INFO . maxinterval -&gt; 5.00 seconds (5s)[2020-05-08 03:44:41,578: INFO/MainProcess] beat: Starting...[2020-05-08 03:44:41,578: INFO/MainProcess] Writing entries...[2020-05-08 03:44:46,745: INFO/MainProcess] Writing entries...[2020-05-08 03:44:51,594: INFO/MainProcess] Scheduler: Sending due task debug_task (schedules.tasks.debug_task)[2020-05-08 03:45:01,585: INFO/MainProcess] Scheduler: Sending due task debug_task (schedules.tasks.debug_task)[2020-05-08 03:45:11,587: INFO/MainProcess] Scheduler: Sending due task debug_task (schedules.tasks.debug_task)[2020-05-08 03:45:21,588: INFO/MainProcess] Scheduler: Sending due task debug_task (schedules.tasks.debug_task)[2020-05-08 03:45:31,591: INFO/MainProcess] Scheduler: Sending due task debug_task (schedules.tasks.debug_task) Celery Worker è´Ÿè´£æ‰§è¡Œç”± Beat ä¼ è¿‡æ¥çš„ä»»åŠ¡ï¼Œè¾“å‡ºæ‰§è¡Œç»“æžœå¹¶å°†ç»“æžœä¿å­˜è‡³ result backendï¼ˆå³æ•°æ®åº“ï¼‰ï¼š 123456789101112131415$ celery -A schedule_task worker -l info[tasks] . schedules.tasks.debug_task[2020-05-08 03:44:05,521: INFO/MainProcess] Connected to redis://127.0.0.1:6379/0[2020-05-08 03:44:05,529: INFO/MainProcess] mingle: searching for neighbors[2020-05-08 03:44:06,546: INFO/MainProcess] mingle: all alone[2020-05-08 03:44:06,558: INFO/MainProcess] celery@mirrors ready.[2020-05-08 03:44:51,607: INFO/MainProcess] Received task: schedules.tasks.debug_task[3d6b77bb-d4b7-4a5d-b05f-3b85e5dafce7][2020-05-08 03:44:51,687: INFO/ForkPoolWorker-1] Task schedules.tasks.debug_task[3d6b77bb-d4b7-4a5d-b05f-3b85e5dafce7] succeeded in 0.07936301361769438s: 'Hello Celery, the task id is: 3d6b77bb-d4b7-4a5d-b05f-3b85e5dafce7'[2020-05-08 03:45:01,588: INFO/MainProcess] Received task: schedules.tasks.debug_task[a097dc02-71c9-4cab-9871-92ed1a7f2f45][2020-05-08 03:45:01,660: INFO/ForkPoolWorker-1] Task schedules.tasks.debug_task[a097dc02-71c9-4cab-9871-92ed1a7f2f45] succeeded in 0.07120843604207039s: 'Hello Celery, the task id is: a097dc02-71c9-4cab-9871-92ed1a7f2f45'[2020-05-08 03:45:11,590: INFO/MainProcess] Received task: schedules.tasks.debug_task[1b0dfc23-d3cc-495a-b306-9d1defe4b119][2020-05-08 03:45:11,659: INFO/ForkPoolWorker-1] Task schedules.tasks.debug_task[1b0dfc23-d3cc-495a-b306-9d1defe4b119] succeeded in 0.0677587790414691s: 'Hello Celery, the task id is: 1b0dfc23-d3cc-495a-b306-9d1defe4b119' åŽå°ç®¡ç†ç³»ç»Ÿ task results ç•Œé¢ï¼š task results é‡Œé»˜è®¤æ˜¾ç¤ºçš„æ˜¯ UTC æ—¶é—´ï¼Œå¯ä»¥ä¿®æ”¹ schedule_task/schedule_task/settings.py é…ç½®æ–‡ä»¶æ›´æ”¹æ—¶åŒºè®¾ç½®ï¼š1TIME_ZONE = 'Asia/Shanghai' PSï¼šå®žé™…æµ‹è¯•ä»¥åŽï¼Œæ­¤å¤„çš„æ—¶åŒºè®¾ç½®åªä¼šå¯¹ç½‘é¡µç«¯ task results è¡¨æ ¼ä¸­æ˜¾ç¤ºçš„æ—¶é—´èµ·ä½œç”¨ï¼Œå®žé™…ä¿å­˜åˆ° task results æ•°æ®åº“è¡¨ä¸­çš„æ—¶é—´ä¾æ—§æ˜¯ UTC æ—¶é—´ã€‚å¦‚éœ€è¦äºŒæ¬¡å¼€å‘ï¼Œå¯ä»¥è°ƒç”¨è¿”å›žçš„ datetime å¯¹è±¡çš„ astimezone æ–¹æ³•è¿›è¡Œæ—¶åŒºæ ¼å¼è½¬æ¢ã€‚ å‚è€ƒèµ„æ–™Celery 4.4.2 documentation: First steps with Djangodjango-celery-beat - Database-backed Periodic Tasksdjango-celery-results - Celery Result Backends for Django]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>Celery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç†è§£ JavaScript ç¼–ç¨‹ï¼ˆECMAScript 6ï¼‰ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2020%2F05%2F07%2Funderstanding-JavaScript-EMCAScript-6-1%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Block Bindingåœ¨å¤§å¤šæ•°åŸºäºŽ C çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå˜é‡é€šå¸¸ä¼šåœ¨å£°æ˜Žæ—¶åˆ›å»ºã€‚è€Œå¯¹äºŽ JavaScript è¯­è¨€ï¼Œå˜é‡åˆ›å»ºçš„æ—¶é—´ç‚¹åˆ™å–å†³äºŽå…·ä½“çš„å£°æ˜Žæ–¹å¼ã€‚JavaScript ä¸­ç»å…¸çš„ä½¿ç”¨ var å£°æ˜Žå˜é‡çš„æ–¹å¼å®¹æ˜“å¼•èµ·å›°æƒ‘ï¼Œå› æ­¤ ECMAScript 6 ä¸­å¼•å…¥äº†å—çº§åˆ«çš„å˜é‡ç»‘å®šï¼ˆblock-level bindingï¼‰ã€‚ var å…³é”®å­—var å…³é”®å­—å¯¹äºŽå˜é‡çš„å£°æ˜Žï¼Œä¼šé»˜è®¤è¯¥å£°æ˜Žä½äºŽå‡½æ•°é¡¶éƒ¨ï¼ˆä½äºŽå‡½æ•°å¤–éƒ¨æ—¶ä¸ºå…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œè€Œä¸åŽ»ç®¡å£°æ˜Žè¯­å¥å®žé™…å‡ºçŽ°çš„ä½ç½®ã€‚ç§°ä¸º hoisting ã€‚12345678910111213141516function getValue(condition) &#123; if (condition) &#123; var value = "blue" console.log("condition is true and value is " + value) &#125; else &#123; console.log("condition is false and value is " + value) &#125; console.log("outside if, value is " + value)&#125;getValue(true)// condition is true and value is blue// outside if, value is bluegetValue(false)// condition is false and value is undefined// outside if, value is undefined ä¹ æƒ¯ä¸Šä¼šè®¤ä¸ºï¼Œä¸Šè¿°ä»£ç ä¸­åªæœ‰ condition ä¸º True æ—¶å˜é‡ value æ‰ä¼šè¢«åˆ›å»ºï¼›å®žé™…ä¸Š value å˜é‡å­˜åœ¨äºŽå‡½æ•°çš„å„ä¸ªéƒ¨åˆ†ï¼Œåªæ˜¯åœ¨ condition ä¸º False æ—¶æœªè¢«åˆå§‹åŒ–ï¼ˆundefinedï¼‰ã€‚ ä¸Šé¢çš„ä»£ç ä¼šè¢« JavaScript å¼•æ“Žè§†ä½œå¦‚ä¸‹å½¢å¼ï¼š12345678910function getValue(condition) &#123; var value; if (condition) &#123; value = "blue"; console.log("condition is true and value is " + value) &#125; else &#123; console.log("condition is false and value is " + value) &#125; console.log("outside if, value is " + value)&#125; å—çº§å£°æ˜Žå’Œ let è¯­å¥ç”±å—çº§å£°æ˜Žåˆ›å»ºçš„å˜é‡æ— æ³•è¢«è¯¥ä»£ç å—ä»¥å¤–çš„éƒ¨åˆ†è®¿é—®ã€‚ å—ä½œç”¨åŸŸï¼ˆBlock scopesï¼‰ä¸€èˆ¬åˆ›å»ºäºŽä»¥ä¸‹ä½ç½®ï¼š å‡½æ•°å†…éƒ¨ ä»£ç å—å†…éƒ¨ï¼ˆè¢«å¤§æ‹¬å· {} åŒ…è£¹çš„éƒ¨åˆ†ï¼‰ å—ä½œç”¨åŸŸç¬¦åˆå¤§éƒ¨åˆ†åŸºäºŽ C çš„ç¼–ç¨‹è¯­è¨€çš„å·¥ä½œæ–¹å¼ã€‚ let å…³é”®å­—ä¼šå°†å˜é‡çš„ä½œç”¨åŸŸé™åˆ¶åœ¨å½“å‰ä»£ç å—å†…éƒ¨ã€‚12345678910111213function getValue(condition) &#123; if (condition) &#123; let value = "blue" console.log("condition is true and value is " + value) &#125; else &#123; console.log("condition is false and value is " + value) &#125; console.log("outside if, value is " + value)&#125;getValue(true)// condition is true and value is blue// ReferenceError: value is not defined No Redeclarationå¦‚æžœåŒä¸€ä½œç”¨åŸŸå†…å·²æœ‰ç›¸åŒåç§°çš„å˜é‡è¢«å£°æ˜Žï¼Œåˆ™ let è¯­å¥ä¼šæŠ¥é”™ã€‚123var count = 30let count = 40// SyntaxError: Identifier 'count' has already been declared ä½†æ˜¯åœ¨ä¸åŒä½œç”¨åŸŸä¸­ï¼Œç±»ä¼¼çš„æƒ…å†µåˆ™ä¸ä¼šæŠ¥é”™ï¼š1234var count = 30if (true) &#123; let count = 40&#125; const å…³é”®å­—ç”¨äºŽå£°æ˜Žå¸¸é‡ï¼Œå¸¸é‡çš„å€¼ä¸€æ—¦ç¡®å®šåŽå³ä¸å¯å†å˜æ›´ï¼Œå› æ­¤åœ¨å£°æ˜Žçš„åŒæ—¶å¿…é¡»èµ‹å€¼ä»¥å®Œæˆåˆå§‹åŒ–ã€‚123const maxItems = 30const name;// SyntaxError: Missing initializer in const declaration éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¸¸é‡çš„â€œä¸å¯å˜â€ä»…é’ˆå¯¹å˜é‡ä¸Žå€¼çš„ç»‘å®šå…³ç³»ï¼Œè€Œå¹¶ä¸é™åˆ¶å€¼æœ¬èº«çš„æ”¹åŠ¨ã€‚å³ä½¿ç”¨ const å£°æ˜ŽæŸä¸ªå¯¹è±¡ï¼Œåˆ™å¯¹è±¡æœ¬èº«çš„æ”¹åŠ¨ä¸è¢«ç¦æ­¢ã€‚12345678910const person = &#123; name: "Nicholas"&#125;person.name = "Greg"person.name// 'Greg'person = &#123; name: "Grep"&#125;// TypeError: Assignment to constant variable. å¾ªçŽ¯ä¸­çš„å—çº§ç»‘å®švarï¼š12345for (var i = 0; i &lt; 10; i++) &#123; // do nothing&#125;console.log(i)// 10 letï¼š12345for (let i = 0; i &lt; 10; i++) &#123; // do nothing&#125;console.log(i)// ReferenceError: i is not defined var å£°æ˜Žè¯­å¥çš„ç‰¹æ€§ï¼ˆloop å˜é‡å¯ä»¥ä»Ž loop å¤–éƒ¨è®¿é—®ï¼‰ä½¿å¾—åœ¨å¾ªçŽ¯ä¸­åˆ›å»ºå‡½æ•°çš„è¡Œä¸ºä¼šäº§ç”Ÿé—®é¢˜ã€‚123456789101112131415161718192021var funcs = []for (var i = 0; i &lt; 10; i++) &#123; funcs.push(function() &#123; console.log(i) &#125;)&#125;funcs.forEach(function(func) &#123; func()&#125;)// 10// 10// 10// 10// 10// 10// 10// 10// 10// 10 è§£å†³çš„åŠžæ³•æ˜¯ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š1234567891011121314151617181920212223var funcs = []for (var i = 0; i &lt; 10; i++) &#123; funcs.push((function(value) &#123; return function() &#123; console.log(value) &#125; &#125;(i)))&#125;funcs.forEach(function(func) &#123; func()&#125;)// 0// 1// 2// 3// 4// 5// 6// 7// 8// 9 æœ‰äº†å—çº§å£°æ˜Žä»¥åŽï¼Œä¸Šè¿°éœ€æ±‚å¯ä»¥è¢«ç®€å•åœ°å®žçŽ°ï¼ˆåªéœ€è¦å°†ç¬¬ä¸€æ®µä»£ç ä¸­çš„ var å…³é”®å­—æ”¹ä¸º let å³å¯ï¼‰ï¼š123456789101112131415161718192021var funcs = []for (let i = 0; i &lt; 10; i++) &#123; funcs.push(function() &#123; console.log(i) &#125;)&#125;funcs.forEach(function(func) &#123; func()&#125;)// 0// 1// 2// 3// 4// 5// 6// 7// 8// 9 äºŒã€å‡½æ•°å‚æ•°å¸¦é»˜è®¤å€¼çš„å‡½æ•°åœ¨ ECMAScript 5 åŠä»¥å‰ç‰ˆæœ¬çš„ JavaScript ä¸­ï¼Œé€šå¸¸ä½¿ç”¨å¦‚ä¸‹æ¨¡å¼åˆ›å»ºå¸¦é»˜è®¤å‚æ•°çš„å‡½æ•°ï¼š12345function makeRequest(url, timeout, callback) &#123; timeout = timeout || 2000 callback = callback || function() &#123;&#125; // the rest code&#125; ä½†ä¸Šè¿° || ï¼ˆæˆ–ï¼‰æ“ä½œç¬¦çš„ä½¿ç”¨å­˜åœ¨ä¸€å®šé—®é¢˜ï¼Œå¦‚ä¼ é€’ç»™ timeout å‚æ•°çš„å€¼ä¸º 0 æ—¶ï¼Œtimeout || 2000 è¡¨è¾¾å¼çš„å€¼ä¸º 2000 è€Œä¸æ˜¯ 0ï¼Œå¯¼è‡´ç¨‹åºå‡ºçŽ°æ„æƒ³ä¸åˆ°çš„ç»“æžœã€‚æ”¹è¿›å¦‚ä¸‹ï¼š12345function makeRequest(url, timeout, callback) &#123; timeout = (typeof timeout !== "undefined") ? timeout : 2000 callback = (typeof callback !== "undefined") ? callback : function() &#123;&#125; // the rest code&#125; åœ¨ ECMAScript 6 ä¸­ï¼Œä¸ºå‡½æ•°çš„å‚æ•°æä¾›é»˜è®¤å€¼çš„æ–¹å¼åˆ™éžå¸¸ç®€å•ç›´è§‚ï¼š123function makeRequest(url, timeout = 2000, callback = function() &#123;&#125;) &#123; // the rest code&#125; è¡¨è¾¾å¼ä½œä¸ºå‚æ•°é»˜è®¤å€¼ï¼š12345678910function getValue() &#123; return 5&#125;function add(first, second = getValue()) &#123; return first + second&#125;console.log(add(1, 1)) // 2console.log(add(1)) // 6 ç”šè‡³å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š12345678910function getValue(value) &#123; return value + 5&#125;function add(first, second = getValue(first)) &#123; return first + second&#125;console.log(add(1, 1)) // 2console.log(add(1)) // 7 åŒ¿åå‚æ•°ECMAScript 5 ä¸­çš„åŒ¿åå‚æ•°ï¼ˆé€šè¿‡ arguments å¯¹è±¡èŽ·å–æ‰€æœ‰å‚æ•°ï¼ŒåŒ…å«å®šä¹‰å‡½æ•°æ—¶æœªæ˜¾å¼æŒ‡å®šçš„å‚æ•°ï¼‰ï¼š123456789101112131415161718function pick(object) &#123; let result = Object.create(null) for (let i = 1, len = arguments.length; i &lt; len; i++) &#123; result[arguments[i]] = object[arguments[i]] &#125; return result&#125;let book = &#123; title: "Understanding ECMAScript 6", author: "Nicholas C. Zakas", year: 2016&#125;let bookData = pick(book, "author", "year")console.log(bookData.author) // "Nicholas C. Zakas"console.log(bookData.year) // 2016 æ³¨æ„ for å¾ªçŽ¯æ˜¯ä»Ž i=1 å³ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹çš„ã€‚ Rest Parametersä¸Šè¿° pick å‡½æ•°å¯ä»¥åˆ©ç”¨ ECMAScript 6 æ”¯æŒçš„ Rest Parameters ç‰¹æ€§é‡å†™ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12345678910111213141516171819function pick(object, ...keys) &#123; let result = Object.create(null) for (let i = 0, len = keys.length; i &lt; len; i++) &#123; result[keys[i]] = object[keys[i]] &#125; return result&#125;let book = &#123; title: "Understanding ECMAScript 6", author: "Nicholas C. Zakas", year: 2016&#125;let bookData = pick(book, "author", "year")console.log(bookData.author) // "Nicholas C. Zakas"console.log(bookData.year) // 2016 å‡½æ•°æž„é€ å™¨123var add = new Function("first", "second", "return first + second")console.log(add(1, 1)) // 2 ECMAScript 6 ä½¿å¾—å‡½æ•°æž„é€ å™¨å¯ä»¥æ”¯æŒé»˜è®¤å‚æ•°å’Œ rest parameters ç­‰ç‰¹æ€§ï¼š12345678var add = new Function("first", "second = first", "return first + second")console.log(add(1, 1)) // 2console.log(add(1)) // 2var pickFirst = new Function("...args", "return args[0]")console.log(pickFirst(1, 2)) // 1 å‡½æ•°çš„ä¸¤ç§è°ƒç”¨æ–¹å¼123456789function Person(name) &#123; this.name = name&#125;var person = new Person("Nicholas")var notAPerson = Person("Nicholas")console.log(person) // Person &#123; name: 'Nicholas' &#125;console.log(notAPerson) // undefined JavaScript æœ‰ä¸¤ä¸ªé’ˆå¯¹å‡½æ•°çš„å†…éƒ¨æ–¹æ³•ï¼š[[Call]] å’Œ [[Construct]]ã€‚ å½“å‡½æ•°ä¸é€šè¿‡ new å…³é”®å­—è°ƒç”¨æ—¶ï¼Œ[[Call]] æ–¹æ³•æ‰§è¡Œï¼ŒæŽ¥ç€è¿è¡Œå‡½æ•°ä½“ä¸­çš„ä»£ç ï¼›å½“å‡½æ•°é€šè¿‡ new å…³é”®å­—è°ƒç”¨æ—¶ï¼Œ[[Construct]] æ–¹æ³•æ‰§è¡Œï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å®žä¾‹å¹¶ç»‘å®šç»™ thisï¼Œä¹‹åŽç»§ç»­æ‰§è¡Œå‡½æ•°ä½“ä¸­çš„ä»£ç ã€‚ ECMAScript 6 ä¸­å¯ä»¥ä½¿ç”¨ new.target åˆ¤æ–­å½“å‰å‡½æ•°æ˜¯å¦ç”± new è°ƒç”¨ï¼š12345678910function Person(name) &#123; if (typeof new.target !== "undefined") &#123; this.name = name &#125; else &#123; throw new Error("You must use new with Person.") &#125;&#125;var person = new Person("Nicholas")var notAPerson = Person("Michael") // error Arrow FunctionArrow Function æ˜¯æŒ‡ä½¿ç”¨ =&gt; ç¬¦å·å®šä¹‰çš„å‡½æ•°ã€‚ä¸Žä¼ ç»Ÿçš„ JavaScript å‡½æ•°ç›¸æ¯”ï¼ŒArrow Function ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä¸åŒç‚¹ï¼š æ²¡æœ‰ this, super, arguments, new.target çš„ç»‘å®šã€‚Arrow Function ä¸­ this, super, arguments, new.target çš„å€¼ç”±è·ç¦»æœ€è¿‘çš„éž Arrow Function å®šä¹‰ ä¸èƒ½è¢« new è°ƒç”¨ã€‚Arrow Function æ²¡æœ‰æž„é€ æ–¹æ³•å› æ­¤ä¸èƒ½ä½œä¸ºæž„é€ å™¨ä½¿ç”¨ æ²¡æœ‰ prototypeã€‚Arrow Function çš„ prototype å±žæ€§ä¸å­˜åœ¨ï¼ˆå‡½æ•°æœ¬èº«ä¸èƒ½è¢« new è°ƒç”¨ï¼Œprototype æ²¡æœ‰å¿…è¦ï¼‰ å‡½æ•°ä¸­çš„ this çš„å€¼ä¸èƒ½è¢«ä¿®æ”¹ åŸºæœ¬è¯­æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536373839let reflect = value =&gt; value// equivalent to:let reflect = function(value) &#123; return value&#125;let sum = (num1, num2) =&gt; num1 + num2// equivalent to:let sum = function(num1, num2) &#123; return num1 + num2&#125;let getName = () =&gt; "Nicholas"// equivalent to:let getName = function() &#123; return "Nicholas"&#125;let doNothing = () =&gt; &#123;&#125;// equivalent to:let doNothing = function() &#123;&#125;let getTempItem = id =&gt; (&#123; id: id, name: "Temp" &#125;)// equivalent to:let getTempItem = function(id) &#123; return &#123; id: id, name: "Temp" &#125;&#125; å‚è€ƒèµ„æ–™Understanding ECMAScript 6]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Functional</tag>
        <tag>JavaScript</tag>
        <tag>ECMAScript6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue.js å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰äº‹ä»¶ä¸Žè¡¨å•å…ƒç´ ]]></title>
    <url>%2F2020%2F04%2F03%2Fevents-and-form-elements-in-vue-js%2F</url>
    <content type="text"><![CDATA[æŽ¥ä¸Šæ–‡ Vue.js å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰æ•°æ®ç»‘å®šä¸ŽæŒ‡ç¤ºå™¨ï¼ŒçŽ¯å¢ƒæ­å»ºä¸Žé…ç½®ç­‰åŸºç¡€å†…å®¹å¯å‰å¾€å‚è€ƒ Eventsç”¨æˆ·ä¸Ž HTML å…ƒç´ çš„äº¤äº’è¡Œä¸ºéƒ½ä¼šè§¦å‘ç‰¹å®šçš„äº‹ä»¶ã€‚Vue.js é€šè¿‡ v-on æŒ‡ç¤ºå™¨åˆ›å»ºå¯¹äº‹ä»¶çš„ç»‘å®šã€‚1234567891011121314151617&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3 text-center&quot;&gt; &lt;h3 v-on:click=&quot;name = &apos;Clicked&apos;&quot;&gt;&#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function () &#123; return &#123; name: &quot;Lifejacket&quot; &#125; &#125;,&#125;&lt;/script&gt; Methods &amp; Events12345678910111213141516171819202122232425&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3 text-center&quot;&gt; &lt;h3 v-on:click=&quot;handleEvent(&apos;Soccer Ball&apos;, $event)&quot;&gt;&#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3 text-center&quot;&gt; &lt;h3 v-on:click=&quot;handleEvent(&apos;Stadium&apos;, $event)&quot;&gt;&#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function () &#123; return &#123; name: &quot;Lifejacket&quot; &#125; &#125;, methods: &#123; handleEvent(name, $event) &#123; this.name = `$&#123;name&#125; - $&#123;$event.type&#125;`; &#125; &#125;&#125;&lt;/script&gt; ç»¼åˆç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;h3 class=&quot;bg=primary text-white text-center mt-2 p-2&quot;&gt;&#123;&#123; message &#125;&#125;&lt;/h3&gt; &lt;table class=&quot;table table-sm table-striped table-bordered&quot;&gt; &lt;tr&gt;&lt;th&gt;Index&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Actions&lt;/th&gt;&lt;/tr&gt; &lt;tr v-for=&quot;(name, index) in names&quot; v-bind:key=&quot;name&quot;&gt; &lt;td&gt;&#123;&#123; index &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; name &#125;&#125;&lt;/td&gt; &lt;td&gt; &lt;button class=&quot;btn btn-sm bg-primary text-white&quot; v-on:click=&quot;handleClick(name)&quot;&gt; Select &lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function () &#123; return &#123; message: &quot;Ready&quot;, names: [&quot;Kayak&quot;, &quot;Lifejacket&quot;, &quot;Soccer Ball&quot;, &quot;Stadium&quot;] &#125; &#125;, methods: &#123; handleClick(name) &#123; this.message = `Select: $&#123;name&#125;`; &#125; &#125;&#125;&lt;/script&gt; Keyboard Events123456789101112131415161718192021222324&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-primary p-4 text-white h3&quot;&gt; &#123;&#123; message &#125;&#125; &lt;/div&gt; &lt;input class=&quot;form-control bg-light&quot; placeholder=&quot;Type here...&quot; v-on:keydown.ctrl=&quot;handleKey&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function () &#123; return &#123; message: &quot;Ready&quot;, &#125; &#125;, methods: &#123; handleKey($event) &#123; this.message = $event.key; &#125; &#125;&#125;&lt;/script&gt; Form Elementsv-model æ˜¯ Vue.js ä¸­ç”¨äºŽ HTML è¡¨å•å…ƒç´ ï¼ˆinputã€selectã€textarea ç­‰ï¼‰çš„å†…ç½®æŒ‡ç¤ºå™¨ã€‚å®ƒèƒ½å¤Ÿåœ¨è¡¨å•å…ƒç´ ä¸Žæ•°æ®ä¹‹é—´åˆ›å»ºåŒå‘ç»‘å®šï¼Œä½¿å¾—ä¸ç®¡æ•°æ®æ€Žæ ·å˜æ›´ï¼Œå…ƒç´ çš„è¡Œä¸ºä¸Žæ•°æ®å€¼æ€»å¯ä»¥ä¿æŒä¸€è‡´æ€§ã€‚ Two-Way Binding1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-info m-2 p-2 text-white&quot;&gt; &lt;div&gt;Data Value: &#123;&#123; dataValue &#125;&#125;&lt;/div&gt; &lt;div&gt;Other Value: &#123;&#123; otherValue || &quot;(Empty)&quot; &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary m-2 p-2 text-white&quot;&gt; &lt;div class=&quot;form-check&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt; &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; v-model=&quot;dataValue&quot; /&gt; Data Value &lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary m-2 p-2&quot;&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; v-model=&quot;otherValue&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;text-center m-2&quot;&gt; &lt;button class=&quot;btn btn-secondary&quot; v-on:click=&quot;reset&quot;&gt; Reset &lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; dataValue: false, otherValue: &quot;&quot; &#125; &#125;, methods: &#123; reset() &#123; this.dataValue = false; this.otherValue = &quot;&quot;; &#125; &#125;&#125;&lt;/script&gt; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œé€‰ä¸­æˆ–å–æ¶ˆ checkboxï¼Œåœ¨ input ä¸­è¾“å…¥ä»»æ„æ–‡æœ¬å†…å®¹ï¼Œä¸Žä¹‹å…³è”çš„æ•°æ® dataValue å’Œ otherValue çš„å€¼éƒ½ä¼šåŒæ­¥å‘ç”Ÿæ”¹å˜ã€‚åè¿‡æ¥ï¼Œåœ¨æŽ§åˆ¶å°ä¸­æ‰‹åŠ¨ä¿®æ”¹ dataValue å’Œ otherValue çš„å€¼ï¼Œcheckbox å’Œ input å…ƒç´ ä¹Ÿä¼šç«‹å³äº§ç”Ÿç›¸åº”çš„å˜æ›´ã€‚ Binding Text Fields123456789101112131415161718192021222324252627282930313233343536373839&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-info m-2 p-2 text-white&quot;&gt; &lt;div&gt;Name: &#123;&#123; name &#125;&#125;&lt;/div&gt; &lt;div&gt;Password: &#123;&#123; password &#125;&#125;&lt;/div&gt; &lt;div&gt;Details: &#123;&#123; details &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary m-2 p-2 text-white&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label&gt;Name&lt;/label&gt; &lt;input class=&quot;form-control&quot; v-model=&quot;name&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label&gt;Password&lt;/label&gt; &lt;input type=&quot;password&quot; class=&quot;form-control&quot; v-model=&quot;password&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label&gt;Detials&lt;/label&gt; &lt;textarea class=&quot;form-control&quot; v-model=&quot;details&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Bob&quot;, password: &quot;secret&quot;, details: &quot;Has admin access&quot; &#125; &#125;&#125;&lt;/script&gt; Radio &amp; Checkbox1234567891011121314151617181920212223242526272829303132333435363738394041&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-info m-2 p-2 text-white&quot;&gt; &lt;div&gt;Name: &#123;&#123; name &#125;&#125;&lt;/div&gt; &lt;div&gt;Has Admin Access: &#123;&#123; hasAdminAccess &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary m-2 p-2 text-white&quot;&gt; &lt;div class=&quot;form-check&quot;&gt; &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; v-model=&quot;name&quot; value=&quot;Bob&quot; /&gt; &lt;label class=&quot;form-check-label&quot;&gt;Bob&lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-check&quot;&gt; &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; v-model=&quot;name&quot; value=&quot;Alice&quot; /&gt; &lt;label class=&quot;form-check-label&quot;&gt;Alice&lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-check&quot;&gt; &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; v-model=&quot;hasAdminAccess&quot; /&gt; &lt;label class=&quot;form-check-label&quot;&gt;Has Admin Access?&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Bob&quot;, hasAdminAccess: true &#125; &#125;&#125;&lt;/script&gt; æ³¨æ„æ¯ä¸ª radio å…ƒç´ éƒ½éœ€è¦é…ç½®ä¸€ä¸ª value å±žæ€§ï¼Œå®ƒå†³å®šäº† v-model æŒ‡ç¤ºå™¨æ€Žæ ·ä¿®æ”¹ä¸Žä¹‹ç»‘å®šçš„æ•°æ®ï¼ˆnameï¼‰çš„å€¼ã€‚ Bind Select12345678910111213141516171819202122232425262728293031&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-info m-2 p-2 text-white&quot;&gt; &lt;div&gt;Name: &#123;&#123; name &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;bg-primary m-2 p-2 text-white&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label&gt;Selected Names&lt;/label&gt; &lt;select class=&quot;form-control&quot; v-model=&quot;name&quot;&gt; &lt;option value=&quot;all&quot;&gt;Everyone&lt;/option&gt; &lt;option v-for=&quot;n in allNames&quot; v-bind:key=&quot;n&quot; v-bind:value=&quot;n&quot;&gt;Just &#123;&#123; n &#125;&#125;&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; allNames: [&quot;Bob&quot;, &quot;Alice&quot;, &quot;Joe&quot;], name: &quot;Bob&quot; &#125; &#125;&#125;&lt;/script&gt; æ³¨æ„ä»£ç ä¸­ v-bind æŒ‡ç¤ºå™¨çš„ä½¿ç”¨ã€‚è¿™é‡Œå¿…é¡»ä½¿ç”¨ v-bind è®¾ç½® option çš„ value å±žæ€§ï¼Œå› ä¸ºç­‰å·åŽé¢çš„ n æ˜¯å˜é‡è€Œä¸æ˜¯æŸä¸ªå…·ä½“çš„å€¼ã€‚ Bind Array12345678910111213141516171819202122232425262728293031323334353637&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;bg-info m-2 p-2 text-white&quot;&gt; &lt;div&gt;Selected Cities: &#123;&#123; cities &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-check m-2&quot; v-for=&quot;city in cityNames&quot; v-bind:key=&quot;city&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt; &lt;input type=&quot;checkbox&quot; class=&quot;form-check-input&quot; v-model=&quot;cities&quot; v-bind:value=&quot;city&quot; /&gt; &#123;&#123; city &#125;&#125; &lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;text-center&quot;&gt; &lt;button v-on:click=&quot;reset&quot; class=&quot;btn btn-info&quot;&gt;Reset&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; cityNames: [&quot;London&quot;, &quot;New York&quot;, &quot;Paris&quot;, &quot;Berlin&quot;], cities: [] &#125; &#125;, methods: &#123; reset() &#123; this.cities = []; &#125; &#125;&#125;&lt;/script&gt; Form å…ƒç´ è‡ªå®šä¹‰å€¼123456789101112131415161718192021222324252627282930&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;m-2 p-2 text-white&quot; v-bind:class=&quot;elemClass&quot;&gt; &lt;div&gt;Value: &#123;&#123; elemClass &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-check m-2&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt; &lt;input type=&quot;checkbox&quot; class=&quot;form-check-input&quot; v-model=&quot;dataValue&quot; /&gt; Dark Color &lt;/label&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; dataValue: false, &#125; &#125;, computed: &#123; elemClass() &#123; return this.dataValue ? &quot;bg-primary&quot; : &quot;bg-info&quot;; &#125; &#125;&#125;&lt;/script&gt; é€šè¿‡ computed property å°† checkbox çš„ true å’Œ false å€¼è½¬æ¢ä¸º &lt;div&gt; å…ƒç´ çš„ bg-primary å’Œ bg-info class å±žæ€§ã€‚ ç»¼åˆç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;template&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;m-2 p-2 text-white&quot; v-bind:class=&quot;dataValue&quot;&gt; &lt;div&gt;Value: &#123;&#123; dataValue &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-check m-2&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt; &lt;input type=&quot;checkbox&quot; class=&quot;form-check-input&quot; v-model=&quot;dataValue&quot; v-bind:true-value=&quot;darkColor&quot; v-bind:false-value=&quot;lightColor&quot; /&gt; Dark Color &lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-group m-2 p-2 bg-secondary&quot;&gt; &lt;label&gt;Color&lt;/label&gt; &lt;select v-model=&quot;dataValue&quot; class=&quot;form-control&quot;&gt; &lt;option v-bind:value=&quot;darkColor&quot;&gt;Dark Color&lt;/option&gt; &lt;option v-bind:value=&quot;lightColor&quot;&gt;Light Color&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class=&quot;form-check-inline m-2&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt; &lt;input type=&quot;radio&quot; class=&quot;form-check-input&quot; v-model=&quot;dataValue&quot; v-bind:value=&quot;darkColor&quot; /&gt; Dark Color &lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-check-inline m-2&quot;&gt; &lt;label class=&quot;form-check-lable&quot;&gt; &lt;input type=&quot;radio&quot; class=&quot;form-check-input&quot; v-model=&quot;dataValue&quot; v-bind:value=&quot;lightColor&quot; /&gt; Light Color &lt;/label&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; darkColor: &quot;bg-primary&quot;, lightColor: &quot;bg-info&quot;, dataValue: &quot;bg-info&quot; &#125; &#125;,&#125;&lt;/script&gt; å‚è€ƒèµ„æ–™Pro Vue.js 2]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Vue</tag>
        <tag>Frontend</tag>
        <tag>Javascript</tag>
        <tag>Vue.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ•ˆ Python ä»£ç  â€”â€” å±žæ€§ä¸Ž @property æ–¹æ³•]]></title>
    <url>%2F2020%2F04%2F03%2Feffective-python-using-property%2F</url>
    <content type="text"><![CDATA[ä¸€ã€ç”¨å±žæ€§æ›¿ä»£ getter æˆ– setter æ–¹æ³•ä»¥ä¸‹ä»£ç ä¸­åŒ…å«æ‰‹åŠ¨å®žçŽ°çš„ getterï¼ˆget_ohms) å’Œ setterï¼ˆset_ohmsï¼‰ æ–¹æ³•ï¼š12345678910111213141516171819class OldResistor(object): def __init__(self, ohms): self._ohms = ohms self.voltage = 0 self.current = 0 def get_ohms(self): return self._ohms def set_ohms(self, ohms): self._ohms = ohmsr0 = OldResistor(50e3)print(f'Before: &#123;r0.get_ohms()&#125;')r0.set_ohms(10e3)print(f'After: &#123;r0.get_ohms()&#125;')# =&gt; Before: 50000.0# =&gt; After: 10000.0 è¿™äº›å·¥å…·æ–¹æ³•æœ‰åŠ©äºŽå®šä¹‰ç±»çš„æŽ¥å£ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°å°è£…åŠŸèƒ½ã€éªŒè¯ç”¨æ³•å¹¶é™å®šå–å€¼èŒƒå›´ã€‚ä½†æ˜¯åœ¨ Python è¯­è¨€ä¸­ï¼Œåº”å°½é‡ä»Žç®€å•çš„ public å±žæ€§å†™èµ·ï¼š123456789101112class Resistor(object): def __init__(self, ohms): self.ohms = ohms self.voltage = 0 self.current = 0r1 = Resistor(50e3)print(f'Before: &#123;r1.ohms&#125;')r1.ohms = 10e3print(f'After: &#123;r1.ohms&#125;')# =&gt; Before: 50000.0# =&gt; After: 10000.0 è®¿é—®å®žä¾‹çš„å±žæ€§åˆ™å¯ä»¥ç›´æŽ¥ä½¿ç”¨ instance.property è¿™æ ·çš„æ ¼å¼ã€‚ å¦‚æžœæƒ³åœ¨è®¾ç½®å±žæ€§çš„åŒæ—¶å®žçŽ°å…¶ä»–ç‰¹æ®Šçš„è¡Œä¸ºï¼Œå¦‚åœ¨å¯¹ä¸Šè¿° Resistor ç±»çš„ voltage å±žæ€§èµ‹å€¼æ—¶ï¼Œéœ€è¦åŒæ—¶ä¿®æ”¹å…¶ current å±žæ€§ã€‚å¯ä»¥å€ŸåŠ© @property è£…é¥°å™¨å’Œ setter æ–¹æ³•å®žçŽ°æ­¤ç±»éœ€æ±‚ï¼š1234567891011121314151617181920212223from resistor import Resistorclass VoltageResistor(Resistor): def __init__(self, ohms): super().__init__(ohms) self._voltage = 0 @property def voltage(self): return self._voltage @voltage.setter def voltage(self, voltage): self._voltage = voltage self.current = self._voltage / self.ohmsr2 = VoltageResistor(1e3)print(f'Before: &#123;r2.current&#125; amps')r2.voltage = 10print(f'After: &#123;r2.current&#125; amps')Before: 0 ampsAfter: 0.01 amps æ­¤æ—¶è®¾ç½® voltage å±žæ€§ä¼šæ‰§è¡Œåä¸º voltage çš„ setter æ–¹æ³•ï¼Œæ›´æ–°å½“å‰å¯¹è±¡çš„ current å±žæ€§ï¼Œä½¿å¾—æœ€ç»ˆçš„ç”µæµå€¼ä¸Žç”µåŽ‹å’Œç”µé˜»ç›¸åŒ¹é…ã€‚ @property çš„å…¶ä»–ä½¿ç”¨åœºæ™¯å±žæ€§çš„ setter æ–¹æ³•é‡Œå¯ä»¥åŒ…å«ç±»åž‹éªŒè¯å’Œæ•°å€¼éªŒè¯çš„ä»£ç ï¼š1234567891011121314151617181920from resistor import Resistorclass BoundedResistor(Resistor): def __init__(self, ohms): super().__init__(ohms) @property def ohms(self): return self._ohms @ohms.setter def ohms(self, ohms): if ohms &lt;= 0: raise ValueError('ohms must be &gt; 0') self._ohms = ohmsr3 = BoundedResistor(1e3)r3.ohms = -5# =&gt; ValueError: ohms must be &gt; 0 ç”šè‡³å¯ä»¥é€šè¿‡ @property é˜²æ­¢ç»§æ‰¿è‡ªçˆ¶ç±»çš„å±žæ€§è¢«ä¿®æ”¹ï¼š1234567891011121314151617181920from resistor import Resistorclass FixedResistance(Resistor): def __init__(self, ohms): super().__init__(ohms) @property def ohms(self): return self._ohms @ohms.setter def ohms(self, ohms): if hasattr(self, '_ohms'): raise AttributeError("Can't set attribute") self._ohms = ohmsr4 = FixedResistance(1e3)r4.ohms = 2e3# =&gt; AttributeError: Can't set attribute è¦ç‚¹ ä¼˜å…ˆä½¿ç”¨ public å±žæ€§å®šä¹‰ç±»çš„æŽ¥å£ï¼Œä¸æ‰‹åŠ¨å®žçŽ° getter æˆ– setter æ–¹æ³• åœ¨è®¿é—®å±žæ€§çš„åŒæ—¶éœ€è¦è¡¨çŽ°æŸäº›ç‰¹æ®Šçš„è¡Œä¸ºï¼ˆå¦‚ç±»åž‹æ£€æŸ¥ã€é™å®šå–å€¼ï¼‰ç­‰ï¼Œä½¿ç”¨ @property @property çš„ä½¿ç”¨éœ€éµå¾ª rule of least surprise åŽŸåˆ™ï¼Œé¿å…ä¸å¿…è¦çš„å‰¯ä½œç”¨ ç¼“æ…¢æˆ–å¤æ‚çš„å·¥ä½œï¼Œåº”æ”¾åœ¨æ™®é€šæ–¹æ³•ä¸­ äºŒã€éœ€è¦å¤ç”¨çš„ @property æ–¹æ³•å¯¹äºŽå¦‚ä¸‹éœ€æ±‚ï¼šç¼–å†™ä¸€ä¸ª Homework ç±»ï¼Œå…¶æˆç»©å±žæ€§åœ¨è¢«èµ‹å€¼æ—¶éœ€è¦ç¡®ä¿è¯¥å€¼å¤§äºŽ 0 ä¸”å°äºŽ 100ã€‚å€ŸåŠ© @property æ–¹æ³•å®žçŽ°èµ·æ¥éžå¸¸ç®€å•ï¼š12345678910111213141516171819class Homework(object): def __init__(self): self._grade = 0 @property def grade(self): return self._grade @grade.setter def grade(self, value): if not (0 &lt;= value &lt;= 100): raise ValueError('Grade must be between 0 and 100') self._grade = valuegalileo = Homework()galileo.grade = 95print(galileo.grade)# =&gt; 95 å‡è®¾ä¸Šè¿°éªŒè¯é€»è¾‘éœ€è¦ç”¨åœ¨åŒ…å«å¤šä¸ªç§‘ç›®çš„è€ƒè¯•æˆç»©ä¸Šï¼Œæ¯ä¸ªç§‘ç›®éƒ½éœ€è¦å•ç‹¬è®¡åˆ†ã€‚åˆ™ @property æ–¹æ³•åŠéªŒè¯ä»£ç å°±è¦é‡å¤ç¼–å†™å¤šæ¬¡ï¼ŒåŒæ—¶è¿™ç§å†™æ³•ä¹Ÿä¸å¤Ÿé€šç”¨ã€‚ é‡‡ç”¨ Python çš„æè¿°ç¬¦å¯ä»¥æ›´å¥½åœ°å®žçŽ°ä¸Šè¿°åŠŸèƒ½ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼ŒExam ç±»å°†å‡ ä¸ª Grade å®žä¾‹ä½œä¸ºè‡ªå·±çš„ç±»å±žæ€§ï¼ŒGrade ç±»åˆ™é€šè¿‡ __get__ å’Œ __set__ æ–¹æ³•å®žçŽ°äº†æè¿°ç¬¦åè®®ã€‚1234567891011121314151617181920212223242526272829303132class Grade(object): def __init__(self): self._value = 0 def __get__(self, instance, instance_type): return self._value def __set__(self, instance, value): if not (0 &lt;= value &lt;= 100): raise ValueError('Grade must be between 0 and 100') self._value = valueclass Exam(object): math_grade = Grade() science_grade = Grade()first_exam = Exam()first_exam.math_grade = 82first_exam.science_grade = 99print('Math', first_exam.math_grade)print('Science', first_exam.science_grade)second_exam = Exam()second_exam.science_grade = 75print('Second exam science grade', second_exam.science_grade, ', right')print('First exam science grade', first_exam.science_grade, ', wrong')# =&gt; Math 82# =&gt; Science 99# =&gt; Second exam science grade 75 , right# =&gt; First exam science grade 75 , wrong åœ¨å¯¹ exam å®žä¾‹çš„å±žæ€§è¿›è¡Œèµ‹å€¼æ“ä½œæ—¶ï¼š12exam = Exam()exam.math_grade = 40 Python ä¼šå°†å…¶è½¬è¯‘ä¸ºå¦‚ä¸‹ä»£ç ï¼š1Exam.__dict__['math_grade'].__set__(exam, 40) è€ŒèŽ·å–å±žæ€§å€¼çš„ä»£ç ï¼š1print(exam.math_grade) ä¹Ÿä¼šåšå¦‚ä¸‹è½¬è¯‘ï¼š1print(Exam.__dict__['math_grade'].__get__(exam, Exam)) ä½†ä¸Šè¿°å®žçŽ°æ–¹æ³•ä¼šå¯¼è‡´ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚ç”±äºŽæ‰€æœ‰çš„ Exam å®žä¾‹éƒ½ä¼šå…±äº«åŒä¸€ä»½ Grade å®žä¾‹ï¼Œåœ¨å¤šä¸ª Exam å®žä¾‹ä¸Šåˆ†åˆ«æ“ä½œæŸä¸€ä¸ªå±žæ€§å°±ä¼šå‡ºçŽ°é”™è¯¯ç»“æžœã€‚123456second_exam = Exam()second_exam.science_grade = 75print(&apos;Second exam science grade&apos;, second_exam.science_grade, &apos;, right&apos;)print(&apos;First exam science grade&apos;, first_exam.science_grade, &apos;, wrong&apos;)# =&gt; Second exam science grade 75 , right# =&gt; First exam science grade 75 , wrong å¯ä»¥åšå‡ºå¦‚ä¸‹æ”¹åŠ¨ï¼Œå°†æ¯ä¸ª Exam å®žä¾‹æ‰€å¯¹åº”çš„å€¼ä¾æ¬¡è®°å½•åˆ° Grade ä¸­ï¼Œç”¨å­—å…¸ç»“æž„ä¿å­˜æ¯ä¸ªå®žä¾‹çš„çŠ¶æ€ï¼š1234567891011121314151617181920212223242526272829class Grade(object): def __init__(self): self._values = &#123;&#125; def __get__(self, instance, instance_type): if instance is None: return self return self._values.get(instance, 0) def __set__(self, instance, value): if not (0 &lt;= value &lt;= 100): raise ValueError('Grade must be between 0 and 100') self._values[instance] = valueclass Exam(object): math_grade = Grade() writing_grade = Grade() science_grade = Grade()first_exam = Exam()first_exam.math_grade = 82second_exam = Exam()second_exam.math_grade = 75print('First exam math grade', first_exam.math_grade, ', right')print('Second exam math grade', second_exam.math_grade, ', right')# =&gt; First exam math grade 82 , right# =&gt; Second exam math grade 75 , right è¿˜æœ‰å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå¯¹äºŽä¼ ç»™ __set__ çš„æ¯ä¸ª Exam å®žä¾‹æ¥è¯´ï¼Œ_values å­—å…¸éƒ½ä¼šä¿å­˜æŒ‡å‘è¯¥å®žä¾‹çš„ä¸€ä»½å¼•ç”¨ï¼Œå¯¼è‡´è¯¥å®žä¾‹çš„å¼•ç”¨è®¡æ•°æ— æ³•é™ä¸º 0 ä»Žè€Œæ— æ³•è¢« GC å›žæ”¶ã€‚è§£å†³æ–¹æ³•æ˜¯å°†æ™®é€šå­—å…¸æ›¿æ¢ä¸º WeakKeyDictionaryï¼š12from weakref import WeakKeyDictionaryself._values = WeakKeyDictionary() å‚è€ƒèµ„æ–™Effective Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows 10 ç³»ç»Ÿæ·»åŠ â€œä»Žæ­¤å¤„æ‰“å¼€å‘½ä»¤æç¤ºç¬¦â€å³é”®èœå•]]></title>
    <url>%2F2020%2F01%2F23%2Fadd-open-cmd-in-right-click-menu%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰ç‰ˆæœ¬çš„ Windows ç³»ç»Ÿä¸­ï¼ŒæŒ‰ä½ shift é”®çš„åŒæ—¶åœ¨ç©ºç™½å¤„ç‚¹å‡»å³é”®ï¼Œå¯ä»¥æ‰¾åˆ°ä»Žæ­¤å¤„æ‰“å¼€å‘½ä»¤æç¤ºç¬¦çš„èœå•é¡¹ã€‚å¯æƒœåŽé¢ç‰ˆæœ¬çš„ Win10 ç³»ç»Ÿç§»é™¤äº†è¯¥èœå•é¡¹ï¼Œæ›¿æ¢æˆä»Žæ­¤å¤„æ‰“å¼€ Powershell çª—å£ã€‚å¯èƒ½ä¹ æƒ¯æ‰€è‡´ï¼Œå¯¹ Poweshell ä¸å¤ªæ„Ÿå†’ï¼ˆå¯åŠ¨å¾ˆæ…¢çš„æ„Ÿè§‰[ç‹—å¤´]ï¼‰ã€‚åœ¨ cmd ä¸­æ‰‹åŠ¨åˆ‡æ¢ç›®å½•åˆè¿‡äºŽéº»çƒ¦ï¼Œå°¤å…¶æ˜¯åœ¨è·¨é©±åŠ¨å™¨çš„æƒ…å†µä¸‹ã€‚æ•…å°è¯•åœ¨å³é”®èœå•ä¸­æ·»åŠ â€œæ‰“å¼€å‘½ä»¤æç¤ºç¬¦â€é€‰é¡¹ã€‚ ä¸€ã€æ·»åŠ â€œä»Žæ­¤å¤„æ‰“å¼€å‘½ä»¤æç¤ºç¬¦â€å³é”®èœå• æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼ˆCTRL+R -&gt; regeditï¼‰ åˆ‡æ¢åˆ° HKEY_CLASSES_ROOT\Directory\Background\shell\ æ–°å»ºé¡¹ cmd_shellï¼Œå…¶ä¸­å­—ç¬¦ä¸²å€¼(é»˜è®¤) çš„æ•°æ®æ”¹ä¸ºâ€œæ‰“å¼€å‘½ä»¤æç¤ºç¬¦â€ï¼ˆèœå•é¡¹çš„åç§°ï¼‰ åœ¨ cmd_shell ä¸­æ–°å»ºå­—ç¬¦ä¸²å€¼ï¼Œåç§°ä¸º Iconï¼Œæ•°æ®ä¸º C:\Windows\System32\cmd.exeï¼ˆå›¾æ ‡è·¯å¾„ï¼‰ åœ¨ cmd_shell ä¸‹æ–°å»ºé¡¹ commandï¼Œä¿®æ”¹å­—ç¬¦ä¸²å€¼(é»˜è®¤) çš„æ•°æ®ä¸º cmd.exe /s /k pushd &quot;%V&quot;ï¼ˆå…·ä½“æ‰§è¡Œçš„å‘½ä»¤ï¼‰ å¦‚ä¸æƒ³æ‰‹åŠ¨æ·»åŠ æ³¨å†Œè¡¨ï¼Œä»¥ä¸‹ä¸ºå¯ç›´æŽ¥åŒå‡»å¯¼å…¥çš„ open_cmd.reg æ–‡ä»¶ï¼š12345678Windows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\Directory\Background\shell\cmd_shell]@=&quot;æ‰“å¼€å‘½ä»¤æç¤ºç¬¦&quot;&quot;Icon&quot;=&quot;C:\\Windows\\System32\\cmd.exe&quot;[HKEY_CLASSES_ROOT\Directory\Background\shell\cmd_shell\command]@=&quot;cmd.exe /s /k pushd \&quot;%V\&quot;&quot; äºŒã€å³é”®èœå•æ·»åŠ â€œä½¿ç”¨ VSCode ç¼–è¾‘æ–‡ä»¶â€ ä¸ªäººä¹ æƒ¯é—®é¢˜ï¼Œæ„Ÿè§‰å³é”®ç‚¹å‡»ä»£ç æºæ–‡ä»¶ï¼Œå¼¹å‡ºçš„èœå•é‡ŒåŒ…å«â€œä½¿ç”¨ VSCode ç¼–è¾‘â€ä¼šæ¯”è¾ƒæ–¹ä¾¿ä¸€ç‚¹ã€‚æ–¹æ³•åŒæ ·æ˜¯ä¿®æ”¹æ³¨å†Œè¡¨ã€‚ æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼ˆCTRL+R -&gt; regeditï¼‰ åˆ‡æ¢åˆ° HKEY_CLASSES_ROOT\*\shell æ–°å»ºé¡¹ vscodeï¼Œå…¶ä¸­å­—ç¬¦ä¸²å€¼(é»˜è®¤) çš„æ•°æ®æ”¹ä¸ºâ€œOpen with VSCodeâ€ï¼ˆèœå•é¡¹çš„åç§°ï¼‰ åœ¨ vscode ä¸­æ–°å»ºå­—ç¬¦ä¸²å€¼ï¼Œåç§°ä¸º Iconï¼Œæ•°æ®ç±»ä¼¼ &quot;F:\Software\VSCode-win32-x64-1.36.1\Code.exe&quot;ï¼ˆå›¾æ ‡è·¯å¾„ï¼‰ åœ¨ vscode ä¸‹æ–°å»ºé¡¹ commandï¼Œä¿®æ”¹å­—ç¬¦ä¸²å€¼(é»˜è®¤) çš„æ•°æ®ä¸º &quot;F:\Software\VSCode-win32-x64-1.36.1\Code.exe&quot; &quot;%1&quot;ï¼ˆå…·ä½“æ‰§è¡Œçš„å‘½ä»¤ï¼‰ å¦‚ä¸æƒ³æ‰‹åŠ¨æ·»åŠ æ³¨å†Œè¡¨ï¼Œä»¥ä¸‹ä¸ºå¯ç›´æŽ¥åŒå‡»å¯¼å…¥çš„ open_with_code.reg æ–‡ä»¶ï¼š12345678Windows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\*\shell\VSCode]@=&quot;Open with Code&quot;&quot;Icon&quot;=&quot;F:\\Software\\VSCode-win32-x64-1.36.1\\Code.exe&quot;[HKEY_CLASSES_ROOT\*\shell\VSCode\command]@=&quot;\&quot;F:\\Software\\VSCode-win32-x64-1.36.1\\Code.exe\&quot; \&quot;%1\&quot;&quot;]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Windows</tag>
        <tag>Cmd</tag>
        <tag>VSCode</tag>
        <tag>Tricks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºæœ¬æ•°æ®ç»“æž„çš„ Python å®žçŽ°åŠåº”ç”¨]]></title>
    <url>%2F2020%2F01%2F23%2Fbasic-data-structure-and-algorithm-with-python%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å†…ç½®æ•°æ®ç»“æž„çš„æ€§èƒ½ListPython å†…ç½®çš„ List ç±»åž‹é’ˆå¯¹ä¸åŒæ“ä½œçš„æ€§èƒ½å¦‚ä¸‹ï¼š Operation Big-O index O(1) index èµ‹å€¼ O(1) append O(1) pop() O(1) pop(i) O(n) insert(i, item) O(n) del O(n) iteration O(n) contains (in) O(n) slice [x:y] O(k) del slice O(n) set slice O(n+k) reverse O(n) concatenate O(k) sort O(n log n) multiply O(nk) å‡ ç§åˆ—è¡¨åˆå§‹åŒ–æ–¹å¼çš„è¿è¡Œæ—¶é—´å¯¹æ¯”ï¼ˆ concatenate &gt; append &gt; comprehension &gt; list rangeï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839from timeit import Timer# concatenatedef test1(): l = [] for i in range(1000): l = l + [i]# appenddef test2(): l = [] for i in range(1000): l.append(i)# comprehensiondef test3(): l = [ i for i in range(1000)]# list rangedef test4(): l = list(range(1000))t1 = Timer("test1()", "from __main__ import test1")print(f"concat &#123;t1.timeit(number=1000)&#125; milliseconds")t2 = Timer("test2()", "from __main__ import test2")print(f"append &#123;t2.timeit(number=1000)&#125; milliseconds")t3 = Timer("test3()", "from __main__ import test3")print(f"comprehension &#123;t3.timeit(number=1000)&#125; milliseconds")t4 = Timer("test4()", "from __main__ import test4")print(f"list range &#123;t4.timeit(number=1000)&#125; milliseconds")# concat 1.3573799000000002 milliseconds# append 0.0650925 milliseconds# comprehension 0.03262469999999995 milliseconds# list range 0.01332690000000003 milliseconds åˆ—è¡¨çš„ pop(0) æ–¹æ³•å’Œ pop() æ–¹æ³•çš„è¿è¡Œæ—¶é—´å¯¹æ¯”ï¼ˆpop(0) ä¸º O(n)ï¼Œpop() ä¸º O(1)ï¼‰ï¼š123456789101112131415161718192021from timeit import Timerfrom matplotlib import pyplot as pltpop_zero = Timer("x.pop(0)", "from __main__ import x")pop_end = Timer("x.pop()", "from __main__ import x")X, Ypt, Ypz = [], [], []for i in range(10000, 500001, 10000): x = list(range(i)) pt = pop_end.timeit(number=1000) pz = pop_zero.timeit(number=1000) X.append(i) Ypt.append(pt) Ypz.append(pz)plt.scatter(X, Ypt, c='m', marker='^', label='pop_end')plt.scatter(X, Ypz, c='y', label='pop_zero')plt.legend()plt.show() Dictionary Operation Big-O copy O(n) get item O(1) set item O(1) delete item O(1) contains (in) O(1) iteration O(n) åˆ—è¡¨ä¸Žå­—å…¸ contains æ“ä½œçš„è¿è¡Œæ—¶é—´å¯¹æ¯”ï¼ˆåˆ—è¡¨ä¸º O(n)ï¼Œå­—å…¸ä¸º O(1)ï¼‰ï¼š123456789101112131415161718192021222324import timeitimport randomfrom matplotlib import pyplot as pltX, Ylist, Ydict = [], [], []for i in range(10000, 1000001, 20000): t = timeit.Timer(f"random.randrange(&#123;i&#125;) in x", "from __main__ import random, x") x = list(range(i)) list_time = t.timeit(number=1000) x = &#123;j: None for j in range(i)&#125; dict_time = t.timeit(number=1000) X.append(i) Ylist.append(list_time) Ydict.append(dict_time)plt.scatter(X, Ylist, c='m', marker='^', label='list')plt.scatter(X, Ydict, c='y', label='dict')plt.legend()plt.show() äºŒã€StackLIFOï¼ˆlast-in first-outï¼‰ï¼Œä»Žé¡¶éƒ¨æ·»åŠ æ–°é¡¹ç›®ï¼Œç§»é™¤é¡¹ç›®ä¹Ÿä»Žé¡¶éƒ¨å¼€å§‹ã€‚å³è¶Šæ˜¯æœ€æ–°æ·»åŠ åˆ°æ ˆä¸­çš„é¡¹ç›®è¶Šæ˜¯æŽ¥è¿‘æ ˆçš„é¡¶éƒ¨ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿæœ€å…ˆå‡ºæ ˆã€‚ç±»ä¼¼äºŽåœ¨åŽ¨æˆ¿é‡Œåˆ·ç›˜å­ï¼Œæ´—å¥½çš„ç›˜å­æ‘žåœ¨é¡¶éƒ¨ï¼Œä½¿ç”¨æ—¶ä¹Ÿæœ€å…ˆæ‹¿é¡¶éƒ¨ï¼ˆæœ€è¿‘æ´—å¥½ï¼‰çš„å¹²å‡€ç›˜å­ã€‚12345678910111213141516171819202122232425262728293031323334# stack.pyclass Stack: def __init__(self): self.items = [] def is_empty(self): return self.items == [] def push(self, item): self.items.append(item) def pop(self): return self.items.pop() def peek(self): return self.items[len(self.items) - 1] def size(self): return len(self.items)if __name__ == '__main__': s = Stack() print(s.is_empty()) # True s.push(4) s.push('dog') print(s.peek()) # dog s.push(True) print(s.size()) # 3 s.push(8.4) print(s.pop()) # 8.4 print(s.pop()) # True print(s.size()) # 2 è¿›åˆ¶è½¬æ¢é€šè¿‡çŸ­é™¤æ³•å°†åè¿›åˆ¶æ•°è½¬æ¢ä¸ºå…¶ä»–è¿›åˆ¶ï¼š1234567891011121314151617181920from stack import Stackdef base_converter(dec_number, base): digits = "0123456789ABCDEF" rem_stack = Stack() while dec_number &gt; 0: rem = dec_number % base rem_stack.push(rem) dec_number = dec_number // base new_string = "" while not rem_stack.is_empty(): new_string = new_string + digits[rem_stack.pop()] return new_stringprint(base_converter(28, 2)) # 11100print(base_converter(28, 16)) # 1C çŸ­é™¤æ³•æ¯æ¬¡å¾ªçŽ¯ç”Ÿæˆçš„ä½™æ•°ä»ŽåŽå¾€å‰æ‹¼æŽ¥å¾—åˆ°æœ€ç»ˆçš„ç›®æ ‡è¿›åˆ¶æ•°å­—ã€‚å³æœ€å…ˆç”Ÿæˆçš„ä½™æ•°ä¸ºç›®æ ‡è¿›åˆ¶æ•°å­—çš„æœ€åŽä¸€ä½ï¼Œæœ€åŽç”Ÿæˆçš„ä½™æ•°ä¸ºç›®æ ‡è¿›åˆ¶æ•°å­—çš„ç¬¬ä¸€ä½ï¼ŒåŽè¿›å…ˆå‡ºã€‚ æ‹¬å·åŒ¹é…12345678910111213141516171819202122232425262728293031from stack import Stackdef par_checker(symbol_string): s = Stack() balanced = True index = 0 while index &lt; len(symbol_string) and balanced: symbol = symbol_string[index] if symbol in "([&#123;": s.push(symbol) else: if s.is_empty(): balanced = False else: top = s.pop() if not matches(top, symbol): balanced = False index += 1 if balanced and s.is_empty(): return True else: return Falsedef matches(open, close): opens = "([&#123;" closes = ")]&#125;" return opens.index(open) == closes.index(close)print(par_checker('&#123;&#123;([][])&#125;()&#125;')) # Trueprint(par_checker('[&#123;()]')) # False é‡åˆ°å·¦åŠè¾¹æ‹¬å·ï¼ˆ([{ï¼‰å°± push åˆ° Stack ä¸­ï¼Œé‡åˆ°å³åŠè¾¹æ‹¬å·ï¼ˆ)]}ï¼‰å°±ä»Ž Stack ä¸­ pop å‡ºä¸€ä¸ªå·¦åŠè¾¹æ‹¬å·è¿›è¡Œé…å¯¹ã€‚æœ€å…ˆé‡åˆ°çš„å³åŠè¾¹æ‹¬å·è‚¯å®šéœ€è¦ä¸Žæœ€åŽæ”¾å…¥ Stack ä¸­çš„å·¦åŠè¾¹æ‹¬å·åŒ¹é…ï¼ˆå› æ­¤ä½¿ç”¨ Stack çš„ pop å–æ•°æ®ï¼‰ã€‚æœ€ç»ˆ Stack ä¸ºç©ºï¼Œåˆ™æ‹¬å·å…¨éƒ¨åŒ¹é…ã€‚ ä¸‰ã€Queues &amp; DequesFIFOï¼ˆfirst-in first-outï¼‰ï¼Œä»Žé˜Ÿåˆ—ä¸€ç«¯ï¼ˆrearï¼‰æ·»åŠ æ–°é¡¹ç›®ï¼Œä»Žå¦ä¸€ç«¯ï¼ˆfrontï¼‰å¼¹å‡ºé¡¹ç›®ã€‚ç±»ä¼¼äºŽç”Ÿæ´»ä¸­çš„æŽ’é˜Ÿç‚¹é¤ï¼Œæ–°æ¥çš„é¡¾å®¢æŽ’åˆ°é˜Ÿä¼æœ€åŽé¢ï¼Œé˜Ÿä¼æœ€å‰é¢çš„äººä¼˜å…ˆç‚¹é¤å’Œä»˜æ¬¾ç„¶åŽç¦»å¼€é˜Ÿä¼ã€‚deque ä¸ºåŒå‘é˜Ÿåˆ—ã€‚123456789101112131415161718192021222324252627282930313233343536373839# queues.pyclass Queue: def __init__(self): self.items = [] def is_empty(self): return self.items == [] def enqueue(self, item): self.items.insert(0, item) def dequeue(self): return self.items.pop() def size(self): return len(self.items)class Deque: def __init__(self): self.items = [] def is_empty(self): return self.items == [] def add_front(self, item): self.items.append(item) def add_rear(self, item): self.items.insert(0, item) def remove_front(self): return self.items.pop() def remove_rear(self): return self.items.pop(0) def size(self): return len(self.items) Palindrome CheckerPalindrome æ˜¯æŒ‡å·¦å³å¯¹ç§°çš„å•è¯ï¼Œå¦‚ radarã€tootã€madam ç­‰ã€‚åŒå‘é˜Ÿåˆ— Deque ä»Žé˜Ÿåˆ—ä¸¤ç«¯å¼¹å‡ºæ•°æ®ï¼Œå¯ç”¨äºŽæ£€æµ‹ç›®æ ‡å•è¯é¦–å°¾ä¸¤ç«¯çš„å­—ç¬¦æ˜¯å¦ä¸€ä¸€å¯¹åº”ï¼Œå³æ˜¯å¦å¯¹ç§°ã€‚123456789101112131415161718192021from queues import Dequedef pal_checker(a_string): char_deque = Deque() for ch in a_string: char_deque.add_rear(ch) still_equal = True while char_deque.size() &gt; 1 and still_equal: first = char_deque.remove_front() last = char_deque.remove_rear() if first != last: still_equal = False return still_equalprint(pal_checker("lsdkjfskf")) #Falseprint(pal_checker("radar")) # True å››ã€SortBubble Sort12345678910def bubble_sort(a_list): for pass_num in range(len(a_list) - 1, 0, -1): for i in range(pass_num): if a_list[i] &gt; a_list[i + 1]: a_list[i], a_list[i + 1] = a_list[i + 1], a_list[i]a_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]bubble_sort(a_list)print(a_list)# =&gt; [17, 20, 26, 31, 44, 54, 55, 77, 93] Bubble Sort ä¼šä¾æ¬¡æ¯”è¾ƒåºåˆ—ä¸­ç›¸é‚»ä¸¤ä¸ªæ•°å­—çš„å¤§å°å…³ç³»ï¼Œå¿…è¦æ—¶äº¤æ¢ä½ç½®ï¼Œä¿è¯è¾ƒå¤§çš„æ•°å­—æŽ’åœ¨å¦ä¸€ä¸ªæ•°å­—å³ä¾§ã€‚æ•´ä¸ªåºåˆ—æ‰§è¡Œå®Œä¸€è½®å®Œæ•´çš„ä¸¤ä¸¤å¯¹æ¯”ä¹‹åŽï¼Œå¯ä»¥ä¿è¯æœ€å¤§çš„æ•°å­—ä½äºŽåºåˆ—çš„æœ€å³ä¾§ã€‚ä¸‹ä¸€è½®åˆ™å¯ä»¥å°†ç¬¬äºŒå¤§çš„æ•°å­—äº¤æ¢åˆ°åºåˆ—ä¸­å€’æ•°ç¬¬äºŒçš„ä½ç½®ï¼Œä¾æ¬¡ç±»æŽ¨ã€‚ Bubble Sort é€šå¸¸è®¤ä¸ºæ˜¯æœ€ä½Žæ•ˆçš„æŽ’åºç®—æ³•ã€‚å¤æ‚åº¦ä¸º O(n^2)ã€‚ Selection Sort123456789101112def selection_sort(a_list): for fill_slot in range(len(a_list) - 1, 0, -1): pos_of_max = 0 for location in range(1, fill_slot + 1): if a_list[location] &gt; a_list[pos_of_max]: pos_of_max = location a_list[pos_of_max], a_list[location] = a_list[location], a_list[pos_of_max]a_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]selection_sort(a_list)print(a_list)# =&gt; [17, 20, 26, 31, 44, 54, 55, 77, 93] Selection Sort ä¼šåœ¨ç¬¬ä¸€è½®å¯¹æ‰€æœ‰æ•°å­—çš„æ¯”è¾ƒä¸­ï¼Œè®°å½•æœ€å¤§æ•°å­—çš„ä½ç½®ï¼Œä»¤å…¶ä¸Žåºåˆ—ä¸­æœ€åŽä½ç½®çš„æ•°å­—äº’æ¢ã€‚ç„¶åŽåœ¨ç¬¬äºŒè½®æ¯”è¾ƒä¸­æ‰¾å‡ºç¬¬äºŒå¤§çš„æ•°å­—ï¼Œä¸Žåºåˆ—ä¸­å€’æ•°ç¬¬äºŒä½ç½®ä¸Šçš„æ•°å­—äº’æ¢ï¼Œä¾æ¬¡ç±»æŽ¨ã€‚å¤æ‚åº¦ä¸º O(n^2)ã€‚ç›¸å¯¹äºŽ Bubble Sortï¼ŒSelection Sort å‡å°‘äº†æ•°å­—ä½ç½®çš„äº¤æ¢æ¬¡æ•°ï¼Œä¸€è½®åªéœ€è¦ä¸€æ¬¡äº¤æ¢ã€‚ Insertion Sort123456789101112131415def insertion_sort(a_list): for index in range(1, len(a_list)): current_value = a_list[index] position = index while position &gt; 0 and a_list[position - 1] &gt; current_value: a_list[position] = a_list[position - 1] position = position - 1 a_list[position] = current_valuea_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]insertion_sort(a_list)print(a_list)# =&gt; [17, 20, 26, 31, 44, 54, 55, 77, 93] Insertion Sort å¯ä»¥ç†è§£ä¸ºåœ¨å½“å‰åºåˆ—å¤´éƒ¨ç»´æŠ¤ç€ä¸€ä¸ªé•¿åº¦ä¸æ–­å¢žé•¿çš„æŽ’åºå¥½çš„å­åºåˆ—ï¼Œæ¯ä»Žåºåˆ—åŽåŠæ®µå–å‡ºä¸€ä¸ªæ•°å­—ï¼Œå°±æ ¹æ®å…¶ä¸Žå¤´éƒ¨åºåˆ—ä¸­æ•°å­—çš„å¤§å°å…³ç³»ï¼Œæ’å…¥åˆ°å¤´éƒ¨åºåˆ—çš„é€‚å½“ä½ç½®ã€‚å¤æ‚åº¦ä¾æ—§ä¸º O(n^2)ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œshift æ“ä½œçš„æ€§èƒ½ä¸€èˆ¬è¦ä¼˜äºŽ exchange æ“ä½œã€‚ Shell SortShell Sort ä¼šä»ŽåŽŸæ¥çš„å¾…æŽ’åºåˆ—è¡¨ä¸­ä»¥ä¸€å®šçš„é—´éš”é€‰å–æ•°å­—ç»„æˆä¸€ç³»åˆ—å°çš„å­åˆ—è¡¨ï¼Œå†ä¾æ¬¡é€šè¿‡ Insertion Sort æ–¹æ³•è¿›è¡ŒæŽ’åºã€‚å¤æ‚åº¦å¤§æ¦‚ä»‹äºŽ O(n) å’Œ O(n^2) ä¹‹é—´ã€‚1234567891011121314151617181920212223242526def shell_sort(a_list): sublist_count = len(a_list) // 2 while sublist_count &gt; 0: for start_position in range(sublist_count): gap_insertion_sort(a_list, start_position, sublist_count) print("After increments of size", sublist_count, "The list is", a_list) sublist_count = sublist_count // 2def gap_insertion_sort(a_list, start, gap): for i in range(start + gap, len(a_list), gap): current_value = a_list[i] position = i while position &gt;= gap and a_list[position - gap] &gt; current_value: a_list[position] = a_list[position - gap] position = position - gap a_list[position] = current_valuea_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]shell_sort(a_list)print(a_list)# =&gt; After increments of size 4 The list is [20, 26, 44, 17, 54, 31, 93, 55, 77]# =&gt; After increments of size 2 The list is [20, 17, 44, 26, 54, 31, 77, 55, 93]# =&gt; After increments of size 1 The list is [17, 20, 26, 31, 44, 54, 55, 77, 93]# =&gt; [17, 20, 26, 31, 44, 54, 55, 77, 93] Merge SortMerge Sort æ˜¯å°†åŽŸå¾…æŽ’åºåˆ—è¡¨é€’å½’åœ°ä¸€åˆ†ä¸ºäºŒç›´åˆ°æˆä¸ºæœ€å°å•ä½ï¼Œç„¶åŽåœ¨ä¸¤ä¸¤åˆå¹¶çš„è¿‡ç¨‹ä¸­è¿›è¡Œå¤§å°æŽ’åºã€‚åˆå¹¶æ“ä½œå®ŒæˆåŽå¾—åˆ°å®Œæ•´çš„æŽ’åºå¥½çš„åˆ—è¡¨ã€‚ Merge Sort å’ŒåŽé¢çš„ Quick Sort å¤æ‚åº¦éƒ½ä¸º O(n log n)ã€‚Merge Sort åœ¨èžåˆè¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œè€Œ Quick Sort çš„å¤æ‚åº¦æœ‰å¯èƒ½æé«˜åˆ° O(n^2) ï¼ˆå½“åˆ†å‰²ç‚¹ä¸æ˜¯æŽ¥è¿‘åˆ—è¡¨çš„ä¸­é—´ä½ç½®ï¼‰ã€‚12345678910111213141516171819202122232425262728293031323334353637def merge_sort(a_list): print("Splitting ", a_list) if len(a_list) &gt; 1: mid = len(a_list) // 2 left_half = a_list[:mid] right_half = a_list[mid:] merge_sort(left_half) merge_sort(right_half) i = 0 j = 0 k = 0 while i &lt; len(left_half) and j &lt; len(right_half): if left_half[i] &lt; right_half[j]: a_list[k] = left_half[i] i = i + 1 else: a_list[k] = right_half[j] j = j + 1 k = k + 1 while i &lt; len(left_half): a_list[k] = left_half[i] i = i + 1 k = k + 1 while j &lt; len(right_half): a_list[k] = right_half[j] j = j + 1 k = k + 1 print("Merging ", a_list)a_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]merge_sort(a_list)print(a_list) Quick Sort123456789101112131415161718192021222324252627282930313233343536373839404142def quick_sort(a_list): quick_sort_helper(a_list, 0, len(a_list) - 1)def quick_sort_helper(a_list, first, last): if first &lt; last: split_point = partition(a_list, first, last) quick_sort_helper(a_list, first, split_point - 1) quick_sort_helper(a_list, split_point + 1, last)def partition(a_list, first, last): pivot_value = a_list[first] left_mark = first + 1 right_mark = last done = False while not done: while left_mark &lt;= right_mark and \ a_list[left_mark] &lt;= pivot_value: left_mark = left_mark + 1 while a_list[right_mark] &gt;= pivot_value and \ right_mark &gt;= left_mark: right_mark = right_mark - 1 if right_mark &lt; left_mark: done = True else: temp = a_list[left_mark] a_list[left_mark] = a_list[right_mark] a_list[right_mark] = temp temp = a_list[first] a_list[first] = a_list[right_mark] a_list[right_mark] = temp return right_marka_list = [54, 26, 93, 17, 77, 31, 44, 55, 20]quick_sort(a_list)print(a_list) å‚è€ƒèµ„æ–™Problem Solving with Algorithms and Data Structures using Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Algorithm</tag>
        <tag>Sort</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Haskell åŸºæœ¬è¯­æ³•ï¼ˆä¸€ï¼‰åˆ—è¡¨ä¸Žç±»åž‹ç³»ç»Ÿ]]></title>
    <url>%2F2020%2F01%2F20%2Fbasic-haskell-lists-and-typeclass%2F</url>
    <content type="text"><![CDATA[ç®—æœ¯ä¸Žé€»è¾‘è¿ç®—ç®—æœ¯è¿ç®—ï¼š12345678910111213Prelude&gt; 2 + 1517Prelude&gt; 5 / 22.5Prelude&gt; 50 * (100 - 4999)-244950Prelude&gt; 5 * -3&lt;interactive&gt;:4:1: error: Precedence parsing error cannot mix â€˜*â€™ [infixl 7] and prefix `-' [infixl 6] in the same infix expressionPrelude&gt; 5 * (-3)-15 é€»è¾‘è¿ç®—ï¼š123456Prelude&gt; True &amp;&amp; FalseFalsePrelude&gt; False || TrueTruePrelude&gt; not (True &amp;&amp; False)True åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼š12345678Prelude&gt; 5 == 5TruePrelude&gt; 5 == 4FalsePrelude&gt; 5 /= 4TruePrelude&gt; "hello" == "hello"True å‡½æ•°è°ƒç”¨åœ¨ Haskell ä¸­ï¼Œ+ - * / ç­‰æ“ä½œç¬¦å®žé™…ä¸Šä¹Ÿæ˜¯å‡½æ•°ï¼Œåªä¸è¿‡è°ƒç”¨æ—¶å‡½æ•°åä½äºŽä¸¤ä¸ªå‚æ•°ä¹‹é—´ï¼Œå«åš infix å‡½æ•°ã€‚å…¶ä»–å¸¸è§çš„å‡½æ•°ä¸º prefix å‡½æ•°ï¼Œé€šè¿‡å‡½æ•°å+ç©ºæ ¼+å‚æ•°çš„æ ¼å¼ï¼ˆfun a b ...ï¼‰è°ƒç”¨ã€‚123456Prelude&gt; succ 89Prelude&gt; min 9 109Prelude&gt; succ 9 + max 5 4 + 116 æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨æ—¶å°†å‡½æ•°åæ”¾åœ¨å‚æ•°ä¸­é—´ï¼Œå¦‚ï¼š1234Prelude&gt; div 10 25Prelude&gt; 10 `div` 25 Haskell ä¸­ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ä¸éœ€è¦åƒ C è¯­è¨€ä¸­é‚£æ ·æ”¾ç½®åœ¨ () ä¸­ï¼Œå› æ­¤ bar (bar 3) å®žé™…ä¸Šç­‰åŒäºŽ C ä¸­çš„ bar(bar(3))ã€‚ å‡½æ•°å®šä¹‰12345Prelude&gt; doubleMe x = x + xPrelude&gt; doubleMe 918Prelude&gt; doubleMe 8.316.6 12345Prelude&gt; doubleSmallNumber x = if x &gt; 100 then x else x * 2Prelude&gt; doubleSmallNumber 123123Prelude&gt; doubleSmallNumber 80160 Haskell ä¸­çš„ if è¯­å¥æ˜¯ä¸€ç§è¡¨è¾¾å¼ã€‚è¡¨è¾¾å¼æ˜¯æŒ‡æŸä¸€æ®µæœ‰è¿”å›žå€¼çš„ä»£ç ç‰‡æ®µã€‚æ¯”å¦‚ 5 æ˜¯è¡¨è¾¾å¼ï¼Œè¿”å›žæ•°å­— 5ï¼›x + y ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œè¿”å›ž x ä¸Ž y çš„å’Œã€‚å› æ­¤ Haskell if è¯­å¥ä¸­çš„ else æ˜¯å¿…éœ€çš„ï¼ˆä¿è¯ä¸€å®šæœ‰è¿”å›žå€¼ï¼‰ã€‚ listHaskell ä¸­çš„åˆ—è¡¨åªèƒ½å­˜æ”¾åŒä¸€ç±»åž‹çš„æ•°æ®é¡¹ã€‚123Prelude&gt; let a = [1,2,3,4]Prelude&gt; a[1,2,3,4] Haskell ä¸­çš„å­—ç¬¦ä¸²å®žé™…ä¸Šæ˜¯æ•°æ®é¡¹ç±»åž‹ä¸º Char çš„åˆ—è¡¨ï¼Œ&quot;hello&quot; ä»…ä»…æ˜¯ [&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;] çš„ä¸€ç§è¯­æ³•ç³–ã€‚123456Prelude&gt; ['h','e','l','l','o']"hello"Prelude&gt; ['h','e','l','l','o'] == "hello"TruePrelude&gt; :t "hello""hello" :: [Char] åˆ—è¡¨é€šè¿‡ ++ ç¬¦å·æ‰§è¡Œè¿žæŽ¥æ“ä½œã€‚1234Prelude&gt; [1,2,3,4] ++ [5][1,2,3,4,5]Prelude&gt; "hello" ++ " " ++ "world""hello world" PSï¼šä½¿ç”¨ ++ æ“ä½œç¬¦è¿žæŽ¥ä¸¤ä¸ªåˆ—è¡¨æ—¶ï¼Œå³ä¾¿å³è¾¹çš„åˆ—è¡¨åªåŒ…å«ä¸€ä¸ªæ•°æ®é¡¹ï¼Œä¹Ÿéœ€è¦ç”¨ [] æ‹¬èµ·æ¥ã€‚ä¸ç®¡å³è¾¹æ·»åŠ çš„åˆ—è¡¨æœ‰å¤šå°‘æ•°æ®é¡¹ï¼Œå·¦è¾¹çš„åˆ—è¡¨éƒ½ä¼šåœ¨åˆå¹¶æ—¶éåŽ†è‡ªèº«çš„æ‰€æœ‰é¡¹ã€‚ å¯ä»¥ä½¿ç”¨ : æ“ä½œç¬¦åœ¨åˆ—è¡¨å·¦ä¾§æ·»åŠ ä¸€ä¸ªæ•°æ®é¡¹ã€‚1234Prelude&gt; 'A' : " Small Cat""A Small Cat"Prelude&gt; 5 : [1,2,3,4,5][5,1,2,3,4,5] PSï¼š[1,2,3] å®žé™…ä¸Šæ˜¯ 1:2:3:[] çš„è¯­æ³•ç³–ã€‚12Prelude&gt; 1:2:3:[][1,2,3] ä½¿ç”¨ !! æ“ä½œç¬¦æ ¹æ®ç´¢å¼•èŽ·å–åˆ—è¡¨ä¸­çš„æŸä¸ªæ•°æ®é¡¹ã€‚1234Prelude&gt; [1,2,3,4] !! 01Prelude&gt; "hello" !! 1'e' elem å¯ä»¥åˆ¤æ–­æŸä¸ªæ•°æ®é¡¹ä¸Žåˆ—è¡¨çš„åŒ…å«å…³ç³»ã€‚1234Prelude&gt; elem 4 [3,4,5,6]TruePrelude&gt; elem 100 [3,4,5,6]False æ¯”è¾ƒåˆ—è¡¨çš„å¤§å°æ—¶ï¼Œä¼šä»Žåˆ—è¡¨å·¦ä¾§å¼€å§‹é€ä¸ªæ•°æ®é¡¹è¿›è¡Œæ¯”å¯¹ã€‚123456Prelude&gt; [3,2,1] &gt; [3,1,0]TruePrelude&gt; [3,2,1] &gt; [2,10,100]TruePrelude&gt; [3,4,2] &gt; [3,4]True å¸¸è§çš„ä½œç”¨äºŽåˆ—è¡¨çš„å‡½æ•°ï¼š headï¼šèŽ·å–åˆ—è¡¨çš„é¦–ä¸ªå…ƒç´  tailï¼šèŽ·å–åˆ—è¡¨çš„å°¾éƒ¨ï¼ˆé™¤é¦–ä¸ªå…ƒç´ ä»¥å¤–çš„ï¼‰å…ƒç´  lastï¼šèŽ·å–åˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´  initï¼šèŽ·å–åˆ—è¡¨çš„å‰å‡ ä¸ªï¼ˆé™¤æœ€åŽä¸€ä¸ªå…ƒç´ ä»¥å¤–ï¼‰å…ƒç´  lengthï¼šè¿”å›žåˆ—è¡¨é•¿åº¦ nullï¼šåˆ¤æ–­åˆ—è¡¨æ˜¯å¦ä¸ºç©º reverseï¼šé€†åºè¾“å‡ºæºåˆ—è¡¨ minimumï¼šèŽ·å–åˆ—è¡¨ä¸­çš„æœ€å°å€¼ maximumï¼šèŽ·å–åˆ—è¡¨ä¸­çš„æœ€å¤§å€¼ sumï¼šèŽ·å–åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„åŠ å’Œ productï¼šèŽ·å–åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ 1234567891011121314Prelude&gt; head [5,4,3,2,1]5Prelude&gt; tail [5,4,3,2,1][4,3,2,1]Prelude&gt; last [5,4,3,2,1]1Prelude&gt; init [5,4,3,2,1][5,4,3,2]Prelude&gt; length [5,4,3,2,1]5Prelude&gt; null [5,4,3,2,1]FalsePrelude&gt; reverse [5,4,3,2,1][1,2,3,4,5] å…¶ä»–å¦‚å¯¹åˆ—è¡¨çš„ subset æ“ä½œï¼Œtake å‡½æ•°å¯ä»¥èŽ·å–åˆ—è¡¨ä¸­çš„å‰å‡ ä¸ªæ•°æ®é¡¹ï¼ˆå³ç”Ÿæˆå­åˆ—è¡¨ï¼‰ï¼Œdrop å¯ä»¥èŽ·å–åˆ—è¡¨ä¸­é™¤å‰å‡ é¡¹ä»¥å¤–çš„å…¶ä»–æ•°æ®é¡¹ã€‚12345678910Prelude&gt; take 3 [5,4,3,2,1][5,4,3]Prelude&gt; drop 3 [5,4,3,2,1][2,1]Prelude&gt; take 0 [5,4,3,2,1][]Prelude&gt; take 10 [5,4,3,2,1][5,4,3,2,1]Prelude&gt; drop 100 [5,4,3,2,1][] range1234Prelude&gt; [1..10][1,2,3,4,5,6,7,8,9,10]Prelude&gt; ['a' .. 'z']"abcdefghijklmnopqrstuvwxyz" åŒ…å«æ­¥é•¿çš„ rangeï¼Œæ¯”å¦‚èŽ·å– 2 åˆ° 20 ä¹‹é—´çš„æ‰€æœ‰å¶æ•°ï¼Œå’ŒèŽ·å– 3 åˆ° 20 ä¹‹é—´æ‰€æœ‰3 çš„å€æ•°ï¼š1234Prelude&gt; [2,4..20][2,4,6,8,10,12,14,16,18,20]Prelude&gt; [3,6..20][3,6,9,12,15,18] ä»Žè¯­æ³•ä¸Šçœ‹ï¼Œ[] ä¸­éœ€åŒ…å«å‰ä¸¤é¡¹ä»¥åŠæœ€åŽä¸€é¡¹ï¼ˆçš„èŒƒå›´ï¼‰ã€‚å› æ­¤èŽ·å– 20 åˆ° 1 çš„æ•°å­—åˆ—è¡¨åˆ™å¯ä»¥ä½¿ç”¨ [20,19..1]ã€‚12Prelude&gt; [20,19..1][20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1] æ­¤å¤–ï¼ŒèŽ·å–ä»Ž 13 å¼€å§‹å…± 24 ä¸ª 13 çš„å€æ•°ï¼Œå¯ä»¥ä½¿ç”¨ [13,26..24*13]ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ take 24 [13,26..]ã€‚æ²¡æœ‰æä¾›æœ€åŽä¸€é¡¹çš„èŒƒå›´ï¼ˆå¦‚ [13,26..]ï¼‰æ—¶ï¼Œrange æ–¹å¼ä¼šç”Ÿæˆæ— ç©·åˆ—è¡¨ã€‚Haskell çš„è®¡ç®—æ˜¯ lazy çš„ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒæ— ç©·åˆ—è¡¨ä¼šåƒæŽ‰æ‰€æœ‰å†…å­˜ã€‚ ç”Ÿæˆæ— ç©·åˆ—è¡¨è¿˜å¯ä»¥ä½¿ç”¨ cycle æˆ–è€… repeatï¼š1234Prelude&gt; take 10 (cycle [1,2,3])[1,2,3,1,2,3,1,2,3,1]Prelude&gt; take 10 (repeat 5)[5,5,5,5,5,5,5,5,5,5] åˆ—è¡¨æŽ¨å¯¼Haskell ä¸­çš„åˆ—è¡¨æŽ¨å¯¼ï¼Œå†™æ³•ä¸Šå¾ˆåƒå•çº¯çš„æ•°å­¦å…¬å¼ $S = {2 * x | x \in \mathbb{N}, x &lt;= 10}$12Prelude&gt; [x*2 | x &lt;- [1..10]][2,4,6,8,10,12,14,16,18,20] ç­‰åŒäºŽ Python ä¸­çš„å¦‚ä¸‹è¡¨è¾¾å¼ï¼š12&gt;&gt;&gt; [x * 2 for x in range(1, 11)][2, 4, 6, 8, 10, 12, 14, 16, 18, 20] æ›´å¤æ‚çš„æƒ…å†µå¦‚ï¼š12Prelude&gt; [x*2 | x &lt;- [1..10], x*2 &gt;= 12][12,14,16,18,20] ç”šè‡³å¯ä»¥æœ‰å¦‚ä¸‹ç”¨æ³•ï¼š1234Prelude&gt; [x*y | x &lt;- [2,5,10], y &lt;- [8,10,11]][16,20,22,40,50,55,80,100,110]Prelude&gt; [x*y | x &lt;- [2,5,10], y &lt;- [8,10,11], x*y &gt; 50][55,80,100,110] å€ŸåŠ©åˆ—è¡¨æŽ¨å¯¼å¯ä»¥å®šä¹‰è‡ªå·±çš„ length å‡½æ•°ï¼š123Prelude&gt; length xs = sum [1 | _ &lt;- xs]Prelude&gt; length [1,2,3,4]4 å®šä¹‰å‡½æ•°åŽ»é™¤æŸä¸ªåˆ—è¡¨ä¸­æ‰€æœ‰çš„éžå¤§å†™å­—ç¬¦ï¼š123Prelude&gt; removeNonUppercase st = [c | c &lt;- st, elem c ['A' .. 'Z']]Prelude&gt; removeNonUppercase "Hahaha! Ahahaha!""HA" TupleHaskell ä¸­çš„å…ƒç»„ç›¸å¯¹äºŽåˆ—è¡¨ä¸»è¦æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š å…ƒç»„çš„ç±»åž‹ç”±æ‰€å«å…ƒç´ çš„é•¿åº¦å’Œæ¯ä¸ªå…ƒç´ çš„ç±»åž‹ç¡®å®š å…ƒç»„ä¸­å¯ä»¥åŒ…å«ä¸åŒç±»åž‹çš„å…ƒç´  å¦‚ (&quot;Christopher&quot;, &quot;Walken&quot;, 55) è¿™æ ·çš„å…ƒç»„æ˜¯åˆæ³•çš„ï¼Œå³å•ä¸ªå…ƒç»„ä¸­å¯ä»¥åŒ…å«å­—ç¬¦ä¸²ï¼ˆåˆ—è¡¨ï¼‰ã€æ•°å­—ç­‰ä¸åŒç±»åž‹ï¼›[(1,2),(8,11,5),(4,5)] å’Œ [(1,2),(&quot;One&quot;,2)] è¿™æ ·çš„åˆ—è¡¨åˆ™æ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºä¸åŒé•¿åº¦æˆ–è€…å…ƒç´ ç±»åž‹ä¸åŒçš„å…ƒç»„ï¼Œå…¶ç±»åž‹ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œä¸èƒ½ä½œä¸ºåŒä¸€ä¸ªåˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚123456Prelude&gt; :t (1,2)(1,2) :: (Num t, Num t1) =&gt; (t1, t)Prelude&gt; :t (8,11,5)(8,11,5) :: (Num t, Num t1, Num t2) =&gt; (t2, t1, t)Prelude&gt; :t ("one",2)("one",2) :: Num t =&gt; ([Char], t) fst å¯ä»¥è¿”å›žå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œsnd è¿”å›žå…ƒç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚è¿™ä¸¤ä¸ªå‡½æ•°åªä½œç”¨äºŽé•¿åº¦ä¸º 2 çš„å…ƒç»„ã€‚1234Prelude&gt; fst (8,11)8Prelude&gt; snd ("Wow", False)False zip å¯ä»¥å°†ä¸¤ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸€ä¸€ç»„åˆæˆé•¿åº¦ä¸ºäºŒçš„å…ƒç»„ï¼Œæœ€ç»ˆå½¢æˆæ–°çš„ä»¥å…ƒç»„ä¸ºå…ƒç´ çš„åˆ—è¡¨ã€‚123456Prelude&gt; zip [1,2,3,4,5] [5,5,5,5,5][(1,5),(2,5),(3,5),(4,5),(5,5)]Prelude&gt; zip [1..5] ["one", "two", "three", "four", "five"][(1,"one"),(2,"two"),(3,"three"),(4,"four"),(5,"five")]Prelude&gt; zip [1..] ["apple", "orange", "cherry", "mango"][(1,"apple"),(2,"orange"),(3,"cherry"),(4,"mango")] ç±»åž‹ç³»ç»ŸHaskell æ˜¯é™æ€ç±»åž‹çš„è¯­è¨€ï¼Œæ¯ä¸€ä¸ªè¡¨è¾¾å¼åœ¨ç¼–è¯‘æ—¶å…¶ç±»åž‹ä¾¿å·²çŸ¥ã€‚ä¸åŒäºŽ Java ç­‰è¯­è¨€ï¼ŒHaskell æ”¯æŒç±»åž‹æŽ¨æ–­ã€‚å®ƒå¯ä»¥è‡ªè¡ŒæŽ¨æ–­å‡ºæŸä¸ªæ•°å­—å±žäºŽ Int ç±»åž‹ã€‚123456789101112Prelude&gt; :t 'a''a' :: CharPrelude&gt; :t TrueTrue :: BoolPrelude&gt; :t "HELLO!""HELLO!" :: [Char]Prelude&gt; :t (True, 'a')(True, 'a') :: (Bool, Char)Prelude&gt; :t ('a','b','c')('a','b','c') :: (Char, Char, Char)Prelude&gt; :t 4 == 54 == 5 :: Bool :: è¯»ä½œ has type of ã€‚å…ƒç»„çš„ç±»åž‹å–å†³äºŽå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ çš„ç±»åž‹ä»¥åŠå…ƒç»„é•¿åº¦ï¼Œå› æ­¤è¡¨è¾¾å¼ (&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) çš„ç±»åž‹ä¸º (Char, Char, Char)ã€‚è¡¨è¾¾å¼ 4 == 5 æ€»æ˜¯è¿”å›ž Falseï¼Œå› æ­¤å…¶ç±»åž‹ä¸º Boolã€‚ Haskell ä¸­çš„å‡½æ•°åŒæ ·æœ‰ç±»åž‹ã€‚123Prelude&gt; removeNonUppercase st = [ c | c &lt;- st, c `elem` ['A'..'Z']]Prelude&gt; :t removeNonUppercaseremoveNonUppercase :: [Char] -&gt; [Char] removeNoneUppercase å‡½æ•°çš„ç±»åž‹ä¸º [Char] -&gt; [Char]ï¼Œè¯´æ˜Žè¯¥å‡½æ•°çš„å‚æ•°ç±»åž‹ä¸ºå­—ç¬¦ä¸²ï¼Œè¿”å›žå€¼ç±»åž‹ä¸ºå­—ç¬¦ä¸²ã€‚å³å‡½æ•°çš„ç±»åž‹é€šè¿‡ç”± -&gt; ç¬¦å·åˆ†éš”çš„å‚æ•°ä¸Žè¿”å›žå€¼çš„ç±»åž‹è¡¨ç¤ºã€‚ ç±»åž‹å˜é‡å‡½æ•°çš„ç±»åž‹ç”±å‚æ•°å’Œè¿”å›žå€¼è¡¨ç¤ºï¼Œä½†æ˜¯æœ‰äº›å‡½æ•°çš„å‚æ•°ä¸Žè¿”å›žå€¼çš„ç±»åž‹å¹¶ä¸ä¼šå›ºå®šä¸ºæŸä¸€ç§ã€‚æ¯”å¦‚ head å‡½æ•°å¯ä»¥èŽ·å–åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè€Œåˆ—è¡¨ä¸­å…ƒç´ çš„ç±»åž‹å¯èƒ½ç”±å¾ˆå¤šç§ã€‚123456Prelude&gt; head [1,2,3,4]1Prelude&gt; head "hello"'h'Prelude&gt; :t headhead :: [a] -&gt; a head :: [a] -&gt; a ä¸­çš„ a å³ä¸ºç±»åž‹å˜é‡ï¼Œè¡¨ç¤ºè¯¥å‚æ•°æˆ–è¿”å›žå€¼å¯ä»¥æ˜¯ä»»æ„ç±»åž‹ã€‚åŒ…å«ç±»åž‹å˜é‡çš„å‡½æ•°å«åšå¤šæ€å‡½æ•°ã€‚é™¤äº† a ä»¥å¤–ï¼Œå…¶ä»–å¦‚ bã€cã€d ç­‰ä¹Ÿå¯ä½œä¸ºç±»åž‹å˜é‡ä½¿ç”¨ã€‚åƒå‰é¢çš„ [a] -&gt; aï¼Œ a å¯ä»¥è¡¨ç¤ºä»»æ„ç±»åž‹ï¼Œä½†ä¸¤ä¸ª a å¿…å®šæ˜¯åŒä¸€ç±»åž‹ã€‚1234Prelude&gt; fst ("hello", True)"hello"Prelude&gt; :t fstfst :: (a, b) -&gt; a TypeclassTypeclass æ˜¯ä¸€ç§å®šä¹‰äº†æŸäº›è¡Œä¸ºçš„æŽ¥å£ã€‚å¦‚æžœæŸä¸ªç±»åž‹å±žäºŽç‰¹å®šçš„ typeclassï¼Œåˆ™æ„å‘³ç€è¯¥ç±»åž‹å®žçŽ°äº†ç”± typeclass æè¿°çš„è¡Œä¸ºï¼Œç±»ä¼¼äºŽ Java ä¸­çš„ interfaceã€‚12Prelude&gt; :t (==)(==) :: Eq a =&gt; a -&gt; a -&gt; Bool å…¶ä¸­ =&gt; ç¬¦å·å‰é¢çš„éƒ¨åˆ†å«åšç±»çº¦æŸï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š== å‡½æ•°æŽ¥æ”¶ä»»æ„ä¸¤ä¸ªç›¸åŒç±»åž‹ï¼ˆaï¼‰çš„æ•°å€¼ï¼Œæ ¹æ®å…¶æ˜¯å¦ç›¸ç­‰è¿”å›ž Bool å€¼ã€‚ä¸¤ä¸ªè¾“å…¥å‚æ•°çš„ç±»åž‹å¿…é¡»æ˜¯ Eq ç±»çš„æˆå‘˜ï¼ˆå› æ­¤å«ç±»çº¦æŸï¼‰ã€‚ Eq typeclass ä¸ºå…¶æˆå‘˜ç±»åž‹æä¾›äº†æµ‹è¯•ç›¸ç­‰æ€§çš„æŽ¥å£ï¼Œä»»ä½•å¯ä»¥ç”¨æ¥æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰çš„ç±»åž‹éƒ½åº”è¯¥æ˜¯ Eq ç±»çš„æˆå‘˜ã€‚æ‰€æœ‰ Haskell åŸºæœ¬ç±»åž‹ï¼ˆé™¤ IO å¤–ï¼‰å’Œå‡½æ•°éƒ½æ˜¯ Eq typeclass çš„ä¸€éƒ¨åˆ†ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›åŸºæœ¬çš„ typeclassï¼šEq ç”¨äºŽç±»åž‹ä¹‹é—´çš„ç›¸ç­‰æ€§æµ‹è¯•ï¼Œå®žçŽ°çš„å‡½æ•°æœ‰ == å’Œ /= ã€‚12345678910Prelude&gt; 5 == 5TruePrelude&gt; 5 /= 5FalsePrelude&gt; 'a' == 'a'TruePrelude&gt; "Ho Ho" == "Ho Ho"TruePrelude&gt; 3.432 == 3.432True Ord ç”¨äºŽæ‹¥æœ‰é¡ºåºçš„ç±»åž‹ï¼ŒåŒ…å«æ‰€æœ‰åŸºæœ¬çš„æ¯”è¾ƒå‡½æ•°å¦‚ &gt;ã€&lt; å’Œ &gt;= ç­‰ã€‚123456Prelude&gt; :t (&gt;)(&gt;) :: Ord a =&gt; a -&gt; a -&gt; BoolPrelude&gt; "Abrakadabra" &lt; "Zebra"TruePrelude&gt; 5 &gt;= 2True Show çš„æˆå‘˜å¯ä»¥è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²ï¼Œæœ€å¸¸ç”¨çš„ç”¨äºŽå¤„ç† Show æˆå‘˜çš„å‡½æ•°æ˜¯ showï¼Œå¯ä»¥å°†æŸä¸ªç±»åž‹çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¡¨ç¤ºï¼š123456Prelude&gt; show 3"3"Prelude&gt; show 5.334"5.334"Prelude&gt; show True"True" Read æ˜¯å’Œ Show ç›¸åçš„ä¸€ç±» typeclassã€‚read å‡½æ•°å¯ä»¥æŽ¥æ”¶å­—ç¬¦ä¸²å¹¶è¿”å›žå±žäºŽ Read çš„æŸä¸ªç±»åž‹ï¼ˆè‡ªè¡ŒæŽ¨æ–­æˆ–æ˜¾ç¤ºæŒ‡å®šï¼‰ï¼š12345678910Prelude&gt; read "True" || FalseTruePrelude&gt; read "8.2" + 3.812.0Prelude&gt; read "[1,2,3,4]" ++ [3][1,2,3,4,3]Prelude&gt; read "[1,2,3,4]"*** Exception: Prelude.read: no parsePrelude&gt; read "[1,2,3,4]" :: [Int][1,2,3,4] Enum çš„æˆå‘˜æ˜¯æœ‰é¡ºåºçš„åºåˆ—ç±»åž‹ï¼Œå¯ä»¥è¢«æžšä¸¾ã€‚Enum ä¸­çš„æˆå‘˜éƒ½å¯ä»¥ä½¿ç”¨ range çš„æ–¹å¼ç”Ÿæˆåˆ—è¡¨ï¼Œä¹Ÿéƒ½å¯ä»¥è¢«è‡ªå¢žæˆ–è‡ªå‡å‡½æ•°è°ƒç”¨ã€‚12345678Prelude&gt; ['a'..'e']"abcde"Prelude&gt; [3..5][3,4,5]Prelude&gt; succ 'B''C'Prelude&gt; pred 'C''B' Num æ˜¯ä¸€ä¸ªæ•°å­—ç±»åž‹çš„ typeclassã€‚å®ƒçš„æˆå‘˜éƒ½å…·æœ‰æ•°å­—ç±»åž‹çš„å±žæ€§ã€‚12345678Prelude&gt; :t 2020 :: Num t =&gt; tPrelude&gt; 20 :: Float20.0Prelude&gt; 20 :: Double20.0Prelude&gt; :t (*)(*) :: Num a =&gt; a -&gt; a -&gt; a å‡½æ•° * çš„ç±»åž‹ä¸º Num a =&gt; a -&gt; a -&gt; aï¼Œå› æ­¤å…¶å‚æ•°å¿…é¡»æ˜¯ Num typelcass çš„æˆå‘˜ï¼Œä¸”å¿…é¡»æ˜¯åŒä¸€ç±»åž‹ã€‚123456789Prelude&gt; 5 * (6 :: Float)30.0Prelude&gt; (5 :: Int) * (6 :: Float)&lt;interactive&gt;:56:15: error: â€¢ Couldn't match expected type â€˜Intâ€™ with actual type â€˜Floatâ€™ â€¢ In the second argument of â€˜(*)â€™, namely â€˜(6 :: Float)â€™ In the expression: (5 :: Int) * (6 :: Float) In an equation for â€˜itâ€™: it = (5 :: Int) * (6 :: Float) å‚è€ƒèµ„æ–™Learn You a Haskell for Great Good!]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Functional</tag>
        <tag>Haskell</tag>
        <tag>Type</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue.js å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰æ•°æ®ç»‘å®šä¸ŽæŒ‡ç¤ºå™¨]]></title>
    <url>%2F2020%2F01%2F18%2Fdata-binding-and-directives-in-vue-js%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å®‰è£…ä¸Žé¡¹ç›®åˆå§‹åŒ–å®‰è£… @vue/cliï¼š$ npm install -g @vue/cli å®‰è£… gitï¼šsudo apt-get install git åˆ›å»ºé¡¹ç›®ï¼š$ vue create todo --default é¡¹ç›®ç»“æž„12345678910111213141516$ tree todo -I node_modulestodoâ”œâ”€â”€ babel.config.jsâ”œâ”€â”€ package.jsonâ”œâ”€â”€ package-lock.jsonâ”œâ”€â”€ publicâ”‚ â”œâ”€â”€ favicon.icoâ”‚ â””â”€â”€ index.htmlâ”œâ”€â”€ README.mdâ””â”€â”€ src â”œâ”€â”€ App.vue â”œâ”€â”€ assets â”‚ â””â”€â”€ logo.png â”œâ”€â”€ components â”‚ â””â”€â”€ HelloWorld.vue â””â”€â”€ main.js æ–‡ä»¶ åŠŸèƒ½ public/index.html æµè§ˆå™¨åŠ è½½çš„ HTML æ–‡ä»¶ã€‚å…¶ä¸­åŒ…å«ç”¨äºŽæ˜¾ç¤º Vue åº”ç”¨çš„æ ‡ç­¾å’ŒåŠ è½½åº”ç”¨æ–‡ä»¶çš„ &lt;script&gt; src/main.js è´Ÿè´£ Vue åº”ç”¨çš„åŸºæœ¬é…ç½®ï¼Œé€šå¸¸è¿˜ç”¨äºŽæ³¨å†Œåº”ç”¨ä¾èµ–çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ src/App.vue Vue ç»„ä»¶ï¼Œå³ Vue åº”ç”¨çš„ä¸»è¦æž„æˆéƒ¨åˆ†ã€‚å¦‚éœ€è¦æ˜¾ç¤ºç»™ç”¨æˆ·çš„ HTML é¡µé¢ã€Javascript ä»£ç å’Œ CSS ç­‰ public/index.htmlï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt; &lt;head&gt; &lt;title&gt;todo&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id="app"&gt;&lt;/div&gt; &lt;!-- built files will be auto injected --&gt; &lt;/body&gt;&lt;/html&gt; src/main.jsï¼š12345678import Vue from 'vue'import App from './App.vue'Vue.config.productionTip = falsenew Vue(&#123; render: h =&gt; h(App),&#125;).$mount('#app') App.vueï¼š12345678910111213141516171819202122232425262728&lt;template&gt; &lt;div id=&quot;app&quot;&gt; &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot;&gt; &lt;HelloWorld msg=&quot;Welcome to Your Vue.js App&quot;/&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import HelloWorld from &apos;./components/HelloWorld.vue&apos;export default &#123; name: &apos;app&apos;, components: &#123; HelloWorld &#125;&#125;&lt;/script&gt;&lt;style&gt;#app &#123; font-family: &apos;Avenir&apos;, Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-align: center; color: #2c3e50; margin-top: 60px;&#125;&lt;/style&gt; å¼€å¯æµ‹è¯•æœåŠ¡å™¨ï¼š$ npm run serve äºŒã€æ•°æ®ç»‘å®šä¸ŽæŒ‡ç¤ºå™¨å‡†å¤‡å·¥ä½œï¼Œæ·»åŠ  CSS åº“ï¼š$ npm install bootstrap@4.0.0 ä¿®æ”¹ src/main.js å¯¼å…¥ Bootstrapï¼š1234567891011// src/main.jsimport Vue from 'vue'import App from './App.vue'import "bootstrap/dist/css/bootstrap.min.css";Vue.config.productionTip = falsenew Vue(&#123; render: h =&gt; h(App),&#125;).$mount('#app') 1. æ•°æ®ç»‘å®šå±•ç¤ºæ•°æ®ç»™ç”¨æˆ·æ˜¯ web ç»„ä»¶æœ€é‡è¦çš„å·¥ä½œä¹‹ä¸€ï¼Œæ•°æ®ç»‘å®šå¯ä»¥å°† &lt;script&gt; ä¸‹å®šä¹‰çš„æ•°æ®å¯¹è±¡å…³è”ç»™ &lt;template&gt; ä¸­çš„ç‰¹å®šå…ƒç´ è¿›è¡Œæ˜¾ç¤ºã€‚ æ˜¾ç¤ºæ•°æ®ä¿®æ”¹ src/App.vue å¦‚ä¸‹ï¼š1234567891011121314151617// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot; &#125; &#125;&#125;&lt;/script&gt; é€šè¿‡ JavaScript æ¨¡å—ä¸­çš„ data å±žæ€§å®šä¹‰äº†å¯ä»¥è¢«ç»‘å®šçš„æ•°æ®å€¼ï¼š12345data: function () &#123; return &#123; name: "Kayak" &#125;&#125; å†å€ŸåŠ©æ•°æ®ç»‘å®šæœºåˆ¶ï¼Œä½¿ç”¨ ç­‰è¯­æ³•å°† &lt;script&gt; ä¸­å®šä¹‰çš„æ•°æ®å…³è”åˆ° template æ¨¡å—çš„ HTML å…ƒç´ ä¸­ã€‚è¿™ç§å½¢å¼çš„ç»‘å®šä¹Ÿç§°ä¸ºæ–‡æœ¬æ³¨å…¥ï¼ˆtext interpolation bindingï¼‰ã€‚ ç»‘å®šä¸­ä½¿ç”¨è¡¨è¾¾å¼å®žé™…ä¸Šæ•°æ®ç»‘å®šä¸ä»…ä»…å¯ä»¥é€šè¿‡é¢„å…ˆå®šä¹‰çš„å˜é‡æ›¿æ¢ HTML å…ƒç´ ä¸­çš„æ–‡æœ¬ï¼Œè¿˜å¯ä»¥ç›´æŽ¥åµŒå…¥å¤æ‚çš„è¡¨è¾¾å¼ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;h3&gt;Price: $&#123;&#123; (price + (price * (taxRate / 100))).toFixed(2) &#125;&#125;&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot;, price: 275, taxRate: 12 &#125; &#125;&#125;&lt;/script&gt; Computed Propertiesåœ¨æ•°æ®ç»‘å®šä¸­ä½¿ç”¨è¿‡äºŽå¤æ‚çš„è¡¨è¾¾å¼å¹¶ä¸åˆ©äºŽä»£ç çš„é˜…è¯»ã€ç»´æŠ¤å’Œå¤ç”¨ã€‚ä¸ºäº†ä½¿ template ç»„ä»¶å¯ä»¥è¶³å¤Ÿç®€å•ï¼ŒVue æä¾›äº†è®¡ç®—å±žæ€§æ¨¡å—ï¼Œå¯ä»¥ä»Ž data å±žæ€§æä¾›çš„æ•°æ®ä¸­ç”Ÿæˆéœ€è¦çš„å€¼ï¼Œä»Žè€Œå‡å°‘æ•°æ®ç»‘å®šä¸­å¤æ‚è¡¨è¾¾å¼çš„ä½¿ç”¨ã€‚12345678910111213141516171819202122232425// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;h3&gt;Price: $&#123;&#123; totalPrice.toFixed(2) &#125;&#125;&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot;, price: 275, taxRate: 12 &#125; &#125;, computed: &#123; totalPrice: function() &#123; return this.price + (this.price * (this.taxRate / 100)); &#125; &#125;&#125;&lt;/script&gt; å…³é”®ä»£ç ï¼š1234567&lt;h3&gt;Price: $&#123;&#123; totalPrice.toFixed(2) &#125;&#125;&lt;/h3&gt;...computed: &#123; totalPrice: function() &#123; return this.price + (this.price * (this.taxRate / 100)); &#125;&#125; Methodsæ–¹æ³•ç›¸å¯¹äºŽè®¡ç®—å±žæ€§åˆ™æ›´åŠ çµæ´»ï¼Œå¯ä»¥å®šä¹‰è‡ªå·±çš„å‚æ•°ã€‚1234567891011121314151617181920212223242526272829303132333435// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;h4&gt;Price: $&#123;&#123; lowTotalPrice.toFixed(2) &#125;&#125; (Low Rate)&lt;/h4&gt; &lt;h4&gt;Price: $&#123;&#123; highTotalPrice.toFixed(2) &#125;&#125; (High Rate)&lt;/h4&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot;, price: 275, lowTaxRate: 12, highTaxRate: 20 &#125; &#125;, computed: &#123; lowTotalPrice: function () &#123; return this.getTotalPrice(this.lowTaxRate); &#125;, highTotalPrice: function () &#123; return this.getTotalPrice(this.highTaxRate); &#125;&#125;, methods: &#123; getTotalPrice(taxRate) &#123; return this.price + (this.price * (taxRate / 100)); &#125; &#125;&#125;&lt;/script&gt; ä¹Ÿå¯ä»¥çœç•¥æŽ‰ä¸Šé¢ä»£ç ä¸­å¯¹è®¡ç®—å±žæ€§çš„å®šä¹‰ï¼Œç›´æŽ¥åœ¨æ•°æ®ç»‘å®šæ—¶è°ƒç”¨æ–¹æ³•ã€‚è¿™æ˜¾ç¤ºäº†å„ç»„ä»¶ä¹‹é—´ç»„ç»‡çš„çµæ´»æ€§ï¼Œå½“ç„¶æ­¤ä¸¾ä¹Ÿä¼šå¢žåŠ  template ä¸­ä»£ç çš„å¤æ‚åº¦ï¼š12345678910111213141516171819202122232425262728// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;h4&gt;Price: $&#123;&#123; getTotalPrice(lowTaxRate).toFixed(2) &#125;&#125; (Low Rate)&lt;/h4&gt; &lt;h4&gt;Price: $&#123;&#123; getTotalPrice(highTaxRate).toFixed(2) &#125;&#125; (High Rate)&lt;/h4&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot;, price: 275, lowTaxRate: 12, highTaxRate: 20 &#125; &#125;, methods: &#123; getTotalPrice(taxRate) &#123; return this.price + (this.price * (taxRate / 100)); &#125; &#125;&#125;&lt;/script&gt; Filtersè¿‡æ»¤å™¨æ˜¯ä¸€ç§åœ¨ filter æ¨¡å—ä¸‹å®šä¹‰çš„å‡½æ•°ï¼Œå¯ä»¥å¯¹éœ€è¦æ˜¾ç¤ºçš„è¡¨è¾¾å¼è¿›è¡Œæ ¼å¼åŒ–æ“ä½œï¼š12345678910111213141516171819202122232425262728293031323334// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name &#125;&#125;&lt;/h3&gt; &lt;h4&gt;Price: &#123;&#123; getTotalPrice(lowTaxRate) | currency &#125;&#125; (Low Rate)&lt;/h4&gt; &lt;h4&gt;Price: &#123;&#123; getTotalPrice(highTaxRate) | currency &#125;&#125; (High Rate)&lt;/h4&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Kayak&quot;, price: 275, lowTaxRate: 12, highTaxRate: 20 &#125; &#125;, methods: &#123; getTotalPrice(taxRate) &#123; return this.price + (this.price * (taxRate / 100)); &#125; &#125;, filters: &#123; currency(value) &#123; return new Intl.NumberFormat(&quot;en-US&quot;, &#123; style: &quot;currency&quot;, currency: &quot;USD&quot; &#125;).format(value); &#125; &#125;&#125;&lt;/script&gt; å¤æ‚ Filter1234567891011121314151617181920212223242526272829303132333435363738394041424344// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;bg-primary text-white text-center m-2 p-3&quot;&gt; &lt;h3&gt;Product: &#123;&#123; name | reverse | capitalize &#125;&#125;&lt;/h3&gt; &lt;h4&gt;Price: &#123;&#123; getTotalPrice(lowTaxRate) | currency(3) &#125;&#125; (Low Rate)&lt;/h4&gt; &lt;h4&gt;Price: &#123;&#123; getTotalPrice(highTaxRate) | currency &#125;&#125; (High Rate)&lt;/h4&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, price: 48.95, lowTaxRate: 12, highTaxRate: 20 &#125; &#125;, methods: &#123; getTotalPrice(taxRate) &#123; return this.price + (this.price * (taxRate / 100)); &#125; &#125;, filters: &#123; currency(value, places) &#123; return new Intl.NumberFormat(&quot;en-US&quot;, &#123; style: &quot;currency&quot;, currency: &quot;USD&quot;, minimumFractionDigits: places || 2, maximumFractionDigits: places || 2 &#125;).format(value); &#125;, capitalize(value) &#123; return value[0].toUpperCase() + value.slice(1); &#125;, reverse(value) &#123; return value.split(&quot;&quot;).reverse().join(&quot;&quot;); &#125; &#125;&#125;&lt;/script&gt; 2. DirectivesæŒ‡ç¤ºå™¨ æ˜¯ template ä¸­å¯ä»¥ä¸º HTML å…ƒç´ æ·»åŠ  Vue.js åŠŸèƒ½çš„ä¸€äº›ç‰¹æ®Šå±žæ€§ã€‚æ¯”å¦‚ v-on:click æŒ‡ç¤ºå™¨å¯ä»¥ä¸º &lt;button&gt; å…ƒç´ æ·»åŠ å¯¹é¼ æ ‡å•å‡»äº‹ä»¶çš„ç›‘å¬ï¼Œv-text æŒ‡ç¤ºå™¨å¯ä»¥è®¾ç½®æŸä¸ª HTML å…ƒç´ çš„æ–‡å­—å†…å®¹ã€‚ æœ‰é€‰æ‹©åœ°æ˜¾ç¤ºå…ƒç´ ä½¿ç”¨ v-if æŒ‡ç¤ºå™¨æŽ§åˆ¶ HTML å…ƒç´ çš„æ˜¾ç¤ºä¸Žéšè—ï¼š12345678910111213141516171819202122232425262728293031// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3&quot;&gt; &lt;h3&gt;Product: &lt;span v-text=&quot;name&quot;&gt;&lt;/span&gt;&lt;/h3&gt; &lt;h4 v-if=&quot;showElements&quot;&gt;&#123;&#123; price &#125;&#125;&lt;/h4&gt; &lt;/div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, price: 275, showElements: true &#125; &#125;, methods: &#123; handleClick() &#123; this.showElements = !this.showElements; &#125; &#125;,&#125;&lt;/script&gt; å…³é”®ä»£ç ï¼š12345678&lt;h4 v-if="showElements"&gt;&#123;&#123; price &#125;&#125;&lt;/h4&gt;&lt;button v-on:click="handleClick" class="btn btn-primary"&gt;...methods: &#123; handleClick() &#123; this.showElements = !this.showElements; &#125; &#125; v-if-else123456789101112131415161718192021222324252627282930313233// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3&quot;&gt; &lt;h3 v-if=&quot;counter % 3 == 0&quot;&gt;Product: &#123;&#123;name&#125;&#125;&lt;/h3&gt; &lt;h3 v-else-if=&quot;counter % 3 == 1&quot;&gt;Price: &#123;&#123;price&#125;&#125;&lt;/h3&gt; &lt;h3 v-else&gt;Category: &#123;&#123;category&#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, price: 275, category: &quot;Waterspots&quot;, counter: 0 &#125; &#125;, methods: &#123; handleClick() &#123; this.counter++; &#125; &#125;,&#125;&lt;/script&gt; è®¾ç½®å…ƒç´ çš„ Class å±žæ€§ é€šè¿‡ v-bind:class è®¾ç½® HTML å…ƒç´ çš„ Class å±žæ€§ï¼š1234567891011121314151617181920212223242526272829303132333435// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3&quot;&gt; &lt;h3 v-bind:class=&quot;elemClasses&quot;&gt;Product: &#123;&#123;name&#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, highlight: false &#125; &#125;, computed: &#123; elemClasses() &#123; return this.highlight ? [&quot;bg-light&quot;, &quot;text-dark&quot;, &quot;display-4&quot;] : [&quot;bg-dark&quot;, &quot;text-light&quot;, &quot;p-2&quot;]; &#125; &#125;, methods: &#123; handleClick() &#123; this.highlight = !this.highlight; &#125; &#125;,&#125;&lt;/script&gt; è®¾ç½®å¤šä¸ªå±žæ€§v-bind æŒ‡ç¤ºå™¨å¯ä»¥åŒæ—¶è®¾ç½® HTML å…ƒç´ çš„ classã€style ç­‰å±žæ€§ï¼Œç”šè‡³è¿˜å¯ä»¥åŒ…æ‹¬åŽŸæœ¬ä¸å­˜åœ¨çš„ç”±ç”¨æˆ·è‡ªè¡Œå®šä¹‰çš„å±žæ€§ï¼ˆå¦‚ä¸‹é¢ä»£ç ä¸­çš„ data-sizeï¼‰ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3&quot;&gt; &lt;h3 v-bind=&quot;attrValues&quot;&gt;Product: &#123;&#123;name&#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, highlight: false &#125; &#125;, computed: &#123; attrValues() &#123; return &#123; class: this.highlight ? [&quot;bg-light&quot;, &quot;text-dark&quot;] : [], style: &#123; border: this.highlight ? &quot;5px solid red&quot; : &quot;&quot; &#125;, &quot;data-size&quot;: this.highlight ? &quot;big&quot; : &quot;small&quot; &#125; &#125; &#125;, methods: &#123; handleClick() &#123; this.highlight = !this.highlight; &#125; &#125;,&#125;&lt;/script&gt;&lt;style&gt; [data-size=big] &#123; font-size: 40pt; &#125; [data-size=small] &#123; font-size: 20pt; &#125;&lt;/style&gt; è®¾ç½® HTMLElement å±žæ€§ï¼ˆä¸å¸¸ç”¨ï¼‰123456789101112131415161718192021222324252627282930313233// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;div class=&quot;bg-primary text-white m-2 p-3&quot;&gt; &lt;h3 v-bind:text-content.prop=&quot;textContent&quot;&gt;&lt;/h3&gt; &lt;/div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; name: &quot;Lifejacket&quot;, highlight: false &#125; &#125;, computed: &#123; textContent() &#123; return this.highlight ? &quot;Highlight!&quot; : `Product: $&#123;this.name&#125;`; &#125; &#125;, methods: &#123; handleClick() &#123; this.highlight = !this.highlight; &#125; &#125;,&#125;&lt;/script&gt; 3. Repeater DirectiveVue.js ä¸­çš„ v-for æŒ‡ç¤ºå™¨å¯ä»¥ç”¨æ¥æ“ä½œæ•°ç»„æ ¼å¼çš„æ•°æ®ã€ç”Ÿæˆè¡¨æ ¼å’Œ Grid å¸ƒå±€ç­‰ã€‚ éåŽ†æ•°ç»„v-for æŒ‡ç¤ºå™¨å¯ä»¥éåŽ†æ•°ç»„ç»“æž„ä¸­çš„æ•°æ®å¯¹è±¡å¹¶ä»¥å¾ªçŽ¯çš„æ–¹å¼ç»‘å®šç»™å¤šä¸ª HTML å…ƒç´ ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;h2 class=&quot;bg-primary text-while text-center p-3&quot;&gt;Products&lt;/h2&gt; &lt;table class=&quot;table table-sm table-bordered table-striped text-left&quot;&gt; &lt;tr&gt;&lt;th&gt;Index&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;&lt;/tr&gt; &lt;tbody&gt; &lt;tr v-for=&quot;(p, i) in products&quot; v-bind:key=&quot;p.name&quot;&gt; &lt;td&gt;&#123;&#123; i + 1 &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.name &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.price &#125;&#125;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; products: [ &#123; name: &quot;Kayak&quot;, price: 275 &#125;, &#123; name: &quot;Lifejacket&quot;, price: 48.95 &#125;, &#123; name: &quot;Soccer Ball&quot;, price: 19.50 &#125;, ] &#125; &#125;, methods: &#123; handleClick() &#123; this.products.push(this.products.shift()); &#125; &#125;,&#125;&lt;/script&gt; å…³é”®ä»£ç ï¼š12345&lt;tr v-for=&quot;(p, i) in products&quot; v-bind:key=&quot;p.name&quot;&gt; &lt;td&gt;&#123;&#123; i + 1 &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.name &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.price &#125;&#125;&lt;/td&gt;&lt;/tr&gt; éåŽ†å¯¹è±¡æ³¨æ„æ­¤å¤„éåŽ†çš„æ•°æ®ç»“æž„æ˜¯ JavaScript å¯¹è±¡è€Œä¸æ˜¯ä¸Šé¢ä»£ç ä¸­çš„æ•°ç»„ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;h2 class=&quot;bg-primary text-while text-center p-3&quot;&gt;Products&lt;/h2&gt; &lt;table class=&quot;table table-sm table-bordered table-striped text-left&quot;&gt; &lt;tr&gt;&lt;th&gt;Index&lt;/th&gt;&lt;th&gt;Key&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;&lt;/tr&gt; &lt;tbody&gt; &lt;tr v-for=&quot;(p, key, i) in products&quot; v-bind:key=&quot;p.name&quot;&gt; &lt;td&gt;&#123;&#123; i + 1 &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; key &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.name &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.price &#125;&#125;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;div&gt; &lt;button v-on:click=&quot;handleClick&quot; class=&quot;btn btn-primary&quot;&gt; Press Me &lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import Vue from &quot;vue&quot;;export default &#123; name: &quot;app&quot;, data: function () &#123; return &#123; products: &#123; &quot;kayak&quot;: &#123; name: &quot;Kayak&quot;, price: 275 &#125;, 22: &#123; name: &quot;Lifejacket&quot;, price: 48.95 &#125;, 3: &#123; name: &quot;Soccer Ball&quot;, price: 19.50 &#125;, 4: &#123; name: &quot;Corner Flags&quot;, price: 39.95 &#125; &#125; &#125; &#125;, methods: &#123; handleClick() &#123; Vue.set(this.products, 5, &#123; name: &quot;Running Shoes&quot;, price: 100 &#125;); &#125; &#125;,&#125;&lt;/script&gt; PSï¼šæ›´æ–°è¡¨æ ¼æ•°æ®åº”ä½¿ç”¨ Vue.set()ï¼Œä¸è¦ä½¿ç”¨ç±»ä¼¼ this.products[index] = xx è¿™æ ·çš„å½¢å¼ã€‚1Vue.set(this.products, 5, &#123; name: &quot;Running Shoes&quot;, price: 100 &#125;); v-for ä¸Ž Computed Propertiesv-for æŒ‡ç¤ºå™¨å¯ä»¥æ­é…è®¡ç®—å±žæ€§å’Œæ–¹æ³•ç­‰ä¸€èµ·ä½¿ç”¨ï¼Œå‚è€ƒï¼ˆç»†å“ï¼‰ä¸‹é¢çš„åˆ†é¡µç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// src/App.vue&lt;template&gt; &lt;div id=&quot;app&quot; class=&quot;container-fluid text-center&quot;&gt; &lt;h2 class=&quot;bg-primary text-while text-center p-3&quot;&gt;Products&lt;/h2&gt; &lt;table class=&quot;table table-sm table-bordered table-striped text-left&quot;&gt; &lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;&lt;/tr&gt; &lt;tbody&gt; &lt;tr v-for=&quot;p in pageItems&quot; v-bind:key=&quot;p.name&quot;&gt; &lt;td&gt;&#123;&#123; p.name &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; p.price &#125;&#125;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;div&gt; &lt;!-- eslint-disable-next-line vue/require-v-for-key --&gt; &lt;button v-for=&quot;i in pageCount&quot; v-on:click=&quot;selectPage(i)&quot; class=&quot;btn btn-secondary m-1&quot; v-bind:class=&quot;&#123;&apos;bg-primary&apos;: currentPage == i&#125;&quot;&gt; &#123;&#123; i &#125;&#125; &lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data: function () &#123; return &#123; pageSize: 3, currentPage: 1, products: [ &#123; name: &quot;Kayak&quot;, price: 275 &#125;, &#123; name: &quot;Lifejacket&quot;, price: 48.95 &#125;, &#123; name: &quot;Soccer Ball&quot;, price: 19.50 &#125;, &#123; name: &quot;Corner Flags&quot;, price: 39.95 &#125;, &#123; name: &quot;Stadium&quot;, price: 79500 &#125;, &#123; name: &quot;Thinking Cap&quot;, price: 16 &#125;, &#123; name: &quot;Unsteady Chair&quot;, price: 29.95 &#125;, &#123; name: &quot;Human Chess Board&quot;, price: 75 &#125;, &#123; name: &quot;Bling Bling King&quot;, price: 1200 &#125; ] &#125; &#125;, computed: &#123; pageCount() &#123; return Math.ceil(this.products.length / this.pageSize); &#125;, pageItems() &#123; let start = (this.currentPage - 1) * this.pageSize; return this.products.slice(start, start + this.pageSize); &#125; &#125;, methods: &#123; selectPage(page) &#123; this.currentPage = page; &#125; &#125;&#125;&lt;/script&gt; å‚è€ƒèµ„æ–™Pro Vue.js 2]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Vue</tag>
        <tag>Frontend</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ ldap3 æ“ä½œ Windows åŸŸè´¦å·]]></title>
    <url>%2F2020%2F01%2F14%2Fmanipulate-windows-ad-account-with-python-ldap3%2F</url>
    <content type="text"><![CDATA[ldap3 æ˜¯ä¸€ä¸ªä¸¥æ ¼éµå®ˆ RFC 4510 è§„èŒƒï¼Œå®Œå…¨ç”±çº¯ Python ä»£ç å®žçŽ°çš„ LDAPv3 å®¢æˆ·ç«¯ã€‚ldap3 åªä¾èµ–äºŽ Python æ ‡å‡†åº“å’Œ pyasn1ï¼Œæ— éœ€ä½¿ç”¨ C ç¼–è¯‘å™¨ç¼–è¯‘æˆ–è€…å®‰è£…å…¶ä»–äºŒè¿›åˆ¶ç¨‹åºï¼Œç›´æŽ¥ä½¿ç”¨ pip å‘½ä»¤å®‰è£…å³å¯ï¼ˆpip install ldap3ï¼‰ã€‚ ä¸€ã€è¿žæŽ¥æœåŠ¡å™¨12345&gt;&gt;&gt; from ldap3 import Server, Connection, ALL&gt;&gt;&gt; server = Server('&lt;hostname_or_ip&gt;')&gt;&gt;&gt; conn = Connection(server)&gt;&gt;&gt; conn.bind()True æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´ç®€çŸ­çš„å½¢å¼ï¼š123&gt;&gt;&gt; conn = Connection('&lt;hostname_or_ip&gt;', auto_bind=True)&gt;&gt;&gt; connConnection(server=Server(host='xx.xx.xx.xx', port=389, use_ssl=False, allowed_referral_hosts=[('*', True)], get_info='SCHEMA', mode='IP_V6_PREFERRED'), auto_bind='NO_TLS', version=3, authentication='ANONYMOUS', client_strategy='SYNC', auto_referrals=True, check_names=True, read_only=False, lazy=False, raise_exceptions=False, fast_decoder=True, auto_range=True, return_empty_attributes=True, auto_encode=True, auto_escape=True, use_referral_cache=False) èŽ·å–æœåŠ¡å™¨ä¿¡æ¯ï¼š12345678910&gt;&gt;&gt; server = Server('&lt;hostname_or_ip&gt;', get_info=ALL)&gt;&gt;&gt; conn = Connection(server, auto_bind=True)&gt;&gt;&gt; server.infoDSA info (from DSE): Supported LDAP versions: 3, 2 Naming contexts: DC=example,DC=com CN=Configuration,DC=example,DC=com CN=Schema,CN=Configuration,DC=example,DC=com... ç”¨æˆ·ç»‘å®š12345&gt;&gt;&gt; from ldap3 import Server, Connection, ALL&gt;&gt;&gt; server = Server('&lt;hostname_or_ip&gt;', get_info=ALL)&gt;&gt;&gt; conn = Connection(server, user='admin@example.com', password='admin@123', auto_bind=True)&gt;&gt;&gt; conn.extend.standard.who_am_i()'u:EXAMPLE\\admin' PSï¼šé€šå¸¸åœ¨å¯¹åŸŸè´¦å·è¿›è¡Œä¿®æ”¹ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦å¯ç”¨ SSL è¿žæŽ¥ä»¥ç¬¦åˆå®‰å…¨è§„èŒƒã€‚åœ¨æž„é€  Server å¯¹è±¡æ—¶ä¼ å…¥ use_ssl=True å³å¯ï¼š1server = Server(&apos;&lt;hostname_or_ip&gt;&apos;, port=636, use_ssl=True, get_info=ALL) å¦‚æœ‰éœ€è¦ï¼ŒTLS çš„å¯ç”¨å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ https://ldap3.readthedocs.io/ssltls.html äºŒã€å¯¹è±¡æ£€ç´¢ä½¿ç”¨ FreeIPA å¼€æ”¾çš„ LDAP ç¤ºä¾‹æœåŠ¡æµ‹è¯•æœç´¢æ“ä½œï¼š1234567891011&gt;&gt;&gt; from ldap3 import Server, Connection, ALL&gt;&gt;&gt; server = Server('ipa.demo1.freeipa.org', get_info=ALL)&gt;&gt;&gt; conn = Connection(server, 'uid=admin,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org', 'Secret123', auto_bind=True)&gt;&gt;&gt; conn.search('dc=demo1,dc=freeipa,dc=org', '(objectclass=person)')True&gt;&gt;&gt; conn.entries[DN: uid=admin,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T18:57:39.837356, DN: uid=manager,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T18:57:39.837594, DN: uid=employee,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T18:57:39.837722, DN: uid=helpdesk,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T18:57:39.837845] search æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°æ˜¯å¿…éœ€çš„ï¼š search_base ç”¨äºŽæŒ‡å®šæœç´¢çš„èµ·å§‹ä½ç½® search_filter ç”¨äºŽæŒ‡å®šæœç´¢çš„ç­›é€‰æ¡ä»¶ filter çš„å®šä¹‰è¯­æ³•æ”¯æŒ =ã€&lt;=ã€&gt;= ç­‰æ¯”è¾ƒè¿ç®—ç¬¦å’Œ &amp;ã€|ã€! ç­‰é€»è¾‘è¿ç®—ç¬¦ã€‚å¦‚ï¼š(&amp;(givenName=John)(mail=*@example.com)) è¡¨ç¤ºå¯»æ‰¾åå­—ä¸º John ä¸”é‚®ç®±ä»¥ ``@example.com ç»“å°¾çš„åŸŸè´¦å·ã€‚ ä»¥ä¸‹æœç´¢æ¡ä»¶åˆ™è¡¨ç¤ºå¯»æ‰¾åå­—ä¸º Fred æˆ– Johnï¼Œå¹¶ä¸”é‚®ç®±ä»¥ ``@example.com ç»“å°¾çš„åŸŸè´¦å·ï¼š1234567(&amp; (| (givenName=Fred) (givenName=John) ) (mail=*@example.com)) attributeså‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516&gt;&gt;&gt; conn.search('dc=demo1,dc=freeipa,dc=org', '(&amp;(objectclass=person)(uid=admin))', attributes=['sn', 'krbLastPwdChange', 'objectclass'])True&gt;&gt;&gt; conn.entries[0]DN: uid=admin,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T19:14:20.657761 krbLastPwdChange: 2019-01-25 15:16:11+00:00 objectclass: top person posixaccount krbprincipalaux krbticketpolicyaux inetuser ipaobject ipasshuser ipaSshGroupOfPubKeys ipaNTUserAttrs sn: Administrator å…¶ä¸­ (&amp;(objectclass=person)(uid=admin) ç”¨äºŽæŒ‡å®šæŸ¥æ‰¾å¯¹è±¡ç±»åž‹ä¸º person ä¸” uid ä¸º admin çš„ç”¨æˆ·è´¦å·ï¼› attributes å‚æ•°åˆ™ç”¨äºŽæŒ‡å®šæœç´¢ç»“æžœä¸­é¢å¤–åŒ…å«è¯¥è´¦æˆ·çš„ snã€krbLastPwdChange å’Œ objectclass å±žæ€§ã€‚ PSï¼šè®¾ç½® attributes = [&#39;*&#39;] å¯ä»¥åœ¨æœç´¢ç»“æžœä¸­æ˜¾ç¤ºå¯¹è±¡çš„æ‰€æœ‰å±žæ€§ã€‚ å¯ä»¥ä½¿ç”¨ Entry å¯¹è±¡çš„ entry_to_json æ–¹æ³•å°†è¯¥å¯¹è±¡çš„æ‰€æœ‰å±žæ€§ä»¥ JSON æ ¼å¼è¾“å‡ºï¼š123456789101112131415161718192021222324&gt;&gt;&gt; print(conn.entries[0].entry_to_json())&#123; "attributes": &#123; "krbLastPwdChange": [ "2019-01-25 15:16:11+00:00" ], "objectclass": [ "top", "person", "posixaccount", "krbprincipalaux", "krbticketpolicyaux", "inetuser", "ipaobject", "ipasshuser", "ipaSshGroupOfPubKeys", "ipaNTUserAttrs" ], "sn": [ "Administrator" ] &#125;, "dn": "uid=admin,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org"&#125; æ­¤å¤–è¿˜å¯ä»¥ä½¿ç”¨ paged_size å‚æ•°æŽ§åˆ¶æ¯é¡µæ˜¾ç¤ºçš„ç»“æžœæ•°é‡ã€‚ç»¼åˆå®žä¾‹å¦‚ä¸‹ï¼š12345678910111213141516&gt;&gt;&gt; searchParameters = &#123;'search_base': 'dc=demo1,dc=freeipa,dc=org',... 'search_filter': '(objectClass=Person)',... 'attributes': ['cn', 'givenName'],... 'paged_size': 3&#125;&gt;&gt;&gt; conn.search(**searchParameters)True&gt;&gt;&gt; conn.entries[DN: uid=admin,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T19:23:50.396926 cn: Administrator, DN: uid=manager,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T19:23:50.397214 cn: Test Manager givenName: Test, DN: uid=employee,cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-13T19:23:50.397509 cn: Test Employee givenName: Test] ä¸‰ã€æ•°æ®åº“æ“ä½œåˆ›å»ºæ¡ç›®æ–°å»º OUï¼š12&gt;&gt;&gt; conn.add('ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'organizationalUnit')True æ–°å»ºç”¨æˆ·ï¼š12&gt;&gt;&gt; conn.add('cn=b.young,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'inetOrgPerson', &#123;'givenName': 'Beatrix', 'sn': 'Young', 'departmentNumber': 'DEV', 'telephoneNumber': 1111&#125;)True æŸ¥çœ‹ objectClass ç»“æž„ï¼š12345678910&gt;&gt;&gt; server.schema.object_classes['person']Object class: 2.5.6.6 Short name: person Type: Structural Superior: top Must contain attributes: sn, cn May contain attributes: userPassword, telephoneNumber, seeAlso, description Extensions: X-ORIGIN: RFC 4519 OidInfo: ('2.5.6.6', 'OBJECT_CLASS', 'person', 'RFC4519') é‡å‘½åæ¡ç›®12&gt;&gt;&gt; conn.modify_dn('cn=b.young,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'cn=b.smith')True ç§»åŠ¨æ¡ç›®1234&gt;&gt;&gt; conn.add('ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org','organizationalUnit')True&gt;&gt;&gt; conn.modify_dn('cn=b.smith,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'cn=b.smith', new_superior='ou=moved, ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org')True æ›´æ–°æ¡ç›®æ·»åŠ å±žæ€§å€¼ï¼š12345678910&gt;&gt;&gt; from ldap3 import MODIFY_ADD, MODIFY_REPLACE, MODIFY_DELETE&gt;&gt;&gt; conn.modify('cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', &#123;'sn': [(MODIFY_ADD, ['Smyth'])]&#125;)True&gt;&gt;&gt; conn.search('ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', '(cn=b.smith)', attributes=['cn', 'sn'])True&gt;&gt;&gt; conn.entries[0]DN: cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-14T13:50:45.461241 cn: b.smith sn: Young Smyth ç§»é™¤å±žæ€§å€¼ï¼š12345678&gt;&gt;&gt; conn.modify('cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', &#123;'sn': [(MODIFY_DELETE, ['Young'])]&#125;)True&gt;&gt;&gt; conn.search('ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', '(cn=b.smith)', attributes=['cn', 'sn'])True&gt;&gt;&gt; conn.entries[0]DN: cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-14T13:52:43.586339 cn: b.smith sn: Smyth æ›¿æ¢å±žæ€§å€¼ï¼š12345678&gt;&gt;&gt; conn.modify('cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', &#123;'sn': [(MODIFY_REPLACE, ['Smith'])]&#125;)True&gt;&gt;&gt; conn.search('ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', '(cn=b.smith)', attributes=['cn', 'sn'])True&gt;&gt;&gt; conn.entries[0]DN: cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org - STATUS: Read - READ TIME: 2020-01-14T13:53:28.834019 cn: b.smith sn: Smith åˆ¤æ–­å±žæ€§æ˜¯å¦ä¸ºæŸä¸ªç‰¹å®šå€¼ï¼š1234&gt;&gt;&gt; conn.compare('cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'departmentNumber', 'DEV')True&gt;&gt;&gt; conn.compare('cn=b.smith,ou=moved,ou=ldap3-tutorial,dc=demo1,dc=freeipa,dc=org', 'departmentNumber', 'QA')False å››ã€åŸŸè´¦å·æ“ä½œä¿®æ”¹è´¦æˆ·å¯†ç ï¼š12345678910&gt;&gt;&gt; from ldap3 import Server, Connection&gt;&gt;&gt; server = Server('&lt;hostname_or_ip', use_ssl=True)&gt;&gt;&gt; conn = Connection(server, user='admin@example.com', password='admin@123', auto_bind=True)&gt;&gt;&gt; conn.search('ou=Domain Users,dc=example,dc=com', '(&amp;(objectClass=person)(sAMAccountName=admin))')True&gt;&gt;&gt; dn = conn.entries[0].entry_dn&gt;&gt;&gt; dn'CN=admin,OU=Domain Users,DC=example,DC=com'&gt;&gt;&gt; conn.extend.microsoft.modify_password(dn, 'new_password')True è§£é”è´¦æˆ·ï¼š12&gt;&gt;&gt; conn.extend.microsoft.unlock_account(dn)True æ­¤å¤–è¯¥æ¨¡å—ä¸‹è¿˜æœ‰ addMembersToGroups å’Œ removeMembersFromGroups ç­‰å‡½æ•°ã€‚ å‚è€ƒèµ„æ–™ldap3 å®˜æ–¹æ–‡æ¡£ldap3 é¡¹ç›®ä¸»é¡µ]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>LDAP</tag>
        <tag>ActiveDirectory</tag>
        <tag>Practical</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python3 ä¸­çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–è¯­æ³•]]></title>
    <url>%2F2020%2F01%2F14%2Fstring-format-in-python3%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æ—§å¼çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–% æ“ä½œç¬¦å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ï¼š123&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; "Hello, %s." % name'Hello, Eric.' å½“æœ‰å¤šä¸ªå˜é‡éœ€è¦æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­æ—¶ï¼š1234&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; age = 74&gt;&gt;&gt; "Hello, %s. You are %s." % (name, age)'Hello, Eric. You are 74.' å½“éœ€è¦æ›¿æ¢çš„å˜é‡è¿›ä¸€æ­¥å¢žå¤šæ—¶ï¼Œä½¿ç”¨ % æ“ä½œç¬¦æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¼šå¯¼è‡´ä»£ç å¯è¯»æ€§å˜å¾—å¾ˆå·®ï¼š1234567&gt;&gt;&gt; first_name = "Eric"&gt;&gt;&gt; last_name = "Idle"&gt;&gt;&gt; age = 74&gt;&gt;&gt; profession = "comedian"&gt;&gt;&gt; affiliation = "Monty Python"&gt;&gt;&gt; "Hello, %s %s. You are %s. You are a %s. You were a member of %s." % (first_name, last_name, age, profession, affiliation)'Hello, Eric Idle. You are 74. You are a comedian. You were a member of Monty Python.' str.format()str.format() æ˜¯å¯¹ % æ–¹å¼çš„æ”¹è¿›ï¼Œå®ƒä½¿ç”¨å¸¸è§çš„å‡½æ•°è°ƒç”¨çš„è¯­æ³•ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å®šä¹‰å¯¹è±¡æœ¬èº«çš„ __format__() æ–¹æ³•æŽ§åˆ¶å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„å…·ä½“è¡Œä¸ºã€‚ åŸºæœ¬ç”¨æ³•ï¼š1234&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; age = 74&gt;&gt;&gt; "Hello, &#123;&#125;. You are &#123;&#125;.".format(name, age)'Hello, Eric. You are 74.' str.format() ç›¸å¯¹äºŽ % æ“ä½œç¬¦æœ‰ç€æ›´å¼ºçš„çµæ´»æ€§ã€‚æ¯”å¦‚å¯ä»¥é€šè¿‡æ•°å­—ç´¢å¼•æ¥å…³è”æ›¿æ¢åˆ°å­—ç¬¦ä¸²ä¸­çš„å˜é‡ï¼š1234&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; age = 74&gt;&gt;&gt; "Hello, &#123;1&#125;. You are &#123;0&#125;.".format(age, name)'Hello, Eric. You are 74.' ä¸ºäº†æé«˜ä»£ç å¯è¯»æ€§ï¼Œ{} ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨æœ‰å…·ä½“å«ä¹‰çš„å‚æ•°åï¼š1234&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; age = 74&gt;&gt;&gt; "Hello, &#123;name&#125;. You are &#123;age&#125;".format(name=name, age=age)'Hello, Eric. You are 74' é’ˆå¯¹å­—å…¸ç»“æž„çš„æ•°æ®ï¼š123&gt;&gt;&gt; person = &#123;'name': 'Eric', 'age': 74&#125;&gt;&gt;&gt; "Hello, &#123;name&#125;. You are &#123;age&#125;.".format(name=person['name'], age=person['age'])'Hello, Eric. You are 74.' æˆ–è€…æ›´ç®€æ´çš„æ–¹å¼ï¼š123&gt;&gt;&gt; person = &#123;'name': 'Eric', 'age': 74&#125;&gt;&gt;&gt; "Hello, &#123;name&#125;. You are &#123;age&#125;.".format(**person)'Hello, Eric. You are 74.' é—®é¢˜åœ¨äºŽå½“éœ€è¦æ›¿æ¢çš„å˜é‡å¾ˆå¤šæ—¶ï¼Œstr.format() æ–¹å¼ä¾ç„¶ä¼šå¯¼è‡´ä»£ç å˜å¾—è¿‡äºŽå†—é•¿ï¼š12345678910&gt;&gt;&gt; first_name = "Eric"&gt;&gt;&gt; last_name = "Idle"&gt;&gt;&gt; age = 74&gt;&gt;&gt; profession = "comedian"&gt;&gt;&gt; affiliation = "Monty Python"&gt;&gt;&gt; "Hello, &#123;first_name&#125; &#123;last_name&#125;. You are &#123;age&#125;. \ You are a &#123;profession&#125;. You were a member of &#123;affiliation&#125;."\ .format(first_name=first_name, last_name=last_name, age=age, \ profession=profession, affiliation=affiliation)'Hello, Eric Idle. You are 74. You are a comedian. You were a member of Monty Python.' äºŒã€f-stringåŸºæœ¬ç”¨æ³•1234&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; age = 74&gt;&gt;&gt; f"Hello, &#123;name&#125;. You are &#123;age&#125;."'Hello, Eric. You are 74.' åµŒå…¥è¡¨è¾¾å¼123456789101112&gt;&gt;&gt; f"&#123;2 * 37&#125;"'74'&gt;&gt;&gt; def to_lowercase(input):... return input.lower() &gt;&gt;&gt; name = "Eric Idle"&gt;&gt;&gt; f"&#123;to_lowercase(name)&#125; is funny"'eric idle is funny'&gt;&gt;&gt; f"&#123;name.lower()&#125; is funny"'eric idle is funny' f-string ä¸­è¿˜å¯ä»¥ç›´æŽ¥åµŒå…¥æŸä¸ªå¯¹è±¡å®žä¾‹ï¼Œåªè¦å…¶å†…éƒ¨å®žçŽ°äº† __str__ æˆ–è€… __repr__ æ–¹æ³•ï¼š12345678910111213class Comedian: def __init__(self, first_name, last_name, age): self.first_name = first_name self.last_name = last_name self.age = age def __str__(self): return f"&#123;self.first_name&#125; &#123;self.last_name&#125; is &#123;self.age&#125;"new_comedian = Comedian("Eric", "Idle", 74)print(f"&#123;new_comedian&#125;")# Eric Idle is 74 å¤šè¡Œ f-string12345678910&gt;&gt;&gt; name = "Eric"&gt;&gt;&gt; profession = "comedian"&gt;&gt;&gt; affiliation = "Monty Python"&gt;&gt;&gt; message = (... f"Hi &#123;name&#125;. "... f"You are a &#123;profession&#125;. "... f"You were in &#123;affiliation&#125;."... )&gt;&gt;&gt; message'Hi Eric. You are a comedian. You were in Monty Python.' å‚è€ƒèµ„æ–™Python 3â€™s f-Strings: An Improved String Formatting Syntax (Guide)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Basic</tag>
        <tag>String</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ç»˜å›¾åº“ Matplotlib ä»£ç ç¤ºä¾‹]]></title>
    <url>%2F2020%2F01%2F08%2Fsample-plots-in-matplotlib%2F</url>
    <content type="text"><![CDATA[Line Plot1234567import matplotlib.pyplot as pltX = range(100)Y = [value ** 2 for value in X]plt.plot(X, Y)plt.show() Using Numpy12345678import numpy as npimport matplotlib.pyplot as pltX = np.linspace(0, 2 * np.pi, 100)Y = np.sin(X)plt.plot(X, Y)plt.show() ç­‰åŒäºŽå¦‚ä¸‹ä»£ç ï¼š123456789import mathimport matplotlib.pyplot as pltT = range(100)X = [(2 * math.pi * t) / len(T) for t in T]Y = [math.sin(value) for value in X]plt.plot(X, Y)plt.show() Multiple Line Plot12345678910import numpy as npimport matplotlib.pyplot as pltX = np.linspace(0, 2 * np.pi, 100)Ya = np.sin(X)Yb = np.cos(X)plt.plot(X, Ya)plt.plot(X, Yb)plt.show() ä»Žæ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–æ•°æ®1234567# my_data.txt0 01 12 44 165 256 36 1234567import numpy as npimport matplotlib.pyplot as pltdata = np.loadtxt('my_data.txt')plt.plot(data[:, 0], data[:, 1])plt.show() ç­‰åŒäºŽå¦‚ä¸‹ä»£ç ï¼š12345678910import matplotlib.pyplot as pltX, Y = [], []for line in open('my_data.txt', 'r'): values = [float(s) for s in line.split()] X.append(values[0]) Y.append(values[1])plt.plot(X, Y)plt.show() å…¶ä»–ç±»åž‹çš„å›¾å½¢Scatter Plot123456789101112131415import numpy as npimport matplotlib.pyplot as pltdata = np.random.rand(1024, 2)print(data)# [[0.74566428 0.27225566]# [0.49387305 0.22290731]# [0.78644733 0.44918945]# ...# [0.42446667 0.31317443]# [0.06518628 0.21378513]# [0.85117629 0.83458943]]plt.scatter(data[:, 0], data[:, 1])plt.show() Bar Charts123456import matplotlib.pyplot as pltdata = [5., 25., 50., 20.]plt.bar(range(len(data)), data)plt.show() Multiple Bar Charts12345678910111213import numpy as npimport matplotlib.pyplot as pltdata = [[5., 25., 50., 20.], [4., 23., 51., 17.], [6., 22., 52., 19.]]X = np.arange(4)plt.bar(X + 0.00, data[0], color='b', width=0.25)plt.bar(X + 0.25, data[1], color='g', width=0.25)plt.bar(X + 0.50, data[2], color='r', width=0.25)plt.show() Histogram1234567import numpy as npimport matplotlib.pyplot as pltX = np.random.randn(1000)plt.hist(X, bins=20)plt.show() Pie Charts12345678910111213import matplotlib.pyplot as plt# Pie chart, where the slices will be ordered and plotted counter-clockwise:labels = 'Frogs', 'Hogs', 'Dogs', 'Logs'sizes = [15, 30, 45, 10]explode = (0, 0.1, 0, 0) # only "explode" the 2nd slice (i.e. 'Hogs')fig1, ax1 = plt.subplots()ax1.pie(sizes, explode=explode, labels=labels, autopct='%1.1f%%', shadow=True, startangle=90)ax1.axis('equal') # Equal aspect ratio ensures that pie is drawn as a circle.plt.show() Colormatplotlib ä¸­å®šä¹‰é¢œè‰²çš„æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š (R, G, B, A)ï¼Œå¦‚ (1.0, 0.0, 0.0) è¡¨ç¤ºçº¢è‰²ï¼Œç¬¬å››é¡¹æ•°å­— A ï¼ˆå¯çœç•¥ï¼‰è¡¨ç¤ºé€æ˜Žåº¦ å­—ç¬¦ bã€gã€rã€cã€mã€yã€kã€wï¼Œåˆ†åˆ«è¡¨ç¤ºè“ã€ç»¿ã€çº¢ã€é’ã€æ´‹çº¢ã€é»„ã€é»‘ã€ç™½ HTML é¢œè‰²å­—ç¬¦ä¸² #RRGGBBï¼Œå¦‚ #FFFFFF è¡¨ç¤ºçº¯ç™½è‰² ç°åº¦å­—ç¬¦ä¸²ï¼Œä»‹äºŽ 0 å’Œ 1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œå¦‚ 0.75 è¡¨ç¤ºä¸­åº¦æµ…ç° ç¤ºä¾‹ä¸€ï¼š123456789101112import numpy as npimport matplotlib.pyplot as pltA = np.random.standard_normal((100, 2))A += np.array((-1, -1))B = np.random.standard_normal((100, 2))B += np.array((1, 1))plt.scatter(A[:, 0], A[:, 1], color='.75')plt.scatter(B[:, 0], B[:, 1], color='y')plt.show() ç¤ºä¾‹äºŒï¼šIris æ–‡æœ¬æ•°æ®ä¸‹è½½è‡ª http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.dataï¼Œæ ¼å¼å¦‚ä¸‹ï¼š123454.6,3.2,1.4,0.2,Iris-setosa5.3,3.7,1.5,0.2,Iris-setosa5.0,3.3,1.4,0.2,Iris-setosa7.0,3.2,4.7,1.4,Iris-versicolor6.4,3.2,4.5,1.5,Iris-versicolor 12345678910111213141516171819202122import numpy as npimport matplotlib.pyplot as pltlabel_set = ( b'Iris-setosa', b'Iris-versicolor', b'Iris-virginica')# convert label to index number.# Iris-setosa -&gt; 0, Iris-versicolor -&gt; 1, Iris-virginica -&gt; 2.def read_label(label): return label_set.index(label)data = np.loadtxt('iris.data', delimiter=',', converters=&#123;4: read_label&#125;)color_set = ('b', 'r', 'm')color_list = [color_set[int(label)] for label in data[:, 4]]plt.scatter(data[:, 0], data[:, 1], color=color_list)plt.show() ä¸Šé¢çš„ç¤ºä¾‹ä¸­åªç”¨åˆ°å‰ä¸¤åˆ—å’Œæœ€åŽä¸€åˆ—æ•°æ®ï¼Œå°†æœ€åŽä¸€åˆ—æ•°æ® label æ›¿æ¢ä¸ºå¯¹åº”çš„ index æ•°å­—ï¼Œä»¥ä¾¿åœ¨ä½œå›¾æ—¶æ ¹æ® index æ–½ä»¥ä¸åŒçš„ç€è‰²ã€‚ Line Pattern123456789101112131415import numpy as npimport matplotlib.pyplot as pltdef pdf(X, mu, sigma): a = 1. / (sigma * np.sqrt(2. * np.pi)) b = -1. / (2. * sigma ** 2) return a * np.exp(b * (X - mu) ** 2)X = np.linspace(-6, 6, 1024)plt.plot(X, pdf(X, 0., 1.), color='r', linestyle='solid')plt.plot(X, pdf(X, 0., .5), color='g', linestyle='dashed')plt.plot(X, pdf(X, 0., .25), color='m', linestyle='dashdot')plt.show() Marker Style123456789101112import numpy as npimport matplotlib.pyplot as pltA = np.random.standard_normal((100, 2))A += np.array((-1, -1))B = np.random.standard_normal((100, 2))B += np.array((1, 1))plt.scatter(A[:, 0], A[:, 1], color='m', marker='x', size=100)plt.scatter(B[:, 0], B[:, 1], color='g', marker='^')plt.show() Title and Label12345678910111213import numpy as npimport matplotlib.pyplot as pltX = np.linspace(-4, 4, 1024)Y = .25 * (X + 4.) * (X + 1.) * (X - 2.)plt.title('Power curve for airfoil KV873')plt.xlabel('Air speed')plt.ylabel('Total drag')plt.text(-0.5, -0.25, 'Brackmard minimum')plt.plot(X, Y, c='k')plt.show() Legend123456789101112131415import numpy as npimport matplotlib.pyplot as pltX = np.linspace(0, 6, 1024)Y1 = np.sin(X)Y2 = np.cos(X)plt.xlabel('X')plt.ylabel('Y')plt.plot(X, Y1, c='k', lw=3., label='sin(X)')plt.plot(X, Y2, c='.5', lw=3., ls='--', label='cos(X)')plt.legend()plt.show() Figures1234567891011121314151617import numpy as npfrom matplotlib import pyplot as pltT = np.linspace(-np.pi, np.pi, 1024)grid_size = (4, 2)plt.subplot2grid(grid_size, (0, 0), rowspan=3, colspan=1)plt.plot(np.sin(2 * T), np.cos(0.5 * T), c='k')plt.subplot2grid(grid_size, (0, 1), rowspan=3, colspan=1)plt.plot(np.cos(3 * T), np.sin(T), c='k')plt.subplot2grid(grid_size, (3, 0), rowspan=1, colspan=3)plt.plot(np.cos(5 * T), np.sin(7 * T), c='k')plt.tight_layout()plt.show() Subplots12345678910111213import matplotlib.pyplot as pltimport numpy as npnp.random.seed(19680801)data = np.random.randn(2, 100)fig, axs = plt.subplots(2, 2, figsize=(5, 5))axs[0, 0].hist(data[0])axs[1, 0].scatter(data[0], data[1])axs[0, 1].plot(data[0], data[1])axs[1, 1].hist2d(data[0], data[1])plt.show() User Interface123456789101112131415161718192021222324252627282930313233343536373839404142434445import numpy as npfrom matplotlib import pyplot as pltfrom matplotlib.widgets import Sliderdef supershape_radius(phi, a, b, m, n1, n2, n3): theta = .25 * m * phi cos = np.fabs(np.cos(theta) / a) ** n2 sin = np.fabs(np.sin(theta) / b) ** n3 r = (cos + sin) ** (-1. / n1) r /= np.max(r) return rphi = np.linspace(0, 2 * np.pi, 1024)m_init = 3n1_init = 2n2_init = 18n3_init = 18fig = plt.figure()ax = fig.add_subplot(111, polar=True)ax_m = plt.axes([0.05, 0.05, 0.25, 0.025])ax_n1 = plt.axes([0.05, 0.10, 0.25, 0.025])ax_n2 = plt.axes([0.7, 0.05, 0.25, 0.025])ax_n3 = plt.axes([0.7, 0.10, 0.25, 0.025])slider_m = Slider(ax_m, 'm', 1, 20, valinit=m_init)slider_n1 = Slider(ax_n1, 'n1', .1, 10, valinit=n1_init)slider_n2 = Slider(ax_n2, 'n2', .1, 20, valinit=n2_init)slider_n3 = Slider(ax_n3, 'n3', .1, 20, valinit=n3_init)r = supershape_radius(phi, 1, 1, m_init, n1_init, n2_init, n3_init)lines, = ax.plot(phi, r, lw=3.)def update(val): r = supershape_radius(phi, 1, 1, np.floor(slider_m.val), slider_n1.val, slider_n2.val, slider_n3.val) lines.set_ydata(r) fig.canvas.draw_idle()slider_n1.on_changed(update)slider_n2.on_changed(update)slider_n3.on_changed(update)slider_m.on_changed(update)plt.show() å‚è€ƒèµ„æ–™matplotlib Plotting CookbookSample plots in Matplotlib]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Data</tag>
        <tag>Plot</tag>
        <tag>Matplotlib</tag>
        <tag>Graphics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹]]></title>
    <url>%2F2020%2F01%2F06%2Fpython-design-patterns-understanding-OOP%2F</url>
    <content type="text"><![CDATA[é¢å‘å¯¹è±¡ç¼–ç¨‹é¢å‘å¯¹è±¡çš„ç¼–ç¨‹èŒƒå¼å¼•å…¥äº†å¯¹è±¡çš„æ¦‚å¿µï¼Œå¯¹è±¡å…·æœ‰å±žæ€§å’Œç”¨æ¥å¤„ç†å±žæ€§çš„æˆå‘˜å‡½æ•°ã€‚æ¯”å¦‚å¯¹è±¡ Car æ‹¥æœ‰å¤šç§å±žæ€§ï¼Œå¦‚ fuel_levelï¼ˆæ²¹ä½ï¼‰ã€is_sedanï¼ˆæ˜¯å¦ä¸ºè½¿è½¦ï¼‰ã€speedï¼ˆé€Ÿåº¦ï¼‰ã€steering_wheelï¼ˆæ–¹å‘ç›˜ï¼‰å’Œ coordinatesï¼ˆåæ ‡ï¼‰ç­‰ã€‚åŒæ—¶è¿˜æ‹¥æœ‰ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚ accelerate() æ–¹æ³•ç”¨æ¥æå‡é€Ÿåº¦ï¼Œtakeleft() æ–¹æ³•è®©è½¦å·¦è½¬ç­‰ã€‚ åœ¨ Python ä¸­ï¼Œä¸€åˆ‡çš†å¯¹è±¡ã€‚æ¯ä¸ªç±»çš„å®žä¾‹æˆ–å˜é‡éƒ½æœ‰å®ƒè‡ªå·±çš„å†…å­˜åœ°å€æˆ–èº«ä»½ã€‚å¯¹è±¡å°±æ˜¯ç±»çš„å®žä¾‹ï¼Œåº”ç”¨å¼€å‘å°±æ˜¯é€šè¿‡å¯¹è±¡äº¤äº’æ¥å®žçŽ°ç›®çš„çš„è¿‡ç¨‹ã€‚ å¯¹è±¡ï¼š è¡¨ç¤ºæ‰€å¼€å‘çš„åº”ç”¨ç¨‹åºå†…çš„å®žä½“ å®žä½“ä¹‹é—´å¯ä»¥é€šè¿‡äº¤äº’æ¥è§£å†³çŽ°å®žä¸–ç•Œçš„é—®é¢˜ å¦‚ Person æ˜¯å®žä½“ï¼ŒCar ä¹Ÿæ˜¯å®žä½“ã€‚Person å¯ä»¥é©¾é©¶ Carï¼Œä»Žä¸€ä¸ªåœ°æ–¹å¼€åˆ°å¦ä¸€ä¸ªåœ°æ–¹ ç±»ï¼š ç±»å¯ä»¥å®šä¹‰å¯¹è±¡çš„å±žæ€§å’Œè¡Œä¸ºã€‚å±žæ€§æ˜¯æ•°æ®æˆå‘˜ï¼Œè¡Œä¸ºç”±æˆå‘˜å‡½æ•°è¡¨ç¤º ç±»åŒ…å«äº†æž„é€ å‡½æ•°ï¼Œä¸ºå¯¹è±¡æä¾›åˆå§‹çŠ¶æ€ ç±»å°±åƒæ¨¡æ¿ï¼Œéžå¸¸æ˜“äºŽé‡å¤ä½¿ç”¨ æ–¹æ³•ï¼š è¡¨ç¤ºå¯¹è±¡çš„è¡Œä¸º å¯ä»¥å¯¹å±žæ€§è¿›è¡Œå¤„ç†ï¼Œå®žçŽ°æ‰€éœ€çš„åŠŸèƒ½ 12345678910111213class Person: def __init__(self, name, age): self.name = name self.age = age def get_person(self,): return f"&lt;Person (&#123;self.name&#125;, &#123;self.age&#125;&gt;)"p = Person("John", 32)print(f"Type of Object: &#123;type(p)&#125;, Memory Address: &#123;id(p)&#125;")print(p.get_person())# =&gt; Type of Object: &lt;class '__main__.Person'&gt;, Memory Address: 140586467650144# =&gt; &lt;Person (John, 32&gt;) ä¸»è¦æ¦‚å¿µå°è£… å¯¹è±¡çš„è¡Œä¸ºå¯¹äºŽå¤–éƒ¨æ˜¯ä¸å¯è§çš„ï¼Œæˆ–è€…è¯´å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯æ˜¯ç§å¯†çš„ å®¢æˆ·ç«¯ä¸èƒ½é€šè¿‡ç›´æŽ¥æ“ä½œæ¥æ”¹å˜å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚éœ€è¦é€šè¿‡å‘é€æ¶ˆæ¯æ¥è¯·æ±‚å¯¹è±¡æ”¹å˜å…¶å†…éƒ¨çŠ¶æ€ï¼Œå¯¹è±¡åˆ™æ ¹æ®è¯·æ±‚é€šè¿‡ç‰¹å®šçš„æˆå‘˜å‡½æ•°å®Œæˆå†…éƒ¨çŠ¶æ€çš„ä¿®æ”¹ åœ¨ Python ä¸­ï¼Œå°è£…çš„æ¦‚å¿µä¸æ˜¯éšå¼çš„ï¼Œå®ƒæ²¡æœ‰æä¾›å°è£…æ‰€éœ€çš„è¯¸å¦‚ publicã€private å’Œ protected ç­‰å…³é”®å­— å¤šæ€ å¤šæ€æœ‰ä¸¤ç§ç±»åž‹ã€‚å¯¹è±¡æ ¹æ®è¾“å…¥çš„å‚æ•°æä¾›æ–¹æ³•çš„ä¸åŒå®žçŽ°ï¼›ä¸åŒç±»åž‹çš„å¯¹è±¡å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŽ¥å£ å¯¹äºŽ Python è€Œè¨€ï¼Œå¤šæ€æ˜¯å†…ç½®åŠŸèƒ½ã€‚å¦‚æ“ä½œç¬¦ + æ—¢å¯ä»¥åº”ç”¨äºŽä¸¤ä¸ªæ•´æ•°è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œä¹Ÿå¯ä»¥åº”ç”¨äºŽå­—ç¬¦ä¸²ç”¨æ¥è¿žæŽ¥å®ƒä»¬ 12345&gt;&gt;&gt; a = "John"&gt;&gt;&gt; b = (1, 2, 3)&gt;&gt;&gt; c = [3, 4, 6, 8, 9]&gt;&gt;&gt; print(a[1], b[0], c[2])o 1 6 ç»§æ‰¿ è¡¨ç¤ºä¸€ä¸ªç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„ï¼ˆå¤§éƒ¨åˆ†ï¼‰åŠŸèƒ½ å¯ä»¥é‡ç”¨åŸºç±»ä¸­å®šä¹‰çš„åŠŸèƒ½å¹¶å…è®¸å­ç±»ç‹¬ç«‹åœ°è¿›è¡Œæ‰©å±• å¯ä»¥åˆ©ç”¨ä¸åŒç±»å¯¹è±¡ä¹‹é—´çš„å…³ç³»å»ºç«‹å±‚æ¬¡ç»“æž„ã€‚Python æ”¯æŒå¤šé‡ç»§æ‰¿ï¼ˆç»§æ‰¿å¤šä¸ªåŸºç±»ï¼‰ è®¾è®¡åŽŸåˆ™å¼€æ”¾/å°é—­åŽŸåˆ™ç±»æˆ–å¯¹è±¡åŠå…¶æ–¹æ³•å¯¹äºŽæ‰©å±•æ¥è¯´åº”è¯¥æ˜¯å¼€æ”¾çš„ï¼Œå¯¹äºŽä¿®æ”¹æ¥è¯´åº”è¯¥æ˜¯å°é—­çš„ã€‚å³åœ¨å¼€å‘è½¯ä»¶çš„æ—¶å€™ï¼Œä¸€å®šç¡®ä¿ä»¥é€šç”¨çš„æ–¹å¼æ¥ç¼–å†™ç±»æˆ–æ¨¡å—ï¼Œä»¥ä¾¿éœ€è¦æ‰©å±•ç±»æˆ–å¯¹è±¡è¡Œä¸ºçš„æ—¶å€™ä¸å¿…ä¿®æ”¹ç±»æœ¬èº«ã€‚ ä¼˜ç‚¹ï¼š çŽ°æœ‰çš„ç±»ä¸ä¼šè¢«ä¿®æ”¹ï¼Œé€€åŒ–çš„å¯èƒ½æ€§è¾ƒå° æœ‰åŠ©äºŽä¿æŒä»¥å‰ä»£ç çš„å‘åŽå…¼å®¹æ€§ æŽ§åˆ¶åè½¬åŽŸåˆ™é«˜å±‚çº§çš„æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºŽä½Žå±‚çº§çš„æ¨¡å—ï¼Œåº”è¯¥éƒ½ä¾èµ–äºŽæŠ½è±¡ã€‚ç»†èŠ‚ä¾èµ–äºŽæŠ½è±¡ï¼Œè€Œä¸æ˜¯æŠ½è±¡ä¾èµ–äºŽç»†èŠ‚ã€‚è¯¥åŽŸåˆ™å»ºè®®ä»»ä½•ä¸¤ä¸ªæ¨¡å—éƒ½ä¸åº”ä»¥ç´§å¯†æ–¹å¼ç›¸äº’ä¾èµ–ã€‚åŸºæœ¬æ¨¡å—å’Œä»Žå±žæ¨¡å—åº”å½“åœ¨å®ƒä»¬ä¹‹é—´æä¾›ä¸€ä¸ªæŠ½è±¡å±‚æ¥è€¦åˆã€‚ç±»çš„ç»†èŠ‚åº”æç»˜æŠ½è±¡ã€‚ ä¼˜ç‚¹ï¼š å‰Šå¼±äº†æ¨¡å—é—´çš„ç´§è€¦åˆï¼Œæ¶ˆé™¤äº†ç³»ç»Ÿä¸­çš„å¤æ‚æ€§å’Œåˆšæ€§ åœ¨ä¾èµ–æ¨¡å—ä¹‹é—´æœ‰ä¸€ä¸ªæ˜Žç¡®çš„æŠ½è±¡å±‚ï¼Œä¾¿äºŽé€šè¿‡æ›´å¥½çš„æ–¹å¼å¤„ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³» æŽ¥å£éš”ç¦»åŽŸåˆ™å®¢æˆ·ç«¯ä¸åº”ä¾èµ–äºŽå®ƒä»¬ä¸éœ€è¦ä½¿ç”¨çš„æŽ¥å£ã€‚ ä¼˜ç‚¹ï¼š å¼ºåˆ¶å¼€å‘äººå‘˜ç¼–å†™â€œç˜¦èº«åž‹â€æŽ¥å£ï¼Œå¹¶ä½¿æ–¹æ³•ä¸ŽæŽ¥å£ç´§å¯†ç›¸å…³ é˜²æ­¢å‘æŽ¥å£ä¸­éšæ„æ·»åŠ æ–¹æ³• å•ä¸€èŒè´£åŽŸåˆ™ç±»çš„èŒè´£å•ä¸€ï¼Œå¼•èµ·ç±»å˜åŒ–çš„åŽŸå› å•ä¸€ã€‚å½“æˆ‘ä»¬åœ¨å¼€å‘ç±»æ—¶ï¼Œå®ƒåº”è¯¥ä¸ºç‰¹å®šçš„åŠŸèƒ½æœåŠ¡ã€‚è‹¥ä¸€ä¸ªç±»å®žçŽ°äº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œåˆ™æœ€å¥½å°†å®ƒä»¬åˆ†å¼€ã€‚ ä¼˜ç‚¹ï¼š æ¯å½“ä¸€ä¸ªåŠŸèƒ½å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé™¤äº†ç‰¹å®šçš„ç±»éœ€è¦æ”¹å˜å¤–ï¼Œå…¶ä»–ç±»æ— éœ€å˜åŠ¨ è‹¥ä¸€ä¸ªç±»æœ‰å¤šç§åŠŸèƒ½ï¼Œé‚£ä¹ˆä¾èµ–å®ƒçš„ç±»å¿…å®šä¼šç”±äºŽå¤šç§åŽŸå› ç»åŽ†å¤šæ¬¡ä¿®æ”¹ã€‚è¿™æ˜¯åº”è¯¥é¿å…çš„ æ›¿æ¢åŽŸåˆ™æ´¾ç”Ÿç±»å¿…é¡»èƒ½å¤Ÿå®Œå…¨å–ä»£åŸºç±»ã€‚å½“åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ç¼–å†™æ´¾ç”Ÿç±»æ—¶ï¼Œè¯¥åŽŸåˆ™çš„å«ä¹‰å°±æ˜¯ä»–ä»¬åº”è¯¥æ‰©å±•åŸºç±»ã€‚æ­¤å¤–ï¼Œæ´¾ç”Ÿç±»åº”è¯¥å°½å¯èƒ½å¯¹åŸºç±»å°é—­ï¼Œä»¥è‡´äºŽæ´¾ç”Ÿç±»æœ¬èº«å¯ä»¥æ›¿æ¢åŸºç±»è€Œæ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç ã€‚]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Object</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è®¾è®¡æ¨¡å¼â€”â€”MVCæ¨¡å¼]]></title>
    <url>%2F2020%2F01%2F06%2Fpython-design-patterns-mvc-pattern%2F</url>
    <content type="text"><![CDATA[æ¨¡åž‹ - è§†å›¾ - æŽ§åˆ¶å™¨æ¨¡å¼MVC ä¸ä»…ä»…æ˜¯ä¸€ç§å®žçŽ°ç”¨æˆ·ç•Œé¢çš„è½¯ä»¶æ¨¡å¼ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§æ˜“äºŽä¿®æ”¹å’Œç»´æŠ¤çš„æž¶æž„ã€‚é€šå¸¸ MVC æ¨¡å¼å°†åº”ç”¨ç¨‹åºåˆ†ä¸º 3 ä¸ªåŸºæœ¬éƒ¨åˆ†ï¼šæ¨¡åž‹ï¼ˆModelï¼‰ã€è§†å›¾ï¼ˆViewï¼‰å’ŒæŽ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€‚è¿™ 3 ä¸ªéƒ¨åˆ†ç›¸äº’å…³è”ï¼Œæœ‰åŠ©äºŽå°†ä¿¡æ¯çš„å¤„ç†ä¸Žä¿¡æ¯çš„å‘ˆçŽ°åˆ†å¼€ã€‚ MVC æ¨¡å¼çš„å·¥ä½œæœºåˆ¶ä¸ºï¼šæ¨¡åž‹æä¾›æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ä½•å­˜å‚¨å’ŒæŸ¥è¯¢ä¿¡æ¯ï¼‰ï¼Œè§†å›¾è´Ÿè´£æ•°æ®çš„å±•ç¤ºï¼ˆå¦‚ä½•å‘ˆçŽ°ï¼‰ï¼Œè€ŒæŽ§åˆ¶å™¨åˆ™æ˜¯ä¸¤è€…ä¹‹é—´çš„ç²˜åˆå‰‚ï¼Œæ ¹æ®ç”¨æˆ·è¦æ±‚çš„å‘ˆçŽ°æ–¹å¼åè°ƒæ¨¡åž‹å’Œè§†å›¾ã€‚è§†å›¾å’ŒæŽ§åˆ¶å™¨ä¾èµ–äºŽæ¨¡åž‹ï¼Œä½†æ¨¡åž‹æ˜¯å¯ä»¥ç‹¬ç«‹å·¥ä½œçš„ã€‚ æ¨¡åž‹ï¼šå®šä¹‰é’ˆå¯¹æ•°æ®çš„æ‰€æœ‰æ“ä½œï¼ˆå¦‚åˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤ç­‰ï¼‰ï¼Œå¹¶æä¾›ä¸Žæ•°æ®ä½¿ç”¨æœ‰å…³çš„æ–¹æ³• è§†å›¾ï¼šæä¾›ç›¸åº”çš„æ–¹æ³•ï¼Œå¸®åŠ©æ ¹æ®ä¸Šä¸‹æ–‡å’Œåº”ç”¨ç¨‹åºçš„éœ€è¦æž„å»º Web æˆ– GUI ç•Œé¢ æŽ§åˆ¶å™¨ï¼šä»Žè¯·æ±‚æŽ¥æ”¶æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ã€‚éœ€è¦æä¾›ç”¨äºŽè·¯ç”±è¯·æ±‚çš„æ–¹æ³• MVC æ¨¡å¼çš„ä¸»è¦æ„å›¾ï¼š å°†æ•°æ®å’Œæ•°æ®çš„å±•ç¤ºéš”ç¦»å¼€ ä½¿ç±»çš„ç»´æŠ¤å’Œå®žçŽ°æ›´åŠ ç®€å• çµæ´»åœ°æ”¹å˜æ•°æ®çš„å­˜å‚¨å’Œæ˜¾ç¤ºæ–¹å¼ï¼Œä¸¤è€…ç›¸äº’ç‹¬ç«‹ æ¨¡åž‹æ˜¯åº”ç”¨ç¨‹åºçš„åŸºçŸ³ï¼Œæä¾›å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®ï¼Œå¿…é¡»åœ¨å¤šä¸ªæ“ä½œä¸­ä¿æŒä¸€è‡´ã€‚è§†å›¾ç”¨æ¥å°†æ•°æ®å±•ç¤ºåœ¨æŽ¥å£ä¸Šä¾›ç”¨æˆ·æŸ¥çœ‹ã€‚å¯ä»¥ç‹¬ç«‹å¼€å‘ï¼Œä½†ä¸åº”åŒ…å«å¤æ‚çš„é€»è¾‘ï¼›éœ€è¦è¶³å¤Ÿçµæ´»ï¼Œé€‚åº”å¤šç§å¹³å°ï¼›åº”é¿å…ä¸Žæ•°æ®åº“ç›´æŽ¥äº¤äº’ã€‚æŽ§åˆ¶å™¨åº”è¯¥ä½œä¸ºæ¨¡åž‹å’Œè§†å›¾ä¹‹é—´çš„ç²˜åˆå‰‚ï¼Œè¦å°½å¯èƒ½è–„ï¼›ä¸åº”è¯¥è¿›è¡Œæ•°æ®åº“è°ƒç”¨æˆ–å‚ä¸Žæ•°æ®çš„å±•ç¤ºã€‚ ç¤ºä¾‹ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849class Model: services = &#123; 'email': &#123;'number': 1000, 'price': 2&#125;, 'sms': &#123;'number': 1000, 'price': 10&#125;, 'voice': &#123;'number': 1000, 'price': 15&#125; &#125;class View: def list_services(self, services): for svc in services: print(svc, ' ') def list_pricing(self, services): for svc in services: print("For", Model.services[svc]['number'], svc, 'message you pay $', Model.services[svc]['price'])class Controller: def __init__(self): self.model = Model() self.view = View() def get_services(self): services = self.model.services.keys() return (self.view.list_services(services)) def get_pricing(self): services = self.model.services.keys() return (self.view.list_pricing(services))if __name__ == '__main__': controller = Controller() print("Services Provided:") controller.get_services() print("Pricing for Services:") controller.get_pricing()# =&gt; Services Provided:# =&gt; email# =&gt; sms# =&gt; voice# =&gt; Pricing for Services:# =&gt; For 1000 email message you pay $ 2# =&gt; For 1000 sms message you pay $ 10# =&gt; For 1000 voice message you pay $ 15 çŽ°å®žä¸–ç•Œä¸­çš„ MVC æ¨¡å¼ç›®å½•ç»“æž„ï¼š123456mvcâ”œâ”€â”€ server.pyâ””â”€â”€ templates â”œâ”€â”€ base.html â”œâ”€â”€ index.html â””â”€â”€ new.html server.py æºä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374import tornadoimport tornado.webimport tornado.ioloopimport tornado.httpserverimport sqlite3def _execute(sql): db = sqlite3.connect('sqlite3.db') cursor = db.cursor() cursor.execute(sql) res = cursor.fetchall() db.commit() db.close() return resclass IndexHandler(tornado.web.RequestHandler): def get(self): query = "select * from task;" todos = _execute(query) print(todos) self.render('index.html', todos=todos)class NewHandler(tornado.web.RequestHandler): def post(self): name = self.get_argument('name', None) query = "create table if not exists task (id INTEGER \ PRIMARY KEY, name TEXT, status NUMERIC);" _execute(query) query = "insert into task (name, status) values ('%s', %d);" % (name, 1) _execute(query) self.redirect('/') def get(self): self.render('new.html')class UpdateHandler(tornado.web.RequestHandler): def get(self, id, status): query = "update task set status=%d where \ id=%s;" % (int(status), id) _execute(query) print(query) self.redirect('/')class DeleteHandler(tornado.web.RequestHandler): def get(self, id): query = "delete from task where id=%s;" % id _execute(query) self.redirect('/')class RunApp(tornado.web.Application): def __init__(self): Handlers = [ (r'/', IndexHandler), (r'/todo/new', NewHandler), (r'/todo/update/(\d+)/(\d+)', UpdateHandler), (r'/todo/delete/(\d+)', DeleteHandler), ] settings = dict( debug=True, template_path='templates', static_path='static', ) tornado.web.Application.__init__(self, Handlers, **settings)if __name__ == '__main__': http_server = tornado.httpserver.HTTPServer(RunApp()) http_server.listen(5000) tornado.ioloop.IOLoop.instance().start() templates/base.html æºä»£ç ï¼š123456789&lt;!DOCTYPE&gt;&lt;html&gt; &lt;head&gt; &#123;% block header %&#125;&#123;% end%&#125; &lt;/head&gt; &lt;body&gt; &#123;% block body %&#125;&#123;% end %&#125; &lt;/body&gt;&lt;/html&gt; templates/index.html æºä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435&#123;% extends 'base.html' %&#125;&lt;title&gt;ToDo&lt;/title&gt;&#123;% block body %&#125;&lt;h3&gt;Your Tasks&lt;/h3&gt;&lt;table border="1"&gt; &lt;tr align="center"&gt; &lt;td&gt;Id&lt;/td&gt; &lt;td&gt;Name&lt;/td&gt; &lt;td&gt;Status&lt;/td&gt; &lt;td&gt;Update&lt;/td&gt; &lt;td&gt;Delete&lt;/td&gt; &lt;/tr&gt; &#123;% for todo in todos %&#125; &lt;tr align="center"&gt; &lt;td&gt;&#123;&#123; todo[0] &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; todo[1] &#125;&#125;&lt;/td&gt; &#123;% if todo[2] %&#125; &lt;td&gt;Open&lt;/td&gt; &#123;% else %&#125; &lt;td&gt;Closed&lt;/td&gt; &#123;% end %&#125; &#123;% if todo[2] %&#125; &lt;td&gt;&lt;a href="/todo/update/&#123;&#123;todo[0]&#125;&#125;/0"&gt;Close Task&lt;/a&gt;&lt;/td&gt; &#123;% else %&#125; &lt;td&gt;&lt;a href="/todo/update/&#123;&#123;todo[0]&#125;&#125;/1"&gt;Open Task&lt;/a&gt;&lt;/td&gt; &#123;% end %&#125; &lt;td&gt;&lt;a href="/todo/delete/&#123;&#123;todo[0]&#125;&#125;"&gt;X&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; &#123;% end %&#125;&lt;/table&gt;&lt;div&gt; &lt;h3&gt;&lt;a href="/todo/new"&gt;Add Task&lt;/a&gt;&lt;/h3&gt;&lt;/div&gt;&#123;% end %&#125; templates/new.html æºä»£ç ï¼š1234567891011&#123;% extends 'base.html' %&#125;&lt;title&gt;ToDo&lt;/title&gt;&#123;% block body %&#125;&lt;div&gt; &lt;h3&gt;Add Task to your List&lt;/h3&gt; &lt;form action="/todo/new" method="post" id="new"&gt; &lt;p&gt;&lt;input type="text" name="name" placeholder="Enter task" /&gt; &lt;input type="submit" class="submit" value="add" /&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt;&#123;% end %&#125; è¿è¡Œ python server.py å‘½ä»¤ï¼Œæµè§ˆ http://localhost:5000/ ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š PSï¼šéœ€å®‰è£… tornado æ¨¡å—ï¼ˆpip install tornadoï¼‰]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>OOP</tag>
        <tag>Design</tag>
        <tag>Pattern</tag>
        <tag>MVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºæœ¬ç®—æ³•é—®é¢˜çš„ Python è§£æ³•ï¼ˆé€’å½’ä¸Žæœç´¢ï¼‰]]></title>
    <url>%2F2020%2F01%2F05%2Fclassic-compute-problems-with-python%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æ–æ³¢é‚£å¥‘æ•°åˆ—é€’å½’å‡½æ•°123456789def fib(n: int) -&gt; int: if n &lt; 2: return n return fib(n - 2) + fib(n - 1)if __name__ == '__main__': for i in range(10): print(fib(i), end=' ')# =&gt; 0 1 1 2 3 5 8 13 21 34 ä¸è¦å°è¯•è°ƒç”¨ fib(50)ï¼ˆè¿™ä¸ªæˆ‘è¯•è¿‡äº†ï¼Œå› ä¸ºç­‰å¾—ä¸è€çƒ¦ Ctrl+C æŽ‰äº†ï¼‰ã€‚åœ¨ä¸Šé¢ç‰ˆæœ¬çš„ç¨‹åºä¸­ï¼Œæ¯æ¬¡å¯¹ fib() å‡½æ•°çš„è°ƒç”¨éƒ½ä¼šå¯¼è‡´é¢å¤–çš„ä¸¤æ¬¡å¯¹ fib() è‡ªèº«çš„è°ƒç”¨ï¼ˆå³ fib(n -2) å’Œ fib(n - 1)ï¼‰ã€‚è¿™ä¸ªè¡Œä¸ºæ¨¡å¼ä¼šä¸€ç›´ä¼ é€’ä¸‹åŽ»ï¼Œç›´åˆ°æ¯ä¸€ä¸ªæ–°çš„è°ƒç”¨åˆ†æ”¯éƒ½æ»¡è¶³ n &lt; 2ã€‚æ¯”å¦‚ fib(4) æœ€ç»ˆä¼šæ‰§è¡Œä»¥ä¸‹å‡½æ•°ï¼š123456789fib(4) -&gt; fib(3), fib(2)fib(3) -&gt; fib(2), fib(1)fib(2) -&gt; fib(1), fib(0)fib(2) -&gt; fib(1), fib(0)fib(1) -&gt; 1fib(1) -&gt; 1fib(1) -&gt; 1fib(0) -&gt; 0fib(0) -&gt; 0 è®¡ç®— fib(4) æœ€ç»ˆä¼šè°ƒç”¨ 9 æ¬¡ fib() å‡½æ•°ï¼Œfib(5) è°ƒç”¨ 15 æ¬¡ï¼Œfib(10) è°ƒç”¨ 177 æ¬¡ï¼Œè®¡ç®— fib(20) åˆ™éœ€è¦æ‰§è¡Œæ•´æ•´ 21891 æ¬¡ã€‚æ¢å¥è¯è¯´ï¼Œå‡½æ•°çš„è°ƒç”¨æ ‘ä¼šä»¥æŒ‡æ•°çº§çš„é€Ÿåº¦æ‰©å±•ã€‚ MemoizationMemoization æ˜¯æŒ‡å°†è®¡ç®—ä»»åŠ¡æ‰§è¡ŒåŽå¾—åˆ°çš„ç»“æžœä¿å­˜åœ¨æŸä¸ªåœ°æ–¹ï¼ŒåŽé¢éœ€è¦ç”¨åˆ°æ—¶å°±å¯ä»¥ç›´æŽ¥å–å‡ºä½¿ç”¨ï¼Œè€Œä¸å¿…å†æ¬¡è®¡ç®—ã€‚1234567891011from typing import Dictmemo: Dict[int, int] = &#123;0: 0, 1: 1&#125; # base casesdef fib2(n: int) -&gt; int: if n not in memo: memo[n] = fib2(n -1) + fib2(n - 2) # memoization return memo[n]if __name__ == '__main__': print(fib2(50))# =&gt; 12586269025 lru_cachePython æä¾›äº†ä¸€ä¸ªå†…ç½®çš„è£…é¥°å™¨ ``@functools.lru_cache()ç”¨æ¥è‡ªåŠ¨è®°å½•ï¼ˆç¼“å­˜ï¼‰æŸä¸ªå‡½æ•°çš„æ‰§è¡Œç»“æžœã€‚å› æ­¤ä¸Šé¢çš„fib2() å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š1234567891011from functools import lru_cache@lru_cache(maxsize=None)def fib3(n: int) -&gt; int: if n &lt; 2: return n return fib3(n - 2) + fib3(n - 1)if __name__ == '__main__': print(fib3(50))# =&gt; 12586269025 è¿­ä»£å¼æ–¹æ¡ˆ1234567891011def fib4(n: int) -&gt; int: if n == 0: return n last: int = 0 next: int = 1 for _ in range(1, n): last, next = next, last + next return nextif __name__== '__main__': print(fib4(50))# =&gt; 12586269025 ä¸Šé¢çš„ç¨‹åºç®—æ˜¯è¿™å‡ ä¸ªæ–¹æ¡ˆä¸­æ€§èƒ½æœ€å¥½çš„ä¸€ä¸ªï¼Œfor å¾ªçŽ¯æœ€å¤šåªæ‰§è¡Œ n-1 æ¬¡ã€‚é€’å½’å¼æ–¹æ¡ˆå€ŸåŠ©é€†å‘æ€ç»´ï¼Œè€Œè¿­ä»£å¼æ–¹æ¡ˆåˆ™æ˜¯æ­£å‘çš„é€»è¾‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒåŽŸå§‹çš„é€’å½’è®¡ç®—æ–¹å¼ä¼šå¸¦æ¥è¿‡å¤šçš„æ€§èƒ½æ¶ˆè€—ã€‚ä½†æ˜¯ä»»ä½•å¯ä»¥é€šè¿‡é€’å½’è®¡ç®—è§£å†³çš„é—®é¢˜ï¼ŒåŒæ ·å¯ä»¥ç”¨è¿­ä»£çš„æ–¹å¼è§£å†³ã€‚ ç”Ÿæˆå™¨123456789101112131415from typing import Generatordef fib5(n: int) -&gt; Generator[int, None, None]: yield 0 if n &gt; 0: yield 1 last: int = 0 next: int = 1 for _ in range(1, n): last, next = next, last + next yield nextif __name__ == '__main__': for i in fib5(50): print(i, end=' ')# =&gt; 0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025 äºŒã€æ±‰è¯ºå¡”é—®é¢˜å…³äºŽæ±‰è¯ºå¡”é—®é¢˜çš„ç®€å•æè¿°ï¼š æœ‰ä¸‰æ ¹æŸ±å­ï¼ŒæŸ±å­ A ä¸Šæ‘žæœ‰ n ä¸ªä¸åŒå¤§å°çš„åœ†ç›˜ï¼Œéœ€è¦å°†æ‰€æœ‰åœ†ç›˜å€ŸåŠ©æŸ±å­ B è½¬ç§»åˆ°æŸ±å­ C æ¯æ¬¡åªèƒ½è½¬ç§»ä¸€ä¸ªåœ†ç›˜ å¤§çš„åœ†ç›˜å¿…é¡»æ”¾ç½®åœ¨å°çš„åœ†ç›˜ä¸‹é¢ é€’å½’è§£æ³•çš„é€»è¾‘å¦‚ä¸‹ï¼š åˆ©ç”¨ C ä½œä¸­è½¬ï¼Œç§»åŠ¨ A é¡¶éƒ¨çš„ n-1 ä¸ªåœ†ç›˜åˆ°æŸ±å­ B ç§»åŠ¨ A åº•éƒ¨å‰©ä¸‹çš„æœ€å¤§å·åœ†ç›˜åˆ°æŸ±å­ C åˆ©ç”¨ A ä½œä¸­è½¬ï¼Œç§»åŠ¨ B ä¸Šçš„ n-1 ä¸ªåœ†ç›˜åˆ°æŸ±å­ Cï¼ˆæ­¤æ—¶é—®é¢˜ç”±æœ€åˆçš„å°† n ä¸ªåœ†ç›˜ä»Ž A è½¬ç§»åˆ° Cï¼Œå˜æˆå°† n-1 ä¸ªåœ†ç›˜ä»Ž B è½¬ç§»åˆ° Cï¼‰ é‡å¤ä»¥ä¸Šæ­¥éª¤ å®žçŽ°ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738from typing import TypeVar, Generic, ListT = TypeVar('T')class Stack(Generic[T]): def __init__(self) -&gt; None: self._container: List[T] = [] def push(self, item: T) -&gt; None: self._container.append(item) def pop(self) -&gt; T: return self._container.pop() def __repr__(self) -&gt; str: return repr(self._container)def hanobi(begin: Stack[int], end: Stack[int], temp: Stack[int], n: int) -&gt; None: if n == 1: end.push(begin.pop()) else: hanobi(begin, temp, end, n - 1) hanobi(begin, end, temp, 1) hanobi(temp, end, begin, n - 1)if __name__ == '__main__': num_discs: int = 10 tower_a: Stack[int] = Stack() tower_b: Stack[int] = Stack() tower_c: Stack[int] = Stack() for i in range(1, num_discs + 1): tower_a.push(i) hanobi(tower_a, tower_c, tower_b, num_discs) print(tower_a) # [] print(tower_b) # [] print(tower_c) # [1, 2, 3] è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºç¨‹åºï¼ŒStack ç±»æŠ½è±¡å‡ºå•æ ¹æŸ±å­ä¸Žåœ†ç›˜çš„æ¨¡åž‹ï¼Œhanobi å‡½æ•°åˆ™ä»¥é€’å½’çš„æ–¹å¼å®šä¹‰äº†åœ†ç›˜ç§»åŠ¨çš„è¿‡ç¨‹ã€‚å¦‚æžœæ˜¯çœŸäººæ¥æ“ä½œçš„è¯ï¼Œæ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜èŠ±è´¹ 1 ç§’é’Ÿæ—¶é—´ã€‚è§£å†³ç”± 50 ä¸ªåœ†ç›˜ç»„æˆçš„æ±‰è¯ºå¡”é—®é¢˜ï¼Œå…±éœ€è¦è€—è´¹å¤šé•¿æ—¶é—´ï¼Ÿçº¦ç­‰äºŽ 3570.2 ä¸‡å¹´ã€‚ ä¸‰ã€DNA æ£€ç´¢åœ¨è®¡ç®—æœºè½¯ä»¶ä¸­ï¼ŒåŸºå› ï¼ˆGeneï¼‰ä¸€èˆ¬é€šè¿‡ç”± Aã€Cã€Gã€T ç»„æˆçš„å­—ç¬¦åºåˆ—è¡¨ç¤ºã€‚å…¶ä¸­æ¯ä¸ªå­—ç¬¦ä»£è¡¨ä¸€ä¸ªæ ¸è‹·é…¸ï¼ˆnucleotideï¼‰ï¼Œæ¯ç›¸é‚»çš„ä¸‰ä¸ªæ ¸è‹·é…¸ï¼ˆç¢±åŸºï¼‰ç»„æˆä¸€ä¸ªå¯†ç å­ï¼ˆcodonï¼‰ã€‚ åŸºå› çš„æ•°æ®æ¨¡åž‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940from enum import IntEnumfrom typing import Tuple, ListNucleotide: IntEnum = IntEnum('Nucleotide', ('A', 'C', 'G', 'T'))Codon = Tuple[Nucleotide, Nucleotide, Nucleotide]Gene = List[Codon]def string_to_gene(s: str) -&gt; Gene: gene: Gene = [] for i in range(0, len(s), 3): if (i + 2) &gt;= len(s): return gene codon: Codon = (Nucleotide[s[i]], Nucleotide[s[i + 1]], Nucleotide[s[i + 2]]) gene.append(codon) return genegene_str: str = "ACGTGGCTCTCTAACGTACGTACGTACGGGGTTTATATATACCCTAGGACTCCCTTT"my_gene: Gene = string_to_gene(gene_str)for conda in my_gene: print(conda)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)# =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.C: 2&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)# =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;)# =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.G: 3&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)# =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)# =&gt; (&lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;)# =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.G: 3&gt;, &lt;Nucleotide.G: 3&gt;)# =&gt; (&lt;Nucleotide.A: 1&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.T: 4&gt;)# =&gt; (&lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;, &lt;Nucleotide.C: 2&gt;)# =&gt; (&lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;, &lt;Nucleotide.T: 4&gt;) Linear searchçº¿æ€§æœç´¢ä¼šæŒ‰ç…§åŽŸå§‹æ•°æ®ç»“æž„ä¸­çš„å…ƒç´ æŽ’åˆ—é¡ºåºï¼Œé€ä¸ªæ£€æŸ¥æœç´¢ç©ºé—´ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ˜¯æœ€ç®€å•ç›´è§‚çš„æœç´¢æ–¹å¼ï¼Œå¤æ‚åº¦ä¸º O(n)ã€‚12345678910def linear_contains(gene: Gene, key_codon: Codon) -&gt; bool: for codon in gene: if codon == key_codon: return True return Falseacg: Codon = (Nucleotide.A, Nucleotide.C, Nucleotide.G)gat: Codon = (Nucleotide.G, Nucleotide.A, Nucleotide.T)print(linear_contains(my_gene, acg)) # Trueprint(linear_contains(my_gene, gat)) # False Binary search12345678910111213141516def binary_contains(gene: Gene, key_codon: Codon) -&gt; bool: low: int = 0 high: int = len(gene) - 1 while low &lt;= high: mid: int = (low + high) if gene[mid] &lt; key_codon: low = mid + 1 elif gene[mid] &gt; key_codon: high = mid - 1 else: return True return Falsemy_sorted_gene: Gene = sorted(my_gene)print(binary_contains(my_sorted_gene, acg))print(binary_contains(my_sorted_gene, gat)) Binary Search å°†æœç´¢å¯¹è±¡ä¸Žæœ‰åºåˆ—è¡¨ä¸­é—´ä½ç½®çš„å€¼è¿›è¡Œæ¯”å¯¹ï¼Œæ ¹æ®å¤§å°å…³ç³»ç¡®å®šä¸‹ä¸€æ¬¡æœç´¢åœ¨åºåˆ—çš„å‰åŠæˆ–è€…åŽåŠéƒ¨åˆ†ç»§ç»­è¿›è¡Œã€‚ä¾ç…§æ­¤è§„åˆ™æŒç»­è¿›è¡Œæ£€ç´¢ï¼Œæ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½ä¼šå°†ä¸‹ä¸€æ¬¡çš„æœç´¢ç©ºé—´å‡å°ä¸€åŠï¼ˆç±»ä¼¼çŒœæ•°å­—æ¸¸æˆï¼‰ã€‚ Binary Search åœ¨æœ€åæƒ…å†µä¸‹çš„å¤æ‚åº¦ä¸º O(lg n)ï¼Œå‰ææ˜¯åºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ å·²ç»æ ¹æ®å¤§å°æŽ’åºã€‚æœ€å¥½çš„æŽ’åºç®—æ³•å¤æ‚åº¦ä¸º O(n lg n)ã€‚å› æ­¤åœ¨éœ€è¦å¯¹æ— åºåˆ—è¡¨æ‰§è¡Œå¤šæ¬¡æœç´¢çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥å…ˆå¯¹åˆ—è¡¨å…ƒç´ æŽ’åºå†æ‰§è¡Œ Binary Searchã€‚ é€šç”¨ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# generic_search.pyfrom typing import TypeVar, Iterable, Sequence, Generic, List, Callable, Set, Deque, Dict, Any, Optionalfrom typing import Protocolfrom heapq import heappush, heappopT = TypeVar('T')def linear_contains(iterable: Iterable[T], key: T) -&gt; bool: for item in iterable: if item == key: return True return FalseC = TypeVar("C", bound="Comparable")class Comparable(Protocol): def __eq__(self, other: Any) -&gt; bool: return self == other def __lt__(self, other: C) -&gt; bool: return self &lt; other def __gt__(self: C, other: C) -&gt; bool: return (not self &lt; other) and self != other def __le__(self: C, other: C) -&gt; bool: return self &lt; other or self == other def __ge__(self: C, other: C) -&gt; bool: return not self &lt; otherdef binary_contains(sequence: Sequence[C], key: C) -&gt; bool: low: int = 0 high: int = len(sequence) - 1 while low &lt;= high: mid: int = (low + high) // 2 if sequence[mid] &lt; key: low = mid + 1 elif sequence[mid] &gt; key: high = mid - 1 else: return True return Falseif __name__ == '__main__': print(linear_contains([1, 5, 15, 15, 15, 15, 20], 5)) print(binary_contains(["a", "d", "e", "f", "z"], "f")) print(binary_contains(["join", "mark", "ronald", "sarah"], "sheila")) å››ã€è¿·å®«é—®é¢˜è¿·å®«å»ºæ¨¡ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# maze.pyfrom enum import Enumfrom typing import List, NamedTuple, Callable, Optionalimport randomfrom math import sqrtclass Cell(str, Enum): EMPTY = " " BLOCKED = "X" START = "S" GOAL = "G" PATH = "*"class MazeLocation(NamedTuple): row: int column: intclass Maze: def __init__(self, rows: int = 10, columns: int = 10, sparseness: float = 0.2, start: MazeLocation = MazeLocation(0, 0), goal: MazeLocation = MazeLocation(9, 9)) -&gt; None: self._rows: int = rows self._columns: int = columns self.start: MazeLocation = start self.goal: MazeLocation = goal self._grid: List[List[Cell]] = [[Cell.EMPTY for c in range(columns)] for r in range(rows)] self._randomly_fill(rows, columns, sparseness) self._grid[start.row][start.column] = Cell.START self._grid[goal.row][goal.column] = Cell.GOAL def _randomly_fill(self, rows: int, columns: int, sparseness: float): for row in range(rows): for column in range(columns): if random.uniform(0, 1.0) &lt; sparseness: self._grid[row][column] = Cell.BLOCKED def __str__(self) -&gt; str: output: str = "" for row in self._grid: output += "".join([c.value for c in row]) + "\n" return outputmaze: Maze = Maze()print(maze) 12345678910SX X X XX X X X X XXX X X X X XXX X X G ä¸º Maze ç±»åˆ›å»ºå¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼Œgoal_test ç”¨äºŽç¡®å®šå½“å‰ Cell æ˜¯å¦ä¸ºç›®æ ‡åœ°ç‚¹ï¼›successors ç”¨äºŽåˆ¤æ–­ä¸Žå½“å‰ Cell ç›¸é‚»çš„å“ªäº› Cell å¯ä»¥ä½œä¸ºä¸‹ä¸€æ­¥çš„è½è„šç‚¹ï¼Œè¿”å›žå…¶åˆ—è¡¨ï¼š123456789101112131415# maze.py continued def goal_test(self, ml: MazeLocation) -&gt; bool: return ml == self.goal def successors(self, ml: MazeLocation) -&gt; List[MazeLocation]: locations: List[MazeLocation] = [] if ml.row + 1 &lt; self._rows and self._grid[ml.row + 1][ml.column] != Cell.BLOCKED: locations.append(MazeLocation(ml.row + 1, ml.column)) if ml.row - 1 &gt;= 0 and self._grid[ml.row - 1][ml.column] != Cell.BLOCKED: locations.append(MazeLocation(ml.row - 1, ml.column)) if ml.column + 1 &lt; self._columns and self._grid[ml.row][ml.column + 1] != Cell.BLOCKED: locations.append(MazeLocation(ml.row, ml.column + 1)) if ml.column - 1 &gt;= 0 and self._grid[ml.row][ml.column - 1] != Cell.BLOCKED: locations.append(MazeLocation(ml.row, ml.column - 1)) return locations DFSï¼ˆdepth-first searchï¼‰ç®—æ³•æˆ‘ç†è§£çš„ DFS ç®—æ³•ï¼Œå°±æ˜¯â€œä¸€æ¡é“å„¿èµ°åˆ°é»‘â€ã€‚åªè¦å½“å‰çš„è·¯å¾„èƒ½èµ°é€šå°±ä¸€ç›´èµ°ä¸‹åŽ»ï¼Œä¸åŽ»è€ƒè™‘é€”ä¸­å…¶ä»–å¯èƒ½çš„æ–¹æ¡ˆã€‚ä¸€æ—¦é‡åˆ°éšœç¢èµ°å…¥â€œæ­»èƒ¡åŒâ€ï¼Œåˆ™å›žé€€åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹å°è¯•ä¹‹å‰æœªé€‰æ‹©çš„è·¯å¾„ã€‚æœ€ç»ˆåˆ°è¾¾ç›®æ ‡åœ°ç‚¹åŽåœæ­¢ï¼Œæˆ–è€…ä¸€è·¯å›žé€€åˆ°èµ·ç‚¹ï¼Œåˆ™è¯æ˜Žä¸å­˜åœ¨å¯è¡Œçš„æ–¹æ¡ˆã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061# generic_search.py continuedclass Stack(Generic[T]): def __init__(self) -&gt; None: self._container: List[T] = [] @property def empty(self) -&gt; bool: return not self._container # not is true for empty container def push(self, item: T) -&gt; None: self._container.append(item) def pop(self) -&gt; T: return self._container.pop() # LIFO def __repr__(self) -&gt; str: return repr(self._container)class Node(Generic[T]): def __init__(self, state: T, parent: Optional[Node], cost: float = 0.0, heuristic: float = 0.0) -&gt; None: self.state: T = state self.parent: Optional[Node] = parent self.cost: float = cost self.heuristic: float = heuristic def __lt__(self, other: Node) -&gt; bool: return (self.cost + self.heuristic) &lt; (other.cost + other.heuristic)def dfs(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]]) -&gt; Optional[Node[T]]: # frontier is where we've yet to go frontier: Stack[Node[T]] = Stack() frontier.push(Node(initial, None)) # explored is where we've been explored: Set[T] = &#123;initial&#125; # keep going while there is more to explore while not frontier.empty: current_node: Node[T] = frontier.pop() current_state: T = current_node.state # if we found the goal, we're done if goal_test(current_state): return current_node # check where we can go next and haven't explored for child in successors(current_state): if child in explored: # skip children we already explored continue explored.add(child) frontier.push(Node(child, current_node)) return None # went through everything and never found goaldef node_to_path(node: Node[T]) -&gt; List[T]: path: List[T] = [node.state] # work backwards from end to front while node.parent is not None: node = node.parent path.append(node.state) path.reverse() return path å…¶ä¸­ Node ç±»å¯ä»¥ç®—ä½œ MazeLocation ä¸Šçš„åˆä¸€å±‚å°è£…ï¼Œä¸ºå…¶æ·»åŠ  parent-child å…³ç³»æ–¹ä¾¿åŽç»­è¿žæŽ¥ä¸ºè·¯å¾„ã€‚å…¶ cost å’Œ heuristic å±žæ€§ä¼šåœ¨åŽé¢çš„ A* ç®—æ³•ä¸­ç”¨åˆ°ã€‚ dfs å‡½æ•°ä¸­çš„ frontier ä½¿ç”¨ Stack æ•°æ®ç»“æž„è®°å½•æ¯ä¸€æ­¥é€‰æ‹©ä¸­å‡ºçŽ°çš„å¯è¡Œè·¯å¾„èŠ‚ç‚¹ï¼Œå…¶ pop æ–¹æ³•ç”¨äºŽå›žæº¯åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚è‹¥ frontier ä¸ºç©ºåˆ™è¯´æ˜Žå·²å›žæº¯åˆ°èµ·ç‚¹ï¼Œæœªæ‰¾åˆ°åˆé€‚è·¯å¾„ã€‚explored ä½¿ç”¨ Set æ•°æ®ç»“æž„è®°å½•æ‰€æœ‰å·²ç»å°è¯•è¿‡çš„è·¯å¾„é€‰æ‹©ï¼Œé¿å…å›žæº¯æ—¶é‡å¤ä¹‹å‰çš„è·¯å¾„ã€‚ node_to_path å‡½æ•°åˆ™å¯ä»¥ä»Žç»ˆç‚¹å¼€å§‹åå‘æŸ¥æ‰¾ï¼Œå°† Node èŠ‚ç‚¹ï¼ˆå³å¸¦æœ‰ parent-child å…³ç³»çš„ MazeLocationï¼‰é€æ­¥æ‰©å±•è¿žæŽ¥æˆå®Œæ•´è·¯å¾„å­˜æ”¾åœ¨åˆ—è¡¨ä¸­ã€‚ è¡¥å…… maze.py ä»£ç ï¼š1234567891011121314151617181920212223242526272829# maze.py continuedfrom generic_search import dfs, node_to_path, Node def mark(self, path: List[MazeLocation]): for maze_location in path: self._grid[maze_location.row][maze_location.column] = Cell.PATH self._grid[self.start.row][self.start.column] = Cell.START self._grid[self.goal.row][self.goal.column] = Cell.GOAL def clear(self, path: List[MazeLocation]): for maze_location in path: self._grid[maze_location.row][maze_location.column] = Cell.EMPTY self._grid[self.start.row][self.start.column] = Cell.START self._grid[self.goal.row][self.goal.column] = Cell.GOALif __name__ == '__main__': m: Maze = Maze() print(m)# test DFS solution1: Optional[Node[MazeLocation]] = dfs(m.start, m.goal_test, m.successors) if solution1 is None: print("No solution found using depth-first search") else: path1: List[MazeLocation] = node_to_path(solution1) m.mark(path1) print(m) m.clear(path1) ç»“æžœå¦‚ä¸‹ï¼š123456789101112131415161718192021SX XX X X XX X X X X XX XX X XX GSX XX X**X *XX*X** X X* *****X****XX *X ***X X* XX****G BFSï¼ˆbreadth-first searchï¼‰ç®—æ³•å¯»æ‰¾æœ€çŸ­è·¯å¾„BFS ç®—æ³•æ›´å€¾å‘äºŽä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œæ¯ä¸€æ­¥éƒ½è¦å°è¯•è¿‡æ‰€æœ‰å¯èƒ½çš„æ–¹æ¡ˆï¼Œå±‚å±‚é€’è¿›ç›´åˆ°å…¶ä¸­ä»»ä½•ä¸€ç§æ–¹æ¡ˆèµ°é€šã€‚å‡å¦‚å…±æœ‰ 100 ç§è·¯å¾„éƒ½å¯ä»¥åˆ°è¾¾è¿·å®«ç»ˆç‚¹ï¼Œå„æ¡è·¯å¾„æˆ–é•¿æˆ–çŸ­ã€‚BFS æ¯æ¬¡éƒ½ä¼šåœ¨æ‰€æœ‰ 100 ç§è·¯å¾„ä¸Šå„èµ°ä¸€æ­¥ï¼Œç›´åˆ°å…¶ä¸­æŸä¸€æ¡è·¯å¾„åˆšå¥½åˆ°è¾¾ç»ˆç‚¹åŽåœæ­¢ã€‚ç”±äºŽå¯¹æ‰€æœ‰å¯è¡Œè·¯å¾„çš„å°è¯•æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œå› æ­¤è¯¥ç®—æ³•æ‰¾åˆ°çš„è·¯å¾„æ€»æ˜¯æœ€çŸ­çš„ã€‚12345678910111213141516171819202122232425262728293031323334353637383940# generic_search.py continuedclass Queue(Generic[T]): def __init__(self) -&gt; None: self._container: Deque[T] = Deque() @property def empty(self) -&gt; bool: return not self._container # not is true for empty container def push(self, item: T) -&gt; None: self._container.append(item) def pop(self) -&gt; T: return self._container.popleft() # FIFO def __repr__(self) -&gt; str: return repr(self._container)def bfs(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]]) -&gt; Optional[Node[T]]: # frontier is where we've yet to go frontier: Queue[Node[T]] = Queue() frontier.push(Node(initial, None)) # explored is where we've been explored: Set[T] = &#123;initial&#125; # keep going while there is more to explore while not frontier.empty: current_node: Node[T] = frontier.pop() current_state: T = current_node.state # if we found the goal, we're done if goal_test(current_state): return current_node # check where we can go next and haven't explored for child in successors(current_state): if child in explored: # skip children we already explored continue explored.add(child) frontier.push(Node(child, current_node)) return None # went through everything and never found goal å…¶ä¸­ Queue æ•°æ®ç»“æž„åº•å±‚ä½¿ç”¨ Deque è€Œä¸æ˜¯ Listï¼Œç›®çš„æ˜¯æå‡ popleft æ–¹æ³•çš„æ•ˆçŽ‡ã€‚ç›¸å¯¹äºŽ DFS ä¸­çš„ Stack æ•°æ®ç»“æž„ï¼ŒQueue çš„ pop æ–¹æ³•æ˜¯ä»Žåºåˆ—çš„æœ€å·¦ä¾§ï¼ˆStack æ˜¯ä»Žæœ€å³ä¾§ï¼‰å¼¹å‡ºé¡¹ç›®ã€‚ç”±æ­¤ä½¿å¾— BFS å¯ä»¥ä»Žèµ·ç‚¹å¼€å§‹æœ€å¤§ç¨‹åº¦åœ°å°è¯•æ‰€æœ‰å¯è¡Œæ–¹æ¡ˆï¼Œå³å¹¿åº¦ä¼˜å…ˆåŽŸåˆ™ã€‚ 12345678910# maze.py continued# test BFS solution2: Optional[Node[MazeLocation]] = bfs(m.start, m.goal_test, m.successors) if solution2 is None: print("No solution found using breadth-first search!") else: path2: List[MazeLocation] = node_to_path(solution2) m.mark(path2) print(m) m.clear(path2) æ‰§è¡Œç»“æžœï¼š123456789101112131415161718192021S******* X X X *XX********* X X********** X *XX ******* * X XXXX*X **** X****XXGS*X X X XX** X X**** XXX***** X* XXXX X **** X XXG A* ç®—æ³•å¯»æ‰¾æœ€ä¼˜è§£ç²—ç•¥åœ°è¯´ï¼ŒDFS å¯ä»¥è¾ƒå¿«åœ°æ‰¾åˆ°åˆé€‚è·¯å¾„ï¼ŒBFS åˆ™å¯ä»¥å¯»æ±‚æœ€çŸ­è·¯å¾„ï¼ˆä½†æ—¶é—´èŠ±è´¹è¾ƒé«˜ï¼‰ã€‚ A* ç®—æ³•åˆ™å¼•å…¥äº† heuristic æ¦‚å¿µï¼Œå¤§æ¦‚å°±æ˜¯åœ¨åšå‡ºå†³ç­–å‰å…ˆæ ¹æ®ä¸€å®šçš„æŒ‡å¯¼åŽŸåˆ™ç¡®å®šè·¯å¾„é€‰æ‹©çš„ä¼˜å…ˆçº§ã€‚å³ä¼˜å…ˆé€‰æ‹©å¯èƒ½æœ€çŸ­ï¼ˆç¦»ç»ˆç‚¹æœ€è¿‘ï¼‰çš„è·¯å¾„ä½œä¸ºä¸‹ä¸€æ­¥çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯éšæœºå°è¯•æ‰€æœ‰å¯è¡Œçš„èŠ‚ç‚¹ï¼Œä»¥æ­¤æ¥é™ä½Ž BFS å¯¼è‡´çš„æ—¶é—´æŸè€—ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041# generic_search.py continuedclass PriorityQueue(Generic[T]): def __init__(self) -&gt; None: self._container: List[T] = [] @property def empty(self) -&gt; bool: return not self._container # not is true for empty container def push(self, item: T) -&gt; None: heappush(self._container, item) # in by priority def pop(self) -&gt; T: return heappop(self._container) # out by priority def __repr__(self) -&gt; str: return repr(self._container)def astar(initial: T, goal_test: Callable[[T], bool], successors: Callable[[T], List[T]], heuristic: Callable[[T], float]) -&gt; Optional[Node[T]]: # frontier is where we've yet to go frontier: PriorityQueue[Node[T]] = PriorityQueue() frontier.push(Node(initial, None, 0.0, heuristic(initial))) # explored is where we've been explored: Dict[T, float] = &#123;initial: 0.0&#125; # keep going while there is more to explore while not frontier.empty: current_node: Node[T] = frontier.pop() current_state: T = current_node.state # if we found the goal, we're done if goal_test(current_state): return current_node # check where we can go next and haven't explored for child in successors(current_state): new_cost: float = current_node.cost + 1 # 1 assumes a grid, need a cost function for more sophisticated apps if child not in explored or explored[child] &gt; new_cost: explored[child] = new_cost frontier.push(Node(child, current_node, new_cost, heuristic(child))) return None # went through everything and never found goal å…¶ä¸­ PriorityQueue æ•°æ®ç»“æž„ä½¿ç”¨ heappop æ–¹æ³•ç¡®ä¿æ¯æ¬¡ä»Žé˜Ÿåˆ—ä¸­å–å‡ºçš„æ•°æ®é¡¹éƒ½æ˜¯ï¼ˆå¯¹ç®—æ³•è€Œè¨€ï¼‰ä¼˜å…ˆçº§æœ€é«˜çš„ã€‚ ä¸‹é¢ maze.py ä¸­æ·»åŠ çš„ manhattan_distance å‡½æ•°åˆ™ä»¥æ„å‘èŠ‚ç‚¹ä¸Žç›®æ ‡èŠ‚ç‚¹çš„è·¯çº¿è·ç¦»ä½œä¸ºä¸‹ä¸€æ­¥è·¯å¾„é€‰æ‹©çš„ä¾æ®ã€‚123456789101112131415161718# maze.py continueddef manhattan_distance(goal: MazeLocation) -&gt; Callable[[MazeLocation], float]: def distance(ml: MazeLocation) -&gt; float: xdist: int = abs(ml.column - goal.column) ydist: int = abs(ml.row - goal.row) return (xdist + ydist) return distance# ... # Test A* distance: Callable[[MazeLocation], float] = manhattan_distance(m.goal) solution3: Optional[Node[MazeLocation]] = astar(m.start, m.goal_test, m.successors, distance) if solution3 is None: print("No solution found using A*!") else: path3: List[MazeLocation] = node_to_path(solution3) m.mark(path3) print(m) æ‰§è¡Œç»“æžœï¼š1234567891011121314151617181920212223242526272829303132S******X X ********* **X X********** X XX*X X** XX***X * ****X*XX***XX * X GS X*X**X X**** X XX*X X * XXX * XXX * XX X******GS X*X**X X*******X XX X ** X XX***X X*XX XX * X G å‚è€ƒèµ„æ–™Classic Computer Science Problems in Pythondavecom/ClassicComputerScienceProblemsInPython]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>DataStructure</tag>
        <tag>Algorithm</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Search</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Cookbook â€”â€” ç±»ä¸Žå¯¹è±¡]]></title>
    <url>%2F2020%2F01%2F02%2Fpython-cookbook-class-and-object%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å®žä¾‹å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºä¿®æ”¹å®žä¾‹å¯¹è±¡çš„ __str__() å’Œ __repr__() æ–¹æ³•å¯ä»¥æ”¹å˜è¯¥å®žä¾‹ç”Ÿæˆçš„å­—ç¬¦ä¸²è¾“å‡ºã€‚123456789101112131415class Pair: def __init__(self, x, y): self.x = x self.y = y def __repr__(self): return 'Pair(&#123;0.x!r&#125;, &#123;0.y!r&#125;)'.format(self) def __str__(self): return '(&#123;0.x!s&#125;, &#123;0.y!s&#125;)'.format(self)# test&gt;&gt;&gt; p = Pair(3, 4)&gt;&gt;&gt; pPair(3, 4) # __repr__() output&gt;&gt;&gt; print(p) # __str__() output(3, 4) äºŒã€è‡ªå®šä¹‰å­—ç¬¦ä¸²æ ¼å¼åŒ–é€šè¿‡å®šä¹‰å®žä¾‹çš„ __format__ æ–¹æ³•ï¼Œå¯ä»¥é…ç½®å®žä¾‹å¯¹è±¡æŽ¥å—å­—ç¬¦ä¸²æ ¼å¼åŒ–æ“ä½œæ—¶çš„è¡¨çŽ°ï¼ˆå³å®šä¹‰è¢« format å‡½æ•°è°ƒç”¨çš„æ–¹å¼ä¸Žè°ƒç”¨åŽçš„è¾“å‡ºç»“æžœï¼‰ã€‚123456789101112131415161718192021222324252627_formats = &#123; 'ymd' : '&#123;d.year&#125;-&#123;d.month&#125;-&#123;d.day&#125;', 'mdy' : '&#123;d.month&#125;/&#123;d.day&#125;/&#123;d.year&#125;', 'dmy' : '&#123;d.day&#125;/&#123;d.month&#125;/&#123;d.year&#125;'&#125;class Date: def __init__(self, year, month, day): self.year = year self.month = month self.day = day def __format__(self, code): if code == '': code = 'ymd' fmt = _formats[code] return fmt.format(d=self)d = Date(2012, 12, 21)print(format(d))print(format(d, 'mdy'))print('The date is &#123;:ymd&#125;'.format(d))# =&gt; 2012-12-21# =&gt; 12/21/2012# =&gt; The date is 2012-12-21 ä¸‰ã€ä½¿å¯¹è±¡æ”¯æŒ Context-Management åè®®ä¸ºäº†ä½¿æŸä¸ªå¯¹è±¡æ”¯æŒ Context-Managementï¼ˆå³ with è¯­å¥ï¼‰ï¼Œéœ€è¦åœ¨ç±»ä¸­å®žçŽ° __enter__() å’Œ __exit__() æ–¹æ³•ã€‚12345678910111213141516171819202122232425262728293031from socket import socket, AF_INET, SOCK_STREAMclass LazyConnection: def __init__(self, address, family=AF_INET, type=SOCK_STREAM): self.address = address self.family = family self.type = type self.sock = None def __enter__(self): if self.sock is not None: raise RuntimeError('Already connected') self.sock = socket(self.family, self.type) self.sock.connect(self.address) return self.sock def __exit__(self, exc_ty, exc_val, tb): self.sock.close() self.sock = None# test codefrom functools import partialconn = LazyConnection(('www.python.org', 80))with conn as s: s.send(b'GET /index.htm HTTP/1.0\r\n') s.send(b'Host: www.python.org\r\n') s.send(b'\r\n') resp = b''.join(iter(partial(s.recv, 8192), b'')) print(resp) å››ã€åˆ›å»ºè‡ªå®šä¹‰å±žæ€§æœ‰äº›æ—¶å€™ï¼Œåœ¨è®¾ç½®æˆ–è€…èŽ·å–æŸä¸ªå®žä¾‹å±žæ€§çš„å€¼æ—¶ï¼Œéœ€è¦å¯¹å…¶æ·»åŠ é¢å¤–çš„æ“ä½œï¼Œæ¯”å¦‚ç±»åž‹æ£€æŸ¥æˆ–è€…å±žæ€§å€¼çš„åˆæ³•æ€§æ£€æŸ¥ç­‰ã€‚è¿™ç±»éœ€æ±‚å¯ä»¥ä½¿ç”¨ @property è£…é¥°å™¨æ¥å®Œæˆã€‚ 12345678910111213141516171819202122232425262728class Person: def __init__(self, first_name): self._first_name = first_name # Getter function @property def first_name(self): return self._first_name # Setter function @first_name.setter def first_name(self, value): if not isinstance(value, str): raise TypeError('Expected a string') self._first_name = value # Deleter function(optional) @first_name.deleter def first_name(self): raise AttributeError("Can't delete attribute")# test codea = Person('Guido')print(a.first_name) # =&gt; Guidoa.first_name = 'Linus'print(a.first_name) # =&gt; Linusa.first_name = 42 # =&gt; TypeError: Expected a stringdel a.first_name # =&gt; AttributeError: can't delete attribute PSï¼šå’Œ Java ç­‰è¯­è¨€çš„ä½¿ç”¨ä¹ æƒ¯ä¸åŒï¼ŒPython çš„ Property å±žæ€§åº”è¯¥åªç”¨åœ¨è®¿é—®å±žæ€§æ—¶éœ€è¦å¯¹å…¶è¿›è¡Œé¢å¤–å¤„ç†çš„æƒ…å†µä¸‹ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰å¯¹å±žæ€§çš„è®¿é—®éƒ½éœ€è¦ç”± getter æˆ– setter å¤„ç†ã€‚ Property è¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºæŒ‰éœ€è®¡ç®—çš„å±žæ€§ã€‚å³å±žæ€§å€¼å¹¶éžé¢„å…ˆå­˜æ”¾åœ¨æŸä¸ªåœ°æ–¹ï¼Œè€Œæ˜¯åœ¨è®¿é—®å®ƒæ—¶å®žæ—¶åœ°è®¡ç®—å¹¶è¿”å›žã€‚12345678910111213141516171819import mathclass Circle: def __init__(self, radius): self.radius = radius @property def area(self): return math.pi * self.radius ** 2 @property def perimeter(self): return 2 * math.pi * self.radiusc = Circle(4.0) print(c.radius) # =&gt; 4.0print(c.area) # =&gt; 50.26548245743669print(c.perimeter) # =&gt; 25.132741228718345 äº”ã€ç®€åŒ–æ•°æ®ç»“æž„çš„åˆå§‹åŒ–æœ‰äº›æ—¶å€™ï¼Œç¨‹åºä¸­ä¼šåŒ…å«å¾ˆå¤šéœ€è¦ç”¨ç±»åŽ»å®šä¹‰çš„æ•°æ®ç»“æž„ï¼Œå¯¼è‡´å‡ºçŽ°ç±»ä¼¼ä¸‹é¢çš„ä»£ç ï¼š12345678910111213141516171819class Stock: def __init__(self, name, shares, price): self.name = name self.shares = shares self.price = priceclass Point: def __init__(self, x, y): self.x = x self.y = yclass Circle: def __init__(self, radius): self.radius = radius def area(self): return math.pi * self.radius ** 2 ä¸Šè¿°å¤šä¸ªæ•°æ®ç»“æž„ï¼ˆStockã€Pointã€Circleï¼‰éƒ½æ˜¯é€šè¿‡ __init__ æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–çš„ã€‚å®žé™…ä¸Šå¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªåŸºç±»ï¼Œåœ¨å…¶ä¸­æŠ½è±¡å‡º __init__ æ–¹æ³•çš„é€»è¾‘ï¼Œä½¿å…¶å¯ä»¥ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ç®€åŒ–é‡å¤çš„åˆå§‹åŒ–æ“ä½œã€‚1234567891011121314151617181920212223242526272829class Structure: # Class variable that specifies expected fields _fields = [] def __init__(self, *args, **kwargs): if len(args) != len(self._fields): raise TypeError('Expected &#123;&#125; arguments'.format(len(self._fields))) # Set the arguments for name, value in zip(self._fields, args): setattr(self, name, value) # Set the additional arguments (if any) extra_args = kwargs.keys() - self._fields for name in extra_args: setattr(self, name, kwargs.pop(name)) if kwargs: raise TypeError('Duplicate values for &#123;&#125;'.format(','.join(kwargs)))# Example useif __name__ == '__main__': class Stock(Structure): _fields = ['name', 'shares', 'price'] s1 = Stock('ACME', 50, 91.1) s2 = Stock('ACME', 50, 91.1, date='8/2/2012') print(s1.shares) # =&gt; 50 print(s2.date) # =&gt; 8/2/2012 å…­ã€å®šä¹‰é¢å¤–çš„æž„é€ å™¨ç±»æ–¹æ³•å¯ä»¥ä½œä¸ºé™¤ __init__() æ–¹æ³•ä»¥å¤–çš„ï¼Œå¦ä¸€ä¸ªç”¨æ¥åˆ›å»ºç±»å®žä¾‹çš„æž„é€ æ–¹æ³•ã€‚123456789101112131415161718192021222324import timeclass Date: # Primary constructor def __init__(self, year, month, day): self.year = year self.month = month self.day = day # Alternate constructor @classmethod def today(cls): t = time.localtime() return cls(t.tm_year, t.tm_mon, t.tm_mday) def __repr__(self): return f'&#123;self.year&#125;-&#123;self.month&#125;-&#123;self.day&#125;'a = Date(2019, 12, 23)print(a) # =&gt; 2019-12-23b = Date.today()print(b) # =&gt; 2019-12-23 ä¸ƒã€é€šè¿‡ Mixin æ‰©å±•ç±»123456789101112131415161718192021222324252627282930313233343536373839404142# mixins.pyclass LoggedMappingMixin: ''' Add logging to get/set/delete operations for debugging. ''' __slots__ = () def __getitem__(self, key): print(f'Getting &#123;key&#125;') return super().__getitem__(key) def __setitem__(self, key, value): print(f'Setting &#123;key&#125; = &#123;value&#125;') return super().__setitem__(key, value) def __delitem__(self, key): print(f'Deleting &#123;key&#125;') return super().__delitem__(key)class SetOnceMappingMixin: ''' Only allow a key to be set once. ''' __slots__ = () def __setitem__(self, key, value): if key in self: raise KeyError(f'&#123;key&#125; already set') return super().__setitem__(key, value)class StringKeysMappingMixin: ''' Restrict keys to strings only. ''' __slots__ = () def __setitem__(self, key, value): if not isinstance(key, str): raise TypeError('keys must be strings') return super().__setitem__(key, value) æµ‹è¯•ä»£ç ï¼š12345678910111213141516171819202122&gt;&gt;&gt; from mixins import *&gt;&gt;&gt; class LoggedDict(LoggedMappingMixin, dict):... pass...&gt;&gt;&gt; d = LoggedDict()&gt;&gt;&gt; d['x'] = 23Setting x = 23&gt;&gt;&gt; d['x']Getting x23&gt;&gt;&gt; del d['x']Deleting x&gt;&gt;&gt;&gt;&gt;&gt; class SetOnceStringDict(StringKeysMappingMixin, SetOnceMappingMixin, dict):... pass...&gt;&gt;&gt; d2 = SetOnceStringDict()&gt;&gt;&gt; d2['x'] = 23&gt;&gt;&gt; d2['x'] = 10KeyError: 'x already set'&gt;&gt;&gt; d2[3] = 42TypeError: keys must be strings å…«ã€ä½¿ç±»æ”¯æŒæ¯”è¾ƒè¿ç®—ç¬¦1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859from functools import total_orderingclass Room: def __init__(self, name, length, width): self.name = name self.length = length self.width = width self.square_feet = self.length * self.width@total_orderingclass House: def __init__(self, name, style): self.name = name self.style = style self.rooms = list() @property def living_space_footage(self): return sum(r.square_feet for r in self.rooms) def add_room(self, room): self.rooms.append(room) def __str__(self): return f'&#123;self.name&#125;: &#123;self.living_space_footage&#125; square foot &#123;self.style&#125;' def __eq__(self, other): return self.living_space_footage == other.living_space_footage def __lt__(self, other): return self.living_space_footage &lt; other.living_space_footage# Build a few houses, and add rooms to themh1 = House('h1', 'Cape')h1.add_room(Room('Master Bedroom', 14, 21))h1.add_room(Room('Living Room', 18, 20))h1.add_room(Room('Kitchen', 12, 16))h1.add_room(Room('Office', 12, 12))h2 = House('h2', 'Ranch')h2.add_room(Room('Master Bedroom', 14, 21))h2.add_room(Room('Living Room', 18, 20))h2.add_room(Room('Kitchen', 12, 16))h3 = House('h3', 'Split')h3.add_room(Room('Master Bedroom', 14, 21))h3.add_room(Room('Living Room', 18, 20))h3.add_room(Room('Office', 12, 16))h3.add_room(Room('Kitchen', 15, 17))houses = [h1, h2, h3]print('Is h1 bigger than h2?', h1 &gt; h2) # =&gt; Trueprint('Is h2 smaller than h3?', h2 &lt; h3) # =&gt; Trueprint('Is h2 greater than or equal to h1?', h2 &gt;= h1) # =&gt; Falseprint('Which one is biggest?', max(houses)) # =&gt; h3: 1101 square foot Splitprint('Which is smallest?', min(houses)) # =&gt; h2: 846 square foot Ranch å‚è€ƒèµ„æ–™Python Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Tricks</tag>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux æœåŠ¡å™¨ä¸Šçš„å¤§æ–‡ä»¶æŸ¥æ‰¾åŠæ¸…ç†å®žè·µ]]></title>
    <url>%2F2019%2F12%2F29%2Flinux-server-big-file-find-and-clean%2F</url>
    <content type="text"><![CDATA[ç”Ÿäº§ä¸Šçš„ Linux æœåŠ¡å™¨ç£ç›˜ç©ºé—´ä¸è¶³ï¼ŒåŽé¢æŽ’æŸ¥å¾—çŸ¥æ˜¯æŸä¸ªåº”ç”¨é¢‘ç¹å†™ log å¯¼è‡´ã€‚äºŽæ˜¯åŠ äº†ä¸€æ¡è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ—¥å¿—çš„ crontab ã€‚å…·ä½“çš„æŽ’æŸ¥è¿‡ç¨‹è®°å½•å¦‚ä¸‹ï¼Œéƒ½æ˜¯å¾ˆåŸºç¡€çš„å‘½ä»¤ã€‚ ä¸€ã€dfdf -h å‘½ä»¤æŸ¥çœ‹å½“å‰ç£ç›˜ç©ºé—´çš„ä½¿ç”¨æƒ…å†µï¼š12345678# df -hFilesystem Size Used Avail Use% Mounted on/dev/vda1 50G 50G 0G 100% /devtmpfs 3.9G 0 3.9G 0% /devtmpfs 3.9G 24K 3.9G 1% /dev/shmtmpfs 3.9G 476K 3.9G 1% /runtmpfs 3.9G 0 3.9G 0% /sys/fs/cgrouptmpfs 783M 0 783M 0% /run/user/0 ç³»ç»Ÿåªæœ‰ä¸€ä¸ªç£ç›˜åˆ†åŒº /dev/vda1ï¼Œå¤§å°ä¸º 50Gï¼Œå·²æŒ‚è½½åˆ°æ ¹ç›®å½•ä¸‹ï¼Œç”¨é‡ä¸º 100%ï¼Œç¡®å®žæ²¡æœ‰å‰©ä½™ç©ºé—´ã€‚ ä»¥æ­¤å¯æ–­å®šå¹¶éžå­˜åœ¨åˆ†åŒºåˆ’åˆ†ä¸åˆç†çš„æƒ…å†µã€‚æ¯”å¦‚ç£ç›˜å¤§éƒ¨åˆ†å®¹é‡åˆ†é…ç»™äº†å…¶ä»–åˆ†åŒºï¼ŒæŒ‚è½½åˆ°è¯¸å¦‚ /homeã€/usr ç­‰ç›®å½•ä¸‹å¯¼è‡´ / è·¯å¾„ä¸‹æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ã€‚ äºŒã€lsblklsblk å‘½ä»¤æŸ¥çœ‹ç¡¬ç›˜çš„åˆ†åŒºä¸ŽæŒ‚è½½ç‚¹ï¼š12345# lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsr0 11:0 1 37M 0 romvda 253:0 0 50G 0 disk`-vda1 253:1 0 50G 0 part / å½“å‰åªæœ‰ä¸€å—ç¡¬ç›˜ vdaï¼Œå¤§å°ä¸º 50Gï¼Œå…¨éƒ¨åˆ†é…ç»™äº†å”¯ä¸€çš„åˆ†åŒº vda1ï¼Œä¸å­˜åœ¨å‰©ä½™ç©ºé—´ã€‚ æ­¤å¤„å¯ä»¥ç¡®å®šç¡¬ç›˜çš„æ‰€æœ‰å®¹é‡éƒ½å·²è¢«åˆ†é…ä½¿ç”¨ã€‚ä¸å­˜åœ¨å‰©ä½™ç©ºé—´ï¼ˆæœªåˆ†é…åŒºåŸŸï¼‰æˆ–è€…å› ä¸º LVM å·å¯¼è‡´ä»æœ‰ç©ºé—²å­˜å‚¨æœªè¢«ä½¿ç”¨ç­‰æƒ…å†µã€‚ ä¸‰ã€dudu å‘½ä»¤ç»Ÿè®¡æ–‡ä»¶å’Œç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ã€‚ du å‘½ä»¤é»˜è®¤ä¼šä»¥é€’å½’çš„æ–¹å¼è¾“å‡ºå½“å‰è·¯å¾„ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶çš„å¤§å°ï¼ˆä»¥ç›®å½•ä¸ºå•ä½æ˜¾ç¤ºï¼‰ï¼Œä¿¡æ¯é‡æœ‰æ—¶ä¼šæ¯”è¾ƒåºžå¤§ã€‚å¯ä»¥ä½¿ç”¨ -s é€‰é¡¹èŽ·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å¤§å°æ€»å’Œã€‚æˆ–è€…ä½¿ç”¨ -d é€‰é¡¹æŒ‡å®šéåŽ†çš„æ·±åº¦ï¼Œå³åªç»Ÿè®¡åˆ°æŸä¸€å±‚ç›®å½•è€Œæ— éœ€å±•å¼€åˆ°æ›´æ·±å±‚çš„å­ç›®å½•ã€‚ å½“å‰ Linux æœåŠ¡å™¨ä¸Šçš„åº”ç”¨éƒ½éƒ¨ç½²åœ¨æŸä¸ªç‰¹å®šçš„è·¯å¾„ä¸‹ï¼Œå› æ­¤åˆ‡æ¢åˆ°è¯¥ç›®å½•å¹¶ç»Ÿè®¡å…¶ä¸­æ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°æ€»å’Œï¼š12# du -sh12G . é€šè¿‡ -d é€‰é¡¹æŒ‡å®šéåŽ†çš„å±‚æ•°ä¸º 1ï¼Œæ˜¾ç¤ºå½“å‰è·¯å¾„ä¸‹åŒ…å«çš„æ¯ä¸€ä¸ªå­ç›®å½•å„è‡ªå ç”¨çš„ç£ç›˜ç©ºé—´æ€»å’Œï¼š12345678910# du -hd180K ./work7.6M ./lib12G ./logs236K ./conf4.0K ./temp221M ./webapps15M ./backup860K ./bin12G . å¯ä»¥çœ‹åˆ° logs å­ç›®å½•ä¸‹çš„æ–‡ä»¶æ€»å…±å ç”¨äº† 12G å­˜å‚¨ç©ºé—´ï¼Œå‡ ä¹Žä¸Žæ•´ä¸ªç›®å½•å¤§å°ç›¸å½“ã€‚å› æ­¤åŸºæœ¬å¯ä»¥ç¡®å®š logs ç›®å½•ä¸ºéœ€è¦è¿›ä¸€æ­¥æŽ’æŸ¥çš„å¯¹è±¡ã€‚ PSï¼šå¦‚å½“å‰è·¯å¾„ä¸‹å­ç›®å½•ä¼—å¤šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ sort å‘½ä»¤å¯¹è¾“å‡ºç»“æžœæŒ‰å¤§å°è¿›è¡ŒæŽ’åºã€‚12345678910# du -d1 | sort -nr12448764 .12199320 ./logs225988 ./webapps14432 ./backup7736 ./lib860 ./bin236 ./conf80 ./work4 ./temp sort å‘½ä»¤çš„ -n é€‰é¡¹è¡¨ç¤ºä»¥æ•°å­—å¤§å°ä¸ºæŽ’åºä¾æ®ï¼Œ-r åˆ™è¡¨ç¤ºé€†åºè¾“å‡ºæŽ’åºç»“æžœã€‚du å‘½ä»¤åŽ»æŽ‰ -h é€‰é¡¹åˆ™é¿å…å°†æ–‡ä»¶å¤§å°ï¼ˆbytesï¼‰è‡ªåŠ¨è½¬æ¢ä¸º KBã€MBã€GB ç­‰å¯¼è‡´å•ä½ä¸ä¸€è‡´ã€‚å¯ä»¥ä½¿ç”¨ -k æˆ– -m ç­‰é€‰é¡¹æ‰‹åŠ¨æŒ‡å®š du å‘½ä»¤çš„å•ä½ã€‚ å››ã€lsls å‘½ä»¤èŽ·å–æŒ‡å®šç›®å½•ä¸‹åŒ…å«çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆåŠè¯¦ç»†ä¿¡æ¯ï¼‰ã€‚ 123456789# ls -Slh logs | head -8total 12G-rw-r--r-- 1 tomcat Devops 3.5G Dec 29 01:40 catalina.out-rw-r----- 1 root root 108M Nov 15 00:00 localhost_access.2019-11-14.log-rw-r----- 1 root root 107M Nov 22 00:00 localhost_access.2019-11-21.log-rw-r----- 1 root root 106M Nov 14 00:00 localhost_access.2019-11-13.log-rw-r----- 1 root root 104M Nov 17 00:00 localhost_access.2019-11-16.log-rw-r----- 1 root root 104M Nov 23 00:00 localhost_access.2019-11-22.log-rw-r----- 1 root root 104M Nov 13 00:00 localhost_access.2019-11-12.log å…¶ä¸­ -S é€‰é¡¹ç”¨äºŽå°†è¾“å‡ºç»“æžœæŒ‰æ–‡ä»¶å¤§å°æŽ’åºï¼Œ-l é€‰é¡¹æŒ‡å®šè¾“å‡ºå„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚ç”±äºŽ logs ç›®å½•ä¸‹æ–‡ä»¶ä¼—å¤šï¼Œä½¿ç”¨ head -8 ç­›é€‰å‰ 8 æ¡è¾“å‡ºè¿›è¡Œæ˜¾ç¤ºã€‚ æ­¤æ—¶å³å¯æ ¹æ®å¯¹æ–‡ä»¶å¤§å°å’ŒåŠŸèƒ½çš„åˆ¤æ–­æ‰‹åŠ¨æ‰§è¡Œåˆ é™¤æ“ä½œã€‚ äº”ã€findfind å‘½ä»¤ç­›é€‰æŒ‡å®šæ—¶æœŸå†…åˆ›å»ºçš„æ–‡ä»¶ logs ç›®å½•ä¸‹æ¯å¤©éƒ½ä¼šåˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯¼è‡´å ç”¨çš„ç£ç›˜ç©ºé—´ä¸Žæ—¥ä¿±å¢žã€‚å› æ­¤éœ€è¦å®šæœŸåˆ é™¤æŒ‡å®šæ—¥æœŸä»¥å‰çš„æ—§æ–‡ä»¶ï¼Œé‡Šæ”¾ä¸å¿…è¦çš„ç©ºé—´å ç”¨ã€‚ å¦‚åˆ é™¤å½“å‰ç›®å½•ä¸‹åªåœ¨ 60 å¤©ä»¥å‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼Œä¿ç•™æœ€è¿‘ä¸¤ä¸ªæœˆçš„æ—¥å¿—è®°å½•ï¼š1# find . -mtime +60 -type f -exec rm &#123;&#125; \; å°†è¯¥å‘½ä»¤æ·»åŠ åˆ° crontab ä¸­ï¼Œè®¾ç½®å¥½å®šæ—¶è§„åˆ™ï¼Œå³å¯å®šæœŸæ‰§è¡Œæ¸…ç†ä»»åŠ¡ï¼Œé¿å…è¿‡é«˜çš„ç£ç›˜å ç”¨ã€‚ å‘½ä»¤æ€»ç»“ du -hï¼šæŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­ç£ç›˜ç©ºé—´çš„ä½¿ç”¨æƒ…å†µ lsblkï¼šæŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­ç£ç›˜çš„åˆ†åŒºå’ŒæŒ‚è½½æƒ…å†µ du -hd1ï¼šæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹å„å­ç›®å½•åˆ†åˆ«å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å° ls -Slh | head -8ï¼šåˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œç»“æžœç”±å¤§åˆ°å°æŽ’åºï¼Œè¾“å‡ºå‰ 8 æ¡ find . -mtime +60 -type f -exec rm {} \;ï¼šæŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ 60 å¤©ä¹‹å‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶å¹¶åˆ é™¤]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Server</tag>
        <tag>Disk</tag>
        <tag>Tricks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ansible Playbooks åŸºæœ¬åŠŸèƒ½ä»‹ç»åŠç¤ºä¾‹ä»£ç ]]></title>
    <url>%2F2019%2F12%2F29%2Fansible-playbooks-basic-code-examples%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åŸºæœ¬ç»“æž„ç”¨äºŽå®‰è£…æˆ–å‡çº§ apache æœåŠ¡çš„ playbook å®Œæ•´ç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526---- hosts: webservers remote_user: root vars: http_port: 80 max_clients: 200 tasks: - name: ensure apache is at the latest version yum: name: httpd state: latest - name: write the apache config file template: src: /srv/httpd.j2 dest: /etc/httpd.conf notify: - restart apache - name: ensure apache is running service: name: httpd state: started handlers: - name: restart apache service: name: httpd state: restarted targettarget éƒ¨åˆ†ç”¨äºŽæŒ‡å®šæ‰§è¡Œ playbook ä»»åŠ¡æ—¶é¢å‘çš„ç›®æ ‡ä¸»æœºå’Œè¿œç¨‹ç”¨æˆ·ã€‚123---- hosts: webservers remote_user: root è¿œç¨‹ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨ç‰¹å®šçš„ task ä¸­é¢å¤–è¿›è¡Œå®šä¹‰ï¼š1234567---- hosts: webservers remote_user: root tasks: - name: test connection ping: remote_user: yourname æ‰§è¡Œä»»åŠ¡æ—¶å…è®¸è¿œç¨‹ç”¨æˆ·é€šè¿‡ sudo æå‡æƒé™ï¼š12345---- hosts: webservers remote_user: yourname become: yes become_method: sudo æ‰§è¡Œä»»åŠ¡æ—¶åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·èº«ä»½ï¼š12345---- hosts: webservers remote_user: yourname become: yes become_user: postgres variablevariable éƒ¨åˆ†ç”¨äºŽå®šä¹‰å˜é‡ï¼Œä½œç”¨åŸŸä¸ºå½“å‰ playã€‚123vars: http_port: 80 max_clients: 200 é€šè¿‡ vars_files å®šä¹‰å˜é‡ï¼š1234vars_files: conf/country-AU.yml conf/datacenter-SYD.yml conf/cluster-mysql.yml äº¤äº’å¼åœ°ä»Žç”¨æˆ·è¾“å…¥ä¸­èŽ·å–å˜é‡çš„å€¼ã€‚å¦‚å°†ç”¨æˆ·è¾“å…¥èµ‹å€¼ç»™å˜é‡ https_passphraseï¼š1234vars_prompt: - name: https_passphrase prompt: Key Passphrase private: yes tasktask éƒ¨åˆ†åŒ…å«äº†ä¸€ç³»åˆ—æˆ‘ä»¬å¸Œæœ›åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œçš„åŠ¨ä½œã€‚12345tasks:- name: ensure apache is at the latest version yum: name: httpd state: latest handlerhandler ä¸Ž task æœ‰ç€ç›¸åŒçš„è¯­æ³•å’Œç±»ä¼¼çš„åŠŸèƒ½ã€‚ä½†æ˜¯ handler åªå¯ä»¥åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹ç”± task è°ƒç”¨åŽæ‰§è¡Œã€‚ å¦‚é…ç½®æ–‡ä»¶æ›¿æ¢æˆåŠŸåŽè§¦å‘é‡å¯æœåŠ¡çš„åŠ¨ä½œï¼š123456789101112tasks: - name: copy the DHCP config copy: src: dhcp/dhcpd.conf dest: /etc/dhcp/dhcpd.conf notify: restart dhcphandlers:- name: restart dhcp service: name: dhcpd state: restarted å¯ä»¥åœ¨å•ä¸ª task ä¸­åŒæ—¶è°ƒç”¨å¤šä¸ª handlerï¼š123456789101112131415161718192021222324252627---- hosts: qroud tasks: - name: checkout Qroud git: repo:git@github.com:smarthall/Qroud.git dest: /opt/apps/Qroud force=no notify: - migrate db - generate static - restart httpdhandlers:- name: migrate db command: ./manage.py migrate â€“all args: chdir: /opt/apps/Qroud- name: generate static command: ./manage.py collectstatic -c â€“noinput args: chdir: /opt/apps/Qroud- name: restart httpd service: name: httpd state: restarted äºŒã€playbook æ¨¡å—templatetemplate æ¨¡å—ä¸€èˆ¬ç”¨äºŽå®šä¹‰é…ç½®æ–‡ä»¶çš„ä¸»ä½“æ¡†æž¶ï¼Œå¹¶ä¸º Ansible ä¸­çš„å˜é‡é¢„ç•™å¥½ä½ç½®ä»¥ä¾¿åœ¨éœ€è¦æ—¶æ¸²æŸ“ã€‚ç±»ä¼¼äºŽ Flask åº”ç”¨ä¾æ®æ¨¡æ¿æ–‡ä»¶åŠ¨æ€åœ°ç”Ÿæˆ HTML æ–‡æ¡£ã€‚å…¶æ¨¡æ¿åŠŸèƒ½ç”± Jinja2 æä¾›ï¼Œæ”¯æŒæ¡ä»¶è¯­å¥ã€for å¾ªçŽ¯å’Œå®ç­‰é«˜çº§è¯­æ³•ã€‚123&#123;% for ip in ansible_all_ipv4_addresses %&#125; &#123;&#123; ip &#125;&#125;;&#123;% endfor %&#125; 12345tasks:- name: write the apache config file template: src: /srv/httpd.j2 dest: /etc/httpd.conf pausepause æ¨¡å—ä¼šå°†æ‰§è¡Œä¸­çš„ playbook æš‚åœä¸€æ®µæ—¶é—´ã€‚æ¯”å¦‚éƒ¨ç½²äº†ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ web åº”ç”¨ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤ä¸€åˆ‡æ­£å¸¸æ‰èƒ½ç»§ç»­æ‰§è¡ŒåŽé¢çš„ä»»åŠ¡ã€‚123456789---- hosts: localhost tasks: - name: wait on user input pause: prompt: "Warning! Press ENTER to continue or CTRL-C to quit." - name: timed wait pause: seconds: 30 wait_forç­‰å¾…æŸä¸ªç‰¹å®šçš„ TCP ç«¯å£å¯ä»¥è¢«è¿œç¨‹ä¸»æœºè®¿é—®è¿žé€šã€‚1234567891011121314151617---- hosts: webapps tasks: - name: Install Tomcat yum: name: tomcat7 state: latest - name: Start Tomcat service: name: tomcat7 state: started - name: Wait for Tomcat to start wait_for: port: 8080 state: started group_bygroup_by æ¨¡å—å¯ä»¥åœ¨ task ä¸­åŸºäºŽæ”¶é›†åˆ°çš„ facts ä¿¡æ¯åŠ¨æ€åœ°å¯¹ hosts è¿›è¡Œåˆ†ç»„ã€‚1234567891011121314151617---- name: Create operating system group hosts: all tasks: - group_by: key=os_&#123;&#123; ansible_distribution &#125;&#125;- name: Run on CentOS hosts only hosts: os_CentOS tasks: - name: Install Apache yum: name=httpd state=latest- name: Run on Ubuntu hosts only hosts: os_Ubuntu tasks: - name: Install Apache apt: pkg=apache2 state=latest ä¸‰ã€Playbooks è¿›é˜¶Looping1234567891011tasks:- name: Secure config files file file: path: "/etc/&#123;&#123; item &#125;&#125;" mode: 0600 owner: root group: root with_items: - my.cnf - shadow - fstab æ¡ä»¶è¯­å¥123456789101112131415161718192021---- name: Install VIM hosts: all tasks: - name: Install VIM via yum yum: name: vim-enhanced state: latest when: ansible_os_family == "RedHat" - name: Install VIM via apt apt: name: vim state: latest when: ansible_os_family == "Debian" - name: Unexpected OS family debug: msg: "OS Family &#123;&#123; ansible_os_family &#125;&#125; is not supported" fail: yes when: ansible_os_family != "RedHat" and ansible_os_family != "Debian" 123456# Copy a file to the remote server if the hosts file doesn't existtasks:- stat: path=/etc/hosts register: hosts_file- copy: src=path/to/local/file dest=/path/to/remote/file when: not hosts_file.stat.exists 123456# Downgrade PHP version if the current version contains '7.0'.tasks:- shell: php --version register: php_version- shell: yum -y downgrade php* when: "'7.0' in php_version.stdout" æ³¨å†Œå˜é‡123456789101112131415- name: Using register hosts: ansibletest remote_user: root tasks: - name: Get /tmp info file: dest: /tmp state: directory register: tmp - name: Set mode on /tmp/subtmp file: dest: /tmp/subtmp mode: "&#123;&#123; tmp.mode &#125;&#125;" state: directory debug æŸ¥çœ‹å˜é‡çš„å€¼ï¼š1234- name: capture output of id command command: id -un register: login- debug: msg="Logged in as user &#123;&#123; login.stdout &#125;&#125;" filterJinja2 æ¨¡æ¿æä¾›çš„ filter åŠŸèƒ½å¯ä»¥å°†åŽŸå§‹æ•°æ®è½¬æ¢ä¸ºç”¨æˆ·éœ€è¦çš„æ ¼å¼123456789101112---- name: Create user accounts hosts: all vars: users: tasks: - name: Create accounts user: name=&#123;&#123; item|lower &#125;&#125; state=present with_items: - Fred - John - DanielH å¸¸ç”¨ filterï¼š minï¼šå‚æ•°ä¸ºåˆ—è¡¨ï¼Œè¿”å›žåˆ—è¡¨ä¸­æœ€å°çš„é¡¹ç›® maxï¼šå‚æ•°ä¸ºåˆ—è¡¨ï¼Œè¿”å›žåˆ—è¡¨ä¸­æœ€å¤§çš„é¡¹ç›® randomï¼šå‚æ•°ä¸ºåˆ—è¡¨ï¼Œéšæœºè¿”å›žåˆ—è¡¨ä¸­çš„æŸä¸ªå€¼ default(x)ï¼šæŒ‡å®šå˜é‡ä¸å­˜åœ¨æ—¶ï¼Œä»¥ x ä¸ºè¯¥å˜é‡çš„é»˜è®¤å€¼ uniqueï¼šå‚æ•°ä¸ºåˆ—è¡¨ï¼Œè¿”å›žè¯¥åˆ—è¡¨åŽ»é™¤é‡å¤é¡¹åŽçš„ç‰ˆæœ¬ replace(x, y)ï¼šå°†å­—ç¬¦ä¸²ä¸­å‡ºçŽ°çš„æ‰€æœ‰ x æ›¿æ¢ä¸º y join(x)ï¼šå‚æ•°ä¸ºåˆ—è¡¨ï¼Œè¿”å›žç”± x æ‹¼æŽ¥æ‰€æœ‰åˆ—è¡¨é¡¹åŽå½¢æˆçš„å­—ç¬¦ä¸² é’ˆå¯¹æ–‡ä»¶è·¯å¾„çš„å¸¸ç”¨ filterï¼š basenameï¼šè¿”å›žè·¯å¾„ä¸­åŒ…å«çš„æ–‡ä»¶å dirnameï¼šè¿”å›žæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• expanduserï¼šå°†è·¯å¾„ä¸­åŒ…å«çš„ ~ æ›¿æ¢ä¸º home ç›®å½• realpathï¼šæ–‡ä»¶çš„çœŸå®žè·¯å¾„ 12345vars: homepage: /usr/share/nginx/html/index.htmltasks:- name: copy home page copy: src=files/&#123;&#123; homepage | basename &#125;&#125; dest=&#123;&#123; homepage &#125;&#125; Lookuplookups å…è®¸ Ansible ä»Žå¤šç§ç±»åž‹çš„æºå¤´ï¼ˆå¦‚æ–‡æœ¬æ–‡æ¡£ã€CSV æ–‡ä»¶ç­‰ï¼‰è¯»å–é…ç½®æ•°æ®ã€‚ fileï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹ä½œä¸ºå‚æ•°12- name: Add my public key as an EC2 key ec2_key: name=mykey key_material="&#123;&#123; lookup('file', '/Users/lorin/.ssh/id_rsa.pub') &#125;&#125;" pipeï¼šåœ¨è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡ŒæŸä¸ªå¤–éƒ¨ç¨‹åºå¹¶å…³è”å…¶æ ‡å‡†è¾“å‡º12- name: get SHA of most recent commit debug: msg="&#123;&#123; lookup('pipe', 'git rev-parse HEAD') &#125;&#125;" envï¼šèŽ·å–è¿œç¨‹æœºå™¨ä¸Šçš„æŸä¸ªçŽ¯å¢ƒå˜é‡12- name: get the current shell debug: msg="&#123;&#123; lookup('env', 'SHELL') &#125;&#125;" passwordï¼šç”Ÿæˆéšæœºå¯†ç ï¼Œå¹¶å°†è¯¥å¯†ç å†™å…¥æŒ‡å®šæ–‡ä»¶1234- name: create deploy postgres user postgresql_user: name: deploy password: "&#123;&#123; lookup('password', 'deploy-password.txt') &#125;&#125;" redis-kvï¼šèŽ·å– redis æœåŠ¡å™¨ä¸ŠæŸä¸ª key çš„å€¼ï¼ˆéœ€è¦åœ¨è¿œç¨‹æœºå™¨ä¸Šå®‰è£… redis Python åº“ï¼‰12- name: look up value in Redis debug: msg="&#123;&#123; lookup('redis_kv', 'redis://localhost:6379,weather') &#125;&#125;" å¤æ‚å¾ªçŽ¯ åç§° è¾“å…¥ å¾ªçŽ¯è§„åˆ™ with_items åˆ—è¡¨ éåŽ†æ‰€æœ‰åˆ—è¡¨é¡¹ with_lines å‘½ä»¤ éåŽ†å‘½ä»¤è¾“å‡ºçš„æ‰€æœ‰è¡Œ with_fileglob Glob éåŽ†æ–‡ä»¶ï¼ˆæ–‡ä»¶åå¯ä½¿ç”¨é€šé…ç¬¦ï¼‰ with_first_found è·¯å¾„åˆ—è¡¨ è·¯å¾„ä¸­æ£€ç´¢åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ç›®æ ‡ with_dict å­—å…¸ éåŽ†å­—å…¸ä¸­çš„æ•°æ®é¡¹ with_flattened å¤šå±‚åˆ—è¡¨ éåŽ†å±•å¼€åŽçš„å¤šå±‚åˆ—è¡¨ with_inventory Host æ¨¡å¼ éåŽ†åŒ¹é…çš„ä¸»æœº with_linesï¼š12345# files/turing.txtLeslie LamportSilvio MicaliShafi GoldwasserJudea Pearl 1234567- name: Send out a slack message slack: domain: example.slack.com token: "&#123;&#123; slack_token &#125;&#125;" msg: "&#123;&#123; item &#125;&#125; was in the list" with_lines: - cat files/turing.txt with_fileglobï¼š12345- name: add public keys to account authorized_key: user=deploy key="&#123;&#123; lookup('file', item) &#125;&#125;" with_fileglob: - /var/keys/*.pub - keys/*.pub with_dictï¼š123- name: iterate over ansible_eth0 debug: msg=&#123;&#123; item.key &#125;&#125;=&#123;&#123; item.value &#125;&#125; with_dict: "&#123;&#123; ansible_eth0.ipv4 &#125;&#125;" å‚è€ƒèµ„æ–™Ansible Configuration Management - Second Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Ansible</tag>
        <tag>DevOps</tag>
        <tag>Playbooks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python3 ä¸­çš„æ—¶é—´ä¸Žæ—¥æœŸæ¨¡å—è¯¦è§£]]></title>
    <url>%2F2019%2F12%2F22%2Fpython3-date-and-time-manual%2F</url>
    <content type="text"><![CDATA[Python ä¸­ä¸åŒ…å«è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´çš„åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œä½†æ˜¯æä¾›äº†å¦‚ä¸‹ä¸‰ä¸ªæ¨¡å—ç”¨äºŽæ“ä½œæ—¶é—´æ—¥æœŸç±»åž‹çš„æ•°æ®ï¼š timeï¼šæä¾›ä¸Žæ—¶é—´ç›¸å…³çš„åŠŸèƒ½ã€‚åŒ…å«æ—¶é’Ÿæ—¶é—´ã€å¤„ç†å™¨è¿è¡Œæ—¶é—´ã€åŸºæœ¬çš„æ ¼å¼åŒ–å·¥å…·ç­‰ datetimeï¼šæä¾›å¤„ç†æ—¶é—´æ—¥æœŸçš„é«˜çº§æŽ¥å£ã€‚å¦‚æ—¶é—´æ—¥æœŸä¹‹é—´çš„ç®—æœ¯è®¡ç®—å’Œå¤§å°æ¯”è¾ƒç­‰ calendarï¼šæä¾›ç±»ä¼¼æ—¥åŽ†çš„å¹´ã€æœˆã€æ—¥ã€å‘¨çš„æ ¼å¼åŒ–è¾“å‡ºå’Œå…¶ä»–æ—¥åŽ†ç›¸å…³çš„åŠŸèƒ½ ä¸€ã€timetime æ¨¡å—åŒ…å«å¤šç§ç±»åž‹çš„â€œæ—¶é’Ÿâ€æ—¶é—´ï¼Œæ–¹ä¾¿å¤„ç†å¤šç§ä¸åŒéœ€æ±‚çš„ä»»åŠ¡ã€‚å¦‚ï¼š time() è¿”å›žè‡ªçºªå¹´ä»¥æ¥çš„ç§’æ•°ã€‚çºªå¹´æŒ‡ time.gmtime(0) å‡½æ•°çš„è¿”å›žå€¼ï¼Œå¤§å¤šæ•°ç³»ç»Ÿä¸­æ˜¯ 1970å¹´1æœˆ1æ—¥00:00:00ï¼ˆUTCï¼‰ monotonic() å¯ä»¥ç”¨æ¥æµ‹é‡é•¿æ—¶é—´è¿è¡Œçš„è¿›ç¨‹ï¼Œå®ƒä¸ä¼šå› ä¸ºç³»ç»Ÿæ—¶é—´è¢«ä¿®æ”¹è€Œå‘ç”Ÿå˜åŒ– perf_counter() æä¾›äº†ç²¾åº¦æœ€é«˜çš„æ—¶é—´é‡åº¦ï¼Œå› æ­¤å¤šç”¨äºŽèŽ·å–çŸ­æ—¶é—´æ®µçš„é«˜ç²¾åº¦ç»“æžœ process_time() è¿”å›žå½“å‰è¿›ç¨‹ä¸­ç³»ç»Ÿå’Œç”¨æˆ· CPU æ—¶é—´çš„æ€»å’Œã€‚ä¸åŒ…æ‹¬ sleep() æ—¶é—´ æµ‹è¯•ç¨‹åºï¼š1234567891011121314151617181920212223import textwrapimport timeavailable_clocks = [ ('time', time.time), ('monotonic', time.monotonic), ('perf_counter', time.perf_counter), ('process_time', time.process_time),]for clock_name, func in available_clocks: print(textwrap.dedent('''\ &#123;name&#125;: adjustable : &#123;info.adjustable&#125; implementation: &#123;info.implementation&#125; monotonic : &#123;info.monotonic&#125; resolution : &#123;info.resolution&#125; result : &#123;result&#125; ''').format( name=clock_name, info=time.get_clock_info(clock_name), result=func()) ) è¾“å‡ºä¸­åŒ…å«äº†å„æ—¶é’Ÿå‡½æ•°çš„å®žçŽ°æ–¹å¼ã€ç²¾åº¦å’Œæ‰§è¡Œç»“æžœç­‰ï¼š123456789101112131415161718192021222324252627time: adjustable : True implementation: clock_gettime(CLOCK_REALTIME) monotonic : False resolution : 1e-09 result : 1576935284.1307783monotonic: adjustable : False implementation: clock_gettime(CLOCK_MONOTONIC) monotonic : True resolution : 1e-09 result : 1653915.765674168perf_counter: adjustable : False implementation: clock_gettime(CLOCK_MONOTONIC) monotonic : True resolution : 1e-09 result : 1653915.765707337process_time: adjustable : False implementation: clock_gettime(CLOCK_PROCESS_CPUTIME_ID) monotonic : True resolution : 1e-09 result : 0.017164144 ä¸Šè¿°å‡ ä¸ªæ—¶é’Ÿå‡½æ•°ä¸­ï¼Œåªæœ‰ time.time() åœ¨è®¡ç®—æ—¶é—´æ—¶æœ‰æ˜Žç¡®çš„å‚è€ƒç‚¹ï¼ˆtime.gmtime(0)ï¼‰ï¼Œå¦å¤–ä¸‰ä¸ªå‡½æ•°éƒ½æ²¡æœ‰å®šä¹‰ç»å¯¹çš„èµ·ç‚¹ä½œä¸ºåŸºå‡†ï¼Œå› æ­¤å¸¸ç”¨æ¥è®¡ç®—æŸä¸ªè¿‡ç¨‹è€—è´¹çš„æ—¶é—´æ€»å’Œï¼ˆå¤šæ¬¡æ‰§è¡Œå¹¶è®¡ç®—æ—¶é—´å·®ï¼‰ï¼Œè€Œæ— æ³•èŽ·å–ä¸€ä¸ªæ ‡å‡†çš„ç»å¯¹æ—¶é—´ã€‚1234&gt;&gt;&gt; start = time.perf_counter()&gt;&gt;&gt; end = time.perf_counter()&gt;&gt;&gt; end - start8.590425299999993 ä¸Šè¿°å‡½æ•°è¿”å›žçš„éƒ½æ˜¯ä»¥ç§’ä¸ºå•ä½ç²¾åº¦è¾ƒé«˜çš„æµ®ç‚¹æ•°ã€‚å¯¹äºŽéœ€è¦è®°å½•æˆ–è€…æ‰“å°æ–¹ä¾¿é˜…è¯»çš„æ—¶é—´æ—¥æœŸæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ctime() å‡½æ•°ï¼š12345&gt;&gt;&gt; time.ctime()'Sat Dec 21 21:56:41 2019'&gt;&gt;&gt; later = time.time() + 30&gt;&gt;&gt; time.ctime(later)'Sat Dec 21 21:57:19 2019' time æ¨¡å—ä¸­è¿˜å®šä¹‰äº† struct_time ç»“æž„ç”¨æ¥è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ä¸­çš„æ¯ä¸€é¡¹ç‹¬ç«‹çš„å€¼ï¼ˆå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ç­‰ï¼‰ã€‚1234567&gt;&gt;&gt; loc_time = time.localtime()&gt;&gt;&gt; loc_timetime.struct_time(tm_year=2019, tm_mon=12, tm_mday=21, tm_hour=22, tm_min=20, tm_sec=32, tm_wday=5, tm_yday=355, tm_isdst=0)&gt;&gt;&gt; loc_time.tm_year2019&gt;&gt;&gt; loc_time.tm_hour22 æ—¶é—´çš„æ ¼å¼åŒ–è¾“å‡ºstrftime() å‡½æ•°å¯ä»¥ç”¨æ¥å°† struct_time æ ¼å¼çš„æ—¶é—´å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„å½¢å¼è¡¨ç¤ºã€‚strptime() å‡½æ•°çš„è¡Œä¸ºåˆ™ç›¸åã€‚å¦‚ï¼š1234567891011&gt;&gt;&gt; import time&gt;&gt;&gt; loc_time = time.localtime()&gt;&gt;&gt; loc_timetime.struct_time(tm_year=2019, tm_mon=12, tm_mday=21, tm_hour=23, tm_min=21, tm_sec=33, tm_wday=5, tm_yday=355, tm_isdst=0)&gt;&gt;&gt; time.strftime('%Y-%m-%d %H:%M:%S', loc_time)'2019-12-21 23:21:33'&gt;&gt;&gt; now = time.ctime()&gt;&gt;&gt; now'Sat Dec 21 23:23:31 2019'&gt;&gt;&gt; time.strptime(now)time.struct_time(tm_year=2019, tm_mon=12, tm_mday=21, tm_hour=23, tm_min=23, tm_sec=31, tm_wday=5, tm_yday=355, tm_isdst=-1) å¸¸è§çš„å­—ç¬¦ä¸²å½¢å¼çš„æ—¶é—´æ—¥æœŸæ ¼å¼å¦‚ä¸‹ï¼š1234&gt;&gt;&gt; time.strftime('%Y-%m-%d %H:%M:%S')'2019-12-21 23:26:40'&gt;&gt;&gt; time.strftime('%a %b %d %H:%M:%S %Y')'Sat Dec 21 23:27:15 2019' strftime() å‡½æ•°æ”¯æŒçš„æ›´å¤šæ ¼å¼å®šä¹‰å¯å‚è€ƒ help(time.strftime) ã€‚ äºŒã€datetimedatetime æ¨¡å—ä¸­å®šä¹‰çš„å‡½æ•°å’Œç±»å¯ä»¥å¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡Œè½¬æ¢ã€æ ¼å¼åŒ–è¾“å‡ºã€ç®—æœ¯è®¡ç®—ç­‰æ“ä½œã€‚ timetime ç±»å¯ä»¥è¡¨ç¤ºåŒ…å«æ—¶ã€åˆ†ã€ç§’ã€æ—¶åŒºç­‰ä¿¡æ¯çš„æ—¶é—´å¯¹è±¡ã€‚123456789101112&gt;&gt;&gt; import datetime&gt;&gt;&gt; t = datetime.time(1, 2, 3)&gt;&gt;&gt; print(t)01:02:03&gt;&gt;&gt; t.hour1&gt;&gt;&gt; t.minute2&gt;&gt;&gt; t.second3&gt;&gt;&gt; t.tzinfo&gt;&gt;&gt; datedate ç±»å¯ä»¥è¡¨ç¤ºåŒ…å«å¹´ã€æœˆã€æ—¥ç­‰ä¿¡æ¯çš„æ—¥æœŸå€¼ã€‚å…¶ today() æ–¹æ³•å¯ä»¥èŽ·å–å½“å¤©çš„æ—¥æœŸã€‚12345678910&gt;&gt;&gt; from datetime import date&gt;&gt;&gt; today = date.today()&gt;&gt;&gt; todaydatetime.date(2019, 12, 21)&gt;&gt;&gt; today.year2019&gt;&gt;&gt; today.month12&gt;&gt;&gt; today.day21 datetimedatetime æ¨¡å—ä¸­çš„ datetime ç±»å¯ä»¥è¡¨ç¤ºå®Œæ•´çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œç±»ä¼¼ time ç±»å’Œ date ç±»çš„ç»“åˆã€‚1234567891011121314151617&gt;&gt;&gt; import datetime&gt;&gt;&gt; now = datetime.datetime.now()&gt;&gt;&gt; nowdatetime.datetime(2019, 12, 22, 0, 30, 21, 372631)&gt;&gt;&gt; print(now)2019-12-22 00:30:21.372631&gt;&gt;&gt; t = datetime.time(1, 2, 3)&gt;&gt;&gt; print(t)01:02:03&gt;&gt;&gt; d = datetime.date.today()&gt;&gt;&gt; print(d)2019-12-22&gt;&gt;&gt; dt = datetime.datetime.combine(d, t)&gt;&gt;&gt; dtdatetime.datetime(2019, 12, 22, 1, 2, 3)&gt;&gt;&gt; print(dt)2019-12-22 01:02:03 timedeltatimedelta ç±»å¯ä»¥è¡¨ç¤ºæŸä¸ªç‰¹å®šé•¿åº¦çš„æ—¶é—´æ®µï¼ˆä»¥å¹´æœˆæ—¥æˆ–æ—¶åˆ†ç§’ç­‰ä¸ºå•ä½ï¼‰ã€‚ä¸¤ä¸ª datetime ç›¸å‡ä¼šå¾—åˆ° timedelta å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç”¨ datetime åŠ ä¸Šæˆ–è€…å‡åŽ» timedelta å¾—åˆ°æ–°çš„æ—¶é—´å€¼ã€‚ æ—¥æœŸåŠ å‡ï¼š123456789&gt;&gt;&gt; import datetime&gt;&gt;&gt; today = datetime.date.today()&gt;&gt;&gt; todaydatetime.date(2019, 12, 22)&gt;&gt;&gt; twodays = datetime.timedelta(days=2)&gt;&gt;&gt; print(twodays)2 days, 0:00:00&gt;&gt;&gt; today - twodaysdatetime.date(2019, 12, 20) æ—¶é—´åŠ å‡ï¼š1234567891011&gt;&gt;&gt; import datetime&gt;&gt;&gt; now = datetime.datetime.now()&gt;&gt;&gt; print(now)2019-12-22 00:35:30.298198&gt;&gt;&gt; delta = datetime.timedelta(days=1, minutes=30)&gt;&gt;&gt; print(delta)1 day, 0:30:00&gt;&gt;&gt; now - deltadatetime.datetime(2019, 12, 21, 0, 5, 30, 298198)&gt;&gt;&gt; print(now - delta)2019-12-21 00:05:30.298198 æ¯”è¾ƒå¤§å°12345678910111213141516&gt;&gt;&gt; t1 = datetime.time(12, 30, 20)&gt;&gt;&gt; print(t1)12:30:20&gt;&gt;&gt; t2 = datetime.time(11, 20, 40)&gt;&gt;&gt; print(t2)11:20:40&gt;&gt;&gt; t2 &gt; t1False&gt;&gt;&gt; today = datetime.date.today()&gt;&gt;&gt; print(today)2019-12-22&gt;&gt;&gt; tomorrow = today + datetime.timedelta(days=1)&gt;&gt;&gt; print(tomorrow)2019-12-23&gt;&gt;&gt; today &lt; tomorrowTrue æ ¼å¼åŒ–è¾“å‡ºdatetime ç±»ä¸­ä¹Ÿæä¾›äº† strftime å’Œ strptime æ–¹æ³•ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910&gt;&gt;&gt; import datetime&gt;&gt;&gt; format = "%a %b %d %H:%M:%S %Y"&gt;&gt;&gt; now = datetime.datetime.now()&gt;&gt;&gt; nowdatetime.datetime(2019, 12, 22, 1, 7, 53, 505983)&gt;&gt;&gt; s = now.strftime(format)&gt;&gt;&gt; s'Sun Dec 22 01:07:53 2019'&gt;&gt;&gt; datetime.datetime.strptime(s, format)datetime.datetime(2019, 12, 22, 1, 7, 53) ä¸‰ã€calendarè¿™éƒ¨åˆ†çš„åŠŸèƒ½ç›®å‰è¿˜æ²¡ç”¨åˆ°ï¼Œç®€å•ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031&gt;&gt;&gt; import calendar&gt;&gt;&gt; c = calendar.TextCalendar(calendar.SUNDAY)&gt;&gt;&gt; c.prmonth(2019, 12) December 2019Su Mo Tu We Th Fr Sa 1 2 3 4 5 6 7 8 9 10 11 12 13 1415 16 17 18 19 20 2122 23 24 25 26 27 2829 30 31&gt;&gt;&gt; cal = calendar.TextCalendar(calendar.SUNDAY)&gt;&gt;&gt; print(cal.formatyear(2020, 2, 1, 1, 3)) 2020 January February MarchSu Mo Tu We Th Fr Sa Su Mo Tu We Th Fr Sa Su Mo Tu We Th Fr Sa 1 2 3 4 1 1 2 3 4 5 6 7 5 6 7 8 9 10 11 2 3 4 5 6 7 8 8 9 10 11 12 13 1412 13 14 15 16 17 18 9 10 11 12 13 14 15 15 16 17 18 19 20 2119 20 21 22 23 24 25 16 17 18 19 20 21 22 22 23 24 25 26 27 2826 27 28 29 30 31 23 24 25 26 27 28 29 29 30 31 April May JuneSu Mo Tu We Th Fr Sa Su Mo Tu We Th Fr Sa Su Mo Tu We Th Fr Sa 1 2 3 4 1 2 1 2 3 4 5 6 5 6 7 8 9 10 11 3 4 5 6 7 8 9 7 8 9 10 11 12 1312 13 14 15 16 17 18 10 11 12 13 14 15 16 14 15 16 17 18 19 2019 20 21 22 23 24 25 17 18 19 20 21 22 23 21 22 23 24 25 26 2726 27 28 29 30 24 25 26 27 28 29 30 28 29 30 31... å‚è€ƒèµ„æ–™THE PYTHON 3 STANDARD LIBRARY BY EXAMPLE]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Basic</tag>
        <tag>Datastructure</tag>
        <tag>Datetime</tag>
        <tag>Date</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django REST framework å®žçŽ°æ–‡ä»¶ä¸Šä¼ çš„ä¸¤ç§æ–¹å¼]]></title>
    <url>%2F2019%2F12%2F21%2Ffile-upload-by-django-rest-framework-two-ways%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åŸºäºŽ Django modelsDjango æ¡†æž¶çš„æ•°æ®æ¨¡åž‹ï¼ˆmodels ç±»ï¼‰ä¸­å®šä¹‰äº† ImageField å’Œ FileField ç­‰ç±»åž‹çš„å­—æ®µï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨å›¾ç‰‡æˆ–è€…æ–‡ä»¶å¯¹è±¡ã€‚ImageField å’Œ FileField é’ˆå¯¹æ–‡ä»¶å¯¹è±¡çš„å±žæ€§å’Œè¡Œä¸ºå°è£…äº†æ˜“äºŽä½¿ç”¨çš„ APIï¼Œé…åˆ Django REST framework æä¾›çš„ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå¯ä»¥åœ¨ç¼–å†™å¾ˆå°‘é‡ä»£ç çš„æƒ…å†µä¸‹å®Œæˆåˆæ­¥çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€‚ å„ç»„ä»¶ä»£ç Models12345from django.db import modelsclass FileModel(models.Model): name = models.CharField(max_length=50) file = models.FileField(upload_to='upload') Serializers12345678from .models import FileModelfrom rest_framework import serializersclass FileSerializer(serializers.ModelSerializer): class Meta: model = FileModel fields = '__all__' Views1234567from rest_framework import viewsetsfrom .models import FileModelfrom .serializers import FileSerializerclass FileViewSet(viewsets.ModelViewSet): queryset = FileModel.objects.all() serializer_class = FileSerializer Urls12345678910from django.urls import path, includefrom &lt;appname&gt;.views import FileViewSetfrom rest_framework import routersrouter = routers.DefaultRouter()router.register(r'upload', FileViewSet)urlpatterns = [ path('', include(router.urls)),] åŠŸèƒ½æµ‹è¯•ä½¿ç”¨ HTTPie å·¥å…·åˆ©ç”¨ POST æ–¹æ³•ä»¥ Form è¡¨å•çš„å½¢å¼ï¼ˆ-fï¼‰æäº¤ä¸Šä¼ çš„æ–‡ä»¶ï¼š12345678$ http -f POST http://127.0.0.1:8000/upload/ name="test" file@test.txtHTTP/1.1 201 Created&#123; "file": "http://127.0.0.1:8000/upload/upload/test.txt", "id": 4, "name": "test"&#125; åŒæ—¶ä¹Ÿå¯ä»¥ç›´æŽ¥è®¿é—® http://127.0.0.1:8000/upload/ ï¼Œé€šè¿‡ Django REST framework æä¾›çš„å‰ç«¯ç•Œé¢æ‰‹åŠ¨ä¸Šä¼ æ–‡ä»¶ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‰ç«¯ç•Œé¢ï¼ŒHTML ä¸Šä¼ é¡µé¢ç¤ºä¾‹ä»£ç ï¼š1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action="http://xx.xx.xx.xx:8000/upload/" method="post" enctype="multipart/form-data"&gt; &lt;input type="text" name="name" placeholder="name"&gt;&lt;br&gt; &lt;input type="file" name="file"&gt;&lt;br&gt; &lt;input type="submit" value="submit"&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; äºŒã€FileFieldå¯¹äºŽ FileField ç±»åž‹çš„æ–‡ä»¶å­—æ®µï¼ŒåŽå°çš„è§†å›¾ä»£ç å¯ä»¥é€šè¿‡ requests.FILES èŽ·å–ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®ã€‚å¦‚ requests.FILES[&#39;file&#39;]ã€‚åªæœ‰å½“è¯·æ±‚æ–¹æ³•ä¸º POST ä¸”å‰ç«¯çš„ &lt;form&gt; å¸¦æœ‰å±žæ€§ enctype=&quot;multipart/form-data&quot; æ—¶ï¼Œrequest.FILES æ‰èƒ½æŽ¥æ”¶åˆ°æ•°æ®ï¼Œå¦åˆ™ä¸ºç©ºã€‚ FileField å­—æ®µçš„ upload_to å±žæ€§ç”¨äºŽæŒ‡å®šä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜ä½ç½®ï¼Œä»¥ settings.py ä¸­å®šä¹‰çš„ MEDIA_ROOT ä¸ºè·¯å¾„å‰ç¼€ã€‚upload_to å±žæ€§å¯ä»¥æŽ¥æ”¶åŒ…å« strftime() æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼ˆ/%Y/%m/%dï¼‰ï¼Œç”¨æ¥å®šä¹‰ç±»ä¼¼ /year/month/day æ ¼å¼çš„è·¯å¾„ã€‚å¦‚ï¼š12# æ–‡ä»¶ä¸Šä¼ è‡³ç±»ä¼¼ MEDIA_ROOT/uploads/2019/12/20 çš„è·¯å¾„ä¸‹upload = models.FileField(upload_to='uploads/%Y/%m/%d/') å¯ä»¥ä½¿ç”¨ models æä¾›çš„æŸ¥è¯¢æŽ¥å£èŽ·å–å·²ä¸Šä¼ æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼š1234567891011121314$ python manage.py shell(InteractiveConsole)&gt;&gt;&gt; from &lt;appname&gt;.models import FileModel&gt;&gt;&gt; test = FileModel.objects.get(name='test') # èŽ·å–æŸä¸€æ¡æ•°æ®è®°å½•&gt;&gt;&gt; test.file # æ•°æ®è®°å½•å…³è”çš„æ–‡ä»¶å¯¹è±¡&lt;FieldFile: upload/test.txt&gt;&gt;&gt;&gt; test.file.name # æ–‡ä»¶å'upload/test.txt'&gt;&gt;&gt; test.file.url # æ–‡ä»¶ URL'upload/test.txt'&gt;&gt;&gt; test.file.size # æ–‡ä»¶å¤§å°22&gt;&gt;&gt; test.file.path # æ–‡ä»¶è·¯å¾„'/home/starky/program/python/web/django/filestorage/media/upload/test.txt' é€šè¿‡æ•°æ®æ¨¡åž‹æ£€ç´¢åˆ°çš„æ–‡ä»¶ï¼ˆtest.fileï¼‰ä¸º FieldFile å¯¹è±¡ã€‚FieldFile ç±»å°è£…äº†ä¸€äº›ä¾¿æ·çš„ API å¯ä»¥ç”¨æ¥æ“ä½œå…³è”çš„åº•å±‚æ–‡ä»¶ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„ç¤ºä¾‹ã€‚ è¯»å–æ–‡ä»¶å†…å®¹1234567&gt;&gt;&gt; test = FileModel.objects.get(name='test')&gt;&gt;&gt; test.file&lt;FieldFile: upload/test.txt&gt;&gt;&gt;&gt; with test.file.open('rb') as f:... f.read()...b'sdfsdfsdfweofssdnvdvs\n' å†™å…¥æ–°çš„å†…å®¹123456&gt;&gt;&gt; with test.file.open('wb') as f:... f.write(b'Hello, World')...12&gt;&gt;&gt; test.file.open().read()b'Hello, World' åˆ é™¤å…³è”çš„åº•å±‚æ–‡ä»¶123&gt;&gt;&gt; test.file.delete()&gt;&gt;&gt; test.file&lt;FieldFile: None&gt; æ–°å»ºæ–‡ä»¶è¯­æ³•æ ¼å¼ä¸º FieldFile.save(name, content, save=True)å…¶ä¸­ content å‚æ•°å¿…é¡»æŽ¥æ”¶ django.core.files.File ç±»æˆ–è€…å…¶å­ç±»çš„å®žä¾‹ï¼Œæ¯”å¦‚ ContentFileï¼Œä¸èƒ½ç›´æŽ¥ä½¿ç”¨ Python å†…ç½®çš„ file å¯¹è±¡ã€‚ ä¸ç®¡æ˜¯åˆ é™¤ï¼ˆFieldFile.delete()ï¼‰è¿˜æ˜¯æ–°å»ºï¼ˆFieldFile.save()ï¼‰æ–‡ä»¶ï¼Œsave å‚æ•°é»˜è®¤éƒ½ä¸º Trueã€‚å³è‡ªåŠ¨è°ƒç”¨æ¨¡åž‹å®žä¾‹çš„ save() æ–¹æ³•æäº¤å¯¹æ•°æ®åº“çš„æ”¹åŠ¨ã€‚ 12345678910&gt;&gt;&gt; testnew = FileModel(name='testnew', file=None)&gt;&gt;&gt; testnew.file&lt;FieldFile: None&gt;&gt;&gt;&gt; from django.core.files.base import ContentFile&gt;&gt;&gt; content = ContentFile('Hello, Django!')&gt;&gt;&gt; testnew.file.save('testnew.txt', content)&gt;&gt;&gt; testnew.file&lt;FieldFile: upload/testnew.txt&gt;&gt;&gt;&gt; testnew.file.open().read()b'Hello, Django!' ä¸‰ã€FileUploadParserDjango REST framework æä¾›äº† parsers.FileUploadParser ç±»ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†åŽŸå§‹æ ¼å¼çš„æ–‡ä»¶å†…å®¹çš„ä¸Šä¼ ã€‚åŽç«¯èŽ·å–åˆ°çš„ request.data ä¸ºå­—å…¸ç»“æž„ï¼Œå…¶ä¸­åŒ…å«çš„ &#39;file&#39; é”®å¯¹åº”çš„å€¼å³ä¸ºä¸Šä¼ çš„æ–‡ä»¶å¯¹è±¡ã€‚ å¦‚æžœ FileUploadParser ç±»è¢«åŒ…å« filename å‚æ•°çš„ URL è°ƒç”¨ï¼Œåˆ™è¯¥å‚æ•°ä¼šä½œä¸ºæ–‡ä»¶ä¿å­˜åˆ°æœåŠ¡ç«¯åŽçš„æ–‡ä»¶åã€‚è‹¥ URL ä¸­ä¸åŒ…å« filename å‚æ•°ï¼Œåˆ™å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚å¿…é¡»åŒ…å« Content-Disposition è¯·æ±‚å¤´åŠ filename å‚æ•°ã€‚å¦‚ Content-Disposition: attachment; filename=upload.jpgã€‚ ç¤ºä¾‹ä»£ç 12345678910111213141516# views.pyfrom rest_framework.views import APIViewfrom rest_framework.response import Responsefrom rest_framework.parsers import FileUploadParserclass FileUploadView(APIView): parser_classes = [FileUploadParser, ] def put(self, request, filename, format=None): file_obj = request.data['file'] with open(filename, 'wb') as f: for chunk in file_obj.chunks(): f.write(chunk) return Response(f'&#123;filename&#125; uploaded',status=204) 123456# urls.pyfrom django.urls import re_pathurlpatterns = [ re_path(r'^files/(?P&lt;filename&gt;[^/]+)$', views.FileUploadView.as_view()),] ä¸Šä¼ æŽ¥å£çš„ URL ä¸º http://xx.xx.xx.xx/files/&lt;filename&gt; ï¼Œå…¶ä¸­ &lt;filenmae&gt; ç”¨äºŽæŒ‡å®šä¸Šä¼ æˆåŠŸåŽåœ¨æœåŠ¡å™¨ç«¯çš„æ–‡ä»¶åã€‚å®¢æˆ·ç«¯ä½¿ç”¨ PUT è¯·æ±‚ä¸Šä¼ æ–‡ä»¶ã€‚ ä½¿ç”¨ postman æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š å‰ç«¯ä¸Šä¼ ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼ˆä½¿ç”¨ jQueryï¼Œæœ‰å¯èƒ½å‡ºçŽ°è·¨åŸŸé—®é¢˜ï¼Œå¯å‚è€ƒç½‘ä¸Šèµ„æ–™è§£å†³ï¼‰ï¼š12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form&gt; &lt;p&gt;ä¸Šä¼ æ–‡ä»¶ï¼š &lt;input type="file" name="files" id='files' /&gt;&lt;/p&gt; &lt;input type="button" value="ä¸Šä¼ " onclick="doUpload()" /&gt; &lt;/form&gt; &lt;script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; function doUpload() &#123; $.ajax(&#123; url: 'http://xx.xx.xx.xx:8000/files/test.jpg', type: 'PUT', data: $('#files')[0].files[0], cache: false, processData: false, contentType: false, async: false &#125;).done(function (res) &#123; alert("ä¸Šä¼ æˆåŠŸ") &#125;).fail(function (res) &#123; alert("ä¸Šä¼ å¤±è´¥ï¼š" + res) &#125;); &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å‚è€ƒèµ„æ–™Managing filesmodels.FileFieldparsers]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>REST</tag>
        <tag>API</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ•ˆ Python ä»£ç â€”â€”ç±»ä¸Žç»§æ‰¿]]></title>
    <url>%2F2019%2F12%2F14%2Feffective-python-class-and-inherit%2F</url>
    <content type="text"><![CDATA[ä¸€ã€ç”¨è¾…åŠ©ç±»ï¼ˆè€Œä¸æ˜¯å­—å…¸ï¼‰æ¥ç»´æŠ¤ç¨‹åºçš„çŠ¶æ€Python å†…ç½®çš„å­—å…¸ç±»åž‹å¯ä»¥å¾ˆå¥½åœ°ä¿å­˜æŸä¸ªå¯¹è±¡åœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­çš„ï¼ˆåŠ¨æ€ï¼‰å†…éƒ¨çŠ¶æ€ã€‚å¦‚ä¸‹é¢çš„æˆç»©å•ç±»ï¼š12345678910111213141516171819202122class SimpleGradebook(object): def __init__(self): self._grades = &#123;&#125; def add_student(self, name): self._grades[name] = [] def report_grade(self, name, score): self._grades[name].append(score) def average_grade(self, name): grades = self._grades[name] return sum(grades) / len(grades)book = SimpleGradebook()book.add_student('Isaac Newton')book.report_grade('Isaac Newton', 90)book.report_grade('Isaac Newton', 80)print(book.average_grade('Isaac Newton'))# =&gt; 85.0 åœ¨ä¸Šé¢çš„ SimpleGradebook ç±»ä¸­ï¼Œå­¦ç”Ÿåå­—åŠå…¶å¯¹åº”çš„æˆç»©éƒ½ä¿å­˜åœ¨ _grades å­—å…¸ç»“æž„ä¸­ï¼Œè¿™æ ·å°±ä¸å¿…æŠŠæ¯ä¸ªå­¦ç”Ÿéƒ½è¡¨ç¤ºæˆå¯¹è±¡å¹¶é¢„è®¾ä¸€ä¸ªç”¨äºŽå­˜æ”¾åå­—çš„å±žæ€§äº†ã€‚ å­—å…¸ç±»åž‹ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œä½†ä¹Ÿå®¹æ˜“å› ä¸ºè¿‡åº¦ä½¿ç”¨å¯¼è‡´ä¸€äº›é—®é¢˜ã€‚å¦‚æžœéœ€è¦æ‰©å……ä¸Šé¢æˆç»©å•ç±»çš„åŠŸèƒ½ï¼ŒæŠŠå­¦ç”Ÿæˆç»©æŒ‰ç…§ç§‘ç›®ä¿å­˜ã€‚åˆ™ _grades å­—å…¸ä¸­éœ€è¦åµŒå…¥å¦ä¸€ä¸ªå­—å…¸å­˜å‚¨ç§‘ç›®ä¸Žå¤šæ¬¡æˆç»©çš„é”®å€¼å¯¹ã€‚å³ç±»ä¼¼è¿™æ ·çš„ç»“æž„ï¼š{&#39;Einstein&#39;: {&#39;Math&#39;: [80, 90]}}123456789101112131415161718192021222324252627282930class BySubjectGradebook(object): def __init__(self): self._grades = &#123;&#125; def add_student(self, name): self._grades[name] = &#123;&#125; def report_grade(self, name, subject, grade): by_subject = self._grades[name] grade_list = by_subject.setdefault(subject, []) grade_list.append(grade) def average_grade(self, name): by_subject = self._grades[name] total, count = 0, 0 for grades in by_subject.values(): total += sum(grades) count += len(grades) return total / countbook = BySubjectGradebook()book.add_student('Albert Einstein')book.report_grade('Albert Einstein', 'Math', 80)book.report_grade('Albert Einstein', 'Math', 90)book.report_grade('Albert Einstein', 'Gym', 70)book.report_grade('Albert Einstein', 'Gym', 80)print(book.average_grade('Albert Einstein'))# =&gt; 80.0 å‡è®¾éœ€æ±‚å†æ¬¡æ”¹å˜ï¼Œåœ¨è®°å½•æŸä¸ªåˆ†æ•°çš„åŒæ—¶ï¼Œè¿˜éœ€è¦è®°å½•è¯¥æ¬¡æˆç»©å è¯¥ç§‘ç›®åŽ†æ¬¡æˆç»©çš„æƒé‡ã€‚ã€‚ã€‚æ­¤æ—¶ç”¨äºŽä¿å­˜æˆç»©çš„æ•°æ®ç»“æž„å¯ä»¥æ”¹æˆè¿™æ ·ï¼š{&#39;Einstein&#39;: {&#39;Math&#39;: [(80, 0.4), (90, 0.6)]}}ä½†æ˜¯å¯¹äºŽæ–°çš„ average_grade æ–¹æ³•æ¥è¯´ï¼Œå¤„ç†ä¸Šè¿°æ•°æ®è®°å½•çš„ä»£ç å°±æ¯”è¾ƒéš¾ä»¥ç†è§£äº†ã€‚ æŠŠåµŒå¥—ç»“æž„é‡æž„ä¸ºç±»ç”¨æ¥ä¿å­˜ç¨‹åºçŠ¶æ€çš„æ•°æ®ç»“æž„ä¸€æ—¦è¿‡äºŽå¤æ‚ï¼ˆå¦‚åŒ…å«å¤šå±‚åµŒå¥—ï¼‰ï¼Œåˆ™åº”è¯¥å°†å…¶æ‹†è§£ä¸ºç±»ï¼Œæä¾›æ›´ä¸ºæ˜Žç¡®çš„æŽ¥å£ï¼ŒåŒæ—¶æ›´å¥½çš„å°è£…æ•°æ®ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657from collections import namedtupleGrade = namedtuple('Grade', ('score', 'weight'))# ç§‘ç›®ç±»ã€‚_grades å±žæ€§ç”¨äºŽä¿å­˜å¸¦æƒé‡çš„åˆ†æ•°ï¼ˆGrade()ï¼‰å¯¹è±¡# average_grade æ–¹æ³•ç”¨äºŽæŒ‰æƒé‡è®¡ç®—æœ¬ç§‘æˆç»©çš„å¹³å‡åˆ†class Subject(object): def __init__(self): self._grades = [] def report_grade(self, score, weight): self._grades.append(Grade(score, weight)) def average_grade(self): total, total_weight = 0, 0 for grade in self._grades: total += grade.score * grade.weight total_weight += grade.weight return total / total_weight# å­¦ç”Ÿç±»ã€‚_subjects å±žæ€§ç”¨äºŽä¿å­˜è¯¥å­¦ç”Ÿçš„æ‰€æœ‰ç§‘ç›®ï¼ˆSubject()ï¼‰å¯¹è±¡# average_grade æ–¹æ³•ç”¨äºŽè®¡ç®—è¯¥å­¦ç”Ÿæ‰€æœ‰ç§‘ç›®æˆç»©çš„å¹³å‡åˆ†class Student(object): def __init__(self): self._subjects = &#123;&#125; def subject(self, name): if name not in self._subjects: self._subjects[name] = Subject() return self._subjects[name] def average_grade(self): total, count = 0, 0 for subject in self._subjects.values(): total += subject.average_grade() count += 1 return total / count# æˆç»©å•ç±»ã€‚_students å±žæ€§ä¿å­˜æ‰€æœ‰çš„å­¦ç”Ÿï¼ˆStudent()ï¼‰å¯¹è±¡class Gradebook(object): def __init__(self): self._students = &#123;&#125; def student(self, name): if name not in self._students: self._students[name] = Student() return self._students[name]book = Gradebook()albert = book.student('Albert Einstein')math = albert.subject('Math')math.report_grade(80, 0.4)math.report_grade(90, 0.6)print(albert.average_grade())# =&gt; 86.0 è¦ç‚¹ å°½é‡ä¸ä½¿ç”¨å¤šå±‚åµŒå¥—çš„å­—å…¸ï¼ˆå¦‚åŒ…å«å…¶ä»–å­—å…¸çš„å­—å…¸ï¼‰å­˜å‚¨ç¨‹åºçŠ¶æ€ï¼Œä¹Ÿä¸è¦ä½¿ç”¨è¿‡é•¿çš„å…ƒç»„ å®¹å™¨ä¸­åŒ…å«ç®€å•åˆä¸å¯å˜çš„æ•°æ®ï¼Œå¯ä»¥å…ˆä½¿ç”¨ namedtuple è¡¨ç¤ºï¼Œæœ‰éœ€è¦æ—¶å†æ”¹ä¸ºå®Œæ•´çš„ç±» ç”¨äºŽä¿å­˜ç¨‹åºå†…éƒ¨çŠ¶æ€çš„å­—å…¸è‹¥è¿‡äºŽå¤æ‚ï¼Œåº”å°†å…¶æ‹†è§£ä¸ºå¤šä¸ªè¾…åŠ©ç±» äºŒã€ç”¨ super åˆå§‹åŒ–çˆ¶ç±»åˆå§‹åŒ–çˆ¶ç±»çš„ä¼ ç»Ÿæ–¹å¼ï¼Œæ˜¯åœ¨å­ç±»é‡Œç›´æŽ¥è°ƒç”¨çˆ¶ç±»çš„ __init__ æ–¹æ³•ï¼š1234567class MyBaseClass(object): def __init__(self, value): self.value = valueclass MyChildClass(MyBaseClass): def __init__(self): MyBaseClass.__init__(self, 5) ä¸Šè¿°æ–¹æ³•å¯¹äºŽç®€å•çš„ç»§æ‰¿è¡Œä¸ºæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹ä»ä¼šå‡ºçŽ°é—®é¢˜ã€‚é¦–å…ˆè‹¥å­ç±»å—åˆ°å¤šé‡ç»§æ‰¿çš„å½±å“ï¼Œåˆ™ç›´æŽ¥è°ƒç”¨çˆ¶ç±»çš„ __init__ æ–¹æ³•ä¼šäº§ç”Ÿæ— æ³•é¢„çŸ¥çš„è¡Œä¸ºï¼ˆè°ƒç”¨é¡ºåºä¸ç¡®å®šï¼‰ã€‚1234567891011121314151617181920212223242526272829class MyBaseClass(object): def __init__(self, value): self.value = valueclass TimesTwo(object): def __init__(self): self.value *= 2class PlusFive(object): def __init__(self): self.value += 5class OneWay(MyBaseClass, TimesTwo, PlusFive): def __init__(self, value): MyBaseClass.__init__(self, value) TimesTwo.__init__(self) PlusFive.__init__(self)class AnotherWay(MyBaseClass, TimesTwo, PlusFive): def __init__(self, value): MyBaseClass.__init__(self, value) PlusFive.__init__(self) TimesTwo.__init__(self)foo = OneWay(5)print(f"First ordering is (5 * 2) + 5 = &#123;foo.value&#125;")bar = AnotherWay(5)print(f"Second ordering still is &#123;foo.value&#125;") OneWay ä¸Ž AnotherWay ä¸­å®šä¹‰äº†ä¸¤ç§å®Œå…¨ä¸åŒçš„è°ƒç”¨çˆ¶ç±» __init__ æ–¹æ³•çš„é¡ºåºï¼Œä½†å®žé™…æ‰§è¡Œçš„ç»“æžœå´æ˜¯ç›¸åŒçš„ï¼Œå¯¼è‡´å­ç±»ä»£ç ä¸­å®šä¹‰çš„è°ƒç”¨é¡ºåºä¸Žå­ç±»å®žé™…äº§ç”Ÿçš„è¡Œä¸ºä¸ä¸€è‡´ã€‚ æ­¤å¤–åœ¨è±å½¢ç»§æ‰¿ä¸­ï¼Œç›´æŽ¥è°ƒç”¨çˆ¶ç±»çš„æž„é€ å™¨ä¹Ÿä¼šå‡ºçŽ°é—®é¢˜ã€‚è±å½¢ç»§æ‰¿æ˜¯æŒ‡å­ç±»ç»§æ‰¿è‡ªä¸¤ä¸ªå•ç‹¬çš„è¶…ç±»ï¼Œè€Œè¿™ä¸¤ä¸ªçˆ¶ç±»åˆéƒ½ç»§æ‰¿è‡ªåŒä¸€ä¸ªå…¬å…±åŸºç±»ã€‚è¿™ç§ç»§æ‰¿æ–¹å¼ä¼šä½¿è±å½¢é¡¶éƒ¨çš„å…¬å…±åŸºç±»å¤šæ¬¡æ‰§è¡Œå…¶ __init__ æ–¹æ³•ï¼Œäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚12345678910111213141516171819202122class MyBaseClass(object): def __init__(self, value): self.value = valueclass TimesFive(MyBaseClass): def __init__(self, value): MyBaseClass.__init__(self, value) self.value *= 5class PlusTwo(MyBaseClass): def __init__(self, value): MyBaseClass.__init__(self, value) self.value += 2class ThisWay(TimesFive, PlusTwo): def __init__(self, value): TimesFive.__init__(self, value) PlusTwo.__init__(self, value)foo = ThisWay(5)print(f"Should be (5 * 5) + 2 = 27 but actully is &#123;foo.value&#125;")# =&gt; Should be (5 * 5) + 2 = 27 but actully is 7 æœ€ç»ˆç»“æžœä¸º 7ï¼ŒåŽŸå› æ˜¯åœ¨è°ƒç”¨ç¬¬äºŒä¸ªçˆ¶ç±»çš„æž„é€ å™¨ï¼ˆå³ PlusTwo.__init__ï¼‰æ—¶ï¼Œå…¬å…±åŸºç±»çš„æž„é€ å™¨ï¼ˆå³ MyBaseClass.__init__ï¼‰ä¼šå†æ¬¡è¢«è°ƒç”¨å¯¼è‡´ value é‡æ–°å˜æˆ 5ï¼Œè€Œä¸èƒ½ä¿æŒ TimesFive.__init__ ä¹‹åŽçš„ 25ã€‚ é€šè¿‡ super è°ƒç”¨çˆ¶ç±»çš„æž„é€ å™¨ï¼š123456789101112131415161718192021class MyBaseClass(object): def __init__(self, value): self.value = valueclass TimesFive(MyBaseClass): def __init__(self, value): super(__class__, self).__init__(value) self.value *= 5class PlusTwo(MyBaseClass): def __init__(self, value): super(__class__, self).__init__(value) self.value += 2class ThisWay(TimesFive, PlusTwo): def __init__(self, value): super(__class__, self).__init__(value)foo = ThisWay(5)print(f"Should be (5 * 5) + 2 = 27 but actully is &#123;foo.value&#125;")# =&gt; Should be (5 * 5) + 2 = 27 but actully is 35 æ­¤æ—¶ç¨‹åºçš„è¡Œä¸ºå¯ä»¥è¯´å’Œé¢„æœŸç›¸ç¬¦åˆäº†ï¼Œæ³¨æ„åŽä¸‰ä¸ªç±»ä¸­ super çš„ä½¿ç”¨ã€‚å…¶ä¸­ä¼ å…¥ super çš„ç¬¬ä¸€ä¸ªå‚æ•° __class__ ç”¨æ¥æŒ‡ä»£å½“å‰ç±»æœ¬èº«ã€‚ ä¸‰ã€åªåœ¨ä½¿ç”¨ Mix-in åˆ¶ä½œå·¥å…·ç±»æ—¶è¿›è¡Œå¤šé‡ç»§æ‰¿åº”åœ¨ Python ç¼–ç¨‹ä¸­å°½é‡é¿å¼€å¤šé‡ç»§æ‰¿ã€‚è‹¥ä¸€å®šè¦åˆ©ç”¨å¤šé‡ç»§æ‰¿å¸¦æ¥çš„ä¾¿æ·åŠå°è£…æ€§ï¼Œåº”è€ƒè™‘ç¼–å†™ mix-in ç±»ã€‚mix-in æ˜¯ä¸€ç§â€œå°åž‹â€ç±»ï¼Œå…¶ä¸­åªå®šä¹‰äº†å…¶ä»–ç±»å¯èƒ½éœ€è¦æä¾›çš„ä¸€å¥—é™„åŠ æ–¹æ³•ï¼Œä½†æ˜¯ä¸å®šä¹‰è‡ªèº«çš„å®žä¾‹å±žæ€§ï¼Œä¹Ÿä¸è¦æ±‚ç»§æ‰¿è€…è°ƒç”¨è‡ªå·±çš„ __init__ æž„é€ å™¨ã€‚ å¯ä»¥åœ¨ mix-in é‡Œé¢é€šè¿‡åŠ¨æ€æ£€æµ‹æœºåˆ¶ç¼–å†™ä¸€å¥—é€šç”¨çš„åŠŸèƒ½ä»£ç ï¼Œæ ¹æ®å¯¹å„ç±»å¯¹è±¡å½“å‰çŠ¶æ€çš„åˆ¤å®šï¼Œç¡®å®šä»£ç å®žé™…çš„è¡Œä¸ºã€‚ä»Žè€Œå°† mix-in åº”ç”¨åˆ°å¤šä¸ªä¸åŒçš„ç±»ä¸Šé¢ã€‚åˆ†å±‚åœ°ç»„åˆ mix-in ç±»å¯ä»¥å‡å°‘é‡å¤ä»£ç å¹¶æå‡ä»£ç å¤ç”¨ç¨‹åº¦ã€‚å¦‚éœ€è¦å°†å†…å­˜ä¸­çš„ Python å¯¹è±¡è½¬æ¢ä¸ºå­—å…¸ç»“æž„ï¼ˆå³é€šå¸¸æ‰€è¯´çš„åºåˆ—åŒ–æ“ä½œï¼‰ï¼Œå¯ä»¥åˆ›å»ºä¸‹é¢çš„ mix-in ç±»å®žçŽ°æ­¤åŠŸèƒ½å¹¶æ·»åŠ  public æ–¹æ³•ä¾›å…¶ä»–ç±»ç»§æ‰¿ã€‚é‡ç‚¹åœ¨äºŽé€šè¿‡ hasattr åŠ¨æ€åœ°è®¿é—®å®žä¾‹çš„å±žæ€§ã€ç”¨ isinstance åŠ¨æ€åœ°æ£€æµ‹å¯¹è±¡ç±»åž‹ã€ç”¨ __dict__ è®¿é—®å®žä¾‹å†…éƒ¨çš„å­—å…¸ã€‚12345678910111213141516171819202122232425262728293031323334353637# todict.pyclass ToDictMixin(object): def to_dict(self): return self._traverse_dict(self.__dict__) def _traverse_dict(self, instance_dict): output = &#123;&#125; for key, value in instance_dict.items(): output[key] = self._traverse(key, value) return output def _traverse(self, key, value): if isinstance(value, ToDictMixin): return value.to_dict() elif isinstance(value, dict): return self._traverse_dict(value) elif isinstance(value, list): return [self._traverse(key, i) for i in value] elif hasattr(value, '__dict__'): return self._traverse_dict(value.__dict__) else: return value# åˆ©ç”¨ mix-in å°†äºŒå‰æ ‘è¡¨ç¤ºä¸ºå­—å…¸class BinaryTree(ToDictMixin): def __init__(self, value, left=None, right=None): self.value = value self.left = left self.right = rightif __name__ == '__main__': tree = BinaryTree(10, left=BinaryTree(7, right=BinaryTree(9)), right=BinaryTree(13, left=BinaryTree(11))) print(tree.to_dict())# =&gt; &#123;'value': 10, 'left': &#123;'value': 7, 'left': None, 'right': &#123;'value': 9, 'left': None, 'right': None&#125;&#125;, 'right': &#123;'value': 13, 'left': &#123;'value': 11, 'left': None, 'right': None&#125;, 'right': None&#125;&#125; mix-in æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºŽï¼Œå¯ä»¥éšæ—¶å‘åŸºç±»ä¸­æ·»åŠ é¢å¤–çš„é€šç”¨åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨å¿…è¦æ—¶è¦†ç›–é‡å†™æŸäº›æ–¹æ³•ã€‚å¤šä¸ª mix-in ä¹‹é—´ä¹Ÿå¯ä»¥ç›¸äº’ç»„åˆã€‚åœ¨å‰é¢ todict.py ä»£ç çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å†å®šä¹‰ä¸€ä¸ª JsonMixin ç”¨æ¥ä¸ºä»»æ„ç±»æä¾›é€šç”¨çš„ JSON åºåˆ—åŒ–åŠŸèƒ½ã€‚JsonMixin çš„å®šä¹‰ä»£ç å†³å®šäº†ç»§æ‰¿è‡ªå®ƒçš„ç±»éœ€è¦åŒ…å« to_dict æ–¹æ³•ï¼ˆæ¯”å¦‚å¯ä»¥ä»Ž ToDictMixin ä¸­ç»§æ‰¿ï¼‰ï¼Œä¸”å…¶ __init__ æ–¹æ³•æŽ¥å—å…³é”®å­—å‚æ•°ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142import jsonfrom todict import ToDictMixinclass JsonMixin(object): @classmethod def from_json(cls, data): kwargs = json.loads(data) return cls(**kwargs) def to_json(self): return json.dumps(self.to_dict())class DatacenterRack(ToDictMixin, JsonMixin): def __init__(self, switch=None, machines=None): self.switch = Switch(**switch) self.machines = [ Machine(**kwargs) for kwargs in machines ]class Switch(ToDictMixin, JsonMixin): def __init__(self, ports=None, speed=None): self.ports = ports self.speed = speedclass Machine(ToDictMixin, JsonMixin): def __init__(self, cores=None, ram=None, disk=None): self.cores = cores self.ram = ram self.disk = diskserialized = """&#123; "switch": &#123;"ports": 5, "speed": 1e9&#125;, "machines": [ &#123;"cores": 8, "ram": 32e9, "disk": 5e12&#125;, &#123;"cores": 4, "ram": 16e9, "disk": 1e12&#125;, &#123;"cores": 2, "ram": 4e9, "disk": 500e9&#125; ]&#125;"""deserialized = DatacenterRack.from_json(serialized)roundtrip = deserialized.to_json()assert json.loads(serialized) == json.loads(roundtrip) ToDictMixin å’Œ ToJsonMixin ä¸¤ä¸ª mix-in ä¸­åˆ†åˆ«å®šä¹‰äº†ä¸åŒçš„é€šç”¨åŠŸèƒ½ç»„ä»¶ï¼Œç¬¦åˆè§„èŒƒçš„å¤šé‡ç»§æ‰¿ä¸‹çš„å­ç±»åˆ™å¯ä»¥ç›´æŽ¥ä½¿ç”¨è¿™ä¸¤è€…æä¾›çš„ to_dict å’Œ to_json æ–¹æ³•ï¼Œè¾¾åˆ°åŠŸèƒ½æ•´åˆçš„æ•ˆæžœã€‚ è¦ç‚¹ èƒ½ç”¨ mix-in ç»„ä»¶å®žçŽ°çš„æ•ˆæžœï¼Œå°±ä¸ç”¨å¤šé‡ç»§æ‰¿æ¥åš å°†å„åŠŸèƒ½å®žçŽ°ä¸ºå¯æ’æ‹”çš„ mix-in ç»„ä»¶ï¼Œè®©å­ç±»é€‰æ‹©ç»§æ‰¿éœ€è¦çš„ç»„ä»¶ ç®€å•è¡Œä¸ºå°è£…åˆ° mix-in ç»„ä»¶é‡Œï¼Œå¤šä¸ª mix-in ç»„åˆæˆå¤æ‚è¡Œä¸º å››ã€å¤šä½¿ç”¨ public å±žæ€§Python ç±»çš„å±žæ€§æœ‰ public å’Œ private ä¸¤ç§ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨å¯¹è±¡ä¸Šé€šè¿‡ dot æ“ä½œç¬¦ï¼ˆ.ï¼‰è®¿é—® public å±žæ€§ã€‚private å±žæ€§æ˜¯åç§°ä¸­ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´çš„å±žæ€§ï¼Œå¯ä»¥è¢«å½“å‰ç±»ä¸­çš„æ–¹æ³•è®¿é—®ã€‚ä½†ä»Žç±»å¤–éƒ¨ç›´æŽ¥è®¿é—® private å±žæ€§ä¼šæŠ¥ AttributeError å¼‚å¸¸ã€‚12345678910111213141516class MyObject(object): def __init__(self): self.public_field = 5 self.__private_field = 10 def get_private_field(self): return self.__private_fieldfoo = MyObject()print(foo.public_field)# =&gt; 5print(foo.get_private_field())# =&gt; 10print(foo.__private_field)# =&gt; AttributeError: 'MyObject' object has no attribute '__private_field' ç±»æ–¹æ³•å¯ä»¥è®¿é—®å½“å‰ç±»çš„ç§æœ‰å±žæ€§ã€‚å­ç±»æ— æ³•è®¿é—®çˆ¶ç±»çš„ç§æœ‰å­—æ®µã€‚1234567891011121314151617181920class MyObject(object): def __init__(self): self.__private_field = 71 @classmethod def get_private_field(cls, instance): return instance.__private_fieldclass MyChildObject(MyObject): def get_private_field(self): return self.__private_fieldbar = MyObject()print(MyObject.get_private_field(bar))# =&gt; 71bar_child = MyChildObject()print(bar_child.get_private_field())# =&gt; AttributeError: 'MyChildObject' object has no attribute '_MyChildObject__private_field' Python ä¼šå¯¹ç§æœ‰å±žæ€§çš„åç§°åšä¸€äº›ç®€å•çš„å˜æ¢ï¼Œè¿™ç§å˜æ¢å¯¼è‡´äº†ç§æœ‰å±žæ€§å¯¹ç±»å¤–éƒ¨ä¸å¯è§ï¼ŒåŒæ—¶å­ç±»ä¹Ÿæ— æ³•è®¿é—®çˆ¶ç±»çš„ç§æœ‰å±žæ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒPython å¹¶æ²¡æœ‰ä»Žè¯­æ³•ä¸Šä¸¥æ ¼ä¿è¯ private å­—æ®µçš„ç§å¯†æ€§ã€‚åœ¨å­ç±»çš„ç»§æ‰¿ä½“ç³»å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹ private å­—æ®µçš„å¼•ç”¨å¾ˆå®¹æ˜“å¤±æ•ˆï¼Œä»Žè€Œå¯¼è‡´å­ç±»å‡ºçŽ°é”™è¯¯ã€‚ ä¸ºäº†å°½é‡å‡å°‘æ— æ„ä¹‰çš„è®¿é—®å†…éƒ¨å±žæ€§å¯¼è‡´çš„æ„å¤–ï¼ŒPython ä¹ æƒ¯ç”¨å•ä¸‹åˆ’çº¿å¼€å¤´çš„å­—æ®µè¡¨ç¤ºå—ä¿æŠ¤ï¼ˆprotectedï¼‰å­—æ®µï¼Œå½“å‰ç±»ä¹‹å¤–çš„ä»£ç ä½¿ç”¨è¿™äº›å­—æ®µæ—¶åº”æ ¼å¤–æ³¨æ„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®å¯è®©å­ç±»æ›´å¤šåœ°è®¿é—®çˆ¶ç±»çš„ protected å±žæ€§ï¼Œä¹Ÿå°½é‡ä¸è¦æŠŠè¿™äº›å±žæ€§è®¾ç½®æˆ privateã€‚å¹¶ä¸”åº”è¯¥åœ¨æ–‡æ¡£ä¸­è¯´æ˜Žæ¯ä¸ª protected å­—æ®µçš„å«ä¹‰ï¼Œåœ¨æ‰©å±•ä»£ç æ—¶å¦‚ä½•ä¿è¯æ•°æ®å®‰å…¨ã€‚123456class MyClass(object): def __init__(self, value): # This stores the user-supplied value for the object. # It should be coercible to a string. Once assigned for # the object it should be treated as immutable. self._value = value è¦ç‚¹ Python ç¼–è¯‘å™¨æ— æ³•ä¸¥æ ¼ä¿è¯ private å­—æ®µçš„ç§å¯†æ€§ åº”å¤šä½¿ç”¨ protected å±žæ€§ï¼Œå¹¶å°†åˆç†ç”¨æ³•åœ¨æ–‡æ¡£ä¸­è¯´æ˜Ž åªæœ‰å­ç±»ä¸å—è‡ªå·±æŽ§åˆ¶æ—¶ï¼Œä¸ºé¿å…å‘½åå†²çªæ‰è€ƒè™‘ä½¿ç”¨ private å±žæ€§ äº”ã€ç»§æ‰¿ collections.abc ä»¥å®žçŽ°è‡ªå®šä¹‰çš„å®¹å™¨ç±»åž‹å¤§éƒ¨åˆ†çš„ Python ç¼–ç¨‹éƒ½æ˜¯åœ¨å®šä¹‰ç±»ï¼Œç±»å¯ä»¥åŒ…å«æ•°æ®ä¸”èƒ½å¤Ÿæè¿°æ•°æ®ä¸Žå¯¹è±¡ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚Python ä¸­çš„ç±»ä»ŽæŸç§ç¨‹åº¦ä¸Šè¯´éƒ½æ˜¯å°è£…äº†å±žæ€§ä¸ŽåŠŸèƒ½å®¹å™¨ã€‚ å¦‚æžœè¦è®¾è®¡åŠŸèƒ½æ¯”è¾ƒç®€å•çš„åºåˆ—ï¼Œå¯ä»¥ç›´æŽ¥ç»§æ‰¿ Python å†…ç½®çš„ list ç±»åž‹ã€‚å¦‚åˆ›å»ºä¸€ç§å¯ä»¥ç»Ÿè®¡å„å…ƒç´ å‡ºçŽ°é¢‘çŽ‡çš„è‡ªå®šä¹‰åˆ—è¡¨ï¼š12345678910111213141516class FrequencyList(list): def __init__(self, members): super().__init__(members) def frequency(self): counts = &#123;&#125; for item in self: counts.setdefault(item, 0) counts[item] += 1 return countsfoo = FrequencyList(['a', 'b', 'a', 'c', 'b', 'a', 'd'])print(f'Length is &#123;len(foo)&#125;')print(f'Frequency: ', foo.frequency())# =&gt; Length is 7# =&gt; Frequency: &#123;'a': 3, 'b': 2, 'c': 1, 'd': 1&#125; å‡è®¾æŸå¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯ list ç±»åž‹çš„å­ç±»ï¼Œä½†æ˜¯éœ€è¦å®ƒè¡¨çŽ°å¾—åƒ list ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…¶å…ƒç´ ã€‚Python ç”¨ä¸€äº›åç§°æ¯”è¾ƒç‰¹æ®Šçš„å®žä¾‹æ–¹æ³•æ¥å®žçŽ°ä¸Žå®¹å™¨æœ‰å…³çš„è¡Œä¸ºã€‚å¦‚éœ€è¦ç”¨ä¸‹æ ‡è®¿é—®åºåˆ—ä¸­çš„å…ƒç´ ï¼Œå¯ä»¥è€ƒè™‘å®žçŽ°åºåˆ—å¯¹è±¡çš„ __getitem__ æ–¹æ³•ï¼š12345&gt;&gt;&gt; bar = [1, 2, 3]&gt;&gt;&gt; bar[0]1&gt;&gt;&gt; bar.__getitem__(0)1 å¦‚ä¸‹é¢çš„äºŒå‰æ ‘ç±»å®žçŽ°äº† __getitem__ æ–¹æ³•ï¼Œä½¿å¾—ä¸ä»…å¯ä»¥æŒ‰æ·±åº¦ä¼˜å…ˆçš„æ¬¡åºéåŽ†ï¼ˆ_traverse()ï¼‰äºŒå‰æ ‘ä¸­çš„å¯¹è±¡ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253# binarynode.pyclass BinaryNode(object): def __init__(self, value, left=None, right=None): self.value = value self.left = left self.right = rightclass IndexableNode(BinaryNode): def _traverse(self): if self.left is not None: yield from self.left._traverse() yield self if self.right is not None: yield from self.right._traverse() def __getitem__(self, index): for i, item in enumerate(self._traverse()): if i == index: return item.value raise IndexError(f'Index &#123;index&#125; is out of range')class SequenceNode(IndexableNode): def __len__(self): for count, _ in enumerate(self._traverse(), 1): pass return countif __name__ == '__main__': tree = SequenceNode( 10, left=SequenceNode( 5, left=SequenceNode(2), right=SequenceNode( 6, right=SequenceNode(7))), right=SequenceNode( 15, left=SequenceNode(11))) print('LRR is', tree.left.right.right.value) # =&gt; LRR is 7 print('Index 0 is', tree[0]) # =&gt; Index 0 is 2 print('11 in the tree?', 11 in tree) # =&gt; 11 in the tree? True print('Tree is', list(tree)) # =&gt; Tree is [2, 5, 6, 7, 10, 11, 15] print('Tree length is', len(tree)) # =&gt; Tree length is 7 ä¸ºäº†ä½¿åºåˆ—å¯ä»¥é€šè¿‡å†…ç½®çš„ len() å‡½æ•°èŽ·å–é•¿åº¦ï¼ŒSequenceNode ç±»ä¸­è¿˜å®žçŽ°äº† __len__ æ–¹æ³•ã€‚è€Œæ›´å¤šçš„åŠŸèƒ½å°±æ„å‘³ç€éœ€è¦é¢å¤–å®žçŽ°æ›´å¤šçš„ç‰¹æ®Šæ–¹æ³•ã€‚ä¸ºäº†é¿å…è¿™äº›éº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„ collections.abc æ¨¡å—ã€‚æ­¤æ¨¡å—å®šä¹‰äº†ä¸€ç³»åˆ—æŠ½è±¡åŸºç±»ï¼Œæä¾›äº†æ¯ä¸€ç§å®¹å™¨ç±»åž‹æ‰€åº”å…·å¤‡çš„å¸¸ç”¨æ–¹æ³•ã€‚ç»§æ‰¿è¿™æ ·çš„åŸºç±»ï¼Œå¦‚æžœå¿˜è®°å®žçŽ°æŸä¸ªæ–¹æ³•ï¼Œcollections.abc æ¨¡å—ä¼šæŠ¥é”™ï¼›å¦‚æžœå®žçŽ°äº†æŠ½è±¡åŸºç±»è¦æ±‚çš„æ¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™åŸºç±»ä¼šè‡ªåŠ¨å®žçŽ°å‰©ä¸‹çš„æ‰€æœ‰æ–¹æ³•ã€‚1234567891011121314151617181920212223from binarynode import SequenceNodefrom collections.abc import Sequenceclass BetterNode(SequenceNode, Sequence): passtree = BetterNode( 10, left=BetterNode( 5, left=BetterNode(2), right=BetterNode( 6, right=BetterNode(7))), right=BetterNode( 15, left=BetterNode(11)))print('Index of 7 is', tree.index(7))# =&gt; Index of 7 is 3print('Count of 10 is', tree.count(10))# =&gt; Count of 10 is 1 SequenceNode ä¸­å·²ç»å®žçŽ°äº† Sequence è¦æ±‚çš„ __getitem__ å’Œ __len__ æ–¹æ³•ï¼Œå› æ­¤ Sequence åŸºç±»ä¸ºç»§æ‰¿çš„ BetterNode å­ç±»è‡ªåŠ¨å®žçŽ°äº† index() å’Œ count() æ–¹æ³•ã€‚ è¦ç‚¹ å¦‚è‡ªå®šä¹‰çš„å®¹å™¨å­ç±»æ¯”è¾ƒç®€å•ï¼Œå¯ç›´æŽ¥ç»§æ‰¿ Python å†…ç½®çš„å®¹å™¨ç±»åž‹ï¼ˆå¦‚ listã€dict ç­‰ï¼‰ æ­£ç¡®å®žçŽ°è‡ªå®šä¹‰å®¹å™¨ç±»åž‹å¯èƒ½éœ€è¦ç¼–å†™å¤§é‡çš„ç‰¹æ®Šæ–¹æ³• ç¼–å†™è‡ªå®šä¹‰å®¹å™¨ç±»åž‹æ—¶ï¼Œå¯ä»¥ä»Ž collections.abc æ¨¡å—ä¸­çš„æŠ½è±¡åŸºç±»ç»§æ‰¿ï¼Œè¿™äº›åŸºç±»èƒ½ä¿è¯å­ç±»å…·å¤‡ç»Ÿä¸€çš„æŽ¥å£åŠè¡Œä¸º å‚è€ƒèµ„æ–™Effective Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
        <tag>Inherit</tag>
        <tag>Effective</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python3 ä¸­ä½œä¸ºä¸€ç­‰å¯¹è±¡çš„å‡½æ•°]]></title>
    <url>%2F2019%2F12%2F10%2Ffirst-class-function-python-3-functional-programming%2F</url>
    <content type="text"><![CDATA[åœ¨ Python è¯­è¨€ä¸­ï¼Œå‡½æ•°ä¸Žæ•´æ•°ã€å­—ç¬¦ä¸²ã€å­—å…¸ç­‰åŸºæœ¬æ•°æ®ç±»åž‹ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸€ç­‰å¯¹è±¡ã€‚æ‰€è°“ä¸€ç­‰å¯¹è±¡ï¼Œå³æ»¡è¶³å¦‚ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š åœ¨è¿è¡Œæ—¶åˆ›å»º èƒ½èµ‹å€¼ç»™å˜é‡ èƒ½ä½œä¸ºå‡½æ•°çš„å‚æ•°æˆ–è¿”å›žå€¼ ä»¥ä¸‹ IDLE ä¸­çš„ä»£ç å³åœ¨è¿è¡Œæ—¶åˆ›å»ºäº†å‡½æ•° factorialï¼š1234567891011121314151617&gt;&gt;&gt; def factorial(n):... '''calculates n!'''... return 1 if n &lt; 2 else n * factorial(n-1)...&gt;&gt;&gt; factorial(5)120&gt;&gt;&gt; factorial.__doc__'calculates n!'&gt;&gt;&gt; type(factorial)&lt;class 'function'&gt;&gt;&gt;&gt; fact = factorial&gt;&gt;&gt; fact&lt;function factorial at 0x7f55bc771c10&gt;&gt;&gt;&gt; fact(5)120&gt;&gt;&gt; list(map(fact, range(10)))[1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880] ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œfactorial æ˜¯ function ç±»çš„å®žä¾‹å¯¹è±¡ï¼Œ__doc__ æ˜¯ factorial å¯¹è±¡ä¼—å¤šå±žæ€§ä¸­çš„ä¸€ä¸ªã€‚å¯ä»¥æŠŠ factorial å‡½æ•°èµ‹å€¼ç»™å˜é‡ factï¼Œé€šè¿‡ fact å˜é‡è°ƒç”¨ factorial å‡½æ•°ã€‚è¿˜å¯ä»¥æŠŠ factorial ä½œä¸ºå‚æ•°ä¼ é€’ç»™ map å‡½æ•°ã€‚è¿™äº›è¡Œä¸ºè¡¨çŽ°äº†å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡çš„ç‰¹æ€§ã€‚ ä¸€ã€é«˜é˜¶å‡½æ•°æŽ¥å—å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…æŠŠå‡½æ•°ä½œä¸ºè¿”å›žå€¼çš„å‡½æ•°å³ä¸ºé«˜é˜¶å‡½æ•°ã€‚å¦‚å†…ç½®ç”¨äºŽæŽ’åºçš„ sorted å‡½æ•°ï¼Œå®ƒçš„ key å‚æ•°ç”¨äºŽä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨éœ€è¦æŽ’åºçš„æ¯ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚å¦‚æ ¹æ®å•è¯é•¿åº¦å¯¹å¤šä¸ªå­—ç¬¦ä¸²è¿›è¡ŒæŽ’åºï¼š123&gt;&gt;&gt; fruits = ['strawberry', 'fig', 'apple', 'cherry', 'raspberry', 'banana']&gt;&gt;&gt; sorted(fruits, key=len)['fig', 'apple', 'cherry', 'banana', 'raspberry', 'strawberry'] ä»»ä½•å•å‚æ•°çš„å‡½æ•°éƒ½å¯ä»¥ä½œä¸º key çš„å€¼ä¼ ç»™ sorted å‡½æ•°ï¼Œå¦‚æŠŠå•è¯åå‘æ‹¼å†™ä½œä¸ºæŽ’åºæ¡ä»¶ï¼š1234567&gt;&gt;&gt; def reverse(word):... return word[::-1]...&gt;&gt;&gt; reverse('test')'tset'&gt;&gt;&gt; sorted(fruits, key=reverse)['banana', 'apple', 'fig', 'raspberry', 'strawberry', 'cherry'] mapã€filter ä¸Ž reduceå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€é€šå¸¸ä¼šæä¾› mapã€filter å’Œ reduce ä¸‰ä¸ªé«˜é˜¶å‡½æ•°æˆ–è€…å®žçŽ°äº†ç±»ä¼¼åŠŸèƒ½çš„å‡½æ•°ã€‚Python3 ä¸­çš„åˆ—è¡¨æŽ¨å¯¼å’Œç”Ÿæˆå™¨å³å…·æœ‰ map å’Œ filter å‡½æ•°çš„åŠŸèƒ½ã€‚å‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ï¼š1234567891011&gt;&gt;&gt; def fact(n):... return 1 if n &lt; 2 else n * fact(n-1)...&gt;&gt;&gt; list(map(fact, range(6)))[1, 1, 2, 6, 24, 120]&gt;&gt;&gt; [fact(n) for n in range(6)][1, 1, 2, 6, 24, 120]&gt;&gt;&gt; list(map(fact, filter(lambda n: n % 2, range(6))))[1, 6, 120]&gt;&gt;&gt; [fact(n) for n in range(6) if n % 2][1, 6, 120] é€šè¿‡åˆ—è¡¨æŽ¨å¯¼å¯ä»¥å®Œæˆä¸Ž map æˆ– filter å‡½æ•°ç±»ä¼¼çš„å·¥ä½œï¼Œä¸”å¯è¯»æ€§æ›´é«˜ï¼Œä¹Ÿé¿å…äº†ä½¿ç”¨ lambda è¡¨è¾¾å¼ã€‚ reduce åœ¨ Python2 ä¸­æ˜¯å†…ç½®å‡½æ•°ï¼Œä½†åœ¨ Python3 ä¸­è¢«ç§»åˆ°äº† functools æ¨¡å—ä¸­ã€‚reduce å¯ä»¥æŠŠæŸä¸ªæ“ä½œè¿žç»­åœ°åº”ç”¨åˆ°æŸä¸ªåºåˆ—ä¸Šï¼Œç´¯è®¡æ‰€æœ‰çš„ç»“æžœï¼ŒæŠŠäº§ç”Ÿçš„ä¸€ç³»åˆ—å€¼è§„çº¦æˆä¸€ä¸ªå€¼ã€‚å› æ­¤å¸¸ç”¨äºŽæ±‚å’Œè®¡ç®—ï¼Œä½†å†…ç½®çš„ sum å‡½æ•°åœ¨å¯è¯»æ€§å’Œæ€§èƒ½æ–¹é¢æ›´ä¼˜ã€‚123456&gt;&gt;&gt; from functools import reduce&gt;&gt;&gt; from operator import add&gt;&gt;&gt; reduce(add, range(101))5050&gt;&gt;&gt; sum(range(101))5050 äºŒã€åŒ¿åå‡½æ•°å¯ä»¥ä½¿ç”¨ lambda å…³é”®å­—åœ¨ Python è¡¨è¾¾å¼å†…åˆ›å»ºåŒ¿åå‡½æ•°ã€‚åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­æœ€é€‚åˆä½¿ç”¨åŒ¿åå‡½æ•°ã€‚å¦‚å‰é¢çš„æ ¹æ®å­—ç¬¦ä¸²ååºåŽçš„ç»“æžœå¯¹å•è¯åˆ—è¡¨è¿›è¡ŒæŽ’åºï¼Œå¯ä»¥ä½¿ç”¨ lambda åŒ¿åå‡½æ•°æ›¿ä»£ä¼ å…¥ sorted çš„ reverse å‡½æ•°ï¼š123&gt;&gt;&gt; fruits = ['strawberry', 'fig', 'apple', 'cherry', 'raspberry', 'banana']&gt;&gt;&gt; sorted(fruits, key=lambda word: word[::-1])['banana', 'apple', 'fig', 'raspberry', 'strawberry', 'cherry'] lambda è¡¨è¾¾å¼ lambda words: words[::-1] å³ç­‰åŒäºŽä¹‹å‰çš„ reverse å‡½æ•°ï¼š12def reverse(word): return word[::-1] é™¤äº†ä½œä¸ºå‚æ•°ä¼ ç»™æŸä¸ªé«˜é˜¶å‡½æ•°å¤–ï¼ŒPython å¾ˆå°‘ä½¿ç”¨åŒ¿åå‡½æ•°ã€‚ ä¸‰ã€å¯è°ƒç”¨å¯¹è±¡é™¤äº†ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œå…¶ä»–å¯è°ƒç”¨å¯¹è±¡ä¹Ÿå¯ä»¥ä½¿ç”¨è°ƒç”¨è¿ç®—ç¬¦ï¼ˆå³ ()ï¼‰ã€‚Python çš„æ•°æ®æ¨¡åž‹ä¸­å…±åŒ…å« 7 ç§å¯è°ƒç”¨å¯¹è±¡ï¼š ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼šä½¿ç”¨ def è¯­å¥æˆ– lambda è¡¨è¾¾å¼åˆ›å»ºçš„å‡½æ•° å†…ç½®å‡½æ•°ï¼šç”± C è¯­è¨€ï¼ˆCPythonï¼‰å®žçŽ°çš„å‡½æ•°ï¼Œå¦‚ len æˆ– time.strftime ç­‰ å†…ç½®æ–¹æ³•ï¼šä½¿ç”¨ C è¯­è¨€å®žçŽ°çš„æ–¹æ³•ï¼Œå¦‚ dict.get æ–¹æ³•ï¼šåœ¨ç±»çš„å®šä¹‰ä½“ä¸­å®šä¹‰çš„å‡½æ•° ç±»ï¼šç±»åœ¨è°ƒç”¨æ—¶ä¼šä½¿ç”¨ __new__ æ–¹æ³•åˆ›å»ºå®žä¾‹ï¼Œç„¶åŽè¿è¡Œ __init__ åˆå§‹åŒ–å®žä¾‹ï¼Œæœ€åŽå°†å®žä¾‹è¿”å›žç»™è°ƒç”¨æ–¹ã€‚è°ƒç”¨ç±»ç›¸å½“äºŽè°ƒç”¨å‡½æ•°ã€‚ ç±»çš„å®žä¾‹ï¼šå¦‚æžœç±»çš„å®šä¹‰ä¸­å®žçŽ°äº† __call__ æ–¹æ³•ï¼Œåˆ™å…¶å®žä¾‹å¯ä»¥ä½œä¸ºå‡½æ•°è°ƒç”¨ ç”Ÿæˆå™¨ï¼šä½¿ç”¨ yield å…³é”®å­—çš„å‡½æ•°æˆ–æ–¹æ³•ã€‚å¯ä»¥è¿”å›žç”Ÿæˆå™¨å¯¹è±¡ã€‚ ä½¿ç”¨å†…ç½®çš„ callable() å‡½æ•°å¯ä»¥ç¡®è®¤å¯¹è±¡æ˜¯å¦å¯è°ƒç”¨ã€‚ ä»»ä½• Python å¯¹è±¡éƒ½å¯ä»¥è¡¨çŽ°å¾—åƒå‡½æ•°ï¼Œåªéœ€å®žçŽ°è¯¥å®žä¾‹çš„ __call__ æ–¹æ³•ã€‚å¦‚ä¸‹é¢çš„ bingocall.pyï¼Œä»Žåˆ—è¡¨ä¸­éšæœºå–å‡ºä¸€ä¸ªå…ƒç´ ï¼š123456789101112131415161718192021222324import randomclass BingoCage: def __init__(self, items): self._items = list(items) random.shuffle(self._items) def pick(self): try: return self._items.pop() except IndexError: raise LookupError('pick from empty BingoCage') def __call__(self): return self.pick()bingo = BingoCage(range(50))print(bingo.pick())# =&gt; 38print(bingo())# =&gt; 22print(callable(bingo))# =&gt; True bingo æ˜¯ BingoCage ç±»çš„ä¸€ä¸ªå®žä¾‹ï¼Œç”±äºŽ BingoCage ç±»ä¸­å®žçŽ°äº† __call__ æ–¹æ³•ï¼Œåˆ™ bingo å¯¹è±¡æ˜¯å¯è°ƒç”¨çš„ï¼ˆbingo()ï¼‰ã€‚ å››ã€æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„æ¨¡å—operatoråœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦å°†ç®—æœ¯è¿ç®—ç¬¦å½“ä½œå‡½æ•°ä½¿ç”¨ã€‚å¦‚ä¸ä½¿ç”¨é€’å½’è®¡ç®—é˜¶ä¹˜ã€‚ ä½¿ç”¨ reduce å’Œ lambda è¡¨è¾¾å¼è®¡ç®—é˜¶ä¹˜ï¼š123456&gt;&gt;&gt; from functools import reduce&gt;&gt;&gt; def fact(n):... return reduce(lambda a, b: a*b, range(1, n+1))...&gt;&gt;&gt; fact(5)120 Python ä¸­çš„ operator ä¸ºå¤šä¸ªè¿ç®—ç¬¦æä¾›äº†å¯¹åº”çš„å‡½æ•°ï¼Œå¯ä»¥é¿å…å†™ lambda a, b: a*b è¿™ç§åŒ¿åå‡½æ•°ã€‚ä½¿ç”¨ reduce å’Œ operator.mul è®¡ç®—é˜¶ä¹˜ï¼š1234567&gt;&gt;&gt; from operator import mul&gt;&gt;&gt; from functools import reduce&gt;&gt;&gt; def fact(n):... return reduce(mul, range(1, n+1))...&gt;&gt;&gt; fact(5)120 operator æ¨¡å—ä¸­è¿˜æœ‰ä¸€ç±» itemgetter å’Œ attrgetter å‡½æ•°ï¼Œå¯ä»¥æ›¿ä»£ä»Žåºåˆ—ä¸­å–å‡ºå…ƒç´ æˆ–è¯»å–å±žæ€§çš„ lambda è¡¨è¾¾å¼ã€‚å¦‚æ ¹æ®å…ƒç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ å¯¹å¤šä¸ªå…ƒç»„è¿›è¡ŒæŽ’åºï¼š12345678910111213141516&gt;&gt;&gt; metro_data = [... ('Tokyo', 'JP', 36.933, (35.689722, 139.691667)),... ('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)),... ('Mexico City', 'MX', 20.142, (19.433333, -99.133333)),... ('New York-Newark', 'US', 20.104, (40.808611, -74.020386)),... ('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)),... ]&gt;&gt;&gt; from operator import itemgetter&gt;&gt;&gt; for city in sorted(metro_data, key=itemgetter(1)):... print(city)...('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833))('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889))('Tokyo', 'JP', 36.933, (35.689722, 139.691667))('Mexico City', 'MX', 20.142, (19.433333, -99.133333))('New York-Newark', 'US', 20.104, (40.808611, -74.020386)) å¦‚æžœæŠŠå¤šä¸ªå‚æ•°ä¼ é€’ç»™ itemgetterï¼Œåˆ™è¯¥å‡½æ•°ä¼šè¿”å›žç”±æå–çš„å€¼æž„æˆçš„å…ƒç»„ï¼š123456789&gt;&gt;&gt; cc_name = itemgetter(1, 0)&gt;&gt;&gt; for city in metro_data:... print(cc_name(city))...('JP', 'Tokyo')('IN', 'Delhi NCR')('MX', 'Mexico City')('US', 'New York-Newark')('BR', 'Sao Paulo') attrgetter ä¸Ž itemgetter ä½œç”¨ç±»ä¼¼ï¼Œå¯ä»¥æ ¹æ®åç§°æå–å¯¹è±¡çš„å±žæ€§ã€‚ operator æ¨¡å—ä¸­è¿˜æœ‰ä¸€ä¸ª methodcaller å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥åœ¨æŸä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ç”±å‚æ•°æŒ‡å®šçš„æ–¹æ³•ã€‚12345678&gt;&gt;&gt; from operator import methodcaller&gt;&gt;&gt; s = 'The time has come'&gt;&gt;&gt; upcase = methodcaller('upper')&gt;&gt;&gt; upcase(s)'THE TIME HAS COME'&gt;&gt;&gt; hiphenate = methodcaller('replace', ' ', '-')&gt;&gt;&gt; hiphenate(s)'The-time-has-come' functools.partialé«˜é˜¶å‡½æ•° functools.partial ç”¨æ¥éƒ¨åˆ†åº”ç”¨æŸä¸ªå‡½æ•°ã€‚å³åŸºäºŽæŸä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶æŠŠåŽŸå‡½æ•°çš„æŸäº›å‚æ•°å›ºå®šã€‚ å¦‚ä½¿ç”¨ partial æŠŠä¸€ä¸ªæŽ¥å—åŒå‚æ•°çš„å‡½æ•°æ”¹ç¼–æˆå•å‚æ•°çš„å¯è°ƒç”¨å¯¹è±¡ï¼š1234567&gt;&gt;&gt; from operator import mul&gt;&gt;&gt; from functools import partial&gt;&gt;&gt; triple = partial(mul, 3)&gt;&gt;&gt; triple(7)21&gt;&gt;&gt; list(map(triple, range(1, 10)))[3, 6, 9, 12, 15, 18, 21, 24, 27] partial() å‡½æ•°è¿”å›žä¸€ä¸ª functools.partial å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æä¾›å¯¹åŽŸå‡½æ•°çš„è®¿é—®å’Œå›ºå®šåŽŸå‡½æ•°å‚æ•°çš„è¡Œä¸ºã€‚123456789&gt;&gt;&gt; def greeting(words, name):... return f'&#123;words&#125;, &#123;name&#125;!'...&gt;&gt;&gt; from functools import partial&gt;&gt;&gt; greeting2 = partial(greeting, name='skitar')&gt;&gt;&gt; greeting2("what's up")"what's up, skitar!"&gt;&gt;&gt; greeting2functools.partial(&lt;function greeting at 0x7f70f31788b0&gt;, name='skitar') å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Functional</tag>
        <tag>Function</tag>
        <tag>Lambda</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vim è¿›é˜¶â€”â€”æŒ‰é”®æ˜ å°„ä¸Ž VimScript è„šæœ¬ç¼–ç¨‹]]></title>
    <url>%2F2019%2F12%2F10%2Fvim-key-binding-and-vimscript-programming%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æŒ‰é”®æ˜ å°„Vim ä¸­çš„å¿«æ·é”®ç»‘å®šå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤é…ç½®ï¼š :imapï¼šåªåœ¨ Insert æ¨¡å¼ä¸‹ç”Ÿæ•ˆçš„å¿«æ·é”® :cmapï¼šåªåœ¨ Command-line æ¨¡å¼ä¸‹ç”Ÿæ•ˆ :nmapï¼šåªåœ¨ Normal æ¨¡å¼ä¸‹ç”Ÿæ•ˆ :vmapï¼šåªåœ¨ Visual æ¨¡å¼ä¸‹ç”Ÿæ•ˆ :mapï¼šåœ¨ä»¥ä¸Šæ‰€æœ‰æ¨¡å¼ä¸‹ç”Ÿæ•ˆ :noremapï¼šåŒ…å« :inoremapã€:nnoremap ç­‰ï¼Œéžé€’å½’æ˜ å°„ PSï¼šå…³äºŽé€’å½’æ˜ å°„ï¼Œå¦‚ :map a bï¼Œ:map b cã€‚æ ¹æ®æŒ‰é”®æ˜ å°„ä¹‹é—´çš„ä¼ é€’ï¼Œåˆ™æœ‰ a -&gt; c çš„å…³ç³»ã€‚è€Œ nore åˆ™ç”¨äºŽç¦æ­¢è¿™ç§é€’å½’è¡Œä¸ºã€‚ åšå¿«æ·é”®æ˜ å°„æ—¶ï¼Œå„åŠŸèƒ½æŒ‰é”®åœ¨ Vim ä¸­çš„åç§°å¦‚ä¸‹ï¼š åç§° å¯¹åº”æŒ‰é”® &lt;BS&gt; é€€æ ¼é”® &lt;Tab&gt; åˆ¶è¡¨é”® &lt;CR&gt;æˆ–&lt;Enter&gt;æˆ–&lt;Return&gt; å›žè½¦ &lt;Esc&gt; Escape &lt;Space&gt; ç©ºæ ¼é”® &lt;Up&gt; ä¸Šæ–¹å‘é”® &lt;Down&gt; ä¸‹æ–¹å‘é”® &lt;Left&gt; å·¦æ–¹å‘é”® &lt;Right&gt; å³æ–¹å‘é”® &lt;F1&gt; - &lt;F12&gt; åŠŸèƒ½é”® F1 åˆ° F12 #1, #2..#9,#0 F1 åˆ° F10 &lt;Insert&gt; Insert &lt;Del&gt; Delete &lt;Home&gt; Home &lt;End&gt; End &lt;PageUp&gt; ä¸Šç¿»é¡µ &lt;PageDown&gt; ä¸‹ç¿»é¡µ ç¤ºä¾‹12345678" save file (ctrl-s):map &lt;C-s&gt; :w&lt;cr&gt;" copy selected text (ctrl-c):vmap &lt;C-c&gt; y" Paste clipboard contents (ctrl-v):imap &lt;C-v&gt; &lt;esc&gt;P" cut selected text (ctrl-x):vmap &lt;C-x&gt; x :map &lt;C-s&gt; :w&lt;cr&gt; è¡¨ç¤ºå°† Ctrl+S ç»„åˆé”®æ˜ å°„ä¸º :w&lt;cr&gt;ï¼ˆä¿å­˜ä¿®æ”¹ï¼Œå†™å…¥æ–‡ä»¶ï¼‰å…¶ä¸­ &lt;C-s&gt; åœ¨ Vim ä¸­å³è¡¨ç¤º Ctrl+Sï¼Œç±»ä¼¼çš„ç”¨æ³•è¿˜æœ‰ &lt;A-s&gt; ï¼ˆAlt+Sï¼‰ã€&lt;M-s&gt; ï¼ˆMeta+Sï¼‰ã€&lt;C-S-s&gt;ï¼ˆCtrl+Shift+Sï¼‰ç­‰ã€‚:w åŽé¢çš„ &lt;cr&gt; è¡¨ç¤ºæŒ‰ä¸‹å›žè½¦é”®ã€‚å¦‚å‘½ä»¤æœ€åŽæ²¡æœ‰åŠ ä¸Š &lt;cr&gt;ï¼Œåˆ™æŒ‰ä¸‹ç»„åˆé”® &lt;C-s&gt; åŽåªä¼šå°†å¯¹åº”çš„ :w è¾“å…¥åˆ°å‘½ä»¤æ è€Œä¸æ‰§è¡Œã€‚ ä¸Šé¢æ˜ å°„çš„ä¿å­˜æ–‡ä»¶åŠŸèƒ½è¿˜å¯ä»¥æ›´åŠ ç»†åŒ–ä¸€äº›ï¼š:imap &lt;C-s&gt; &lt;esc&gt;:w&lt;cr&gt;aå³è¯¥ç»„åˆé”®é€‚ç”¨äºŽæ’å…¥æ¨¡å¼ï¼ŒæŒ‰ä¸‹ Ctrl+S æ„å‘³ç€ä¼šä¾ç…§å¦‚ä¸‹é¡ºåºæ‰§è¡Œå‘½ä»¤ï¼š &lt;esc&gt;ï¼šé€€å‡ºæ’å…¥æ¨¡å¼ :w&lt;cr&gt;ï¼šå°†ä¹‹å‰çš„ä¿®æ”¹å†™å…¥æ–‡ä»¶ aï¼šå›žåˆ°æ’å…¥æ¨¡å¼ç»§ç»­ç¼–è¾‘æ–‡ä»¶ å¯¹äºŽ Gvim ä¸‹çš„æŒ‰é”®æ˜ å°„ï¼Œè¿˜å¯ä»¥è°ƒå‡ºå¯¹è¯æ¡†å®Œæˆ Open å’Œ save-as åŠŸèƒ½ï¼š1234"Open new file dialog (ctrl-n):map &lt;C-n&gt; :browse confirm e&lt;cr&gt;"Open save-as dialog (ctrl-shift-s):map &lt;C-S-s&gt; :browse confirm saveas&lt;cr&gt; å¯¹äºŽä¾æ¬¡æŒ‰ä¸‹å¤šä¸ªæŒ‰é”®çš„ç»„åˆé”®ï¼Œå¦‚ï¼š:map $1 :MyFunction1()&lt;cr&gt;å½“æŒ‰ä¸‹ $ é”®åŽï¼ŒVim ä¼šç­‰å¾…ä¸€ç§’é’Ÿï¼Œè‹¥ä¸€ç§’é’Ÿä¹‹å†…åˆæŒ‰ä¸‹äº† 1 é”®ï¼Œåˆ™æ‰§è¡Œæ˜ å°„çš„ MyFunction1() å‡½æ•°ï¼›è‹¥ä¸€ç§’é’Ÿä¹‹å†…æ²¡æœ‰ä»»ä½•æŒ‰é”®æŒ‰ä¸‹ï¼Œåˆ™æ‰§è¡Œ $ é”®åŽŸæœ¬çš„åŠŸèƒ½ï¼ˆç§»åŠ¨å…‰æ ‡åˆ°è¡Œå°¾ï¼‰ã€‚ äºŒã€Vim è„šæœ¬Vim è„šæœ¬æ˜¯æŒ‡ç”¨ VimScript ç¼–å†™çš„ä¸º Vim æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½çš„å•ç‹¬çš„æ–‡ä»¶ã€‚å¦‚ä¸‹é¢çš„ hello.vim è„šæœ¬ï¼š12345678" hello.vimfunction! SayHello() echo 'Hello, World!'endfunctioncommand! Hello call SayHello()nnoremap Q :Hello&lt;CR&gt; å…¶ä¸­ function! ç”¨äºŽå®šä¹‰ SayHello() å‡½æ•°ï¼Œcommand! ç”¨äºŽå°†è°ƒç”¨è¯¥å‡½æ•°çš„è¡Œä¸ºç»‘å®šç»™ Hello å‘½ä»¤ï¼Œnnoremap Q åˆ™ç”¨äºŽå°† :Hello å‘½ä»¤çš„æ‰§è¡Œç»‘å®šç»™é”®ç›˜ä¸Šçš„ Q æŒ‰é”®ã€‚ åœ¨ Vim ä¸­ä½¿ç”¨ :source å‘½ä»¤å¯¼å…¥åˆšåˆšåˆ›å»ºçš„è„šæœ¬ï¼š:source hello.vimä¹‹åŽæ‰§è¡Œ :Hello å‘½ä»¤æˆ–è€…æŒ‰ä¸‹ Q æŒ‰é”®å³å¯åœ¨å‘½ä»¤æ è¾“å‡º Hello, World! å­—ç¬¦ä¸²ã€‚ å˜é‡å˜é‡çš„èµ‹å€¼ä½¿ç”¨ :let å‘½ä»¤ï¼š1234:let mystring = "a string":let mynumber = 123:let mylist = [1, 2, "three", 0x04 ,["five", "six"]]:let mydict = &#123;1: "one", 2: "two", "others": &#123;3: "three", 4: "four"&#125;&#125; Vim è„šæœ¬ä¸­æ”¯æŒä»¥ä¸‹ç±»åž‹çš„å˜é‡ï¼š Stringï¼šå­—ç¬¦ä¸²ï¼Œå¦‚ &quot;this is a string&quot; Numberï¼šæ•°å­—ï¼ŒåŒ…å«åè¿›åˆ¶ï¼ˆ123ï¼‰ã€åå…­è¿›åˆ¶ï¼ˆ0x8Aï¼‰å’Œå…«è¿›åˆ¶ï¼ˆ012ï¼‰ Listï¼šæœ‰åºåˆ—è¡¨ï¼Œåˆ—è¡¨é¡¹æ”¯æŒå¤šç§æ•°æ®ç±»åž‹æ··åˆ Dictionaryï¼šå­—å…¸ï¼Œæ— åºé”®å€¼å¯¹ Funcrefï¼šå‡½æ•°å¼•ç”¨ PSï¼šä¸åŒè¿›åˆ¶çš„æ•°å­—ä¹‹é—´å¯ä»¥ç›´æŽ¥è¿›è¡Œç®—æœ¯è¿ç®—ç”±å•å¼•å·ï¼ˆ&#39;ï¼‰åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸ä¼šè½¬ä¹‰ \n ç­‰è½¬ä¹‰å­—ç¬¦ å…³äºŽå­—ç¬¦ä¸²å’Œæ•°å­—ä¹‹é—´çš„è‡ªåŠ¨ç±»åž‹è½¬æ¢ï¼Œå‚è€ƒä»¥ä¸‹è§„åˆ™ï¼š Input (type) Result (type) â€œhelloâ€ . â€œworldâ€ â€œhello worldâ€ (string) â€œnumberâ€ . 123 â€œnumber 123â€ (string) â€œ123â€ + 10 133 (number) â€œ123â€ - 10 . â€œhitsâ€ â€œ113 hitsâ€ (string) â€œ123â€ - 10 + â€œhitsâ€ 113 (number) å˜é‡ä½œç”¨åŸŸVim ä¸­å˜é‡çš„ä½œç”¨åŸŸé€šè¿‡ä¸åŒçš„å‰ç¼€æ¥æŒ‡å®šï¼š vï¼šVim é¢„å®šä¹‰çš„å…¨å±€ä½œç”¨åŸŸ gï¼šå…¨å±€å˜é‡å‰ç¼€ bï¼šBuffer èŒƒå›´å†…ç”Ÿæ•ˆçš„å˜é‡ tï¼šTab èŒƒå›´å†…ç”Ÿæ•ˆçš„å˜é‡ wï¼šWindow èŒƒå›´å†…ç”Ÿæ•ˆçš„å˜é‡ lï¼šå³ localï¼ŒFunction èŒƒå›´å†…ç”Ÿæ•ˆ sï¼šå³ sourceï¼Œé€šè¿‡ :source è½½å…¥çš„å½“å‰è„šæœ¬å†…ç”Ÿæ•ˆ aï¼šå³ argumentï¼Œç”¨æ¥ä¿®é¥°å‡½æ•°çš„å‚æ•° å½“å˜é‡æ²¡æœ‰ä»»ä½•ä½œç”¨åŸŸå‰ç¼€ä¿®é¥°æ—¶ï¼Œé»˜è®¤ä¸ºå…¨å±€å˜é‡ï¼ˆé™¤éžè¯¥å˜é‡åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰ï¼‰ã€‚ å˜é‡ä½œç”¨åŸŸå‰ç¼€çš„ä½¿ç”¨å‚è€ƒå¦‚ä¸‹è„šæœ¬ï¼š1234567891011let g:sum = 10function SumNumbers(num1, num2) let l:sum = a:num1 + a:num2 if g:sum &lt; l:sum let g:sum = l:sum endif return l:sumendfunctionecho SumNumbers(3, 4)echo g:sum æ¡ä»¶è¯­å¥Vim è„šæœ¬ä¸­çš„ if-else è¯­å¥è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š12345if condition1 code-to-execute-if-condition1-is-trueelseif condition2 code-to-execute-if-condition2-is-trueendif å…¶ä¸­åˆ¤æ–­æ¡ä»¶ condition å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š val1 == val2 val1 != val2 val1 &gt; val1 val1 &lt; val2 val1 &lt;= val2 val1 &gt;= val2 str1 =~ str2 str1 !~ str2 å­—ç¬¦ä¸²æ¯”è¾ƒä¸­çš„ str2 å¯ä»¥æ˜¯æŸä¸ªæ¨¡å¼ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚ if-else è¯­å¥çš„ä½¿ç”¨å¯ä»¥å‚è€ƒå¦‚ä¸‹è„šæœ¬ï¼Œæ ¹æ®å½“å‰æ—¶é—´åˆ‡æ¢ä¸åŒçš„é…è‰²ï¼š1234567891011121314151617" note addition of zero" this guarantees return from function is numericlet currentHour = strftime ("%H")echo "currentHour is " currentHourif currentHour &lt; 6 + 0 colorscheme darkblue echo "setting colorscheme to darkblue"elseif currentHour &lt; 12 + 0 colorscheme morning echo "setting colorscheme to morning"elseif currentHour &lt; 18 + 0 colorscheme shine echo "setting colorscheme to shine"else colorscheme evening echo "setting colorscheme to evening"endif å¾ªçŽ¯For å¾ªçŽ¯çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š123for var in range do-somethingendfor æˆ–123for var in list do-somthingendfor ä»£ç ç¤ºä¾‹12345678910111213141516" rangefor myvar in range(1,10) echo myvarendfor" listlet mylist = ['a','b','c','d','e','f','g','h','i','j','k']for itemvar in mylist echo itemvarendfor" dictionarylet mydict = &#123;"a": "apple", "b":"banana", "c": "citrus" &#125;for keyvar in keys(mydict) echo mydict[keyvar]endfor While å¾ªçŽ¯çš„è¯­æ³•æ ¼å¼ï¼š123while condition execute-this-codeendwhile ä»£ç ç¤ºä¾‹ï¼š12345let x=0while x &lt;= 5 echo "x is now " x let x+=1endwhile åˆ—è¡¨ä¸Žå­—å…¸å…³äºŽ Vim ä¸­åˆ—è¡¨ä¸Žå­—å…¸çš„æ“ä½œï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š123456789101112131415161718192021222324252627282930let mylist = [1, 2, "three"]echo mylist[2]" =&gt; threelet mylist2 = [[1, 2, 3], ["four", "five", "six"]]echo mylist2[1][0]" =&gt; fourecho mylist2[0][-1]" =&gt; 3let mylist3 = [1, 2, 3, 4]call add(mylist3, [5, 6])echo mylist3" =&gt; [1, 2, 3, 4, [5, 6]]let mylist4 = [1, 2, 3, 4]let mylist4 = mylist4 + [5, 6]echo mylist4" =&gt; [1, 2, 3, 4, 5, 6]let mylist5 = [1, 2, 3, 4]call remove(mylist5, 3)echo mylist5" =&gt; [1, 2, 3]let mydict = &#123;'banana': 'yellow', 'apple': 'green'&#125;echo mydict['banana']" =&gt; yellowecho mydict.apple" =&gt; green get map split join å¯ä»¥å¯¹åˆ—è¡¨æˆ–å­—å…¸ä¸­çš„å€¼åº”ç”¨æŸä¸ªå‡½æ•°ï¼ˆå¦‚ join å’Œ map ç­‰ï¼‰ä»¥å®Œæˆç‰¹å®šçš„éœ€æ±‚ï¼Œå¸¸è§ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819let a = split("one two")echo a" =&gt; onelet mylist = ["one", "two", "three"]call map(mylist, '"&lt;" . v:val . "&gt;"')echo mylist" =&gt; ['&lt;one&gt;', '&lt;two&gt;', '&lt;three&gt;']let mylist2 = ["one", "two", "three"]echo get(mylist2, 2, "none")" =&gt; threeecho get(mylist2, 3, "none")" =&gt; nonelet mylist3 = ["one", "two", "three"]let mystring = join(mylist3, "+")echo mystring" =&gt; one+two+three æ›´å¤æ‚çš„ç¤ºä¾‹ï¼ˆå¥½ç¥žå¥‡ï¼Œæ²¡çœ‹æ‡‚ã€‚ã€‚ã€‚ï¼‰ï¼š12345678let mynumbers = &#123;0:'zero', 1:'one', 2:'two', 3:'three', 4:'four', 5:'five', 6:'six', 7:'seven', 8:'eight', 9:'nine'&#125;function mynumbers.convert(numb) dict return join(map(split(a:numb, '\zs'), 'get(self, v:val, "unknown")'))endfunctionecho mynumbers.convert(12345)" =&gt; one two three four five å‡½æ•°Vim ä¸­å®šä¹‰å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š123function Name(arg1, arg2,...argN) keyword code-to-execute-when-function-is-calledendfunction æ‰€æœ‰åœ¨å‡½æ•°ä½“ä¸­å®šä¹‰çš„å˜é‡åªåœ¨è¯¥å‡½æ•°å†…éƒ¨å¯è§ï¼Œå³ä½œç”¨åŸŸä¸º localã€‚å¦‚æžœéœ€è¦ä½¿ç”¨å‡½æ•°å¤–éƒ¨çš„å˜é‡ï¼Œå¯ä»¥å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œæˆ–è€…ç›´æŽ¥è°ƒç”¨ï¼ˆéœ€è¦åœ¨è¯¥å˜é‡åå‰åŠ ä¸Šå…¨å±€ä½œç”¨åŸŸå‰ç¼€ g:ï¼‰ã€‚å‡½æ•°å®šä¹‰ä»£ç ä¸­ä½¿ç”¨ç”±å‚æ•°ä¼ é€’çš„å˜é‡æ—¶ï¼Œéœ€è¦åŠ ä¸Š a: ä½œç”¨åŸŸå‰ç¼€ã€‚ å‚æ•°åˆ—è¡¨ å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213function PrintSum(num1, num2, ...) let sum = a:num1 + a:num2 let argnum = 1 while argnum &lt;= a:0 let sum += a:&#123;argnum&#125; let argnum += 1 endwhile echo "The sum is" sum return sumendfunctionlet sum = PrintSum(1, 2, 3, 4)" =&gt; The sum is 10 æ³¨æ„ä»£ç ä¸­ a:0ï¼ˆä¸å®šå‚æ•°çš„é•¿åº¦ï¼‰å’Œ a:{argnum}ï¼ˆç¬¬ argnum ä¸ªé¢å¤–å‚æ•°ï¼‰çš„ç”¨æ³•ã€‚ æ­¤å¤–è¿˜å¯ä»¥é€šè¿‡ a:000 ä»¥åˆ—è¡¨çš„æ–¹å¼èŽ·å–æ‰€æœ‰é¢å¤–çš„å‚æ•°ï¼š1234567891011function PrintSum(num1, num2, ...) let sum = a:num1 + a:num2 for arg in a:000 let sum += arg endfor echo "The sum is" sum return sumendfunctionlet sum = PrintSum(1, 2, 3, 4)" =&gt; The sum is 10 ç»¼åˆç¤ºä¾‹æ ¹æ®å½“å‰æ—¶é—´è‡ªåŠ¨åˆ‡æ¢ Vim é…è‰²çš„è„šæœ¬ï¼š12345678910let g:Favcolorschemes = ["darkblue", "morning", "shine", "evening"]function SetTimeOfDayColors() " currentHour will be 0, 1, 2 or 3 let CurrentHour = (strftime("%H") + 0) / 6 execute "colorscheme " . g:Favcolorschemes[CurrentHour] echo "set color scheme to " . g:Favcolorschemes[CurrentHour]endfunctioncall SetTimeOfDayColors() ä¸‰ã€AutocommandsAutocommands å³åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤åŒ…æ‹¬æ‰€æœ‰åˆæ³•çš„ Vim å‘½ä»¤ã€‚Vim å®šä¹‰äº†ä¸€äº›äº‹ä»¶ï¼ˆeventï¼‰ä½œä¸ºè§¦å‘å‘½ä»¤è‡ªåŠ¨æ‰§è¡Œçš„å¼€å…³ï¼Œå¸¸è§çš„ event å¦‚ä¸‹ï¼š BufNewFileï¼šåœ¨å¼€å§‹ç¼–è¾‘ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ—¶è§¦å‘ BufReadPreï¼šåœ¨ Vim ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ buffer å‰è§¦å‘ BufRead, BufReadPostï¼šå¼€å§‹ç¼–è¾‘æ–°çš„ buffer æ—¶ï¼Œè¯»å–æ–‡ä»¶ä¹‹åŽè§¦å‘ BufWrite, BufWritePreï¼šåœ¨å°† buffer å†…å®¹å†™å…¥æ–‡ä»¶ä¹‹å‰è§¦å‘ FileTypeï¼šåœ¨ç¡®å®šäº†æ–‡ä»¶ç±»åž‹ï¼ˆfiletypeï¼‰ä¹‹åŽè§¦å‘ VimResizedï¼šæ›´æ”¹ Vim çš„çª—å£å¤§å°åŽè§¦å‘ WinEnter, WinLeaveï¼šè¿›å…¥æˆ–ç¦»å¼€æŸä¸ª Vim çª—å£æ—¶è§¦å‘ CursorMoved, CursorMovedIï¼šNormal æˆ– Insert æ¨¡å¼ä¸‹ï¼Œå…‰æ ‡ç§»åŠ¨åŽè§¦å‘ Autocommands ä»£ç ç¤ºä¾‹12345augroup demo autocmd! autocmd BufReadPost * echo 'Reading: ' . expand('&lt;afile&gt;') autocmd BufWritePost * echo 'Writing: ' . expand('&lt;afile&gt;')augroup END ä¸Šè¿°è„šæœ¬ä¼šæ·»åŠ å¦‚ä¸‹åŠŸèƒ½ï¼šæ‰“å¼€æ–‡ä»¶æ—¶ Vim å‘½ä»¤æ è¾“å‡º â€œReading: â€œï¼›åœ¨ä½¿ç”¨ :w ç­‰å‘½ä»¤ä¿å­˜æ–‡ä»¶æ—¶ï¼Œå‘½ä»¤æ è¾“å‡º â€œWriting: â€œã€‚ åˆå¦‚æ ¹æ®æºæ–‡ä»¶ç±»åž‹è®¾ç½®ä¸åŒçš„ç¼©è¿›é£Žæ ¼ï¼š123filetype onautocmd FileType ruby setlocal tabstop=2 softtabstop=2 shiftwidth=2 expandtabautocmd FileType javascript setlocal ts=4 sts=4 sw=4 noet å‚è€ƒèµ„æ–™Hacking Vim 7.2Modern Vim]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Program</tag>
        <tag>Script</tag>
        <tag>Vim</tag>
        <tag>VimScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Golang åŸºæœ¬è¯­æ³•é€ŸæŸ¥â€”â€”å˜é‡ã€æŽ§åˆ¶ç»“æž„ä¸Žå‡½æ•°]]></title>
    <url>%2F2019%2F12%2F10%2Fgo-basic-syntax-variable-control-structure-function%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åŸºæœ¬ç»“æž„hello world ç¨‹åºï¼š1234567package mainimport "fmt"func main()&#123; fmt.Println("ä½ å¥½ï¼Œä¸–ç•Œ")&#125; ç›´æŽ¥è¿è¡Œï¼š12$ go run hello.goä½ å¥½ï¼Œä¸–ç•Œ æž„å»ºå¯æ‰§è¡Œç¨‹åºï¼š123$ go build hello.go$ ./helloä½ å¥½ï¼Œä¸–ç•Œ PS Package ç”¨äºŽç»„ç»‡ä»£ç æž¶æž„ï¼Œç±»ä¼¼äºŽå…¶ä»–è¯­è¨€ä¸­çš„åº“æˆ–å‘½åç©ºé—´ æ¯ä¸ª go æºæ–‡ä»¶éƒ½å¿…é¡»å±žäºŽï¼ˆä¸”åªå±žäºŽä¸€ä¸ªï¼‰ç‰¹å®šçš„ packageï¼Œä¸€ä¸ª package å¯ä»¥åŒ…å«å¤šä¸ª go ä»£ç æ–‡ä»¶ import å¯¼å…¥æŸä¸ª package ï¼Œæ„å‘³ç€èŽ·å–äº†è¯¥ package ä¸­å¯è§å¯¹è±¡çš„è®¿é—®æƒé™ import å¯¼å…¥çš„ package æœªåœ¨åŽé¢çš„ä»£ç ä¸­ä½¿ç”¨ä¼šæŠ¥é”™ï¼Œno unnecessary code! åŽŸåˆ™ main å‡½æ•°æ²¡æœ‰ä»»ä½•å‚æ•°ä¸”ä¸è¿”å›žä»»ä½•å€¼ï¼Œå®ƒé€šå¸¸ä½œä¸ºç¨‹åºæ‰§è¡Œçš„å…¥å£ å¯¼å…¥å¤šä¸ªåŒ…ï¼š1234import ( "fmt" "os") äºŒã€å˜é‡å˜é‡å®šä¹‰å’Œèµ‹å€¼ï¼švar identifier [type] = value12345var a intvar b boolvar str string = "hello"var i = 5GOROOT := os.Getenv("GOROOT") PS b := false ç­‰åŒäºŽ var b = false ã€‚å€ŸåŠ© Go è¯­è¨€çš„ç±»åž‹æŽ¨æ–­å¯ä»¥çœç•¥ç±»åž‹å£°æ˜Ž := æˆ–è€… var å½¢å¼çš„å˜é‡èµ‹å€¼ï¼ŒåŒ…å«å˜é‡åˆå§‹åŒ–åŠ¨ä½œã€‚å³ a = 1 è¡¨ç¤ºå°† 1 èµ‹å€¼ç»™å˜é‡ aï¼ˆa å¿…é¡»å·²ç»åˆ›å»ºï¼‰ï¼Œa := 1 è¡¨ç¤ºæ–°å»ºå˜é‡ aï¼Œå¹¶å°† 1 èµ‹å€¼ç»™ aã€‚ ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡ï¼Œå®šä¹‰çš„æœ¬åœ°å˜é‡æœªåœ¨åŽç»­ä»£ç ä¸­ä½¿ç”¨ï¼Œæ–°å»ºå˜é‡çš„åç§°å·²å­˜åœ¨ç­‰éƒ½ä¼šæŠ¥é”™ æŽ¨èä½¿ç”¨ := çš„å½¢å¼ï¼Œä½†åªåº”è¯¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ ä¸‰ã€å­—ç¬¦ä¸²è¿žæŽ¥å­—ç¬¦ä¸²ï¼Œ+ï¼š123s := "hel" + "lo"s += " world"fmt.Println(s) // prints out "hello world" å‰ç¼€åŒ¹é…ï¼šstrings.HasPrefix(s, prefix string) bool åŽç¼€åŒ¹é…ï¼šstrings.HasSuffix(s, suffix string) bool åŒ…å«å…³ç³»ï¼šstrings.Contains(s, substr string) bool å­—ç¬¦ä¸²æ›¿æ¢ï¼šstrings.Replace(str, old, new, n) string è®¡ç®—å­å­—ç¬¦ä¸²å‡ºçŽ°æ¬¡æ•°ï¼šstrings.Count(s, str string) int åˆ†å‰²å­—ç¬¦ä¸²ï¼šstrings.Split(s, sep string) []string join å­—ç¬¦ä¸²ï¼šstrings.join(sl []string, sep string) string ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324package mainimport ( "fmt" "strings")func main() &#123; str := "The quick brown fox jumps over the lazy dog" sl := strings.Split(str, " ") fmt.Printf("Splitted in slice: %v\n", sl) // å­—ç¬¦ä¸²åˆ†å‰²åŽçš„è¿”å›žå€¼ sl æ˜¯æ•°ç»„ for _, val := range sl &#123; fmt.Printf("%s,", val) &#125; fmt.Println() str2 := strings.Join(sl, "/") fmt.Printf("sl joined by / is: %s\n", str2)&#125;// output// Splitted in slice: [The quick brown fox jumps over the lazy dog]// The,quick,brown,fox,jumps,over,the,lazy,dog,// sl joined by / is: The/quick/brown/fox/jumps/over/the/lazy/dog å››ã€æŽ§åˆ¶ç»“æž„if-elseif-else ç»“æž„è¯­æ³•å¦‚ä¸‹ï¼š1234567if condition1 &#123; // do something&#125; else if condition2 &#123; // do something&#125; else &#123; // catch-all or default&#125; PSï¼šelse æ—è¾¹çš„ } å’Œ { ä¸èƒ½éš”è¡Œï¼Œå¦åˆ™æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚ switch12345678switch var1 &#123;case val1: // do somethingcase val2: // do somethingdefault: // catch-all or default&#125; 12345678switch &#123;case condition1: // do somethingcase condition2: // do somethingdefault: // catch-all or default&#125; 12345678switch initialization &#123;case val1: // do somethingcase val2: // do somethingdefault: // catch-all or default&#125; ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324package mainimport ( "fmt")func Abs(x int) int &#123; if x &lt; 0 &#123; return -x &#125; return x&#125;func main() &#123; switch num := Abs(-5); &#123; case num &gt; 0: fmt.Println("Result is positive") case num &lt; 0: fmt.Println("Never gonna happen") default: fmt.Println("Exact 0") &#125;&#125;// Result is positive forå‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ï¼š1234567891011121314151617package mainimport ( "fmt")func main() &#123; str := "Go is a beautiful language" for ix :=0; ix &lt; len(str); ix ++ &#123; fmt.Printf("Character on position %d is: %c \n", ix, str[ix]) &#125; for pos, char := range str &#123; fmt.Printf("Character on position %d is: %c \n", pos, char) &#125;&#125; äº”ã€å‡½æ•°å®šä¹‰å‡½æ•°è¯­æ³•ï¼š12func g() &#123;&#125; æ³¨æ„ä¸èƒ½å†™æˆå¦‚ä¸‹å½¢å¼ï¼š123func g()&#123;&#125; å‡½æ•°è°ƒç”¨è¯­æ³•ï¼špack1.Function(arg1,arg2, ... ,argn) Go ä¸­çš„å‡½æ•°å¯ä»¥æŽ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¯”å¦‚æœ‰ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ï¼šf1(a, b, c int) æŽ¥æ”¶ä¸‰ä¸ªå‚æ•°f2(a, b int) (int, int, int) æœ‰ä¸¤ä¸ªå‚æ•°å’Œä¸‰ä¸ªè¿”å›žå€¼åˆ™å¯ä»¥è¿™æ ·è°ƒç”¨ï¼šf1(f2(a, b)) å‡½æ•°æœ¬èº«å¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼Œå¦‚ add := binOp å‚æ•°ä¸Žè¿”å›žå€¼Go ä¸­çš„å‡½æ•°å¯ä»¥æŽ¥æ”¶ 0 ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¿”å›ž 0 ä¸ªæˆ–å¤šä¸ªç»“æžœã€‚ä¼ ç»™å‡½æ•°çš„å‚æ•°é€šå¸¸ä¼šæœ‰åç§°ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ²¡æœ‰åç§°åªåŒ…å«ç±»åž‹ï¼šfunc f(int, int, float64) Go å‡½æ•°çš„ä¼ å‚é»˜è®¤æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œå³å®žé™…ä¼ ç»™å‡½æ•°çš„æ˜¯å‚æ•°å€¼çš„å¤åˆ¶ã€‚å¦‚è°ƒç”¨ Function(arg1)ï¼Œå‡½æ•° Function æ”¶åˆ°çš„æ˜¯ arg1 æŒ‡å‘çš„å€¼çš„å‰¯æœ¬ï¼Œè€Œä¸æ˜¯ arg1 æœ¬èº«ã€‚å¦‚æžœéœ€è¦å‡½æ•°æ“ä½œä¼ å…¥çš„å‚æ•°æœ¬èº«ï¼Œå³ Function(arg1) æ“ä½œ arg1 æœ¬ä½“çš„å€¼ï¼Œåˆ™éœ€è¦ä¼ å…¥å‚æ•°çš„æŒ‡é’ˆï¼ˆå†…å­˜åœ°å€ï¼‰ã€‚ä½¿ç”¨å¦‚ä¸‹å½¢å¼ï¼šFunction(&amp;arg1)ã€‚ å¤§éƒ¨åˆ†å‡½æ•°éƒ½éœ€è¦è¿”å›žå€¼ï¼Œå¯ä»¥æ˜¯å‘½åçš„ä¹Ÿå¯ä»¥ä¸å‘½åã€‚ æ•°é‡æœªçŸ¥çš„å‚æ•°å‡½æ•°çš„æœ€åŽä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯ ...type è¿™æ ·çš„å½¢å¼ï¼Œå³ func myFunc(a, b, arg ...int) {} ã€‚è¿™è¡¨ç¤ºå‡½æ•°å¯ä»¥æŽ¥æ”¶ç›¸åŒç±»åž‹çš„ä¸å®šæ•°é‡çš„å‚æ•°ã€‚å‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526272829package mainimport ( "fmt")func main() &#123; x := Min(1, 3, 2, 0) fmt.Printf("The minimum is: %d\n", x) arr := []int&#123;7, 9, 3, 5, 1&#125; x = Min(arr...) fmt.Printf("The minimum in the array arr is: %d", x)&#125;func Min(a ...int) int &#123; if len(a) == 0 &#123; return 0 &#125; min := a[0] for _, v := range a &#123; if v &lt; min &#123; min = v &#125; &#125; return min&#125;// The minimum is: 0// The minimum in the array arr is: 1 Deferdefer å…³é”®å­—ç”¨äºŽâ€œå»¶è¿Ÿâ€æ‰§è¡ŒæŸä¸ªå‡½æ•°æˆ–å‘½ä»¤ï¼Œç”± defer ä¿®é¥°çš„è¯­å¥ä¼šåœ¨å¤–éƒ¨å‡½æ•°è¿”å›žç»“æžœä¹‹åŽå†æ‰§è¡Œã€‚123456789101112131415161718package mainimport ( "fmt")func main() &#123; fmt.Printf("In Main function at the top\n") defer Function2() fmt.Printf("In Main function at the bottom\n")&#125;func Function2() &#123; fmt.Printf("Function2: Deferred until the end of the calling function")&#125;// In Main function at the top// In Main function at the bottom// Function2: Deferred until the end of the calling function% å¦‚æžœ defer è¯­å¥ä¸­åŒ…å«å˜é‡å‚æ•°ï¼Œåˆ™è¯¥å‚æ•°çš„å€¼åœ¨ defer çš„ä½ç½®å·²ç»ç¡®å®šã€‚å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š1234567891011121314package mainimport ( "fmt")func main() &#123; i := 0 defer fmt.Println(i) i++ fmt.Println("The number is:")&#125;// The number is:// 0 ç”± defer ä¿®é¥°çš„ Println å‡½æ•°è™½ç„¶åœ¨ç¨‹åºæ‰§è¡Œæµçš„æœ€åŽè¾“å‡º i å€¼ã€‚ä½†å˜é‡ i åœ¨ defer å¤„çš„å€¼ä¸º 0ï¼Œå› æ­¤æœ€åŽè¾“å‡º 0 è€Œä¸æ˜¯æ‰§è¡Œ i++ åŽçš„ 1 ã€‚ å½“ä»£ç ä¸­åŒ…å«æœ‰å¤šä¸ª defer è¯­å¥æ—¶ï¼Œè¿™äº›è¯­å¥ä¼šä»¥ LIFOï¼ˆåŽè¿›å…ˆå‡ºï¼Œç±»ä¼¼ stackï¼‰çš„é¡ºåºæ‰§è¡Œã€‚123456789101112package mainimport ( "fmt")func main() &#123; for i := 0; i &lt; 5; i++ &#123; defer fmt.Printf("%d", i) &#125;&#125;// 43210 é€’å½’å‡½æ•°12345678910111213141516171819202122package mainimport ( "fmt")func main() &#123; result := 0 for i := 0; i &lt;= 10; i++ &#123; result = fibonacci(i) fmt.Printf("fibonacci(%d) is: %d\n", i, result) &#125;&#125;func fibonacci(n int) (res int) &#123; if n &lt;= 1 &#123; res = 1 &#125; else &#123; res = fibonacci(n-1) + fibonacci(n-2) &#125; return&#125; é«˜é˜¶å‡½æ•°å‡½æ•°ä½œä¸ºå‚æ•°12345678910111213141516package mainimport "fmt"func main() &#123; callback(1, Add)&#125;func Add(a, b int) &#123; fmt.Printf("The sum of %d and %d is: %d\n", a, b, a+b)&#125;func callback(y int, f func(int, int)) &#123; f(y, 2)&#125;// =&gt; The sum of 1 and 2 is: 3 ï¼ˆåŒ¿åï¼‰å‡½æ•°èµ‹å€¼ç»™å˜é‡123456789101112131415package mainimport "fmt"func main() &#123; for i := 0; i &lt; 4; i++ &#123; g := func(i int) &#123; fmt.Printf("%d", i) &#125; g(i) fmt.Printf(" - g is of type %T and has value %v\n", g, g) &#125;&#125;// =&gt; 0 - g is of type func(int) and has value 0x4839d0// =&gt; 1 - g is of type func(int) and has value 0x4839d0// =&gt; 2 - g is of type func(int) and has value 0x4839d0// =&gt; 3 - g is of type func(int) and has value 0x4839d0 å‡½æ•°ä½œä¸ºè¿”å›žå€¼12345678910111213141516171819202122232425package mainimport "fmt"func main() &#123; p2 := Add2() fmt.Printf("Call Add2 for 3 returns: %v\n", p2(3)) TwoAdder := Adder(2) fmt.Printf("The result is: %v\n", TwoAdder(3))&#125;func Add2() func(b int) int &#123; return func(b int) int &#123; return b + 2 &#125;&#125;func Adder(a int) func(b int) int &#123; return func(b int) int &#123; return a + b &#125;&#125;// =&gt; Call Add2 for 3 returns: 5// =&gt; The result is: 5 å¦ä¸€ä¸ªç‰ˆæœ¬çš„ç´¯åŠ å™¨ï¼Œæ¶‰åŠåˆ°é—­åŒ…ï¼š12345678910111213141516171819package mainimport "fmt"func main() &#123; f := Adder() fmt.Print(f(1), " - ") fmt.Print(f(20), " - ") fmt.Print(f(300))&#125;func Adder() func(int) int &#123; var x int return func(delta int) int &#123; x += delta return x &#125;&#125;// =&gt; 1 - 21 - 321 å‚è€ƒèµ„æ–™The Way To Go: A Thorough Introduction To The Go Programming Language]]></content>
      <categories>
        <category>Golang</category>
      </categories>
      <tags>
        <tag>Program</tag>
        <tag>Golang</tag>
        <tag>Go</tag>
        <tag>Basic</tag>
        <tag>Code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu 18.04 æ­å»ºç§æœ‰è½¯ä»¶é•œåƒæºï¼ˆæ”¯æŒ Ubuntu å’Œ CentOSï¼‰]]></title>
    <url>%2F2019%2F12%2F04%2Fubuntu-18-04-create-ubuntu-and-centos-software-mirrors%2F</url>
    <content type="text"><![CDATA[ç³»ç»ŸçŽ¯å¢ƒä¸º Ubuntu 18.04ï¼Œæ­å»ºæ”¯æŒ Ubuntu ç³»å’Œ CentOS ç³»çš„åŒç§æœ‰è½¯ä»¶ä»“åº“ã€‚Ubuntu æœ¬åœ°è½¯ä»¶é•œåƒæºä½¿ç”¨ apt-mirror å·¥å…·ä¸Žè¿œç¨‹ä»“åº“åŒæ­¥ï¼ŒCentOS æœ¬åœ°é•œåƒæºä½¿ç”¨ reposync å·¥å…·ä¸Žè¿œç¨‹ä»“åº“åŒæ­¥ã€‚ä¸Šè¿°ä¸¤ä¸ªå·¥å…·éƒ½å¯ä»¥é€šè¿‡ Ubuntu çš„åŒ…ç®¡ç†å™¨ apt-get å‘½ä»¤ç›´æŽ¥å®‰è£…ä½¿ç”¨ã€‚ ä¸€ã€çŽ¯å¢ƒå‡†å¤‡æˆ‘è¿™é‡Œæ­å»ºäº† Ubuntu 18.04ã€Ubuntu 16.04 å’Œ CentOS7 ä¸‰ä¸ªé•œåƒæºï¼Œä»Žè¿œç¨‹ä»“åº“æ‹‰å–çš„è½¯ä»¶åŒ…æ€»å…±è€—è´¹äº†çº¦ 300G ç¡¬ç›˜ç©ºé—´ï¼Œå…¶ä¸­ä¸¤ä¸ª Ubuntu å ç”¨äº†çº¦ 261Gï¼ŒCentOS7ï¼ˆåŒ…å« epel æºï¼‰çº¦ 29G ã€‚åˆ›å»ºé•œåƒæºå‰éœ€ä¿è¯æœ¬åœ°æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´ã€‚ å»ºè®®ç»™ç£ç›˜åˆ†åŒºæ—¶ä½¿ç”¨ LVMï¼ˆé€»è¾‘å·ç®¡ç†ï¼‰ çš„æ–¹å¼ï¼Œä¾¿äºŽä¹‹åŽå¯¹å­˜å‚¨ç©ºé—´è¿›è¡Œæ‰©å®¹ç­‰æ“ä½œã€‚å…³äºŽ Linux ç³»ç»Ÿç£ç›˜åˆ†åŒºå’Œ LVM çš„ä»‹ç»å¯ä»¥å‚è€ƒ Linux ç£ç›˜è®¾å¤‡å’Œ LVM ç®¡ç†å‘½ä»¤è¯¦è§£ã€‚æ­¤å¤„ä¸ä½œèµ˜è¿°ã€‚ å®‰è£…åŒæ­¥å·¥å…·ï¼š$ sudo apt-get install apt-mirror reposync createrepo å®‰è£… web æœåŠ¡å™¨ï¼ˆnginxï¼‰ï¼š$ sudo apt-get install nginx äºŒã€Ubuntu é•œåƒæºæ­å»ºç¼–è¾‘ /etc/apt/mirror.list é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹è¿œç¨‹ä»“åº“çš„åœ°å€ä¸ºå›½å†…çš„é˜¿é‡Œé•œåƒç«™ï¼Œæœ¬åœ°çš„ Ubuntu è½¯ä»¶ä»“åº“å°†å®šæœŸä»Žé˜¿é‡ŒæºåŒæ­¥è½¯ä»¶åŒ…ã€‚1234567891011121314151617181920set nthreads 20set _tilde 0set base_path /opt/mirrors/ubuntuset defaultarch amd64#Ubuntu 16.04deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse#Ubuntu 18.04deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverseclean http://mirrors.aliyun.com/ubuntu ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­ base_path æŒ‡å®šçš„ç›®å½•ï¼Œå³æœ¬åœ°ä»“åº“å­˜æ”¾è½¯ä»¶åŒ…çš„è·¯å¾„ã€‚$ sudo mkdir -p /opt/mirrors/ubuntu è¿è¡Œ apt-mirror å‘½ä»¤æ‹‰å–è½¯ä»¶åŒ…ï¼ŒåŒæ­¥å®ŒæˆèŠ±è´¹çš„æ—¶é—´è§†ç½‘é€Ÿè€Œå®šï¼š$ sudo apt-mirror é…ç½® web æœåŠ¡é•œåƒæºåŒæ­¥å®Œæˆä¹‹åŽï¼Œéœ€é…ç½® web æœåŠ¡ä½¿å¾—æœ¬åœ°ä»“åº“å¯ä»¥è¢«å…¶ä»– Linux æœºå™¨ä½¿ç”¨ã€‚ç¼–è¾‘ /etc/nginx/sites-available/default é…ç½®æ–‡ä»¶ï¼Œå¼€å¯ç›®å½•æµè§ˆï¼ˆauto_indexï¼‰åŠŸèƒ½ï¼š1234567891011121314server &#123; listen 80 default_server; listen [::]:80 default_server; root /var/www/html; index index.html index.htm index.nginx-debian.html; server_name _; location / &#123; try_files $uri $uri/ =404; autoindex on; autoindex_exact_size off; autoindex_localtime on; &#125;&#125; åˆ›å»ºè½¯é“¾æŽ¥ï¼Œå°†è½¯ä»¶åŒ…å­˜å‚¨è·¯å¾„æŒ‡å‘åˆ° web ç›®å½•ä¸‹ï¼š$ sudo ln -s /opt/mirrors/ubuntu/mirror/mirrors.aliyun.com/ubuntu /var/www/html/ubuntu é‡æ–°è½½å…¥ nginx æœåŠ¡ï¼š$ sudo service nginx reload æ­¤æ—¶è®¿é—® http://127.0.0.1/ubuntu ï¼Œåº”è¯¥å¯ä»¥åœ¨ web ç•Œé¢ä¸­æµè§ˆæœ¬åœ°ä»“åº“ä¸­çš„è½¯ä»¶åŒ…ã€‚ ä½¿ç”¨æœ¬åœ°é•œåƒæºå‰é¢çš„é…ç½®å®ŒæˆåŽï¼Œå³å¯è¿›å…¥ä»»æ„ä¸€å° Ubuntu ä¸»æœºï¼Œé…ç½®å…¶é•œåƒæºä¸ºåˆšåˆšåˆ›å»ºçš„æœ¬åœ°è½¯ä»¶ä»“åº“ã€‚ç¼–è¾‘ /etc/apt/sources.list æ–‡ä»¶ï¼Œä¿®æ”¹é•œåƒæºï¼ˆUbuntu 18.04ï¼‰ï¼š12345deb http://127.0.0.1/ubuntu/ bionic main restricted universe multiversedeb http://127.0.0.1/ubuntu/ bionic-updates main restricted universe multiversedeb http://127.0.0.1/ubuntu/ bionic-backports main restricted universe multiversedeb http://127.0.0.1/ubuntu/ bionic-security main restricted universe multiversedeb http://127.0.0.1/ubuntu/ bionic-proposed main restricted universe multiverse è¿è¡Œ sudo apt-get update å‘½ä»¤æ›´æ–°ç´¢å¼•æ–‡ä»¶ï¼Œä¹‹åŽå³å¯ä½¿ç”¨ sudo apt-get install å‘½ä»¤ä»Žæœ¬åœ°ä»“åº“ä¸­å®‰è£…è½¯ä»¶åŒ…äº†ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼š123456789101112131415$ sudo apt-get updateHit:1 http://127.0.0.1/ubuntu bionic InReleaseHit:2 http://127.0.0.1/ubuntu bionic-updates InReleaseHit:3 http://127.0.0.1/ubuntu bionic-backports InReleaseHit:4 http://127.0.0.1/ubuntu bionic-security InReleaseHit:5 http://127.0.0.1/ubuntu bionic-proposed InReleaseReading package lists... Done$ sudo apt-get install nmap...Get:1 http://127.0.0.1/ubuntu bionic/main amd64 libblas3 amd64 3.7.1-4ubuntu1 [140 kB]Get:2 http://127.0.0.1/ubuntu bionic/main amd64 liblinear3 amd64 2.1.0+dfsg-2 [39.3 kB]Get:3 http://127.0.0.1/ubuntu bionic-updates/main amd64 liblua5.3-0 amd64 5.3.3-1ubuntu0.18.04.1 [115 kB]Get:4 http://127.0.0.1/ubuntu bionic/main amd64 nmap amd64 7.60-1ubuntu5 [5174 kB]Fetched 5467 kB in 1s (9200 kB/s)... ä¸‰ã€CentOS é•œåƒæºæ­å»ºåˆ›å»º /opt/mirrors/CentOS-7.repo é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ è¿œç¨‹è½¯ä»¶ä»“åº“çš„åœ°å€ã€‚è¿™é‡Œä½¿ç”¨æ¸…åŽå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ã€‚12345678910111213141516171819202122232425262728293031323334353637383940[base]name=CentOS-7 - Basebaseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/7/os/x86_64/#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=osgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#released updates[updates]name=CentOS-7 - Updatesbaseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/7/updates/x86_64/#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updatesgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that may be useful[extras]name=CentOS-7 - Extrasbaseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/7/extras/x86_64/#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extrasgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that extend functionality of existing packages[centosplus]name=CentOS-7 - Plusbaseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/7/centosplus/x86_64/#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplusgpgcheck=0enabled=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7[epel]name=Extra Packages for Enterprise Linux 7baseurl=https://mirrors.tuna.tsinghua.edu.cn/epel/7/x86_64#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&amp;arch=$basearchfailovermethod=priorityenabled=1gpgcheck=0# gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7 æ­¤å¤„ä¸ºäº†ç®€å•èµ·è§ï¼Œgpgcheck éƒ½è®¾ç½®ä¸º 0 å…³é—­äº† GPG KEY æ£€æŸ¥ã€‚ åˆ›å»ºè½¯ä»¶ä»“åº“æœ¬åœ°è·¯å¾„ï¼š$ sudo mkdir -p /opt/mirrors/centos æ‹‰å–è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°ï¼š$ sudo reposync -np /opt/mirrors/centos -c /opt/mirrors/CentOS-7.repo åŒæ­¥å®ŒæˆåŽï¼Œ/opt/mirrors/centos è·¯å¾„ä¸‹ä¼šç”Ÿæˆå¦‚ä¸‹ 4 ä¸ªæ–‡ä»¶å¤¹ï¼š12$ ls /opt/mirrors/centosbase epel extras updates åˆ‡æ¢åˆ° root ç”¨æˆ·ï¼Œä½¿ç”¨ createrepo å‘½ä»¤åœ¨ä¸Šè¿° 4 ä¸ªæ–‡ä»¶å¤¹ä¸­åˆ†åˆ«åˆ›å»ºç§æœ‰ä»“åº“çš„ç´¢å¼•æ–‡ä»¶ï¼š1234$ cd /opt/mirrors/centos$ for i in base extras updates epel; docreaterepo $idone ç´¢å¼•åˆ›å»ºå®ŒæˆåŽï¼Œä¸Šè¿°å››ä¸ªè·¯å¾„ä¸­éƒ½ä¼šå¤šå‡º repodata å’Œ .repodata ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼š12$ ls -a base. .. Packages repodata .repodata é…ç½® web æœåŠ¡åˆ›å»ºè½¯é“¾æŽ¥ï¼Œå°† CentOS è½¯ä»¶åŒ…å­˜å‚¨è·¯å¾„æŒ‡å‘åˆ° web ç›®å½•ä¸‹ï¼š$ sudo ln -s /opt/mirrors/centos /var/www/html/centos é‡æ–°è½½å…¥ nginx æœåŠ¡ï¼š$ sudo service nginx reload æ­¤æ—¶è®¿é—® http://127.0.0.1/centos ï¼Œåº”è¯¥å¯ä»¥åœ¨ web ç•Œé¢ä¸­æµè§ˆæœ¬åœ° CentOS ä»“åº“ä¸­çš„è½¯ä»¶åŒ…ã€‚ ä½¿ç”¨æœ¬åœ°é•œåƒæºç™»å½•ä»»æ„ä¸€å° CentOS ä¸»æœºï¼Œå¤‡ä»½ /etc/yum.repos.d ç›®å½•ä¸‹çš„æ‰€æœ‰ .repo é…ç½®æ–‡ä»¶åˆ°å…¶ä»–ä½ç½®ã€‚åˆ›å»ºè½¯ä»¶ä»“åº“é…ç½®æ–‡ä»¶ /etc/yum.repos.d/CentOS-7.repoï¼Œç¼–è¾‘è¿œç¨‹ä»“åº“åœ°å€ï¼ˆbaseurlï¼‰ä¸ºå‰é¢æ­å»ºçš„ç§æœ‰ä»“åº“ï¼š12345678910111213141516171819202122232425262728293031323334353637383940[base]name=CentOS-7 - Basebaseurl=http://127.0.0.1/centos/base#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=osgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#released updates[updates]name=CentOS-7 - Updatesbaseurl=http://127.0.0.1/centos/updates#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updatesgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that may be useful[extras]name=CentOS-7 - Extrasbaseurl=http://127.0.0.1/centos/extras#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extrasgpgcheck=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that extend functionality of existing packages[centosplus]name=CentOS-7 - Plusbaseurl=http://127.0.0.1/centos/centosplus#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplusgpgcheck=0enabled=0#gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7[epel]name=Extra Packages for Enterprise Linux 7baseurl=http://127.0.0.1/centos/epel#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&amp;arch=$basearchfailovermethod=priorityenabled=1gpgcheck=0# gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7 è¿è¡Œ sudo yum clean all &amp;&amp; yum makecache å‘½ä»¤é‡å»ºè½¯ä»¶åŒ…ç´¢å¼•ã€‚ä¹‹åŽå³å¯é€šè¿‡ sudo yum install å‘½ä»¤ä»Žæœ¬åœ°çš„ç§æœ‰ä»“åº“ä¸­å®‰è£…è½¯ä»¶äº†ã€‚ å››ã€crontabåˆ›å»º crontab è®¡åˆ’ä»»åŠ¡ï¼Œè®©æœ¬åœ°ä»“åº“å®šæœŸä»Žè¿œç¨‹ä»“åº“æ‹‰å–æœ‰æ›´æ–°çš„è½¯ä»¶åŒ…ï¼š$ sudo crontab -e å‚è€ƒé…ç½®ï¼š120 3 * * 0 reposync -np /opt/mirrors/centos -c /opt/mirrors/CentOS-7.repo0 22 * * 6 apt-mirror æ¯å‘¨æ—¥å‡Œæ™¨ 3 ç‚¹è¿è¡Œ reposync å‘½ä»¤åŒæ­¥ CentOS ä»“åº“ã€‚æ¯å‘¨å…­æ™šä¸Š 10 ç‚¹è¿è¡Œ apt-mirror å‘½ä»¤åŒæ­¥ Ubuntu ä»“åº“ã€‚ å‚è€ƒæ–‡ç« centos ä¸‹åˆ›å»ºæœ¬åœ°é•œåƒæºï¼Œç»“åˆ nginx]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Server</tag>
        <tag>Software</tag>
        <tag>Ubuntu</tag>
        <tag>CentOS</tag>
        <tag>Mirror</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTTPie å‘½ä»¤è¯­æ³•é€ŸæŸ¥]]></title>
    <url>%2F2019%2F12%2F01%2Fhttpie-as-powerful-http-client%2F</url>
    <content type="text"><![CDATA[HTTPie æ˜¯ä¸€ä¸ªåŸºäºŽå‘½ä»¤è¡Œçš„ HTTP å®¢æˆ·ç«¯ï¼Œç±»ä¼¼äºŽ Linux ç³»ç»Ÿä¸­çš„ curl å·¥å…·ã€‚å®ƒå‡­å€Ÿéžå¸¸ç®€å•ç›´è§‚çš„è¯­æ³•å’Œç€è‰²çš„æ ¼å¼åŒ–è¾“å‡ºç­‰ç‰¹æ€§ï¼Œæä¾›äº†ä¸€ç§å‹å¥½çš„ä¸Ž Web æœåŠ¡äº¤äº’çš„æ–¹å¼ã€‚ ä¸€ã€å®‰è£…HTTPie çš„å®‰è£…æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥é€šè¿‡ pip å‘½ä»¤ä»¥ Python æ¨¡å—çš„æ–¹å¼å®‰è£…ï¼Œç›¸å¯¹ç®€å•ä¸”é€šç”¨ï¼š$ pip install httpie è¯­æ³•æ ¼å¼ï¼š$ http [flags] [METHOD] URL [ITEM [ITEM]] åŸºæœ¬ç¤ºä¾‹ $ http httpie.org ä»¥ GET æ–¹æ³•è®¿é—® Web æœåŠ¡ï¼ŒèŽ·å– HTML æ–‡æ¡£æˆ–å…¶ä»–ç±»åž‹çš„å“åº” $ http PUT example.org X-API-TOKEN:123 name=John è‡ªå®šä¹‰ HTTP è¯·æ±‚å¤´ã€HTTP æ–¹æ³•åŠä¸Šä¼ çš„ JSON æ•°æ®åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒPUT ä¸ºè‡ªå®šä¹‰çš„è¯·æ±‚æ–¹æ³•ï¼ŒX-API-Token ä¸ºè¯·æ±‚å¤´é€‰é¡¹ï¼Œname=John å³é€šè¿‡ PUT æ–¹æ³•æäº¤çš„ JSON æ•°æ®ã€‚ $ http -f POST example.org hello=world æäº¤ form è¡¨å• $ http example.org &lt; file.json é€šè¿‡é‡å®šå‘ä¸Šä¼ æ–‡ä»¶ http --download exmaple.org/file ä¸‹è½½æ–‡ä»¶ï¼ˆç±»ä¼¼ wget å‘½ä»¤ï¼‰ äºŒã€è¯­æ³•è¯¦è§£HTTP æ–¹æ³•http å‘½ä»¤é»˜è®¤ä½¿ç”¨ GET æ–¹æ³•ï¼ˆæ— è¯·æ±‚æ•°æ®æ—¶ï¼‰æˆ– POST æ–¹æ³•ï¼ˆæœ‰æä¾›è¯·æ±‚æ•°æ®æ—¶ï¼‰è®¿é—® Web æœåŠ¡ï¼Œä¹Ÿæ”¯æŒ PUTã€DELETE ç­‰æ ‡å‡†çš„ HTTP åŠ¨è¯ï¼šhttp &lt;method&gt; &lt;url&gt;ã€‚ å¦‚ï¼š$ http DELETE example.org/todos/7ï¼Œå®žé™…å‘æœåŠ¡å™¨å‘é€äº†ç±»ä¼¼è¿™æ ·çš„è¯·æ±‚ï¼šDELETE /todos/7 HTTP/1.1ã€‚ Request é€‰é¡¹http å…è®¸åœ¨è¯·æ±‚å‘½ä»¤ä¸­æ·»åŠ  HTTP è¯·æ±‚å¤´ã€JSON æˆ–è¡¨å•æ•°æ®ã€æ–‡ä»¶å’Œ URL å‚æ•°ç­‰è¯·æ±‚é€‰é¡¹ã€‚å‚è€ƒä¸‹è¡¨ï¼š Item ç±»åž‹ æè¿° HTTP è¯·æ±‚å¤´ Name:Value å¦‚ X-API-Token:123 URL å‚æ•° name==value é€šè¿‡ == ç¬¦å·å‘ URL ä¸­é™„åŠ  query string å‚æ•° Data Fields field=value, field=@file.txt æ­¤ç±»æ•°æ®åœ¨æäº¤æ—¶ä¼šåºåˆ—åŒ–ä¸º JSON å¯¹è±¡ï¼Œæˆ–è€…ç¼–ç ä¸º form æ ¼å¼ä¸Šä¼ ï¼ˆ--form, -fï¼‰ Raw JSON field:=json, field:=@file.json ç”¨äºŽæäº¤ Booleanã€Numberã€Array ç­‰åŽŸå§‹æ ¼å¼çš„ JSON æ•°æ®ã€‚å¦‚ meals:=&#39;[&quot;ham&quot;,&quot;spam&quot;]&#39; è¡¨å•æ–‡ä»¶ file@/dir/file é…åˆ --form æˆ– -f ä½¿ç”¨ï¼Œä»¥ multipart/form-data çš„å½¢å¼æäº¤æ–‡ä»¶ Querystringå¯¹äºŽ URL é“¾æŽ¥ä¸­åŒ…å«çš„ querystring å‚æ•°ï¼ˆå¦‚ /?param1=value1&amp;param2=value2ï¼‰ï¼Œhttp å‘½ä»¤å¯ä»¥é€šè¿‡ç®€å•çš„ param==value è¯­æ³•æ¥æŒ‡å®šã€‚ å¦‚ $ http www.google.com search==&#39;HTTPie logo&#39; tbm==ischæ•ˆæžœç±»ä¼¼äºŽ GET /?search=HTTPie+logo&amp;tbm=isch HTTP/1.1 Non-string JSONhttp å‘½ä»¤ä¸­åŒ…å«çš„è¯·æ±‚æ•°æ®é»˜è®¤éƒ½ä¼šåºåˆ—åŒ–ä¸º JSON æ ¼å¼å†æäº¤ç»™æœåŠ¡å™¨ï¼Œå³è¯·æ±‚å¤´ä¸­ Content-Type å’Œ Accept é€‰é¡¹çš„é»˜è®¤å€¼éƒ½ä¸º application/json ã€‚ å¯ä»¥ä½¿ç”¨ := æ“ä½œç¬¦æäº¤éžå­—ç¬¦ä¸²å½¢å¼çš„ JSON æ•°æ®ï¼›Text å’Œ JSON æ–‡ä»¶åˆ™å¯ä»¥åˆ†åˆ«ä½¿ç”¨ =@ å’Œ :=@ åµŒå…¥åˆ°è¯·æ±‚ä¸­ã€‚å¦‚ï¼š12345$ http PUT api.example.com/person/1 \ name=John \ # Text JSON age:=29 married:=false hobbies:=&apos;[&quot;http&quot;, &quot;pies&quot;]&apos; \ # Raw JSON description=@about-john.txt \ # Embed text file bookmarks:=@bookmarks.json # Embed JSON file è¡¨å•å¸¸è§„è¡¨å•æäº¤è¡¨å•å’Œå‘é€ JSON è¯·æ±‚çš„æ–¹å¼éžå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯éœ€è¦åœ¨å‘½ä»¤ä¸­æ·»åŠ  --form æˆ– -f é€‰é¡¹ï¼Œä»¥ç¡®ä¿è¯·æ±‚æ•°æ®çš„ Content-Type è¢«è®¾ç½®ä¸º application/x-www-form-urlencoded; charset=utf-8 ã€‚ $ http -f POST api.example.org/person/1 name=&#39;John Smith&#39;1234POST /person/1 HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=utf-8name=John+Smith æ–‡ä»¶ä¸Šä¼ è¡¨å•å¦‚æžœè¡¨å•è¯·æ±‚ä¸­æœ‰åŒ…å«æ–‡ä»¶é¡¹ï¼Œåˆ™è¯¥è¯·æ±‚çš„ Content-Type ä¼šè¢«è®¾ç½®æˆ multipart/form-data ã€‚ $ http -f POST example.com/jobs name=&#39;John Smith&#39; cv@~/Documents/cv.pdfä¸Šè¿°å‘½ä»¤çš„æ•ˆæžœç­‰åŒäºŽå¦‚ä¸‹ HTML è¡¨å•ï¼š1234&lt;form enctype="multipart/form-data" method="post" action="http://example.com/jobs"&gt; &lt;input type="text" name="name" /&gt; &lt;input type="file" name="cv" /&gt;&lt;/form&gt; å…¶ä»–å¸¸ç”¨è¯­æ³•Cookies$ http example.org &#39;Cookie:sessionid=foo;another-cookie=bar&#39; åŸºæœ¬è®¤è¯$ http -a username:password example.org Digest è®¤è¯$ http -A digest -a username:password example.org æç¤ºæ‰‹åŠ¨è¾“å…¥å¯†ç $ http -a username example.org ä»£ç†$ http --proxy=http:http://10.10.1.10:3128 --proxy=https:https://10.10.1.10:1080 example.org å¸¦è®¤è¯çš„ä»£ç†$ http --proxy=http:http://user:pass@10.10.1.10:3128 example.org SOCKS ä»£ç†éœ€å®‰è£…ä¾èµ–åº“ï¼š$ pip install requests[socks]$ http --proxy=http:socks5://user:pass@host:port --proxy=https:socks5://user:pass@host:port example.org è·³è¿‡ SSL è¯ä¹¦è®¤è¯$ http --verify=no https://example.org è‡ªå®šä¹‰ CA$ http --verify=/ssl/custom_ca_bundle https://example.org å®¢æˆ·ç«¯ SSL è¯ä¹¦$ http --cert=client.pem https://example.org æˆ–$ http --cert=client.crt --cert-key=client.key https://example.org ä¸‰ã€å‘½ä»¤è¾“å‡ºé»˜è®¤æƒ…å†µä¸‹ï¼Œhttp å‘½ä»¤ä¼šè¾“å‡ºæœ€ç»ˆçš„å®Œæ•´å“åº”ä¿¡æ¯ï¼ˆåŒ…å« headers å’Œ bodyï¼‰ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹é€‰é¡¹æŽ§åˆ¶æ˜¾ç¤ºçš„ç»“æžœï¼š é€‰é¡¹ å«ä¹‰ --headers, -h åªè¾“å‡ºå“åº”å¤´ä¿¡æ¯ --body, -b åªè¾“å‡ºå“åº”ä¸­çš„ body ä¿¡æ¯ --verbose, -b è¾“å‡ºæ‰€æœ‰çš„ HTTP äº¤äº’ä¿¡æ¯ï¼ˆåŒ…å«è¯·æ±‚å’Œå“åº”ï¼‰ --print, -p è‡ªç”±ç»„åˆéœ€è¦æ˜¾ç¤ºçš„éƒ¨åˆ† --print æˆ– -p é€‰é¡¹å¯ä»¥æºå¸¦å¤šä¸ªä¸åŒçš„å­—ç¬¦å¯¹åº”ç‰¹å®šçš„å†…å®¹è¿›è¡Œæ˜¾ç¤ºï¼š å­—ç¬¦ å«ä¹‰ H è¯·æ±‚å¤´ B è¯·æ±‚ä½“ h å“åº”å¤´ b å“åº”ä½“ å¦‚ï¼šhttp --print=Hh PUT httpbin.org/put hello=world è¾“å‡ºé‡å®šå‘ä¿å­˜æ–‡ä»¶ï¼š$ http example.org/Movie.mov &gt; Movie.mov ä¿å­˜å›¾ç‰‡åŽä½¿ç”¨ ImageMagick æ”¹å˜å¤§å°å†ä¸Šä¼ ï¼š$ http octodex.github.com/images/original.jpg | convert - -resize 25% - | http example.org/Octocats ä¸‹è½½æ¨¡å¼ï¼ˆå“åº”å¤´å®šå‘è‡³ stderrï¼Œä¼ è¾“è¿‡ç¨‹ä¸­æ˜¾ç¤ºè¿›åº¦æ¡ï¼‰ï¼šhttp --download https://github.com/jakubroztocil/httpie/archive/master.tar.gz ä¸‹è½½è¿‡ç¨‹ä¸­ä½¿ç”¨ç®¡é“é‡å®šå‘ï¼š$ http -d https://github.com/jakubroztocil/httpie/archive/master.tar.gz | tar zxf - å‚è€ƒèµ„æ–™HTTPie Documentation]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Tricks</tag>
        <tag>Python</tag>
        <tag>Efficiency</tag>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ Flask æ¡†æž¶æž„å»º REST APIï¼ˆä¸‰ï¼‰â€”â€”åŸºäºŽ Token çš„èº«ä»½è®¤è¯]]></title>
    <url>%2F2019%2F11%2F30%2Fpython-build-rest-api-with-flask-3-authorization-by-token%2F</url>
    <content type="text"><![CDATA[æŽ¥ä¸Šæ–‡Python é€šè¿‡ Flask æ¡†æž¶æž„å»º REST APIï¼ˆäºŒï¼‰â€”â€”ä¼˜åŒ–é¡¹ç›®æž¶æž„ã€‚å‰é¢ä»‹ç»äº†å¦‚ä½•é€šè¿‡ Flask å’Œ marshmallow æ¡†æž¶å†™ä¸€ä¸ªå®Œæ•´çš„æž¶æž„æ¸…æ™°çš„é¡¹ç›®ï¼Œä½œä¸º REST API å®žçŽ°åŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥åŠŸèƒ½ã€‚æœ¬ç¯‡ä¸»è¦ä»‹ç»åœ¨å‰æ–‡çš„åŸºç¡€ä¸Šï¼Œå€ŸåŠ© JWTï¼ˆJSON Web Tokensï¼‰åˆ›å»ºåŸºäºŽ Token çš„èº«ä»½è®¤è¯æœºåˆ¶ã€‚ ä¸€ã€å®‰è£…ä¾èµ–åœ¨å‰æ–‡åˆ›å»ºçš„ Python è™šæ‹ŸçŽ¯å¢ƒä¸­ï¼Œé¢å¤–å®‰è£…å¦‚ä¸‹ä¸¤ä¸ª Python åº“ï¼š$ pip install passlib flask-jwt-extended å…¶ä¸­ passlib ç”¨æ¥æä¾›å¯¹æ˜Žæ–‡å¯†ç çš„å“ˆå¸Œå¤„ç†åŠéªŒè¯ï¼Œflask-jwt-extended åˆ™å¼•å…¥äº†å¯¹ JWT è®¤è¯çš„æ”¯æŒã€‚ users æ•°æ®åº“æ¨¡åž‹ç¼–è¾‘ src/api/models/users.py æ–‡ä»¶ï¼Œåˆ›å»º User æ•°æ®åº“æ¨¡åž‹å’Œ UserSchema åºåˆ—åŒ–å¯¹è±¡ï¼š123456789101112131415161718192021222324252627282930313233343536373839# src/api/models/users.pyfrom api.utils.database import dbfrom passlib.hash import pbkdf2_sha256 as sha256from marshmallow_sqlalchemy import ModelSchemafrom marshmallow import fieldsclass User(db.Model): __tablename__ = 'users' id = db.Column(db.Integer, primary_key=True) username = db.Column(db.String(120), unique=True, nullable=False) password = db.Column(db.String(120), nullable=False) def create(self): db.session.add(self) db.session.commit() return self @classmethod def find_by_username(cls, username): return cls.query.filter_by(username=username).first() @staticmethod def generate_hash(password): return sha256.hash(password) @staticmethod def verify_hash(password, hash): return sha256.verify(password, hash)class UserSchema(ModelSchema): class Meta(ModelSchema.Meta): model = User sqla_session = db.session id = fields.Number(dump_only=True) username = fields.String(required=True) ä¸‰ã€è·¯ç”±å’Œå“åº”é€»è¾‘ç¼–è¾‘ src/api/routes/users.py æ–‡ä»¶ï¼ŒåŠ å…¥ users è·¯ç”±å’Œå¯¹åº”çš„ POST å“åº”é€»è¾‘ã€‚å…¶ä¸­ create_user() ç”¨äºŽåˆ›å»ºç”¨æˆ·å¹¶å°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥æ•°æ®åº“è¡¨ï¼Œauthenticate_user() ç”¨äºŽå®Œæˆç”¨æˆ·è®¤è¯å¹¶è¿”å›ž Token å­—ç¬¦ä¸²ä½œä¸ºä¹‹åŽçš„è®¿é—®ä»¤ç‰Œã€‚123456789101112131415161718192021222324252627282930313233343536373839404142from flask import Blueprintfrom flask import requestfrom flask import url_for, render_template_stringfrom api.utils.responses import response_withfrom api.utils import responses as respfrom api.models.users import User, UserSchemafrom api.utils.database import dbfrom flask_jwt_extended import create_access_tokenimport datetimeuser_routes = Blueprint("user_routes", __name__)@user_routes.route('/', methods=['POST'])def create_user(): try: data = request.get_json() data['password'] = User.generate_hash(data['password']) user_schmea = UserSchema() user = user_schmea.load(data) result = user_schmea.dump(user.create()) return response_with(resp.SUCCESS_201) except Exception as e: print(e) return response_with(resp.INVALID_INPUT_422)@user_routes.route('/login', methods=['POST'])def authenticate_user(): try: data = request.get_json() current_user = User.find_by_username(data['username']) if not current_user: return response_with(resp.SERVER_ERROR_404) if User.verify_hash(data['password'], current_user.password): access_token = create_access_token(identity=data['username']) return response_with(resp.SUCCESS_201, value=&#123;'message': 'Logged in as &#123;&#125;'.format(current_user.username), "access_token": access_token&#125;) else: return response_with(resp.UNAUTHORIZED_401) except Exception as e: print(e) return response_with(resp.INVALID_INPUT_422) å››ã€é…ç½®ç¼–è¾‘ src/main.py æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä¸¤è¡Œä»£ç æ³¨å†Œ users è·¯ç”±ï¼š12from api.routes.users import user_routesapp.register_blueprint(user_routes, url_prefix='/api/users') åœ¨ main.py çš„ db.init_app(app) ä»£ç å‰æ·»åŠ å¦‚ä¸‹å†…å®¹åˆå§‹åŒ– JWT æ¨¡å—ï¼š12from flask_jwt_extended import JWTManagerjwt = JWTManager(app) ç¼–è¾‘ src/api/config/config.py æ–‡ä»¶ï¼Œåœ¨ ProductionConfigã€DevelopmentConfigã€TestingConfig æ·»åŠ  JWT_SECRET_KEY å®šä¹‰ï¼š1JWT_SECRET_KEY = &apos;SOME-RADOM-JWT-SECRET&apos; ç¼–è¾‘ src/api/utils/responses.py æ–‡ä»¶ï¼Œæ·»åŠ â€œæœªè®¤è¯â€å’Œâ€œç¦æ­¢è®¿é—®â€çš„æ ‡å‡†å“åº”æ ¼å¼ï¼š1234567891011FORBIDDEN_403 = &#123; "http_code": 403, "code": "notAuthorized", "message": "You are not authorised to execute this."&#125;UNAUTHORIZED_401 = &#123; "http_code": 401, "code": "notAuthorized", "message": "Invalid authentication."&#125; åœ¨ src/api/routes/authors.py å’Œ src/api/routes/books.py ä¸¤ä¸ªè·¯ç”±æ–‡ä»¶çš„å“åº”é€»è¾‘ä¸­ï¼Œå¯¹ POSTã€PATCHã€PUT å’Œ DELETE è¯·æ±‚åŠ å…¥éªŒè¯ Token çš„è®¿é—®æ¡ä»¶ï¼Œä»¥é™åˆ¶åŒ¿åç”¨æˆ·å¯¹åŽå°æ•°æ®çš„ä¿®æ”¹ã€‚åªéœ€è¦åœ¨å“åº”å‡½æ•°å‰åŠ å…¥ @jwt_required è£…é¥°å™¨å³å¯ï¼Œå¦‚ï¼š123456789from flask_jwt_extended import jwt_required@author_routes.route('/&lt;int:id&gt;', methods=['DELETE'])@jwt_requireddef delete_author(id): get_author = Author.query.get_or_404(id) db.session.delete(get_author) db.session.commit() return response_with(resp.SUCCESS_204) äº”ã€æµ‹è¯•è¿è¡Œ python run.pyï¼Œä½¿ç”¨ httpie å·¥å…·è¿›è¡Œæµ‹è¯•ã€‚ åˆ›å»ºç”¨æˆ·ï¼š1234$ http POST 127.0.0.1:5000/api/users/ username=admin password=flask&#123; "code": "success"&#125; ç”¨æˆ·ç™»å½•èŽ·å– Tokenï¼š123456$ http POST 127.0.0.1:5000/api/users/login username=admin password=flask&#123; "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1NzUwODkyMTQsIm5iZiI6MTU3NTA4OTIxNCwianRpIjoiMTdiZjViZTEtMmJjMS00OWY2LWI2ZDgtZDRmZGZkZGE2MDI1IiwiZXhwIjoxNTc1MDkwMTE0LCJpZGVudGl0eSI6ImFkbWluIiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.iipDvS-BFwOQ9IfybEZxn2adrBu7sC7MznDoXfnWEsI", "code": "success", "message": "Logged in as admin"&#125; ä½¿ç”¨ POST æ–¹æ³•å‘ authors æ•°æ®è¡¨ä¸­æ’å…¥ä½œè€…ä¿¡æ¯ï¼š12345678910$ http POST 127.0.0.1:5000/api/authors/ first_name=Jack last_name=SparrowHTTP/1.0 401 UNAUTHORIZEDContent-Length: 44Content-Type: application/jsonDate: Sat, 30 Nov 2019 04:53:15 GMTServer: Werkzeug/0.16.0 Python/3.7.3&#123; "msg": "Missing Authorization Header"&#125; æç¤ºç¼ºå°‘ Authorization è¯·æ±‚å¤´ï¼Œå³ POST è¯·æ±‚éœ€è¦æ·»åŠ  Token è®¤è¯ä¿¡æ¯ã€‚ æ·»åŠ  Authorization è¯·æ±‚å¤´ï¼ˆTokenï¼‰ï¼Œé‡æ–°å‘èµ· POST è¯·æ±‚ï¼š123456789101112131415161718$ http POST 127.0.0.1:5000/api/authors/ Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1NzUwODkyMTQsIm5iZiI6MTU3NTA4OTIxNCwianRpIjoiMTdiZjViZTEtMmJjMS00OWY2LWI2ZDgtZDRmZGZkZGE2MDI1IiwiZXhwIjoxNTc1MDkwMTE0LCJpZGVudGl0eSI6ImFkbWluIiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.iipDvS-BFwOQ9IfybEZxn2adrBu7sC7MznDoXfnWEsI" first_name=Jack last_name=SparrowHTTP/1.0 201 CREATEDAccess-Control-Allow-Origin: *Content-Length: 171Content-Type: application/jsonDate: Sat, 30 Nov 2019 04:57:05 GMTserver: Flask REST API&#123; "author": &#123; "books": [], "created": "2019-11-30 04:57:05", "first_name": "Jack", "id": 1.0, "last_name": "Sparrow" &#125;, "code": "success"&#125; æˆåŠŸåˆ›å»ºæ•°æ®ã€‚ æ³¨æ„ Authorization è¯·æ±‚å¤´çš„æ ¼å¼ä¸º Authorization:&quot;Bearer &lt;token&gt;&quot;ã€‚ å‚è€ƒèµ„æ–™Building REST APIs with Flask]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>REST</tag>
        <tag>API</tag>
        <tag>Flask</tag>
        <tag>Token</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ Flask æ¡†æž¶æž„å»º REST APIï¼ˆäºŒï¼‰â€”â€”ä¼˜åŒ–é¡¹ç›®æž¶æž„]]></title>
    <url>%2F2019%2F11%2F30%2Fpython-build-rest-api-with-flask-2-project-structure%2F</url>
    <content type="text"><![CDATA[æŽ¥ä¸Šæ–‡ Python é€šè¿‡ Flask æ¡†æž¶æž„å»º REST APIï¼ˆä¸€ï¼‰â€”â€”æ•°æ®åº“å»ºæ¨¡ã€‚å‰é¢ä»‹ç»äº†å¦‚ä½•é€šè¿‡ Flask å’Œ marshmallow æ¡†æž¶å†™ä¸€ä¸ªå®Œæ•´çš„å•é¡µ Web åº”ç”¨ï¼Œä½œä¸º REST API å®žçŽ°åŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥åŠŸèƒ½ã€‚æœ¬ç¯‡ä¸»è¦ä»‹ç»åœ¨å‰æ–‡çš„åŸºç¡€ä¸Šï¼Œå¦‚ä½•å°†å•é¡µåº”ç”¨åˆç†åœ°ç»„ç»‡åˆ°ä¸€ä¸ªæž¶æž„æ¸…æ™°çš„é¡¹ç›®ä¸­ã€‚æ ‡å‡†åŒ–çš„åŒæ—¶ä¹Ÿæ–¹ä¾¿æ—¥åŽçš„ç»´æŠ¤ã€‚ ä¸€ã€çŽ¯å¢ƒæ­å»ºè§å¦‚ä¸‹ä»£ç ï¼š12345678910# åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹$ mkdir author-manager &amp;&amp; cd author-manager# åˆ›å»º Python è™šæ‹ŸçŽ¯å¢ƒ$ pip install virtualenv$ virtualenv venv$ source venv/bin/activate# å®‰è£…ä¾èµ–åº“(venv) $ pip install flask marshmallow-sqlalchemy flask-sqlalchemy# åˆ›å»ºæ–‡ä»¶å¤¹å­˜æ”¾æºä»£ç $ mkdir src &amp;&amp; cd src äºŒã€åˆå§‹åŒ–åº”ç”¨åˆ›å»º main.py æºä»£ç æ–‡ä»¶åˆå§‹åŒ– Flask åº”ç”¨ï¼š123456789101112131415# main.pyimport osfrom flask import Flaskfrom flask import jsonifyapp = Flask(__name__)if os.environ.get('WORK_ENV') == 'PROD': app_config = ProductionConfigelif os.environ.get('WORK_ENV') == 'TEST': app_config = TestingConfigelse: app_config = DevelopmentConfigapp.config.from_object(app_config) åˆ›å»º run.py æ–‡ä»¶ä½œä¸ºè¿è¡Œ Web åº”ç”¨çš„å…¥å£ï¼š1234# run.pyfrom main import app as applicationif __name__ == "__main__": application.run(port=5000, host="0.0.0.0", use_reloader=False) Configåˆ›å»º api/config ç›®å½•ï¼Œåœ¨å…¶ä¸­åˆ›å»ºç©ºçš„ __init__.py å’Œ config.py æ–‡ä»¶ï¼Œç¼–è¾‘ config.py åŠ å…¥ config å¯¹è±¡ï¼š$ mkdir -p api/config &amp;&amp; touch api/config/__init__.py$ vim api/config/config.py 12345678910111213141516171819# src/config/config.pyclass Config(object): DEBUG = False TESTING = False SQLALCHEMY_TRACK_MODIFICATIONS = Falseclass ProductionConfig(Config):# SQLALCHEMY_DATABASE_URI = &lt;Production DB RUL&gt; passclass DevelopmentConfig(Config): DEBUG = True SQLALCHEMY_DATABASE_URI = "sqlite:///../authors.db" SQLALCHEMY_ECHO = Falseclass TestingConfig(Config): TESTING = True# SQLALCHEMY_DATABASE_URI = &lt;Testing DB URL&gt; SQLALCHEMY_ECHO = False PSï¼šæ¯ä¸ªç›®å½•ä¸­åŒ…å«çš„ __init__.py ç©ºæ–‡ä»¶ç”¨æ¥æŒ‡ç¤ºè¯¥ç›®å½•ä¸­åŒ…å«æœ‰å¯ä¾›å…¶ä»–ä»£ç æ–‡ä»¶å¯¼å…¥çš„ Python æ¨¡å— Databaseåˆ›å»º api/utils æ–‡ä»¶å¤¹å¹¶ç¼–è¾‘ database.py æ–‡ä»¶ï¼š$ mkdir -p api/utils &amp;&amp; touch api/utils/__init__.py$ vim api/utils/database.py 1234# src/api/utils/database.pyfrom flask_sqlalchemy import SQLAlchemydb = SQLAlchemy() å°† main.py æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ä»¥å¯¼å…¥ config å’Œ db å¯¹è±¡ï¼š1234567891011121314151617181920# main.pyimport osfrom flask import Flaskfrom flask import jsonifyfrom api.config.config import *from api.utils.database import dbif os.environ.get('WORK_ENV') == 'PROD': app_config = ProductionConfigelif os.environ.Get('WORK_ENV') == 'TEST': app_config = TestingConfigelse: app_config = DevelopmentConfigapp = Flask(__name__)app.config.from_object(app_config)db.init_app(app)with app.app_context(): db.create_all() æ­¤æ—¶æ•´ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š1234567891011121314author-managerâ”œâ”€â”€ srcâ”‚ â”œâ”€â”€ apiâ”‚ â”‚ â”œâ”€â”€ __init__.pyâ”‚ â”‚ â”œâ”€â”€ configâ”‚ â”‚ â”‚ â”œâ”€â”€ __init__.pyâ”‚ â”‚ â”‚ â””â”€â”€ config.pyâ”‚ â”‚ â””â”€â”€ utilsâ”‚ â”‚ â”œâ”€â”€ __init__.pyâ”‚ â”‚ â””â”€â”€ database.pyâ”‚ â”œâ”€â”€ main.pyâ”‚ â”œâ”€â”€ requirements.txtâ”‚ â””â”€â”€ run.pyâ””â”€â”€ venv ä¸‰ã€æ•°æ®åº“å…³ç³»æ¨¡åž‹åˆ›å»º api/models æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­ç¼–è¾‘ books.py æ–‡ä»¶ä½œä¸ºæ•°æ®åº“æ¨¡åž‹ï¼š$ mkdir -p api/models &amp;&amp; touch api/models/__init__.py books æ•°æ®è¡¨æ¨¡åž‹ï¼š123456789101112131415161718192021222324252627282930313233# src/api/models/books.pyfrom api.utils.database import dbfrom marshmallow_sqlalchemy import ModelSchemafrom marshmallow import fieldsclass Book(db.Model): __talbename__ = 'books' id = db.Column(db.Integer, primary_key=True, autoincrement=True) title = db.Column(db.String(50)) year = db.Column(db.Integer) author_id = db.Column(db.Integer, db.ForeignKey('authors.id')) def __init__(self, title, year, author_id=None): self.title = title self.year = year self.author_id = author_id def create(self): db.session.add(self) db.session.commit() return selfclass BookSchema(ModelSchema): class Meta(ModelSchema.Meta): model = Book sqla_session = db.session id = fields.Number(dump_only=True) title = fields.String(required=True) year = fields.Integer(required=True) author_id = fields.Integer() authors æ•°æ®è¡¨æ¨¡åž‹ï¼š12345678910111213141516171819202122232425262728293031323334353637# src/api/models/authors.pyfrom api.utils.database import dbfrom marshmallow_sqlalchemy import ModelSchemafrom marshmallow import fieldsfrom api.models.books import BookSchemaclass Author(db.Model): __tablename__ = 'authors' id = db.Column(db.Integer, primary_key=True, autoincrement=True) first_name = db.Column(db.String(20)) last_name = db.Column(db.String(20)) created = db.Column(db.DateTime, server_default=db.func.now()) books = db.relationship('Book', backref='Author', cascade="all, delete-orphan") def __init__(self, first_name, last_name, books=[]): self.first_name = first_name self.last_name = last_name self.books = books def create(self): db.session.add(self) db.session.commit() return selfclass AuthorSchema(ModelSchema): class Meta(ModelSchema.Meta): model = Author sqla_session = db.session id = fields.Number(dump_only=True) first_name = fields.String(required=True) last_name = fields.String(required=True) created = fields.String(dump_only=True) books = fields.Nested(BookSchema, many=True, only=['title', 'year', 'id']) å››ã€HTTP æ ‡å‡†å“åº”åœ¨ api/utils ç›®å½•ä¸‹åˆ›å»º responses.py ï¼Œä½œä¸º REST API é€šç”¨çš„å“åº”æ ¼å¼ï¼š123456789101112131415161718192021222324# src/api/utils/responses.pyfrom flask import make_response, jsonifydef response_with(response, value=None, message=None, error=None, headers=&#123;&#125;, pagination=None): result = &#123;&#125; if value is not None: result.update(value) if response.get('message', None) is not None: result.update(&#123;'message': response['message']&#125;) result.update(&#123;'code': response['code']&#125;) if error is not None: result.update(&#123;'errors': error&#125;) if pagination is not None: result.update(&#123;'pagination': pagination&#125;) headers.update(&#123;'Access-Control-Allow-Origin': '*'&#125;) headers.update(&#123;'server': 'Flask REST API'&#125;) return make_response(jsonify(result), response['http_code'], headers) åœ¨ responses.py æ–‡ä»¶çš„ response_with å‡½æ•°å‰é¢æ’å…¥å¦‚ä¸‹ä»£ç ï¼Œå®šä¹‰ http_codeï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# src/api/utils/responses.pyINVALID_FIELD_NAME_SENT_422 = &#123; "http_code": 422, "code": "invalidField", "message": "Invalid fields found" &#125;INVALID_INPUT_422 = &#123; "http_code": 422, "code": "missingParameter", "message": "Missing parameters" &#125;BAD_REQUEST_400 = &#123; "http_code": 400, "code": "badRequest", "message": "Bad request" &#125;SERVER_ERROR_500 = &#123; "http_code": 500, "code": "serverError", "message": "Server error" &#125;SERVER_ERROR_404 = &#123; "http_code": 404, "code": "notFound", "message": "Resource not found" &#125;UNAUTHORIZED_403 = &#123; "http_code": 403, "code": "notAuthorized", "message": "You are not authorized" &#125;SUCCESS_200 = &#123; 'http_code': 200, 'code': 'success', &#125;SUCCESS_201 = &#123; 'http_code': 201, 'code': 'success', &#125;SUCCESS_204 = &#123; 'http_code': 204, 'code': 'success' &#125; åœ¨ main.py ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¯¼å…¥ status code å®šä¹‰å’Œ response_with å‡½æ•°ï¼š1234# src/main.pyimport api.utils.responses as respfrom api.utils.responses import response_withimport logging åœ¨ main.py ä¸­ db.init_app(app) å‰é¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¼•å…¥é”™è¯¯åœºæ™¯ä¸‹çš„æ ‡å‡†å“åº”æ ¼å¼ï¼š12345678910111213141516171819# src/main.py@app.after_requestdef add_header(response): return response@app.errorhandler(400)def bad_request(e): logging.error(e) return response_with(resp.BAD_REQUEST_400)@app.errorhandler(500)def server_error(e): logging.error(e) return response_with(resp.SERVER_ERROR_500)@app.errorhandler(404)def not_found(e): logging.error(e) return response_with(resp.SERVER_ERROR_404) äº”ã€API endpointsæŽ¥ä¸‹æ¥åˆ›å»º REST API çš„è®¿é—®ç«¯ç‚¹åŠå…¶å¯¹åº”çš„è·¯ç”±ã€‚ç¼–è¾‘ api/routes/authors.py æ–‡ä»¶ï¼ŒåŠ å…¥å¯¹ POSTã€GET ç­‰æ–¹æ³•çš„å“åº”é€»è¾‘ã€‚$ mkdir -p api/routes &amp;&amp; touch api/routes/__init__.py 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374# src/api/routes/authors.pyfrom flask import Blueprintfrom flask import requestfrom api.utils.responses import response_withfrom api.utils import responses as respfrom api.models.authors import Author, AuthorSchemafrom api.utils.database import dbauthor_routes = Blueprint("author_routes", __name__)@author_routes.route('/', methods=['POST'])def create_author(): try: data = request.get_json() author_schema = AuthorSchema() author = author_schema.load(data) result = author_schema.dump(author.create()) return response_with(resp.SUCCESS_201, value=&#123;"author": result&#125;) except Exception as e: print(e) return response_with(resp.INVALID_INPUT_422)@author_routes.route('/', methods=['GET'])def get_author_list(): fetched = Author.query.all() author_schema = AuthorSchema(many=True, only=['first_name', 'last_name','id']) authors = author_schema.dump(fetched) return response_with(resp.SUCCESS_200, value=&#123;"authors": authors&#125;)@author_routes.route('/&lt;int:author_id&gt;', methods=['GET'])def get_author_detail(author_id): fetched = Author.query.get_or_404(author_id) author_schema = AuthorSchema() author = author_schema.dump(fetched) return response_with(resp.SUCCESS_200, value=&#123;"author": author&#125;)@author_routes.route('/&lt;int:id&gt;', methods=['PUT'])def update_author_detail(id): data = request.get_json() get_author = Author.query.get_or_404(id) get_author.first_name = data['first_name'] get_author.last_name = data['last_name'] db.session.add(get_author) db.session.commit() author_schema = AuthorSchema() author = author_schema.dump(get_author) return response_with(resp.SUCCESS_200, value=&#123;"author": author&#125;)@author_routes.route('/&lt;int:id&gt;', methods=['PATCH'])def modify_author_detail(id): data = request.get_json() get_author = Author.query.get(id) if data.get('first_name'): get_author.first_name = data['first_name'] if data.get('last_name'): get_author.last_name = data['last_name'] db.session.add(get_author) db.session.commit() author_schema = AuthorSchema() author = author_schema.dump(get_author) return response_with(resp.SUCCESS_200, value=&#123;"author": author&#125;)@author_routes.route('/&lt;int:id&gt;', methods=['DELETE'])def delete_author(id): get_author = Author.query.get_or_404(id) db.session.delete(get_author) db.session.commit() return response_with(resp.SUCCESS_204) ç„¶åŽåœ¨ main.py æ–‡ä»¶ä¸­å¯¼å…¥ä¸Šé¢åˆ›å»ºçš„ author_routesï¼šfrom api.routes.authors import author_routes å¹¶åŠ å…¥ä»¥ä¸‹ä»£ç ï¼ˆåœ¨ ``@app.after_requestä¹‹å‰ï¼‰ä»¥å®Œæˆè·¯ç”±çš„æ³¨å†Œï¼šapp.register_blueprint(author_routes, url_prefix=â€™/api/authorsâ€™) æµ‹è¯•è¿è¡Œ python run.py å¯åŠ¨ Web æœåŠ¡ï¼Œä½¿ç”¨ httpie å·¥å…·è¿›è¡Œæµ‹è¯•ï¼š1234567891011$ http POST 127.0.0.1:5000/api/authors/ first_name=Jack last_name=Sparrow&#123; "author": &#123; "books": [], "created": "2019-11-29 04:41:46", "first_name": "Jack", "id": 2.0, "last_name": "Sparrow" &#125;, "code": "success"&#125; 1234567891011$ http 127.0.0.1:5000/api/authors/&#123; "authors": [ &#123; "first_name": "Jack", "id": 1.0, "last_name": "Sparrow" &#125;, ], "code": "success"&#125; 1234567891011$ http 127.0.0.1:5000/api/authors/1&#123; "author": &#123; "books": [], "created": "2019-11-29 03:22:22", "first_name": "Jack", "id": 1.0, "last_name": "Sparrow" &#125;, "code": "success"&#125; åŒæ ·çš„æ–¹å¼ï¼Œåˆ›å»º api/routes/books.py æ–‡ä»¶ï¼Œæ·»åŠ  book_routes çš„å“åº”é€»è¾‘ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869# src/api/routes/books.pyfrom flask import Blueprint, requestfrom api.utils.responses import response_withfrom api.utils import responses as respfrom api.models.books import Book, BookSchemafrom api.utils.database import dbbook_routes = Blueprint("book_routes", __name__)@book_routes.route('/', methods=['POST'])def create_book(): try: data = request.get_json() book_schema = BookSchema() book = book_schema.load(data) result = book_schema.dump(book.create()) return response_with(resp.SUCCESS_201, value=&#123;"book": result&#125;) except Exception as e: print(e) return response_with(resp.INVALID_INPUT_422)@book_routes.route('/', methods=['GET'])def get_book_list(): fetched = Book.query.all() book_schema = BookSchema(many=True, only=['author_id', 'title', 'year']) books = book_schema.dump(fetched) return response_with(resp.SUCCESS_200, value=&#123;"books": books&#125;)@book_routes.route('/&lt;int:id&gt;', methods=['GET'])def get_book_detail(id): fetched = Book.query.get_or_404(id) book_schema = BookSchema() books = book_schema.dump(fetched) return response_with(resp.SUCCESS_200, value=&#123;"books": books&#125;)@book_routes.route('/&lt;int:id&gt;', methods=['PUT'])def update_book_detail(id): data = request.get_json() get_book = Book.query.get_or_404(id) get_book.title = data['title'] get_book.year = data['year'] db.session.add(get_book) db.session.commit() book_schema = BookSchema() book = book_schema.dump(get_book) return response_with(resp.SUCCESS_200, value=&#123;"book": book&#125;)@book_routes.route('/&lt;int:id&gt;', methods=['PATCH'])def modify_book_detail(id): data = request.get_json() get_book = Book.query.get_or_404(id) if data.get('title'): get_book.title = data['title'] if data.get('year'): get_book.year = data['year'] db.session.add(get_book) db.session.commit() book_schema = BookSchema() book = book_schema.dump(get_book) return response_with(resp.SUCCESS_200, value=&#123;"book": book&#125;)@book_routes.route('/&lt;int:id&gt;', methods=['DELETE'])def delete_book(id): get_book = Book.query.get_or_404(id) db.session.delete(get_book) db.session.commit() return response_with(resp.SUCCESS_204) åœ¨ main.py ä¸­å¯¼å…¥ book_routes å¹¶ä½¿ç”¨ app.register_blueprint æ–¹æ³•æ³¨å†Œã€‚åŒæ—¶åœ¨ main.py æœ«å°¾åŠ å…¥ logging é…ç½®ä»£ç ï¼Œæœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354# src/main.pyimport osimport sysimport loggingfrom flask import Flaskfrom flask import jsonifyfrom api.config.config import *from api.utils.database import dbfrom api.utils.responses import response_withimport api.utils.responses as respfrom api.routes.authors import author_routesfrom api.routes.books import book_routesif os.environ.get('WORK_ENV') == 'PROD': app_config = ProductionConfigelif os.environ.get('WORK_ENV') == 'TEST': app_config = TestingConfigelse: app_config = DevelopmentConfigapp = Flask(__name__)app.config.from_object(app_config)app.register_blueprint(author_routes, url_prefix='/api/authors')app.register_blueprint(book_routes, url_prefix='/api/books')@app.after_requestdef add_header(response): return response@app.errorhandler(400)def bad_request(e): logging.error(e) return response_with(resp.BAD_REQUEST_400)@app.errorhandler(500)def server_error(e): logging.error(e) return response_with(resp.SERVER_ERROR_500)@app.errorhandler(404)def not_found(e): logging.error(e) return response_with(resp.SERVER_ERROR_404)db.init_app(app)with app.app_context(): db.create_all()logging.basicConfig( stream=sys.stdout, format='%(asctime)s|%(levelname)s|%(filename)s:%(lineno)s|%(message)s', level=logging.DEBUG) å‚è€ƒèµ„æ–™Building REST APIs with Flask]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>REST</tag>
        <tag>API</tag>
        <tag>Flask</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ Flask æ¡†æž¶æž„å»º REST APIï¼ˆä¸€ï¼‰â€”â€”æ•°æ®åº“å»ºæ¨¡]]></title>
    <url>%2F2019%2F11%2F28%2Fpython-build-rest-api-with-flask-1-modeling%2F</url>
    <content type="text"><![CDATA[ä¸€ã€REST ç®€ä»‹RESTï¼ˆRepresentational State Transferï¼‰æ˜¯ä¸€ç§è½¯ä»¶æž¶æž„é£Žæ ¼æˆ–è€…å¼€å‘æ¨¡å¼ï¼Œä¸»è¦é¢å‘å¯ä»¥åœ¨å¤šç§ç³»ç»Ÿä¹‹é—´æä¾›æ ‡å‡†çš„æ•°æ®é€šä¿¡åŠŸèƒ½çš„ Web æœåŠ¡ã€‚è€Œ REST é£Žæ ¼çš„ Web æœåŠ¡åˆ™å…è®¸è¯·æ±‚ç«¯é€šè¿‡ç»Ÿä¸€çš„ã€é¢„å…ˆå®šä¹‰å¥½çš„æ— çŠ¶æ€è¡Œä¸ºæ¥è®¿é—®å’Œæ“ä½œæœåŠ¡ç«¯æ•°æ®ã€‚ ä¸‹é¢ç®€è¦è¯´æ˜Ž REST é£Žæ ¼çš„ç‰¹ç‚¹ã€‚ Uniform Interfaceï¼šç»Ÿä¸€æŽ¥å£å³ä½¿ç”¨ HTTP æä¾›çš„ä¸€ç³»åˆ—æ–¹æ³•ï¼ˆæˆ–åŠ¨è¯ï¼ŒGETã€POST ç­‰ï¼‰æ“ä½œåŸºäºŽåè¯çš„ URI è¡¨ç¤ºçš„èµ„æº Representationsï¼šRESTful æœåŠ¡å…³æ³¨èµ„æºä»¥åŠèµ„æºçš„è®¿é—®ï¼Œrepresentation å³æœºå™¨å¯è¯»çš„å¯¹èµ„æºå½“å‰çŠ¶æ€çš„å®šä¹‰ã€‚æŽ¨èä½¿ç”¨ JSON Messagesï¼šå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚/å“åº”ï¼Œä»¥åŠå…¶ä¸­åŒ…å«çš„å…ƒæ•°æ®ï¼ˆè¯·æ±‚å¤´ã€å“åº”ç ç­‰ï¼‰ Links Between Resourcesï¼šREST æž¶æž„çš„æ ¸å¿ƒæ¦‚å¿µå³èµ„æºï¼Œèµ„æºå¯ä»¥åŒ…å« link ç”¨äºŽé©±åŠ¨å¤šä¸ªèµ„æºä¹‹é—´çš„è¿žæŽ¥å’Œè·³è½¬ Cachingï¼šç¼“å­˜ï¼ŒREST API ä¸­çš„ç¼“å­˜ç”± HTTP å¤´æŽ§åˆ¶ Statelessï¼šæ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»æ˜¯ç‹¬ç«‹çš„ï¼ŒæœåŠ¡å™¨ä¸ä¿å­˜å®¢æˆ·ç«¯çš„çŠ¶æ€ä¿¡æ¯ï¼›å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¿…é¡»åŒ…å«èƒ½å¤Ÿè®©æœåŠ¡å™¨ç†è§£è¯·æ±‚çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå› æ­¤å®¢æˆ·ç«¯è¯·æ±‚å¯ä»¥è¢«ä»»ä½•å¯ç”¨çš„æœåŠ¡å™¨åº”ç­”ã€‚æ— çŠ¶æ€åŽŸåˆ™ä¸º REST æœåŠ¡çš„å¯ä¼¸ç¼©æ€§ï¼ˆæ¨ªå‘æ‰©å±•ï¼‰å’Œ Caching ç­‰ç‰¹æ€§æä¾›äº†ä¾¿åˆ©ã€‚ äºŒã€æ­å»ºå¼€å‘çŽ¯å¢ƒvirtualenv åˆ›å»º Python è™šæ‹ŸçŽ¯å¢ƒï¼š1234$ mkdir flask-mysql &amp;&amp; cd flask-mysql$ pip install virtualenv$ virtualenv venv$ source venv/bin/activate è™šæ‹ŸçŽ¯å¢ƒä¸­å®‰è£… Flaskï¼š$ pip install flask æœ€ç®€å• Flask åº”ç”¨ä»£ç ï¼š123456from flask import Flaskapp = Flask(__name__)@app.route(&apos;/&apos;)def hello_world(): return &apos;Hello, From Flask!&apos; ä½¿ç”¨ $ FLASK_APP=app.py flask run å‘½ä»¤è¿è¡Œä¸Šé¢åˆ›å»ºçš„ app.py æºæ–‡ä»¶ã€‚ SQLAlchemyFlask æ˜¯ä¸€ä¸ªçµæ´»çš„è½»é‡çº§ Web å¼€å‘æ¡†æž¶ï¼Œå®ƒä»¥æ’ä»¶çš„æ–¹å¼æä¾›äº†é’ˆå¯¹å„ç§æ•°æ®æºçš„äº¤äº’æ”¯æŒã€‚è¿™é‡Œä½¿ç”¨ ORMï¼ˆObject Relational Mapperï¼‰ç±»åž‹çš„æ¡†æž¶ sqlalchemy ä½œä¸ºä¸Žæ•°æ®åº“äº¤äº’çš„å·¥å…·ã€‚å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š$ pip install flask-sqlalchemy pymysql æ•°æ®åº“é…ç½®ä»£ç ï¼š123app = Flask(__name__)app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://&lt;mysql_username&gt;:&lt;mysql_password&gt;@&lt;mysql_host&gt;:&lt;mysql_port&gt;/&lt;mysql_db&gt;'db = SQLAlchemy(app) å¦‚æœªå®‰è£… Mysql æœåŠ¡ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨ Sqlite3 æ•°æ®åº“å¼•æ“Žï¼šapp.config[&#39;SQLALCHEMY_DATABASE_URI&#39;] = &#39;sqlite:///./&lt;dbname&gt;.db&#39; ä¸‰ã€æ•°æ®åº“å»ºæ¨¡åˆ›å»º Authors æ¨¡åž‹çš„ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718class Authors(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(20)) specialisation = db.Column(db.String(50)) def create(self): db.session.add(self) db.session.commit() return self def __init__(self, name, specialisation): self.name = name self.specialisation = specialisation def __repr__(self): return '&lt;Author %d&gt;' % self.iddb.create_all() ä¸Šè¿°æ¨¡åž‹ä»£ç ä¼šåœ¨å…³è”çš„æ•°æ®åº“ä¸­åˆ›å»ºä¸€å¼ åä¸º authors çš„è¡¨ï¼ŒåŒæ—¶ sqlalchemy æ¡†æž¶æä¾›çš„åŸºäºŽæ¨¡åž‹çš„ API ä¹Ÿä¼šç”¨æ¥ä¸Žè¯¥æ•°æ®è¡¨è¿›è¡Œäº¤äº’ã€‚ æ¨¡åž‹ä¸­çš„å­—æ®µå®šä¹‰ç­‰åŒäºŽå¦‚ä¸‹çš„ SQL è¯­å¥ï¼š12345678910mysql&gt; show create table authors\G*************************** 1. row *************************** Table: authorsCreate Table: CREATE TABLE `authors` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(20) DEFAULT NULL, `specialisation` varchar(50) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin11 row in set (0.00 sec) åºåˆ—åŒ–åºåˆ—åŒ–æ˜¯æŒ‡å°† Web API æä¾›çš„åŽå°æ•°æ®ä»¥ç‰¹å®šçš„å½¢å¼ï¼ˆå¦‚ json æ ¼å¼ï¼‰å±•ç¤ºç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿å‰ç«¯ç¨‹åºè°ƒç”¨ã€‚ååºåˆ—åŒ–åˆ™æ˜¯æ­¤è¿‡ç¨‹çš„é€†å‘æ“ä½œï¼Œå°†å‰ç«¯å‘é€ç»™ API çš„ json æ ¼å¼çš„æ•°æ®æŒä¹…åŒ–åˆ°åŽç«¯æ•°æ®åº“ä¸­ã€‚ è¿™é‡Œéœ€è¦å®‰è£… marshmallow æ¡†æž¶å°† SQLAlchemy è¿”å›žçš„æ•°æ®å¯¹è±¡è½¬æ¢æˆ JSON æ ¼å¼ã€‚$ pip install marshmallow-sqlalchemy æ·»åŠ å¦‚ä¸‹ä»£ç åˆ›å»º AuthorSchema åºåˆ—åŒ–å™¨ï¼š1234567891011from marshmallow_sqlalchemy import ModelSchemafrom marshmallow import fieldsclass AuthorsSchema(ModelSchema): class Meta(ModelSchema.Meta): model = Authors sqla_session = db.session id = fields.Number(dump_only=True) name = fields.String(required=True) specialisation = fields.String(required=True) å››ã€Entrypointåˆ›å»º /authors entrypointï¼Œå“åº” GET æ–¹æ³•èŽ·å– authors æ¨¡åž‹ä¸­çš„æ‰€æœ‰æ•°æ®å¯¹è±¡å¹¶ä»¥ JSON æ ¼å¼è¿”å›žç»™ç”¨æˆ·ã€‚12345678from flask import Flask, request, jsonify, make_response@app.route('/authors', methods=['GET'])def index(): get_authors = Authors.query.all() author_schema = AuthorsSchema(many=True) authors = author_schema.dump(get_authors) return make_response(jsonify(&#123;"authors": authors&#125;)) ä»¥ id ä¸ºç­›é€‰æ¡ä»¶èŽ·å–æŸæ¡ç‰¹å®šçš„æ•°æ®çºªå½•ï¼š123456@app.route('/authors/&lt;id&gt;', methods=['GET'])def get_author_by_id(id): get_author = Authors.query.get(id) author_schema = AuthorsSchema() author = author_schema.dump(get_author) return make_response(jsonify(&#123;"author": author&#125;)) ä¾æ¬¡æ·»åŠ  POSTã€PUTã€DELETE ç­‰æ–¹æ³•çš„å“åº”é€»è¾‘ï¼Œæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192from flask import Flask, request, jsonify, make_responsefrom flask_sqlalchemy import SQLAlchemyfrom marshmallow_sqlalchemy import ModelSchemafrom marshmallow import fieldsapp = Flask(__name__)app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///./test.db'db = SQLAlchemy(app)class Authors(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(20)) specialisation = db.Column(db.String(50)) def create(self): db.session.add(self) db.session.commit() return self def __init__(self, name, specialisation): self.name = name self.specialisation = specialisation def __repr__(self): return '&lt;Author %d&gt;' % self.iddb.create_all()class AuthorsSchema(ModelSchema): class Meta(ModelSchema.Meta): model = Authors sqla_session = db.session id = fields.Number(dump_only=True) name = fields.String(required=True) specialisation = fields.String(required=True)@app.route('/authors', methods=['GET'])def index(): get_authors = Authors.query.all() author_schema = AuthorsSchema(many=True) authors = author_schema.dump(get_authors) return make_response(jsonify(&#123;"authors": authors&#125;))@app.route('/authors/&lt;id&gt;', methods=['GET'])def get_author_by_id(id): get_author = Authors.query.get(id) author_schema = AuthorsSchema() author = author_schema.dump(get_author) return make_response(jsonify(&#123;"author": author&#125;))@app.route('/authors', methods=['POST'])def create_author(): data = request.get_json() author_schema = AuthorsSchema() author = author_schema.load(data) result = author_schema.dump(author.create()) return make_response(jsonify(&#123;"author": result&#125;), 200)@app.route('/authors/&lt;id&gt;', methods=['PUT'])def update_author_by_id(id): data = request.get_json() get_author = Authors.query.get(id) if data.get('specialisation'): get_author.specialisation = data['specialisation'] if data.get('name'): get_author.name = data['name'] db.session.add(get_author) db.session.commit() author_schema = AuthorsSchema(only=['id', 'name', 'specialisation']) author = author_schema.dump(get_author) return make_response(jsonify(&#123;"author": author&#125;))@app.route('/authors/&lt;id&gt;', methods=['DELETE'])def delete_author_by_id(id): get_author = Authors.query.get(id) db.session.delete(get_author) db.session.commit() return make_response("", 204)if __name__ == "__main__": app.run(host='0.0.0.0', debug=True) äº”ã€æµ‹è¯•è¿è¡Œ python app.py å‘½ä»¤å¼€å¯ Web æœåŠ¡ï¼Œä½¿ç”¨ httpie å·¥å…·æµ‹è¯• REST APIã€‚ POST æ–¹æ³•æ·»åŠ æ–°çš„æ•°æ®çºªå½•ï¼š1234567891011121314$ http POST 127.0.0.1:5000/authors name="starky" specialisation="Python"HTTP/1.0 200 OKContent-Length: 92Content-Type: application/jsonDate: Wed, 27 Nov 2019 02:12:41 GMTServer: Werkzeug/0.16.0 Python/3.7.4&#123; "author": &#123; "id": 1.0, "name": "starky", "specialisation": "Python" &#125;&#125; GET æ–¹æ³•èŽ·å–æ•°æ®çºªå½•ï¼š12345678910$ http GET 127.0.0.1:5000/authors&#123; "authors": [ &#123; "id": 1.0, "name": "starky", "specialisation": "Python" &#125; ]&#125; PUT æ–¹æ³•æ›´æ–°å·²æœ‰çš„æ•°æ®çºªå½•ï¼š12345678$ http PUT 127.0.0.1:5000/authors/1 name="skitar" specialisation="Go"&#123; "author": &#123; "id": 1.0, "name": "skitar", "specialisation": "Go" &#125;&#125; DELETE æ–¹æ³•åˆ é™¤æŸæ¡æ•°æ®ï¼š123456$ http DELETE 127.0.0.1:5000/authors/1$ http GET 127.0.0.1:5000/authors&#123; "authors": []&#125; å‚è€ƒèµ„æ–™Building REST APIs with Flask]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>REST</tag>
        <tag>API</tag>
        <tag>Flask</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python 3.7 é€šè¿‡ asyncio å®žçŽ°å¼‚æ­¥ç¼–ç¨‹]]></title>
    <url>%2F2019%2F11%2F07%2Fpython-37-async-programming-with-asyncio%2F</url>
    <content type="text"><![CDATA[Python ä¸­é€šè¿‡ asyncio å®žçŽ°çš„å¼‚æ­¥ç¼–ç¨‹ä¸»è¦åŒ…å«å¦‚ä¸‹ä¸‰ä¸ªæ¨¡å—ï¼š äº‹ä»¶å¾ªçŽ¯ï¼ˆevent loopï¼‰ï¼šæ¯ä¸€ä¸ªéœ€è¦å¼‚æ­¥æ‰§è¡Œçš„ä»»åŠ¡éƒ½ä¼šåœ¨äº‹ä»¶å¾ªçŽ¯ä¸­æ³¨å†Œï¼Œäº‹ä»¶å¾ªçŽ¯è´Ÿè´£ç®¡ç†è¿™äº›ä»»åŠ¡ä¹‹é—´çš„æ‰§è¡Œæµç¨‹ åç¨‹ï¼ˆCoroutineï¼‰ï¼šæŒ‡ç”¨äºŽæ‰§è¡Œå…·ä½“æŸä¸ªå¼‚æ­¥ä»»åŠ¡çš„å‡½æ•°ã€‚å‡½æ•°ä½“ä¸­çš„ await å…³é”®å­—å¯ä»¥å°†åç¨‹çš„æŽ§åˆ¶æƒé‡Šæ”¾ç»™äº‹ä»¶å¾ªçŽ¯ Futureï¼šè¡¨ç¤ºå·²ç»æ‰§è¡Œæˆ–è€…å°šæœªæ‰§è¡Œçš„ä»»åŠ¡çš„ç»“æžœ åœ¨å¼‚æ­¥ç¨‹åºçš„ä¸–ç•Œé‡Œï¼Œæ‰€æœ‰ä»£ç éƒ½è¿è¡Œåœ¨äº‹ä»¶å¾ªçŽ¯ä¸­ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªåç¨‹ã€‚è¿™äº›åç¨‹å¼‚æ­¥åœ°æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ° await å…³é”®å­—ï¼Œæ­¤æ—¶è¯¥åç¨‹ä¼šè®©å‡ºç¨‹åºæŽ§åˆ¶æƒç»™äº‹ä»¶å¾ªçŽ¯ï¼Œä½¿å¾—å…¶ä»–åç¨‹æœ‰æœºä¼šå‘æŒ¥ä½œç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­åŒæ—¶åŒ…å«å¼‚æ­¥å’ŒåŒæ­¥ä»£ç ã€‚å³åœ¨åŒæ­¥å‡½æ•°ä¸­æ— æ³•ä½¿ç”¨ await å…³é”®å­—ã€‚ ä¸€ã€Hello Worldä»¥ä¸‹æ˜¯ä¸€æ®µç®€å•çš„ä½¿ç”¨äº† async å…³é”®å­—çš„ Hello World ç¨‹åºï¼š12345678910import asyncioasync def hello(first_print, second_print): print(first_print) await asyncio.sleep(1) print(second_print)asyncio.run(hello("Welcome", "Good-bye"))# =&gt; Welcome# =&gt; Good-bye ä¸Šè¿°ä»£ç çš„è¡Œä¸ºçœ‹ä¸ŠåŽ»æ›´åƒæ˜¯åŒæ­¥ä»£ç ï¼Œå…ˆè¾“å‡º Welcomeï¼Œç­‰å¾…ä¸€ç§’é’Ÿä¹‹åŽï¼Œå†è¾“å‡º Good-byeã€‚åœ¨è¿›ä¸€æ­¥æŽ¢ç©¶ä¹‹å‰ï¼Œå…ˆçœ‹ä¸‹ä¸Šè¿°å¼‚æ­¥ä»£ç ä¸­å‡ºçŽ°çš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š Python è¯­è¨€ä¸­ï¼Œä»»ä½•ç”± async def å®šä¹‰çš„å‡½æ•°ï¼ˆå³ä¸Šé¢çš„ hello()ï¼‰éƒ½å¯ä»¥ç§°ä¹‹ä¸ºåç¨‹ã€‚è°ƒç”¨åç¨‹å‡½æ•°æ‰€è¿”å›žçš„å¯¹è±¡ç§°ä¸ºåç¨‹å¯¹è±¡ã€‚ å‡½æ•° asyncio.run æ˜¯æ‰€æœ‰å¼‚æ­¥ä»£ç çš„ä¸»å…¥å£ï¼Œåªåº”è¯¥è¢«è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒè´Ÿè´£ç»„ç»‡ä¼ å…¥çš„åç¨‹å¯¹è±¡ï¼ŒåŒæ—¶ç®¡ç† asyncio çš„äº‹ä»¶å¾ªçŽ¯ã€‚ await å…³é”®å­—ç”¨äºŽå°†åç¨‹è¿è¡Œæ—¶èŽ·å–çš„ç¨‹åºæŽ§åˆ¶æƒç§»äº¤ç»™äº‹ä»¶å¾ªçŽ¯ï¼Œå¹¶ä¸­æ–­è¯¥åç¨‹çš„æ‰§è¡Œæµç¨‹ã€‚ ä¸€ä¸ªæ›´çŽ°å®žçš„å¼‚æ­¥ç¨‹åºçš„ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526import asyncioimport timeasync def say_something(delay, words): print(f"Started: &#123;words&#125;") await asyncio.sleep(delay) print(f"Finished: &#123;words&#125;")async def main(): print(f"Starting Tasks: &#123;time.strftime('%X')&#125;") task1 = asyncio.create_task(say_something(1, "First task")) task2 = asyncio.create_task(say_something(2, "Second task")) await task1 await task2 print(f"Finished Tasks: &#123;time.strftime('%X')&#125;")asyncio.run(main())# =&gt; Starting Tasks: 20:32:28# =&gt; Started: First task# =&gt; Started: Second task# =&gt; Finished: First task# =&gt; Finished: Second task# =&gt; Finished Tasks: 20:32:30 ä»ŽåŒæ­¥æ‰§è¡Œçš„é€»è¾‘æ¥çœ‹ï¼Œåº”è¯¥æ˜¯ task1 å¼€å§‹ï¼Œç­‰å¾…ä¸€ç§’é’Ÿï¼Œç»“æŸï¼›task2 å¼€å§‹ï¼Œç­‰å¾…ä¸¤ç§’é’Ÿï¼Œç»“æŸã€‚å…±è€—æ—¶ 3 ç§’ä»¥ä¸Šã€‚å¼‚æ­¥ç¨‹åºå®žé™…çš„æ‰§è¡Œæµç¨‹ä¸ºï¼Œtask1 å’Œ task2 åŒæ—¶å¼€å§‹ï¼Œå„è‡ªç­‰å¾…ä¸€æ®µæ—¶é—´åŽï¼Œå…ˆåŽç»“æŸã€‚å…±è€—æ—¶ 2 ç§’ã€‚å…·ä½“å¦‚ä¸‹ï¼š task1 ä¸­çš„ say_something åç¨‹å¼€å§‹æ‰§è¡Œ say_something é‡åˆ° await å…³é”®å­—æ—¶ï¼ˆawait asyncio.sleep(delay)ï¼‰ï¼Œåç¨‹æš‚åœæ‰§è¡Œå¹¶ç­‰å¾… 1 ç§’é’Ÿï¼Œåœ¨æš‚åœçš„åŒæ—¶å°†ç¨‹åºæŽ§åˆ¶æƒè½¬ç§»ç»™äº‹ä»¶å¾ªçŽ¯ task2 ä»Žäº‹ä»¶å¾ªçŽ¯èŽ·å–æŽ§åˆ¶æƒå¼€å§‹æ‰§è¡Œï¼ŒåŒæ ·é‡åˆ° await å…³é”®å­—æ—¶æš‚åœåç¨‹å¹¶ç­‰å¾… 2 ç§’é’Ÿï¼Œåœ¨æš‚åœçš„åŒæ—¶å°†ç¨‹åºæŽ§åˆ¶æƒè½¬ç§»ç»™äº‹ä»¶å¾ªçŽ¯ task1 ç­‰å¾…æ—¶é—´ç»“æŸåŽï¼Œäº‹ä»¶å¾ªçŽ¯å°†æŽ§åˆ¶æƒç§»äº¤ç»™ task1ï¼Œæ¢å¤å…¶åç¨‹çš„è¿è¡Œç›´è‡³ç»“æŸ task1 è¿è¡Œç»“æŸï¼Œtask2 ç­‰å¾…æ—¶é—´å®Œæˆï¼Œtask2 èŽ·å–ç¨‹åºæŽ§åˆ¶æƒå¹¶æ¢å¤è¿è¡Œç›´è‡³ç»“æŸã€‚ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚ äºŒã€Awaitable å¯¹è±¡await å…³é”®å­—ç”¨äºŽå°†ç¨‹åºæŽ§åˆ¶æƒç§»äº¤ç»™äº‹ä»¶å¾ªçŽ¯å¹¶ä¸­æ–­å½“å‰åç¨‹çš„æ‰§è¡Œã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨è§„åˆ™ï¼š åªèƒ½ç”¨åœ¨ç”± async def ä¿®é¥°çš„å‡½æ•°ä¸­ï¼Œåœ¨æ™®é€šå‡½æ•°ä¸­ä½¿ç”¨ä¼šæŠ›å‡ºå¼‚å¸¸ è°ƒç”¨ä¸€ä¸ªåç¨‹å‡½æ•°åŽï¼Œå°±å¿…é¡»ç­‰å¾…å…¶æ‰§è¡Œå®Œæˆå¹¶è¿”å›žç»“æžœ await func() ä¸­çš„ func() å¿…é¡»æ˜¯ä¸€ä¸ª awaitable å¯¹è±¡ã€‚å³ä¸€ä¸ªåç¨‹å‡½æ•°æˆ–è€…ä¸€ä¸ªåœ¨å†…éƒ¨å®žçŽ°äº† __await__() æ–¹æ³•çš„å¯¹è±¡ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›žä¸€ä¸ªç”Ÿæˆå™¨ Awaitable å¯¹è±¡åŒ…å«åç¨‹ã€Task å’Œ Future ç­‰ã€‚ åç¨‹å…³äºŽè¢« await è°ƒç”¨çš„åç¨‹ï¼Œå³ä¸Šé¢çš„ç¬¬äºŒæ¡è§„åˆ™ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425import asyncioasync def mult(first, second): print(f"Calculating multiply of &#123;first&#125; and &#123;second&#125;") await asyncio.sleep(1) num_mul = first * second print(f"Multiply is &#123;num_mul&#125;") return num_mulasync def sum(first, second): print(f"Calculating sum of &#123;first&#125; and &#123;second&#125;") await asyncio.sleep(1) num_sum = first + second print(f"Sum is &#123;num_sum&#125;") return num_sumasync def main(first, second): await sum(first, second) await mult(first, second)asyncio.run(main(7, 8))# =&gt; Calculating sum of 7 and 8# =&gt; Sum is 15# =&gt; Calculating multiply of 7 and 8# =&gt; Multiply is 56 ä¸Šè¿°ä»£ç ä¸­ç”± await ä¿®é¥°çš„ä¸¤ä¸ªåç¨‹å‡½æ•° sum å’Œ mult å³ä¸º awaitable å¯¹è±¡ï¼Œä»Žè¾“å‡ºç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œsum å‡½æ•°å…ˆæ‰§è¡Œå®Œæ¯•å¹¶è¾“å‡ºç»“æžœï¼ŒéšåŽ mult å‡½æ•°æ‰§è¡Œå¹¶è¾“å‡ºç»“æžœã€‚å³ await è°ƒç”¨çš„åç¨‹å‡½æ•°å¿…é¡»æ‰§è¡Œå®Œæ¯•åŽæ‰èƒ½ç»§ç»­æ‰§è¡Œå¦å¤–çš„ await åç¨‹ï¼Œè¿™çœ‹ä¸ŠåŽ»å¹¶ä¸ç¬¦åˆå¼‚æ­¥ç¨‹åºçš„å®šä¹‰ã€‚ Tasksåç¨‹å¼‚æ­¥æ‰§è¡Œçš„å…³é”®åœ¨äºŽ Tasksã€‚å½“ä»»æ„ä¸€ä¸ªåç¨‹å‡½æ•°è¢«ç±»ä¼¼äºŽ asyncio.create_task() çš„å‡½æ•°è°ƒç”¨æ—¶ï¼Œè¯¥åç¨‹å°±ä¼šè‡ªåŠ¨æŽ’è¿›ç”±äº‹ä»¶å¾ªçŽ¯ç®¡ç†çš„æ‰§è¡Œæµç¨‹é‡Œã€‚åœ¨ asyncio çš„å®šä¹‰ä¸­ï¼Œç”±äº‹ä»¶å¾ªçŽ¯æŽ§åˆ¶è¿è¡Œçš„åç¨‹å³è¢«ç§°ä¸ºä»»åŠ¡ã€‚ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç¼–å†™å¼‚æ­¥ä»£ç å³æ„å‘³ç€éœ€è¦ä½¿ç”¨ create_task() æ–¹æ³•å°†åç¨‹æ”¾è¿›äº‹ä»¶å¾ªçŽ¯ã€‚ å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425262728import asyncioasync def mul(first, second): print(f"Calculating multiply of &#123;first&#125; and &#123;second&#125;") await asyncio.sleep(1) num_mul = first * second print(f"Multiply is &#123;num_mul&#125;") return num_mulasync def sum(first, second): print(f"Calculating sum of &#123;first&#125; and &#123;second&#125;") await asyncio.sleep(1) num_sum = first + second print(f"Sum is &#123;num_sum&#125;") return num_sumasync def main(first, second): sum_task = asyncio.create_task(sum(first, second)) mul_task = asyncio.create_task(mul(first, second)) await sum_task await mul_taskasyncio.run(main(7, 8))# =&gt; Calculating sum of 7 and 8# =&gt; Calculating multiply of 7 and 8# =&gt; Sum is 15# =&gt; Multiply is 56 å¯¹æ¯”ä¸Šä¸€æ®µä»£ç ç¤ºä¾‹ï¼Œä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œsum_task å’Œ mul_task ä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œæµç¨‹ç¬¦åˆå¼‚æ­¥ç¨‹åºçš„é€»è¾‘ã€‚sum_task é‡åˆ° await asyncio.sleep(1) è¯­å¥åŽå¹¶æ²¡æœ‰è®©æ•´ä¸ªç¨‹åºç­‰å¾…è‡ªå·±è¿”å›žè®¡ç®—ç»“æžœï¼Œè€Œæ˜¯ä¸­æ–­æ‰§è¡Œå¹¶æŠŠæŽ§åˆ¶æƒé€šè¿‡äº‹ä»¶å¾ªçŽ¯ç§»äº¤ç»™ mul_taskã€‚ä¸¤ä¸ªä»»åŠ¡å…ˆåŽæ‰§è¡Œå¹¶è¿›å…¥ç­‰å¾…ï¼Œæœ€åŽåœ¨å„è‡ªçš„ç­‰å¾…æ—¶é—´ç»“æŸåŽè¾“å‡ºç»“æžœã€‚ é™¤ create_task() å‡½æ•°ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ asyncio.gather() å‡½æ•°åˆ›å»ºå¼‚æ­¥ä»»åŠ¡ï¼š123456789101112131415161718192021222324import asyncioimport timeasync def greetings(): print("Welcome") await asyncio.sleep(1) print("Good by")async def main(): await asyncio.gather(greetings(), greetings())def say_greet(): start = time.perf_counter() asyncio.run(main()) elasped = time.perf_counter() - start print(f"Total time elasped: &#123;elasped&#125;")say_greet()# =&gt; Welcome# =&gt; Welcome# =&gt; Good by# =&gt; Good by# =&gt; Total time elasped: 1.0213364 å®žé™…ä¸¤ä¸ªä»»åŠ¡å®Œæˆçš„æ—¶é—´ç•¥å¤§äºŽ 1 ç§’è€Œä¸æ˜¯ 2 ç§’ã€‚ FuturesFutures ä»£è¡¨å¼‚æ­¥æ“ä½œçš„é¢„æœŸç»“æžœï¼Œå³è¯¥å¼‚æ­¥æ“ä½œå¯èƒ½å·²ç»æ‰§è¡Œä¹Ÿå¯èƒ½å°šæœªæ‰§è¡Œå®Œæ¯•ã€‚é€šå¸¸æƒ…å†µä¸‹å¹¶ä¸éœ€è¦åœ¨ä»£ç ä¸­æ˜¾å¼åœ°ç®¡ç† Future å¯¹è±¡ï¼Œè¿™äº›å·¥ä½œä¸€èˆ¬ç”± asyncio åº“éšå¼åœ°å¤„ç†ã€‚ å½“ä¸€ä¸ª Future å®žä¾‹è¢«åˆ›å»ºæˆåŠŸä»¥åŽï¼Œå³ä»£è¡¨è¯¥å®žä¾‹å…³è”çš„å¼‚æ­¥æ“ä½œè¿˜æ²¡æœ‰å®Œæˆï¼Œä½†æ˜¯ä¼šåœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´è¿”å›žç»“æžœã€‚asyncio æœ‰ä¸€ä¸ª asyncio.wait_for(aws, timeout, *) æ–¹æ³•å¯ä»¥ä¸ºå¼‚æ­¥ä»»åŠ¡è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚å¦‚æžœè¶…è¿‡æŒ‡å®šæ—¶é—´åŽå¼‚æ­¥æ“ä½œä»æœªæ‰§è¡Œå®Œæ¯•ï¼Œåˆ™è¯¥ä»»åŠ¡è¢«å–æ¶ˆå¹¶æŠ›å‡º asyncio.TimeoutError å¼‚å¸¸ã€‚timeout çš„é»˜è®¤å€¼ä¸º Noneï¼Œå³ç¨‹åºä¼šé˜»å¡žå¹¶ä¸€ç›´ç­‰å¾…ç›´åˆ° Future å¯¹è±¡å…³è”çš„æ“ä½œè¿”å›žç»“æžœã€‚123456789101112131415import asyncioasync def long_time_taking_method(): await asyncio.sleep(4000) print("Completed the work")async def main(): try: await asyncio.wait_for(long_time_taking_method(), timeout=2) except asyncio.TimeoutError: print("Timeout occurred")asyncio.run(main())# =&gt; Timeout occurred ä¸‰ã€Async å®žä¾‹ä»£ç é€šè¿‡åˆ›å»ºå­è¿›ç¨‹å¼‚æ­¥æ‰§è¡Œ Shell å‘½ä»¤ï¼š12345678910111213141516171819202122232425262728293031323334353637import asyncioasync def run(cmd): proc = await asyncio.create_subprocess_shell( cmd, stdout=asyncio.subprocess.PIPE, stderr=asyncio.subprocess.PIPE) stdout, stderr = await proc.communicate() print(f'[&#123;cmd!r&#125; exited with &#123;proc.returncode&#125;]') if stdout: print(f'[stdout]\n&#123;stdout.decode()&#125;') if stderr: print(f'[stderr]\n&#123;stderr.decode()&#125;')async def main(): await asyncio.gather( run('sleep 2; echo "world"'), run('sleep 1; echo "hello"'), run('ls /zzz'))asyncio.run(main())# =&gt; ['ls /zzz' exited with 2]# =&gt; [stderr]# =&gt; ls: cannot access '/zzz': No such file or directory# =&gt; ['sleep 1; echo "hello"' exited with 0]# =&gt; [stdout]# =&gt; hello# =&gt; ['sleep 2; echo "world"' exited with 0]# =&gt; [stdout]# =&gt; world é€šè¿‡ Queue å°†å·¥ä½œè´Ÿè½½åˆ†å‘ç»™å¤šä¸ªå¼‚æ­¥æ‰§è¡Œçš„ Task å¤„ç†ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import asyncioimport randomimport timeasync def worker(name, queue): while True: # Get a "work item" out of the queue. sleep_for = await queue.get() # Sleep for the "sleep_for" seconds. await asyncio.sleep(sleep_for) # Notify the queue that the "work item" has been processed. queue.task_done() print(f'&#123;name&#125; has slept for &#123;sleep_for:.2f&#125; seconds')async def main(): # Create a queue that we will use to store our "workload". queue = asyncio.Queue() # Generate random timings and put them into the queue. total_sleep_time = 0 for _ in range(20): sleep_for = random.uniform(0.05, 1.0) total_sleep_time += sleep_for queue.put_nowait(sleep_for) # Create three worker tasks to process the queue concurrently. tasks = [] for i in range(3): task = asyncio.create_task(worker(f'worker-&#123;i&#125;', queue)) tasks.append(task) # Wait until the queue is fully processed. started_at = time.monotonic() await queue.join() total_slept_for = time.monotonic() - started_at # Cancel our worker tasks. for task in tasks: task.cancel() # Wait until all worker tasks are cancelled. await asyncio.gather(*tasks, return_exceptions=True) print('====') print(f'3 workers slept in parallel for &#123;total_slept_for:.2f&#125; seconds') print(f'total expected sleep time: &#123;total_sleep_time:.2f&#125; seconds')asyncio.run(main())# =&gt; worker-2 has slept for 0.12 seconds# =&gt; worker-1 has slept for 0.28 seconds# =&gt; worker-1 has slept for 0.12 seconds# =&gt; worker-0 has slept for 0.46 seconds# =&gt; worker-0 has slept for 0.49 seconds# =&gt; worker-2 has slept for 0.90 seconds# =&gt; worker-1 has slept for 0.62 seconds# =&gt; worker-1 has slept for 0.67 seconds# =&gt; worker-0 has slept for 0.85 seconds# =&gt; worker-2 has slept for 0.94 seconds# =&gt; worker-1 has slept for 0.45 seconds# =&gt; worker-2 has slept for 0.19 seconds# =&gt; worker-0 has slept for 0.99 seconds# =&gt; worker-2 has slept for 0.86 seconds# =&gt; worker-1 has slept for 0.97 seconds# =&gt; worker-0 has slept for 0.74 seconds# =&gt; worker-1 has slept for 0.58 seconds# =&gt; worker-2 has slept for 0.73 seconds# =&gt; worker-1 has slept for 0.27 seconds# =&gt; worker-0 has slept for 0.57 seconds# =&gt; ====# =&gt; 3 workers slept in parallel for 4.10 seconds# =&gt; total expected sleep time: 11.80 seconds å‚è€ƒèµ„æ–™asyncio â€” Asynchronous I/O]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Concurrency</tag>
        <tag>Performance</tag>
        <tag>Async</tag>
        <tag>Eventloop</tag>
        <tag>Coroutine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ Celery æ¡†æž¶å®žçŽ°åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—]]></title>
    <url>%2F2019%2F11%2F06%2Fpython-celery-distributed-message-queue%2F</url>
    <content type="text"><![CDATA[Celery æ˜¯ä¸€ä¸ªç®€å•ã€çµæ´»ä¸”å¯é çš„åˆ†å¸ƒå¼æ¶ˆæ¯å¤„ç†ç³»ç»Ÿï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—å¯¹æµ·é‡æ¶ˆæ¯æ•°æ®è¿›è¡Œå®žæ—¶çš„å¤„ç†ï¼Œåœ¨å¤šä¸ªç¨‹åºçº¿ç¨‹æˆ–è€…ä¸»æœºä¹‹é—´ä¼ é€’å’Œåˆ†å‘å·¥ä½œä»»åŠ¡ã€‚åŒæ—¶ä¹Ÿæ”¯æŒè®¡åˆ’ä»»åŠ¡ç­‰éœ€æ±‚ã€‚ ä¸€ã€çŽ¯å¢ƒé…ç½®Celery æ¡†æž¶è‡ªèº«å¹¶ä¸å¯¹ä¼ å…¥çš„æ¶ˆæ¯è¿›è¡Œå­˜å‚¨ï¼Œå› æ­¤åœ¨ä½¿ç”¨å‰éœ€è¦å…ˆå®‰è£…ç¬¬ä¸‰æ–¹çš„ Message Brokerã€‚å¦‚ RabbitMQ å’Œ Redis ç­‰ã€‚ å®‰è£… RabbitMQå¯¹äºŽ Linux ç³»ç»Ÿï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š12345$ sudo apt-get install rabbitmq-server # å®‰è£… RabbitMQ$ sudo rabbitmqctl add_user myuser mypassword # æ·»åŠ ç”¨æˆ· myuser/mypassword$ sudo rabbitmqctl add_vhost myvhost # æ·»åŠ  vhost$ sudo rabbitmqctl set_user_tags myuser mytag$ sudo rabbitmqctl set_permissions -p myvhost myuser ".*" ".*" ".*" # ä¸ºç”¨æˆ· myuser è®¾ç½®è®¿é—® myvhost çš„æƒé™ é€šè¿‡ Docker å®‰è£…çš„æ­¥éª¤å¦‚ä¸‹ï¼š123456$ docker pull rabbitmq:3.8-management # æ‹‰å– docker é•œåƒï¼ˆåŒ…å« web ç®¡ç†ï¼‰# å¯åŠ¨ rabbitmq å®¹å™¨$ docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 --hostname myRabbit \-e RABBITMQ_DEFAULT_VHOST=myvhost \-e RABBITMQ_DEFAULT_USER=myuser \-e RABBITMQ_DEFAULT_PASS=mypassword rabbitmq:3.8-management å®‰è£… Redis$ sudo apt-get install redis-server å®‰è£… Celery$ pip install celery äºŒã€åˆ›å»º Celery åº”ç”¨Celery åº”ç”¨æ˜¯è¯¥æ¡†æž¶æ‰€èƒ½æä¾›çš„æ‰€æœ‰åŠŸèƒ½ï¼ˆå¦‚ç®¡ç† tasks å’Œ workers ç­‰ï¼‰çš„å…¥å£ï¼Œé¡»ç¡®ä¿å®ƒå¯ä»¥è¢«å…¶ä»–æ¨¡å—å¯¼å…¥ã€‚ä»¥ä¸‹æ˜¯ä¸€æ®µç®€å•çš„ Celery app ä»£ç  tasks.pyï¼š12345678910# tasks.pyfrom celery import Celeryapp = Celery('tasks', broker='pyamqp://myuser:mypassword@localhost:5672/myvhost', backend='redis://localhost:6379/0')@app.taskdef add(x, y): return x + y ä½¿ç”¨ RabbitMQ ä½œä¸º broker æŽ¥æ”¶å’Œå‘é€ä»»åŠ¡æ¶ˆæ¯ï¼Œä½¿ç”¨ Redis ä½œä¸º backend å­˜å‚¨è®¡ç®—ç»“æžœã€‚ è¿è¡Œ Celery worker æœåŠ¡$ celery -A tasks worker --loglevel=info 123456789101112131415161718192021222324$ celery -A tasks worker --loglevel=info -------------- celery@skitarniu-ubuntu18 v4.3.0 (rhubarb)---- **** -------- * *** * -- Linux-4.15.0-60-generic-x86_64-with-debian-buster-sid 2019-11-01 07:21:34-- * - **** ---- ** ---------- [config]- ** ---------- .&gt; app: tasks:0x7f4f30b84a90- ** ---------- .&gt; transport: amqp://myuser:**@localhost:5672/myvhost- ** ---------- .&gt; results: redis://localhost:6379/0- *** --- * --- .&gt; concurrency: 2 (prefork)-- ******* ---- .&gt; task events: OFF (enable -E to monitor tasks in this worker)--- ***** ----- -------------- [queues] .&gt; celery exchange=celery(direct) key=celery[tasks] . tasks.add[2019-11-01 07:21:35,316: INFO/MainProcess] Connected to amqp://myuser:**@127.0.0.1:5672/myvhost[2019-11-01 07:21:35,367: INFO/MainProcess] mingle: searching for neighbors[2019-11-01 07:21:36,535: INFO/MainProcess] mingle: all alone[2019-11-01 07:21:36,782: INFO/MainProcess] celery@skitarniu-ubuntu18 ready. ä»»åŠ¡æµ‹è¯•è¿›å…¥ Python Shellï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å‘å¸ƒä»»åŠ¡å¹¶èŽ·å–ç»“æžœï¼š12345678910&gt;&gt;&gt; from tasks import add&gt;&gt;&gt; result = add.delay(4, 4)&gt;&gt;&gt; result&lt;AsyncResult: 6f435bc7-f194-469c-837f-54d77f880ace&gt;&gt;&gt;&gt; result.ready()True&gt;&gt;&gt; result.get()8&gt;&gt;&gt; result.traceback&gt;&gt;&gt; delay() æ–¹æ³•ç”¨äºŽå‘å¸ƒä»»åŠ¡æ¶ˆæ¯ï¼Œå®ƒæ˜¯ apply_async() æ–¹æ³•çš„ç®€å†™ï¼Œå³ä»¥å¼‚æ­¥çš„æ–¹å¼å°†ä»»åŠ¡éœ€æ±‚æäº¤ç»™å‰é¢å¯åŠ¨å¥½çš„ worker åŽ»å¤„ç†ã€‚delay() æ–¹æ³•è¿”å›žä¸€ä¸ª AsyncResult å¯¹è±¡ã€‚result.ready() æ–¹æ³•å¯ä»¥ç”¨æ¥æ£€æŸ¥æäº¤çš„ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆï¼Œè¿”å›žå¸ƒå°”å€¼ã€‚ result.get() æ–¹æ³•åˆ™ç”¨äºŽèŽ·å–æ‰§è¡Œå®ŒæˆåŽçš„ç»“æžœã€‚å¦‚ä»»åŠ¡æœªå®Œæˆï¼Œåˆ™ç¨‹åºä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°æœ‰ç»“æžœè¿”å›žã€‚å› æ­¤è¯¥æ–¹æ³•æ˜¯é˜»å¡žçš„ï¼Œå¹¶ä¸å¸¸ç”¨ã€‚å¯ä»¥ä¼ å…¥ timeout å‚æ•°æŒ‡å®šç­‰å¾…çš„æ—¶é—´ä¸Šé™ã€‚å¦‚ result.get(timeout=1)ï¼Œå°è¯•èŽ·å–ä»»åŠ¡æ‰§è¡ŒåŽçš„ç»“æžœï¼Œç­‰å¾… 1 ç§’ã€‚è‹¥ 1 ç§’ä¹‹åŽç»“æžœä»æœªè¿”å›žï¼ŒæŠ›å‡º celery.exceptions.TimeoutError: The operation timed out. å¼‚å¸¸ã€‚ å¦‚æžœä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨ get() æ–¹æ³•èŽ·å–ç»“æžœæ—¶ä¼šé‡æ–°æŠ›å‡ºè¯¥å¼‚å¸¸å¯¼è‡´ç¨‹åºä¸­æ–­ã€‚å¯ä»¥é€šè¿‡ä¿®æ”¹ propagate å‚æ•°é¿å…æ­¤æƒ…å†µï¼šresult.get(propagate=False)result.traceback åˆ™ç”¨äºŽèŽ·å–ä»»åŠ¡çš„ traceback ä¿¡æ¯ã€‚ ä¸‰ã€Calling TasksCelery å®šä¹‰äº†ä¸€äº›å¯ä¾› task å®žä¾‹è°ƒç”¨çš„é€šç”¨çš„ Calling APIï¼ŒåŒ…æ‹¬ä¸‰ä¸ªæ–¹æ³•å’Œä¸€äº›æ ‡å‡†çš„æ‰§è¡Œé€‰é¡¹ï¼š apply_async(args[, kwargs[, ...]])ï¼šå‘é€ä»»åŠ¡æ¶ˆæ¯ç»™ worker delay(*args, **kwargs)ï¼šå‘é€ä»»åŠ¡æ¶ˆæ¯çš„ç®€å†™å½¢å¼ï¼Œä¸æ”¯æŒæ‰§è¡Œé€‰é¡¹ calling (__call__)ï¼šå³åœ¨æœ¬åœ°è¿›ç¨‹ä¸­ç›´æŽ¥æ‰§è¡Œä»»åŠ¡å‡½æ•°ï¼Œä¸é€šè¿‡ worker å¼‚æ­¥æ‰§è¡Œ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è°ƒç”¨ç¤ºä¾‹ï¼š T.delay(arg, kwarg=value) T.apply_async((arg,), {&#39;kwarg&#39;: value}) T.apply_async(countdown=10)10 ç§’ä¹‹åŽå¼€å§‹æ‰§è¡ŒæŸä¸ªä»»åŠ¡ T.apply_async(eta=now + timedelta(seconds=10))10 ç§’ä¹‹åŽå¼€å§‹æ‰§è¡ŒæŸä¸ªä»»åŠ¡ T.apply_async(countdown=60, expires=120)é¢„è®¡ 1 åˆ†é’ŸåŽå¼€å§‹æ‰§è¡Œï¼Œä½† 2 åˆ†é’ŸåŽè¿˜æœªæ‰§è¡Œåˆ™å¤±æ•ˆ T.apply_async(expires=now + timedelta(days=2))2 å¤©åŽå¤±æ•ˆ é€šè¿‡ countdown è®¾ç½®ä»»åŠ¡çš„å»¶è¿Ÿæ‰§è¡Œï¼š123456789101112131415&gt;&gt;&gt; from tasks import add&gt;&gt;&gt; result = add.apply_async((2, 3))&gt;&gt;&gt; result.get()5&gt;&gt;&gt; delay_result = add.apply_async((2, 3), countdown=15)&gt;&gt;&gt; delay_result.ready()False&gt;&gt;&gt; delay_result.ready()False&gt;&gt;&gt; delay_result.ready()False&gt;&gt;&gt; delay_result.ready()True&gt;&gt;&gt; delay_result.get()5 è¿˜å¯ä»¥é€šè¿‡ etaï¼ˆestimated time of arrivalï¼‰ è®¾ç½®å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ï¼š1234&gt;&gt;&gt; from datetime import datetime, timedelta&gt;&gt;&gt; tomorrow = datetime.utcnow() + timedelta(days=1)&gt;&gt;&gt; add.apply_async((2, 3), eta=tomorrow)&lt;AsyncResult: c7dc6d7f-8b87-49d1-8077-73d7f046d709&gt; æ­¤æ—¶ worker åœ¨å‘½ä»¤è¡Œçš„æ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š12[2019-11-06 05:16:21,362: INFO/MainProcess] Received task: tasks.add[c7dc6d7f-8b87-49d1-8077-73d7f046d709]ETA:[2019-11-07 05:16:06.652736+00:00] å››ã€è®¡åˆ’ä»»åŠ¡Celery å…è®¸åƒä½¿ç”¨ crontab é‚£æ ·æŒ‰è®¡åˆ’åœ°å®šæ—¶æ‰§è¡ŒæŸä¸ªä»»åŠ¡ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819# tasks.pyfrom celery import Celeryapp = Celery('tasks', broker='pyamqp://myuser:mypassword@localhost:5672/myvhost', backend='redis://localhost:6379/1')app.conf.beat_schedule = &#123; 'add-every-60-seconds': &#123; 'task': 'tasks.add', 'schedule': 60.0, 'args': (16, 16) &#125;,&#125;app.conf.timezone = 'UTC'@app.taskdef add(x, y): print(x + y) è¿è¡Œ celery -A tasks worker -B å¯åŠ¨ worker æœåŠ¡ã€‚-B é€‰é¡¹è¡¨ç¤º beatï¼Œå³ celery beat æœåŠ¡ï¼Œè´Ÿè´£æ‰§è¡Œè®¡åˆ’ä»»åŠ¡ã€‚ è¾“å‡ºå¦‚ä¸‹ï¼ˆæ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰ï¼š12345678$ celery -A tasks worker -B...[2019-11-06 05:41:34,057: WARNING/ForkPoolWorker-3] 32[2019-11-06 05:42:33,998: WARNING/ForkPoolWorker-3] 32[2019-11-06 05:43:34,056: WARNING/ForkPoolWorker-3] 32[2019-11-06 05:44:34,105: WARNING/ForkPoolWorker-3] 32[2019-11-06 05:45:34,157: WARNING/ForkPoolWorker-3] 32... åŒæ—¶ Celery ä¹Ÿæ”¯æŒæ›´å¤æ‚çš„ crontab ç±»åž‹çš„æ—¶é—´è§„åˆ’ï¼š12345678910from celery.schedules import crontabapp.conf.beat_schedule = &#123; # Executes every Monday morning at 7:30 a.m. 'add-every-monday-morning': &#123; 'task': 'tasks.add', 'schedule': crontab(hour=7, minute=30, day_of_week=1), 'args': (16, 16), &#125;,&#125; Crontab è¡¨è¾¾å¼æ”¯æŒçš„è¯­æ³•å¦‚ä¸‹ï¼š Example Meaning crontab() æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ crontab(minute=0, hour=0) æ¯å¤©åŠå¤œ 0 ç‚¹æ‰§è¡Œ crontab(minute=0, hour=&#39;*/3&#39;) æ¯éš” 3 å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼ˆä»Ž 0 æ—¶å¼€å§‹ï¼‰ crontab(minute=0, hour=&#39;0,3,6,9,12,15,18,21&#39;) åŒä¸Šä¸€æ¡ crontab(day_of_week=&#39;sunday&#39;) åªåœ¨å‘¨æ—¥æ‰§è¡Œï¼Œæ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ crontab(minute=&#39;*&#39;, hour=&#39;*&#39;, day_of_week=&#39;sun&#39;) åŒä¸Šä¸€æ¡ crontab(minute=&#39;*/10&#39;, hour=&#39;3,17,22&#39;, day_of_week=&#39;thu,fri&#39;) åªåœ¨å‘¨å››ã€å‘¨äº”çš„ 3ã€17ã€22 æ—¶æ‰§è¡Œï¼Œæ¯éš” 10 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ crontab(minute=0, hour=&#39;*/2,*/3&#39;) åªåœ¨èƒ½è¢« 2 æˆ–è€… 3 æ•´é™¤çš„æ•´ç‚¹æ‰§è¡Œ crontab(minute=0, hour=&#39;*/3,8-17&#39;) åœ¨èƒ½è¢« 3 æ•´é™¤çš„æ•´ç‚¹ï¼Œå’Œ 8-17 ç‚¹ä¹‹é—´çš„æ•´ç‚¹æ‰§è¡Œ crontab(0, 0, day_of_month=&#39;2&#39;) åœ¨æ¯ä¸ªæœˆçš„ç¬¬äºŒå¤©çš„ 0 æ—¶æ‰§è¡Œ crontab(0, 0, day_of_month=&#39;11&#39;, month_of_year=&#39;5&#39;) åœ¨æ¯å¹´çš„ 5 æœˆ 11 å· 0 ç‚¹æ‰§è¡Œ å‚è€ƒèµ„æ–™Celery 4.3.0 documentation]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Message</tag>
        <tag>Concurrency</tag>
        <tag>Async</tag>
        <tag>Celery</tag>
        <tag>Distributed</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¸­çš„åç¨‹ï¼ˆcoroutineï¼‰ç®€ä»‹]]></title>
    <url>%2F2019%2F11%2F05%2Fpython-coroutines-with-generators%2F</url>
    <content type="text"><![CDATA[Python ä¸­çš„åç¨‹ï¼ˆCoroutineï¼‰æ˜¯ä¸€ç§æ¯”çº¿ç¨‹ï¼ˆThreadï¼‰æ›´åŠ è½»é‡çš„ä»£ç æ‰§è¡Œæœºæž„ã€‚ä¸Žçº¿ç¨‹ä¸åŒçš„æ˜¯ï¼Œåç¨‹å®Œå…¨æ˜¯ç”±ç¨‹åºæœ¬èº«æŽ§åˆ¶ï¼Œä¸éœ€è¦æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹å…¶è¿›è¡Œè°ƒåº¦ï¼Œå› è€Œæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚åŒæ—¶ä¹Ÿä¸éœ€è¦å¤šçº¿ç¨‹ä¸­æ•°æ®åŒæ­¥æ‰€ä¾èµ–çš„é”æœºåˆ¶ï¼Œæ‰§è¡Œæ•ˆçŽ‡ä¸Žå¤šçº¿ç¨‹ç›¸æ¯”è¦é«˜å‡ºå¾ˆå¤šã€‚ä»Žå¥æ³•ä¸Šçœ‹ï¼Œåç¨‹å¯ä»¥çœ‹ä½œå¯¹ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰çš„ä¸€ç§æ‰©å±•ï¼Œéƒ½æ˜¯å®šä¹‰ä½“ä¸­åŒ…å« yield å…³é”®å­—çš„å‡½æ•°ã€‚å¯åŠ¨ç”Ÿæˆå™¨å’Œåç¨‹æ‰€éœ€çš„å¼€é”€ï¼Œä¸Žè°ƒç”¨å‡½æ•°çš„å¼€é”€ç›¸å·®æ— å‡ ã€‚ è‹±æ–‡ä¸­çš„ yield æœ‰ä¸¤ä¸ªæ„æ€ï¼šäº§å‡ºå’Œè®©æ­¥ã€‚ Python ç”Ÿæˆå™¨ä¸­çš„ yield åˆšå¥½ç¬¦åˆäº†ä¸Šè¿°ä¸¤ä¸ªé‡Šä¹‰ã€‚yield item ä¼šâ€œäº§å‡ºâ€ä¸€ä¸ªå€¼æä¾›ç»™ next() çš„è°ƒç”¨æ–¹ï¼ŒåŒæ—¶åšå‡ºâ€œè®©æ­¥â€ï¼Œæš‚åœç”Ÿæˆå™¨å‡½æ•°çš„æ‰§è¡Œï¼Œå°†ç¨‹åºæŽ§åˆ¶æƒç§»äº¤ç»™è°ƒç”¨æ–¹ã€‚ç›´åˆ°è°ƒç”¨æ–¹å†æ¬¡æ‰§è¡Œ next() å‡½æ•°ï¼Œç”Ÿæˆå™¨åˆ™ç»§ç»­â€œäº§å‡ºâ€ä¸‹ä¸€ä¸ªå€¼ã€‚è€Œåç¨‹ä¸­çš„ yield é€šå¸¸å‡ºçŽ°åœ¨è¡¨è¾¾å¼å³è¾¹ï¼ˆå¦‚ data = yieldï¼‰ï¼Œå¯ä»¥äº§å‡ºå€¼ï¼Œä¹Ÿå¯ä»¥ä¸äº§å‡ºã€‚è°ƒç”¨æ–¹å¯ä»¥é€šè¿‡ .send(data) æ–¹æ³•å‘åç¨‹æä¾›æ•°æ®ã€‚ä¸ç®¡æ•°æ®å¦‚ä½•æµåŠ¨ï¼Œyield éƒ½æ˜¯ä¸€ç§ç”¨æ¥å®žçŽ°åä½œå¼å¤šä»»åŠ¡çš„æµç¨‹æŽ§åˆ¶å·¥å…·ã€‚åç¨‹é€šè¿‡ yield æŠŠæŽ§åˆ¶å™¨è®©æ­¥ç»™ä¸­å¿ƒè°ƒåº¦ç¨‹åºï¼Œå†ç”±è°ƒåº¦ç¨‹åºæ¿€æ´»å…¶ä»–åç¨‹ã€‚ ä¸€ã€ç”¨ä½œåç¨‹çš„ç”Ÿæˆå™¨ä¸€ä¸ªæœ€ç®€å•çš„åç¨‹å®žçŽ°ä»£ç å¦‚ä¸‹ï¼š12345# coroutine.pydef simple_coroutine(): print('-&gt; coroutine started') x = yield print('-&gt; coroutine received: ', x) åœ¨ Python Shell ä¸­è¿›è¡Œæµ‹è¯•ï¼Œç»“æžœå¦‚ä¸‹ï¼š123456789101112&gt;&gt;&gt; from coroutine import simple_coroutine&gt;&gt;&gt; my_coro = simple_coroutine()&gt;&gt;&gt; my_coro&lt;generator object simple_coroutine at 0x00000000021B4DC8&gt;&gt;&gt;&gt; next(my_coro)-&gt; coroutine started&gt;&gt;&gt; my_coro.send(42)-&gt; coroutine received: 42Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration&gt;&gt;&gt; ä¸Šè¿°ä»£ç çš„æ‰§è¡Œæµç¨‹ä¸ºï¼š ä¸»å‡½æ•°è°ƒç”¨ next() å‡½æ•°å¯åŠ¨ç”Ÿæˆå™¨ã€‚ç”Ÿæˆå™¨åœ¨ yield è¯­å¥å¤„æš‚åœï¼Œæ²¡æœ‰äº§å‡ºå€¼ï¼ˆNoneï¼‰ my_coro.send(42) å‘åç¨‹å‘é€æ•°æ® 42ï¼Œåç¨‹æ¢å¤è¿è¡Œï¼ŒæŠ›å‡º StopIteration å¼‚å¸¸ åç¨‹çš„çŠ¶æ€å¯ä»¥ä½¿ç”¨ inspect.getgeneratorstate èŽ·å–åç¨‹çš„è¿è¡ŒçŠ¶æ€ï¼Œå…±åŒ…å«ä»¥ä¸‹å››ç§ï¼š GEN_CREATEDï¼šç­‰å¾…å¼€å§‹æ‰§è¡Œ GEN_RUNNINGï¼šåç¨‹æ­£åœ¨æ‰§è¡Œ GEN_SUSPENDEDï¼šåœ¨ yield è¡¨è¾¾å¼å¤„æš‚åœ GEN_CLOSEï¼šåç¨‹æ‰§è¡Œç»“æŸ å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š123456def simple_coro2(a): print('-&gt; Started: a=', a) b = yield a print('-&gt; Received: b=', b) c = yield a + b print('-&gt; Received: c=', c) 1234567891011121314151617181920&gt;&gt;&gt; my_coro2 = simple_coro2(14)&gt;&gt;&gt; from inspect import getgeneratorstate&gt;&gt;&gt; getgeneratorstate(my_coro2)'GEN_CREATED'&gt;&gt;&gt; next(my_coro2)-&gt; Started: a= 1414&gt;&gt;&gt; getgeneratorstate(my_coro2)'GEN_SUSPENDED'&gt;&gt;&gt; my_coro2.send(28)-&gt; Received: b= 2842&gt;&gt;&gt; my_coro2.send(99)-&gt; Received: c= 99Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration&gt;&gt;&gt; getgeneratorstate(my_coro2)'GEN_CLOSED'&gt;&gt;&gt; åç¨‹ simple_coro2 çš„æ‰§è¡Œæµç¨‹åˆ†ä¸ºå¦‚ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š è°ƒç”¨ next(my_coro2)ï¼Œåç¨‹å¯åŠ¨ï¼Œæ‰“å°æ¶ˆæ¯ Started: a= 14ï¼Œæ‰§è¡Œ yield aï¼Œäº§å‡ºæ•°å­— 14 è°ƒç”¨ my_coro2.send(28)ï¼ŒæŠŠ 28 èµ‹å€¼ç»™ bï¼Œæ‰“å° Received: b= 28ï¼Œæ‰§è¡Œ yield a + bï¼Œäº§å‡ºæ•°å­— 42 è°ƒç”¨ my_coro2.send(99)ï¼ŒæŠŠ 99 èµ‹å€¼ç»™ cï¼Œæ‰“å° Received: c= 99ï¼Œåç¨‹ç»ˆæ­¢ å‚è€ƒå¦‚ä¸‹ç¤ºæ„å›¾ï¼š äºŒã€ä½¿ç”¨åç¨‹è®¡ç®—ç§»åŠ¨å¹³å‡å€¼12345678910# coroaverager.pydef averager(): total = 0.0 count = 0 average = None while True: term = yield average total += term count += 1 average = total/count åœ¨ Python Shell ä¸­è¿›è¡Œæµ‹è¯•ï¼š12345678910&gt;&gt;&gt; from coroaverager import averager&gt;&gt;&gt; coro_avg = averager()&gt;&gt;&gt; next(coro_avg)&gt;&gt;&gt; coro_avg.send(10)10.0&gt;&gt;&gt; coro_avg.send(30)20.0&gt;&gt;&gt; coro_avg.send(5)15.0&gt;&gt;&gt; ä»Žæ‰§è¡Œç»“æžœçœ‹ï¼Œåªè¦è°ƒç”¨æ–¹ä¸æ–­æŠŠæ•°æ®å‘é€ç»™åç¨‹ averager()ï¼Œåç¨‹å°±ä¼šä¸€ç›´æŽ¥æ”¶å€¼å¹¶è¿”å›žå¹³å‡å€¼çš„è®¡ç®—ç»“æžœã€‚å…¶ä¸­ yield è¡¨è¾¾å¼ç”¨äºŽæš‚åœåç¨‹çš„æ‰§è¡Œï¼Œè¿”å›žè®¡ç®—ç»“æžœç»™è°ƒç”¨æ–¹ï¼ŒåŒæ—¶ç­‰å¾…è°ƒç”¨æ–¹ç»§ç»­å‘é€æ•°æ®ç»™åç¨‹ä»¥æ¢å¤å¾ªçŽ¯ã€‚ ä½¿ç”¨è£…é¥°å™¨é¢„æ¿€åç¨‹ä½¿ç”¨åç¨‹ä¹‹å‰å¿…é¡»é¢„æ¿€ï¼ˆå³é€šè¿‡ next() è°ƒç”¨å¯åŠ¨åç¨‹ï¼‰ï¼Œå¯ä»¥åˆ›å»ºå¦‚ä¸‹çš„ç”¨äºŽé¢„æ¿€åç¨‹çš„è£…é¥°å™¨ï¼š12345678910# coroutil.pyfrom functools import wrapsdef coroutine(func): @wraps(func) def primer(*args, **kwargs): gen = func(*args, **kwargs) next(gen) return gen return primer æ­¤æ—¶ coroaverager.py åˆ™å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š123456789101112from coroutil import coroutine@coroutinedef averager(): total = 0.0 count = 0 average = None while True: term = yield average total += term count += 1 average = total/count 123456789&gt;&gt;&gt; from coroaverager import averager&gt;&gt;&gt; coro_avg = averager()&gt;&gt;&gt; coro_avg.send(10)10.0&gt;&gt;&gt; coro_avg.send(20)15.0&gt;&gt;&gt; coro_avg.send(15)15.0&gt;&gt;&gt; ä¸‰ã€åç¨‹è¿”å›žå€¼1234567891011121314151617# coroaverager2.pyfrom collections import namedtupleResult = namedtuple('Result', 'count average')def averager(): total = 0.0 count = 0 average = None while True: term = yield if term is None: break total += term count += 1 average = total/count return Result(count, average) 1234567891011&gt;&gt;&gt; from coroaverager2 import averager&gt;&gt;&gt; coro_avg = averager()&gt;&gt;&gt; next(coro_avg)&gt;&gt;&gt; coro_avg.send(10)&gt;&gt;&gt; coro_avg.send(20)&gt;&gt;&gt; coro_avg.send(15)&gt;&gt;&gt; coro_avg.send(None)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration: Result(count=3, average=15.0)&gt;&gt;&gt; æ­¤å¤„çš„ yield è¡¨è¾¾å¼åªæŽ¥æ”¶æ•°æ®è€Œä¸è¿”å›žä»»ä½•ç»“æžœï¼Œç›´åˆ°åç¨‹æ”¶åˆ° Noneï¼Œå¾ªçŽ¯ç»ˆæ­¢åç¨‹ç»“æŸï¼Œè¿”å›žæœ€ç»ˆç»“æžœ Result(...)ã€‚return è¡¨è¾¾å¼è¿”å›žçš„å€¼ä¼šä¼ é€’ç»™è°ƒç”¨æ–¹ï¼Œèµ‹å€¼ç»™ StopIteration å¼‚å¸¸çš„ä¸€ä¸ªå±žæ€§ã€‚å› æ­¤æœ€ç»ˆç»“æžœéœ€è¦é€šè¿‡ try...except è¯­å¥æ¥æ•èŽ·ã€‚å¥½åœ¨ yield from ç»“æž„ä¼šåœ¨å†…éƒ¨è‡ªåŠ¨æ•èŽ· StopIteration å¼‚å¸¸ï¼Œå¹¶æŠŠ value å±žæ€§çš„å€¼å˜æˆ yield from è¡¨è¾¾å¼çš„å€¼ã€‚ å››ã€yield fromyield from å¯ä»¥ç”¨æ¥ç®€åŒ– for å¾ªçŽ¯ä¸­çš„ yield è¡¨è¾¾å¼ã€‚12345678910111213141516def gen(): for c in 'AB': yield c for i in range(1, 3): yield iprint(list(gen()))# =&gt; ['A', 'B', 1, 2]def gen2(): yield from 'AB' yield from range(1, 3)print(list(gen2()))# =&gt; ['A', 'B', 1, 2] yield from è¡¨ç¤ºçš„å«ä¹‰ä¸ºï¼Œåœ¨ç”Ÿæˆå™¨ gen ä¸­ä½¿ç”¨ yield from subgen() æ—¶ï¼Œsubgen ä¼šèŽ·å¾—æŽ§åˆ¶æƒï¼Œå…¶äº§å‡ºçš„å€¼ä¼ é€’ç»™ gen çš„è°ƒç”¨æ–¹ã€‚åŒæ—¶ gen ä¼šé˜»å¡žï¼Œç­‰å¾… subgen ç»ˆæ­¢ã€‚ ä½¿ç”¨ yield from å¯ä»¥è¿žæŽ¥å¤šä¸ªå¯è¿­ä»£å¯¹è±¡ï¼š123456789def chain(*iterables): for it in iterables: yield from its = 'ABC't = tuple(range(3))print(list(chain(s, t)))# =&gt; ['A', 'B', 'C', 0, 1, 2] yield from çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰“å¼€åŒå‘é€šé“ï¼ŒæŠŠæœ€å¤–å±‚çš„è°ƒç”¨æ–¹ä¸Žæœ€å†…å±‚çš„å­ç”Ÿæˆå™¨è¿žæŽ¥èµ·æ¥ï¼Œä½¿å¾—ä¸¤è€…å¯ä»¥ç›´æŽ¥å‘é€å’Œäº§å‡ºå€¼ï¼Œè€Œä¸å¿…åœ¨ä½äºŽä¸­é—´çš„åç¨‹ä¸­æ·»åŠ å¤§é‡å¤„ç†å¼‚å¸¸ï¼ˆStopIterationï¼‰çš„ä»£ç ã€‚ ä½¿ç”¨ yield from è®¡ç®—ç§»åŠ¨å¹³å‡å€¼ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566from collections import namedtupleResult = namedtuple('Result', 'count average')# the subgeneratordef averager(): # &lt;1&gt; total = 0.0 count = 0 average = None while True: term = yield # &lt;2&gt; if term is None: # &lt;3&gt; break total += term count += 1 average = total/count return Result(count, average) # &lt;4&gt;# the delegating generatordef grouper(results, key): # &lt;5&gt; while True: # &lt;6&gt; results[key] = yield from averager() # &lt;7&gt;# the client code, a.k.a. the callerdef main(data): # &lt;8&gt; results = &#123;&#125; for key, values in data.items(): group = grouper(results, key) next(group) # &lt;9&gt; for value in values: group.send(value) # &lt;10&gt; group.send(None) # &lt;11&gt; report(results)# output reportdef report(results): for key, result in sorted(results.items()): group, unit = key.split(';') print('&#123;:2&#125; &#123;:5&#125; averaging &#123;:.2f&#125;&#123;&#125;'.format( result.count, group, result.average, unit))data = &#123; 'girls;kg': [40.9, 38.5, 44.3, 42.2, 45.2, 41.7, 44.5, 38.0, 40.6, 44.5], 'girls;m': [1.6, 1.51, 1.4, 1.3, 1.41, 1.39, 1.33, 1.46, 1.45, 1.43], 'boys;kg': [39.0, 40.8, 43.2, 40.8, 43.1, 38.6, 41.4, 40.6, 36.3], 'boys;m': [1.38, 1.5, 1.32, 1.25, 1.37, 1.48, 1.25, 1.49, 1.46],&#125;if __name__ == '__main__': main(data)# =&gt; 9 boys averaging 40.42kg# =&gt; 9 boys averaging 1.39m# =&gt; 10 girls averaging 42.04kg# =&gt; 10 girls averaging 1.43m æ³¨é‡Šï¼š ï¼šaverager åç¨‹ä½œä¸ºè¢«è°ƒç”¨çš„å­ç”Ÿæˆå™¨ï¼Œè®¡ç®—ç§»åŠ¨å¹³å‡å€¼ ï¼šè°ƒç”¨æ–¹å‡½æ•° main å‘é€çš„å€¼éƒ½ä¼šç»‘å®šç»™ term å˜é‡ ï¼šç»ˆæ­¢æ¡ä»¶ï¼Œè‹¥æ— æ­¤å¥ä»£ç ï¼Œå­ç”Ÿæˆå™¨æ°¸ä¸ç»ˆæ­¢ï¼Œyield from ä¹Ÿä¼šä¸€ç›´é˜»å¡ž ï¼šè¿”å›žçš„ Result å¯¹è±¡å°†ä½œä¸º grouper å‡½æ•°ä¸­ yield from è¡¨è¾¾å¼çš„å€¼ ï¼šgrouper å‡½æ•°ä½œä¸ºå§”æ´¾ç”Ÿæˆå™¨ï¼Œç›¸å½“äºŽå­ç”Ÿæˆå™¨å’Œè°ƒç”¨æ–¹ä¹‹é—´çš„â€œç®¡é“â€ ï¼šè¿™é‡Œ while å¾ªçŽ¯çš„æ¯æ¬¡éåŽ†éƒ½ä¼šåˆ›å»ºä¸€ä¸ª averager åç¨‹å®žä¾‹ ï¼šgrouper é€šè¿‡ .send å‘é€çš„æ¯ä¸€ä¸ªå€¼éƒ½ä¼šè¢« yield from å¯¼å‘ç»™ averager å®žä¾‹ï¼Œå¾… averager å¤„ç†å®Œæ‰€æœ‰ grouper å‘é€çš„å€¼ä¹‹åŽï¼Œæœ€ç»ˆçš„è®¡ç®—ç»“æžœç»‘å®šç»™ results[key]ã€‚while å¾ªçŽ¯åˆ™ç»§ç»­åˆ›å»ºå¦ä¸€ä¸ª averager å®žä¾‹ç”¨æ¥å¤„ç†æ›´å¤šçš„å€¼ ï¼šmain å³å®¢æˆ·ç«¯ä»£ç ï¼Œå­ç”Ÿæˆå™¨çš„è°ƒç”¨æ–¹ ï¼šé¢„æ¿€åç¨‹å¯¹è±¡ ï¼šå‘é€æ•°æ®ç»™ grouperï¼Œè¯¥æ•°æ®å®žé™…ä¸Šå¯¹ grouper å¹¶ä¸å¯è§ï¼Œè€Œæ˜¯é€šè¿‡ yield from ä¼ é€’ç»™äº† averager ä¸­çš„ term = yieldã€‚ æˆ‘è¦åäº†ã€‚å†è§å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Concurrency</tag>
        <tag>Performance</tag>
        <tag>Coroutine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python é€šè¿‡ concurrent.futures æ¨¡å—ä»¥å¼‚æ­¥æ–¹å¼å¤„ç†å¹¶å‘éœ€æ±‚]]></title>
    <url>%2F2019%2F10%2F30%2Fpython-concurrent-futures-async-programming%2F</url>
    <content type="text"><![CDATA[å¯¹äºŽè®¡ç®—æœºç¨‹åºçš„æ‰§è¡Œæµè€Œè¨€ï¼ŒI/O æ“ä½œé€šå¸¸æ˜¯æ—¶é—´å æ¯”éžå¸¸å¤§çš„ä¸€å—ã€‚åœ¨å½“å‰çš„ç¡¬ä»¶è®¾å¤‡ä¸­ï¼Œç»å¤§å¤šæ•° I/O æ“ä½œè¦æ¯” CPU æ…¢ä¸Šå‡ ä¸ªæ•°é‡çº§ã€‚æ¯”å¦‚å¤§çº¦èŠ±è´¹ 1 æ¯«ç§’å†™å…¥ä¸€ä¸ªç½‘ç»œ socketï¼Œå¯¹åº”åˆ° 2.4GHz çš„å¤„ç†å™¨ä¸Šï¼ŒåŒæ ·çš„æ—¶é—´åˆ™å¯ä»¥æ‰§è¡Œ 24000000 æ¡æŒ‡ä»¤ã€‚ åœ¨ä¸€èˆ¬çš„åŒæ­¥æ‰§è¡Œçš„ç¨‹åºä¸­ï¼Œå½“ä»£ç é‡åˆ° I/O æ“ä½œæ—¶ï¼ˆå¦‚è¯»å–ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å†™å…¥ä¸€ä¸ªç½‘ç»œ socketï¼‰ï¼Œå¿…é¡»æš‚æ—¶ä¸­æ­¢å’Œå†…æ ¸çš„äº¤äº’ï¼ŒåŽ»è¯·æ±‚ I/O å¹¶ç­‰å¾…ä¼ è¾“å®Œæˆã€‚è¿™ç§å›  I/O é˜»å¡žè€Œäº§ç”Ÿçš„ç­‰å¾…åœ¨æŸäº›æƒ…å†µä¸‹å¾€å¾€å¯¼è‡´æ‰§è¡Œæ•ˆçŽ‡çš„ä½Žä¸‹å’Œå“åº”çš„å»¶è¿Ÿã€‚ è€Œåœ¨å¼‚æ­¥æ‰§è¡Œçš„æµç¨‹ä¸­ï¼Œå½“ä¸€ä¸ªç¨‹åºè¿›å…¥ I/O ç­‰å¾…æ—¶ï¼Œå…¶æŽ§åˆ¶æƒä¼šè¢«ç§»äº¤ç»™ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ï¼Œç›´åˆ° I/O æ“ä½œå®Œæˆæ—¶æ‰å¯ä»¥é‡æ–°èŽ·å–ï¼ˆè¿™ç§°ä¸ºä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰ã€‚å¼‚æ­¥ç¨‹åºä¸­ä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ç”¨æ¥ç›‘å¬äº‹ä»¶å¹¶åˆ†æ´¾ä»»åŠ¡ã€‚æ¯”å¦‚ç”¨ä¸€ä¸ªå¼‚æ­¥ç¨‹åºåšä¸€æ¬¡ç½‘ç»œå†™æ“ä½œï¼Œè¯¥è¯·æ±‚ä¼šç«‹å³è¿”å›žï¼ˆç¨‹åºæŽ§åˆ¶æƒç§»äº¤ç»™äº‹ä»¶å¾ªçŽ¯ï¼‰ï¼Œå³ä¾¿å†™æ“ä½œå®žé™…ä¸Šå¹¶æœªå‘ç”Ÿã€‚æ­¤æ—¶ç¨‹åºå…è®¸æ‰§è¡Œå¦å¤–çš„å‡½æ•°å’Œè¿ç®—ã€‚å½“å†™æ“ä½œå®Œæˆæ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶ï¼Œç”±äº‹ä»¶å¾ªçŽ¯å“åº”è¯¥äº‹ä»¶å¹¶æ‰§è¡Œå…³è”çš„æ“ä½œã€‚ åŒæ­¥ç¨‹åºä¸‹è½½ç½‘ç»œèµ„æºä»¥ä¸‹ä»£ç ä¸ºä½¿ç”¨åŒæ­¥çš„æ–¹å¼ä¸‹è½½ç½‘ç»œä¸­å­˜æ”¾çš„å¤šå¼ å›½æ——å›¾ç‰‡ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# flags.pyimport osimport timeimport sysimport requestsPOP20_CC = ('CN IN US ID BR PK NG BD RU JP ' 'MX PH VN ET EG DE IR TR CD FR').split()BASE_URL = 'http://flupy.org/data/flags'DEST_DIR = 'downloads/'def save_flag(img, filename): if not os.path.exists(DEST_DIR): os.makedirs(DEST_DIR) path = os.path.join(DEST_DIR, filename) with open(path, 'wb') as fp: fp.write(img)def get_flag(cc): url = '&#123;&#125;/&#123;cc&#125;/&#123;cc&#125;.gif'.format(BASE_URL, cc=cc.lower()) resp = requests.get(url) return resp.contentdef show(text): print(text, end=' ') sys.stdout.flush()def download_many(cc_list): for cc in sorted(cc_list): image = get_flag(cc) show(cc) save_flag(image, cc.lower() + '.gif') return len(cc_list)def main(download_many): t0 = time.time() count = download_many(POP20_CC) elapsed = time.time() - t0 msg = '\n&#123;&#125; flags downloaded in &#123;:.2f&#125;s' print(msg.format(count, elapsed))if __name__ == '__main__': main(download_many)# =&gt; BD BR CD CN DE EG ET FR ID IN IR JP MX NG PH PK RU TR US VN# =&gt; 20 flags downloaded in 218.70s ä½¿ç”¨ concurrent.futures æ¨¡å—ä¸‹è½½concurrent.futures æ¨¡å—çš„ä¸»è¦ç‰¹è‰²æ˜¯åŒ…å« ThreadPoolExecutor å’Œ ProcessPoolExecutor ä¸¤ä¸ªç±»ï¼Œå®ƒä»¬å®žçŽ°çš„æŽ¥å£å¯ä»¥åˆ†åˆ«åœ¨ä¸åŒçš„çº¿ç¨‹æˆ–è¿›ç¨‹ä¸­æ‰§è¡Œå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒä»¬å†…éƒ¨éƒ½ç»´æŠ¤ç€ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼ˆæˆ–è¿›ç¨‹ï¼‰æ± å’Œä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ã€‚ ä¸‹è½½ä»£ç å¦‚ä¸‹ï¼ˆå¼•ç”¨äº†ä¸Šä¸€ä¸ªæºæ–‡ä»¶ flags.py ä¸­çš„å‡ ä¸ªåŠŸèƒ½å‡½æ•°ï¼‰ï¼š12345678910111213141516171819202122232425from concurrent import futuresfrom flags import save_flag, get_flag, show, mainMAX_WORKERS = 20def download_one(cc): image = get_flag(cc) show(cc) save_flag(image, cc.lower() + '.gif') return ccdef download_many(cc_list): workers = min(MAX_WORKERS, len(cc_list)) with futures.ThreadPoolExecutor(workers) as executor: res = executor.map(download_one, sorted(cc_list)) return len(list(res))if __name__ == "__main__": main(download_many)# =&gt; EG BD NG CD IN ET RU ID CN FR US PK PH MX IR VN BR JP DE TR# =&gt; 20 flags downloaded in 83.36s å…¶ä¸­æœ€å…³é”®çš„éƒ¨åˆ†ä¸º download_many å‡½æ•°ã€‚workers å˜é‡ç”¨äºŽæŒ‡å®š ThreadPoolExecutor å¯¹è±¡ä½¿ç”¨çš„å·¥ä½œçº¿ç¨‹çš„æ•°é‡ï¼Œå–é¢„è®¾çš„æœ€å¤§çº¿ç¨‹æ•°ï¼ˆMAX_WORKERSï¼‰å’Œå®žé™…ä¸‹è½½æ•°ç›®ï¼ˆlen(cc_list)ï¼‰ä¸­çš„è¾ƒå°çš„å€¼ï¼›with è¯­å¥ç”¨äºŽä½¿ç”¨æŒ‡å®šæ•°é‡ï¼ˆworkersï¼‰çš„å·¥ä½œçº¿ç¨‹åˆå§‹åŒ– ThreadPoolExecutor å¯¹è±¡ï¼›map æ–¹æ³•ç±»ä¼¼äºŽå†…ç½®çš„ map å‡½æ•°ï¼Œç›®çš„æ˜¯ä½¿ download_one å‡½æ•°å¯ä»¥è¢«å¤šä¸ªå·¥ä½œçº¿ç¨‹å¹¶è¡Œåœ°è°ƒç”¨ã€‚å®ƒä¼šè¿”å›žä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œè¯¥ç”Ÿæˆå™¨å¯ä»¥è¢«éåŽ†ä»¥èŽ·å–æ¯ä¸€ä¸ª download_one æ‰§è¡ŒåŽçš„ç»“æžœã€‚ Future å¯¹è±¡Python æ ‡å‡†åº“ä¸­åŒ…å«ä¸¤ä¸ªåä¸º Future çš„ç±»ï¼šconcurrent.futures.Future å’Œ asyncio.Future ã€‚è¿™ä¸¤ä¸ªç±»çš„å®žä¾‹éƒ½è¡¨ç¤ºå¯èƒ½å·²ç»å®Œæˆæˆ–è€…å°šæœªå®Œæˆçš„å»¶è¿Ÿè®¡ç®—ã€‚Future å¯¹è±¡å¹¶ä¸æ˜¯ä¸€ä¸ªç«‹å³äº§ç”Ÿçš„å®žé™…ç»“æžœï¼Œæ›´åƒæ˜¯ä¸€ç§â€œæ‰¿è¯ºâ€ï¼Œéœ€è¦ç­‰å¾…å…¶æ‰§è¡Œå®Œæ¯•å¹¶è¢«æˆ‘ä»¬æœŸå¾…çš„å€¼æ‰€å¡«å……ã€‚åœ¨ç­‰å¾…â€œæ‰¿è¯ºâ€å…‘çŽ°çš„è¿‡ç¨‹ä¸­ç¨‹åºå¯ä»¥åŒæ—¶æ‰§è¡Œå…¶ä»–è¿ç®—ã€‚ Future æ˜¯ concurrent.futures æ¨¡å—å’Œ asyncio åº“çš„é‡è¦ç»„ä»¶ï¼Œä½†æ˜¯åœ¨ä¸Šé¢çš„ä»£ç ä¸­å¹¶æ²¡æœ‰ç›´æŽ¥è°ƒç”¨ Future å¯¹è±¡ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒFuture ä¸åº”è¯¥ç”±ç”¨æˆ·æ˜¾å¼åœ°åˆ›å»ºï¼Œè€Œåªèƒ½ç”±å¹¶å‘æ¡†æž¶å®žä¾‹åŒ–ã€‚Future å¦‚åŒå®ƒçš„åå­—ä¸€æ ·ï¼Œä»£è¡¨å°†è¦å‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œç¡®å®šæŸä»¶äº‹æœªæ¥ä¼šå‘ç”Ÿçš„å”¯ä¸€æ–¹å¼æ˜¯å…¶æ‰§è¡Œæ—¶é—´å·²ç»æŽ’å®šã€‚Executor.submit() æ–¹æ³•ä¼šæŽ¥æ”¶ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½œä¸ºå‚æ•°å¹¶ä¸ºå…¶æŽ’æœŸï¼Œè¿”å›žä¸€ä¸ª Future å¯¹è±¡ã€‚ ç”¨æˆ·ä»£ç ä¹Ÿä¸åº”è¯¥æ”¹å˜ Future å¯¹è±¡çš„çŠ¶æ€ã€‚å¹¶å‘æ¡†æž¶ä¼šåœ¨ Future ä»£è¡¨çš„å»¶è¿Ÿè®¡ç®—ç»“æŸåŽè‡ªåŠ¨æ”¹å˜ Future çš„çŠ¶æ€ï¼Œæ²¡æœ‰åŠžæ³•äººä¸ºåœ°æŽ§åˆ¶å»¶è¿Ÿè®¡ç®—ä½•æ—¶ç»“æŸã€‚Future å…·æœ‰éžé˜»å¡žçš„ .done() æ–¹æ³•ï¼Œè¿”å›žå¸ƒå°”å€¼è¡¨æ˜Ž Future å¯¹åº”çš„è°ƒç”¨å¯¹è±¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚æ­¤å¤–è¿˜æœ‰ .add_done_callback() æ–¹æ³•ç”¨äºŽåœ¨ Future è¿è¡Œç»“æŸåŽæ‰§è¡Œç‰¹å®šçš„å›žè°ƒå‡½æ•°ã€‚concurrency.futures.Future å®žä¾‹è¿˜æœ‰ .results() æ–¹æ³•ç”¨ä»¥èŽ·å– Future æ‰§è¡Œçš„å¯è°ƒç”¨å¯¹è±¡çš„ç»“æžœã€‚è¯¥æ–¹æ³•ä¼šé˜»å¡žè°ƒç”¨æ–¹æ‰€åœ¨çš„çº¿ç¨‹ï¼Œç›´åˆ°å¯è°ƒç”¨å¯¹è±¡è¿è¡Œç»“æŸå¹¶è¿”å›žç»“æžœã€‚result() æ–¹æ³•å¯ä»¥æŽ¥æ”¶å¯é€‰çš„ timeout å‚æ•°ç”¨äºŽè®¾å®šè¶…æ—¶æ—¶é—´ã€‚ ä»Žæ›´çŽ°å®žçš„è§’åº¦ç†è§£ Future å¯¹è±¡ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334from concurrent import futuresfrom flags import save_flag, get_flag, show, mainimport timeMAX_WORKERS = 20def download_one(cc): image = get_flag(cc) show(cc) save_flag(image, cc.lower() + '.gif') return ccdef download_many(cc_list): cc_list = cc_list[:5] with futures.ThreadPoolExecutor(max_workers=3) as executor: to_do = [] for cc in sorted(cc_list): future = executor.submit(download_one, cc) to_do.append(future) msg = 'Scheduled for &#123;&#125;: &#123;&#125;' print(msg.format(cc, future)) results = [] for future in futures.as_completed(to_do): res = future.result() msg = '&#123;&#125; result: &#123;!r&#125;' print(msg.format(future, res)) results.append(res) return len(results)if __name__ == '__main__': main(download_many) æ­¤å¤„çš„ä»£ç åªé€šè¿‡ 3 ä¸ªå·¥ä½œçº¿ç¨‹èŽ·å– 5 ä¸ªå›½å®¶çš„å›½æ——å›¾ç‰‡ã€‚å’Œä¹‹å‰çš„ä»£ç ç›¸æ¯”ï¼Œå°† download_many å‡½æ•°ä¸­è¾ƒæŠ½è±¡çš„ executor.map æ›¿æ¢æˆäº†ä¸¤ä¸ª for å¾ªçŽ¯ï¼š executor.submit ç”¨äºŽæŽ’å®šå¯è°ƒç”¨å¯¹è±¡ï¼ˆå³ download_one(cc)ï¼‰ç»™å¤šä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œï¼Œè¿”å›žä¸€ä¸ª Future å¯¹è±¡è¡¨ç¤ºè¿™ä¸ªå¾…æ‰§è¡Œçš„æ“ä½œã€‚ futures.as_completed åˆ™ç”¨äºŽåœ¨ Future è¿è¡Œç»“æŸåŽèŽ·å–å¯æ‰§è¡Œå¯¹è±¡ï¼ˆå³ download_one(cc)ï¼‰è¿”å›žçš„ç»“æžœã€‚ æœ¬ä¾‹ä¸­çš„ future.result() æ–¹æ³•ç»ä¸ä¼šé˜»å¡žï¼Œå› ä¸º future æ˜¯ç”± as_completed å‡½æ•°è¿”å›žçš„ã€‚ æœ€ç»ˆè¾“å‡ºå¦‚ä¸‹ï¼š123456789101112Scheduled for BR: &lt;Future at 0x4524a48 state=running&gt;Scheduled for CN: &lt;Future at 0x3ca46c8 state=running&gt;Scheduled for ID: &lt;Future at 0x453f7c8 state=running&gt;Scheduled for IN: &lt;Future at 0x2ab1308 state=pending&gt;Scheduled for US: &lt;Future at 0x4530888 state=pending&gt;ID BR CN &lt;Future at 0x453f7c8 state=finished returned str&gt; result: &apos;ID&apos;&lt;Future at 0x3ca46c8 state=finished returned str&gt; result: &apos;CN&apos;&lt;Future at 0x4524a48 state=finished returned str&gt; result: &apos;BR&apos;IN &lt;Future at 0x2ab1308 state=finished returned str&gt; result: &apos;IN&apos;US &lt;Future at 0x4530888 state=finished returned str&gt; result: &apos;US&apos;5 flags downloaded in 1.57s ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œå‰ä¸‰ä¸ª Future çš„çŠ¶æ€æ˜¯ runningï¼ŒåŽä¸¤ä¸ª Future çš„çŠ¶æ€æ˜¯ pendingï¼Œå› ä¸ºåªæœ‰ä¸‰ä¸ªå·¥ä½œçº¿ç¨‹å¯ä¾›åˆ†é…ã€‚åŒæ—¶ï¼Œå¦‚æžœå¤šè¿è¡Œå‡ æ¬¡ï¼Œè¾“å‡ºç»“æžœçš„é¡ºåºä¹Ÿæ˜¯æœ‰å˜åŒ–çš„ã€‚ å…³äºŽ GILCython è§£é‡Šå™¨ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒé€šè¿‡ GILï¼ˆGlobal Interpreter Lockï¼Œå…¨å±€è§£é‡Šå™¨é”ï¼‰å¼ºåˆ¶æ€§åœ°ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ Python ä»£ç ã€‚æ‰€ä»¥é€šå¸¸ä¸€ä¸ª Python è¿›ç¨‹å¹¶ä¸èƒ½åŒæ—¶ä½¿ç”¨å¤šä¸ª CPU æ ¸å¿ƒï¼Œå³ä¸èƒ½å¤Ÿå°†ä¸€ä¸ª Python è¿›ç¨‹æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹æ‰§è¡Œçš„çº¿ç¨‹åœ¨å¤šä¸ª CPU æ ¸å¿ƒä¸Šä»¥å¹¶è¡Œçš„æ–¹å¼è¿è¡Œã€‚ä½†æ˜¯ Python æ ‡å‡†åº“ä¸­æ‰€æœ‰æ‰§è¡Œé˜»å¡žåž‹ I/O æ“ä½œçš„å‡½æ•°ï¼Œåœ¨ç­‰å¾…ç³»ç»Ÿè¿”å›žç»“æžœæ—¶éƒ½ä¼šé‡Šæ”¾ GILã€‚å³åœ¨ I/O å¯†é›†åž‹çš„éœ€æ±‚åœºæ™¯ä¸‹ï¼ŒPython ç¨‹åºå¯ä»¥é€šè¿‡å¤šçº¿ç¨‹æ¥æå‡æ€§èƒ½ã€‚ å‚è€ƒèµ„æ–™Fluent Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Concurrency</tag>
        <tag>Performance</tag>
        <tag>Async</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Cookbook â€”â€” æ•°æ®ç»“æž„æŠ€å·§]]></title>
    <url>%2F2019%2F10%2F27%2Fpython-cookbook-data-structure-tricks%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åºåˆ—å±•å¼€ä¸Žå¤šé‡èµ‹å€¼ä»»ä½•æ•°æ®åºåˆ—ï¼ˆæˆ–å¯è¿­ä»£å¯¹è±¡ï¼‰éƒ½å¯ä»¥åªé€šè¿‡ä¸€ä¸ªèµ‹å€¼æ“ä½œå±•å¼€è‡ªèº«å¹¶åŒæ—¶èµ‹å€¼ç»™å¤šä¸ªå˜é‡ã€‚åªéœ€è¦ç¡®ä¿è¢«èµ‹å€¼çš„å˜é‡çš„æ•°ç›®å’Œç»“æž„ä¸Žåºåˆ—ç›¸ç¬¦åˆå³å¯ã€‚å¦‚ï¼š123456&gt;&gt;&gt; p = (4, 5)&gt;&gt;&gt; x, y = p&gt;&gt;&gt; x4&gt;&gt;&gt; y5 å¯¹äºŽåµŒå¥—çš„å¤šå±‚æ¬¡åºåˆ—ï¼Œæ­¤ç§æ–¹å¼çš„å¤šé‡èµ‹å€¼ä»ç„¶é€‚ç”¨ï¼š123456789101112131415&gt;&gt;&gt; data = [ 'ACME', 50, 91.1, (2012, 12, 21) ]&gt;&gt;&gt; name, shares, price, date = data&gt;&gt;&gt; name'ACME'&gt;&gt;&gt; date(2012, 12, 21)&gt;&gt;&gt; name, shares, price, (year, mon, day) = data&gt;&gt;&gt; name'ACME'&gt;&gt;&gt; year2012&gt;&gt;&gt; mon12&gt;&gt;&gt; day21 åºåˆ—å±•å¼€åŒæ ·é€‚ç”¨äºŽä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼ˆå³å†…éƒ¨å®žçŽ°äº† __iter__ æ–¹æ³•çš„å¯¹è±¡ï¼Œå¦‚å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š12345678&gt;&gt;&gt; s = 'Hello'&gt;&gt;&gt; a, b, c, d, e = s&gt;&gt;&gt; a'H'&gt;&gt;&gt; b'e'&gt;&gt;&gt; e'o' å¿½ç•¥ç‰¹å®šçš„å€¼åœ¨åºåˆ—å±•å¼€å¹¶èµ‹å€¼æ—¶ï¼Œå¯ä»¥å¿½ç•¥æŒ‡å®šé¡¹ç›®ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š123456&gt;&gt;&gt; data = [ 'ACME', 50, 91.1, (2012, 12, 21) ]&gt;&gt;&gt; _, shares, price, _ = data&gt;&gt;&gt; shares50&gt;&gt;&gt; price91.1 å±•å¼€ä¸ºå›ºå®šé•¿åº¦åœ¨åºåˆ—å±•å¼€å¹¶èµ‹å€¼æ—¶ï¼Œè¢«èµ‹å€¼çš„å˜é‡æ•°ç›®å’Œç»“æž„å¦‚æžœä¸Žåºåˆ—æœ¬èº«ä¸ç¬¦åˆï¼Œåˆ™ä¼šæŠ¥å‡º ValueError ï¼š12345&gt;&gt;&gt; p = (4, 5, 6)&gt;&gt;&gt; x, y = pTraceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;ValueError: too many values to unpack (expected 2) å¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå½“å±•å¼€çš„åºåˆ—é•¿åº¦å¤§äºŽæœŸæœ›çš„å˜é‡æ•°ç›®æ—¶ï¼Œå¯ä»¥å¯¹å˜é‡ä½¿ç”¨ * æ“ä½œç¬¦å°†å¤šä¸ªé¡¹ç›®ä¿å­˜åœ¨åˆ—è¡¨ç»“æž„ä¸­ï¼Œå¦‚ï¼š123456789def drop_first_last(grades): first, *middle, last = sorted(grades) return sum(middle) / len(middle)grades = [ 100, 94, 96, 88, 70, 62, 80 ]print(f"&#123; drop_first_last(grades) &#125;")# =&gt; 85.6print(sum([94, 96, 88, 70, 80]) / 5)# =&gt; 85.6 å…¶ä»–åº”ç”¨ç¤ºä¾‹å¦‚ï¼š12345678&gt;&gt;&gt; record = ('Dave', 'dave@example.com', '773-555-1212', '847-555-1212')&gt;&gt;&gt; name, email, *phone_numbers = record&gt;&gt;&gt; name'Dave'&gt;&gt;&gt; email'dave@example.com'&gt;&gt;&gt; phone_numbers['773-555-1212', '847-555-1212'] * æ“ä½œç¬¦çš„ç‰¹æ€§ä½¿å…¶å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åº”ç”¨åœ¨å­—ç¬¦ä¸²åˆ†å‰²ä¸­ï¼š12345678&gt;&gt;&gt; line = 'nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false'&gt;&gt;&gt; uname, *fields, homedir, sh = line.split(':')&gt;&gt;&gt; uname'nobody'&gt;&gt;&gt; homedir'/var/empty'&gt;&gt;&gt; sh'/usr/bin/false' ç»“åˆ _ è¿˜å¯ä»¥å†™å‡ºå¦‚ä¸‹ä»£ç ä»¥åœ¨èµ‹å€¼æ—¶å¿½ç•¥åºåˆ—ä¸­çš„å¤šä¸ªé¡¹ç›®ï¼š123456&gt;&gt;&gt; record = ('ACME', 50, 123.45, (12, 18, 2012))&gt;&gt;&gt; name, *_, (*_, year) = record&gt;&gt;&gt; name'ACME'&gt;&gt;&gt; year2012 äºŒã€æ£€ç´¢åºåˆ—ä¸­æœ€å¤§æˆ–æœ€å°çš„ N ä¸ªé¡¹ç›®Python çš„ heapq æ¨¡å—åŒ…å« nlargest() å’Œ nsmallest() å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥ç­›é€‰æŸä¸ªæ•°æ®åºåˆ—ä¸­æœ€å¤§æˆ–æœ€å°çš„ N ä¸ªå€¼ã€‚12345678import heapqnums = [1, 8, 2, 23, 7, -4, 18, 23, 42, 37, 2]print(heapq.nlargest(3, nums))print(heapq.nsmallest(3, nums))# =&gt; [42, 37, 23]# =&gt; [-4, 1, 2] ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥æŽ¥æ”¶ä¸€ä¸ªåä¸º key çš„å‚æ•°ï¼Œä½¿å…¶å¯ä»¥åº”ç”¨åœ¨æ›´å¤æ‚çš„æ•°æ®ç»“æž„ä¸­ï¼š123456789101112131415161718import heapqportfolio = [ &#123;'name': 'IBM', 'shares': 100, 'price': 91.1&#125;, &#123;'name': 'AAPL', 'shares': 50, 'price': 543.22&#125;, &#123;'name': 'FB', 'shares': 200, 'price': 21.09&#125;, &#123;'name': 'HPQ', 'shares': 35, 'price': 31.75&#125;, &#123;'name': 'YHOO', 'shares': 45, 'price': 16.35&#125;, &#123;'name': 'ACME', 'shares': 75, 'price': 115.65&#125;]cheap = heapq.nsmallest(2, portfolio, key=lambda s: s['price'])expensive = heapq.nlargest(2, portfolio, key=lambda s: s['price'])print(cheap)# =&gt; [&#123;'name': 'YHOO', 'shares': 45, 'price': 16.35&#125;, &#123;'name': 'FB', 'shares': 200, 'price': 21.09&#125;]print(expensive)# =&gt; [&#123;'name': 'AAPL', 'shares': 50, 'price': 543.22&#125;, &#123;'name': 'ACME', 'shares': 75, 'price': 115.65&#125;] heapq ä¸­çš„ nlargest() å’Œ nsmallest() ä¸¤ä¸ªå‡½æ•°çš„åŽŸç†éƒ½æ˜¯å°†æ•°æ®åºåˆ—è½¬æ¢ä¸ºåˆ—è¡¨ç»“æž„å¹¶ä¸”ä»¥å †ï¼ˆheapï¼‰çš„å½¢å¼è¿›è¡Œç»„ç»‡ã€‚heap æœ€é‡è¦çš„å±žæ€§ä¸ºï¼Œ heap[0] æ°¸è¿œæ˜¯åºåˆ—ä¸­æœ€å°çš„å€¼ã€‚ä½¿ç”¨ heapq.heappop() æ–¹æ³•å¯ä»¥èŽ·å– heap ä¸­çš„ç¬¬ä¸€ä¸ªå€¼ï¼ˆå³æœ€å°å€¼ï¼‰ï¼Œè€Œä¹‹å‰ç¬¬äºŒå°çš„å€¼åˆ™ç§»åŠ¨åˆ°ç¬¬ä¸€çš„ä½ç½®ã€‚å³ä¸æ–­è°ƒç”¨ heappop() å¯ä»¥ä¸€ç›´èŽ·å–å½“å‰åºåˆ—ä¸­æœ€å°çš„å€¼ã€‚123456789101112131415&gt;&gt;&gt; nums = [1, 8, 2, 23, 7, -4, 18, 23, 42, 37, 2]&gt;&gt;&gt; import heapq&gt;&gt;&gt; heapq.heapify(nums)&gt;&gt;&gt; nums[-4, 2, 1, 23, 7, 2, 18, 23, 42, 37, 8]&gt;&gt;&gt; heapq.heappop(nums)-4&gt;&gt;&gt; heapq.heappop(nums)1&gt;&gt;&gt; heapq.heappop(nums)2&gt;&gt;&gt; heapq.heappop(nums)2&gt;&gt;&gt; heapq.heappop(nums)7 PSï¼šå¦‚æžœåªæƒ³æ£€ç´¢æŸä¸€ä¸ªæœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼Œmin() æˆ–è€… max() æ›´å¿«ï¼›å¦‚æžœ nlargest(N, items) æˆ– nsmallest(N, items) ä¸­çš„ N ä¸Ž items é›†åˆçš„å¤§å°å¾ˆæŽ¥è¿‘ï¼Œåˆ™å…ˆå¯¹é›†åˆè¿›è¡ŒæŽ’åºå†åˆ†ç‰‡çš„æ–¹å¼æ›´å¿«ä¸€ç‚¹ï¼Œå³ sorted(itmes)[:N]ï¼ˆå®žé™… nlargest å’Œ nsmallest å†…éƒ¨æœ¬èº«ä¹Ÿæ˜¯è¿™æ ·å®žçŽ°çš„ï¼‰ ä¸‰ã€å®žçŽ°ä¸€ä¸ªåŠ æƒé˜Ÿåˆ—ä»¥ä¸‹çš„ä»£ç å®žçŽ°äº†ä¸€ç§æ”¯æŒåŠ æƒçš„é˜Ÿåˆ—ï¼Œå³é˜Ÿåˆ—ä¸­çš„é¡¹ç›®ä¼šæŒ‰æŒ‡å®šçš„æƒé‡æŽ’åºï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨ pop æ–¹æ³•éƒ½å¯ä»¥è¿”å›žæƒé‡æœ€é«˜çš„é¡¹ç›®ã€‚1234567891011121314151617181920212223242526272829import heapqclass PriorityQueue: def __init__(self): self._queue = [] self._index = 0 def push(self, item, priority): heapq.heappush(self._queue, (-priority, self._index, item)) self._index += 1 def pop(self): return heapq.heappop(self._queue)[-1]# test codeq = PriorityQueue()q.push('foo', 1)q.push('bar', 5)q.push('spam', 4)q.push('grok', 1)print(q.pop())# =&gt; barprint(q.pop())# =&gt; spamprint(q.pop())# =&gt; fooprint(q.pop())# =&gt; grok å…¶ä¸­ heapq.heappush() å‡½æ•°å¯ä»¥å‘ _queue åºåˆ—ä¸­æ’å…¥æ•°æ®ï¼Œä¹‹åŽå†ä½¿ç”¨ heapq.heappop() å‡½æ•°èŽ·å–åºåˆ—ä¸­çš„æ•°æ®æ—¶ï¼Œæ€»èƒ½ä¿è¯å–å‡ºçš„æ•°æ®æ˜¯å½“æ—¶é˜Ÿåˆ—ä¸­æœ€å°çš„é‚£ä¸ªã€‚pop å’Œ push æ“ä½œçš„å¤æ‚åº¦ä¸º O(logN)ï¼Œæ¯”æ™®é€šåˆ—è¡¨å½¢å¼çš„æ“ä½œï¼ˆå¤æ‚åº¦ä¸º O(N)ï¼‰æ•ˆçŽ‡æ›´é«˜ã€‚åŒæ—¶æ•°æ®æ˜¯ä»¥å…ƒç»„ (-priority, _index, item) çš„å½¢å¼å­˜å…¥åˆ° _queue é˜Ÿåˆ—ä¸­çš„ï¼Œå…ƒç»„å¯ä»¥ä¾æ®è‡ªèº«çš„æ¯ä¸ªæ•°æ®é¡¹ä¾æ¬¡è¿›è¡Œæ¯”å¯¹å¹¶ç¡®å®šå¤§å°å…³ç³»ã€‚å› è€Œæƒé‡ -priority å¯ä»¥ä½œä¸ºæŽ’åºçš„é¦–è¦ä¾æ®ï¼ˆåŠ è´Ÿå·æ˜¯ä¸ºäº†ä½¿æƒé‡é«˜çš„å€¼æ›´å°ï¼Œå¯ä»¥ä¼˜å…ˆè¢« pop() è¿”å›žï¼‰ã€‚å½“æƒé‡ä¸€æ ·å³ -priority çš„å€¼ç›¸åŒæ—¶ï¼Œåˆ™æ ¹æ®æ’å…¥çš„é¡ºåºï¼ˆ_indexï¼‰è¿”å›žæ•°æ®ã€‚ å››ã€æ¯”è¾ƒå­—å…¸ä¸­çš„ Valueå‚è€ƒä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼š12345678910prices = &#123; 'ACME': 45.23, 'AAPL': 612.78, 'IBM': 205.55, 'HPQ': 37.20, 'FB': 10.75&#125;print(min(prices)) # =&gt; 'AAPL'print(max(prices)) # =&gt; 'IBM' ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œmin(prices) å’Œ max(prices) å‡½æ•°åªæ˜¯å¤„ç†å­—å…¸ prices ä¸­çš„ keysï¼Œå¯¹ values åˆ™ä¸åšä»»ä½•æ“ä½œã€‚å¯ä»¥å°†å…¶æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12min(prices.values()) # =&gt; 10.75max(prices.values()) # =&gt; 612.78 åˆ™æ­¤æ—¶ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°åˆåªå¯¹å­—å…¸ä¸­çš„ values æœ‰æ•ˆï¼Œè¾“å‡ºçš„ç»“æžœä¸­ä¹ŸåªåŒ…å« valuesï¼Œä¸åŒ…å«ä¸Žä¹‹å…³è”çš„ key çš„å€¼ã€‚ å¦‚æžœæƒ³æ ¹æ® values å¯¹å­—å…¸ä¸­çš„æ•°æ®è¿›è¡ŒæŽ’åºï¼ŒåŒæ—¶è¾“å‡ºçš„ç»“æžœä¸­æ—¢åŒ…å« valueï¼ŒåˆåŒ…å«ä¸Žä¹‹å…³è”çš„ keyã€‚åˆ™å¯ä»¥ä½¿ç”¨ zip() å‡½æ•°ã€‚zip() å‡½æ•°ä»¥å¤šä¸ªå¯è¿­ä»£çš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å„å¯¹è±¡ä¸­ä½ç½®å¯¹åº”çš„å…ƒç´ æ‰“åŒ…æˆä¸€ä¸ªä¸ªå…ƒç»„ã€‚å›žåˆ°å‰é¢çš„éœ€æ±‚ï¼Œåˆ™å¯ä»¥å°†å­—å…¸çš„ keys å’Œ values æ‹†åˆ†åˆ°ä¸¤ä¸ªåˆ—è¡¨ä¸­ï¼Œå†é€šè¿‡ zip() å‡½æ•°å°†å…¶ä¸­çš„æ•°æ®åˆå¹¶æˆä¸€ä¸ªä¸ªå…ƒç»„ï¼ˆç­‰åŒäºŽä¹‹å‰çš„é”®å€¼å¯¹ï¼‰ï¼Œè€Œ value ä½œä¸ºå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚12345678910111213141516171819prices = &#123; 'ACME': 45.23, 'AAPL': 612.78, 'IBM': 205.55, 'HPQ': 37.20, 'FB': 10.75&#125;for item in zip(prices.values(), prices.keys()): print(item)# =&gt; (45.23, 'ACME')# =&gt; (612.78, 'AAPL')# =&gt; (205.55, 'IBM')# =&gt; (37.2, 'HPQ')# =&gt; (10.75, 'FB')max_price = max(zip(prices.values(), prices.keys()))print(max_price)# =&gt; (612.78, 'AAPL') äº”ã€åŽ»é™¤åºåˆ—ä¸­çš„é‡å¤å…ƒç´ é›†åˆï¼ˆsetï¼‰æ˜¯ Python ä¸­çš„ä¸€ç§æ•°æ®ç»“æž„ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—æ— åºçš„ä¸é‡å¤å…ƒç´ ã€‚å› æ­¤å¯ä»¥é€šè¿‡å°†å…¶ä»–ç±»åž‹çš„æ•°æ®è½¬ä¸º set ç±»åž‹ï¼Œä¸ºåºåˆ—ä¸­çš„æ•°æ®åŽ»é‡ã€‚ä½†æ­¤ç§æ–¹æ³•ä¸èƒ½ä¿ç•™åŽŸåºåˆ—ä¸­æ•°æ®é¡¹åŽŸæœ¬çš„æŽ’åˆ—é¡ºåºï¼ˆå› ä¸º set æ˜¯æ— åºçš„ï¼‰ã€‚123&gt;&gt;&gt; a = [1, 5, 2, 1, 9, 1, 5, 10]&gt;&gt;&gt; set(a)&#123;1, 2, 5, 9, 10&#125; ä¸‹é¢çš„å‡½æ•° dedupe åˆ™å®žçŽ°äº†åŽ»é‡å¹¶ä¿ç•™åŽŸæœ¬çš„æŽ’åˆ—é¡ºåºï¼š123456789101112def dedupe(items): seen = set() for item in items: if item not in seen: yield item seen.add(item)a = [1, 5, 2, 1, 9, 1, 5, 10]print(list(dedupe(a)))# =&gt; [1, 5, 2, 9, 10] è€Œå¯¹äºŽæ›´å¤æ‚çš„æ•°æ®ç»“æž„ï¼Œæ¯”å¦‚å¯¹å¦‚ä¸‹çš„åˆ—è¡¨è¿›è¡ŒåŽ»é‡æ“ä½œï¼š[{&#39;x&#39;:1, &#39;y&#39;:2}, {&#39;x&#39;:1, &#39;y&#39;:3}, {&#39;x&#39;:1, &#39;y&#39;:2}, {&#39;x&#39;:2, &#39;y&#39;:4}] åˆ™å¯ä»¥å°† dedupe å‡½æ•°æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š123456789101112131415def dedupe(items, key=None): seen = set() for item in items: val = item if key is None else key(item) if val not in seen: yield item seen.add(val)a = [&#123;'x':1, 'y':2&#125;, &#123;'x':1, 'y':3&#125;, &#123;'x':1, 'y':2&#125;, &#123;'x':2, 'y':4&#125;]print(list(dedupe(a, key=lambda d: (d['x'],d['y']))))# =&gt; [&#123;'x': 1, 'y': 2&#125;, &#123;'x': 1, 'y': 3&#125;, &#123;'x': 2, 'y': 4&#125;]print(list(dedupe(a, key=lambda d: (d['x']))))# =&gt; [&#123;'x': 1, 'y': 2&#125;, &#123;'x': 2, 'y': 4&#125;] é¢ï¼Œè‡ªè¡Œä½“ä¼šå§ã€‚ã€‚ã€‚ å…­ã€æ‰¾å‡ºåºåˆ—ä¸­æœ€å¸¸å‡ºçŽ°çš„é¡¹collections.Counter ç±»å¯ä»¥ç”¨æ¥å¯»æ‰¾åºåˆ—ä¸­å‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„å‡ ä¸ªé¡¹ç›®ã€‚1234567891011121314151617181920212223from collections import Counterwords = [ 'look', 'into', 'my', 'eyes', 'look', 'into', 'my', 'eyes', 'the', 'eyes', 'the', 'eyes', 'the', 'eyes', 'not', 'around', 'the', 'eyes', "don't", 'look', 'around', 'the', 'eyes', 'look', 'into', 'my', 'eyes', "you're", 'under']word_counts = Counter(words)top_three = word_counts.most_common(3)print(top_three)# =&gt; [('eyes', 8), ('the', 5), ('look', 4)]morewords = ['why', 'are', 'you', 'not', 'looking', 'in', 'my', 'eyes']word_counts.update(morewords)print(word_counts.most_common(3))# =&gt; [('eyes', 9), ('the', 5), ('look', 4)]a = Counter(words)b = Counter(morewords)print(a + b)# =&gt; Counter(&#123;'eyes': 9, 'the': 5, 'look': 4, 'my': 4, 'into': 3, 'not': 2, 'around': 2, "don't": 1, "you're": 1, 'under': 1, 'why': 1, 'are': 1, 'you': 1, 'looking': 1, 'in': 1&#125;) å‚è€ƒèµ„æ–™Python Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Tricks</tag>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Cookbook</tag>
        <tag>Datastructure</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows 10 é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹ Wi-Fi å¯†ç ]]></title>
    <url>%2F2019%2F10%2F27%2Ffind-wlan-password-in-windows-10%2F</url>
    <content type="text"><![CDATA[æœ¬æ–¹æ³•ä»…é€‚ç”¨äºŽ Win10 ç³»ç»Ÿï¼Œä¸”å·²è¿žæŽ¥è¿‡è¯¥ WiFi å¹¶å‹¾é€‰äº†è®°ä½å¯†ç é€‰é¡¹ã€‚å³ç”µè„‘å¯è‡ªåŠ¨è¿žæŽ¥æŸçƒ­ç‚¹ï¼Œä½†ä¹‹åŽåˆä¸è®°å¾—è¯¥çƒ­ç‚¹å¯†ç ï¼Œæ— æ³•æ‰‹åŠ¨æŽ¥å…¥å…¶ä»–è®¾å¤‡ã€‚æ–¹æ³•æ¥è‡ªäºŽæ²¹ç®¡ä¸Šçš„æŸè§†é¢‘åˆ†äº«ã€‚ å‰æ Win10 ç³»ç»Ÿ ç®¡ç†å‘˜æƒé™ å·²è¿žæŽ¥è¿‡æŸçƒ­ç‚¹å¹¶ä¿å­˜äº†å¯†ç  æ­¥éª¤ä¸€ã€ç®¡ç†å‘˜æƒé™æ‰“å¼€å‘½ä»¤è¡Œå¯ä»¥æŒ‰ä¸‹ win+R ç»„åˆé”®è°ƒå‡ºè¿è¡Œçª—å£ï¼Œè¾“å‡º cmd å¹¶å›žè½¦ã€‚å¦‚æ‰“å¼€çš„æ˜¯æ™®é€šç”¨æˆ·çš„å‘½ä»¤æç¤ºç¬¦çª—å£ï¼Œå¯å³å‡»ä»»åŠ¡æ ä¸­çš„å‘½ä»¤è¡Œå›¾æ ‡ï¼Œå†å³å‡»å¼¹å‡ºçš„ å‘½ä»¤æç¤ºç¬¦ æ–‡å­—ï¼Œé€‰æ‹© ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œã€‚ æ­¥éª¤äºŒã€netsh å‘½ä»¤netsh æ˜¯ Windows ä¸‹çš„ç½‘ç»œé…ç½®å‘½ä»¤ï¼Œç›´æŽ¥è¾“å…¥è¯¥å‘½ä»¤å¹¶å›žè½¦ï¼Œå³å¯è¿›å…¥ä¸€ä¸ªäº¤äº’å¼çš„å‘½ä»¤è¡Œã€‚è¿è¡Œ wlan show profile å³å¯èŽ·å–å½“å‰ç³»ç»Ÿä¸­ä¿å­˜çš„æ— çº¿çƒ­ç‚¹ä¿¡æ¯ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š12345678910111213141516C:\Users\Administrator&gt;netshnetsh&gt;wlan show profileæŽ¥å£ WLAN ä¸Šçš„é…ç½®æ–‡ä»¶:ç»„ç­–ç•¥é…ç½®æ–‡ä»¶(åªè¯»)--------------------------------- &lt;æ— &gt;ç”¨æˆ·é…ç½®æ–‡ä»¶------------- æ‰€æœ‰ç”¨æˆ·é…ç½®æ–‡ä»¶ : 3-1-2102 æ‰€æœ‰ç”¨æˆ·é…ç½®æ–‡ä»¶ : 103netsh&gt; ä¸Šé¢çš„ 3-1-2102 å’Œ 103 å³è¡¨ç¤ºæ­¤å°è®¡ç®—æœºè¿žæŽ¥è¿‡å¹¶è®°ä½äº†å¯†ç çš„çƒ­ç‚¹åç§°ã€‚ æ­¥éª¤ä¸‰ã€èŽ·å–çƒ­ç‚¹å¯†ç ç»§ç»­ä½¿ç”¨ wlan show profile &lt;SSID&gt; key=clear å‘½ä»¤å³å¯èŽ·å–æŸçƒ­ç‚¹ï¼ˆç”± &lt;SSID&gt; æŒ‡å®šï¼‰çš„å…·ä½“è¿žæŽ¥ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940netsh&gt;wlan show profile 103 key=clearæŽ¥å£ WLAN ä¸Šçš„é…ç½®æ–‡ä»¶ 103:=======================================================================å·²åº”ç”¨: æ‰€æœ‰ç”¨æˆ·é…ç½®æ–‡ä»¶é…ç½®æ–‡ä»¶ä¿¡æ¯------------------- ç‰ˆæœ¬ : 1 ç±»åž‹ : æ— çº¿å±€åŸŸç½‘ åç§° : 103 æŽ§åˆ¶é€‰é¡¹ : è¿žæŽ¥æ¨¡å¼ : è‡ªåŠ¨è¿žæŽ¥ ç½‘ç»œå¹¿æ’­ : åªåœ¨ç½‘ç»œå¹¿æ’­æ—¶è¿žæŽ¥ AutoSwitch : è¯·å‹¿åˆ‡æ¢åˆ°å…¶ä»–ç½‘ç»œ MAC éšæœºåŒ–: ç¦ç”¨è¿žæŽ¥è®¾ç½®--------------------- SSID æ•°ç›® : 1 SSID åç§° :â€œ103â€ ç½‘ç»œç±»åž‹ : ç»“æž„ æ— çº¿ç”µç±»åž‹ : [ ä»»ä½•æ— çº¿ç”µç±»åž‹ ] ä¾›åº”å•†æ‰©å±•å : ä¸å­˜åœ¨å®‰å…¨è®¾ç½®----------------- èº«ä»½éªŒè¯ : WPA2 - ä¸ªäºº å¯†ç  : CCMP èº«ä»½éªŒè¯ : WPA2 - ä¸ªäºº å¯†ç  : GCMP å®‰å…¨å¯†é’¥ : å­˜åœ¨ å…³é”®å†…å®¹ : House1886753****è´¹ç”¨è®¾ç½®------------- è´¹ç”¨ : ä¸å¯ç”¨netsh&gt; å…¶ä¸­ å…³é”®å†…å®¹ æ¡ç›®ä¸­çš„ House1886753**** å³ä»£è¡¨æ— çº¿çƒ­ç‚¹ 103 çš„è¿žæŽ¥å¯†ç ã€‚ å‘½ä»¤åˆ—è¡¨ netsh wlan show profile wlan show profile &lt;SSID&gt; key=clear]]></content>
      <categories>
        <category>Hack</category>
      </categories>
      <tags>
        <tag>Security</tag>
        <tag>Windows</tag>
        <tag>Wlan</tag>
        <tag>Network</tag>
        <tag>Hack</tag>
        <tag>WiFi</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django REST framework æ•™ç¨‹ï¼ˆ2ï¼‰â€”â€” åºåˆ—åŒ–]]></title>
    <url>%2F2019%2F10%2F11%2Fdjango-rest-framework-2-serializer%2F</url>
    <content type="text"><![CDATA[å‚è€ƒè‡ª Django REST framework å®˜æ–¹æ–‡æ¡£ ï¼Œæƒä½œç¬”è®°ã€‚ ä¸€ã€çŽ¯å¢ƒæ­å»ºé€šè¿‡ Python3 å†…ç½®çš„ venv æ¨¡å—åˆ›å»ºè™šæ‹Ÿå¼€å‘çŽ¯å¢ƒï¼š123$ python3 -m venv env # åˆ›å»ºåä¸º env çš„è™šæ‹ŸçŽ¯å¢ƒ$ source env/bin/activate # å¯ç”¨è™šæ‹ŸçŽ¯å¢ƒ# env\Scripts\activate Windows ç³»ç»Ÿå¯ç”¨è™šæ‹ŸçŽ¯å¢ƒ å®‰è£…ä¾èµ–åº“ï¼š123$ pip install django$ pip install djangorestframework$ pip install pygments # We&apos;ll be using this for the code highlighting åˆå§‹åŒ–é¡¹ç›®123$ django-admin startproject tutorial$ cd tutorial$ python manage.py startapp snippets ç¼–è¾‘ tutorial/tutorial/settings.py é…ç½®æ–‡ä»¶ï¼Œå°† rest_framework å’Œ snippets APP æ·»åŠ åˆ° INSTALLED_APPS é€‰é¡¹ä¸­ã€‚12345INSTALLED_APPS = [ ... &apos;rest_framework&apos;, &apos;snippets.apps.SnippetsConfig&apos;,] äºŒã€åˆ›å»ºæ¨¡åž‹ç¼–è¾‘ tutorial/snippets/models.py æ–‡ä»¶åˆ›å»ºæ•°æ®æ¨¡åž‹ã€‚å†…å®¹å¦‚ä¸‹ï¼š12345678910111213141516171819from django.db import modelsfrom pygments.lexers import get_all_lexersfrom pygments.styles import get_all_stylesLEXERS = [item for item in get_all_lexers() if item[1]]LANGUAGE_CHOICES = sorted([(item[1][0], item[0]) for item in LEXERS])STYLE_CHOICES = sorted([(item, item) for item in get_all_styles()])class Snippet(models.Model): created = models.DateTimeField(auto_now_add=True) title = models.CharField(max_length=100, blank=True, default=&apos;&apos;) code = models.TextField() linenos = models.BooleanField(default=False) language = models.CharField(choices=LANGUAGE_CHOICES, default=&apos;python&apos;, max_length=100) style = models.CharField(choices=STYLE_CHOICES, default=&apos;friendly&apos;, max_length=100) class Meta: ordering = [&apos;created&apos;] ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®Œæˆæ•°æ®åº“è¿ç§»æ“ä½œï¼š12$ python manage.py makemigrations snippets$ python manage.py migrate ä¸‰ã€åˆ›å»ºåºåˆ—åŒ–å™¨åºåˆ—åŒ–æ˜¯æŒ‡å°† Web API æä¾›çš„åŽå°æ•°æ®å·²ç‰¹å®šçš„å½¢å¼ï¼ˆå¦‚ json æ ¼å¼ï¼‰å±•ç¤ºç»™ç”¨æˆ·ï¼Œæ–¹ä¾¿å‰ç«¯ç¨‹åºè°ƒç”¨ã€‚ ä»¥ä¸‹ä»£ç åæ˜ äº†ä¸€ä¸ªåºåˆ—åŒ–å™¨çš„åŸºæœ¬é€»è¾‘ã€‚ç¼–è¾‘ tutorial/snippets/serializers.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829from rest_framework import serializersfrom snippets.models import Snippet, LANGUAGE_CHOICES, STYLE_CHOICESclass SnippetSerializer(serializers.Serializer): id = serializers.IntegerField(read_only=True) title = serializers.CharField(required=False, allow_blank=True, max_length=100) code = serializers.CharField(style=&#123;&apos;base_template&apos;: &apos;textarea.html&apos;&#125;) linenos = serializers.BooleanField(required=False) language = serializers.ChoiceField(choices=LANGUAGE_CHOICES, default=&apos;python&apos;) style = serializers.ChoiceField(choices=STYLE_CHOICES, default=&apos;friendly&apos;) def create(self, validated_data): &quot;&quot;&quot; Create and return a new `Snippet` instance, given the validated data. &quot;&quot;&quot; return Snippet.objects.create(**validated_data) def update(self, instance, validated_data): &quot;&quot;&quot; Update and return an existing `Snippet` instance, given the validated data. &quot;&quot;&quot; instance.title = validated_data.get(&apos;title&apos;, instance.title) instance.code = validated_data.get(&apos;code&apos;, instance.code) instance.linenos = validated_data.get(&apos;linenos&apos;, instance.linenos) instance.language = validated_data.get(&apos;language&apos;, instance.language) instance.style = validated_data.get(&apos;style&apos;, instance.style) instance.save() return instance ModelSerializerDjango REST framework æ¡†æž¶é€šè¿‡ serializers ä¸­çš„æŸäº›ç±»å¯¹åºåˆ—åŒ–å™¨çš„é€»è¾‘åŠŸèƒ½åšäº†å°è£…ä¸ŽæŠ½è±¡ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¿™äº›ç±»å®Œæˆä¸Žä¸Šé¢ä»£ç åŒæ ·çš„éœ€æ±‚ï¼ŒåŒæ—¶ä»£ç çš„å†—ä½™åº¦å¤§å¤§é™ä½Žã€‚å¯ä»¥å°† tutorial/snippets/serializers.py æ–‡ä»¶æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š1234567from rest_framework import serializersfrom snippets.models import Snippetclass SnippetSerializer(serializers.ModelSerializer): class Meta: model = Snippet fields = [&apos;id&apos;, &apos;title&apos;, &apos;code&apos;, &apos;linenos&apos;, &apos;language&apos;, &apos;style&apos;] å››ã€Django Shell æ“ä½œ Serializerè¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›å…¥ Django Shellï¼š$ python manage.py shell ã€‚ é€šè¿‡ Snippet æ¨¡åž‹åˆ›å»ºæ•°æ®çºªå½•ï¼š12345678&gt;&gt;&gt; from snippets.models import Snippet&gt;&gt;&gt; from snippets.serializers import SnippetSerializer&gt;&gt;&gt; from rest_framework.renderers import JSONRenderer&gt;&gt;&gt; from rest_framework.parsers import JSONParser&gt;&gt;&gt; snippet = Snippet(code=&apos;foo = &quot;bar&quot;\n&apos;)&gt;&gt;&gt; snippet.save()&gt;&gt;&gt; snippet = Snippet(code=&apos;print(&quot;hello, world&quot;)\n&apos;)&gt;&gt;&gt; snippet.save() åºåˆ—åŒ–æ•°æ®å¯¹è±¡å¹¶ä»¥ JSON çš„å½¢å¼å±•ç¤ºï¼š123456&gt;&gt;&gt; serializer = SnippetSerializer(snippet)&gt;&gt;&gt; serializer.data&#123;&apos;id&apos;: 2, &apos;title&apos;: &apos;&apos;, &apos;code&apos;: &apos;print(&quot;hello, world&quot;)\n&apos;, &apos;linenos&apos;: False, &apos;language&apos;: &apos;python&apos;, &apos;style&apos;: &apos;friendly&apos;&#125;&gt;&gt;&gt; content = JSONRenderer().render(serializer.data)&gt;&gt;&gt; contentb&apos;&#123;&quot;id&quot;:2,&quot;title&quot;:&quot;&quot;,&quot;code&quot;:&quot;print(\\&quot;hello, world\\&quot;)\\n&quot;,&quot;linenos&quot;:false,&quot;language&quot;:&quot;python&quot;,&quot;style&quot;:&quot;friendly&quot;&#125;&apos; ååºåˆ—åŒ–ï¼š12345678910&gt;&gt;&gt; import io&gt;&gt;&gt; stream = io.BytesIO(content)&gt;&gt;&gt; data = JSONParser().parse(stream)&gt;&gt;&gt; serializer = SnippetSerializer(data=data)&gt;&gt;&gt; serializer.is_valid()True&gt;&gt;&gt; serializer.validated_dataOrderedDict([(&apos;title&apos;, &apos;&apos;), (&apos;code&apos;, &apos;print(&quot;hello, world&quot;)&apos;), (&apos;linenos&apos;, False), (&apos;language&apos;, &apos;python&apos;), (&apos;style&apos;, &apos;friendly&apos;)])&gt;&gt;&gt; serializer.save()&lt;Snippet: Snippet object (3)&gt; åºåˆ—åŒ–å¤šä¸ªæ¨¡åž‹å®žä¾‹ï¼š123&gt;&gt;&gt; serializer = SnippetSerializer(Snippet.objects.all(), many=True)&gt;&gt;&gt; serializer.data[OrderedDict([(&apos;id&apos;, 1), (&apos;title&apos;, &apos;&apos;), (&apos;code&apos;, &apos;foo = &quot;bar&quot;\n&apos;), (&apos;linenos&apos;, False), (&apos;language&apos;, &apos;python&apos;), (&apos;style&apos;, &apos;friendly&apos;)]), OrderedDict([(&apos;id&apos;, 2), (&apos;title&apos;, &apos;&apos;), (&apos;code&apos;, &apos;print(&quot;hello, world&quot;)\n&apos;), (&apos;linenos&apos;, False), (&apos;language&apos;, &apos;python&apos;), (&apos;style&apos;, &apos;friendly&apos;)]), OrderedDict([(&apos;id&apos;, 3), (&apos;title&apos;, &apos;&apos;), (&apos;code&apos;, &apos;print(&quot;hello, world&quot;)&apos;), (&apos;linenos&apos;, False), (&apos;language&apos;, &apos;python&apos;), (&apos;style&apos;, &apos;friendly&apos;)])] äº”ã€è§†å›¾ç¼–è¾‘ tutorial/snippets/views.py æ–‡ä»¶ï¼Œåˆ›å»º snippet_list å’Œ snippet_detail ä¸¤ä¸ªè§†å›¾å‡½æ•°ï¼Œå¹¶æ·»åŠ ä¸Šå¯¹ GETã€POST ç­‰è¯·æ±‚çš„å“åº”é€»è¾‘ã€‚å†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051from django.http import HttpResponse, JsonResponsefrom django.views.decorators.csrf import csrf_exemptfrom rest_framework.parsers import JSONParserfrom snippets.models import Snippetfrom snippets.serializers import SnippetSerializer@csrf_exemptdef snippet_list(request): &quot;&quot;&quot; List all code snippets, or create a new snippet. &quot;&quot;&quot; if request.method == &apos;GET&apos;: snippets = Snippet.objects.all() serializer = SnippetSerializer(snippets, many=True) return JsonResponse(serializer.data, safe=False) elif request.method == &apos;POST&apos;: data = JSONParser().parse(request) serializer = SnippetSerializer(data=data) if serializer.is_valid(): serializer.save() return JsonResponse(serializer.data, status=201) return JsonResponse(serializer.errors, status=400)@csrf_exemptdef snippet_detail(request, pk): &quot;&quot;&quot; Retrieve, update or delete a code snippet. &quot;&quot;&quot; try: snippet = Snippet.objects.get(pk=pk) except Snippet.DoesNotExist: return HttpResponse(status=404) if request.method == &apos;GET&apos;: serializer = SnippetSerializer(snippet) return JsonResponse(serializer.data) elif request.method == &apos;PUT&apos;: data = JSONParser().parse(request) serializer = SnippetSerializer(snippet, data=data) if serializer.is_valid(): serializer.save() return JsonResponse(serializer.data) return JsonResponse(serializer.errors, status=400) elif request.method == &apos;DELETE&apos;: snippet.delete() return HttpResponse(status=204) å…­ã€è·¯ç”±é…ç½®ç¼–è¾‘ tutorial/snippets/urls.py æ–‡ä»¶ï¼Œå®Œæˆè§†å›¾ä¸Ž URL è·¯å¾„çš„å…³è”ï¼š1234567from django.urls import pathfrom snippets import viewsurlpatterns = [ path(&apos;snippets/&apos;, views.snippet_list), path(&apos;snippets/&lt;int:pk&gt;/&apos;, views.snippet_detail),] åœ¨ tutorial/tutorial/urls.py é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ snippets åº”ç”¨çš„è·¯ç”±é…ç½®ï¼š1234567from django.contrib import adminfrom django.urls import pathurlpatterns = [ path(&apos;&apos;, include(&apos;snippets.urls&apos;)), path(&apos;admin/&apos;, admin.site.urls),] ä¸ƒã€æµ‹è¯•è¿è¡Œ $ python manage.py runserver å‘½ä»¤å¼€å¯æµ‹è¯•æœåŠ¡ï¼Œä½¿ç”¨ httpie å·¥å…·å¯¹ API è¿›è¡Œè®¿é—®æµ‹è¯•ï¼Œç»“æžœå¦‚ä¸‹ï¼š GET æ–¹æ³•èŽ·å–æ•°æ®ï¼š12345678910111213141516171819$ http -b 172.20.19.76:8000/snippets/[ &#123; &quot;code&quot;: &quot;foo = \&quot;bar\&quot;\n&quot;, &quot;id&quot;: 1, &quot;language&quot;: &quot;python&quot;, &quot;linenos&quot;: false, &quot;style&quot;: &quot;friendly&quot;, &quot;title&quot;: &quot;&quot; &#125;, &#123; &quot;code&quot;: &quot;print(\&quot;hello, world\&quot;)\n&quot;, &quot;id&quot;: 2, &quot;language&quot;: &quot;python&quot;, &quot;linenos&quot;: false, &quot;style&quot;: &quot;friendly&quot;, &quot;title&quot;: &quot;&quot; &#125;] POST æ–¹æ³•æ·»åŠ æ–°çš„æ•°æ®ï¼š123456789$ http -b POST 172.20.19.76:8000/snippets/ code=&quot;a = 1\nb = 2\nprint(a + b)&quot;&#123; &quot;code&quot;: &quot;a = 1\\nb = 2\\nprint(a + b)&quot;, &quot;id&quot;: 4, &quot;language&quot;: &quot;python&quot;, &quot;linenos&quot;: false, &quot;style&quot;: &quot;friendly&quot;, &quot;title&quot;: &quot;&quot;&#125;]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>REST</tag>
        <tag>API</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ä¸­çš„åŒæ­¥ç¼–ç¨‹ä¸Žå¼‚æ­¥ç¼–ç¨‹ï¼ˆasyncï¼‰å®žä¾‹å¯¹æ¯”]]></title>
    <url>%2F2019%2F10%2F11%2Fexamples-about-python-sync-and-async-program%2F</url>
    <content type="text"><![CDATA[åŒæ­¥ç¨‹åºï¼ˆsynchronous programï¼‰å³æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ªæ­¥éª¤ï¼Œåªæœ‰åœ¨å½“å‰æ“ä½œçš„æ­¥éª¤å½»åº•å®Œæˆä¹‹åŽï¼Œæ‰ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ­¥éª¤ç»§ç»­æ‰§è¡Œã€‚å¼‚æ­¥ç¨‹åºï¼ˆasynchronous programï¼‰åŒæ ·æ¯æ¬¡åªæŽ¥å—ä¸€ä¸ªæ“ä½œæ­¥éª¤ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä¼šç­‰å¾…å½“å‰çš„æ“ä½œæ­¥éª¤æ‰§è¡Œå®ŒæˆåŽæ‰ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚ ä¸€ã€åŒæ­¥ç¼–ç¨‹ä¸‹é¢çš„ä»£ç è´Ÿè´£ä»Žé˜Ÿåˆ—ï¼ˆqueueï¼‰ä¸­ä¾æ¬¡å–å‡ºæŸä¸ªç‰¹å®šçš„ä»»åŠ¡å¹¶æ‰§è¡Œã€‚é˜Ÿåˆ—æ˜¯ Python ä¸­çš„ä¸€ç§å®žçŽ°äº† FIFO ï¼ˆå…ˆå…¥å…ˆå‡ºï¼‰è§„åˆ™çš„æ•°æ®ç»“æž„ï¼Œå¯ä»¥è°ƒç”¨å…¶ put() å’Œ get() æ–¹æ³•ä»¥ç›¸åŒçš„é¡ºåºå­˜å…¥å’Œå–å‡ºæ•°æ®ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import queuedef task(name, work_queue): if work_queue.empty(): print(f"Task &#123;name&#125; nothing to do") else: while not work_queue.empty(): count = work_queue.get() total = 0 print(f"Task &#123;name&#125; running") for x in range(count): total += 1 print(f"Task &#123;name&#125; total: &#123;total&#125;")def main(): """ This is the main entry point for the program. """ # Create the queue of 'work' work_queue = queue.Queue() # Put some 'work' in the queue for work in [15, 10, 5, 2]: work_queue.put(work) # Create some synchronous tasks tasks = [ (task, "One", work_queue), (task, "Two", work_queue) ] # Run the tasks for t, n, q in tasks: t(n, q)if __name__ == "__main__": main()# =&gt; Task One running# =&gt; Task One total: 15# =&gt; Task One running# =&gt; Task One total: 10# =&gt; Task One running# =&gt; Task One total: 5# =&gt; Task One running# =&gt; Task One total: 2# =&gt; Task Two nothing to do å…¶ä¸­çš„ task() å‡½æ•°æŽ¥æ”¶å­—ç¬¦ä¸²å’Œé˜Ÿåˆ—ä½œä¸ºå‚æ•°ï¼Œå¯ä»¥ä»Žé˜Ÿåˆ—ä¸­ä¸æ–­åœ°å–å‡ºæ•°å­—å¹¶å®Œæˆè®¡æ•°åŠ¨ä½œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºã€‚è€Œ main() å‡½æ•°åˆ™ä¾æ¬¡æŒ‡æ´¾ä¸¤ä¸ª task() å‡½æ•°ç”¨äºŽå¤„ç†åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ•°æ®ã€‚ä»Žè¾“å‡ºç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼ŒæŽ’åœ¨å‰é¢çš„ Task One å¤„ç†äº†é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå¾…æ•°æ®å¤„ç†å®Œæˆå³ Task One ä¸­çš„å¾ªçŽ¯é€€å‡ºä¹‹åŽï¼ŒæŽ’åœ¨åŽé¢çš„ Task Two ç»§ç»­æ‰§è¡Œï¼Œä½†å·²ç»æ²¡æœ‰ä»»ä½•æ•°æ®éœ€è¦å¤„ç†ã€‚ äºŒã€åä½œä¸‹é¢ç‰ˆæœ¬çš„ç¨‹åºå…è®¸ä¸¤ä¸ªå·¥ä½œå‡½æ•°å…±åŒå¤„ç†ä½äºŽåŒä¸€é˜Ÿåˆ—ä¸­çš„å¤šä¸ªä»»åŠ¡ï¼Œè¾¾åˆ°â€œåä½œâ€çš„æ•ˆæžœã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import queuedef task(name, queue): while not queue.empty(): count = queue.get() total = 0 print(f"Task &#123;name&#125; running") for x in range(count): total += 1 yield print(f"Task &#123;name&#125; total: &#123;total&#125;")def main(): """ This is the main entry point for the program. """ # Create the queue of 'work' work_queue = queue.Queue() # Put some 'work' in the queue for work in [15, 10, 5, 2]: work_queue.put(work) # Create some tasks tasks = [ task("One", work_queue), task("Two", work_queue) ] # Run the tasks done = False while not done: for t in tasks: try: next(t) except StopIteration: tasks.remove(t) if len(tasks) == 0: done = Trueif __name__ == "__main__": main()# =&gt; Task One running# =&gt; Task Two running# =&gt; Task Two total: 10# =&gt; Task Two running# =&gt; Task One total: 15# =&gt; Task One running# =&gt; Task Two total: 5# =&gt; Task One total: 2 ä»£ç ä¸­æœ€å…³é”®çš„éƒ¨åˆ†å³ yield å…³é”®å­—ï¼Œå®ƒå°† task() å‡½æ•°è½¬å˜æˆäº†ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰ã€‚ ç”Ÿæˆå™¨å‡½æ•°å’Œå…¶ä»– Python å‡½æ•°åœ¨è°ƒç”¨æ—¶å¹¶æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œä½†æ˜¯å½“ç”Ÿæˆå™¨ä¸­çš„ yield è¯­å¥æ‰§è¡Œæ—¶ï¼Œå¯¹ç¨‹åºçš„æŽ§åˆ¶æƒä¼šè¢«è¿”è¿˜ç»™è°ƒç”¨ç”Ÿæˆå™¨çš„å‡½æ•°ï¼ˆcallerï¼‰ã€‚æœ‰è¶£çš„åœ°æ–¹åœ¨äºŽï¼Œè¿˜å¯ä»¥é€šè¿‡å°†ç”Ÿæˆå™¨ä¼ é€’ç»™ next() å‡½æ•°ï¼Œå°†ç¨‹åºçš„æŽ§åˆ¶æƒå†æ¬¡è½¬ç§»ç»™ç”Ÿæˆå™¨æœ¬èº«ã€‚ç»“åˆå‰é¢ç”Ÿæˆå™¨ä¸­çš„ yield å…³é”®å­—ï¼Œæœ€ç»ˆè¾¾åˆ°åœ¨ç¨‹åºä¸­æ¥å›žåˆ‡æ¢ä¸Šä¸‹æ–‡çš„æ•ˆæžœã€‚ ä¸Šé¢çš„ main() å‡½æ•°é€šè¿‡è°ƒç”¨ next(t) å°†ç¨‹åºæŽ§åˆ¶æƒè½¬ç§»ç»™æŸä¸ª Task() ç”Ÿæˆå™¨ï¼Œè€Œ Task() ä»£ç ä¸­çš„ yield åˆä¼šåœ¨æ‰§è¡Œå®ŒæŒ‡æ´¾ç»™å®ƒçš„æŸä¸ªä»»åŠ¡ä¹‹åŽï¼Œè¿”å›žç»“æžœå¹¶å°†æŽ§åˆ¶æƒè¿˜ç»™ main() ä¸»ç¨‹åºã€‚è€Œ main() å‡½æ•°ç»§ç»­é€šè¿‡ next(t) å°†é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªä»»åŠ¡åˆ†é…ç»™å¦ä¸€ä¸ª Task() æ‰§è¡Œï¼Œç›´åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºã€‚ä»Žè¾“å‡ºç»“æžœä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒTask One å’Œ Task Two éƒ½å‚ä¸Žäº†é˜Ÿåˆ—ä¸­ä»»åŠ¡çš„å¤„ç†ã€‚ è™½ç„¶ Task Two total: 10 æœ€åŽå…ˆäºŽ Task One total: 15 è¾“å‡ºï¼Œä½†å¹¶ä¸ä»£è¡¨è¯¥ç¨‹åºæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚Task Two å…ˆè¾“å‡ºçš„åŽŸå› ä»…åœ¨äºŽå®ƒæ‰§è¡Œçš„è®¡æ•°æ¬¡æ•°å°‘ã€‚ä»Žé€»è¾‘ä¸Šçœ‹ï¼Œè¿™ç§é€šè¿‡ç”Ÿæˆå™¨å‡½æ•°åˆ‡æ¢ç¨‹åºä¸Šä¸‹æ–‡çš„æ–¹å¼è™½ç„¶ä½¿å¤šä¸ªå·¥ä½œå‡½æ•°åŒæ—¶å‚ä¸Žåˆ°äº†ä»»åŠ¡ä¸­ï¼Œä½†ä»æ—§æ€»æ˜¯åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åŽæ‰è¿›è¡Œä¸Šä¸‹æ–‡çš„åˆ‡æ¢ã€‚å› æ­¤ä»å±žäºŽåŒæ­¥ç¨‹åºã€‚ ä¸‰ã€é˜»å¡žå¼è¯·æ±‚ä¸‹é¢çš„ä»£ç ç¤ºä¾‹å’Œä¸Šä¸€ä¸ªç‰ˆæœ¬åŸºæœ¬ç›¸åŒï¼Œåªä¸è¿‡åœ¨ Task() ä»£ç ä¸­ä½¿ç”¨ time.sleep(delay) å‡½æ•°ç”¨äºŽæ¨¡æ‹Ÿé˜»å¡žè¯·æ±‚ï¼Œå–ä»£äº†ä¹‹å‰çš„è®¡æ•°æ“ä½œã€‚é˜»å¡žè¯·æ±‚æ˜¯æŒ‡åœ¨ä¸€å®šæ—¶é—´å†…é˜»æ­¢ CPU åŽ»å¤„ç†å…¶ä»–ä»»ä½•äº‹ä»¶çš„ä»£ç ï¼Œæ¯”å¦‚ time.sleep(delay) å°±ä¼šé˜»æ­¢ CPU åšå…¶ä»–ä»»ä½•æ“ä½œç›´åˆ°ç­‰å¾…çš„æ—¶é—´ç»“æŸã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758import timeimport queuedef task(name, queue): while not queue.empty(): delay = queue.get() start_time = time.time() print(f"Task &#123;name&#125; running") time.sleep(delay) print(f"Task &#123;name&#125; total elapsed time: &#123;time.time() - start_time:.1f&#125;") yielddef main(): """ This is the main entry point for the program. """ # Create the queue of 'work' work_queue = queue.Queue() # Put some 'work' in the queue for work in [15, 10, 5, 2]: work_queue.put(work) tasks = [ task("One", work_queue), task("Two", work_queue) ] # Run the tasks start_time = time.time() done = False while not done: for t in tasks: try: next(t) except StopIteration: tasks.remove(t) if len(tasks) == 0: done = True print(f"\nTotal elapsed time: &#123;time.time() - start_time:.1f&#125;")if __name__ == "__main__": main()# =&gt; Task One running# =&gt; Task One total elapsed time: 15.0# =&gt; Task Two running# =&gt; Task Two total elapsed time: 10.0# =&gt; Task One running# =&gt; Task One total elapsed time: 5.0# =&gt; Task Two running# =&gt; Task Two total elapsed time: 2.0# =&gt; Total elapsed time: 32.0 ä»Žè¾“å‡ºçš„ç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œåä½œçš„æ–¹å¼å¹¶æ²¡æœ‰åŠ é€Ÿç¨‹åºçš„è¿è¡Œã€‚æ•´ä¸ªç¨‹åºæ‰§è¡Œå®Œè€—è´¹çš„å…¨éƒ¨æ—¶é—´åˆšå¥½æ˜¯é˜»å¡žä»£ç å¼•èµ·çš„å»¶è¿Ÿæ—¶é—´ä¹‹å’Œã€‚ å››ã€éžé˜»å¡žå¼è¯·æ±‚12345678910111213141516171819202122232425262728293031323334353637383940414243import asyncioimport timeasync def task(name, work_queue): while not work_queue.empty(): delay = await work_queue.get() start_time = time.time() print(f"Task &#123;name&#125; running") await asyncio.sleep(delay) print(f"Task &#123;name&#125; total elapsed time: &#123;time.time() - start_time:.1f&#125;")async def main(): """ This is the main entry point for the program. """ # Create the queue of 'work' work_queue = asyncio.Queue() # Put some 'work' in the queue for work in [15, 10, 5, 2]: await work_queue.put(work) # Run the tasks start_time = time.time() await asyncio.gather( asyncio.create_task(task("One", work_queue)), asyncio.create_task(task("Two", work_queue)), ) print(f"\nTotal elapsed time: &#123;time.time() - start_time:.1f&#125;")if __name__ == "__main__": asyncio.run(main())# =&gt; Task One running# =&gt; Task Two running# =&gt; Task Two total elapsed time: 10.0# =&gt; Task Two running# =&gt; Task Two total elapsed time: 5.0# =&gt; Task Two running# =&gt; Task One total elapsed time: 15.0# =&gt; Task Two total elapsed time: 2.0# =&gt; Total elapsed time: 17.0 åŒä¸Šä¸€ä¸ªç‰ˆæœ¬çš„ç¨‹åºä¸åŒï¼Œæ­¤å¤„ä½¿ç”¨ await asyncio.sleep(delay) æ›¿ä»£äº†ä¹‹å‰çš„ time.sleep(delay) å’Œ yield è¯­å¥ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªéžé˜»å¡žçš„å»¶è¿Ÿå¹¶å°†ç¨‹åºæŽ§åˆ¶æƒè¿”è¿˜ç»™è°ƒç”¨è€…ï¼ˆå³ main() å‡½æ•°ï¼‰ã€‚è€Œæœ€åŽä¸€è¡Œä»£ç  asyncio.run(main()) å°†åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯ï¼ˆevent loopï¼‰ï¼Œç”¨äºŽæ‰§è¡Œ main() å‡½æ•°ä¹Ÿå°±æ˜¯ä¸¤ä¸ª task() å®žä¾‹ã€‚ äº‹ä»¶å¾ªçŽ¯æ˜¯ Python ä¸­ async æœºåˆ¶çš„æ ¸å¿ƒå†…å®¹ï¼Œå®ƒè´Ÿè´£è°ƒç”¨æ‰§è¡Œæ‰€æœ‰çš„å·¥ä½œä»£ç ã€‚å½“å…·ä½“çš„æŸä¸ªå·¥ä½œä»»åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ° await è¯­å¥æ—¶ï¼Œåˆ™ç¨‹åºå°†æŽ§åˆ¶æƒè¿”è¿˜ç»™ä¸»äº‹ä»¶å¾ªçŽ¯ã€‚åŒæ—¶äº‹ä»¶å¾ªçŽ¯æŒç»­ä¸æ–­åœ°ç›‘è§†ç€æ‰€æœ‰å·¥ä½œä»»åŠ¡çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®è§¦å‘çš„æŸä¸ªå…·ä½“äº‹ä»¶å°†ç¨‹åºæŽ§åˆ¶æƒåˆ†é…ç»™å¯¹åº”çš„å·¥ä½œä»£ç ã€‚ç”±æ­¤ä¿è¯ CPU ä¸€ç›´å¤„äºŽâ€œç´§å¼ â€çŠ¶æ€ï¼Œä¸ä¼šè¢«æŸä¸ª IO å¯†é›†åž‹æ“ä½œé˜»å¡žè€Œå¤„äºŽç­‰å¾…çŠ¶æ€ã€‚await asyncio.sleep(delay) å¯¹äºŽ CPU è€Œè¨€æ˜¯éžé˜»å¡žçš„ã€‚åœ¨å¤„ç†è¯¥ä»£ç æ—¶ï¼ŒCPU å¹¶ä¸ä¼šç­‰å¾…å»¶è¿Ÿçš„æ—¶é—´ç»“æŸï¼Œè€Œæ˜¯åœ¨äº‹ä»¶å¾ªçŽ¯çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ³¨å†Œä¸€ä¸ª sleep äº‹ä»¶ï¼Œç´§æŽ¥ç€å°†ç¨‹åºçš„æŽ§åˆ¶æƒç›´æŽ¥äº¤è¿˜ç»™äº†äº‹ä»¶å¾ªçŽ¯ï¼Œç”±äº‹ä»¶å¾ªçŽ¯ç›‘è§†å¯èƒ½ä¼šè§¦å‘çš„äº‹ä»¶ï¼ˆæ¯”å¦‚å»¶è¿Ÿç»“æŸï¼‰å¹¶åˆ†é…ä»»åŠ¡ç»™å·¥ä½œä»£ç ã€‚ äº”ã€åŒæ­¥ HTTP è¯·æ±‚ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869import queueimport requestsimport timedef task(name, work_queue): with requests.Session() as session: while not work_queue.empty(): url = work_queue.get() print(f"Task &#123;name&#125; getting URL: &#123;url&#125;") start = time.perf_counter() session.get(url) elapsed = time.perf_counter() - start print(f"Task &#123;name&#125; elapsed time: &#123;elapsed&#125;") yielddef main(): """ This is the main entry point for the program """ # Create the queue of work work_queue = queue.Queue() # Put some work in the queue for url in [ "https://www.baidu.com", "https://www.jianshu.com/", "https://www.jd.com/", "https://www.tmall.com/", "https://www.zhihu.com/", "https://www.douban.com/", "https://www.bilibili.com/", ]: work_queue.put(url) tasks = [task("One", work_queue), task("Two", work_queue)] # Run the tasks done = False start = time.perf_counter() while not done: for t in tasks: try: next(t) except StopIteration: tasks.remove(t) if len(tasks) == 0: done = True elapsed = time.perf_counter() - start print(f"Total elapsed time: &#123;elapsed&#125;")if __name__ == "__main__": main()# =&gt; Task One getting URL: https://www.baidu.com# =&gt; Task One elapsed time: 0.1149543260000001# =&gt; Task Two getting URL: https://www.jianshu.com/# =&gt; Task Two elapsed time: 0.09059067599999993# =&gt; Task One getting URL: https://www.jd.com/# =&gt; Task One elapsed time: 0.06162170499999986# =&gt; Task Two getting URL: https://www.tmall.com/# =&gt; Task Two elapsed time: 0.16310405699999975# =&gt; Task One getting URL: https://www.zhihu.com/# =&gt; Task One elapsed time: 5.111851316# =&gt; Task Two getting URL: https://www.douban.com/# =&gt; Task Two elapsed time: 0.31463871600000015# =&gt; Task One getting URL: https://www.bilibili.com/# =&gt; Task One elapsed time: 0.18364096799999974# =&gt; Total elapsed time: 6.082241783 å…­ã€å¼‚æ­¥ HTTP è¯·æ±‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162import asyncioimport aiohttpimport timeasync def task(name, work_queue): async with aiohttp.ClientSession() as session: while not work_queue.empty(): url = await work_queue.get() print(f"Task &#123;name&#125; getting URL: &#123;url&#125;") start = time.perf_counter() async with session.get(url) as response: await response.text() elapsed = time.perf_counter() - start print(f"Task &#123;name&#125; elapsed time: &#123;elapsed&#125;")async def main(): """ This is the main entry point for the program """ # Create the queue of work work_queue = asyncio.Queue() # Put some work in the queue for url in [ "https://www.baidu.com", "https://www.jianshu.com/", "https://www.jd.com/", "https://www.tmall.com/", "https://www.zhihu.com/", "https://www.douban.com/", "https://www.bilibili.com/", ]: await work_queue.put(url) # Run the tasks start = time.perf_counter() await asyncio.gather( asyncio.create_task(task("One", work_queue)), asyncio.create_task(task("Two", work_queue)), ) elapsed = time.perf_counter() - start print(f"Total elapsed time: &#123;elapsed&#125;")if __name__ == "__main__": asyncio.run(main())# =&gt; Task One getting URL: https://www.baidu.com# =&gt; Task Two getting URL: https://www.jianshu.com/# =&gt; Task One elapsed time: 0.21159282599999996# =&gt; Task One getting URL: https://www.jd.com/# =&gt; Task One elapsed time: 0.09301454900000006# =&gt; Task One getting URL: https://www.tmall.com/# =&gt; Task One elapsed time: 0.09578595199999995# =&gt; Task One getting URL: https://www.zhihu.com/# =&gt; Task Two elapsed time: 0.4948436540000001# =&gt; Task Two getting URL: https://www.douban.com/# =&gt; Task One elapsed time: 0.218484707# =&gt; Task One getting URL: https://www.bilibili.com/# =&gt; Task Two elapsed time: 0.2670722139999997# =&gt; Task One elapsed time: 0.22822054000000014# =&gt; Total elapsed time: 0.867767489 å‚è€ƒèµ„æ–™Getting Started With Async Features in Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>async</tag>
        <tag>concurency</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Web å¼€å‘ä¹‹ Django Models è¯¦è§£]]></title>
    <url>%2F2019%2F10%2F09%2Fpython-web-development-django-models%2F</url>
    <content type="text"><![CDATA[Django æ˜¯ç”± Python è¯­è¨€ç¼–å†™çš„åŸºäºŽ MVCï¼ˆå³ Model View Controllerï¼‰æž¶æž„çš„ Web å¼€å‘æ¡†æž¶ã€‚å…¶æž¶æž„ä¸­çš„æ¨¡åž‹ï¼ˆModelï¼‰ä¸»è¦è´Ÿè´£å¤„ç† Web åº”ç”¨çš„æ•°æ®é€»è¾‘éƒ¨åˆ†ï¼ŒåŒ…æ‹¬å®šä¹‰æ•°æ®å­˜å‚¨å•ä½ï¼ˆå³æ•°æ®åº“è¡¨ï¼‰çš„å­—æ®µå±žæ€§å’Œè¡Œä¸ºã€ä¸Žæ•°æ®åº“äº¤äº’ä»¥åŠå…¶ä»–ç›¸å…³è”çš„æ“ä½œã€‚é€šå¸¸ä¸€ä¸ªæ¨¡åž‹æ˜ å°„äºŽä¸€ä¸ªç‰¹å®šçš„æ•°æ®åº“è¡¨ã€‚ Django ä¸­çš„æ¨¡åž‹æœ‰ä»¥ä¸‹å‡ ä¸ªåŸºæœ¬å±žæ€§ï¼š æ¯ä¸ªæ¨¡åž‹éƒ½æ˜¯ç»§æ‰¿è‡ª django.db.models.Model ç±»çš„å­ç±» æ¨¡åž‹ç±»çš„å±žæ€§åˆ†åˆ«å¯¹åº”äºŽä¸Žä¹‹ç›¸å…³è”çš„æ•°æ®è¡¨ä¸­çš„å­—æ®µ Django ä¼šè‡ªåŠ¨ç”Ÿæˆç”¨äºŽè®¿é—®æ•°æ®åº“çš„ API ä¸€ã€åŸºæœ¬ä½¿ç”¨é¡¹ç›®åˆå§‹åŒ–åœ¨å¼€å§‹ç¼–å†™ Web åº”ç”¨ä»£ç ä¹‹å‰ï¼Œéœ€è¦å…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆå§‹åŒ–ä¸€ä¸ª Django é¡¹ç›®å¹¶åˆ›å»ºåº”ç”¨ï¼š123$ django-admin startproject myproject$ cd myproject$ python manage.py startapp myapp æœ€ç»ˆç”Ÿæˆçš„é¡¹ç›®ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š123456789101112131415myproject â”œâ”€manage.py â”‚ â”œâ”€myapp â”‚ â”œâ”€admin.py â”‚ â”œâ”€apps.py â”‚ â”œâ”€models.py â”‚ â”œâ”€tests.py â”‚ â”œâ”€views.py â”‚ â””â”€migrations â”‚ â””â”€myproject â”œâ”€settings.py â”œâ”€urls.py â””â”€wsgi.py å®šä¹‰æ¨¡åž‹ç”¨äºŽå®šä¹‰æ¨¡åž‹çš„ä»£ç é€šå¸¸ä¿å­˜åœ¨ myproject/myapp/models.py æ–‡ä»¶ä¸­ã€‚ä¸‹é¢çš„ä»£ç å³å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„ Person æ¨¡åž‹ï¼š12345from django.db import modelsclass Person(models.Model): first_name = models.CharField(max_length=30) last_name = models.CharField(max_length=30) å…¶ä¸­çš„ first_name å’Œ last_name ä¸¤ä¸ªç±»å±žæ€§å³å¯¹åº”äºŽæ•°æ®åº“è¡¨çš„ä¸¤ä¸ªå­—æ®µã€‚Person æ¨¡åž‹ä¼šä»¥å¦‚ä¸‹çš„ SQL è¯­å¥åˆ›å»ºä¸Žä¹‹å…³è”çš„æ•°æ®åº“è¡¨ï¼ˆid å­—æ®µé»˜è®¤ä¼šè‡ªåŠ¨æ·»åŠ ï¼‰ï¼š12345CREATE TABLE myapp_person ( &quot;id&quot; serial NOT NULL PRIMARY KEY, &quot;first_name&quot; varchar(30) NOT NULL, &quot;last_name&quot; varchar(30) NOT NULL); ä¸ºäº†ä½¿æ¨¡åž‹ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦å°† myapp åŒ…å«è¿› settings.py é…ç½®æ–‡ä»¶ä¸­çš„ INSTALLED_APPSï¼Œç¼–è¾‘ myproject/myproject/settings.py æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345INSTALLED_APPS = [ #... &apos;myapp&apos;, #...] ä¹‹åŽå³å¯ä½¿ç”¨ python manage.py makemigrations myapp åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼›å†è¿è¡Œ python manage.py migrate å‘½ä»¤å°†æ¨¡åž‹ä¸­å®šä¹‰çš„è¡¨ç»“æž„è¿ç§»è‡³æ•°æ®åº“ä¸­ã€‚ Django Shell æµ‹è¯•å®Œæˆæ•°æ®åº“è¿ç§»åŽï¼Œå¯ä½¿ç”¨ python manage.py shell å‘½ä»¤è¿›å…¥ Django Shell äº¤äº’å¼å‘½ä»¤è¡Œï¼Œé€šè¿‡ Django æä¾›çš„æ¨¡åž‹ API è¿›è¡Œæµ‹è¯•ï¼ˆæ’å…¥æ•°æ®ï¼‰ï¼š1234567&gt;&gt;&gt; from myapp.models import Person&gt;&gt;&gt; john = Person(first_name=&apos;John&apos;, last_name=&apos;Smith&apos;)&gt;&gt;&gt; john.save()&gt;&gt;&gt; Person.objects.all()&lt;QuerySet [&lt;Person: Person object (1)&gt;]&gt;&gt;&gt;&gt; john.first_name&apos;John&apos; è®¿é—® sqlite3 æ•°æ®åº“æŸ¥è¯¢æœ€ç»ˆç»“æžœï¼ŒJohn Smith å·²æ·»åŠ è‡³æ•°æ®è¡¨ä¸­ï¼š1234567&gt;&gt;&gt; import sqlite3&gt;&gt;&gt; conn = sqlite3.connect(&apos;db.sqlite3&apos;)&gt;&gt;&gt; cursor = conn.cursor()&gt;&gt;&gt; cursor.execute(&apos;select * from myapp_person&apos;)&lt;sqlite3.Cursor object at 0x0000022C36ADBD50&gt;&gt;&gt;&gt; print(cursor.fetchone())(1, &apos;John&apos;, &apos;Smith&apos;) äºŒã€å­—æ®µï¼ˆFieldï¼‰æ¨¡åž‹ä¸­æœ€é‡è¦çš„ä¹Ÿæ˜¯å”¯ä¸€å¿…é¡»å­˜åœ¨çš„é¡¹ç›®å°±æ˜¯å­—æ®µï¼Œå®ƒç”±æ¨¡åž‹ç±»çš„å±žæ€§å®šä¹‰ï¼Œç”¨æ¥è¡¨è¿°ä¸Žæ¨¡åž‹ç›¸å…³è”çš„æ•°æ®è¡¨çš„ç»“æž„ã€‚ å­—æ®µçš„ç±»åž‹ä¸Žé€‰é¡¹æ¨¡åž‹ä¸­çš„æ¯ä¸ªå­—æ®µéƒ½æ˜¯ django.db.models.Field ç±»çš„å®žä¾‹ï¼Œå¯¹åº”äºŽæ•°æ®åº“è¡¨ä¸­çš„åˆ—ã€‚Django å†…ç½®äº†å¤§é‡çš„å­—æ®µç±»åž‹ï¼Œå¦‚ CharFieldï¼ŒTextField å’Œ DateTimeField ç­‰ã€‚å…·ä½“å¯æŸ¥çœ‹ æ¨¡åž‹å­—æ®µå‚è€ƒã€‚ æ¯ä¸ªå­—æ®µéƒ½å¯ä»¥æŽ¥æ”¶ç‰¹å®šçš„å­—æ®µç›¸å…³çš„å‚æ•°ï¼Œæ¯”å¦‚ CharField éœ€è¦ä¼ å…¥ max_length ç”¨äºŽå®šä¹‰ VARCHAR ç±»åž‹çš„å­—ç¬¦é•¿åº¦ã€‚ æ­¤å¤–è¿˜æœ‰ä¸€äº›é€šç”¨çš„å¯é€‰çš„å­—æ®µé€‰é¡¹ã€‚å¦‚ï¼š nullï¼šå¦‚ä¸º Trueï¼Œåˆ™ Django ä¼šå°†ç©ºå€¼åœ¨æ•°æ®åº“ä¸­å­˜ä¸º NULLã€‚è¯¥é€‰é¡¹é»˜è®¤ä¸º Falseã€‚ blankï¼šå¦‚ä¸º Trueï¼Œåˆ™è¯¥å­—æ®µå…è®¸ä¸ºç©ºã€‚ä¸Ž null é€‰é¡¹ä¸åŒï¼Œblank æ˜¯ä¸Žè¡¨å•éªŒè¯ç›¸å…³çš„ï¼Œè€Œ null æ˜¯æ•°æ®åº“ç›¸å…³çš„ã€‚ defaultï¼šç”¨äºŽè®¾ç½®å­—æ®µçš„é»˜è®¤å€¼ã€‚ primary_keyï¼šç”¨äºŽè®¾ç½®æ¨¡åž‹çš„ä¸»é”®ã€‚å¦‚æœªæŒ‡å®šä»»ä½•å­—æ®µä¸ºä¸»é”®ï¼Œåˆ™ Django ä¼šè‡ªåŠ¨æ·»åŠ  IntegerField å­—æ®µä½œä¸ºä¸»é”®ã€‚ uniqueï¼šè®¾ç½®å­—æ®µçš„å€¼æ˜¯å¦å…è®¸é‡å¤ã€‚ PSï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒDjango ä¼šç»™æ¯ä¸ªæ¨¡åž‹æ·»åŠ å¦‚ä¸‹å­—æ®µid = models.AutoField(primary_key=True)ä½œä¸ºä¸ºè‡ªå¢žçš„ä¸»é”®ã€‚å¦‚æžœæƒ³è¦†ç›–æ­¤é»˜è®¤è¡Œä¸ºï¼Œç›´æŽ¥æ‰‹åŠ¨æŒ‡å®šå…¶ä»–å­—æ®µä¸ºä¸»é”®ï¼ˆprimary_key=Trueï¼‰å³å¯ã€‚ å…³ç³»é¢ï¼Œå…³ç³»åž‹æ•°æ®åº“çš„å¼ºå¤§ä¹‹å¤„å³åœ¨äºŽå„æ•°æ®åº“è¡¨ä¹‹é—´çš„ç›¸äº’å…³è”ã€‚Django æ”¯æŒå®šä¹‰ä¸‰ç§æœ€å¸¸è§çš„æ•°æ®åº“å…³ç³»ï¼šå¤šå¯¹ä¸€ã€å¤šå¯¹å¤šå’Œä¸€å¯¹ä¸€ã€‚ å¯ä»¥é€šè¿‡ django.db.models.ForeignKey åˆ›å»ºå¤šå¯¹ä¸€å…³ç³»ï¼Œåªéœ€è¦åƒå®šä¹‰å…¶ä»–å­—æ®µé‚£æ ·å°†å®ƒä½œä¸ºç±»å±žæ€§å¼•å…¥å³å¯ã€‚å¦‚ï¼š123456789from django.db import modelsclass Manufacturer(models.Model): name = models.CharField(max_length=20) location = models.CharField(max_length=40)class Car(models.Model): manufacturer = models.ForeignKey(Manufacturer, on_delete=models.CASCADE) price = models.IntegerField() è¿è¡Œ python manage.py makemigrations å‘½ä»¤åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼š12345$ python manage.py makemigrations myappMigrations for &apos;myapp&apos;: myapp/migrations/0001_initial.py - Create model Manufacturer - Create model Car ä½¿ç”¨ python manage.py sqlmigrate myapp 0001 å‘½ä»¤æŸ¥çœ‹å…·ä½“ä¼šæ‰§è¡Œå“ªäº› SQL è¯­å¥ï¼ˆåŸºäºŽ sqlite3ï¼‰ï¼š123456789101112$ python manage.py sqlmigrate myapp 0001BEGIN;---- Create model Manufacturer--CREATE TABLE &quot;myapp_manufacturer&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;name&quot; varchar(20) NOT NULL, &quot;location&quot; varchar(40) NOT NULL);---- Create model Car--CREATE TABLE &quot;myapp_car&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;price&quot; integer NOT NULL, &quot;manufacturer_id&quot; integer NOT NULL REFERENCES &quot;myapp_manufacturer&quot; (&quot;id&quot;) DEFERRABLE INITIALLY DEFERRED);CREATE INDEX &quot;myapp_car_manufacturer_id_2be676ab&quot; ON &quot;myapp_car&quot; (&quot;manufacturer_id&quot;);COMMIT; å¤šå¯¹å¤šå’Œä¸€å¯¹ä¸€çš„æ•°æ®åº“å…³ç³»åˆ™åˆ†åˆ«å¯ä»¥ä½¿ç”¨ ManyToManyField å’Œ OneToOneField å®šä¹‰ã€‚ ä¸‰ã€æ¨¡åž‹çš„å±žæ€§ä¸Žæ–¹æ³•Meta é€‰é¡¹æ¨¡åž‹çš„ Meta é€‰é¡¹åœ¨æ¨¡åž‹ç±»çš„å®šä¹‰ä¸­æ˜¯å¯é€‰çš„ï¼Œå®ƒåŸºæœ¬ä¸ŠåŒ…å«äº†é™¤å­—æ®µä»¥å¤–çš„æ‰€æœ‰å†…å®¹ã€‚æ¯”å¦‚æ•°æ®çºªå½•çš„é¡ºåºï¼ˆorderingï¼‰ã€å…³è”çš„æ•°æ®åº“è¡¨çš„åç§°ï¼ˆdb_tableï¼‰å’Œç´¢å¼•ï¼ˆindexesï¼‰ç­‰ã€‚ Django æ¨¡åž‹æ”¯æŒçš„æ‰€æœ‰ Meta é€‰é¡¹å¯ä»¥å‚è€ƒ Model Meta options ç¤ºä¾‹ä»£ç ï¼š12345678from django.db import modelsclass Ox(models.Model): horn_length = models.IntegerField() class Meta: ordering = [&quot;horn_length&quot;] verbose_name_plural = &quot;oxen&quot; è‡ªå®šä¹‰æ¨¡åž‹æ–¹æ³•åœ¨æ¨¡åž‹ä¸­åˆ›å»ºè‡ªå®šä¹‰æ–¹æ³•å¯ä»¥ä¸ºæ¨¡åž‹å¯¹è±¡æ·»åŠ ä¸ªæ€§åŒ–çš„â€œåº•å±‚â€åŠŸèƒ½ã€‚å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š1234567891011from django.db import modelsclass Person(models.Model): first_name = models.CharField(max_length=50) last_name = models.CharField(max_length=50) birth_date = models.DateField() @property def full_name(self): &quot;Returns the person&apos;s full name.&quot; return &apos;%s %s&apos; % (self.first_name, self.last_name) æ­¤æ—¶çš„ Person æ¨¡åž‹é™¤äº†å¯ä»¥ä»Žæ•°æ®åº“ä¸­è¯»å–å’Œå†™å…¥æ•°æ®ç­‰åŸºæœ¬åŠŸèƒ½å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡å®ƒè°ƒç”¨è‡ªå®šä¹‰çš„ full_name æ–¹æ³•å®Œæˆé¢å¤–çš„éœ€æ±‚ï¼ˆè¿”å›žå…¨åï¼‰ã€‚ è¦†ç›–é»˜è®¤çš„æ¨¡åž‹æ–¹æ³•æœ‰äº›æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹æ¨¡åž‹å†…ç½®çš„æ–¹æ³•ï¼Œæ”¹å˜æ¨¡åž‹ä¸Žæ•°æ®åº“çš„å…·ä½“äº¤äº’æ–¹å¼ã€‚å°¤å…¶æ˜¯ save() ï¼ˆå‘æ•°æ®åº“ä¸­å­˜å…¥æ•°æ®ï¼‰å’Œ delete() ï¼ˆä»Žæ•°æ®åº“ä¸­åˆ é™¤çºªå½•ï¼‰ç­‰æ–¹æ³•ã€‚å¦‚ï¼š123456789101112131415from django.db import modelsclass Person(models.Model): first_name = models.CharField(max_length=50) last_name = models.CharField(max_length=50) def save(self, *args, **kwargs): self.first_name = self.first_name.capitalize() self.last_name = self.last_name.capitalize() super().save(*args, **kwargs) @property def full_name(self): &quot;Returns the person&apos;s full name.&quot; return &apos;%s %s&apos; % (self.first_name, self.last_name) é‡æ–°è¿ç§»æ•°æ®åº“ï¼Œè¿›å…¥ Django Shell æµ‹è¯•ï¼Œç»“æžœå¦‚ä¸‹ï¼š1234567&gt;&gt;&gt; from myapp.models import Person&gt;&gt;&gt; john = Person(first_name=&apos;john&apos;, last_name=&apos;smith&apos;)&gt;&gt;&gt; john.save()&gt;&gt;&gt; john&lt;Person: Person object (2)&gt;&gt;&gt;&gt; john.full_name&apos;John Smith&apos; å››ã€æ•°æ®åº“æ“ä½œä¸€æ—¦åˆ›å»ºäº†æ•°æ®æ¨¡åž‹ï¼ŒDjango å³ä¼šè‡ªåŠ¨ç”Ÿæˆä¸Žæ•°æ®åº“äº¤äº’çš„ API ä¾›ç”¨æˆ·åˆ›å»ºã€èŽ·å–ã€æ›´æ–°å’Œåˆ é™¤æ•°æ®å¯¹è±¡ã€‚ æ­¤å¤„å…ˆåˆ›å»ºå¦‚ä¸‹çš„æ¨¡åž‹æ–‡ä»¶ä¾›æµ‹è¯•ä½¿ç”¨ï¼š1234567891011121314151617181920212223242526272829from django.db import modelsclass Blog(models.Model): name = models.CharField(max_length=100) tagline = models.TextField() def __str__(self): return self.nameclass Author(models.Model): name = models.CharField(max_length=200) email = models.EmailField() def __str__(self): return self.nameclass Entry(models.Model): blog = models.ForeignKey(Blog, on_delete=models.CASCADE) headline = models.CharField(max_length=255) body_text = models.TextField() pub_date = models.DateField() mod_date = models.DateField() authors = models.ManyToManyField(Author) n_comments = models.IntegerField() n_pingbacks = models.IntegerField() rating = models.IntegerField() def __str__(self): return self.headline Insertå¯ä»¥é€šè¿‡å®žä¾‹åŒ–æ¨¡åž‹ç±»åˆ›å»ºä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶ save() æ–¹æ³•å°†å¯¹åº”çš„è®°å½•æ’å…¥ï¼ˆæ‰§è¡Œ INSERT SQL è¯­å¥ï¼‰åˆ°æ•°æ®åº“è¡¨ä¸­ã€‚123456789&gt;&gt;&gt; from myapp.models import Blog&gt;&gt;&gt; b = Blog(name=&apos;Beatles Blog&apos;, tagline=&apos;All the latest Beatles news&apos;)&gt;&gt;&gt; b.save()&gt;&gt;&gt; b.name = &apos;Beatles Blog All&apos;&gt;&gt;&gt; b.save()&gt;&gt;&gt; b&lt;Blog: Beatles Blog All&gt;&gt;&gt;&gt; b.tagline&apos;All the latest Beatles news&apos; æ’å…¥ ForeignKey ä¸Ž ManyToManyFieldæ›´æ–° ForeignKey ä¸Žæ“ä½œæ™®é€šå­—æ®µçš„æ–¹å¼ç›¸åŒï¼Œå°†æ­£ç¡®ç±»åž‹çš„å¯¹è±¡èµ‹å€¼ç»™å¯¹åº”å­—æ®µå¹¶è°ƒç”¨ save() æ–¹æ³•å³å¯ã€‚å¦‚ï¼š12345&gt;&gt;&gt; from blog.models import Blog, Entry&gt;&gt;&gt; entry = Entry.objects.get(pk=1)&gt;&gt;&gt; cheese_blog = Blog.objects.get(name=&quot;Cheddar Talk&quot;)&gt;&gt;&gt; entry.blog = cheese_blog&gt;&gt;&gt; entry.save() æ›´æ–° ManyToManyField çš„æ–¹å¼ç¨æœ‰ä¸åŒï¼Œéœ€è¦ä½¿ç”¨ add() æ–¹æ³•ï¼š123&gt;&gt;&gt; from blog.models import Author&gt;&gt;&gt; joe = Author.objects.create(name=&quot;Joe&quot;)&gt;&gt;&gt; entry.authors.add(joe) èŽ·å–æ•°æ®ä»Žæ•°æ®åº“ä¸­èŽ·å–æ•°æ®ä¼šç”Ÿæˆä¸€ä¸ª QuerySet å¯¹è±¡ï¼Œå®ƒä»£è¡¨ä»Žæ•°æ®åº“ä¸­å–å‡ºçš„æ•°æ®å¯¹è±¡çš„é›†åˆã€‚QuerySet ç­‰åŒäºŽæ•°æ®åº“ä¸­çš„ SELECT è¯­å¥ï¼Œå®ƒå¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ª filter ã€‚filter å¯¹åº”äºŽæ•°æ®åº“ä¸­çš„ç­›é€‰æ¡ä»¶å¦‚ WHERE æˆ– LIMIT ç­‰ã€‚ èŽ·å–å•ä¸ªå¯¹è±¡&gt;&gt;&gt; one_entry = Entry.objects.get(pk=1) PSï¼špk å³ primary key ã€‚ èŽ·å–æ‰€æœ‰å¯¹è±¡&gt;&gt;&gt; all_entries = Entry.objects.all() åº”ç”¨ç­›é€‰å™¨&gt;&gt;&gt; entry = Entry.objects.filter(pub_date__year=2006) Limiting&gt;&gt;&gt; entries = Entry.objects.all()[:5] æŽ’åº&gt;&gt;&gt; entry = Entry.objects.order_by(&#39;headline&#39;)[0] å­—æ®µæŸ¥è¯¢å­—æ®µæŸ¥è¯¢å¯¹åº”äºŽ SQL ä¸­çš„ WHERE è¯­å¥ï¼Œå¯ä»¥é€šè¿‡å‘ QuerySet å¯¹è±¡çš„æ–¹æ³• filter()ã€exclude() å’Œ get() ä¸­ä¼ å…¥ç‰¹å®šçš„å‚æ•°æ¥å®žçŽ°ã€‚åŸºæœ¬çš„æŸ¥è¯¢å‚æ•°è¯­æ³•å¦‚ä¸‹ï¼šfield__lookuptype=value ã€‚ å¦‚ï¼š&gt;&gt;&gt; Entry.objects.filter(pub_date__lte=&#39;2006-01-01&#39;)ç­‰åŒäºŽï¼šSELECT * FROM blog_entry WHERE pub_date &lt;= &#39;2006-01-01&#39;; å…¶ä¸­ lte å³ less or equalï¼ˆå°äºŽç­‰äºŽï¼‰ã€‚å…¶ä»–ç±»ä¼¼çš„ lookuptype è¿˜åŒ…æ‹¬ gtï¼ˆå¤§äºŽï¼‰ã€gteï¼ˆå¤§äºŽç­‰äºŽï¼‰ã€ltï¼ˆå°äºŽï¼‰ã€exactã€iexactï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ã€startswithã€istartswithã€endswithã€iendswithã€containsã€rangeï¼ˆæŒ‡å®šèŒƒå›´ï¼‰ã€regexï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€iregex ç­‰ã€‚ ä»¥ä¸‹ä¸ºä¸€äº›å¸¸è§çš„ä½¿ç”¨ç¤ºä¾‹ï¼š exactï¼š&gt;&gt;&gt; Entry.objects.get(headline__exact=&quot;Cat bites dog&quot;)ç­‰äºŽ SELECT ... WHERE headline = &#39;Cat bites dog&#39;; iexactï¼š&gt;&gt;&gt; Blog.objects.get(name__iexact=&quot;beatles blog&quot;)ç­‰äºŽ SELECT ... WHERE name ILIKE &#39;beatles blog&#39;; startswithï¼š&gt;&gt;&gt; Entry.objects.filter(headline__startswith=&#39;Lennon&#39;)ç­‰äºŽ SELECT ... WHERE headline LIKE &#39;Lennon%&#39;; containsï¼š&gt;&gt;&gt; Entry.objects.get(headline__contains=&#39;Lennon&#39;)ç­‰äºŽ SELECT ... WHERE headline LIKE &#39;%Lennon%&#39;; inï¼š&gt;&gt;&gt; Entry.objects.filter(id__in=[1, 3, 4])ç­‰äºŽ SELECT ... WHERE id IN (1, 3, 4); rangeï¼š 1234import datetimestart_date = datetime.date(2005, 1, 1)end_date = datetime.date(2005, 3, 31)Entry.objects.filter(pub_date__range=(start_date, end_date)) ç­‰äºŽ SELECT ... WHERE pub_date BETWEEN &#39;2005-01-01&#39; and &#39;2005-03-31&#39;; ManagerManager æ˜¯æä¾›ç»™ Django æ¨¡åž‹ï¼Œç”¨äºŽåšæ•°æ®åº“æŸ¥è¯¢æ“ä½œçš„æŽ¥å£ã€‚Django é¡¹ç›®ä¸­çš„æ¯ä¸€ä¸ªæ¨¡åž‹éƒ½éœ€è¦è‡³å°‘åŒ…å«ä¸€ä¸ª Manager å¯¹è±¡ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒDjango ä¼šåœ¨æ¯ä¸€ä¸ªæ¨¡åž‹ç±»ä¸­æ·»åŠ ä¸€ä¸ªåä¸º objects çš„ Manager ã€‚é€šè¿‡å°† models.Manager() èµ‹å€¼ç»™é™¤ objects ä»¥å¤–çš„ç±»å±žæ€§ï¼Œå¯ä»¥è¦†ç›–æ­¤é»˜è®¤è¡Œä¸ºï¼š12345from django.db import modelsclass Person(models.Model): #... people = models.Manager() æ­¤æ—¶ Person.objects.all() æŸ¥è¯¢è¯­å¥ä¼šæŠ¥å‡º AttributeError é”™è¯¯ï¼Œè€Œ Person.people.all() åˆ™è¿”å›žæ‰€æœ‰çš„ Person å¯¹è±¡ã€‚ è‡ªå®šä¹‰ Managerè‡ªå®šä¹‰çš„ Manager æ–¹æ³•å¯ä»¥å‘æ¨¡åž‹ä¸­æ·»åŠ è¡¨çº§åˆ«çš„æŸ¥è¯¢åŠŸèƒ½ã€‚ä¸Žä¹‹å¯¹åº”çš„çºªå½•çº§åˆ«çš„åŠŸèƒ½åˆ™éœ€è¦ä½¿ç”¨æ¨¡åž‹æ–¹æ³•ã€‚ å¦‚ï¼š123456789101112# First, define the Manager subclass.class DahlBookManager(models.Manager): def get_queryset(self): return super().get_queryset().filter(author=&apos;Roald Dahl&apos;)# Then hook it into the Book model explicitly.class Book(models.Model): title = models.CharField(max_length=100) author = models.CharField(max_length=50) objects = models.Manager() # The default manager. dahl_objects = DahlBookManager() # The Dahl-specific manager. ä»¥ä¸Šé¢çš„æ¨¡åž‹ä¸ºä¾‹ï¼ŒBook.objects.all() ä¼šè¿”å›žæ•°æ®åº“ä¸­æ‰€æœ‰çš„ä¹¦ç±ä¿¡æ¯ï¼Œè€Œ Book.dahl_objects.all() åˆ™ä¼šè¿”å›žæ‰€æœ‰ä½œè€…ä¸º Roald Dahl çš„ä¹¦ç±ã€‚Django å…è®¸å‘æ¨¡åž‹ä¸­æ·»åŠ ä»»æ„æ•°é‡çš„ Manager() å®žä¾‹ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥ä¸ºæ¨¡åž‹å®šä¹‰ä¸€äº›é€šç”¨çš„ç­›é€‰å™¨ã€‚å¦‚ï¼š123456789101112131415class AuthorManager(models.Manager): def get_queryset(self): return super().get_queryset().filter(role=&apos;A&apos;)class EditorManager(models.Manager): def get_queryset(self): return super().get_queryset().filter(role=&apos;E&apos;)class Person(models.Model): first_name = models.CharField(max_length=50) last_name = models.CharField(max_length=50) role = models.CharField(max_length=1, choices=[(&apos;A&apos;, _(&apos;Author&apos;)), (&apos;E&apos;, _(&apos;Editor&apos;))]) people = models.Manager() authors = AuthorManager() editors = EditorManager() åˆ™ Person.people.all()ã€Person.authors.all() å’Œ Person.editors.all() éƒ½å¯ä»¥ä½œä¸ºä»Žæ¨¡åž‹ä¸­èŽ·å–æ•°æ®çš„æŽ¥å£ï¼Œä¸” authors ä¸Ž editors å·²é¢„å…ˆæ ¹æ® role å¯¹æ•°æ®è¿›è¡Œäº†ç­›é€‰ã€‚ å‚è€ƒèµ„æ–™Django 2.2 å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Django</tag>
        <tag>MVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹ç±»ä¸Žé¢å‘å¯¹è±¡ç¼–ç¨‹]]></title>
    <url>%2F2019%2F09%2F23%2Fpro-python-class-and-oop%2F</url>
    <content type="text"><![CDATA[ä¸€ã€ç±»çš„å®šä¹‰Python è¯­è¨€ä¸­çš„ç±»å®žé™…ä¸Šæ˜¯ä¸€ç§æ•°æ®ç±»åž‹ï¼ŒåŒæ—¶ Python ä¸­æ‰€æœ‰å†…ç½®çš„æ•°æ®ç±»åž‹ä¹Ÿéƒ½æ˜¯ç”±ç±»å®šä¹‰çš„ã€‚123456&gt;&gt;&gt; type(10)&lt;class &apos;int&apos;&gt;&gt;&gt;&gt; type(&apos;10&apos;)&lt;class &apos;str&apos;&gt;&gt;&gt;&gt; type([10,11,12])&lt;class &apos;list&apos;&gt; å¯ä»¥ä½¿ç”¨ class å…³é”®å­—å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š12class MyClass: pass ä½¿ç”¨èµ‹å€¼çš„å½¢å¼å®žä¾‹åŒ–æŸä¸ªç±»ï¼Œæ ¼å¼å¦‚ä¸‹ï¼šinstance = MyClass()å³åˆ›å»ºä¸€ä¸ªä»¥ MyClass ç±»ä¸ºæ•°æ®ç±»åž‹çš„æ–°å¯¹è±¡ instance ã€‚ å®žä¾‹å˜é‡Python ä¸­çš„ç±»å®žä¾‹å¯ä»¥ä½œä¸ºç±»ä¼¼äºŽ struct çš„æ•°æ®ç±»åž‹å­˜å‚¨æ•°æ®æˆ–è®°å½•ï¼Œä¸”ä¸åŒäºŽ C æˆ– Java è¯­è¨€ä¸­çš„ç±»ä¼¼ç»“æž„ï¼Œå…³è”äºŽç±»å®žä¾‹çš„æ•°æ®ä¸éœ€è¦æå‰å£°æ˜Žã€‚12345678class Circle: passmy_circle = Circle()my_circle.radius = 4print(2 * 3.14 * my_circle.radius)# =&gt; 25.12 å¯ä»¥é€šè¿‡åœ¨ç±»çš„å®šä¹‰ä»£ç ä¸­æ·»åŠ  __init__ æ–¹æ³•æ¥åˆå§‹åŒ–å®žä¾‹ä¸­çš„æŸäº›æ•°æ®ã€‚æ¯å½“æ–°çš„ç±»å®žä¾‹åˆ›å»ºæ—¶ï¼Œ__init__ æ–¹æ³•éƒ½ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œç±»ä¼¼äºŽ Java ä¸­çš„æž„é€ å™¨ã€‚å…¶ç¬¬ä¸€ä¸ªå‚æ•° self ç”¨æ¥æŒ‡ä»£æ–°çš„ç±»å®žä¾‹æœ¬èº«ã€‚12345678class Circle: def __init__(self): self.radius = 1my_circle = Circle()print(2 * 3.14 * my_circle.radius)# =&gt; 6.28 ä¸Šé¢ä»£ç ä¸­çš„ radius å³ä¸º Circle ç±»çš„å®žä¾‹å˜é‡ï¼Œæ¯ä¸€ä¸ªç”± Circle ç±»ç”Ÿæˆçš„å®žä¾‹å¯¹è±¡ï¼ˆå¦‚ä¸Šé¢ä»£ç ä¸­çš„ my_circleï¼‰éƒ½åŒ…å«ä¸€ä»½ç‹¬æœ‰çš„ radius å˜é‡ã€‚åˆ›å»ºå®žä¾‹å˜é‡çš„è¯­æ³•å¦‚ä¸‹ï¼šinstance.variable = value ç±»å˜é‡ç±»å˜é‡æ˜¯å…³è”äºŽæŸä¸ªç±»çš„å˜é‡ï¼ˆè€Œä¸æ˜¯æŸä¸ªç±»å®žä¾‹ï¼‰ï¼Œå¯ä»¥è¢«æ‰€æœ‰çš„ç±»å®žä¾‹è®¿é—®ï¼Œå› æ­¤å¸¸ç”¨æ¥è¿½è¸ªæŸäº›ç±»çº§åˆ«çš„ä¿¡æ¯ã€‚ç±»å˜é‡å¯ä»¥é€šè¿‡ç±»ç»“æž„ä½“ä¸­çš„èµ‹å€¼è¯­å¥è¿›è¡Œåˆ›å»ºï¼ˆè€Œç±»çš„å®žä¾‹å˜é‡éœ€è¦åœ¨ __init__ æ–¹æ³•ä¸­å®šä¹‰ï¼‰ã€‚123456789101112class Circle: pi = 3.14159 def __init__(self, radius): self.radius = radius def area(self): return self.radius * self.radius * Circle.piprint(Circle.pi) # =&gt; 3.14159Circle.pi = 4c = Circle(3)print(c.area()) # =&gt; 36 äºŒã€æ–¹æ³•æ–¹æ³•æ˜¯æŒ‡ä¸Žç‰¹å®šçš„ç±»å¯¹è±¡ç›¸å…³è”çš„å‡½æ•°ï¼Œæ¯”å¦‚å‰é¢çš„ __init__ æ–¹æ³•ã€‚å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š123456789101112class Circle: def __init__(self): self.radius = 1 def area(self): return self.radius * self.radius * 3.14159c = Circle()c.radius = 3print(c.area())# =&gt; 28.27431 ä¸Šé¢ä»£ç ä¸­çš„ area æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä»ä¸º selfï¼Œå®ƒç±»ä¼¼äºŽå¾ˆå¤šè¯­è¨€ä¸­çš„ this å…³é”®å­—ï¼Œç”¨äºŽæŒ‡ä»£ç”±ç±»ç”Ÿæˆçš„å®žä¾‹å¯¹è±¡æœ¬èº«ã€‚ ç±»çš„æ–¹æ³•å®šä¹‰ä¸­å¯ä»¥æ·»åŠ é™¤ self ä»¥å¤–çš„å…¶ä»–å‚æ•°ï¼Œæ¯”å¦‚å¯ä»¥ä¸º __init__ æ–¹æ³•å…³è”ä¸€ä¸ª radius å‚æ•°ï¼Œåœ¨å®žä¾‹åŒ–ç±»çš„åŒæ—¶ç›´æŽ¥åˆå§‹åŒ–ä¸€ä¸ª radius å˜é‡ï¼Œè€Œä¸å¿…åœ¨ç±»å®žä¾‹åˆ›å»ºä»¥åŽæ‰‹åŠ¨è¿›è¡Œé¢å¤–çš„èµ‹å€¼æ“ä½œã€‚1234567891011class Circle: def __init__(self, radius=1): self.radius = radius def area(self): return self.radius * self.radius * 3.14159c = Circle(3)print(c.area())# =&gt; 28.27431 ä¸‰ã€é™æ€æ–¹æ³•ä¸Žç±»æ–¹æ³•é™æ€æ–¹æ³•Python è¯­è¨€å¯ä»¥é€šè¿‡ @staticmethod è£…é¥°å™¨åˆ›å»ºç±»ä¸­çš„é™æ€æ–¹æ³•ã€‚é™æ€æ–¹æ³•ä¸å¸¦ self å‚æ•°ï¼Œå³è°ƒç”¨æ—¶ä¸éœ€è¦å…ˆå¯¹ç±»è¿›è¡Œå®žä¾‹åŒ–ï¼Œä¸é€šè¿‡ç±»çš„å®žä¾‹å¯¹è±¡è¿›è¡Œè°ƒç”¨ã€‚å®ƒå¯ä»¥æ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œå¯ç›´æŽ¥é€šè¿‡ç±»åè°ƒç”¨ã€‚1234567891011121314151617181920class Circle: all_circles = [] pi = 3.14159 def __init__(self, r=1): self.radius = r self.__class__.all_circles.append(self) def area(self): return self.__class__.pi * self.radius * self.radius @staticmethod def total_area(): total = 0 for c in Circle.all_circles: total = total + c.area() return totalc1 = Circle(1)c2 = Circle(2)print(Circle.total_area())# =&gt; 15.70795 ç±»æ–¹æ³•å¯ä»¥ä½¿ç”¨ @classmethod è£…é¥°å™¨åˆ›å»º Python ç±»ä¸­çš„ç±»æ–¹æ³•ã€‚ç±»æ–¹æ³•é»˜è®¤æœ‰ä¸ª cls å‚æ•°ï¼ˆè¡¨ç¤ºç±»æœ¬èº«ï¼‰ï¼Œå¯ä»¥è¢«ç±»å’Œå®žä¾‹è°ƒç”¨ã€‚123456789101112131415161718192021class Circle: all_circles = [] pi = 3.14159 def __init__(self, r=1): self.radius = r self.__class__.all_circles.append(self) def area(self): return self.__class__.pi * self.radius * self.radius @classmethod def total_area(cls): total = 0 for c in cls.all_circles: total = total + c.area() return totalc1 = Circle(1)c2 = Circle(2)print(Circle.total_area())# =&gt; 15.70795 PSï¼šå…³äºŽå®žä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ä¸Žé™æ€æ–¹æ³•çš„ç®€è¦å¯¹æ¯” å®žä¾‹æ–¹æ³• å®šä¹‰ï¼šç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯å®žä¾‹å¯¹è±¡ï¼Œä¸€èˆ¬çº¦å®šä¸º selfï¼Œé€šè¿‡å®ƒæ¥ä¼ é€’å®žä¾‹çš„å±žæ€§å’Œæ–¹æ³•ï¼ˆä¹Ÿå¯ä»¥ä¼ ç±»çš„å±žæ€§å’Œæ–¹æ³•ï¼‰ è°ƒç”¨ï¼šåªèƒ½ç”±å®žä¾‹å¯¹è±¡è°ƒç”¨ ç±»æ–¹æ³• å®šä¹‰ï¼šä½¿ç”¨è£…é¥°å™¨ @classmethodã€‚ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯å½“å‰ç±»å¯¹è±¡ï¼Œä¸€èˆ¬çº¦å®šä¸º clsï¼Œé€šè¿‡å®ƒæ¥ä¼ é€’ç±»çš„å±žæ€§å’Œæ–¹æ³•ï¼ˆä¸èƒ½ä¼ å®žä¾‹çš„å±žæ€§å’Œæ–¹æ³•ï¼‰ è°ƒç”¨ï¼šå®žä¾‹å¯¹è±¡å’Œç±»å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ é™æ€æ–¹æ³• å®šä¹‰ï¼šä½¿ç”¨è£…é¥°å™¨ @staticmethodã€‚å‚æ•°éšæ„ï¼Œæ²¡æœ‰ self å’Œ cls å‚æ•°ï¼Œæ–¹æ³•ä½“ä¸­ä¸èƒ½ä½¿ç”¨ç±»æˆ–å®žä¾‹çš„ä»»ä½•å±žæ€§å’Œæ–¹æ³• è°ƒç”¨ï¼šå®žä¾‹å¯¹è±¡å’Œç±»å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ å››ã€ç»§æ‰¿12345678910111213141516171819202122class Shape: def __init__(self, x, y): self.x = x self.y = y def move(self, delta_x, delta_y): self.x = self.x + delta_x self.y = self.y + delta_yclass Square(Shape): def __init__(self, side=1, x=0, y=0): super().__init__(x, y) self.side = sideclass Circle(Shape): def __init__(self, r=1, x=0, y=0): super().__init__(x, y) self.radius = rc = Circle(1)c.move(3, 4)print(c.x) # =&gt; 3print(c.y) # =&gt; 4 å…¶ä¸­ super å‡½æ•°ç”¨äºŽåœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»å®šä¹‰çš„æ–¹æ³•ã€‚çˆ¶ç±» Shape ä¸­å®šä¹‰çš„ move æ–¹æ³•å¯ä»¥ç›´æŽ¥è¢«å­ç±»å®žä¾‹åŒ–åŽçš„å¯¹è±¡ä½¿ç”¨ã€‚ä»Žä¼ ç»Ÿçš„ OOP æ¦‚å¿µæ¥çœ‹ï¼Œå³ Python ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œå¦‚æŸä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•åœ¨å½“å‰çš„ç±»ä¸­ä¸å­˜åœ¨ï¼Œåˆ™ Python ä¼šå°è¯•ä»Žå®ƒçš„çˆ¶ç±»ä¸­å¯»æ‰¾åŒåçš„æ–¹æ³•ï¼Œæœ€ç»ˆä½¿ç”¨ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ç»“æžœã€‚ äº”ã€ç§æœ‰å˜é‡ç§æœ‰å˜é‡å’Œç§æœ‰æ–¹æ³•æ˜¯æŒ‡åœ¨ç±»ä¸­å®šä¹‰ä¸”åœ¨ç±»å¤–ä¸å¯è§çš„å¯¹è±¡ã€‚åœ¨ Python è¯­è¨€ä¸­ï¼Œåç§°å‰é¢å¸¦åŒä¸‹åˆ’çº¿ï¼ˆ__ï¼‰çš„å˜é‡æˆ–æ–¹æ³•å³ä¸ºç§æœ‰ã€‚ 1234567891011class Mine: def __init__(self): self.x = 2 self.__y = 3 def print_y(self): print(self.__y)m = Mine()print(m.x) # =&gt; 2m.print_y() # =&gt; 3print(m.__y) # =&gt; AttributeError: &apos;Mine&apos; object has no attribute &apos;__y&apos; ä¸Šé¢ä»£ç ä¸­çš„ __y å˜é‡å³ä¸ºç§æœ‰å˜é‡ï¼Œå› æ­¤å½“ç›´æŽ¥ä»Žç±»å¤–éƒ¨è®¿é—® __y æ—¶ä¼šæŠ¥å‡º AttributeError é”™è¯¯ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç±»å†…éƒ¨å®šä¹‰çš„ print_y æ–¹æ³•ï¼ˆéžç§æœ‰æ–¹æ³•ï¼‰æ“ä½œ __y å˜é‡ã€‚ @propertyPython å…è®¸ç”¨æˆ·ç›´æŽ¥è®¿é—®å®žä¾‹å˜é‡ï¼Œè€Œä¸éœ€è¦ç±»ä¼¼äºŽ Java æˆ–å…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„ getter æˆ– setter æœºåˆ¶ã€‚Python å¯ä»¥ä½¿ç”¨ property æœºåˆ¶å®Œæˆç±»ä¼¼çš„éœ€æ±‚ã€‚12345678910111213141516171819class Temperature: def __init__(self): self._temp_fahr = 0 @property def temp(self): return (self._temp_fahr - 32) * 5 / 9 @temp.setter def temp(self, new_temp): self._temp_fahr = new_temp * 9 / 5 + 32t = Temperature()print(t._temp_fahr) # =&gt; 0print(t.temp) # =&gt; -17.77777777777778t.temp = 34print(t._temp_fahr) # =&gt; 93.2print(t.temp) # =&gt; 34.0 The Quick Python Book 3rd EditionPython å®žä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€é™æ€æ–¹æ³•çš„åŒºåˆ«ä¸Žä½œç”¨]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Class</tag>
        <tag>OOP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹å¹¶å‘ç¼–ç¨‹ä¸­çš„å¤šçº¿ç¨‹]]></title>
    <url>%2F2019%2F09%2F23%2Fpro-python-concurrency-with-multi-threading%2F</url>
    <content type="text"><![CDATA[Two events are concurrent if neither can causally affect the other. ä»Žç¼–ç¨‹çš„è§’åº¦è®²ï¼ŒæŸä¸ªé—®é¢˜æ˜¯å¯å¹¶å‘çš„ï¼Œå³ä»£è¡¨å®ƒå¯ä»¥è¢«å®Œå…¨æˆ–éƒ¨åˆ†åœ°åˆ†è§£æˆå¤šä¸ªç»„ä»¶ï¼Œä¸”è¿™å‡ ä¸ªç»„ä»¶ä¹‹é—´æ˜¯é¡ºåºç‹¬ç«‹çš„ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªäº‹ä»¶è¢«åˆ†è§£æˆå¤šä¸ªç›¸äº’ä¹‹é—´æ— ä¾èµ–å…³ç³»çš„å…·ä½“æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤å¯ä»¥ç‹¬ç«‹åœ°è¢«å®Œæˆï¼Œä¸”ä¸ç®¡å„è‡ªå®Œæˆçš„é¡ºåºå¦‚ä½•ï¼Œéƒ½ä¸å½±å“æœ€ç»ˆçš„ç»“æžœã€‚ å°±åƒåŽç½—åºšå…ˆç”Ÿåœ¨ã€Šç»Ÿç­¹æ–¹æ³•ã€‹ä¸­æåˆ°çš„ä¾‹å­ï¼Œå–èŒ¶éœ€è¦æ¸…æ´—èŒ¶å…·å’Œçƒ§çƒ­æ°´ï¼Œè¿™æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„äº‹ä»¶ã€‚å¯ä»¥å…ˆæ¸…æ´—èŒ¶å…·å†çƒ§å£¶çƒ­æ°´ï¼Œåˆ™æœ€ç»ˆçš„ç­‰å¾…æ—¶é—´æ˜¯ä¸¤è€…ç‹¬ç«‹å®Œæˆæ‰€éœ€çš„æ—¶é•¿ä¹‹å’Œã€‚æ›´æœ‰æ•ˆçŽ‡çš„æ–¹æ³•ä¸ºï¼Œå…ˆæ‰§è¡Œæ¯”è¾ƒè€—è´¹æ—¶é—´çš„çƒ§çƒ­æ°´åŠ¨ä½œï¼Œå¹¶ä¸”åœ¨ç­‰å¾…çƒ­æ°´çƒ§å¼€çš„åŒæ—¶æ¸…æ´—å¥½èŒ¶å…·ï¼Œæ•ˆæžœç±»ä¼¼äºŽä¸¤ä¸ªå‡†å¤‡æ­¥éª¤åŒæ—¶æ‰§è¡Œè€Œä¸æ˜¯æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ åœ¨ç¨‹åºçš„ä¸–ç•Œä¸­ï¼Œç±»ä¼¼çš„éœ€æ±‚åŒæ ·å±¡è§ä¸é²œã€‚æ¯”å¦‚ç”¨æˆ·ç‚¹å‡»é“¾æŽ¥ä¸‹è½½ä¸€ä¸ªå¤§çš„æ–‡ä»¶ï¼Œé€šå¸¸ä¼šæŠŠæ–‡ä»¶ä¸‹è½½ä»»åŠ¡æ”¾åœ¨åŽå°æ‰§è¡Œï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç»§ç»­æµè§ˆç½‘é¡µï¼Œä¸éœ€è¦ç­‰å¾…ä¸‹è½½ä»»åŠ¡å®Œæˆã€‚ å¤šçº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œç¨‹åºè®¾è®¡è€…å¯ä»¥å°†å…¶å·¥ä½œåˆ’åˆ†æˆå¤šä¸ªå¯åŒæ­¥è¿è¡Œçš„çº¿ç¨‹ä»¥åº”å¯¹æŸäº›åœºæ™¯å’Œéœ€æ±‚ã€‚ä¸è¿‡åœ¨å•æ ¸ç³»ç»Ÿä¸­ï¼Œå¤šçº¿ç¨‹å¹¶ä¸ä¼šåŠ é€Ÿç¨‹åºçš„è¿è¡Œã€‚è€Œå¤šæ ¸æˆ–å¤šå¤„ç†å™¨ç³»ç»Ÿå¯ä»¥å°†ä¸åŒçš„çº¿ç¨‹åˆ†é…ç»™å¤šä¸ª CPU æ ¸å¿ƒåŒæ—¶è¿›è¡Œå¤„ç†ï¼Œå› è€Œèƒ½å¤Ÿå¸¦æ¥æ€§èƒ½ä¸Šçš„æå‡ï¼ˆä½† Python ç”±äºŽ GIL æœºåˆ¶ä½¿å¾—è¿™ç§æå‡ä»æœ‰ä¸€å®šçš„é™åˆ¶ï¼‰ã€‚ åœ¨å•æ ¸ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸€ç§åä¸ºæ—¶é—´åˆ†ç‰‡ï¼ˆtimeslicingï¼‰çš„æœºåˆ¶æ¥å®žçŽ°å¤šçº¿ç¨‹ã€‚å³ CPU å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹é—´éžå¸¸è¿…é€Ÿåœ°è¿›è¡Œåˆ‡æ¢ï¼Œè¾¾æˆä¸€ç§å¤šä¸ªçº¿ç¨‹â€œåŒæ—¶â€åœ¨è¿è¡Œçš„å‡è±¡ã€‚è¿™ç§è™šæ‹Ÿçš„å¹¶è¡Œæ–¹å¼è™½ç„¶ä¸èƒ½å¸¦æ¥æ€§èƒ½ä¸Šçš„æå‡ï¼Œä½†æ˜¯ä»ç„¶èƒ½å¤Ÿéžå¸¸å¥½åœ°åº”å¯¹æŸäº›ç‰¹å®šçš„éœ€æ±‚åœºæ™¯ã€‚å¦‚ï¼š æž„å»ºå“åº”å¼æŽ¥å£ï¼šæ¯”å¦‚å°†é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æ”¾åœ¨åŽå°æ‰§è¡Œï¼Œä½¿å…¶ç­‰å¾…çš„è¿‡ç¨‹ä¸ä¼šé˜»å¡žç”¨æˆ·å…¶ä»–çš„äº¤äº’åŠ¨ä½œ ä»»åŠ¡çš„åˆ†å‘ä¸Žå§”æ´¾ï¼šå¯¹äºŽä¾èµ–äºŽç¬¬ä¸‰æ–¹èµ„æºçš„è¿›ç¨‹ï¼ˆæ¯”å¦‚éœ€è¦å¯¹è¿œç¨‹ Web æœåŠ¡è¿›è¡Œå¤§é‡çš„è¯·æ±‚ï¼‰ï¼Œå¤šçº¿ç¨‹å¯ä»¥èµ·åˆ°å¾ˆå¥½çš„åŠ é€Ÿæ•ˆæžœ æž„å»ºå¤šç”¨æˆ·åº”ç”¨ï¼šå¤šç”¨æˆ·çŠ¶æ€ä¸‹çš„å¤šçº¿ç¨‹ç±»ä¼¼äºŽç‹¬ç«‹æ‰§è¡Œçš„è¿›ç¨‹ï¼Œåªä¸è¿‡åœ¨æŸäº›å±‚é¢ä¸Šæ›´åŠ æ˜“äºŽç®¡ç†ï¼ˆå…±äº«å†…å­˜ï¼‰ ç¤ºä¾‹ï¼šå¤šçº¿ç¨‹è¯·æ±‚ Web æ•°æ®requests èŽ·å–å¤©æ°”ä¿¡æ¯ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ Web è¯·æ±‚ç¤ºä¾‹ï¼Œé€šè¿‡ requests æ¨¡å—è®¿é—®ä¸­å›½å¤©æ°”ç½‘ï¼ŒèŽ·å–éƒ¨åˆ†åŸŽå¸‚çš„å¤©æ°”ä¿¡æ¯ï¼š12345678910111213import requestsdef get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] return weather_infoprint(get_weather(&apos;101210101&apos;))# =&gt; &#123;&apos;city&apos;: &apos;æ­å·ž&apos;, &apos;cityid&apos;: &apos;101210101&apos;, &apos;temp&apos;: &apos;24.8&apos;, &apos;WD&apos;: &apos;ä¸œåŒ—é£Ž&apos;, &apos;WS&apos;: &apos;å°äºŽ3çº§&apos;, &apos;SD&apos;:# &apos;81%&apos;, &apos;AP&apos;: &apos;1000.3hPa&apos;, &apos;njd&apos;: &apos;æš‚æ— å®žå†µ&apos;, &apos;WSE&apos;: &apos;&lt;3&apos;, &apos;time&apos;: &apos;17:50&apos;, &apos;sm&apos;: &apos;2.1&apos;, &apos;isRadar&apos;: &apos;1&apos;, &apos;Radar&apos;: &apos;JC_RADAR_AZ9571_JB&apos;&#125; èŽ·å–å¤šä¸ªåŸŽå¸‚å¤©æ°”12345678910111213141516171819202122232425262728293031323334353637import requestsimport timedef get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] print(&quot;%s (tmp/humi): %s/%s&quot; % ( weather_info[&apos;city&apos;], weather_info[&apos;temp&apos;], weather_info[&apos;SD&apos;] ))cityids = ( &apos;101210101&apos;, &apos;101010100&apos;, &apos;101090201&apos;, &apos;101020100&apos;, &apos;101280101&apos;, &apos;101230201&apos;)def main(): for id in cityids: get_weather(id)if __name__ == &apos;__main__&apos;: started = time.time() main() elapsed = time.time() - started print(&quot;Time elapsed: &#123;:.2f&#125;s&quot;.format(elapsed))# =&gt; æ­å·ž (tmp/humi): 24.8/81%# =&gt; åŒ—äº¬ (tmp/humi): 27.9/28%# =&gt; ä¿å®š (tmp/humi): 27.5/43%# =&gt; ä¸Šæµ· (tmp/humi): 23.5/80%# =&gt; å¹¿å·ž (tmp/humi): 26.6/83%# =&gt; åŽ¦é—¨ (tmp/humi): 26.8/87%# =&gt; Time elapsed: 0.16s å¤šçº¿ç¨‹èŽ·å–å¤šä¸ªåŸŽå¸‚çš„å¤©æ°”å®Œæ•´ä»£ç å¦‚ä¸‹ï¼Œä¸»è¦ä¿®æ”¹äº† main å‡½æ•°ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344from threading import Threadimport requestsimport timedef get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] print(&quot;%s (tmp/humi): %s/%s&quot; % ( weather_info[&apos;city&apos;], weather_info[&apos;temp&apos;], weather_info[&apos;SD&apos;] ))cityids = ( &apos;101210101&apos;, &apos;101010100&apos;, &apos;101090201&apos;, &apos;101020100&apos;, &apos;101280101&apos;, &apos;101230201&apos;)def main(): threads = [] for id in cityids: thread = Thread(target=get_weather, args=[id]) thread.start() threads.append(thread) while threads: threads.pop().join()if __name__ == &apos;__main__&apos;: started = time.time() main() elapsed = time.time() - started print(&quot;Time elapsed: &#123;:.2f&#125;s&quot;.format(elapsed))# =&gt; ä¿å®š (tmp/humi): 27.5/43%# =&gt; å¹¿å·ž (tmp/humi): 26.6/83%# =&gt; æ­å·ž (tmp/humi): 24.8/81%# =&gt; ä¸Šæµ· (tmp/humi): 23.5/80%# =&gt; åŒ—äº¬ (tmp/humi): 27.9/28%# =&gt; åŽ¦é—¨ (tmp/humi): 26.8/87%# =&gt; Time elapsed: 0.08s ä¸Žå‰ä¸€ä¸ªç‰ˆæœ¬ï¼ˆåœ¨å•ä¸ªçº¿ç¨‹ä¸­é¡ºåºåœ°ä¾æ¬¡è¯·æ±‚å¤šä¸ªåŸŽå¸‚çš„å¤©æ°”ä¿¡æ¯ï¼‰ç›¸æ¯”ï¼Œæ­¤ç‰ˆæœ¬é€šè¿‡ä¸åŒçš„çº¿ç¨‹åŒæ—¶è¯·æ±‚å¤šä¸ªåŸŽå¸‚çš„å¤©æ°”ä¿¡æ¯ï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£ä¸€ä¸ªåŸŽå¸‚ã€‚è™½ç„¶å¤šçº¿ç¨‹åœ¨ç³»ç»Ÿèµ„æºä¸Šå¢žåŠ äº†ä¸€å®šç¨‹åº¦çš„æ¶ˆè€—ï¼Œä½†æ˜¯ç›¸å¯¹äºŽç½‘ç»œèµ„æºå“åº”ä»¥åŠ IO ä¼ è¾“äº§ç”Ÿçš„å»¶è¿Ÿå’Œç­‰å¾…ï¼Œä»ç„¶åœ¨æ•ˆçŽ‡ä¸Šæœ‰äº†ä¸€å®šç¨‹åº¦çš„æå‡ã€‚ åŒæ—¶ä¹Ÿå¯ä»¥ä»Žå¯¹è¾“å‡ºç»“æžœçš„æ¯”è¾ƒä¸­çœ‹å‡ºï¼Œå¤šçº¿ç¨‹æ–¹æ¡ˆèŽ·å–åˆ°çš„å¤©æ°”ä¿¡æ¯å¹¶ä¸æ˜¯æŒ‰é¡ºåºè¿”å›žçš„ã€‚å³è¡¨æ˜Žåœ¨è¯·æ±‚æŸä¸ªæ•°æ®æ—¶ï¼Œç¨‹åºå¹¶æ²¡æœ‰ç­‰å¾…ä¸Šä¸€ä¸ªè¯·æ±‚å®Œå…¨è§£å†³ï¼Œè€Œæ˜¯åœ¨ç»“æžœè¿”å›žä¹‹å‰åˆå‘èµ·äº†æ–°çš„è¯·æ±‚ã€‚ä»Žè€Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å¼±äº†ç½‘ç»œå»¶è¿Ÿå¯¹æ•´ä¸ªç¨‹åºçš„é˜»å¡žæ•ˆæžœã€‚ çº¿ç¨‹æ± ä¸€ä¸ªç¨‹åºæ‰€èƒ½è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¹¶ä¸æ˜¯æ¯«æ— é™åˆ¶çš„ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦æž„å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± æ¥å¤„ç†æ‰€æœ‰å¸¦å¹¶è¡Œéœ€æ±‚çš„å·¥ä½œä»»åŠ¡ã€‚è¿™äº›å¹¶è¡Œä»»åŠ¡å¯ä»¥å…ˆå­˜å‚¨åœ¨ä¸€ç§åä¸ºé˜Ÿåˆ—ï¼ˆqueueï¼‰çš„æ•°æ®ç»“æž„ä¸­ï¼Œä»¥å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŽŸåˆ™åˆ†é…ç»™çº¿ç¨‹æ± ä¸­å›ºå®šæ•°é‡çš„çº¿ç¨‹åŽ»å¤„ç†ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364from queue import Queue, Emptyfrom threading import Threadimport requestsimport timeTHREAD_POOL_SIZE = 4cityids = ( &apos;101210101&apos;, &apos;101010100&apos;, &apos;101090201&apos;, &apos;101020100&apos;, &apos;101280101&apos;, &apos;101230201&apos;)def worker(work_queue): while not work_queue.empty(): try: item = work_queue.get(block=False) except Empty: break else: get_weather(item) work_queue.task_done()def get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] print(&quot;%s (tmp/humi): %s/%s&quot; % ( weather_info[&apos;city&apos;], weather_info[&apos;temp&apos;], weather_info[&apos;SD&apos;] ))def main(): work_queue = Queue() for id in cityids: work_queue.put(id) threads = [ Thread(target=worker, args=(work_queue,)) for _ in range(THREAD_POOL_SIZE) ] for thread in threads: thread.start() work_queue.join() while threads: threads.pop().join()if __name__ == &apos;__main__&apos;: started = time.time() main() elapsed = time.time() - started print(&quot;Time elapsed: &#123;:.2f&#125;s&quot;.format(elapsed))# =&gt; ä¿å®š (tmp/humi): 27.5/43%# =&gt; æ­å·ž (tmp/humi): 24.8/81%# =&gt; åŒ—äº¬ (tmp/humi): 27.9/28%# =&gt; ä¸Šæµ· (tmp/humi): 23.5/80%# =&gt; å¹¿å·ž (tmp/humi): 26.6/83%# =&gt; åŽ¦é—¨ (tmp/humi): 26.8/87%# =&gt; Time elapsed: 0.08s å…¶ä¸­ get_weather å‡½æ•°å¯ä»¥é€šè¿‡ id å€¼èŽ·å–å¯¹åº”åŸŽå¸‚çš„å¤©æ°”ä¿¡æ¯ï¼Œæ‰€æœ‰éœ€è¦è¯·æ±‚çš„ id å‚æ•°ä¿å­˜åœ¨ main ä¸­å®šä¹‰çš„é˜Ÿåˆ— work_queue é‡Œï¼› worker å‡½æ•°æ˜¯ä¸Žçº¿ç¨‹ç›¸å…³è”çš„å·¥ä½œä»£ç ï¼Œå®ƒå¯ä»¥é€ä¸ªèŽ·å–é˜Ÿåˆ—ä¸­å­˜å‚¨çš„ id å‚æ•°å¹¶ä¼ é€’ç»™ get_weather å‡½æ•°ï¼›main å‡½æ•°ä¸­çš„ threads åˆ—è¡¨åˆ™åˆå§‹åŒ–äº†å›ºå®šæ•°é‡ï¼ˆTHREAD_POOL_SIZEï¼‰çš„çº¿ç¨‹å¯¹è±¡ï¼Œæ‰€æœ‰çš„è¯·æ±‚ä»»åŠ¡æœ€ç»ˆéƒ½ç”±è¿™äº›çº¿ç¨‹åŽ»å¤„ç†ã€‚é˜Ÿåˆ—ä¸­çš„ä»»ä½•ä¸€ä¸ª id å‚æ•°äº¤ç”±ä»»ä½•ä¸€ä¸ªçº¿ç¨‹å¤„ç†æ—¶éƒ½ä¼šç«‹å³ä»Žé˜Ÿåˆ—ä¸­å¼¹å‡ºï¼Œå› è€Œä¿è¯äº†å„çº¿ç¨‹é—´çš„ç›¸äº’ç‹¬ç«‹ï¼ˆåŒä¸€ä¸ªä»»åŠ¡ä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹èŽ·å–ï¼‰ã€‚ ç®€å•æ¥è¯´ï¼Œå›ºå®šæ•°é‡çš„çº¿ç¨‹å®Œæˆäº†é˜Ÿåˆ—ä¸­å¤§é‡ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†ã€‚å¯ä»¥é€‚å½“ä¿®æ”¹çº¿ç¨‹æ•°é‡ä»¥è¾¾åˆ°ç³»ç»Ÿèµ„æºå’Œæ‰§è¡Œæ•ˆçŽ‡çš„å¹³è¡¡ã€‚ åŒå‘é˜Ÿåˆ—123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import timefrom queue import Queue, Emptyfrom threading import Threadimport requestsTHREAD_POOL_SIZE = 4cityids = ( &apos;101210101&apos;, &apos;101010100&apos;, &apos;101090201&apos;, &apos;101020100&apos;, &apos;101280101&apos;, &apos;101230201&apos;)def get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] return weather_infodef present_result(weather_info): print(&quot;%s (tmp/humi): %s/%s&quot; % ( weather_info[&apos;city&apos;], weather_info[&apos;temp&apos;], weather_info[&apos;SD&apos;] ))def worker(work_queue, results_queue): while not work_queue.empty(): try: item = work_queue.get(block=False) except Empty: break else: results_queue.put( get_weather(item) ) work_queue.task_done()def main(): work_queue = Queue() results_queue = Queue() for id in cityids: work_queue.put(id) threads = [ Thread(target=worker, args=(work_queue, results_queue)) for _ in range(THREAD_POOL_SIZE) ] for thread in threads: thread.start() work_queue.join() while threads: threads.pop().join() while not results_queue.empty(): present_result(results_queue.get())if __name__ == &apos;__main__&apos;: started = time.time() main() elapsed = time.time() - started print(&quot;Time elapsed: &#123;:.2f&#125;s&quot;.format(elapsed))# =&gt; æ­å·ž (tmp/humi): 24.8/81%# =&gt; åŒ—äº¬ (tmp/humi): 27.9/28%# =&gt; ä¿å®š (tmp/humi): 27.5/43%# =&gt; ä¸Šæµ· (tmp/humi): 23.5/80%# =&gt; å¹¿å·ž (tmp/humi): 26.6/83%# =&gt; åŽ¦é—¨ (tmp/humi): 26.8/87%# =&gt; Time elapsed: 0.08s ä¸Žä¸Šä¸€ä¸ªç‰ˆæœ¬çš„æ–¹æ¡ˆä¸åŒï¼Œæ­¤å¤„çš„ç¨‹åºé™¤äº†åˆ›å»ºåŒ…å«è¯·æ±‚ä¿¡æ¯çš„ work_queue é˜Ÿåˆ—å¤–ï¼Œè¿˜åˆ›å»ºäº†ä¸€ä¸ªç”¨äºŽä¿å­˜è¿”å›žç»“æžœçš„ results_queue é˜Ÿåˆ—ã€‚å³å·¥ä½œçº¿ç¨‹åªç”¨äºŽå¯¹è¿œç¨‹ API å‘èµ·è¯·æ±‚å¹¶èŽ·å–ç»“æžœï¼Œè€Œæœ€ç»ˆç»“æžœçš„æ•´ç†åŠæ‰“å°è¾“å‡ºç­‰åˆ™äº¤ç”±ä¸»çº¿ç¨‹æ¥å¤„ç†ã€‚æ­¤ä¸¾å¯ä»¥å‡å¼±æŸäº›æ— å…³çš„æ“ä½œå¯èƒ½å¯¹å·¥ä½œçº¿ç¨‹äº§ç”Ÿçš„ä¸åˆ©å½±å“ã€‚ é”™è¯¯å¤„ç†ä¸ºäº†åº”å¯¹è¯·æ±‚æ•°æ®çš„è¿‡ç¨‹ä¸­å¯èƒ½å‡ºçŽ°çš„é”™è¯¯ï¼Œå¯ä»¥åœ¨ä¹‹å‰ä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ å¼‚å¸¸æ•èŽ·åŠŸèƒ½ã€‚å³åœ¨ worker å‡½æ•°ä¸­æ·»åŠ  try...except è¯­å¥ï¼Œå½“æ‰§è¡ŒæˆåŠŸæ—¶å°†è¿”å›žçš„ç»“æžœä¿å­˜è‡³ results_queue é˜Ÿåˆ—ï¼›å¦‚æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œåˆ™å°†å¼‚å¸¸å¯¹è±¡ä¿å­˜è‡³ results_queue é˜Ÿåˆ—ã€‚ç„¶åŽåœ¨ main å‡½æ•°ä¸­å¯¹ results_queue ä¸­çš„å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œæ˜¯ç›´æŽ¥è¾“å‡ºç»“æžœè¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸å¯¹è±¡ã€‚æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980import timefrom queue import Queue, Emptyfrom threading import Threadimport requestsTHREAD_POOL_SIZE = 4cityids = ( &apos;101210101&apos;, &apos;101010100&apos;, &apos;101090201&apos;, &apos;101020100&apos;, &apos;101280101&apos;, &apos;101230201&apos;)def get_weather(cityid): api_url = &apos;http://www.weather.com.cn/data/sk/&apos; + cityid + &apos;.html&apos; results = requests.get(api_url) results.encoding = &apos;utf-8&apos; weather_info = results.json()[&apos;weatherinfo&apos;] return weather_infodef present_result(weather_info): print(&quot;%s (tmp/humi): %s/%s&quot; % ( weather_info[&apos;city&apos;], weather_info[&apos;temp&apos;], weather_info[&apos;SD&apos;] ))def worker(work_queue, results_queue): while not work_queue.empty(): try: item = work_queue.get(block=False) except Empty: break else: try: result = get_weather(item) except Exception as err: results_queue.put(err) else: results_queue.put(result) finally: work_queue.task_done()def main(): work_queue = Queue() results_queue = Queue() for id in cityids: work_queue.put(id) threads = [ Thread(target=worker, args=(work_queue, results_queue)) for _ in range(THREAD_POOL_SIZE) ] for thread in threads: thread.start() work_queue.join() while threads: threads.pop().join() while not results_queue.empty(): result = results_queue.get() if isinstance(result, Exception): raise result present_result(result)if __name__ == &apos;__main__&apos;: started = time.time() main() elapsed = time.time() - started print(&quot;Time elapsed: &#123;:.2f&#125;s&quot;.format(elapsed))# =&gt; æ­å·ž (tmp/humi): 24.8/81%# =&gt; åŒ—äº¬ (tmp/humi): 27.9/28%# =&gt; ä¿å®š (tmp/humi): 27.5/43%# =&gt; ä¸Šæµ· (tmp/humi): 23.5/80%# =&gt; å¹¿å·ž (tmp/humi): 26.6/83%# =&gt; åŽ¦é—¨ (tmp/humi): 26.8/87%# =&gt; Time elapsed: 0.07s å‚è€ƒèµ„æ–™Expert Python Programming - Second Edition]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Concurrency</tag>
        <tag>Threading</tag>
        <tag>Performance</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django REST framework æ•™ç¨‹ï¼ˆ1ï¼‰â€”â€” å¿«é€Ÿå¼€å§‹]]></title>
    <url>%2F2019%2F09%2F23%2Fdjango-rest-framework-1-quick-start%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡å‚è€ƒè‡ª Django REST framework å®˜æ–¹æ–‡æ¡£ ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ API ä¾› admin ç”¨æˆ·æŸ¥è¯¢ä¸Žä¿®æ”¹ç³»ç»Ÿä¸­çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ä¿¡æ¯ã€‚ ä¸€ã€åˆ›å»ºé¡¹ç›®å®‰è£…ä¾èµ–åº“ï¼š$ pip install django$ pip install djangorestframework é¡¹ç›®åˆå§‹åŒ–ï¼š123$ django-admin startproject tutorial$ cd tutorial$ django-admin startapp quickstart ä¸Šè¿°å‘½ä»¤æ‰§è¡ŒåŽï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ tutorial é¡¹ç›®çš„ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š12345678910111213141516tutorialâ”œâ”€â”€ manage.pyâ”œâ”€â”€ quickstartâ”‚ â”œâ”€â”€ __init__.pyâ”‚ â”œâ”€â”€ admin.pyâ”‚ â”œâ”€â”€ apps.pyâ”‚ â”œâ”€â”€ migrationsâ”‚ â”‚ â””â”€â”€ __init__.pyâ”‚ â”œâ”€â”€ models.pyâ”‚ â”œâ”€â”€ tests.pyâ”‚ â””â”€â”€ views.pyâ””â”€â”€ tutorial â”œâ”€â”€ __init__.py â”œâ”€â”€ settings.py â”œâ”€â”€ urls.py â””â”€â”€ wsgi.py æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿ç§»æ•°æ®åº“å¹¶åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼š$ python manage.py migrate$ python manage.py createsuperuser äºŒã€åºåˆ—åŒ–åˆ›å»º tutorial/quickstart/serializers.py æ–‡ä»¶å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š1234567891011121314from django.contrib.auth.models import User, Groupfrom rest_framework import serializersclass UserSerializer(serializers.HyperlinkedModelSerializer): class Meta: model = User fields = [&apos;url&apos;, &apos;username&apos;, &apos;email&apos;, &apos;groups&apos;]class GroupSerializer(serializers.HyperlinkedModelSerializer): class Meta: model = Group fields = [&apos;url&apos;, &apos;name&apos;] ä¸‰ã€è§†å›¾ä¿®æ”¹ tutorial/quickstart/views.py è§†å›¾æ–‡ä»¶ï¼š123456789101112131415161718192021from django.contrib.auth.models import User, Groupfrom rest_framework import viewsets, permissionsfrom quickstart.serializers import UserSerializer, GroupSerializerclass UserViewSet(viewsets.ModelViewSet): &quot;&quot;&quot; API endpoint that allows users to be viewed or edited. &quot;&quot;&quot; queryset = User.objects.all().order_by(&apos;-date_joined&apos;) serializer_class = UserSerializer permission_classes = [permissions.IsAuthenticatedOrReadOnly]class GroupViewSet(viewsets.ModelViewSet): &quot;&quot;&quot; API endpoint that allows groups to be viewed or edited. &quot;&quot;&quot; queryset = Group.objects.all() serializer_class = GroupSerializer permission_classes = [permissions.IsAuthenticatedOrReadOnly] å››ã€URLs å’Œè®¾ç½®ç¼–è¾‘ tutorial/tutorial/urls.py è·¯ç”±é…ç½®æ–‡ä»¶ï¼š12345678910111213141516from django.contrib import adminfrom django.urls import include, pathfrom rest_framework import routersfrom quickstart import viewsrouter = routers.DefaultRouter()router.register(r&apos;users&apos;, views.UserViewSet)router.register(r&apos;groups&apos;, views.GroupViewSet)# Wire up our API using automatic URL routing.# Additionally, we include login URLs for the browsable API.urlpatterns = [ path(&apos;&apos;, include(router.urls)), path(&apos;api-auth/&apos;, include(&apos;rest_framework.urls&apos;, namespace=&apos;rest_framework&apos;)), path(&apos;admin/&apos;, admin.site.urls),] ç¼–è¾‘ tutorial/tutorial/settings.py æ–‡ä»¶ï¼Œåœ¨ INSTALLED_APPS é…ç½®ä¸­æ·»åŠ ä¸Š rest_framework é¡¹ç›®ï¼š1234INSTALLED_APPS = [ ... &apos;rest_framework&apos;,] äº”ã€æµ‹è¯•è¿è¡Œ $ python manage.py runserver å‘½ä»¤å¯åŠ¨æµ‹è¯•æœåŠ¡ï¼›ä½¿ç”¨ http å‘½ä»¤å¯¹ API è¿›è¡Œè®¿é—®æµ‹è¯•ï¼ˆå¦‚æœªå®‰è£… http å·¥å…·ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… $ pip install httpieï¼‰ã€‚ èŽ·å– API åˆ—è¡¨ï¼š12345$ http -b 127.0.0.1:8000&#123; &quot;groups&quot;: &quot;http://172.20.19.76:8000/groups/&quot;, &quot;users&quot;: &quot;http://172.20.19.76:8000/users/&quot;&#125; GET æ–¹æ³•èŽ·å–ç”¨æˆ·ç»„ä¿¡æ¯ï¼š1234567891011$ http -b 127.0.0.1:8000/groups/[ &#123; &quot;name&quot;: &quot;admin&quot;, &quot;url&quot;: &quot;http://172.20.19.76:8000/groups/1/&quot; &#125;, &#123; &quot;name&quot;: &quot;staff&quot;, &quot;url&quot;: &quot;http://172.20.19.76:8000/groups/2/&quot; &#125;] GET æ–¹æ³•èŽ·å–ç”¨æˆ·ä¿¡æ¯ï¼š12345678910111213141516171819$ http -b 127.0.0.1:8000/users/[ &#123; &quot;email&quot;: &quot;starky@test.com&quot;, &quot;groups&quot;: [ &quot;http://172.20.19.76:8000/groups/2/&quot; ], &quot;url&quot;: &quot;http://172.20.19.76:8000/users/2/&quot;, &quot;username&quot;: &quot;starky&quot; &#125;, &#123; &quot;email&quot;: &quot;admin@test.com&quot;, &quot;groups&quot;: [ &quot;http://172.20.19.76:8000/groups/1/&quot; ], &quot;url&quot;: &quot;http://172.20.19.76:8000/users/1/&quot;, &quot;username&quot;: &quot;admin&quot; &#125;] POST æ–¹æ³•æ·»åŠ æ–°çš„ç”¨æˆ·ç»„ï¼ˆæœªæŽˆæƒï¼‰ï¼š1234$ http -b POST 172.20.19.76127.0.0.1:8000/groups/ name=superuser&#123; &quot;detail&quot;: &quot;Authentication credentials were not provided.&quot;&#125; POST æ–¹æ³•æ·»åŠ æ–°çš„ç”¨æˆ·ç»„ï¼ˆæä¾› Admin è´¦æˆ·ä¿¡æ¯ç”¨äºŽéªŒè¯ï¼‰12345$ http -b -a admin:123456 POST 127.0.0.1:8000/groups/ name=superuser&#123; &quot;name&quot;: &quot;superuser&quot;, &quot;url&quot;: &quot;http://172.20.19.76:8000/groups/3/&quot;&#125; å…­ã€Web ç•Œé¢è®¿é—® http://127.0.0.1:8000ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š ç™»å½•åŽæ”¯æŒ POST æ“ä½œï¼Œæˆªå›¾å¦‚ä¸‹ï¼š]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>WebDev</tag>
        <tag>Django</tag>
        <tag>Restful</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹ Logging æ¨¡å—]]></title>
    <url>%2F2019%2F09%2F23%2Fpro-python-logging-module%2F</url>
    <content type="text"><![CDATA[æ—¥å¿—å¯ä»¥ç”¨äºŽè®°å½•è½¯ä»¶è¿è¡Œæ—¶è§¦å‘çš„ä¸€ç³»åˆ—äº‹ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…å®žæ—¶åœ°è·Ÿè¸ªå’Œäº†è§£ç¨‹åºä»£ç è¿è¡Œçš„çŠ¶æ€ã€‚ç”±æ—¥å¿—è®°å½•çš„äº‹ä»¶æ¶ˆæ¯é€šå¸¸ä¼šä»Žå±žäºŽç‰¹å®šçš„é‡è¦æ€§ç­‰çº§ï¼ˆç§°ä¸º level æˆ– severityï¼‰ï¼Œè¯¥ç­‰çº§ç”±ä½Žåˆ°é«˜ä¸€èˆ¬åŒ…æ‹¬ DEBUGã€INFOã€WARNINGã€ERRORã€CRITICAL ç­‰ã€‚ ä¸€ã€Levelä»¥ä¸‹ä¸ºä¸€æ®µç®€å•çš„ Logging ä»£ç ï¼š123456789import logginglogging.warning(&apos;Watch out!&apos;) # will print a message to the consolelogging.error(&apos;Error happend&apos;) # will print a message to the consolelogging.info(&apos;I told you so&apos;) # will not print anythinglogging.debug(&apos;debug information&apos;) # will not print anything# =&gt; WARNING:root:Watch out!# =&gt; ERROR:root:Error happend logging æ¨¡å—é»˜è®¤çš„å®‰å…¨ç­‰çº§ä¸º WARNINGï¼Œåªæœ‰å±žäºŽæˆ–è€…é«˜äºŽæ­¤ç­‰çº§çš„æ—¥å¿—æ¶ˆæ¯æ‰ä¼šè¢«è·Ÿè¸ªå¹¶è¿›ä¸€æ­¥å¤„ç†ï¼ˆæ¯”å¦‚è¾“å‡ºåˆ°ç»ˆç«¯ï¼‰ã€‚å› æ­¤ä¸Šé¢ä»£ç ä¸­ warning å’Œ error è®°å½•çš„ä¿¡æ¯ä¼šè¾“å‡ºåˆ°ç»ˆç«¯çª—å£ä¸­ï¼Œè€Œ info å’Œ debug ç”±äºŽæ‰€å±žçš„å®‰å…¨ç­‰çº§è¾ƒä½Žï¼Œå…¶ä¿¡æ¯ä¸ä¼šè¾“å‡ºåˆ°ç»ˆç«¯ç•Œé¢ã€‚ logging æ¨¡å—å¯ä»¥é€šè¿‡ basicConfig æ–¹æ³•ä¸­çš„ level å‚æ•°è‡ªå®šä¹‰å®‰å…¨ç­‰çº§ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011import logginglogging.basicConfig(level=logging.INFO)logging.warning(&apos;Watch out!&apos;) # will print a message to the consolelogging.error(&apos;Error happend&apos;) # will print a message to the consolelogging.info(&apos;I told you so&apos;) # will not print anythinglogging.debug(&apos;debug information&apos;) # will not print anything# =&gt; WARNING:root:Watch out!# =&gt; ERROR:root:Error happend# =&gt; INFO:root:I told you so äºŒã€è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶ä¸­å‚è€ƒä»¥ä¸‹ä»£ç ï¼š12345import logginglogging.basicConfig(filename=&apos;example.log&apos;,level=logging.DEBUG)logging.debug(&apos;This message should go to the log file&apos;)logging.info(&apos;So should this&apos;)logging.warning(&apos;And this, too&apos;) ä¸Šé¢çš„ä»£ç è¿è¡ŒåŽä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ example.log æ—¥å¿—æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š123DEBUG:root:This message should go to the log fileINFO:root:So should thisWARNING:root:And this, too ä¸‰ã€æ›´æ”¹ä¿¡æ¯æ ¼å¼è®°å½•å˜é‡ç±»ä¼¼äºŽ print è¯­å¥ï¼Œlogging ä¹Ÿæ”¯æŒå°†å˜é‡çš„å€¼åµŒå…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯ä¸­ï¼š1234import logginglogging.warning(&apos; %s before you %s&apos;, &apos;Look&apos;, &apos;Leap!&apos;)# =&gt; WARNING:root: Look before you Leap! æ›´æ”¹è¾“å‡ºä¿¡æ¯çš„æ ¼å¼å¯ä»¥é€šè¿‡ basicConfig æ–¹æ³•ä¸­çš„ format å‚æ•°å®šä¹‰æ—¥å¿—æ¶ˆæ¯çš„æ ¼å¼ï¼Œæ¯”å¦‚å…·ä½“éœ€è¦è¾“å‡ºå“ªäº›å†…å®¹ä»¥åŠè¿™äº›ä¿¡æ¯å¦‚ä½•å±•çŽ°ç»™ç”¨æˆ·ç­‰ï¼š12345678910import logginglogging.basicConfig(format=&apos;%(levelname)s:%(message)s&apos;, level=logging.DEBUG)logging.debug(&apos;This message should appear on the console&apos;)logging.info(&apos;So should this&apos;)logging.warning(&apos;And this, too&apos;)# =&gt; DEBUG:This message should appear on the console# =&gt; INFO:So should this# =&gt; WARNING:And this, too PSï¼šé»˜è®¤çš„è¾“å‡ºæ ¼å¼ä¸º severity:logger name:messageã€‚ æ˜¾ç¤ºæ—¶é—´ä¿¡æ¯123456import logginglogging.basicConfig(format=&apos;%(asctime)s %(message)s&apos;, datefmt=&apos;%m/%d/%Y %I%M%S %p&apos;)logging.warning(&apos;is when this event was logged.&apos;)# =&gt; 09/06/2019 091722 AM is when this event was logged. å…¶ä¸­ datefmt å‚æ•°æ”¯æŒçš„æ ¼å¼å®šä¹‰ä¸Ž time.strftime() ç›¸åŒã€‚ å››ã€é…ç½® Logginglogging åº“å¯ä»¥é€šè¿‡æ¨¡å—åŒ–çš„æ–¹å¼å‘å¤–éƒ¨æä¾›ä»¥ä¸‹å‡ ç§ç»„ä»¶ï¼š Loggersï¼šæä¾›å¯è¢«åº”ç”¨ç›´æŽ¥è°ƒç”¨çš„æŽ¥å£ Handlersï¼šå°† loggers åˆ›å»ºçš„æ—¥å¿—è®°å½•å‘é€åˆ°æŒ‡å®šä½ç½® Filtersï¼šæä¾›è¿‡æ»¤åŠŸèƒ½ï¼Œå†³å®šå“ªäº›æ—¥å¿—è®°å½•å¯ä»¥è¢«è¾“å‡ºæ˜¾ç¤º Formattersï¼šå†³å®šæ—¥å¿—æœ€ç»ˆæ˜¾ç¤ºæ—¶çš„å¸ƒå±€æ ¼å¼ å¯¹æ—¥å¿—çš„å„ç±»æ“ä½œå®žé™…ä¸Šæ˜¯é€šè¿‡è°ƒç”¨ Logger å®žä¾‹ä¸­åŒ…å«çš„æ–¹æ³•æ¥å®žçŽ°çš„ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¯­å¥åˆ›å»ºä¸€ä¸ª Logger ç±»çš„å®žä¾‹å¯¹è±¡å¹¶å¯¹å…¶å‘½åï¼šlogger = logging.getLogger(__name__)åŒæ—¶è¿™ç§å‘½åæ–¹å¼å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ˜¾ç¤ºå‡ºäº§ç”Ÿæ—¥å¿—ä¿¡æ¯çš„æ¨¡å—å…·ä½“æ˜¯å“ªä¸€ä¸ªã€‚ ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„ logging é…ç½®ï¼š ï¼ˆ1ï¼‰æ‰‹åŠ¨é…ç½®ï¼š1234567891011121314151617181920212223242526272829303132import loggingimport logging.config# create loggerlogger = logging.getLogger(&apos;simple_example&apos;)logger.setLevel(logging.DEBUG)# create console handler and set level to debugch = logging.StreamHandler()ch.setLevel(logging.DEBUG)# create formatterformatter = logging.Formatter(&apos;%(asctime)s - %(name)s - %(levelname)s - %(message)s&apos;)# add formatter to chch.setFormatter(formatter)# add ch to loggerlogger.addHandler(ch)# &apos;application&apos; codelogger.debug(&apos;debug message&apos;)logger.info(&apos;info message&apos;)logger.warning(&apos;warn message&apos;)logger.error(&apos;error message&apos;)logger.critical(&apos;critical message&apos;)# =&gt; 2019-09-06 09:54:53,574 - simple_example - DEBUG - debug message# =&gt; 2019-09-06 09:54:53,576 - simple_example - INFO - info message# =&gt; 2019-09-06 09:54:53,577 - simple_example - WARNING - warn message# =&gt; 2019-09-06 09:54:53,578 - simple_example - ERROR - error message# =&gt; 2019-09-06 09:54:53,580 - simple_example - CRITICAL - critical message ï¼ˆ2ï¼‰é…ç½®å¤šä¸ª handler1234567891011121314151617181920212223242526import logginglogger = logging.getLogger(&apos;simple_example&apos;)logger.setLevel(logging.DEBUG)# create file handler which logs even debug messagesfh = logging.FileHandler(&apos;E:\\spam.log&apos;)fh.setLevel(logging.DEBUG)# create console handler with a higher log levelch = logging.StreamHandler()ch.setLevel(logging.ERROR)# create formatter and add it to the handlersformatter = logging.Formatter(&apos;%(asctime)s - %(name)s - %(levelname)s - %(message)s&apos;)ch.setFormatter(formatter)fh.setFormatter(formatter)# add the handlers to loggerlogger.addHandler(ch)logger.addHandler(fh)# &apos;application&apos; codelogger.debug(&apos;debug message&apos;)logger.info(&apos;info message&apos;)logger.warning(&apos;warn message&apos;)logger.error(&apos;error message&apos;)logger.critical(&apos;critical message&apos;)# =&gt; 2019-09-23 09:20:01,361 - simple_example - ERROR - error message# =&gt; 2019-09-23 09:20:01,377 - simple_example - CRITICAL - critical message ä¸Šè¿°ä»£ç é™¤äº†é…ç½® StreamHandler ç”¨äºŽåœ¨ç»ˆç«¯è¾“å‡ºæ—¥å¿—æ¶ˆæ¯å¤–ï¼Œè¿˜é…ç½®äº† FileHandler ç”¨äºŽåˆ›å»º E:\spam.log æ—¥å¿—æ–‡ä»¶ã€‚ä¸”æ—¥å¿—æ–‡ä»¶ä¸­åŒ…å«äº†ç›¸å¯¹æ›´ä¸°å¯Œçš„ä¿¡æ¯ï¼ˆå› ä¸º Level çº§åˆ«è®¾ç½®çš„æ›´ä½Žï¼‰ï¼š123452019-09-23 09:26:58,050 - simple_example - DEBUG - debug message2019-09-23 09:26:58,051 - simple_example - INFO - info message2019-09-23 09:26:58,052 - simple_example - WARNING - warn message2019-09-23 09:26:58,052 - simple_example - ERROR - error message2019-09-23 09:26:58,055 - simple_example - CRITICAL - critical message ï¼ˆ3ï¼‰dictConfig é…ç½® Loggingï¼š1234567891011121314151617181920212223242526272829303132333435import loggingfrom logging.config import dictConfiglogging_config = dict( version=1, formatters=&#123; &apos;f&apos;: &#123;&apos;format&apos;: &apos;%(asctime)s %(name)-12s %(levelname)-8s %(message)s&apos;&#125; &#125;, handlers=&#123; &apos;h&apos;: &#123;&apos;class&apos;: &apos;logging.StreamHandler&apos;, &apos;formatter&apos;: &apos;f&apos;, &apos;level&apos;: logging.DEBUG&#125; &#125;, root=&#123; &apos;handlers&apos;: [&apos;h&apos;], &apos;level&apos;: logging.DEBUG, &#125;,)dictConfig(logging_config)logger = logging.getLogger(&apos;simple_example&apos;)# &apos;application&apos; codelogger.debug(&apos;debug message&apos;)logger.info(&apos;info message&apos;)logger.warning(&apos;warn message&apos;)logger.error(&apos;error message&apos;)logger.critical(&apos;critical message&apos;)# =&gt; 2019-09-09 10:15:47,932 simple_example DEBUG debug message# =&gt; 2019-09-09 10:15:47,934 simple_example INFO info message# =&gt; 2019-09-09 10:15:47,935 simple_example WARNING warn message# =&gt; 2019-09-09 10:15:47,936 simple_example ERROR error message# =&gt; 2019-09-09 10:15:47,938 simple_example CRITICAL critical message ï¼ˆ4ï¼‰YAML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼š12345678910111213141516171819202122# logging.pyimport loggingimport logging.configimport yamlwith open(&apos;E:\\Program\\python\\logging.yml&apos;, &apos;r&apos;) as f: config = yaml.safe_load(f.read()) logging.config.dictConfig(config)logger = logging.getLogger(__file__)# &apos;application&apos; codelogger.debug(&apos;debug message&apos;)logger.info(&apos;info message&apos;)logger.warning(&apos;warn message&apos;)logger.error(&apos;error message&apos;)logger.critical(&apos;critical message&apos;)# =&gt; 2019-09-09 11:18:07,167 - e:\Program\python\logging.py - DEBUG - debug message# =&gt; 2019-09-09 11:18:07,169 - e:\Program\python\logging.py - INFO - info message# =&gt; 2019-09-09 11:18:07,170 - e:\Program\python\logging.py - WARNING - warn message# =&gt; 2019-09-09 11:18:07,171 - e:\Program\python\logging.py - ERROR - error message# =&gt; 2019-09-09 11:18:07,172 - e:\Program\python\logging.py - CRITICAL - critical message 12345678910111213141516171819# logging.ymlversion: 1formatters: simple: format: &apos;%(asctime)s - %(name)s - %(levelname)s - %(message)s&apos;handlers: console: class: logging.StreamHandler level: DEBUG formatter: simple stream: ext://sys.stdoutloggers: sampleLogger: level: DEBUG handlers: [console] propagate: noroot: level: DEBUG handlers: [console] å‚è€ƒèµ„æ–™Python 3.7.4 documentation]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Logging</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹é”™è¯¯æ•èŽ·ä¸Žå¼‚å¸¸å¤„ç†]]></title>
    <url>%2F2019%2F09%2F17%2Fpro-python-exception-capturing-and-error-handling%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å¼‚å¸¸ä»‹ç»Python ä¸­çš„å¼‚å¸¸æ˜¯ä¸€ç§ç”± raise è¯­å¥è‡ªåŠ¨åˆ›å»ºçš„å¯¹è±¡ã€‚åœ¨å¼‚å¸¸å¯¹è±¡ç”Ÿæˆä¹‹åŽï¼ŒPython ç¨‹åºä¸ä¼šå†ç»§ç»­æ‰§è¡Œ raise åŽé¢ç´§è·Ÿçš„è¯­å¥æˆ–è€…æ“ä½œå¼‚å¸¸å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯â€œæœç´¢â€ç”¨äºŽå¤„ç†è¯¥å¼‚å¸¸çš„æŸä¸ªç‰¹å®šçš„ handler ã€‚å¦‚æžœè¯¥ handler è¢« Python ç¨‹åºæ‰¾åˆ°ï¼Œåˆ™å®ƒå¯ä»¥å…³è”å¹¶è®¿é—®å¼‚å¸¸å¯¹è±¡èŽ·å–æ›´å¤šçš„ä¿¡æ¯ï¼›å¦‚æžœæ²¡æœ‰æ‰¾åˆ°ä¸Žå¼‚å¸¸å¯¹åº”çš„ handlerï¼Œåˆ™ç¨‹åºç»ˆæ­¢å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚ PS: LBYL ä¸Ž EAFPä»Žç†å¿µä¸Šè®²ï¼ŒPython å€¾å‘äºŽåœ¨é”™è¯¯å‘ç”Ÿä¹‹åŽé€šè¿‡æ•èŽ·å¼‚å¸¸æ¥å¤„ç†ç¨‹åºé”™è¯¯ã€‚ç§°ä¸º easier to ask forgiveness than permission (EAFP) ã€‚å¦å¤–ä¸€ç§é”™è¯¯å¤„ç†çš„æ–¹å¼åˆ™æ˜¯å°½å¯èƒ½åœ°åœ¨é”™è¯¯å‘ç”Ÿä¹‹å‰æ£€æŸ¥æ‰€æœ‰å¯èƒ½å‘ç”Ÿçš„æƒ…å†µï¼Œè¿™ç§æ¨¡å¼ç§°ä¸º look before you leap (LBYL) ã€‚ Python æä¾›å¤šç§ä¸åŒç±»åž‹çš„å¼‚å¸¸ç”¨ä»¥åæ˜ é”™è¯¯äº§ç”Ÿçš„åŽŸå› å’Œåœºæ™¯ç­‰ã€‚æ¯ç§ç±»åž‹çš„å¼‚å¸¸å®žé™…ä¸Šéƒ½æ˜¯ä¸€ä¸ª Python ç±»ï¼Œä¸”å…¶ä¸­å¤§å¤šæ•°éƒ½ç»§æ‰¿äºŽ Exception ã€‚å¯¹äºŽç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»ï¼Œä¹Ÿæœ€å¥½ä½œä¸º Exception çš„å­ç±»æ¥å®žçŽ°ã€‚ Python å¼‚å¸¸è§¦å‘æ—¶é€šå¸¸ä¼šè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼š12345&gt;&gt;&gt; alist = [1,2,3]&gt;&gt;&gt; alist[7]Traceback (most recent call last): File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;IndexError: list index out of range ä¸Šé¢ä»£ç ä¸­çš„ alist[7] åœ¨è¯·æ±‚åˆ—è¡¨ä¸­çš„é¡¹ç›®æ—¶è¶…å‡ºäº†åˆ—è¡¨åŽŸæœ¬çš„é•¿åº¦ï¼Œå› æ­¤è§¦å‘äº† IndexError å¼‚å¸¸ã€‚è¯¥å¼‚å¸¸è¢« Python äº¤äº’è§£é‡Šå™¨èŽ·å–å¹¶å¤„ç†ï¼Œæœ€ç»ˆè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚ å¦‚æžœéœ€è¦ï¼Œå…¶å®žä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­é€šè¿‡ raise è¯­å¥æ‰‹åŠ¨è§¦å‘å¼‚å¸¸ï¼š1234&gt;&gt;&gt; raise IndexError(&quot;Just kidding&quot;)Traceback (most recent call last): File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;IndexError: Just kidding äºŒã€å¼‚å¸¸æ•èŽ·èƒ½å¤Ÿç»ˆæ­¢ç¨‹åºçš„è¿è¡Œå¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶ä¸æ˜¯å¼‚å¸¸æœºåˆ¶çš„å…³é”®æ‰€åœ¨ã€‚å¼‚å¸¸æœºåˆ¶çš„ç‰¹æ®Šæ€§åœ¨äºŽï¼Œé€šè¿‡å®šä¹‰åˆé€‚çš„ç”¨äºŽå¤„ç†ç‰¹å®šå¼‚å¸¸çš„ handlerï¼Œå¯ä»¥ç¡®ä¿ä¸€èˆ¬çš„å¼‚å¸¸æƒ…å†µèƒ½å¤Ÿè¢« handler æ•æ‰ï¼Œè€Œä¸ä¼šç›´æŽ¥å¯¼è‡´ç¨‹åºè¿è¡Œå¤±è´¥ã€‚handler å¯ä»¥è¾“å‡ºé”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·ï¼Œæˆ–è€…å°è¯•ä¿®å¤é—®é¢˜ï¼Œä½†æ˜¯é‡ç‚¹åœ¨äºŽå®ƒä¸ä¼šç»ˆæ­¢ç¨‹åºã€‚ æ•èŽ·å¼‚å¸¸çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š12345678910111213try: bodyexcept exception_type1 as var1: exception_code1except exception_type2 as var2: exception_code2...except: default_exception_codeelse: else_bodyfinally: finally å…¶å…·ä½“çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š try è¯­å¥é¦–å…ˆè¢«æ‰§è¡Œï¼Œå¦‚æžœæ‰§è¡ŒæˆåŠŸï¼ˆæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œåˆ™ç»§ç»­æ‰§è¡Œ else è¯­å¥ï¼ˆå¦‚æžœæœ‰ï¼‰ï¼Œtry è¯­å¥æ­¤æ—¶ç»“æŸã€‚æœ€åŽæ‰§è¡Œ finally è¯­å¥ï¼ˆå¦‚æžœæœ‰ï¼‰ã€‚ å¦‚æžœ try è¯­å¥æ‰§è¡Œæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ except è¯­å¥æ ¹æ®å¼‚å¸¸ç±»åž‹è¿›è¡ŒåŒ¹é…ã€‚å¦‚æŸä¸ª except è¯­å¥æœ€ç»ˆåŒ¹é…æŠ›å‡ºçš„å¼‚å¸¸ç±»åž‹ï¼Œåˆ™æŠ›å‡ºçš„å¼‚å¸¸èµ‹å€¼ç»™å…¶åŽçš„å˜é‡ varï¼ˆå¦‚æžœæœ‰ï¼‰ï¼Œå¯¹åº”çš„ exception_code è¢«æ‰§è¡Œã€‚ å¦‚æžœ try æŠ›å‡ºçš„å¼‚å¸¸æ²¡æœ‰ä»»ä½• except è¯­å¥è¿›è¡ŒåŒ¹é…ï¼Œåˆ™è¯¥å¼‚å¸¸ç»§ç»­ä¼ é€’çœ‹æ˜¯å¦æœ‰å†…åµŒçš„ try è¯­å¥å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ ä¸Šé¢æ ¼å¼ä¸­æœ€åŽçš„ except è¯­å¥æ²¡æœ‰è·Ÿä»»ä½•å¼‚å¸¸ç±»åž‹ï¼Œåˆ™è¡¨ç¤ºå®ƒå°†åŒ¹é…å…³è”æ‰€æœ‰çš„å¼‚å¸¸ç±»åž‹ã€‚è¿™ç§æ–¹å¼åœ¨è°ƒè¯•å’Œåˆ›å»ºç¨‹åºåŽŸåž‹æ—¶è¾ƒå¸¸ç”¨ï¼Œä½†å¹¶ä¸æŽ¨èï¼ˆå› ä¸ºéšè—äº†å¼‚å¸¸åŒ…å«çš„ç»†èŠ‚ï¼‰ã€‚ try è¯­å¥ä¸­çš„ else æ˜¯å¯é€‰çš„ä¸”å¹¶ä¸å¸¸ç”¨ï¼Œå®ƒåªæœ‰åœ¨ try è¯­å¥æ‰§è¡ŒåŽæœªæŠ›å‡ºä»»ä½•å¼‚å¸¸çš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œã€‚ finally è¯­å¥åŒæ ·æ˜¯å¯é€‰çš„ï¼Œå®ƒåœ¨ä»»ä½•æƒ…å†µä¸‹æœ€ç»ˆéƒ½ä¼šæ‰§è¡Œã€‚å³ä¾¿ try è¯­å¥æŠ›å‡ºå¼‚å¸¸ä¸”æ²¡æœ‰ä»»ä½• except è¯­å¥è¿›è¡Œæ•èŽ·å’Œå¤„ç†ï¼Œè¯¥å¼‚å¸¸ä¹Ÿæ˜¯åœ¨ finally è¯­å¥æ‰§è¡ŒåŽæŠ›å‡ºç»™ç”¨æˆ·ã€‚å› æ­¤ finally è¯­å¥å¤šç”¨äºŽä¸€äº›â€œæ¸…ç†â€ä»»åŠ¡ï¼Œæ¯”å¦‚è¯»å†™ç¡¬ç›˜åŽçš„å…³é—­æ–‡ä»¶ç­‰ã€‚å¦‚ï¼š12345try: infile = open(filename) data = infile.read()finally: infile.close() ä¸‰ã€assert è¯­å¥assert è¯­å¥æ˜¯ raise è¯­å¥çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå…¶è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼šassert expression, argument å…¶å«ä¹‰ä¸ºï¼Œå¦‚æžœ expression è¡¨è¾¾å¼çš„æ‰§è¡Œç»“æžœä¸º False ä¸”ç³»ç»Ÿå˜é‡ __debug__ çš„å€¼ä¸º Trueï¼Œåˆ™æŠ›å‡º AssertionError å¼‚å¸¸å’Œ argumentå˜é‡ï¼ˆå¯é€‰ï¼‰ã€‚ ç³»ç»Ÿå˜é‡ __debug__ çš„å€¼é»˜è®¤ä¸º Trueï¼Œå¯ä»¥åœ¨ Python è¿è¡Œæ—¶æ·»åŠ  -O æˆ– -OO é€‰é¡¹å°†è¯¥å€¼æ”¹ä¸º Falseã€‚å› æ­¤å¯ä»¥åœ¨å¼€å‘ç¨‹åºæ—¶åŠ å…¥ assert è¯­å¥è¿›è¡Œè°ƒè¯•ï¼Œè€Œç¨‹åºå‘å¸ƒæ—¶å°†å…¶ä¿ç•™åœ¨ä»£ç ä¸­ä¹Ÿä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼ˆåªéœ€ä¿è¯ __debug__ ä¸º Falseï¼‰ã€‚12345&gt;&gt;&gt; x = (1, 2, 3)&gt;&gt;&gt; assert len(x) &gt; 5, &quot;len(x) not &gt; 5&quot;Traceback (most recent call last): File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;AssertionError: len(x) not &gt; 5 å››ã€ä»£ç ç¤ºä¾‹ä¸æ•èŽ·å¼‚å¸¸1234while True: x = int(input(&apos;Enter the first number: &apos;)) y = int(input(&apos;Enter the second number: &apos;)) print(x / y) è¿è¡Œæ•ˆæžœï¼ˆå‡ºé”™åŽç¨‹åºé€€å‡ºï¼‰ï¼š1234567891011$ python exceptions.pyEnter the first number: 5Enter the second number: 41.25Enter the first number: 4Enter the second number: 0Traceback (most recent call last): File &quot;exception.py&quot;, line 4, in &lt;module&gt; print(x / y)ZeroDivisionError: division by zero$ æ•èŽ·é™¤æ•°ä¸ä¸ºé›¶å¼‚å¸¸1234567while True: try: x = int(input(&apos;Enter the first number: &apos;)) y = int(input(&apos;Enter the second number: &apos;)) print(x / y) except ZeroDivisionError: print(&apos;Division by zero is illegal&apos;) è¿è¡Œæ•ˆæžœï¼ˆå‡ºé”™åŽå¼‚å¸¸è¢«æ•èŽ·ï¼Œç¨‹åºä¸é€€å‡ºï¼‰ï¼š12345678$ python exceptions.pyEnter the first number: 4Enter the second number: 0Division by zero is illegalEnter the first number: 5Enter the second number: 41.25Enter the first number: æ•èŽ·å¤šä¸ªå¼‚å¸¸123456789while True: try: x = int(input(&apos;Enter the first number: &apos;)) y = int(input(&apos;Enter the second number: &apos;)) print(x / y) except ZeroDivisionError: print(&apos;Division by zero is illegal&apos;) except ValueError: print(&quot;That wasn&apos;t a number, was it?&quot;) è¿è¡Œæ•ˆæžœï¼š1234567891011$ python exceptions.pyEnter the first number: 4Enter the second number: 0Division by zero is illegalEnter the first number: 4Enter the second number: helloThat wasn&apos;t a number, was it?Enter the first number: 5Enter the second number: 41.25Enter the first number: æ•èŽ·æ‰€æœ‰å¼‚å¸¸ï¼ˆä¸æŽ¨èï¼Œéšè—äº†å¼‚å¸¸çš„ç»†èŠ‚ï¼‰1234567while True: try: x = int(input(&apos;Enter the first number: &apos;)) y = int(input(&apos;Enter the second number: &apos;)) print(x / y) except: print(&apos;Something wrong happened ...&apos;) è¿è¡Œæ•ˆæžœï¼š12345678$ python exceptions.pyEnter the first number: 4Enter the second number: 0Something wrong happened ...Enter the first number: 4Enter the second number: helloSomething wrong happened ...Enter the first number: ç¨å¥½ä¸€ç‚¹çš„ç‰ˆæœ¬ï¼ˆè¾“å‡ºå¼‚å¸¸ä¿¡æ¯ï¼‰ï¼š1234567while True: try: x = int(input(&apos;Enter the first number: &apos;)) y = int(input(&apos;Enter the second number: &apos;)) print(x / y) except Exception as e: print(&apos;Invalid input:&apos;, e) è¿è¡Œæ•ˆæžœï¼š1234567Enter the first number: 4Enter the second number: 0Invalid input: division by zeroEnter the first number: 4Enter the second number: helloInvalid input: invalid literal for int() with base 10: &apos;hello&apos;Enter the first number: å‚è€ƒèµ„æ–™Beginning Python 3rdThe Quick Python Book 3rd Edition]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Tricks</tag>
        <tag>Python</tag>
        <tag>Advanced</tag>
        <tag>Program</tag>
        <tag>Technique</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹ç”Ÿæˆå™¨ä¸Žè¿­ä»£å™¨]]></title>
    <url>%2F2019%2F09%2F05%2Fpro-python-iterators-and-generators%2F</url>
    <content type="text"><![CDATA[è¿­ä»£å™¨ï¼ˆIteratorsï¼‰å’Œç”Ÿæˆå™¨ï¼ˆGeneratorsï¼‰æ˜¯ Python è¯­è¨€ä¸­ç”¨å¤„å¾ˆå¤§çš„å·¥å…·ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹é€šè¿‡å®ƒä»¬å¯ä»¥å†™å‡ºæ›´åŠ ç²¾ç®€ã€æ¸…æ™°å’Œé«˜æ•ˆçš„ä»£ç ã€‚ è¿­ä»£å™¨è¿­ä»£å™¨æ˜¯ä¸€ç§åŒ…å« __next__ æ–¹æ³•ã€ç”¨äºŽå¤„ç†æ•°æ®æµçš„å¯¹è±¡ã€‚å½“ä½¿ç”¨ for å¾ªçŽ¯ä¹‹ç±»çš„æ–¹å¼éåŽ†è¿­ä»£å™¨ä¸­çš„æ¯ä¸€é¡¹æ•°æ®æ—¶ï¼Œ__next__ æ–¹æ³•å³è¢«é‡å¤æ€§åœ°è°ƒç”¨è¿›è€Œå®Œæˆç‰¹å®šçš„åŠ¨ä½œã€‚ ä»¥ä¸‹ä»£ç å³ä¸ºä¸€ä¸ªä¸å®Œæ•´çš„è¿­ä»£å™¨ç±»ï¼š1234567891011121314class MultiplyByTwo: def __init__(self, number): self.number = number self.counter = 0 def __next__(self): self.counter += 1 return self.number * self.countermul = MultiplyByTwo(5)print(next(mul)) # =&gt; 5print(next(mul)) # =&gt; 10print(next(mul)) # =&gt; 15print(next(mul)) # =&gt; 20 é€šè¿‡ next() å‡½æ•°æ‰‹åŠ¨è°ƒç”¨ MultiplyByTwo ç±»çš„ __next__ æ–¹æ³•ï¼Œå¯ä»¥ä¾æ¬¡å¾—åˆ° number å˜é‡ä¸Žé€’å¢žçš„ counter å˜é‡çš„ä¹˜ç§¯ã€‚ä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¯è¢«éåŽ†çš„è¿­ä»£å™¨ç±»ï¼Œç†è®ºä¸Šä¹Ÿåº”è¯¥å¯ä»¥é€šè¿‡ for è¯­å¥ç›´æŽ¥ä»¥å¾ªçŽ¯çš„æ–¹å¼é€æ¬¡å–å‡º __next__ è¿”å›žçš„ä¹˜ç§¯ã€‚ æ­¤æ—¶è¿è¡Œå¦‚ä¸‹ä»£ç å¯¹ MultiplyByTwo ç±»è¿›è¡Œè¿­ä»£æ“ä½œï¼š12for num in MultiplyByTwo(5): print(num) åˆ™ä¼šæŠ¥å‡º TypeError: &#39;MultiplyByTwo&#39; object is not iterable é”™è¯¯ã€‚å³æ­¤æ—¶çš„â€œè¿­ä»£å™¨â€å¯¹è±¡è¿˜ä¸æ”¯æŒéåŽ†æ“ä½œã€‚ éœ€è¦åœ¨ MultiplyByTwo ç±»ä¸­æ·»åŠ  __iter__ æ–¹æ³•è¡¨æ˜Žå…¶â€œå¯è¢«éåŽ†â€ï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819class MultiplyByTwo: def __init__(self, number): self.number = number self.counter = 0 def __iter__(self): return self def __next__(self): self.counter += 1 return self.number * self.counterfor num in MultiplyByTwo(5): print(num)# =&gt; 5# =&gt; 10# =&gt; 15# =&gt; 20# =&gt; ... æ­¤æ—¶åˆ™å¯ä»¥ä½¿ç”¨ for è¯­å¥å¾ªçŽ¯åœ°è°ƒç”¨ __next__ æ–¹æ³•èŽ·å– number å’Œé€’å¢žçš„ counter å˜é‡çš„ä¹˜ç§¯ã€‚æ¯”è¾ƒå°´å°¬çš„æ˜¯ï¼Œä»¥ä¸Šé¢çš„æ–¹å¼éåŽ† MultiplyByTwo è¿­ä»£å™¨ï¼Œfor å¾ªçŽ¯ä¼šä¸€ç›´è¿è¡Œä¸‹åŽ»ã€‚ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç ä¸ºå‰é¢çš„è¿­ä»£å™¨æ·»åŠ ç»ˆæ­¢ç‚¹ï¼š12345678910111213141516171819202122232425class MultiplyByTwo: def __init__(self, number, limit): self.number = number self.limit = limit self.counter = 0 def __iter__(self): return self def __next__(self): self.counter += 1 value = self.number * self.counter if value &gt; self.limit: raise StopIteration else: return valuefor num in MultiplyByTwo(5, 20): print(num)# =&gt; 5# =&gt; 10# =&gt; 15# =&gt; 20 æ‰€ä»¥ä¸€ä¸ªå®žçŽ°äº† __next__ æ–¹æ³•ï¼ˆç”¨ä»¥ä¸æ–­è¿”å›žä¸‹ä¸€ä¸ªæ•°æ®ï¼‰ã€å¯è¿›è¡Œè¿­ä»£æ“ä½œçš„å¯¹è±¡å³ä¸ºè¿­ä»£å™¨ã€‚ å¯¹äºŽå‰é¢å®žçŽ°çš„ MultiplyByTwo è¿­ä»£å™¨ç±»ï¼Œåœ¨ç”¨ for å¾ªçŽ¯è¿›è¡ŒéåŽ†æ“ä½œæ—¶ï¼Œfor num in MultiplyByTwo(5, 20): çš„æœ€ç»ˆç»“æžœç­‰åŒäºŽ for è¯­å¥å¯¹ä»¥ä¸‹åˆ—è¡¨çš„éåŽ†ï¼šfor num in [5 * 1, 5 * 2, 5 * 3, 5 *4]: ã€‚ å®žé™…ä¸Šï¼Œè¿­ä»£å™¨å¯¹è±¡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œå…¶å¯ä»¥è¢« next() å‡½æ•°è°ƒç”¨å¹¶ä¸æ–­è¿”å›žä¸‹ä¸€ä¸ªæ•°æ®ï¼Œç›´åˆ°æ²¡æœ‰æ•°æ®æ—¶æŠ›å‡º StopIteration å¼‚å¸¸ã€‚ä½†è¿™ä¸ªâ€œæ•°æ®æµâ€ä¸æ˜¯åŽŸæœ¬å°±å®Œæ•´åœ°å­˜åœ¨çš„ï¼Œåªèƒ½é€šè¿‡ next() å‡½æ•°é€æ¬¡åœ°è®¡ç®—ä¸‹ä¸€ä¸ªå€¼ã€‚å³è¿­ä»£å™¨çš„è®¡ç®—æ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰åœ¨éœ€è¦è¿”å›žä¸‹ä¸€ä¸ªæ•°æ®æ—¶æ‰ä¼šè¢«åŠ¨åœ°è¿›è¡Œè®¡ç®—ã€‚ ç”Ÿæˆå™¨ç”Ÿæˆå™¨å¯ä»¥ç†è§£ä¸ºä¸€ç§å®žçŽ°äº†è¿­ä»£å™¨åè®®çš„æ•°æ®ç»“æž„ã€‚å‰é¢æåˆ°è¿­ä»£å™¨æ˜¯â€œæ‡’æƒ°â€çš„ï¼Œä¸€æ¬¡åªè®¡ç®—ä¸€ä¸ªæ•°æ®ã€‚å¯¹äºŽé¡¹ç›®ä½“é‡éžå¸¸åºžå¤§çš„æ•°æ®é›†åˆï¼ˆæ¯”å¦‚å…¨ä½“è‡ªç„¶æ•°ï¼Ÿæ²¡æœ‰ä»»ä½•ä¸€ä¸ªåˆ—è¡¨èƒ½è£…ä¸‹ï¼‰æˆ–æ–‡ä»¶ï¼Œç”Ÿæˆå™¨ç›¸æ¯”äºŽå…¶ä»–æ•°æ®ç»“æž„ï¼Œèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°ä½¿ç”¨å†…å­˜èµ„æºã€‚ ç”Ÿæˆå™¨ä»£ç ç¤ºä¾‹ï¼š123456789101112131415def multiple_generator(num, limit): counter = 1 value = num * counter while value &lt;= limit: yield value counter += 1 value = num * counterfor num in multiple_generator(5, 20): print(num)# =&gt; 5# =&gt; 10# =&gt; 15# =&gt; 20 ä¸åŒäºŽå‰é¢çš„ MultiplyByTwo ç±»ï¼Œæ­¤æ¬¡çš„ multiple_generator ç”Ÿæˆå™¨å‡½æ•°å¹¶ä¸éœ€è¦å®žçŽ° __next__ å’Œ __iter__ æ–¹æ³•ï¼Œä¹Ÿä¸ç”¨æ£€æŸ¥å†…éƒ¨çŠ¶æ€ç¡®è®¤æ˜¯å¦å‘èµ·å¼‚å¸¸ã€‚è€Œæ˜¯ä½¿ç”¨äº† yield å…³é”®å­—ã€‚yield å…³é”®å­—ç±»ä¼¼äºŽ returnï¼Œåªä¸è¿‡å®ƒå¹¶ä¸ä¼šç»ˆæ­¢å‡½æ•°çš„è¿è¡Œã€‚è€Œæ˜¯æš‚æ—¶ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ•°æ®è¢«è¯·æ±‚ï¼ˆå°±ç»§ç»­è¿”å›žä¸‹ä¸€ä¸ªå€¼ï¼‰ã€‚å› æ­¤ç”Ÿæˆå™¨ç›¸å¯¹äºŽä¸€èˆ¬çš„è¿­ä»£å™¨æ›´åŠ æ˜“è¯»å’Œé«˜æ•ˆã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»å…¸çš„ç”Ÿæˆå™¨åœ¨çŽ°å®žä¸­çš„åº”ç”¨ï¼Œé€šè¿‡ç”Ÿæˆå™¨ä»¥æ•°æ®å—çš„æ–¹å¼è¯»å–æ–‡ä»¶ï¼š1234567891011def read_in_chunks(file_handler, chunk_size=1024): &quot;&quot;&quot; Lazy function (generator) to read a file piece by piece.&quot;&quot;&quot; while True: data = file_handler.read(chunk_size) if not data: break yield dataf = open(&apos;large_number_of_data.dat&apos;)for piece in read_in_chunks(f): print(piece) é€šè¿‡ç”Ÿæˆå™¨æ¯æ¬¡åªè¯»å– 1k å¤§å°çš„æ•°æ®å—ï¼Œå¾ªçŽ¯éåŽ†ç›´åˆ°æ•´ä¸ªæ–‡ä»¶è¢«å¤„ç†ã€‚è€Œä¸æ˜¯å°†æ‰€æœ‰æ–‡ä»¶æ•°æ®ä¸€æ¬¡æ€§åœ°è¯»å…¥åˆ°å†…å­˜ä¸­ã€‚å½“éœ€è¦è¯»å–çš„æ–‡ä»¶éžå¸¸å¤§æ—¶ï¼Œæ­¤ç§æ–¹å¼ç›¸å¯¹äºŽå¸¸è§„æ‰‹æ®µæ›´åŠ èŠ‚çœå†…å­˜çš„ä½¿ç”¨ã€‚ yield fromyield from å…³é”®å­—å¯ä»¥ç”¨æ¥ä»Žå…¶ä»–ç”Ÿæˆå™¨ä¸­èŽ·å–æ•°æ®ã€‚å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š12345678910def flat_list(iter_values): &quot;&quot;&quot;flatten a multi list or something&quot;&quot;&quot; for item in iter_values: if hasattr(item, &apos;__iter__&apos;): yield from flat_list(item) else: yield itemprint(list(flat_list([1, 2, [3, 4, [5]], 6])))# =&gt; [1, 2, 3, 4, 5, 6] ä¸Šé¢çš„çŸ­çŸ­ 6 è¡Œä»£ç å¯ä»¥å°†åŒ…å«ä»»æ„å±‚æ¬¡çš„å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ç­‰ï¼‰è½¬æ¢æˆå•å±‚çš„åˆ—è¡¨ç»“æž„ã€‚ä¸ªäººæ„Ÿè§‰ï¼Œè¿™ä»£ç éžå¸¸æ¼‚äº®ï¼Œæœ‰ç‚¹å±‚å±‚é€’è¿›ã€çŽ¯çŽ¯ç›¸æ‰£çš„æ„Ÿè§‰äº†ã€‚å€¼å¾—å¥½å¥½è§‚èµã€‚ PSï¼šå¯ä»¥å¯¹æ¯”ä¸‹é˜¶ä¹˜çš„å®žçŽ°ä»£ç ï¼š12345def factorial(n): if n != 1: return n * factorial(n-1) else: return 1 å‚è€ƒèµ„æ–™Clean Python]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Functional</tag>
        <tag>Programming</tag>
        <tag>Language</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python è¿›é˜¶ä¹‹ Decoratorsï¼ˆè£…é¥°å™¨ï¼‰æµ…æž]]></title>
    <url>%2F2019%2F09%2F05%2Fpro-python-decorators-intro%2F</url>
    <content type="text"><![CDATA[Decoratorsï¼ˆè£…é¥°å™¨ï¼‰å¯ä»¥åœ¨ä¸æ›´æ”¹å‡½æ•°æˆ–å¯¹è±¡çš„è¡Œä¸ºçš„å‰æä¸‹ï¼ŒåŠ¨æ€åœ°å‘å…¶æ·»åŠ é¢å¤–çš„æ•ˆæžœã€‚ å‡è®¾å½“å‰çš„é¡¹ç›®ä¸­æœ‰å¤šä¸ªå‡½æ•°éœ€è¦æ·»åŠ æ—¥å¿—åŠŸèƒ½ï¼Œå³å‡½æ•°æ‰§è¡Œæ—¶å‘ç»ˆç«¯æˆ–è€…æ—¥å¿—æ–‡ä»¶ä¸­è¾“å‡ºç‰¹å®šçš„å†…å®¹ã€‚ æœ‰ä¸€ç§åŠžæ³•å°±æ˜¯åœ¨æ¯ä¸€ä¸ªå‡½æ•°ä¸­æ·»åŠ ä¸Šè‹¥å¹²è¡Œè®°å½•æ—¥å¿—çš„ä»£ç ï¼Œä½†è¿™ç§æ–¹å¼è€—è´¹æ—¶é—´çš„åŒæ—¶ï¼Œä¹Ÿå®¹æ˜“å‡ºçŽ°æ„æƒ³ä¸åˆ°çš„é”™è¯¯ï¼Œæ¯•ç«Ÿä¼šå¯¹åŽŸæœ¬çš„ä»£ç åšå‡ºç›¸å½“å¤§çš„æ”¹åŠ¨ã€‚è€Œå¦ä¸€åŠžæ³•å°±æ˜¯åœ¨æ¯ä¸€ä¸ªå‡½æ•°æˆ–ç±»å‰é¢æ·»åŠ è£…é¥°å™¨ï¼Œé€šè¿‡è£…é¥°å™¨å‘è¢«è£…é¥°å‡½æ•°æ·»åŠ é¢å¤–çš„è¡Œä¸ºï¼ˆè®°å½•æ—¥å¿—ï¼‰ï¼Œè¿™æ ·åœ¨æå‡æ•ˆçŽ‡çš„åŒæ—¶ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´çŽ°æœ‰çš„ä»£ç ä¸­å¼•å…¥äº†æ–°çš„ bug ã€‚ æ¯”è¾ƒå¸¸è§çš„ä¸€ç§è£…é¥°å™¨ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¸€æ®µæœ€ç®€å•çš„ flask åº”ç”¨ä»£ç ï¼š123456789from flask import Flaskapp = Flask(__name__)@app.route(&quot;/&quot;)def hello(): return &quot;Hello World&quot;if __name__ == &apos;__main__&apos;: app.run() ä¸Šé¢çš„ä»£ç é€šè¿‡ route è£…é¥°å™¨å‘ hello å‡½æ•°æ·»åŠ äº†æŸäº›æ•ˆæžœï¼Œåœ¨ä¸å˜æ›´åŽŸ hello å‡½æ•°å†…éƒ¨ä»£ç çš„å‰æä¸‹ï¼Œå°†å…¶å˜æˆäº†æŸä¸ªæ–°å‡½æ•°ä½œä¸º Web åº”ç”¨ä¸­çš„ API æŽ¥å—è°ƒç”¨ ã€‚ ä¸€ã€åˆçº§ç¤ºä¾‹å‡½æ•°ä½œä¸ºå‚æ•°ä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„å‡½æ•°ä»£ç ï¼Œå¯ä»¥ç”¨æ¥å°†æŸä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼š123456789def to_uppercase(text): if not isinstance(text, str): raise TypeError(&quot;Not a string&quot;) return text.upper()text = &quot;Hello World&quot;upper_text = to_uppercase(text)print(upper_text)# =&gt; HELLO WORLD è¿™é‡Œå¯¹ to_uppercase å‡½æ•°åšä¸€ç‚¹å¾®å°çš„æ”¹åŠ¨ï¼š12345678910111213def to_uppercase(func): text = func() if not isinstance(text, str): raise TypeError(&quot;Not a string&quot;) return text.upper()def hello(): return &quot;Hello World&quot;hello = to_uppercase(hello)print(hello)# =&gt; HELLO WORLD ä¸Žä¹‹å‰ç‰ˆæœ¬çš„ to_uppercase ä¸åŒï¼Œæ­¤ç‰ˆæœ¬çš„ to_uppercase å‡½æ•°å¹¶ä¸ç›´æŽ¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼Œè€Œæ˜¯æŽ¥æ”¶æŸä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†è¯¥å‡½æ•°æ‰§è¡ŒåŽè¿”å›žçš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ã€‚ to_uppercase å‡½æ•°å¹¶æ²¡æœ‰æ”¹å˜ hello å‡½æ•°åŽŸæœ¬çš„è¡Œä¸ºï¼ˆè¾“å‡ºå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œæ˜¯åœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ äº†é¢å¤–çš„æ•ˆæžœï¼ˆå°†è¾“å‡ºå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼‰ï¼Œå› è€Œèµ·åˆ°äº†è£…é¥°å™¨çš„ä½œç”¨ã€‚ ä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼ˆä¸¤è€…æ•ˆæžœç›¸åŒï¼‰ï¼š12345678910111213def to_uppercase(func): text = func() if not isinstance(text, str): raise TypeError(&quot;Not a string&quot;) return text.upper()@to_uppercasedef hello(): return &quot;Hello World&quot;print(hello)# =&gt; HELLO WORLD @decorator æ˜¯ Python ä¸­çš„è¯­æ³•ç³–ï¼Œ123@decoratordef func(): ... ç­‰åŒäºŽ123def func(): ...func = decorator(func) å‡½æ•°ä½œä¸ºè¿”å›žå€¼ä»¥ä¸‹ä»£ç ä¸º to_uppercase è£…é¥°å™¨çš„æœ€ç»ˆå½¢å¼ï¼š1234567891011121314151617181920def to_uppercase(func): def wrapper(): text = func() if not isinstance(text, str): raise TypeError(&quot;Not a string type&quot;) return text.upper() return wrapper@to_uppercasedef hello(): return &quot;Hello World&quot;&apos;&apos;&apos;ç­‰åŒäºŽdef hello(): return &quot;Hello World&quot;hello = to_uppercase(hello)&apos;&apos;&apos;print(hello())# =&gt; HELLO WORLD ä¹‹å‰çš„ to_uppercase å‡½æ•°æŽ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼ŒèŽ·å–å…¶è¿”å›žå€¼å¹¶ä½œå‡ºä¿®æ”¹ï¼Œæœ€åŽè¿”å›žä¿®æ”¹åŽçš„ç»“æžœã€‚è€Œæ­¤å¤„çš„ to_uppercase å‡½æ•°åœ¨ä»£ç ä¸­å†…åµŒäº†ä¸€ä¸ª wrapper å‡½æ•°å¹¶å°†å…¶ä½œä¸ºè¿”å›žå€¼ï¼Œwrapper å‡½æ•°ä¸­åŒ…å«äº†å¯¹è¢«è£…é¥°çš„å‡½æ•°åšå‡ºçš„æ”¹åŠ¨ã€‚å³ to_uppercase è£…é¥°å™¨æŽ¥æ”¶è¢«è£…é¥°çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡å†…åµŒå‡½æ•°å¯¹å…¶è¿›è¡Œæ”¹åŠ¨ï¼Œæœ€ç»ˆè¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°æ›¿ä»£è¢«è£…é¥°çš„åŽŸå‡½æ•°ã€‚ å›žåˆ°ä»£ç ä¸­ï¼Œhello å‡½æ•°ç”¨äºŽè¿”å›ž Hello World å­—ç¬¦ä¸²ï¼Œè€Œè£…é¥°å™¨ to_uppercase æŽ¥æ”¶ hello ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡ wrapper å¯¹å…¶æ·»åŠ æ–°çš„è¡Œä¸ºï¼ˆå°†è¿”å›žçš„å­—ç¬¦ä¸²è½¬ä¸ºå¤§å†™ï¼‰å¹¶æ›¿æ¢æŽ‰åŽŸæ¥çš„ hello å‡½æ•°ã€‚å› æ­¤åœ¨ä¸æ”¹å˜åŽŸ hello å‡½æ•°å†…éƒ¨ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è£…é¥°å™¨ç”Ÿæˆäº†æ–°çš„ hello å‡½æ•°ï¼Œæœ€ç»ˆæ”¹å˜äº†åŽŸå‡½æ•°çš„è¡Œä¸ºã€‚ äºŒã€ä½¿ç”¨å¤šä¸ªè£…é¥°å™¨ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122def add_prefix(func): def wrapper(): text = func() result = &quot; &quot;.join([text, &quot;Larry Page!&quot;]) return result return wrapperdef to_uppercase(func): def wrapper(): text = func() if not isinstance(text, str): raise TypeError(&quot;Not a string&quot;) return text.upper() return wrapper()@to_uppercase@add_prefixdef say(): return &quot;welcome&quot;print(say)# =&gt; WELCOME LARRY PAGE! ä¸‰ã€å¸¦å‚æ•°çš„è£…é¥°å™¨ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314def to_uppercase(func): def wrapper(*args, **kwargs): text = func(*args, **kwargs) if not isinstance(text, str): raise TypeError(&quot;Not a string&quot;) return text.upper() return wrapper@to_uppercasedef say(greet): return greetprint(say(&quot;hello, how are you&quot;))# =&gt; HELLO, HOW ARE YOU å››ã€functools.wrapsè¿è¡Œå¦‚ä¸‹è£…é¥°å™¨ä»£ç ï¼š1234567891011121314151617def logging(func): def logs(*args, **kwargs): print(func.__name__ + &quot; was called&quot;) return func(*args, **kwargs) return logs@loggingdef foo(x): &quot;&quot;&quot;Calling function for logging&quot;&quot;&quot; return x * xfo = foo(10)# =&gt; foo was calledprint(foo.__name__)# =&gt; logsprint(foo.__doc__)# =&gt; None ä»Žè¿è¡Œç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œprint(foo.__name__) å¹¶æ²¡æœ‰è¾“å‡º foo ï¼Œè€Œæ˜¯æ‰“å°äº†è£…é¥°å™¨çš„å†…åµŒå‡½æ•° logs çš„åå­—ã€‚å³è¢«è£…é¥°çš„å‡½æ•° foo ç”±æ–°å‡½æ•°æ›¿ä»£åŽï¼Œå…¶ __name__ å’Œ __doc__ ç­‰å±žæ€§ä¹Ÿä¸¢å¤±äº†ã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ functool.wrap ï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819from functools import wrapsdef logging(func): @wraps(func) def logs(*args, **kwargs): print(func.__name__ + &quot; was called&quot;) return func(*args, **kwargs) return logs@loggingdef foo(x): &quot;&quot;&quot;does some math&quot;&quot;&quot; return x * xfo = foo(10)# =&gt; foo was calledprint(foo.__name__)# =&gt; fooprint(foo.__doc__)# =&gt; does some math äº”ã€åœºæ™¯ï¼šåŸºäºŽè£…é¥°å™¨çš„æŽˆæƒå¾ˆå¤š Web API éƒ½éœ€è¦ç”¨æˆ·æºå¸¦è®¤è¯ä¿¡æ¯æ‰èƒ½è®¿é—®ï¼Œå½“ç„¶å¯ä»¥åœ¨æ¯ä¸€æ®µ API çš„ä»£ç ä¸­åŠ å…¥æ£€æŸ¥æŽˆæƒçŠ¶æ€çš„ç‰‡æ®µï¼Œæ›´ä¾¿æ·çš„æ–¹å¼åˆ™æ˜¯ä½¿ç”¨è£…é¥°å™¨ã€‚å¦‚ï¼š12345678910from functools import wraps def requires_auth(func): @wraps(func) def wrapper(*args, **kwargs): auth = request.authorization if not auth or not check_auth(auth.username, auth.password): authenticate() return func(*args, **kwargs) return wrapper åˆ™æ¯ä¸€ä¸ªè¢« require_auth è£…é¥°çš„å‡½æ•°æ‰§è¡Œå‰ï¼Œéƒ½ä¼šå…ˆèŽ·å–æŽˆæƒä¿¡æ¯å¹¶éªŒè¯ã€‚ å‚è€ƒèµ„æ–™Clean PythonPython å‡½æ•°è£…é¥°å™¨]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Function</tag>
        <tag>Programming</tag>
        <tag>Language</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Tricks â€”â€” ä½¿ç”¨ asciinema å½•åˆ¶å‘½ä»¤è¡Œæ“ä½œ]]></title>
    <url>%2F2019%2F08%2F25%2Fusing-asciinema-to-record-Linux-terminal-sessions%2F</url>
    <content type="text"><![CDATA[asciinema æ˜¯ä¸€ä¸ªç”± Python è¯­è¨€ç¼–å†™çš„å¼€æºçš„ç»ˆç«¯ä¼šè¯å½•åˆ¶å·¥å…·ã€‚å®ƒå¯ä»¥å°†å‘½ä»¤è¡Œçš„è¾“å‡ºå†…å®¹æ ¹æ®æ—¶é—´ä¿å­˜åœ¨ JSON æ ¼å¼çš„æ–‡ä»¶ä¸­ï¼Œä»¥ä¾›åŽç»­æ’­æ”¾æ—¶ä½¿ç”¨ã€‚åŒæ—¶è¯¥å½•åˆ¶æ–‡ä»¶ä¹Ÿå¯ä»¥é€šè¿‡ Web æµè§ˆå™¨è¿›è¡Œæ’­æ”¾ï¼ˆéœ€è¦ä½¿ç”¨ç”± asciinema-player æä¾›çš„ Javascript å’Œ CSS æ–‡ä»¶ï¼‰ï¼Œæˆ–è€…ç›´æŽ¥ä¸Šä¼ åˆ° asciinema.org ç½‘ç«™åˆ†äº«ç»™å…¶ä»–äº’è”ç½‘ç”¨æˆ·ã€‚ ä¸€ã€script å‘½ä»¤script å‘½ä»¤æ˜¯ Linux ç³»ç»Ÿè‡ªå¸¦ä¸€ä¸ªçš„ç»ˆç«¯å½•åˆ¶å·¥å…·ï¼ŒåŠŸèƒ½ä¸Ž asciinema ç±»ä¼¼ï¼Œå¯ä»¥å°†ç»ˆç«¯äº¤äº’å†…å®¹ä¿å­˜åœ¨æœ¬åœ°çš„æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå†ä½¿ç”¨ scriptreplay å‘½ä»¤è¿›è¡Œæ’­æ”¾ã€‚ å½•åˆ¶ï¼šscript -t 2&gt;time.file -a output.file å…¶ä¸­ time.file ç”¨äºŽä¿å­˜æ—¶é—´ä¿¡æ¯ï¼Œoutput.file åˆ™ç”¨äºŽè®°å½•ç»ˆç«¯è¾“å‡ºçš„å†…å®¹åŠå…‰æ ‡çš„ç§»åŠ¨ç­‰ã€‚å½•åˆ¶å®Œæˆæ—¶ä½¿ç”¨ exit å‘½ä»¤æˆ–è€… Ctrl+D ç»ˆæ­¢å½•åˆ¶ã€‚ æ’­æ”¾ï¼šscriptreplay time.file output.file äºŒã€asciinema æœ¬åœ°å½•åˆ¶asciinema å®‰è£…æ¯”è¾ƒç®€å•ï¼Œç›´æŽ¥ä½¿ç”¨ pip å‘½ä»¤å³å¯ï¼š$ pip install asciinema å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†ç»ˆç«¯å†…å®¹å½•åˆ¶åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼š$ asciinema rec demo.castå®ŒæˆåŽä½¿ç”¨ exit æˆ– Ctrl+D ç»“æŸå½•åˆ¶ã€‚ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ’­æ”¾å‰é¢å½•åˆ¶çš„å†…å®¹ï¼š$ asciinema play demo.castæ’­æ”¾æ—¶å¯ä½¿ç”¨ -s &lt;n&gt; é€‰é¡¹æŽ§åˆ¶å›žæ”¾çš„é€Ÿåº¦ï¼Œå…¶ä¸­ n ä¸ºè¡¨ç¤ºå€çŽ‡çš„æ•°å­—ï¼Œæ•°å€¼è¶Šå¤§æ’­æ”¾é€Ÿåº¦è¶Šå¿«ã€‚ å…¶ä»–é€‰é¡¹çš„ä½¿ç”¨æ–¹æ³•å¯é€šè¿‡ asciinema rec -h æˆ– asciinema play -h å‘½ä»¤æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚ ä¸‰ã€æµè§ˆå™¨æ’­æ”¾æµè§ˆå™¨æ’­æ”¾å½•åˆ¶æ–‡ä»¶éœ€è¦å€ŸåŠ© asciinema-player é¡¹ç›®æä¾›çš„ä¸¤ä¸ªåº“æ–‡ä»¶ asciinema-player.css å’Œ asciinema-player.js ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥ä»Žè¯¥ Github é¡¹ç›®çš„ release ä¸­ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡ CDN é“¾æŽ¥å¼•å…¥ã€‚ ç¤ºä¾‹ HTML ä»£ç ï¼ˆæ³¨æ„æ–°å¢žçš„ asciinema-player æ ‡ç­¾ï¼‰å¦‚ä¸‹ï¼š123456789&lt;html&gt;&lt;head&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;asciinema-player.css&quot; /&gt;&lt;/head&gt;&lt;body&gt; &lt;asciinema-player src=&quot;demo.cast&quot;&gt;&lt;/asciinema-player&gt; &lt;script src=&quot;asciinema-player.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ’­æ”¾æ•ˆæžœå¦‚ä¸‹ï¼š å››ã€ä¸Šä¼ è‡³ asciinema.orgé¦–å…ˆè®¿é—® asciinema.org åˆ›å»ºä¸€ä¸ªæ–°è´¦æˆ·ã€‚å†ä½¿ç”¨ asciinema auth å‘½ä»¤ç”Ÿæˆè‡ªå·±ç”µè„‘ç‹¬æœ‰çš„ ID ï¼š123456$ asciinema authOpen the following URL in a web browser to link your install ID with your asciinema.org user account:https://asciinema.org/connect/636713f1-db74-41c5-bb45-97fc213f3c94This will associate all recordings uploaded from this machine (past and future ones) to your account, and allow you to manage them (change title/theme, delete) at asciinema.org. é€šè¿‡æµè§ˆå™¨è®¿é—®ä¸Šé¢ç”Ÿæˆçš„é“¾æŽ¥å®Œæˆç»‘å®šï¼Œåˆ™æ­¤å°è®¾å¤‡ä¸Šä½¿ç”¨ asciinema rec å½•åˆ¶çš„å†…å®¹éƒ½å°†è‡ªåŠ¨ä¸Šä¼ è‡³ä¹‹å‰åˆ›å»ºçš„è´¦æˆ·ä¸­ã€‚ å½•åˆ¶ï¼šasciinema recåœæ­¢å½•åˆ¶åŽæŒ‰ä¸‹å›žè½¦é”®è‡ªåŠ¨ä¸Šä¼ è‡³äº‘ç«¯å¹¶è¿”å›žæ’­æ”¾é“¾æŽ¥ã€‚123456asciinema: recording finishedasciinema: press &lt;enter&gt; to upload to asciinema.org, &lt;ctrl-c&gt; to save locallyView the recording at: https://asciinema.org/a/9WlhbT4qnTr5cFWQQZNS0auIY æ’­æ”¾ï¼šasciinema play &lt;link&gt; ä¸ªäººè´¦æˆ·ç•Œé¢å¦‚ä¸‹ï¼š å¦‚ä¸æ–¹ä¾¿å°†å½•åˆ¶å†…å®¹æ”¾ç½®äºŽå¤–éƒ¨çš„å…¬ç½‘æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæ­å»ºç±»ä¼¼çš„ç§äººæœåŠ¡å™¨ã€‚å‚è€ƒ asciinema-server é¡¹ç›®ï¼Œå¯ä½¿ç”¨ docker å¿«é€Ÿè¿›è¡Œéƒ¨ç½²ï¼Œä¸å†åšè¯¦ç»†è¯´æ˜Žã€‚ æ³¨æ„éƒ¨ç½²æˆåŠŸåŽä¿®æ”¹ ~/.config/asciinema/config é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š12[api]url = https://your.asciinema.host å‚è€ƒèµ„æ–™asciinema Docs]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Tricks</tag>
        <tag>Terminal</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Tricks â€”â€” ä½¿ç”¨ Supervisor æŽ§åˆ¶ Linux è¿›ç¨‹]]></title>
    <url>%2F2019%2F08%2F24%2Fusing-supervisor-to-control-Linux-processes%2F</url>
    <content type="text"><![CDATA[Supervisor æ˜¯ä¸€ä¸ª C/S æž¶æž„çš„è¿›ç¨‹æŽ§åˆ¶ç³»ç»Ÿï¼Œå®Œå…¨ç”± Python è¯­è¨€ç¼–å†™ã€‚å®ƒå…è®¸ç”¨æˆ·ç›‘è§†å’ŒæŽ§åˆ¶ç±» Unix ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚ åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œä¸€èˆ¬å¯ä»¥ä½¿ç”¨ service &lt;service-name&gt; start|stop|restart æˆ–è€… systemctl start|stop|restart &lt;service-name&gt; ç­‰å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæœåŠ¡çš„è¿›ç¨‹å®žä¾‹ã€‚å®žé™…ä¸Šï¼Œservice å’Œ systemctl å‘½ä»¤éƒ½æ˜¯é€šè¿‡è°ƒç”¨ /etc/init.d/ ç›®å½•ä¸‹çš„å¯åŠ¨è„šæœ¬å¯¹æœåŠ¡è¿›è¡ŒæŽ§åˆ¶ã€‚ ç›¸å¯¹è€Œè¨€ï¼Œè¿™ç±»å¯åŠ¨è„šæœ¬åœ¨ç¼–å†™å’Œç»´æŠ¤ä¸Šéƒ½éœ€è¦è€—è´¹æ¯”è¾ƒå¤§çš„ç²¾åŠ›ã€‚è€Œ Supervisor åªé€šè¿‡ä¸€ä¸ªç®€å•çš„ INI æ ¼å¼çš„é…ç½®æ–‡ä»¶å³èƒ½å®Œæˆå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹çš„é›†ä¸­ç®¡ç†ï¼Œä¸”èƒ½å¤ŸæŽ§åˆ¶è¿›ç¨‹åœ¨å´©æºƒåŽè‡ªåŠ¨é‡å¯ã€‚åŒæ—¶ï¼ŒSupervisor è¿˜æ”¯æŒå¯¹è¿›ç¨‹è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ä¸ºç»„ä¸­çš„è¿›ç¨‹åˆ†é…ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥æŒ‰é¢„å…ˆå®šä¹‰çš„é¡ºåºè¿›è¡Œå¯åŠ¨ã€‚ ä¸€ã€è½¯ä»¶å®‰è£…Supervisor æ”¯æŒ Linuxã€MacOSã€Solaris å’Œ FreeBSD ç­‰æ“ä½œç³»ç»Ÿï¼Œç›´æŽ¥ä½¿ç”¨å¯¹åº”çš„åŒ…ç®¡ç†å‘½ä»¤å®‰è£…å³å¯ã€‚å¦‚ Ubuntu ç³»ç»Ÿï¼š$ sudo apt-get install supervisor Supervisor å®Œå…¨ç”± Python è¯­è¨€ç¼–å†™ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ pip å‘½ä»¤å®‰è£…ï¼Œä¹Ÿæ”¯æŒå®‰è£…åˆ°ç”± virtualenv ç­‰å·¥å…·æž„å»ºçš„è™šæ‹ŸçŽ¯å¢ƒä¸­ã€‚$ pip install supervisor ç»„ä»¶ä»‹ç»supervisordsupervisord æ˜¯ Supervisor çš„æœåŠ¡ç«¯ç»„ä»¶ï¼Œè´Ÿè´£æŽ§åˆ¶å­è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€å“åº”å®¢æˆ·ç«¯ç»„ä»¶çš„å‘½ä»¤è¯·æ±‚ã€é‡å¯å´©æºƒçš„è¿›ç¨‹ä»¥åŠæ—¥å¿—è®°å½•ç­‰å·¥ä½œã€‚supervisord ä½¿ç”¨ Windows-INI æ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚ supervisorctlsupervisorctl æ˜¯ä¸€ä¸ªå€ŸåŠ©å‘½ä»¤è¡Œè¿›è¡Œäº¤äº’å¼æ“ä½œçš„å®¢æˆ·ç«¯ç»„ä»¶ï¼Œå®ƒå¯ä»¥é€šè¿‡ç±»ä¼¼ Shell çš„æŽ¥å£è®¿é—® supervisord æä¾›çš„åŠŸèƒ½ã€‚ Web Serverå¦‚ Supervisor é…ç½®æ–‡ä»¶ä¸­çš„ [inet_http_server] é¡¹è¢«å¯ç”¨ï¼Œåˆ™å¯ä»¥é€šè¿‡è®¿é—® http://localhost:9001 è¿›å…¥ä¸€ä¸ªåŠŸèƒ½ç±»ä¼¼ supervisorctl çš„ Web äº¤äº’ç•Œé¢ã€‚ XML-RPC æŽ¥å£Supervisor çš„ HTTP æœåŠ¡è¿˜æä¾›äº† XML-RPC æŽ¥å£ï¼Œå‚è€ƒ XML-RPC API Documentation äºŒã€é…ç½®æ–‡ä»¶Supervisor çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬å‘½åä¸º supervisord.confã€‚å®ƒå¯ä»¥åŒæ—¶è¢« supervisord å’Œ supervisorctl ä½¿ç”¨ï¼ˆé€šè¿‡ -c é€‰é¡¹æŒ‡å®šï¼‰ã€‚å¦‚æ‰§è¡Œä¸Šè¿°ä¸¤ä¸ªå‘½ä»¤æ—¶å¹¶æœªæ‰‹åŠ¨æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œåˆ™ä¾æ¬¡åœ¨ä»¥ä¸‹ä½ç½®æŸ¥æ‰¾åä¸º supervisord.conf çš„é…ç½®æ–‡ä»¶ï¼š $CWD/supervisord.conf $CWD/etc/supervisord.conf /etc/supervisord.conf /etc/supervisor/supervisord.conf ../etc/supervisord.conf ../supervisord.conf Section Settingsé…ç½®æ–‡ä»¶ä¸­çš„ [inet_http_server] ç”¨äºŽé…ç½®å¯ä¾›è¿œç¨‹è®¿é—®çš„ HTTP æœåŠ¡ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š1234[inet_http_server]port = 127.0.0.1:9001username = userpassword = 123 [supervisord] ç”¨äºŽé…ç½® supervisord è¿›ç¨‹çš„ä¸€äº›å…¨å±€é€‰é¡¹ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617[supervisord]logfile = /tmp/supervisord.loglogfile_maxbytes = 50MBlogfile_backups=10loglevel = infopidfile = /tmp/supervisord.pidnodaemon = falseminfds = 1024minprocs = 200umask = 022user = chrismidentifier = supervisordirectory = /tmpnocleanup = truechildlogdir = /tmpstrip_ansi = falseenvironment = KEY1=&quot;value1&quot;,KEY2=&quot;value2&quot; [supervisorctl] ç”¨äºŽæŽ§åˆ¶äº¤äº’å¼ Shell supervisorctl çš„è¡Œä¸ºï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š12345[supervisorctl]serverurl = unix:///tmp/supervisor.sockusername = chrispassword = 123prompt = mysupervisor [program:x]é…ç½®æ–‡ä»¶ä¸­éœ€è¦è‡³å°‘åŒ…å«ä¸€ä¸ª [program:x] é¡¹ç”¨äºŽæŒ‡å®šæŸä¸ªç”± Supervisor æŽ§åˆ¶çš„è¿›ç¨‹ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930[program:cat]command=/bin/catprocess_name=%(program_name)snumprocs=1directory=/tmpumask=022priority=999autostart=trueautorestart=unexpectedstartsecs=10startretries=3exitcodes=0stopsignal=TERMstopwaitsecs=10stopasgroup=falsekillasgroup=falseuser=chrismredirect_stderr=falsestdout_logfile=/a/pathstdout_logfile_maxbytes=1MBstdout_logfile_backups=10stdout_capture_maxbytes=1MBstdout_events_enabled=falsestderr_logfile=/a/pathstderr_logfile_maxbytes=1MBstderr_logfile_backups=10stderr_capture_maxbytes=1MBstderr_events_enabled=falseenvironment=A=&quot;1&quot;,B=&quot;2&quot;serverurl=AUTO [include] å¯ä»¥ç”¨æ¥å¼•å…¥å…¶ä»–ä½ç½®çš„é…ç½®æ–‡ä»¶ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š12[include]files = /an/absolute/filename.conf /an/absolute/*.conf foo.conf config??.conf ä¸‰ã€å®žä¾‹æ¼”ç¤ºå¯¹äºŽä¸€ä¸ªåˆå§‹çš„ Django é¡¹ç›®ï¼Œå¯ä»¥é€šè¿‡åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ python manage.py runserver å‘½ä»¤å¯åŠ¨ Web æœåŠ¡ã€‚è¿™é‡Œä½¿ç”¨ Supervisor æŽ§åˆ¶æœåŠ¡è¿›ç¨‹ã€‚ é¦–å…ˆåœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º supervisord.conf é…ç½®æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡ echo_supervisord_conf å‘½ä»¤èŽ·å–ç¤ºä¾‹é…ç½®å¹¶å®šå‘åˆ° supervisord.conf æ–‡ä»¶ä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ echo_supervisord_conf &gt; supervisord.conf è¯¥ç¤ºä¾‹é…ç½®ä¸­å¹¶ä¸åŒ…å«ä»»ä½• [program:x] é¡¹ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ ã€‚è¿™é‡Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œå†…å®¹ï¼š12[include]files = ./django_server.ini å³ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè¿™é‡Œä¸æŠŠ Supervisor æŽ§åˆ¶çš„è¿›ç¨‹åŒ…å«åœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯æ”¾ç½®åœ¨å½“å‰ç›®å½•ä¸‹çš„ django_server.ini æ–‡ä»¶ä¸­ï¼Œå†é€šè¿‡ä¸»é…ç½®æ–‡ä»¶ä¸­çš„ [include] å°†å…¶å¯¼å…¥ã€‚django_server.ini æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š12345678910111213[program:django_server]command=python manage.py runserver 0000:8000 ;ç¨‹åºå¯åŠ¨å‘½ä»¤process_name=%(program_name)s ;è¿›ç¨‹åç§°directory=/home/starky/project/django/test_project ;å¯åŠ¨ç›®å½•autostart=true ;è‡ªåŠ¨å¯åŠ¨autorestart=unexpected ;å¼‚å¸¸é€€å‡ºåŽè‡ªåŠ¨é‡å¯startsecs=10 ;ç¨‹åºå¯åŠ¨ 10 ç§’åŽæœªå¼‚å¸¸é€€å‡ºï¼Œåˆ™æ­£å¸¸å¯åŠ¨startretries=3 ;è‡ªåŠ¨é‡å¯å°è¯•æ¬¡æ•°user=starky ;å¯åŠ¨è¯¥è¿›ç¨‹çš„ç”¨æˆ·redirect_stderr=true ;stderr é‡å®šå‘è‡³ stdout ã€‚é»˜è®¤ falsestdout_logfile_maxbytes=20MB ;stdout æ—¥å¿—å¤§å°ï¼Œé»˜è®¤ 50MBstdout_log_backups=10 ;stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°é‡stdout_logfile=./logs/django_server.log ;stdout æ—¥å¿—è·¯å¾„ã€‚ç›®å½•ä¸å­˜åœ¨æ—¶éœ€æ‰‹åŠ¨åˆ›å»º é…ç½®å®ŒæˆåŽï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ supervisord ç¨‹åºï¼š$ supervisord -c supervisord.conf è¿è¡Œ supervisorctl å‘½ä»¤è¿›å…¥äº¤äº’å¼ Shell ï¼Œå¯ä»¥çœ‹åˆ° django_server.ini ä¸­é…ç½®çš„ django_server ç¨‹åºå·²ç»å¯åŠ¨æˆåŠŸï¼š123$ supervisorctldjango_server RUNNING pid 6210, uptime 0:00:15supervisor&gt; Web Serverå‡ºäºŽå®‰å…¨ä¸Šçš„è€ƒè™‘ï¼ŒSupervisor æä¾›çš„ Web Server é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶ supervisord.conf è¿›è¡Œå¯ç”¨ã€‚åˆ é™¤ä»¥ä¸‹å†…å®¹å‰çš„æ³¨é‡Šå³å¯ï¼š1234[inet_http_server] ; inet (TCP) server disabled by defaultport=0.0.0.0:9001 ; ip_address:port specifier, *:port for all ifaceusername=user ; default is no username (open server)password=123 ; default is no password (open server) é…ç½®å®ŒæˆåŽï¼Œé¦–å…ˆä½¿ç”¨ pkill -9 supervisord å‘½ä»¤é€€å‡º supervisord ç¨‹åºï¼Œå†ä½¿ç”¨ supervisord -c supervisord.conf å‘½ä»¤é‡æ–°å¯åŠ¨ã€‚æ­¤æ—¶é€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:9001/ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç åŽå³å¯è¿›å…¥ Web æŽ§åˆ¶å°ç•Œé¢ï¼š supervisorctlsupervisorctl æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„ Shell ï¼Œå¯ä»¥é€šè¿‡å®ƒè®¿é—® supervisord æä¾›çš„éƒ¨åˆ†åŠŸèƒ½ï¼ˆå¦‚å¯åŠ¨å’Œåœæ­¢æŸä¸ªè¿›ç¨‹ã€æŸ¥çœ‹æ—¥å¿—ç­‰ï¼‰ã€‚å®ƒæ”¯æŒçš„åŸºæœ¬å‘½ä»¤å¦‚ä¸‹ï¼š12345678$ supervisorctldjango_server RUNNING pid 8661, uptime 0:14:11supervisor&gt; helpdefault commands (type help &lt;topic&gt;):=====================================add exit open reload restart start tailavail fg pid remove shutdown status updateclear maintail quit reread signal stop version è¾“å…¥ help &lt;topic&gt; å¯ä»¥æŸ¥çœ‹å¯¹åº”å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ã€‚ å¸¸ç”¨å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š help : Print a list of available actions help &lt;action&gt; : Print help for add &lt;name&gt; [...] : Activates any updates in config for process/group remove &lt;name&gt; [...] : Removes process/group from active config update : Reload config and add/remove as necessary, and will restart affected programs update all : Reload config and add/remove as necessary, and will restart affected programs update &lt;gname&gt; [...] : Update specific groups, and will restart affected programs clear &lt;name&gt; : Clear a processâ€™ log files. clear &lt;name&gt; &lt;name&gt; : Clear multiple processâ€™ log files clear all : Clear all processâ€™ log files fg &lt;process&gt; : Connect to a process in foreground mode Press Ctrl+C to exit foreground pid : Get the PID of supervisord. pid &lt;name&gt; : Get the PID of a single child process by name. pid all : Get the PID of every child process, one per line. reload : Restarts the remote supervisord reread : Reload the daemonâ€™s configuration files, without add/remove (no restarts) start | stop | restart &lt;name&gt; : Start / Stop / Restart a process start | stop | restart &lt;gname&gt;:* : Start / Stop / Restart all processes in a group. start | stop | restart &lt;name&gt; &lt;name&gt; : Start / Stop / Restart multiple processes or groups start | stop | restart all : Start / Stop / Restart all processes. Note: restart does not reread config files. status : Get all process status info. status &lt;name&gt; : Get status on a single process by name. status &lt;name&gt; &lt;name&gt; : Get status on multiple named processes. tail &lt;name&gt; [stdout|stderr] (default stdout) : Output the last part of process logs tail -f &lt;name&gt; : Continuous tail of named process stdout Ctrl-C to exit tail -100 &lt;name&gt; : last 100 bytes of process stdout å‚è€ƒèµ„æ–™Supervisord Docs]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
        <tag>Server</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux ç£ç›˜è®¾å¤‡å’Œ LVM ç®¡ç†å‘½ä»¤è¯¦è§£]]></title>
    <url>%2F2019%2F08%2F11%2FLinux-disk-and-lvm-management%2F</url>
    <content type="text"><![CDATA[ä¸€ã€è®¾å¤‡æ–‡ä»¶åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œè®¾å¤‡æ–‡ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶ç»å¤§å¤šæ•°ä½äºŽ /dev ç›®å½•ä¸‹ï¼Œç”¨æ¥è¡¨ç¤º Linux ä¸»æœºæ£€æµ‹åˆ°çš„æŸä¸ªå…·ä½“çš„ç¡¬ä»¶è®¾å¤‡ã€‚æ¯”å¦‚ /dev/sda æ–‡ä»¶é€šå¸¸ç”¨æ¥æŒ‡ä»£ç³»ç»Ÿä¸­çš„ç¬¬ä¸€å—ç¡¬ç›˜ã€‚Linux æ“ä½œç³»ç»ŸåŠå…¶åº”ç”¨ä¸ŽæœåŠ¡åˆ™é€šè¿‡è¿™äº›è®¾å¤‡æ–‡ä»¶ä¸Žå¯¹åº”çš„ç¡¬ä»¶è®¾å¤‡è¿›è¡Œäº¤äº’ã€‚ å¯¹äºŽå¸¸è§çš„ç£ç›˜ï¼ˆATAã€SATAã€SCSIã€SASã€SSD ç­‰ï¼‰å’Œä¼˜ç›˜ç­‰å—å­˜å‚¨è®¾å¤‡ï¼Œå…¶è®¾å¤‡æ–‡ä»¶ä¸»è¦ä»¥ sd* çš„å½¢å¼å‘½åã€‚å¦‚ sda è¡¨ç¤ºç¬¬ä¸€å—ç¡¬ç›˜ï¼Œsdb2 è¡¨ç¤ºç¬¬äºŒå—ç¡¬ç›˜çš„ç¬¬äºŒä¸ªåˆ†åŒºï¼Œä»¥æ­¤ç±»æŽ¨ã€‚å› æ­¤ï¼Œå¯ç›´æŽ¥ä½¿ç”¨ ls -l /dev/sd* å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä¸­çš„ç£ç›˜è®¾å¤‡ï¼š123$ ls -l /dev/sd*brw-rw---- 1 root disk 8, 0 8æœˆ 7 00:47 /dev/sdabrw-rw---- 1 root disk 8, 1 8æœˆ 7 00:47 /dev/sda1 å³å½“å‰ç³»ç»Ÿä¸­åªè¿žæŽ¥äº†ä¸€å—ç¡¬ç›˜ï¼ˆ/dev/sdaï¼‰ï¼Œä¸”è¯¥ç¡¬ç›˜åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼ˆ/dev/sda1ï¼‰ã€‚ äºŒã€åˆ†åŒºåˆ†åŒºå¯ä»¥ç†è§£ä¸ºå°†ä¸€æ•´å—ç¡¬ç›˜åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªç›¸äº’ç‹¬ç«‹çš„å­˜å‚¨åŒºåŸŸã€‚ æ¯”å¦‚å¯ä»¥å°†ç³»ç»Ÿçš„ç¬¬ä¸€å—ç¡¬ç›˜åˆ’åˆ†ä¸º 3 ä¸ªåˆ†åŒºï¼Œåˆ†åˆ«ä¸º sda1ã€sda2ã€sda3 ã€‚sda1 ç”¨äºŽæŒ‚è½½æ ¹ç›®å½•ï¼ˆ/ï¼‰ï¼Œsda2 æŒ‚è½½ /var ï¼Œsda3 æŒ‚è½½ /home ç›®å½•ã€‚åˆ™å³ä½¿ /var ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶ç­‰å ç”¨äº† sda2 å…¨éƒ¨çš„å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–ä¸¤ä¸ªåˆ†åŒºçš„ä½¿ç”¨ã€‚ å¯ä»¥ä½¿ç”¨ fdisk -l å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä¸­çš„ç£ç›˜å’Œåˆ†åŒºä¿¡æ¯ï¼š1234567891011$ sudo fdisk -lDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectorsDisk model: VBOX HARDDISKUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0x20985120Device Boot Start End Sectors Size Id Type/dev/sda1 2048 20964824 20962777 10G 83 Linux åˆ›å»ºç£ç›˜åˆ†åŒºfdisk å‘½ä»¤è¿˜å¯ä»¥ç”¨æ¥å¯¹ç¡¬ç›˜è¿›è¡Œåˆ†åŒºæ“ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºæ–°åˆ†åŒºã€åˆ é™¤å·²æœ‰çš„åˆ†åŒºã€åˆ›å»ºåˆ†åŒºè¡¨ç­‰ã€‚æˆ‘è¿™é‡Œé€šè¿‡ VirtualBox è½¯ä»¶ä¸ºè™šæ‹Ÿæœºä¸­çš„ Linux ç³»ç»Ÿæ·»åŠ äº†ä¸€å—ç©ºç™½çš„è™šæ‹Ÿç¡¬ç›˜ã€‚ä½¿ç”¨ fdisk -l å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿæ£€æµ‹åˆ°çš„ç¡¬ç›˜è®¾å¤‡ï¼š123456789101112131415161718$ sudo fdisk -lDisk /dev/sda: 10 GiB, 10737418240 bytes, 20971520 sectorsDisk model: VBOX HARDDISKUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0x20985120Device Boot Start End Sectors Size Id Type/dev/sda1 2048 20964824 20962777 10G 83 LinuxDisk /dev/sdb: 5 GiB, 5368709120 bytes, 10485760 sectorsDisk model: VBOX HARDDISKUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytes æ­¤æ—¶ç³»ç»Ÿä¸­å¤šäº†ä¸€å—ä¸åŒ…å«ä»»ä½•åˆ†åŒºçš„æ–°ç¡¬ç›˜ /dev/sdb ã€‚ ä½¿ç”¨ fdisk /dev/sdb å‘½ä»¤å¯¹æ–°ç¡¬ç›˜è¿›è¡Œåˆ†åŒºæ“ä½œï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546$ sudo fdisk /dev/sdbWelcome to fdisk (util-linux 2.33.1).Changes will remain in memory only, until you decide to write them.Be careful before using the write command.Device does not contain a recognized partition table.Created a new DOS disklabel with disk identifier 0xce119026.Command (m for help): mHelp: DOS (MBR) a toggle a bootable flag b edit nested BSD disklabel c toggle the dos compatibility flag Generic d delete a partition F list free unpartitioned space l list known partition types n add a new partition p print the partition table t change a partition type v verify the partition table i print information about a partition Misc m print this menu u change display/entry units x extra functionality (experts only) Script I load disk layout from sfdisk script file O dump disk layout to sfdisk script file Save &amp; Exit w write table to disk and exit q quit without saving changes Create a new label g create a new empty GPT partition table G create a new empty SGI (IRIX) partition table o create a new empty DOS partition table s create a new empty Sun partition table è¿›å…¥ fdisk ç¨‹åºç•Œé¢ä¹‹åŽï¼ŒæŒ‰ä¸‹ m é”®å¹¶å›žè½¦ï¼Œå³å¯æ‰“å°å¸®åŠ©ä¿¡æ¯ï¼ŒèŽ·å–è¯¥ç•Œé¢ä¸‹æ”¯æŒçš„äº¤äº’å¼å‘½ä»¤ã€‚æ¯”å¦‚è¾“å…¥ p å¯ä»¥ç”¨æ¥è¾“å‡ºå½“å‰ç¡¬ç›˜çš„åˆ†åŒºä¿¡æ¯ï¼Œè¾“å…¥ n åˆ›å»ºæ–°çš„åˆ†åŒºï¼Œè¾“å…¥ d åˆ é™¤å·²æœ‰çš„åˆ†åŒºã€‚åœ¨å¯¹åˆ†åŒºè¿›è¡Œä»»ä½•æ“ä½œä¹‹åŽï¼Œæœ€åŽéƒ½éœ€è¦ä½¿ç”¨ w å°†ä¹‹å‰çš„æ‰€æœ‰æ›´æ”¹å†™å…¥ç¡¬ç›˜ã€‚ è¿™é‡Œå…ˆæŒ‰ä¸‹ n å¼€å§‹æ–°åˆ†åŒºçš„åˆ›å»ºï¼Œæ ¹æ®æç¤ºé€‰æ‹©åˆ†åŒºç±»åž‹ï¼ˆp è¡¨ç¤ºä¸»åˆ†åŒºï¼Œe è¡¨ç¤ºæ‰©å±•åˆ†åŒºï¼‰ï¼Œè¿›ä¸€æ­¥é€‰æ‹©åˆ†åŒºç¼–å·å’Œç¬¬ä¸€ä¸ªæ‰‡åŒºçš„ä½ç½®ï¼ˆä¸€èˆ¬é»˜è®¤å³å¯ï¼‰ï¼Œæœ€åŽè¾“å…¥æ–°åˆ†åŒºä¸­æœ€åŽä¸€ä¸ªæ‰‡åŒºçš„ä½ç½®ï¼ˆä¹Ÿå¯ä»¥ç›´æŽ¥æŒ‡å®šåˆ†åŒºå¤§å°ï¼‰ï¼Œæ ¼å¼ä¸º +/-sectors æˆ– +/-size ã€‚å¦‚è¾“å…¥ +3G åˆ™è¡¨ç¤ºåˆ›å»ºå¤§å°ä¸º 3 GB çš„æ–°åˆ†åŒºã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š123456789101112131415161718192021Command (m for help): nPartition type p primary (0 primary, 0 extended, 4 free) e extended (container for logical partitions)Select (default p): pPartition number (1-4, default 1):First sector (2048-10485759, default 2048):Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (2048-10485759, default 10485759): +3GCreated a new partition 1 of type &apos;Linux&apos; and of size 3 GiB.Command (m for help): nPartition type p primary (1 primary, 0 extended, 3 free) e extended (container for logical partitions)Select (default p): pPartition number (2-4, default 2):First sector (6293504-10485759, default 6293504):Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (6293504-10485759, default 10485759):Created a new partition 2 of type &apos;Linux&apos; and of size 2 GiB. å†ç”¨åŒæ ·çš„æ­¥éª¤å°†ç£ç›˜çš„å‰©ä½™ç©ºé—´åˆ’åˆ†ä¸ºå¦ä¸€ä¸ªåˆ†åŒºã€‚æ­¤æ—¶æŸ¥çœ‹åˆ†åŒºä¿¡æ¯ï¼ŒåŽŸæœ¬ç©ºç™½çš„ 5GB æ–°ç¡¬ç›˜ sdb å·²ç»è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªåˆ†åŒº sdb1 å’Œ sdb2 ï¼š123456789101112Command (m for help): pDisk /dev/sdb: 5 GiB, 5368709120 bytes, 10485760 sectorsDisk model: VBOX HARDDISKUnits: sectors of 1 * 512 = 512 bytesSector size (logical/physical): 512 bytes / 512 bytesI/O size (minimum/optimal): 512 bytes / 512 bytesDisklabel type: dosDisk identifier: 0xce119026Device Boot Start End Sectors Size Id Type/dev/sdb1 2048 6293503 6291456 3G 83 Linux/dev/sdb2 6293504 10485759 4192256 2G 83 Linux éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœæ­¤æ—¶æŒ‰ä¸‹ q æŒ‰é”®ç›´æŽ¥é€€å‡º fdisk ç¨‹åºï¼Œåˆ™ä¹‹å‰æ‰€åšçš„å…¨éƒ¨æ“ä½œéƒ½ä¸ä¼šè¢«ä¿å­˜ã€‚å¦‚ç¡®è®¤å‰é¢å¯¹ç¡¬ç›˜çš„æ“ä½œæ²¡æœ‰é—®é¢˜ï¼Œåº”ä½¿ç”¨ w å‘½ä»¤å°†æ–°çš„åˆ†åŒºä¿¡æ¯å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚ç±»ä¼¼äºŽç¼–è¾‘æ–‡ä»¶æ—¶çš„ä¿å­˜å¹¶é€€å‡ºã€‚ ä¸‰ã€æ–‡ä»¶ç³»ç»Ÿå¯ä»¥å°†ç£ç›˜ç­‰å­˜å‚¨è®¾å¤‡çœ‹ä½œä¸€ä¸ªå°åž‹çš„å›¾ä¹¦é¦†ï¼Œå­˜æ”¾åœ¨å…¶ä¸­çš„ä¹¦ç±å³ç¡¬ç›˜ä¸­çš„æ•°æ®ï¼Œè€Œåˆ†åŒºçš„ä½œç”¨ç±»ä¼¼äºŽå¯¹ä¹¦ç±åˆ†é—¨ç±»å­˜æ”¾çš„ä¹¦æž¶ï¼Œå½¢æˆç›¸å¯¹ç‹¬ç«‹çš„åŒºåŸŸã€‚ä½†æ˜¯ä¹¦æž¶ä¸Šçš„ä¹¦ç±å¹¶ä¸æ˜¯éšæ„æ”¾ç½®çš„ï¼Œæ¯æœ¬ä¹¦éƒ½éœ€è¦æ ¹æ®ä¸€å®šçš„è§„åˆ™å’Œé¡ºåºæœ‰è§„å¾‹åœ°æ‘†æ”¾ï¼Œæœ‰æ—¶è¿˜è¦è®°å½•ä¸‹æ‘†æ”¾çš„å…·ä½“ä½ç½®ã€‚è¿™äº›ä¹¦ç±çš„æ‘†æ”¾è§„åˆ™å³å¯¹åº”äºŽåˆ†åŒºä¸Šçš„æ–‡ä»¶ç³»ç»Ÿã€‚ æ–‡ä»¶ç³»ç»Ÿæ˜¯å¯¹å­˜å‚¨è®¾å¤‡çš„ç©ºé—´è¿›è¡Œç»„ç»‡å’Œåˆ†é…ï¼Œè´Ÿè´£æ–‡ä»¶å­˜å–å¹¶å¯¹å­˜å…¥çš„æ–‡ä»¶è¿›è¡Œä¿æŠ¤å’Œæ£€ç´¢çš„ç³»ç»Ÿã€‚å¯¹æ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œæ–‡ä»¶çš„è¯»å†™ä¸ä¼šç›´æŽ¥ä½œç”¨äºŽç¡¬ç›˜æ‰‡åŒºï¼Œè€Œæ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿä»¥ç‰¹å®šçš„è§„åˆ™å¤„ç†å’Œç»„ç»‡æ–‡ä»¶æ•°æ®ã€‚å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿå¦‚ Windows ä¸­çš„ NTFS å’Œ Linux ç³»ç»Ÿä¸­ Ext4 ç­‰ã€‚ åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æ‰€è¯´çš„â€œåˆ†åŒºâ€æ“ä½œå³åŒ…å«äº†åˆ›å»ºåˆ†åŒºå¹¶å»ºç«‹æ–‡ä»¶ç³»ç»Ÿçš„è¿‡ç¨‹ã€‚è€Œåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œè¿™ä¸¤æ­¥æ“ä½œåˆ™éœ€è¦ä¸¤ä¸ªç‹¬ç«‹çš„å‘½ä»¤å®Œæˆã€‚ å¯ä»¥ä½¿ç”¨ mkfs.ext4 /dev/sdb1 å‘½ä»¤ï¼Œåœ¨ä¹‹å‰æ–°åŠ ç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒºä¸Šåˆ›å»º Ext4 æ ¼å¼çš„æ–‡ä»¶ç³»ç»Ÿã€‚1234567891011$ sudo mkfs.ext4 /dev/sdb1mke2fs 1.44.6 (5-Mar-2019)Creating filesystem with 786432 4k blocks and 196608 inodesFilesystem UUID: d5e21599-12e9-44da-ae51-124d89fe5edaSuperblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912Allocating group tables: doneWriting inode tables: doneCreating journal (16384 blocks): doneWriting superblocks and filesystem accounting information: done äº¤æ¢åˆ†åŒºLinux ç³»ç»Ÿä¸­çš„ swap åˆ†åŒºå¯ä»¥çœ‹ä½œä½äºŽç¡¬ç›˜ä¸Šçš„â€œå†…å­˜è®¾å¤‡â€ã€‚Linux ä¼šå°†å†…å­˜ä¸­ä¸€éƒ¨åˆ†ä¸éœ€è¦ç«‹å³ä½¿ç”¨çš„æ•°æ®ä¸´æ—¶äº¤æ¢è‡³ç¡¬ç›˜ä¸Šçš„ swap åˆ†åŒºï¼Œä»¥ç¼“è§£å†…å­˜ä¸è¶³ç­‰æƒ…å†µã€‚ æˆ‘çš„ Linux è™šæ‹Ÿæœºå®‰è£…æ—¶å¹¶æ²¡æœ‰åˆ†é… swap åˆ†åŒºï¼Œè¿™é‡Œé€šè¿‡ mkswap å‘½ä»¤å°† 2G å¤§å°çš„ sdb2 åˆ†åŒºåˆ’åˆ†ä¸º swap ç©ºé—´ï¼š123$ sudo mkswap /dev/sdb2Setting up swapspace version 1, size = 2 GiB (2146430976 bytes)no label, UUID=47006330-810c-4321-8d73-d52a5f70bc88 ç„¶åŽä½¿ç”¨ swapon å‘½ä»¤ç«‹å³å¯ç”¨å‰é¢åˆ›å»ºçš„ swap åˆ†åŒºï¼š12345$ sudo swapon /dev/sdb2$ free -h total used free shared buff/cache availableMem: 983Mi 223Mi 168Mi 4.0Mi 590Mi 597MiSwap: 2.0Gi 0B 2.0Gi åˆ†åŒºæŒ‚è½½åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œä¸€èˆ¬æ’å…¥ä¸€ä¸ªå·²ç»åˆ†å¥½åŒºçš„ç¡¬ç›˜æˆ–ä¼˜ç›˜ä¹‹åŽï¼Œä¼šè‡ªåŠ¨ä¸ºæ·»åŠ çš„ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒºåˆ†é…ç›˜ç¬¦ï¼ˆå¦‚ D:ã€E:ã€F: ç­‰ï¼‰ï¼Œä¹‹åŽå°±å¯ä»¥ç›´æŽ¥é€šè¿‡ç›˜ç¬¦åœ¨æ–°åˆ†åŒºä¸Šè¯»å–æˆ–å†™å…¥æ–‡ä»¶äº†ã€‚ Linux ç³»ç»Ÿä¸­æ²¡æœ‰ç›˜ç¬¦çš„æ¦‚å¿µï¼Œå®ƒçš„æ–‡ä»¶å±‚æ¬¡æ˜¯ä¸€ä¸ªä»Žæ ¹ç›®å½•ï¼ˆ/ï¼‰å¼€å§‹çš„æ ‘çŠ¶ç»“æž„ï¼ˆç›®å½•ï¼‰ï¼Œä¸€ç›´å‘ä¸‹å»¶ç”³ï¼Œæ¯ä¸€ä¸ªåˆ†æ”¯éƒ½æ˜¯ä¸€æ¡å…·ä½“çš„è·¯å¾„ï¼ŒæŒ‡å‘æŸä¸ªç‰¹å®šçš„æ–‡ä»¶ã€‚æ¯”å¦‚ /usrã€/rootã€/varã€/var/log ç­‰ã€‚ ç›®å½•å¯ä»¥è¯´æ˜¯ç‹¬ç«‹äºŽç¡¬ä»¶å­˜å‚¨è®¾å¤‡çš„æŠ½è±¡çš„é€»è¾‘ç»“æž„ï¼Œç”¨äºŽæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ä¸­çš„æŸä¸ªå…·ä½“ä½ç½®ã€‚è€Œç£ç›˜åˆ†åŒºä¸Žç›®å½•ç»“æž„çš„å¯¹åº”å…³ç³»ï¼Œåˆ™éœ€è¦é€šè¿‡æŒ‚è½½æ¥æŒ‡å®šã€‚ ä¸€èˆ¬åœ¨å®‰è£…ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥å°† sda1 åˆ†åŒºæŒ‚è½½åˆ°æ ¹ç›®å½•ä¸‹ï¼Œåˆ™è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¹‹åŽéƒ½å°†ä¿å­˜åœ¨ sda1 ä¸Šã€‚å¦‚æžœåŽé¢åˆæ·»åŠ äº†ä¸€å—æ–°çš„æ•°æ®ç›˜ sdbï¼Œè¯¥ç¡¬ç›˜åªæœ‰ä¸€ä¸ªåˆ†åŒº sdb1ã€‚ä¸ºäº†å°†æŸäº›æ–‡ä»¶ä¿å­˜åœ¨ sdb1 åˆ†åŒºä¸Šï¼Œå¯ä»¥åœ¨ç›®å½•æ ‘ä¸­æ–°å»ºä¸€ä¸ªç©ºç™½åˆ†æ”¯ï¼ˆæ¯”å¦‚ /mnt/dataï¼‰å¹¶å°† sdb1 æŒ‚è½½åœ¨è¯¥åˆ†æ”¯ä¸‹ã€‚ä¹‹åŽ /mnt/data ç›®å½•ä¸‹åˆ›å»ºçš„ä»»ä½•å­ç›®å½•å’Œæ–‡ä»¶ç­‰æ•°æ®éƒ½ä¼šä¿å­˜åœ¨ sdb1 ä¸Šã€‚å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š12$ sudo mkdir -p /mnt/data$ sudo mount /dev/sdb1 /mnt/data ä½¿ç”¨ df -h å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿå ç”¨çš„ç£ç›˜ç©ºé—´çš„å…·ä½“æƒ…å†µï¼š1234567891011$ df -hFilesystem Size Used Avail Use% Mounted onudev 456M 0 456M 0% /devtmpfs 99M 1.1M 98M 2% /run/dev/sda1 9.8G 5.2G 4.2G 56% /tmpfs 492M 0 492M 0% /dev/shmtmpfs 5.0M 4.0K 5.0M 1% /run/locktmpfs 492M 0 492M 0% /sys/fs/cgrouptmpfs 99M 0 99M 0% /run/user/117tmpfs 99M 0 99M 0% /run/user/1000/dev/sdb1 2.9G 9.0M 2.8G 1% /mnt/data å¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„åˆ†åŒº /dev/sdb1 å·²ç»æŒ‚è½½åˆ° /mnt/data ç›®å½•ä¸‹äº†ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ lsblk å‘½ä»¤æŸ¥çœ‹å—å­˜å‚¨è®¾å¤‡ï¼ˆå³ç£ç›˜å’Œåˆ†åŒºï¼‰çš„å®¹é‡å’ŒæŒ‚è½½ç‚¹ï¼š12345678$ lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsda 8:0 0 10G 0 diskâ””â”€sda1 8:1 0 10G 0 part /sdb 8:16 0 5G 0 diskâ”œâ”€sdb1 8:17 0 3G 0 part /mnt/dataâ””â”€sdb2 8:18 0 2G 0 part [SWAP]sr0 11:0 1 1024M 0 rom éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰‹åŠ¨æŒ‚è½½çš„åˆ†åŒºåœ¨ç³»ç»Ÿé‡å¯ä»¥åŽä¼šè‡ªåŠ¨å¸è½½ã€‚å¦‚æžœæƒ³åƒæ ¹ç›®å½•é‚£æ ·ï¼Œæ¯æ¬¡ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½åˆ†åŒºï¼Œå¯ä»¥ä¿®æ”¹ /etc/fstab é…ç½®æ–‡ä»¶ï¼Œç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š1234# &lt;file system&gt; &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;UUID=f3435713-b2cd-4196-b07b-2ffb116a028d / ext4 defaults 0 1/dev/sdb1 /mnt/data ext4 defaults 0 1/dev/sdb2 none swap sw 0 0 PSï¼šç›¸å¯¹äºŽ /dev/sda1 è¿™ç§å½¢å¼ï¼Œä½¿ç”¨ UUID æŒ‚è½½åˆ†åŒºå¾€å¾€æ›´ä¿é™©ä¸€ç‚¹ï¼Œå¯ä»¥é€šè¿‡ blkid å‘½ä»¤æŸ¥çœ‹ç£ç›˜åˆ†åŒºçš„ UUIDï¼š1234$ sudo blkid/dev/sda1: UUID=&quot;f3435713-b2cd-4196-b07b-2ffb116a028d&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;20985120-01&quot;/dev/sdb1: UUID=&quot;d5e21599-12e9-44da-ae51-124d89fe5eda&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;ce119026-01&quot;/dev/sdb2: UUID=&quot;47006330-810c-4321-8d73-d52a5f70bc88&quot; TYPE=&quot;swap&quot; PARTUUID=&quot;ce119026-02&quot; å››ã€LVMï¼ˆé€»è¾‘å·ç®¡ç†ï¼‰å¯¹äºŽä¸åŒ…å«é€»è¾‘å·ç®¡ç†ï¼ˆLVMï¼‰çš„ç£ç›˜åˆ†åŒºæ–¹æ¡ˆï¼Œåˆ†åŒºçš„ä½ç½®ã€å¤§å°å’Œæ•°é‡ä¸€èˆ¬éƒ½æ˜¯å›ºå®šçš„ï¼Œä»Žè€Œå¯¼è‡´æ‰©å±•å½“å‰åˆ†åŒºå’Œæ·»åŠ æ–°åˆ†åŒºç­‰æ“ä½œå˜å¾—å›°éš¾ã€‚æ­¤æ—¶è‹¥æ·»åŠ é¢å¤–çš„ç¡¬ç›˜å’Œåˆ†åŒºï¼Œåˆ™éœ€è¦åœ¨ç›®å½•æ ‘ä¸­åˆ›å»ºæ–°çš„åˆ†æ”¯ä½œä¸ºæŒ‚è½½ç‚¹ï¼Œæ–‡ä»¶æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªå¤æ‚çš„ä½ç½®ä¸Šï¼Œä¸ä¾¿äºŽåˆå¹¶ã€å¤‡ä»½å’Œç®¡ç†æ•°æ®ã€‚ LVM å…è®¸å°†å•ä¸ªæˆ–å¤šä¸ªåˆ†åŒºåˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘å·ç»„ï¼Œä¸”å…¶ä¸­åŒ…å«çš„é€»è¾‘å·å¯ä»¥åŠ¨æ€åœ°æ·»åŠ ã€æ”¹å˜å¤§å°æˆ–åˆ é™¤ã€‚LVM ç³»ç»Ÿæœ€åº•å±‚ä¸ºç‰©ç†å·ï¼ˆpvï¼‰ï¼Œå³ç£ç›˜ã€åˆ†åŒºå’Œ RAID é˜µåˆ—ç­‰ã€‚ç‰©ç†å·å¯ä»¥ç”¨æ¥åˆ›å»ºé€»è¾‘å·ç»„ï¼ˆvgï¼‰ï¼Œè€Œé€»è¾‘å·ç»„åˆå¯ä»¥åŒ…å«ä»»æ„æ•°é‡çš„é€»è¾‘å·ï¼ˆlvï¼‰ï¼Œé€»è¾‘å·ä»ŽåŠŸèƒ½ä¸Šå³å¯¹åº”äºŽç‰©ç†ç£ç›˜ä¸Šçš„åˆ†åŒºã€‚ åˆ›å»ºå·ç»„å’Œé€»è¾‘å·å¯ä»¥ä½¿ç”¨ pvcreate å‘½ä»¤å°†æŸä¸ªå­˜å‚¨è®¾å¤‡ï¼ˆç£ç›˜æˆ–åˆ†åŒºç­‰ï¼‰æ ‡è®°ä¸ºç‰©ç†å·ã€‚è¿™é‡Œæˆ‘é€šè¿‡ VirtualBox æ·»åŠ äº†å¦ä¸€å—å¤§å°ä¸º 5G çš„ç©ºç™½çš„è™šæ‹Ÿç¡¬ç›˜ï¼Œç³»ç»Ÿæ£€æµ‹åˆ°è¯¥è®¾å¤‡ä¸º /dev/sdc ï¼š123456789$ lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsda 8:0 0 10G 0 diskâ””â”€sda1 8:1 0 10G 0 part /sdb 8:16 0 5G 0 diskâ”œâ”€sdb1 8:17 0 3G 0 part /mnt/dataâ””â”€sdb2 8:18 0 2G 0 part [SWAP]sdc 8:32 0 5G 0 disksr0 11:0 1 1024M 0 rom åˆ›å»ºç‰©ç†å·ï¼š12$ sudo pvcreate /dev/sdc Physical volume &quot;/dev/sdc&quot; successfully created. é€šè¿‡ pvs å‘½ä»¤åˆ—å‡ºæ‰€æœ‰çš„ç‰©ç†å·ï¼š123$ sudo pvs PV VG Fmt Attr PSize PFree /dev/sdc lvm2 --- 5.00g 5.00g é€šè¿‡ vgcreate å‘½ä»¤åœ¨ç‰©ç†å·çš„åŸºç¡€ä¸Šåˆ›å»ºé€»è¾‘å·ç»„ï¼š12$ sudo vgcreate data-volume /dev/sdc Volume group &quot;data-volume&quot; successfully created ä½¿ç”¨ vgs å‘½ä»¤åˆ—å‡ºå½“å‰æ‰€æœ‰çš„é€»è¾‘å·ç»„ï¼š123$ sudo vgs VG #PV #LV #SN Attr VSize VFree data-volume 1 0 0 wz--n- &lt;5.00g &lt;5.00g ä½¿ç”¨ lvcreate å‘½ä»¤åœ¨å·ç»„ä¸­åˆ›å»ºé€»è¾‘å·ï¼š12$ sudo lvcreate --name data --size 2G data-volume Logical volume &quot;data&quot; created. è®¿é—®é€»è¾‘å·å¯ä»¥é€šè¿‡ /dev/mapper/&lt;vgname&gt;-&lt;lvname&gt; æˆ–è€… /dev/&lt;vgname&gt;/&lt;lvname&gt; å½¢å¼çš„è·¯å¾„ï¼Œå³åˆšåˆšåˆ›å»ºçš„ data é€»è¾‘å·å¯ä»¥é€šè¿‡ /dev/data-volume/data æŒ‡å®šã€‚åœ¨è¯¥é€»è¾‘å·ä¸Šåˆ›å»º Ext4 æ–‡ä»¶ç³»ç»Ÿï¼š1234567891011$ sudo mkfs.ext4 /dev/data-volume/datamke2fs 1.44.6 (5-Mar-2019)Creating filesystem with 524288 4k blocks and 131072 inodesFilesystem UUID: 0f24cdd8-62e0-42fd-bc38-aa3bce91e099Superblock backups stored on blocks: 32768, 98304, 163840, 229376, 294912Allocating group tables: doneWriting inode tables: doneCreating journal (16384 blocks): doneWriting superblocks and filesystem accounting information: done æ­¤æ—¶è¯¥é€»è¾‘å·å³å¯æŒ‚è½½åˆ°æŸä¸ªç›®å½•åˆ†æ”¯ä¸‹åƒæ™®é€šç‰©ç†åˆ†åŒºä¸€æ ·æ­£å¸¸ä½¿ç”¨äº†ã€‚ æ“ä½œå·ç»„å’Œé€»è¾‘å·å¯ä»¥ä½¿ç”¨ lvextend å‘½ä»¤åŠ¨æ€åœ°æ‰©å±•é€»è¾‘å·çš„å­˜å‚¨ç©ºé—´ï¼š12345678$ sudo lvextend --size +2G --resizefs /dev/data-volume/datafsck from util-linux 2.33.1/dev/mapper/data--volume-data: clean, 11/131072 files, 26156/524288 blocks Size of logical volume data-volume/data changed from 2.00 GiB (512 extents) to 4.00 GiB (1024 extents). Logical volume data-volume/data successfully resized.resize2fs 1.44.6 (5-Mar-2019)Resizing the filesystem on /dev/mapper/data--volume-data to 1048576 (4k) blocks.The filesystem on /dev/mapper/data--volume-data is now 1048576 (4k) blocks long. å…¶ä¸­ --size +2G ç”¨äºŽæŒ‡å®šå¢žåŠ  2G ç©ºé—´ï¼Œ--resizefs æŒ‡å®šåœ¨æ‰©å±•é€»è¾‘å·å¤§å°çš„åŒæ—¶æ‰©å……æ–‡ä»¶ç³»ç»Ÿçš„å¤§å°ï¼ˆæ–‡ä»¶ç³»ç»Ÿé»˜è®¤ä¸ä¼šéšé€»è¾‘å·çš„ç©ºé—´å˜åŒ–è€Œè‡ªåŠ¨æ‰©å±•ï¼‰ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥ç›´æŽ¥æŒ‡å®šæ‰©å±•åŽçš„å¤§å°ï¼Œå¦‚ï¼š$ sudo lvextend --size 4G --resizefs /dev/data-volume/data å…¶ä»–å¸¸ç”¨çš„å‘½ä»¤æ¯”å¦‚é€šè¿‡ lvresize å‘½ä»¤æ‰©å±•é€»è¾‘å·ï¼Œä½¿å…¶å ç”¨å½“å‰å·ç»„ä¸­å‰©ä½™çš„å…¨éƒ¨ç©ºé—´ï¼š123$ sudo lvresize -l +100%free /dev/data-volume/data Size of logical volume data-volume/data changed from &lt;3.00 GiB (767 extents) to &lt;5.00 GiB (1279 extents). Logical volume data-volume/data successfully resized. å› ä¸ºä¸Šé¢çš„å‘½ä»¤æ²¡æœ‰åŠ ä¸Š --resizefs æˆ–è€… -r é€‰é¡¹ï¼Œå› æ­¤æ–‡ä»¶ç³»ç»Ÿä¸ä¼šéšç€é€»è¾‘å·è‡ªåŠ¨æ‰©å±•å¤§å°ï¼Œå¯ä»¥é€šè¿‡ resize2fs å‘½ä»¤æ‰‹åŠ¨æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼š$ sudo resize2fs /dev/data-volume/data å‡è®¾ä¸€æ®µæ—¶é—´ä»¥åŽï¼Œé€»è¾‘å· /dev/data-volume/data çš„ç©ºé—´å³å°†è¢«æ•°æ®å¡«æ»¡ï¼Œå¯ä»¥å°è¯•æ·»åŠ å¦ä¸€å—ç¡¬ç›˜ sddï¼š1234567891011$ lsblkNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTsda 8:0 0 10G 0 diskâ””â”€sda1 8:1 0 10G 0 part /sdb 8:16 0 5G 0 diskâ”œâ”€sdb1 8:17 0 3G 0 part /mnt/dataâ””â”€sdb2 8:18 0 2G 0 part [SWAP]sdc 8:32 0 5G 0 diskâ””â”€data--volume-data 253:0 0 5G 0 lvmsdd 8:48 0 5G 0 disksr0 11:0 1 1024M 0 rom ä½¿ç”¨ pvcreate å‘½ä»¤åˆ›å»ºç‰©ç†å·ï¼š1234$ sudo pvs PV VG Fmt Attr PSize PFree /dev/sdc data-volume lvm2 a-- &lt;5.00g 0 /dev/sdd lvm2 --- 5.00g 5.00g ä½¿ç”¨ vgextend å‘½ä»¤å°†è¯¥ç‰©ç†å·æ·»åŠ åˆ°ä¹‹å‰åˆ›å»ºçš„å·ç»„ data-volume ä¸­ï¼š12345$ sudo vgextend data-volume /dev/sdd Volume group &quot;data-volume&quot; successfully extended$ sudo vgs VG #PV #LV #SN Attr VSize VFree data-volume 2 1 0 wz--n- 9.99g &lt;5.00g æ­¤æ—¶çš„ data-volume å·ç»„åŒ…å«äº†ä¸¤ä¸ªç‰©ç†å·ï¼ˆ/dev/sdc å’Œ /dev/sddï¼‰å’Œä¸€ä¸ªé€»è¾‘å·ï¼ˆ/dev/data-volume/dataï¼‰ï¼Œæ€»å¤§å°å˜ä¸º 10Gï¼Œé—²ç½®ç©ºé—´ä¸º 5Gï¼ˆå³åˆšåˆšæ·»åŠ çš„ç‰©ç†å·ï¼‰ã€‚ æœ€åŽä½¿ç”¨ lvresize å‘½ä»¤æ‰©å±•é€»è¾‘å·å¤§å°ï¼Œä½¿å…¶å æ®ä¸¤ä¸ªç‰©ç†å·çš„å…¨éƒ¨å­˜å‚¨ç©ºé—´ï¼š12345678$ sudo lvresize -l +100%free -r /dev/data-volume/datafsck from util-linux 2.33.1/dev/mapper/data--volume-data: clean, 11/196608 files, 30268/785408 blocks Size of logical volume data-volume/data changed from &lt;5.00 GiB (1279 extents) to 9.99 GiB (2558 extents). Logical volume data-volume/data successfully resized.resize2fs 1.44.6 (5-Mar-2019)Resizing the filesystem on /dev/mapper/data--volume-data to 2619392 (4k) blocks.The filesystem on /dev/mapper/data--volume-data is now 2619392 (4k) blocks long. æ­¤æ—¶é€»è¾‘å· /dev/data-volume/data çš„å¤§å°æ‰©å±•ä¸º 10Gï¼Œå³å ç”¨äº†æ•´ä¸ªå·ç»„ data-volumeï¼ˆåŒ…å«ä¸¤ä¸ª 5G çš„ç‰©ç†å·ï¼‰çš„å…¨éƒ¨ç©ºé—´ã€‚ æ€»ç»“ï¼šLVM å·ç»„ï¼ˆvgï¼‰çš„ä½œç”¨ç±»ä¼¼äºŽç‰©ç†ç£ç›˜ï¼Œç”¨äºŽæ‰¿è½½é€»è¾‘å·ï¼ˆlvï¼‰ã€‚å·ç»„å¯ä»¥ç”±å¤šä¸ªç‰©ç†å·ï¼ˆç£ç›˜æˆ–åˆ†åŒºç­‰ï¼‰æž„æˆï¼Œç©ºé—´ä¸å¤Ÿæ—¶ä¹Ÿå¯ä»¥éšæ—¶æ·»åŠ æ–°çš„ç‰©ç†å·è¿›è¡Œæ‰©å±•ã€‚è€Œå·ç»„ä¸Šçš„é€»è¾‘å·ï¼ˆlvï¼‰ç±»ä¼¼äºŽç£ç›˜åˆ†åŒºï¼Œå¯ä»¥æŒ‚è½½åˆ°ç›®å½•ä½œä¸ºå­˜å‚¨ç©ºé—´ã€‚ä½†æ˜¯ç‰©ç†åˆ†åŒºçš„ä½ç½®å’Œå¤§å°å›ºå®šï¼Œè€Œé€»è¾‘å·åˆ™å¯ä»¥åœ¨å·ç»„çš„åŸºç¡€ä¸ŠåŠ¨æ€çš„æ”¹å˜å¤§å°ï¼Œç”šè‡³è·¨è¶Šå¤šä¸ªç‰©ç†ç£ç›˜å’Œåˆ†åŒºï¼Œä½¿å¾—ç®¡ç†èµ·æ¥æ›´åŠ æ–¹ä¾¿å’Œçµæ´»ã€‚ å¸¸ç”¨ LVM å‘½ä»¤åˆ—è¡¨ï¼š Command Used For pvcreate Labeling devices for use with LVM pvremove Removing the LVM label from a physical volume pvdisplay / pvs Displaying information on the specified device or all physical volumes on the system vgcreate Creating a new volume group vgremove Removing (deleting) a volume group vgextend Adding physical volumes to a volume group vgreduce Removing physical volumes from a volume group vgdisplay / vgs Displaying information about the specified group or all volume groups on the system lvcreate Creating a new logical volume lvremove Removing (deleting) a logical volume lvextend Increasing the size of a logical volume lvreduce Decreasing the size of a logical volume lvdisplay / lvs Displaying all logical volumes on the system or in a specified volume group å‚è€ƒèµ„æ–™Pro Linux System Administration]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Disk</tag>
        <tag>Storage</tag>
        <tag>LVM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nagios4 ç³»ç»Ÿç›‘æŽ§å·¥å…·å®‰è£…åŠé…ç½®ç®€ä»‹ï¼ˆUbuntu 19.04ï¼‰]]></title>
    <url>%2F2019%2F08%2F01%2Fmonitor-system-nagios4-installation-and-usage%2F</url>
    <content type="text"><![CDATA[Nagios æ˜¯ä¸€æ¬¾å¼€æºçš„ç³»ç»Ÿç›‘æŽ§å·¥å…·ã€‚å®ƒä¸»è¦è´Ÿè´£å¯¹ç½‘ç»œçŽ¯å¢ƒä¸­çš„ç¡¬ä»¶è®¾å¤‡åŠè½¯ä»¶æœåŠ¡è¿›è¡ŒæŒç»­çš„æ£€æŸ¥ï¼Œç¡®ä¿è¿™äº›è®¾å¤‡æˆ–æœåŠ¡å¤„äºŽæ­£å¸¸è¿è¡Œçš„çŠ¶æ€ã€‚ä¸€æ—¦å‘çŽ°ä»»ä½•é”™è¯¯ï¼ŒNagios ä¼šåœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´å†…å‘å·¥ä½œäººå‘˜å‘å‡ºè­¦æŠ¥ï¼ŒåŒæ—¶ä¹Ÿä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå°è¯•è‡ªåŠ¨ä¿®å¤æ•…éšœï¼ˆæ¯”å¦‚é‡å¯è®¾å¤‡æˆ–æœåŠ¡ï¼‰ã€‚ ä¸€ã€ç®€ä»‹Nagios ç›‘æŽ§çš„å¯¹è±¡ä¸»è¦å¯åˆ†ä¸ºä¸¤ç±»ï¼š Hosts è¡¨ç¤ºç½‘ç»œä¸­çš„ç‰©ç†ï¼ˆæˆ–è™šæ‹ŸåŒ–çš„ï¼‰è®¾å¤‡ï¼Œå¦‚æœåŠ¡å™¨ã€å·¥ä½œç«™ã€è·¯ç”±å™¨å’Œæ‰“å°æœºç­‰ Services è¡¨ç¤ºç½‘ç»œä¸­æŸäº›è®¾æ–½æä¾›çš„ç‰¹å®šåŠŸèƒ½çš„é›†åˆï¼Œå¦‚ CPUã€å†…å­˜ã€ç£ç›˜ç©ºé—´ç­‰ã€‚å…¶ä»–å¦‚ sshd æœåŠ¡ç­‰ä¹Ÿå¯è¢«å®šä¹‰ä¸º Service æŽ¥å— Nagios çš„ç›‘æŽ§ æ­¤å¤–ï¼Œå¤šå°ä¸»æœºè¿˜å¯ä»¥è¢«åˆ’åˆ†åˆ°ä¸åŒçš„ä¸»æœºç»„ä¸­ä»¥æ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚ pluginsNagios æä¾›çš„æ‰€æœ‰çš„ç›‘æŽ§æ“ä½œå…¨éƒ¨éƒ½ç”±æ’ä»¶æ¥å®Œæˆã€‚æ’ä»¶æ˜¯ä¸€äº›ç”¨æ¥ä¼ é€’ç›‘æŽ§ä¿¡æ¯çš„é™„åŠ ç»„ä»¶ï¼ŒNagios é€šè¿‡å®ƒä»¬æ‰§è¡Œå…·ä½“çš„ç›‘æŽ§å’Œæ£€æŸ¥ä»»åŠ¡ï¼ŒåŒæ—¶å¯¹æ”¶é›†åˆ°çš„ç»“æžœè¿›è¡Œç»Ÿè®¡ä¸Žæ•´ç†ã€‚ Nagios é»˜è®¤æä¾›äº†ä¸€äº›åŸºç¡€çš„æ’ä»¶ï¼Œå‡ ä¹Žå¯ä»¥æ»¡è¶³æ‰€æœ‰å¸¸è§çš„ç›‘æŽ§ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œå¦‚æžœæœ‰ç‰¹æ®Šçš„ç›‘æŽ§éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œç¼–å†™ Nagios æ’ä»¶ã€‚ä¸€èˆ¬æ ‡å‡†æ’ä»¶çš„é»˜è®¤å®‰è£…è·¯å¾„ä¸º /usr/lib/nagios/plugins ï¼Œæ’ä»¶åç§°ç»å¤§å¤šæ•°ä»¥ check_ å¼€å¤´ï¼š1234567$ ls /usr/lib/nagios/pluginscheck_apt check_file_age check_imap check_nagios check_pop check_ssmtpcheck_breeze check_flexlm check_ircd check_nntp check_procs check_swapcheck_by_ssh check_fping check_jabber check_nntps check_radius check_tcpcheck_clamd check_ftp check_ldap check_nt check_real check_timecheck_cluster check_game check_ldaps check_ntp check_rpc check_udp... äºŒã€å®‰è£… Nagiosæˆ‘ç”¨çš„æ˜¯ Ubuntu 19.04 ç³»ç»Ÿï¼Œå‘ƒï¼Œæ²¡æœ‰å°è¯•è¿‡å…¶ä»–çš„å®‰è£…æ–¹å¼ã€‚å°±æ˜¯ç›´æŽ¥ç”¨åŒ…ç®¡ç†å™¨ï¼ˆapt-getï¼‰å®‰è£…çš„ï¼Œå‘½ä»¤ï¼ˆå°±ä¸€æ¡ï¼Œï¼Œï¼Œï¼‰å¦‚ä¸‹ï¼š$ sudo apt-get install nagios4 è¯¥å‘½ä»¤ä¼šåŒæ—¶å®‰è£…ä¸€äº›æ ‡å‡†çš„ Nagios æ’ä»¶ä»¥åŠä¸€ä¸ªç®€å•çš„ Web ç›‘æŽ§å¹³å°ï¼ˆéœ€è¦ Apache2 æœåŠ¡å™¨å’Œ PHP è¯­è¨€æ”¯æŒï¼‰ã€‚ç”¨ apt-get å‘½ä»¤å®‰è£…å®Œ Nagios4 ä¹‹åŽï¼ŒWeb ç›‘æŽ§å¹³å°çš„ Apache2 é…ç½®æ–‡ä»¶ä¼šè‡ªåŠ¨æ·»åŠ åˆ° /etc/apache2/conf_enabled ç›®å½•ä¸‹å¹¶ç›´æŽ¥å¯ç”¨ã€‚ åªä¸è¿‡æˆ‘è¿™é‡Œé‡å¯ Apache2 æœåŠ¡æ—¶æŠ¥é”™ï¼ŒåŽŸå› æ˜¯è¿˜éœ€è¦å¯ç”¨é¢å¤–ä¸¤ä¸ª Apache çš„æ¨¡å—ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š12$ sudo a2enmod auth_digest$ sudo a2enmod authz_groupfile é‡å¯ Apache2 åŽè®¿é—® http://127.0.0.1/nagios4 é“¾æŽ¥ï¼Œå³å¯è¿›å…¥ Web ç›‘æŽ§å¹³å°ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š ä¸‰ã€é…ç½®æ–‡ä»¶ä»‹ç»Nagios çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬ä½äºŽ /etc/nagios æˆ–è€… /usr/local/etc/nagios ç›®å½•ä¸‹ï¼Œæœ€ä¸»è¦çš„é…ç½®æ–‡ä»¶ä¸º nagios.cfg ã€‚nagios.cfg åƒæ˜¯ä¸€ä¸ªç»Ÿé¢†æ€§çš„å¤§çº²æ–‡ä»¶ï¼Œå®ƒé™¤äº†å®šä¹‰ä¸€äº›å…¨å±€èŒƒå›´å†…çš„åŸºæœ¬é…ç½®å¤–ï¼Œè¿˜ç”¨äºŽæŒ‡å®šå…¶ä»–ï¼ˆæ›´ç»†èŠ‚çš„ï¼‰é…ç½®æ–‡ä»¶çš„ä½ç½®æˆ–è€…ç»„ç»‡æ–¹å¼ï¼Œç±»ä¼¼äºŽä¹¦ç±ä¸­çš„ç›®å½•ã€‚ å¦‚æ–‡ä»¶ä¸­çš„ cfg_dir å’Œ cfg_file ä¸¤ä¸ªé…ç½®é¡¹ï¼š12345678910111213...cfg_dir=/etc/nagios-plugins/configcfg_dir=/etc/nagios4/conf.d# You can specify individual object config files as shown below:cfg_file=/etc/nagios4/objects/commands.cfgcfg_file=/etc/nagios4/objects/contacts.cfgcfg_file=/etc/nagios4/objects/timeperiods.cfgcfg_file=/etc/nagios4/objects/templates.cfg# Definitions for monitoring the local (Linux) hostcfg_file=/etc/nagios4/objects/localhost.cfg... å³å…³äºŽç›‘æŽ§å¯¹è±¡çš„è¯¦ç»†é…ç½®ï¼Œä¸€èˆ¬ä¿å­˜åœ¨ç”± cfg_file æŒ‡å®šçš„é…ç½®æ–‡ä»¶ä¸­ã€‚æˆ–è€…ä¹Ÿå¯ä»¥å°†åŒ…å«é…ç½®ä¿¡æ¯çš„æ–‡ä»¶æ”¾ç½®åœ¨ç”± cfg_dir æŒ‡å®šçš„ç›®å½•ï¼ˆåŠå…¶å­ç›®å½•ï¼‰ä¸‹ã€‚ æ¯”å¦‚é»˜è®¤å¯ç”¨çš„ /etc/nagios4/objects/localhost.cfg é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å…³è”åˆ°æœ¬åœ°ä¸»æœºçš„å¤šä¸ªç›‘æŽ§å¯¹è±¡çš„ä¿¡æ¯ï¼Œä»Žä¸­ä¹Ÿå¯ä»¥çœ‹å‡º Nagios åœ¨é…ç½®ç›‘æŽ§å¯¹è±¡æ—¶æ‰€éµå¾ªçš„åŸºæœ¬è¯­æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536# Define a host for the local machinedefine host&#123; use linux-server ; Name of host template to use host_name localhost alias localhost address 127.0.0.1 &#125;# Define a service to check the disk space of the root partitio on the local machine. Warning if &lt; 20% free, critical if &lt; 10% free space on partition.define service&#123; use local-service ; Name of service template to use host_name localhost service_description Root Partition check_command check_local_disk!20%!10%!/ &#125;# Define a service to check the number of currently running procs on the local machine. Warning if &gt; 250 processes, critical if &gt; 400 processes.define service&#123; use local-service ; Name of service template to use host_name localhost service_description Total Processes check_command check_local_procs!250!400!RSZDT &#125;# Define a service to check HTTP on the local machine. Disable notifications for this service by default, as not all users may have HTTP enabled.define service&#123; use local-service ; Name of service template to use host_name localhost service_description HTTP check_command check_http notifications_enabled 0 &#125; è‡³äºŽ /etc/nagios4/objects ç›®å½•ä¸‹é»˜è®¤å¯ç”¨çš„å‡ ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ™åŒ…å«äº†ä¸€äº›è‡ªå®šä¹‰å‘½ä»¤ï¼ˆcommands.cfgï¼‰ã€è”ç³»äººä¿¡æ¯ï¼ˆcontacts.cfgï¼‰ã€æ—¶é—´æ®µé…ç½®ï¼ˆtimeperiods.cfgï¼‰ä»¥åŠä¸»æœºå’ŒæœåŠ¡çš„æ¨¡æ¿ï¼ˆtemplates.cfgï¼‰ç­‰ã€‚ æ¯”å¦‚ localhost.cfg ä¸­çš„ use linux-server é…ç½®é¡¹ï¼Œå³ä½¿ç”¨äº†ç”± templates.cfg æ–‡ä»¶å®šä¹‰çš„åä¸º linux-server çš„æ¨¡æ¿ï¼š1234567891011121314151617$ cat /etc/nagios4/objects/templates.cfg...define host&#123; name linux-server ; The name of this host template use generic-host ; This template inherits other values from the generic-host template check_period 24x7 ; By default, Linux hosts are checked round the clock check_interval 5 ; Actively check the host every 5 minutes retry_interval 1 ; Schedule host check retries at 1 minute intervals max_check_attempts 10 ; Check each Linux host 10 times (max) check_command check-host-alive ; Default command to check Linux hosts notification_period workhours ; Linux admins hate to be woken up, so we only notify during the day notification_interval 120 ; Resend notifications every 2 hours notification_options d,u,r ; Only send notifications for specific host states contact_groups admins ; Notifications get sent to the admins by default register 0 ; DONT REGISTER THIS DEFINITION - ITS NOT A REAL HOST, JUST A TEMPLATE! &#125;... å…¶ä»–ç”± Nagios é»˜è®¤æä¾›çš„ä¸»æœºæˆ–æœåŠ¡æ¨¡æ¿ã€è”ç³»äººæ¨¡æ¿ç­‰ä¹Ÿéƒ½ä¿å­˜åœ¨è¯¥æ–‡ä»¶ä¸­ã€‚ æ€»çš„æ¥è¯´ï¼Œåœ¨åˆ›å»ºè‡ªå®šä¹‰é…ç½®æ—¶ï¼Œobjects ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶å¯ä»¥ä½œä¸ºå¾ˆæœ‰ä»·å€¼çš„å‚è€ƒç¤ºä¾‹ï¼ŒåŒæ—¶å…¶ä¸­å®šä¹‰çš„å‘½ä»¤ã€è”ç³»äººå’Œæ¨¡æ¿ç­‰ä¹Ÿå¯åœ¨éœ€è¦æ—¶ç›´æŽ¥é€šè¿‡åç§°è°ƒç”¨ï¼Œå‡å°‘ç›¸å…³ä»£ç çš„ç¼–å†™ã€‚ å¯¹äºŽè®¾å¤‡æ•°é‡åºžå¤§ä¸”ç§ç±»è¾ƒå¤æ‚çš„åœºæ™¯ï¼Œå»ºè®®å°† Nagios é…ç½®æ–‡ä»¶çš„ç»„ç»‡æž¶æž„è®¾è®¡æˆä¾¿äºŽç®¡ç†çš„å½¢å¼ã€‚æ¯”å¦‚ï¼š1234567891011$ tree /etc/nagios4/conf.d/etc/nagios4/conf.dâ”œâ”€â”€ commandsâ”œâ”€â”€ contactgroupsâ”œâ”€â”€ contactsâ”œâ”€â”€ hostgroupsâ”œâ”€â”€ hostsâ”‚ â””â”€â”€ server2.cfgâ”œâ”€â”€ servicegroupsâ”œâ”€â”€ servicesâ””â”€â”€ timeperiods å››ã€å®šä¹‰ç›‘æŽ§å¯¹è±¡å®æŒ‡ä»¤èƒ½å¤Ÿé€šè¿‡å®æŒ‡ä»¤æ¥ç®€åŒ–é…ç½®ï¼Œæ˜¯ Nagios çš„å…³é”®ç‰¹æ€§ä¹‹ä¸€ã€‚å®çš„è¿ç”¨åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜äº†å®šä¹‰å¯¹è±¡å’Œå‘½ä»¤çš„çµæ´»æ€§ã€‚å¦‚ä¸‹é¢çš„é…ç½®ç¤ºä¾‹ï¼š1234567891011define host&#123; use linux-server host_name server2 address 192.168.1.102 check_command check-host-ssh&#125;define command&#123; command_name check-host-ssh command_line $USER1$/check_ssh -H $HOSTADDRESS$&#125; å…¶ä¸­çš„ $USER1$ å’Œ $HOSTADDRESS$ å³æ˜¯é¢„å…ˆå®šä¹‰çš„ä¸¤ä¸ªå®ã€‚$USER1$ æ˜¯åœ¨èµ„æºé…ç½®æ–‡ä»¶ï¼ˆ/etc/nagios4/resource.cfgï¼‰ä¸­æŒ‡å®šçš„ Nagios æ’ä»¶çš„å®‰è£…è·¯å¾„ã€‚$HOSTADDRESS$ åˆ™è¡¨ç¤º host å®šä¹‰ä¸­çš„ address é¡¹çš„å†…å®¹ï¼Œå³ä¸»æœºçš„ IP åœ°å€ã€‚ å®šä¹‰ä¸»æœºç®€å•çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š123456789101112131415define host&#123; host_name server1 hostgroups linux-servers alias Ubuntu 19.04 address 192.168.1.101 check_command check-host-alive check_interval 10 retry_interval 1 max_check_attempts 5 check_period 24x7 contact_groups admins notification_interval 30 notification_period 24x7 notification_options d,u,r&#125; å…³äºŽ notification_optionsï¼š d : the host DOWN state u : the host UNREACHABLE state r : host recovery (UP state) f : the host starts and stops flapping s : notify when scheduled downtime starts or ends å®šä¹‰ä¸»æœºç»„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617define hostgroup&#123; hostgroup_name linux-servers alias Linux servers members server1,server2&#125;define hostgroup&#123; hostgroup_name aix-servers alias AIX servers members aixbox1,aixbox2&#125;define hostgroup&#123; hostgroup_name unix-servers alias UNIX servers hostgroup_members linux-servers,aix-servers&#125; å…¶ä¸­å®šä¹‰äº†ä¸¤ä¸ªåˆ†åˆ«åŒ…å«ä¸¤å°ä¸»æœºçš„ä¸»æœºç»„ï¼ˆlinux-serversã€aix-serversï¼‰ï¼ŒåŒæ—¶è¿˜å®šä¹‰äº†åŒ…å«è¿™ä¸¤ä¸ªä¸»æœºç»„çš„â€œå¤§â€ä¸»æœºç»„ï¼ˆunix-serversï¼‰ã€‚å³ä¸»æœºç»„çš„å®šä¹‰æ”¯æŒåµŒå¥—ã€‚ å®šä¹‰æœåŠ¡ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213define service&#123; host_name server2 service_description www check_command check_http check_interval 10 check_period 24x7 retry_interval 3 max_check_attempts 3 notification_interval 30 notification_period 24x7 notification_options w,c,u,r contact_groups admins&#125; å…³äºŽ notification_optionsï¼š w : the service WARNING state u : the service UNKNOWN state c : the service CRITICAL state r : the service recovery (back to OK) state f : the host starts and stops flapping s : notify when the scheduled downtime starts or ends å®šä¹‰æ—¶é—´æ®µç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516define timeperiod&#123; timeperiod_name workinghours alias Working Hours, excluding lunch break monday 09:00-13:00,14:00-17:00 tuesday 09:00-13:00,14:00-17:00 wednesday 09:00-13:00,14:00-17:00 thursday 09:00-13:00,14:00-17:00 friday 09:00-13:00,14:00-17:00&#125;define timeperiod&#123; timeperiod_name weekends alias Weekends all day long saturday 00:00-24:00 sunday 00:00-24:00&#125; å®šä¹‰è”ç³»äººç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š123456789101112define contact&#123; contact_name jdoe alias John Doe email john.doe@gmail.com contactgroups admins host_notification_period workinghours service_notification_period workinghours host_notification_options d,u,r service_notification_options w,u,c,r host_notification_commands notify-host-by-email service_notification_commands notify-service-by-email&#125; å‚è€ƒèµ„æ–™Learning Nagios - Third Edition]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Server</tag>
        <tag>DevOps</tag>
        <tag>Monitoring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ RabbitMQ è¯¦ç»†ä»‹ç»â€”â€”å®‰è£…ä¸ŽåŸºæœ¬åº”ç”¨ï¼ˆPythonï¼‰]]></title>
    <url>%2F2019%2F07%2F28%2Fmessage-broker-RabbitMQ-intro%2F</url>
    <content type="text"><![CDATA[RabbitMQ æ˜¯å½“å‰æœ€æµè¡Œçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMessage Brokerï¼‰ä¹‹ä¸€ï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯åè®®ï¼ˆå¦‚ AMQPã€MQTTï¼‰ã€‚åŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªè½»é‡çº§çš„éžå¸¸æ˜“äºŽéƒ¨ç½²çš„å¼€æºè½¯ä»¶ï¼Œå¯ä»¥è¿è¡Œåœ¨å½“å‰å¤§å¤šæ•°æ“ä½œç³»ç»ŸåŠäº‘ç«¯çŽ¯å¢ƒä¸­ï¼Œä¹Ÿèƒ½å¤Ÿéƒ¨ç½²åœ¨åˆ†å¸ƒå¼çš„é›†ç¾¤çŽ¯å¢ƒé‡Œä»¥è¾¾åˆ°é«˜å¯ç”¨ã€å¯ä¼¸ç¼©çš„éœ€æ±‚ã€‚æ­¤å¤–ï¼ŒRabbitMQ è¿˜ä¸ºç›®å‰ä¸»æµçš„ç¼–ç¨‹è¯­è¨€æä¾›äº†ä¸°å¯Œçš„å¼€å‘å·¥å…·ã€‚ ä¸€ã€è½¯ä»¶å®‰è£…å¯ä»¥è¿›å…¥ å®˜æ–¹ä¸‹è½½ç•Œé¢ é˜…è¯»é’ˆå¯¹è‡ªå·±æ“ä½œç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…æ‰‹å†Œï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©é€‚åˆçš„å®‰è£…æ–¹å¼ã€‚Windows ç³»ç»Ÿå¯ä»¥ç›´æŽ¥åœ¨è¯¥é¡µé¢ä¸­èŽ·å–äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼ˆè¿˜éœ€è¦å®‰è£… Erlang çŽ¯å¢ƒï¼‰ï¼ŒLinux ç³»ç»Ÿä¹Ÿå¯ä»¥æ ¹æ®å‘è¡Œç‰ˆçš„ä¸åŒæ·»åŠ ç‰¹å®šçš„è½¯ä»¶é•œåƒæºã€‚ æˆ‘è¿™é‡Œæ˜¯ Ubuntu 19.04ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œæ‰€ä»¥ç›´æŽ¥ä»Žç³»ç»Ÿé»˜è®¤çš„è½¯ä»¶é•œåƒæºé‡Œä¸‹è½½å®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo apt-get install rabbitmq-server å®‰è£…å®Œæˆä»¥åŽï¼Œè¿è¡Œ systemctl status rabbitmq-server å‘½ä»¤æŸ¥çœ‹ RabbitMQ æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼š123456789101112131415161718$ systemctl status rabbitmq-serverâ— rabbitmq-server.service - RabbitMQ Messaging Server Loaded: loaded (/lib/systemd/system/rabbitmq-server.service; enabled; vendor preset: enabled) Active: active (running) since Fri 2019-07-26 01:03:27 CST; 2min 55s ago Main PID: 770 (beam.smp) Status: &quot;Initialized&quot; Tasks: 85 (limit: 2302) Memory: 85.8M CGroup: /system.slice/rabbitmq-server.service â”œâ”€ 741 /bin/sh /usr/sbin/rabbitmq-server â”œâ”€ 770 /usr/lib/erlang/erts-10.2.4/bin/beam.smp -W w -A 64 -MBas ageffcbf -MHas ageffcbf -MBlmbcs 512 -MHlmbcs 512 -MMmcs 30 -P 1048576 -t 5000000 -stbt db -zdbbl 128000 -K true -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/ebin -noshell -noinput -s rabbit boot -sname rabbit@server1 -boot start_sasl -kernel inet_default_connect_options [&#123;nodelay,true&#125;] -sasl errlog_type error -sasl sasl_error_logger false -rabbit lager_log_root &quot;/var/log/rabbitmq&quot; -rabbit lager_default_file &quot;/var/log/rabbitmq/rabbit@server1.log&quot; -rabbit lager_upgrade_file &quot;/var/log/rabbitmq/rabbit@server1_upgrade.log&quot; -rabbit enabled_plugins_file &quot;/etc/rabbitmq/enabled_plugins&quot; -rabbit plugins_dir &quot;/usr/lib/rabbitmq/plugins:/usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/plugins&quot; -rabbit plugins_expand_dir &quot;/var/lib/rabbitmq/mnesia/rabbit@server1-plugins-expand&quot; -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir &quot;/var/lib/rabbitmq/mnesia/rabbit@server1&quot; -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672 â”œâ”€1243 erl_child_setup 65536 â”œâ”€1286 inet_gethost 4 â””â”€1287 inet_gethost 47æœˆ 26 01:02:44 server1 systemd[1]: Starting RabbitMQ Messaging Server...7æœˆ 26 01:03:27 server1 systemd[1]: rabbitmq-server.service: Supervising process 770 which is not our child. We&apos;ll most likely not notice when it exits.7æœˆ 26 01:03:27 server1 systemd[1]: Started RabbitMQ Messaging Server. Web AdminRabbitMQ è¿˜æä¾›äº†å¯ä»¥è¿œç¨‹è®¿é—®çš„ Web ç®¡ç†ä¸Žç›‘æŽ§å·¥å…·ï¼Œé»˜è®¤ä»¥æ’ä»¶çš„å½¢å¼å®‰è£…åˆ°ç³»ç»Ÿä¸­ï¼Œéœ€è¦ä½¿ç”¨ rabbitmq-plugins å‘½ä»¤å¼€å¯ã€‚å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š$ sudo rabbitmq-plugins enable rabbitmq_management RabbitMQ é»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·åå¯†ç åˆ†åˆ«ä¸º guest/guest çš„ç”¨æˆ·ï¼Œåªæ˜¯è¯¥ç”¨æˆ·åªå…è®¸æœ¬åœ°ç™»å½•ã€‚ï¼ˆæˆ‘è¿™é‡Œæ˜¯è¿œç¨‹ã€‚ã€‚ã€‚ï¼‰å¦‚æžœéœ€è¦è¿œç¨‹è®¿é—® Web æŽ§åˆ¶å°ï¼Œå¯ä»¥é€šè¿‡ rabbitmqctl å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†è´¦æˆ·ï¼š$ sudo rabbitmqctl add_user &lt;username&gt; &lt;password&gt; æ­¤æ—¶æ–°åˆ›å»ºçš„è´¦æˆ·ä»æ— æ³•ç™»å½•ï¼Œè¿˜éœ€è¦ä¸ºå…¶åˆ†é…ç”¨æˆ·è§’è‰²ä»¥åŠå¯¹ vhost çš„ç®¡ç†æƒé™ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š12$ sudo rabbitmqctl set_user_tags &lt;username&gt; administrator$ sudo rabbitmqctl set_permissions -p / &lt;username&gt; &quot;.*&quot; &quot;.*&quot; &quot;.*&quot; æƒé™è®¾ç½®å®Œæ¯•åŽï¼Œå³å¯ç”¨ä¹‹å‰æŒ‡å®šçš„ç”¨æˆ·åå¯†ç è¿œç¨‹ç™»å½• Web ç®¡ç†ç³»ç»Ÿï¼Œç•Œé¢å¦‚ä¸‹å›¾ï¼š Web å½¢å¼çš„åŽå°ç•Œé¢ä¸ºç®¡ç†å·¥ä½œä¸Žç›‘æŽ§éœ€æ±‚æä¾›äº†ä¾¿æ·çš„æŽ¥å£ï¼ŒåŒæ—¶å¤§éƒ¨åˆ†ç®¡ç†æ“ä½œä¹Ÿå¯ç›´æŽ¥é€šè¿‡ rabbitmqctl å‘½ä»¤å®Œæˆï¼Œå…·ä½“å¯å‚è€ƒè¯¥å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼š1234567891011121314$ sudo rabbitmqctlUsage:rabbitmqctl [-n &lt;node&gt;] [-l] [-q] &lt;command&gt; [&lt;command options&gt;]...Commands: add_user &lt;username&gt; &lt;password&gt; add_vhost &lt;vhost&gt; authenticate_user &lt;username&gt; &lt;password&gt; await_online_nodes &lt;count&gt; [-t &lt;timeout&gt;] cancel_sync_queue [-p &lt;vhost&gt;] queue change_cluster_node_type &lt;disc|ram&gt; change_password &lt;username&gt; &lt;password&gt;... äºŒã€æž¶æž„è§£æžRabbitMQ æ˜¯ä¸€ç§é«˜æ€§èƒ½ã€ç¨³å®šã€å¯ä¼¸ç¼©ï¼ˆé›†ç¾¤éƒ¨ç½²ï¼‰çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç”± Erlang è¯­è¨€ç¼–å†™ã€‚ Erlang æ˜¯ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä¸“æ³¨äºŽåˆ†å¸ƒå¼ã€é«˜å®¹é”™çš„è½¯ä»¶ç±»å®žæ—¶ç³»ç»Ÿç­‰åº”ç”¨åœºæ™¯ã€‚å®ƒé€šè¿‡è½»é‡çº§çš„è¿›ç¨‹è®¾è®¡ä»¥åŠè¿›ç¨‹ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼Œæä¾›äº†ä¸€ä¸ªé«˜å±‚æ¬¡çš„ä¸éœ€è¦å…±äº«çŠ¶æ€çš„å¹¶å‘æ¨¡åž‹ã€‚RabbitMQ é›†ç¾¤é€šè¿‡ Erlang VM åŽŸç”Ÿçš„ IPC (inter-process communication) æœºåˆ¶å®Œæˆè·¨èŠ‚ç‚¹çš„æ¶ˆæ¯é€šä¿¡ã€‚ æ¾è€¦åˆæž¶æž„å¯¹äºŽä¼ ç»Ÿçš„åº”ç”¨æž¶æž„ï¼Œæ¯”å¦‚ä¸€ä¸ª Web åº”ç”¨çš„ç™»å½•ç¨‹åºï¼Œå¾€å¾€éœ€è¦å¯¹åŽç«¯çš„æ•°æ®åº“è¡¨æ ¼è¿›è¡Œå¤šé¡¹å®žæ—¶çš„å†™å…¥æ“ä½œã€‚è€Œå½“ç”¨æˆ·çš„è®¿é—®é‡å¤§å¢žæ—¶ï¼Œæ­¤æ—¶çš„è¡¨æ ¼æ›´æ–°æ“ä½œå¾ˆå®¹æ˜“æˆä¸ºç“¶é¢ˆå¹¶å½±å“åˆ°æ•´ä½“çš„å“åº”é€Ÿåº¦ã€‚ ç›¸å¯¹äºŽç™»å½•ç¨‹åºç›´æŽ¥æ›´æ–°è¡¨æ ¼æ•°æ®çš„ç´§è€¦åˆæž¶æž„ï¼Œå¯ä»¥å°†å‰ç«¯çš„è¯·æ±‚æ•°æ®æŽ¨é€åˆ°åŸºäºŽæ¶ˆæ¯çš„ä¸­é—´ä»¶æˆ–è€…æŸä¸ªä¸­å¿ƒåŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨ï¼Œå†é€šè¿‡ä¸­é—´ä»¶åˆ†å‘æ¶ˆæ¯åˆ°å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰åº”ç”¨ï¼Œç”±æ¶ˆè´¹è€…ç‹¬ç«‹ã€å¼‚æ­¥åœ°å®Œæˆæœ€ç»ˆçš„æ•°æ®åº“æ›´æ–°æ“ä½œã€‚åŸºäºŽæ¶ˆæ¯çš„ä¸­é—´ä»¶å¯¹äºŽåˆ›å»ºæ•°æ®å¯¼å‘çš„çµæ´»çš„åº”ç”¨æž¶æž„æœ‰éžå¸¸å¤§çš„ä¼˜åŠ¿ã€‚RabbitMQ æ”¯æŒçš„æ¾è€¦åˆè®¾è®¡å¯ä»¥ä½¿åº”ç”¨ä¸å†å—ç±»ä¼¼äºŽæ•°æ®åº“å†™æ“ä½œçš„æ€§èƒ½é™åˆ¶ã€‚åŒæ—¶è¿™ç§æž¶æž„ä¹Ÿéžå¸¸æ˜“äºŽæ¨ªå‘æ‰©å±•ï¼Œå¯ä»¥åœ¨æ·»åŠ ä½œç”¨äºŽç›¸åŒæ•°æ®çš„åº”ç”¨å®žä¾‹æ—¶ä¸å½±å“çŽ°æœ‰çš„æ ¸å¿ƒåŠŸèƒ½ã€‚ ä¸‰ã€æ¶ˆæ¯åº”ç”¨ç¤ºä¾‹ä»£ç ä¸‹æ–‡ä¸­å°†ä½¿ç”¨ Python è¯­è¨€åŠå…¶ RabbitMQ å®¢æˆ·ç«¯ Pika åˆ›å»º 5 ä¸ªåŸºæœ¬çš„æ¶ˆæ¯åº”ç”¨ï¼Œç»“æž„ç”±ç®€å•åˆ°å¤æ‚ï¼Œæºä»£ç å‡å‚è€ƒè‡ªå®˜ç½‘ RabbitMQ Tutorials ã€‚å®‰è£… pika åº“ï¼špip install pika Hello Worldè¯¥åº”ç”¨çš„ç»“æž„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š ç”± P (Producer) å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼Œå†ç”±é˜Ÿåˆ—è½¬å‘æ¶ˆæ¯åˆ° C (Consumer) ã€‚ å‘é€ç«¯ä»£ç  send.py å¦‚ä¸‹ï¼š123456789101112131415#!/usr/bin/env pythonimport pika# åˆå§‹åŒ–ä¸Ž RabbitMQ æœåŠ¡å™¨çš„è¿žæŽ¥connection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()# é˜Ÿåˆ—å£°æ˜Žchannel.queue_declare(queue=&apos;hello&apos;)# å‘é€æ¶ˆæ¯channel.basic_publish(exchange=&apos;&apos;, routing_key=&apos;hello&apos;, body=&apos;Hello World!&apos;)print(&quot; [x] Sent &apos;Hello World!&apos;&quot;)connection.close() æŽ¥æ”¶ç«¯ reveive.py ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718#!/usr/bin/env pythonimport pikaconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.queue_declare(queue=&apos;hello&apos;)# æŽ¥æ”¶åˆ°æ¶ˆæ¯åŽè§¦å‘çš„å›žè°ƒå‡½æ•°def callback(ch, method, properties, body): print(&quot; [x] Received %r&quot; % body)# æ¶ˆè´¹è€…å£°æ˜Žä¸Žæ¶ˆæ¯ç›‘å¬channel.basic_consume( queue=&apos;hello&apos;, on_message_callback=callback, auto_ack=True)print(&apos; [*] Waiting for messages. To exit press CTRL+C&apos;)channel.start_consuming() æµ‹è¯•é¦–å…ˆè¿è¡Œ 4 æ¬¡å‘é€ç¨‹åºï¼š12345678$ python send.py [x] Sent &apos;Hello World&apos;$ python send.py [x] Sent &apos;Hello World&apos;$ python send.py [x] Sent &apos;Hello World&apos;$ python send.py [x] Sent &apos;Hello World&apos; ä»Ž Web ç®¡ç†ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶é˜Ÿåˆ—ä¸­ç¼“å­˜äº† 4 æ¡æ¶ˆæ¯ã€‚è¿è¡ŒæŽ¥æ”¶ç«¯ç¨‹åºï¼š123456$ python receive.py [x] Waiting for messages. To exit press CTRL+C [x] Received b&apos;Hello World&apos; [x] Received b&apos;Hello World&apos; [x] Received b&apos;Hello World&apos; [x] Received b&apos;Hello World&apos; å‘é€ç«¯è¿žç»­ 4 æ¬¡å‘é€çš„æ¶ˆæ¯è¢«æŽ¥æ”¶ç«¯æ”¶å–ï¼Œé˜Ÿåˆ—ä¸­ç¼“å­˜çš„æ¶ˆæ¯è¢«æ¸…ç©ºã€‚åŒæ—¶æŽ¥æ”¶ç«¯ä¿æŒè¿è¡ŒçŠ¶æ€ç­‰å¾…æ–°çš„æ¶ˆæ¯è¢«è½¬å‘ç»™è‡ªå·±ã€‚æ¶ˆæ¯é˜Ÿåˆ—ä¸€ç›´å¤„äºŽç­‰å¾…ç”Ÿäº§è€…å‘é€æ¶ˆæ¯å’Œå°†æ”¶åˆ°æˆ–ç¼“å­˜çš„æ¶ˆæ¯è½¬å‘ç»™æ¶ˆè´¹è€…çš„çŠ¶æ€ã€‚å¦‚æœªæœ‰æ¶ˆè´¹è€…åŠæ—¶æŽ¥æ”¶å’Œå¤„ç†è¢«è½¬å‘çš„æ¶ˆæ¯ï¼Œåˆ™è¿™éƒ¨åˆ†æ¶ˆæ¯ç¼“å­˜åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…è¿›ä¸€æ­¥æ“ä½œã€‚ Work Queueç»“æž„ç¤ºæ„å›¾ï¼šæœ¬ä¾‹ä¸­å°†åˆ›å»ºä¸€ä¸ª Work Queue ç”¨æ¥å°†æ¶ˆè€—æ—¶é—´é•¿çš„ä»»åŠ¡ä»¥è½®è¯¢çš„æ–¹å¼åˆ†å‘ç»™å¤šä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚ ç”Ÿäº§è€…æºä»£ç  new_task.py ï¼š1234567891011121314151617181920#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.queue_declare(queue=&apos;task_queue&apos;, durable=True)message = &apos; &apos;.join(sys.argv[1:]) or &quot;Hello World!&quot;channel.basic_publish( exchange=&apos;&apos;, routing_key=&apos;task_queue&apos;, body=message, properties=pika.BasicProperties( delivery_mode=2, # make message persistent ))print(&quot; [x] Sent %r&quot; % message)connection.close() æ¶ˆè´¹è€…æºä»£ç  worker.py ï¼š1234567891011121314151617181920212223#!/usr/bin/env pythonimport pikaimport timeconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.queue_declare(queue=&apos;task_queue&apos;, durable=True)print(&apos; [*] Waiting for messages. To exit press CTRL+C&apos;)def callback(ch, method, properties, body): print(&quot; [x] Received %r&quot; % body) time.sleep(body.count(b&apos;.&apos;)) print(&quot; [x] Done&quot;) ch.basic_ack(delivery_tag=method.delivery_tag) # Message acknowledgmentchannel.basic_qos(prefetch_count=1)channel.basic_consume(queue=&apos;task_queue&apos;, on_message_callback=callback)channel.start_consuming() Message acknowledgmentæ¶ˆè´¹è€…åœ¨å¤„ç†æŽ¥æ”¶åˆ°çš„ä»»åŠ¡æˆ–æ¶ˆæ¯æ—¶æœ‰å¯èƒ½ä¼šæ¶ˆè€—æ¯”è¾ƒå¤šçš„æ—¶é—´ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå¦‚æ¶ˆè´¹è€…ç«¯å‡ºçŽ°è½¯ç¡¬ä»¶æ•…éšœï¼Œåˆ™ä¼šå‡ºçŽ°æ¶ˆæ¯ä¸¢å¤±çš„æƒ…å†µã€‚ RabbitMQ æ”¯æŒ Message acknowledgment ã€‚å³æ¶ˆè´¹è€…åœ¨æŽ¥æ”¶å’Œå¤„ç†å®Œä¸€ä¸ªç‰¹å®šçš„æ¶ˆæ¯åŽä¼šå‘ RabbitMQ è¿”å›žä¸€ä¸ªåº”ç­”ï¼ˆackï¼‰ï¼Œè¯´æ˜Žè¯¥æ¶ˆæ¯å¯ä»¥ä»Žé˜Ÿåˆ—ä¸­ç§»é™¤ã€‚å¦‚æžœæ¶ˆè´¹è€…åœ¨è¿”å›žåº”ç­”ä¹‹å‰ä¸¢å¤±ä¸Žé˜Ÿåˆ—çš„è¿žæŽ¥ï¼Œåˆ™ RabbitMQ åˆ¤å®šå¯¹åº”çš„æ¶ˆæ¯æœªç”±æ¶ˆè´¹è€…å®Œå…¨å¤„ç†ï¼Œä¼šå°†è¯¥æ¶ˆæ¯ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­å¹¶é‡æ–°åˆ†å‘ç»™å…¶ä»–åœ¨çº¿çš„æ¶ˆè´¹è€…ã€‚ Message durabilityæ¶ˆæ¯åº”ç­”çš„æœºåˆ¶å¯ä»¥ç¡®ä¿å³ä½¿æ¶ˆè´¹è€…å®•æœºçš„æƒ…å†µä¸‹ä»»åŠ¡ä»ä¸ä¼šä¸¢å¤±ã€‚ä½†æ˜¯å½“ RabbitMQ æœåŠ¡æœ¬èº«å‡ºçŽ°æ•…éšœæ—¶ï¼Œé˜Ÿåˆ—ä»¥åŠé˜Ÿåˆ—ä¸­ç¼“å­˜çš„æ¶ˆæ¯ä»æ—§ä¼šè¢«æ¸…ç†æŽ‰ã€‚ ä¸ºäº†ä¿è¯ RabbitMQ ä¸­é˜Ÿåˆ—ä»¥åŠæ¶ˆæ¯çš„æŒä¹…åŒ–ï¼Œé¦–å…ˆéœ€è¦åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä»£ç ä¸­åŒæ—¶å£°æ˜Žé˜Ÿåˆ—ä¸º durable ï¼šchannel.queue_declare(queue=&#39;task_queue&#39;, durable=True) æ­¤å¤–è¿˜éœ€è¦å°†ç”Ÿäº§è€…ä»£ç ä¸­çš„ delivery_mode å±žæ€§è®¾ç½®ä¸º 2 ç¡®ä¿æ¶ˆæ¯çš„æŒä¹…åŒ–ï¼šproperties=pika.BasicProperties(delivery_mode=2,) æµ‹è¯•æ‰“å¼€ä¸¤ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œåˆ†åˆ«è¿è¡Œ worker.py ç¨‹åºï¼š123# Shell 1$ python worker.py [x] Waiting for messages. To exit press CTRL+C 123# Shell 2$ python worker.py [x] Waiting for messages. To exit press CTRL+C æ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œ new_task.py ç¨‹åºå‘é€ 4 æ¡æ¶ˆæ¯ï¼š123456789# Shell 3$ python new_task.py First Message [x] Sent &apos;First Message&apos;$ python new_task.py Second Message [x] Sent &apos;Second Message&apos;$ python new_task.py Third Message [x] Sent &apos;Third Message&apos;$ python new_task.py Forth Message [x] Sent &apos;Forth Message&apos; æœ€ç»ˆä¸¤ä¸ªæ¶ˆè´¹è€…åˆ†åˆ«æŽ¥æ”¶åˆ°é˜Ÿåˆ—åˆ†å‘çš„ä¸¤æ¡æ¶ˆæ¯ï¼š1234567# Shell 1$ python worker.py [x] Waiting for messages. To exit press CTRL+C [x] Received b&apos;First Message&apos; [x] Done [x] Received b&apos;Third Message&apos; [x] Done 1234567# Shell 2$ python worker.py [x] Waiting for messages. To exit press CTRL+C [x] Received b&apos;Second Message&apos; [x] Done [x] Received b&apos;Forth Message&apos; [x] Done Fair dispatchå½“ RabbitMQ ä»¥è½®è¯¢çš„æ–¹å¼ï¼ˆå³å¹³å‡åˆ†é…ï¼‰å°†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è½¬å‘ç»™å¤šä¸ªæ¶ˆè´¹è€…æ—¶ï¼Œå¦‚æžœè¿™äº›æ¶ˆè´¹è€…æŽ¥æ”¶åˆ°çš„ä»»åŠ¡ç¹é‡ç¨‹åº¦å·®å¼‚å¾ˆå¤§ï¼Œåˆ™ä¼šå¯¼è‡´æŸäº›æ¶ˆè´¹è€…ç«¯ä»»åŠ¡çš„ç§¯åŽ‹ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œå¯ä»¥ä½¿ç”¨ basic_qos æ–¹æ³•è®¾ç½® prefetch çš„å€¼ï¼Œå¦‚ worker.py ç¨‹åºä¸­çš„ä»¥ä¸‹ä»£ç ï¼šchannel.basic_qos(prefetch_count=1) ã€‚ è¯¥è¡Œä»£ç å¯ä»¥ç¡®ä¿åŒä¸€ä¸ªæ¶ˆè´¹è€…åœ¨ä»»æ„æ—¶é—´ç‚¹æœ€å¤šåªæŽ¥å— 1 ä¸ªä»»åŠ¡åˆ†é…ç»™è‡ªå·±ã€‚å³å¦‚æžœæŸä¸ªæ¶ˆè´¹è€…å½“å‰æœ‰æœªå¤„ç†å®Œçš„æ¶ˆæ¯ï¼Œåˆ™ä¸å†æŽ¥æ”¶æ–°çš„æ¶ˆæ¯ç›´åˆ°å½“å‰çš„ä»»åŠ¡å¤„ç†å®Œã€‚ Publish/Subscribeç»“æž„ç¤ºæ„å›¾ï¼š Exchangeåœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œç”¨åˆ°äº†æ¶ˆæ¯é˜Ÿåˆ—æ¨¡åž‹ä¸­çš„ä»¥ä¸‹å‡ ä¸ªç»„ä»¶ï¼š producer ï¼šç”Ÿäº§è€…ï¼Œå³å‘é€æ¶ˆæ¯çš„åº”ç”¨ queue ï¼šé˜Ÿåˆ—ï¼Œå³å­˜å‚¨æ¶ˆæ¯çš„ç¼“å­˜ consumer ï¼šæ¶ˆè´¹è€…ï¼Œå³æŽ¥æ”¶æ¶ˆæ¯çš„åº”ç”¨ å®žé™…ä¸Šåœ¨ RabbitMQ çš„æ¶ˆæ¯æ¨¡åž‹ä¸­ï¼Œç”Ÿäº§è€…ä»Žæ¥ä¸ä¼šå°†æ¶ˆæ¯ç›´æŽ¥å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å°†æ¶ˆæ¯å‘é€ç»™ä¸€ä¸ªåä¸º exchange çš„ç»„ä»¶ã€‚exchange çš„ä¸€ç«¯ç”¨æ¥æŽ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œä¸€ç«¯ç”¨æ¥å°†æ¶ˆæ¯æŽ¨é€åˆ°é˜Ÿåˆ—ä¸­ã€‚å®ƒé€šè¿‡ exchange type ä¸­çš„å®šä¹‰åˆ¤æ–­ç‰¹å®šçš„æ¶ˆæ¯æ˜¯è¯¥æŽ¨é€ç»™æŸä¸ªå¯¹åº”çš„é˜Ÿåˆ—ï¼Œè¿˜æ˜¯å°†å…¶å¹¿æ’­ç»™å¤šä¸ªé˜Ÿåˆ—ï¼Œåˆæˆ–è€…ç›´æŽ¥ä¸¢å¼ƒã€‚ RabbitMQ ä¸»è¦æä¾›äº† 4 ç§ exchange ç±»åž‹ï¼šdirectã€topicã€headers å’Œ fanoutã€‚æœ¬ä¾‹ä¸­ä½¿ç”¨ fanoutï¼Œå³ exchange ä¼šå°†æŽ¥æ”¶åˆ°çš„æ¶ˆæ¯ä»¥å¹¿æ’­çš„å½¢å¼å‘é€ç»™æ‰€æœ‰å…³è”çš„é˜Ÿåˆ—ï¼Œå†ç”±é˜Ÿåˆ—ä¼ é€’ç»™æ¶ˆè´¹è€…å¤„ç†ã€‚ æºä»£ç ï¼ˆemit_log.pyï¼‰å¦‚ä¸‹ï¼š1234567891011121314#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;logs&apos;, exchange_type=&apos;fanout&apos;)message = &apos; &apos;.join(sys.argv[1:]) or &quot;info: Hello World!&quot;channel.basic_publish(exchange=&apos;logs&apos;, routing_key=&apos;&apos;, body=message)print(&quot; [x] Sent %r&quot; % message)connection.close() receive_logs.pyï¼š1234567891011121314151617181920212223#!/usr/bin/env pythonimport pikaconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;logs&apos;, exchange_type=&apos;fanout&apos;)result = channel.queue_declare(queue=&apos;&apos;, exclusive=True)queue_name = result.method.queuechannel.queue_bind(exchange=&apos;logs&apos;, queue=queue_name)print(&apos; [*] Waiting for logs. To exit press CTRL+C&apos;)def callback(ch, method, properties, body): print(&quot; [x] %r&quot; % body)channel.basic_consume( queue=queue_name, on_message_callback=callback, auto_ack=True)channel.start_consuming() receive_logs.py æ–‡ä»¶ä¸­æœ‰ä¸€è¡Œ result = channel.queue_declare(queue=&#39;&#39;, exclusive=True) ä»£ç ï¼Œç”¨æ¥å£°æ˜Žä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ï¼ˆ queue=&#39;&#39; æ²¡æœ‰æŒ‡å®šåç§°ï¼Œå› æ­¤ä¼šç”± RabbitMQ è®¾ç½®éšæœºçš„åç§°ï¼‰ï¼ŒåŒæ—¶ exclusive=True è®¾ç½®è¯¥é˜Ÿåˆ—åœ¨æ¶ˆè´¹è€…æ–­å¼€è¿žæŽ¥åŽè‡ªè¡Œåˆ é™¤ã€‚ æµ‹è¯•åŒæ—¶æ‰“å¼€ä¸¤ä¸ªå‘½ä»¤è¡Œçª—å£åˆ†åˆ«è¿è¡Œ receive_logs.py æ–‡ä»¶ï¼š123# Shell 1$ python receive_logs.py [*] Waiting for logs. To exit press CTRL+C 123# Shell 2$ python receive_logs.py [*] Waiting for logs. To exit press CTRL+C å†æ‰“å¼€ç¬¬ä¸‰ä¸ªç»ˆç«¯æ‰§è¡Œ emit_log.py å‘½ä»¤ 4 æ¬¡ï¼š123456789# Shell 3$ python emit_log.py [x] Sent &apos;info: Hello World!&apos;$ python emit_log.py [x] Sent &apos;info: Hello World!&apos;$ python emit_log.py [x] Sent &apos;info: Hello World!&apos;$ python emit_log.py [x] Sent &apos;info: Hello World!&apos; æ­¤æ—¶ä¹‹å‰è¿è¡Œçš„ä¸¤ä¸ª receive ç¨‹åºåŒæ—¶æ”¶åˆ°å‘é€çš„ 4 æ¡æ¶ˆæ¯ï¼š123456$ python receive_logs.py [*] Waiting for logs. To exit press CTRL+C [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; 123456$ python receive_logs.py [*] Waiting for logs. To exit press CTRL+C [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; [x] b&apos;info: Hello World!&apos; Routingç»“æž„ç¤ºæ„å›¾ï¼šä¸Žä¸Šä¸€ä¸ªä¾‹å­ä¸­ä»¥å¹¿æ’­çš„å½¢å¼è½¬å‘æ¶ˆæ¯ä¸åŒï¼Œæœ¬ä¾‹ä¸­å…è®¸æ¶ˆè´¹è€…é€šè¿‡é˜Ÿåˆ—æœ‰é€‰æ‹©åœ°è®¢é˜…ç”Ÿäº§è€…å‘é€çš„éƒ¨åˆ†æ¶ˆæ¯ã€‚ Binding å’Œ Direct exchangeåœ¨ RabbitMQ ä¸­ï¼Œbinding ä»£è¡¨ exchange ä¸Žé˜Ÿåˆ—çš„å¯¹åº”å…³ç³»ï¼Œå³é˜Ÿåˆ—ä¼šæ ¹æ® binding çš„è®¾ç½®å¯¹ exchange è½¬å‘çš„æ¶ˆæ¯æœ‰é€‰æ‹©æ€§åœ°æŽ¥æ”¶ã€‚å› æ­¤ binding çš„æœ€ç»ˆæ•ˆæžœä¹Ÿä¾èµ–äºŽ exchange çš„ç±»åž‹ã€‚æ¯”å¦‚ä¹‹å‰ç”¨åˆ°çš„ fanout ç±»åž‹ï¼Œç”±äºŽæ˜¯å¹¿æ’­çš„å½¢å¼ï¼ˆè½¬å‘ç»™æ‰€æœ‰å…³è”çš„é˜Ÿåˆ—ï¼‰å¹¶ä¸éœ€è¦é€‰æ‹©çš„åŠ¨ä½œï¼Œåˆ™ binding çš„å€¼è¢«å¿½ç•¥ã€‚ ä½†æ˜¯å¯¹äºŽ direct ç±»åž‹çš„ exchange ï¼Œåˆ™å¯ä»¥é€šè¿‡ binding å¯¹æ¶ˆæ¯è¿›è¡Œç­›é€‰ã€‚åœ¨ direct exchange ä¸‹ï¼Œåªæœ‰å½“é˜Ÿåˆ—çš„ binding_key ä¸Žæ¶ˆæ¯çš„ routing_key ä¸€è‡´æ—¶ï¼Œé˜Ÿåˆ—æ‰ä¼šæ”¶åˆ° exchange è½¬å‘çš„æ¶ˆæ¯ã€‚ emit_log_direct.pyï¼š12345678910111213141516#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;direct_logs&apos;, exchange_type=&apos;direct&apos;)severity = sys.argv[1] if len(sys.argv) &gt; 1 else &apos;info&apos;message = &apos; &apos;.join(sys.argv[2:]) or &apos;Hello World!&apos;channel.basic_publish( exchange=&apos;direct_logs&apos;, routing_key=severity, body=message)print(&quot; [x] Sent %r:%r&quot; % (severity, message))connection.close() receive_logs_direct.pyï¼š123456789101112131415161718192021222324252627282930313233#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;direct_logs&apos;, exchange_type=&apos;direct&apos;)result = channel.queue_declare(queue=&apos;&apos;, exclusive=True)queue_name = result.method.queueseverities = sys.argv[1:]if not severities: sys.stderr.write(&quot;Usage: %s [info] [warning] [error]\n&quot; % sys.argv[0]) sys.exit(1)for severity in severities: channel.queue_bind( exchange=&apos;direct_logs&apos;, queue=queue_name, routing_key=severity)print(&apos; [*] Waiting for logs. To exit press CTRL+C&apos;)def callback(ch, method, properties, body): print(&quot; [x] %r:%r&quot; % (method.routing_key, body))channel.basic_consume( queue=queue_name, on_message_callback=callback, auto_ack=True)channel.start_consuming() æµ‹è¯•é¦–å…ˆè¿è¡Œ receive_logs_direct.py ç¨‹åºå¹¶æŒ‡å®šå‚æ•°ä¸º errorï¼ˆå³åªæŽ¥æ”¶æ ‡è®°ä¸ºâ€œerrorâ€çš„æ¶ˆæ¯ï¼‰ï¼š123# Shell 1$ python receive_logs_direct.py error [*] Waiting for logs. To exit press CTRL+C æ‰“å¼€å¦ä¸€ç»ˆç«¯åŒæ ·è¿è¡Œ receive_logs_direct.py ç¨‹åºå¹¶æŒ‡å®šå‚æ•°ä¸º info warningï¼ˆå³æŽ¥æ”¶æ ‡è®°ä¸º info æˆ– warning çš„æ¶ˆæ¯ï¼‰ï¼š123# Shell 2$ python receive_logs_direct.py info warning [*] Waiting for logs. To exit press CTRL+C æ‰“å¼€ç¬¬ä¸‰ä¸ªç»ˆç«¯å¹¶è¿è¡Œ emit_log_direct.py ç¨‹åºå‘é€ 4 æ¡æ—¥å¿—æ¶ˆæ¯ï¼š123456789# Shell 3$ python emit_log_direct.py error &quot;This is an error&quot; [x] Sent &apos;error&apos;:&apos;This is an error&apos;$ python emit_log_direct.py info &quot;Hi, I am an info&quot; [x] Sent &apos;info&apos;:&apos;Hi, I am an info&apos;$ python emit_log_direct.py warning &quot;Yeah, it&apos;s a warning&quot; [x] Sent &apos;warning&apos;:&quot;Yeah, it&apos;s a warning&quot;$ python emit_log_direct.py error &quot;Hi, it&apos;s an error again&quot; [x] Sent &apos;error&apos;:&quot;Hi, it&apos;s an error again&quot; æ­¤æ—¶ Shell 1 ä¸­åªæŽ¥æ”¶åˆ°äº†æ ‡è®°ä¸º error çš„æ¶ˆæ¯ï¼š1234$ python receive_logs_direct.py error [*] Waiting for logs. To exit press CTRL+C [x] &apos;error&apos;:b&apos;This is an error&apos; [x] &apos;error&apos;:b&quot;Hi, it&apos;s an error again&quot; è€Œ Shell 2 ä¸­æŽ¥æ”¶åˆ°äº†æ ‡è®°ä¸º info å’Œ warning çš„æ¶ˆæ¯ï¼š1234$ python receive_logs_direct.py info warning [*] Waiting for logs. To exit press CTRL+C [x] &apos;info&apos;:b&apos;Hi, I am an info&apos; [x] &apos;warning&apos;:b&quot;Yeah, it&apos;s a warning&quot; Topicsç»“æž„ç¤ºæ„å›¾ï¼š direct ç±»åž‹çš„ exchange è™½ç„¶å¯ä»¥æ ¹æ®æ¶ˆæ¯çš„ routing_key ä»¥åŠé˜Ÿåˆ—çš„ binding_key æœ‰é€‰æ‹©æ€§çš„æŽ¨é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œä½†æ˜¯å¹¶ä¸é€‚åˆæ›´å¤æ‚çš„åœºæ™¯ã€‚è€Œ topic ç±»åž‹çš„ exchange ä¸Ž direct ç±»åž‹é€»è¾‘ä¸Šå¤§è‡´ç›¸åŒï¼Œåªæ˜¯ topic ç±»åž‹çš„ exchange å¹¶æ²¡æœ‰ä¸€ä¸ªæ˜Žç¡®çš„ routing_keyï¼Œè€Œæ˜¯ç”±å‡ ä¸ªç‚¹å·ï¼ˆ.ï¼‰åˆ†éš”çš„å•è¯ï¼ˆå¦‚ lazy.orange.catï¼‰è¿›è¡Œå®šä¹‰ã€‚ä¸Žä¹‹å¯¹åº”çš„ binding_key ä¹Ÿéœ€è¦éµå¾ªåŒæ ·çš„å½¢å¼ï¼Œåªä¸è¿‡ binding_key é¢å¤–æ”¯æŒä¸¤ä¸ªç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ï¼š æ˜Ÿå·ï¼ˆ*)å¯ä»¥è¡¨ç¤ºæŸä¸€ä¸ªä»»æ„çš„å•è¯ äº•å·ï¼ˆ#ï¼‰å¯ä»¥è¡¨ç¤ºä»»æ„ 0 ä¸ªæˆ–å¤šä¸ªå•è¯ å› æ­¤å¯¹äºŽä¸Šå›¾ï¼ˆTopicsï¼‰ä¸­çš„æƒ…å½¢ï¼Œrouting_key ä¸º quick.orange.rabbit çš„æ¶ˆæ¯ä¼šè¢«è½¬å‘ç»™ Q1 å’Œ Q2 é˜Ÿåˆ—ï¼Œquick.orange.fox åˆ™åªä¼šè½¬å‘ç»™ Q1 é˜Ÿåˆ—ï¼Œlazy.orange.male.rabbit è¢«è½¬å‘ç»™ Q2 é˜Ÿåˆ—ã€‚ emit_log_topicï¼š12345678910111213141516#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;topic_logs&apos;, exchange_type=&apos;topic&apos;)routing_key = sys.argv[1] if len(sys.argv) &gt; 2 else &apos;anonymous.info&apos;message = &apos; &apos;.join(sys.argv[2:]) or &apos;Hello World!&apos;channel.basic_publish( exchange=&apos;topic_logs&apos;, routing_key=routing_key, body=message)print(&quot; [x] Sent %r:%r&quot; % (routing_key, message))connection.close() receive_logs_topic.pyï¼š123456789101112131415161718192021222324252627282930313233#!/usr/bin/env pythonimport pikaimport sysconnection = pika.BlockingConnection( pika.ConnectionParameters(host=&apos;localhost&apos;))channel = connection.channel()channel.exchange_declare(exchange=&apos;topic_logs&apos;, exchange_type=&apos;topic&apos;)result = channel.queue_declare(&apos;&apos;, exclusive=True)queue_name = result.method.queuebinding_keys = sys.argv[1:]if not binding_keys: sys.stderr.write(&quot;Usage: %s [binding_key]...\n&quot; % sys.argv[0]) sys.exit(1)for binding_key in binding_keys: channel.queue_bind( exchange=&apos;topic_logs&apos;, queue=queue_name, routing_key=binding_key)print(&apos; [*] Waiting for logs. To exit press CTRL+C&apos;)def callback(ch, method, properties, body): print(&quot; [x] %r:%r&quot; % (method.routing_key, body))channel.basic_consume( queue=queue_name, on_message_callback=callback, auto_ack=True)channel.start_consuming() æµ‹è¯•å…ˆè¿è¡ŒæŽ¥æ”¶ç«¯ç¨‹åºï¼ˆShell 1 å’Œ Shell 2ï¼‰ï¼Œå†è¿è¡Œå‘é€ç«¯ï¼ˆShell 3ï¼‰ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š1234567# Shell 3$ python emit_log_topic.py &quot;kern.warning&quot; &quot;A kernel warning message&quot; [x] Sent &apos;kern.warning&apos;:&apos;A kernel warning message&apos;$ python emit_log_topic.py &quot;network.critical&quot; &quot;A critical network error&quot; [x] Sent &apos;network.critical&apos;:&apos;A critical network error&apos;$ python emit_log_topic.py &quot;kern.critical&quot; &quot;A critical kernel error&quot; [x] Sent &apos;kern.critical&apos;:&apos;A critical kernel error&apos; 12345# Shell 1$ python receive_logs_topic.py &quot;kern.*&quot; [*] Waiting for logs. To exit press CTRL+C [x] &apos;kern.warning&apos;:b&apos;A kernel warning message&apos; [x] &apos;kern.critical&apos;:b&apos;A critical kernel error&apos; 12345# Shell 2$ python receive_logs_topic.py &quot;*.critical&quot; [*] Waiting for logs. To exit press CTRL+C [x] &apos;network.critical&apos;:b&apos;A critical network error&apos; [x] &apos;kern.critical&apos;:b&apos;A critical kernel error&apos; å‚è€ƒèµ„æ–™RabbitMQ TutorialsRabbitMQ in Depth]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>DevOps</tag>
        <tag>Development</tag>
        <tag>Message</tag>
        <tag>Deployment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu ç³»ç»Ÿ dpkg å‘½ä»¤ä½¿ç”¨è¯¦è§£]]></title>
    <url>%2F2019%2F07%2F21%2Fdpkg-package-manager-manual%2F</url>
    <content type="text"><![CDATA[dpkg å³ package manager for Debian ï¼Œæ˜¯ Debian å’ŒåŸºäºŽ Debian çš„ç³»ç»Ÿä¸­ä¸€ä¸ªä¸»è¦çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥å®‰è£…ã€æž„å»ºã€å¸è½½ã€ç®¡ç† deb æ ¼å¼çš„è½¯ä»¶åŒ…ã€‚ å®‰è£…è½¯ä»¶ä½¿ç”¨ dpkg å‘½ä»¤å®‰è£…è½¯ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ -i é€‰é¡¹å¹¶æŒ‡å®š deb å®‰è£…åŒ…çš„è·¯å¾„ã€‚å’Œ Ubuntu ä¸‹çš„å¦ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…· apt-getï¼ˆAdvanced Package Toolï¼‰æœ‰æ‰€ä¸åŒã€‚apt-get å‘½ä»¤å¹¶ä¸ç›´æŽ¥æ“ä½œ deb å®‰è£…åŒ…æ–‡ä»¶ï¼Œè€Œæ˜¯ä»Ž /etc/apt/sources.list é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„è½¯ä»¶é•œåƒæºé‡Œä¸‹è½½è½¯ä»¶åŒ…å¹¶å®‰è£…ï¼Œä½¿ç”¨æ—¶ä¹Ÿåªéœ€æŒ‡å®šè½¯ä»¶çš„åç§°ï¼ˆæˆ–è€…ä¹Ÿå¯ä»¥é™„åŠ ä¸Šç‰ˆæœ¬å·ï¼‰ã€‚ apt-get å‘½ä»¤å®‰è£…è½¯ä»¶ï¼š$ apt-get install &lt;package_name[=version]&gt; dpkg å‘½ä»¤å®‰è£…è½¯ä»¶ï¼š$ dpkg -i &lt;package_file_path&gt; å› æ­¤ï¼Œdpkg ä¸»è¦æ˜¯ç”¨æ¥å®‰è£…å·²ç»ä¸‹è½½åˆ°æœ¬åœ°çš„ deb è½¯ä»¶åŒ…ï¼Œæˆ–è€…å¯¹å·²ç»å®‰è£…å¥½çš„è½¯ä»¶è¿›è¡Œç®¡ç†ã€‚è€Œ apt-get å¯ä»¥ç›´æŽ¥ä»Žè¿œç¨‹çš„è½¯ä»¶ä»“åº“é‡Œä¸‹è½½å®‰è£…è½¯ä»¶ã€‚ 12345678910111213141516$ sudo apt-get install emacsæ­£åœ¨è¯»å–è½¯ä»¶åŒ…åˆ—è¡¨... å®Œæˆæ­£åœ¨åˆ†æžè½¯ä»¶åŒ…çš„ä¾èµ–å…³ç³»æ ‘æ­£åœ¨è¯»å–çŠ¶æ€ä¿¡æ¯... å®Œæˆå°†ä¼šåŒæ—¶å®‰è£…ä¸‹åˆ—è½¯ä»¶ï¼š emacs-bin-common emacs-common emacs-el emacs-gtk libm17n-0 libotf0 m17n-dbå»ºè®®å®‰è£…ï¼š mailutils emacs-common-non-dfsg m17n-docs gawkä¸‹åˆ—ã€æ–°ã€‘è½¯ä»¶åŒ…å°†è¢«å®‰è£…ï¼š emacs emacs-bin-common emacs-common emacs-el emacs-gtk libm17n-0 libotf0 m17n-dbå‡çº§äº† 0 ä¸ªè½¯ä»¶åŒ…ï¼Œæ–°å®‰è£…äº† 8 ä¸ªè½¯ä»¶åŒ…ï¼Œè¦å¸è½½ 0 ä¸ªè½¯ä»¶åŒ…ï¼Œæœ‰ 115 ä¸ªè½¯ä»¶åŒ…æœªè¢«å‡çº§ã€‚éœ€è¦ä¸‹è½½ 34.4 MB çš„å½’æ¡£ã€‚è§£åŽ‹ç¼©åŽä¼šæ¶ˆè€— 137 MB çš„é¢å¤–ç©ºé—´ã€‚æ‚¨å¸Œæœ›ç»§ç»­æ‰§è¡Œå—ï¼Ÿ [Y/n] 123456$ sudo dpkg -i fping_4.2-1_amd64.deb(æ­£åœ¨è¯»å–æ•°æ®åº“ ... ç³»ç»Ÿå½“å‰å…±å®‰è£…æœ‰ 252654 ä¸ªæ–‡ä»¶å’Œç›®å½•ã€‚)å‡†å¤‡è§£åŽ‹ fping_4.2-1_amd64.deb ...æ­£åœ¨è§£åŽ‹ fping (4.2-1) å¹¶è¦†ç›– (4.2-1) ...æ­£åœ¨è®¾ç½® fping (4.2-1) ...æ­£åœ¨å¤„ç†ç”¨äºŽ man-db (2.8.5-2) çš„è§¦å‘å™¨ ... åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶å¯ä»¥ä½¿ç”¨ dpkg -l å‘½ä»¤åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„è½¯ä»¶ä»¥åŠè½¯ä»¶åŒ…çš„çŠ¶æ€ã€‚å¦‚ï¼š12345678910111213141516$ dpkg -læœŸæœ›çŠ¶æ€=æœªçŸ¥(u)/å®‰è£…(i)/åˆ é™¤(r)/æ¸…é™¤(p)/ä¿æŒ(h)| çŠ¶æ€=æœªå®‰è£…(n)/å·²å®‰è£…(i)/ä»…å­˜é…ç½®(c)/ä»…è§£åŽ‹ç¼©(U)/é…ç½®å¤±è´¥(F)/ä¸å®Œå…¨å®‰è£…(H)/è§¦å‘å™¨ç­‰å¾…(W)/è§¦å‘å™¨æœªå†³(T)|/ é”™è¯¯?=(æ— )/é¡»é‡è£…(R) (çŠ¶æ€ï¼Œé”™è¯¯ï¼šå¤§å†™=æ•…éšœ)||/ åç§° ç‰ˆæœ¬ ä½“ç³»ç»“æž„ æè¿°+++-=============================================-===================================-============-===============================================================================ii 2048-qt 0.1.6-1build1 amd64 mathematics based puzzle gameii accountsservice 0.6.50-0ubuntu1 amd64 query and manipulate user account informationii acl 2.2.53-4 amd64 access control list - utilitiesii acpi-support 0.143 amd64 scripts for handling many ACPI eventsii acpid 1:2.0.31-1ubuntu2 amd64 Advanced Configuration and Power Interface event daemonii adduser 3.118ubuntu1 all add and remove users and groupsii adwaita-icon-theme 3.32.0-1ubuntu1 all default icon theme of GNOME (small subset)ii alsa-base 1.0.25+dfsg-0ubuntu5 all ALSA driver configuration filesii alsa-utils 1.1.8-1ubuntu1 amd64 Utilities for configuring and using ALSA... è¯¥å‘½ä»¤æ¯è¡Œè¾“å‡ºä¸­çš„ç¬¬ä¸€åˆ— ii è¡¨ç¤ºè½¯ä»¶åŒ…çš„å®‰è£…å’Œé…ç½®çŠ¶æ€ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼šæœŸæœ›çŠ¶æ€|å½“å‰çŠ¶æ€|é”™è¯¯å…¶ä¸­æœŸæœ›çŠ¶æ€æœ‰ä»¥ä¸‹å‡ ç§ uï¼šå³ unknownï¼Œè½¯ä»¶åŒ…æœªå®‰è£…ä¸”ç”¨æˆ·æœªè¯·æ±‚å®‰è£… iï¼šå³ installï¼Œç”¨æˆ·è¯·æ±‚å®‰è£…è¯¥è½¯ä»¶åŒ… rï¼šå³ removeï¼Œç”¨æˆ·è¯·æ±‚å¸è½½è¯¥è½¯ä»¶åŒ… pï¼šå³ purgeï¼Œç”¨æˆ·è¯·æ±‚å¸è½½è¯¥è½¯ä»¶åŒ…å¹¶æ¸…ç†é…ç½®æ–‡ä»¶ hï¼šå³ holdï¼Œç”¨æˆ·è¯·æ±‚ä¿æŒç»­å½“å‰è½¯ä»¶åŒ…ç‰ˆæœ¬ å½“å‰çŠ¶æ€ æœ‰ä»¥ä¸‹å‡ ç§ï¼š nï¼šå³ not-installedï¼Œè½¯ä»¶åŒ…æœªå®‰è£… iï¼šå³ installedï¼Œè½¯ä»¶åŒ…å·²å®‰è£…å¹¶å®Œæˆé…ç½® cï¼šå³ config-filesï¼Œè½¯ä»¶åŒ…å·²ç»è¢«å¸è½½ï¼Œä½†æ˜¯å…¶é…ç½®æ–‡ä»¶æœªæ¸…ç† uï¼šå³ unpackedï¼Œè½¯ä»¶åŒ…å·²ç»è¢«è§£åŽ‹ç¼©ï¼Œä½†è¿˜æœªé…ç½® fï¼šå³ half-configuredï¼Œé…ç½®è½¯ä»¶åŒ…æ—¶å‡ºçŽ°é”™è¯¯ wï¼šå³ triggers-awaitedï¼Œè§¦å‘å™¨ç­‰å¾… tï¼šå³ triggers-pendingï¼Œè§¦å‘å™¨æœªå†³ é”™è¯¯çŠ¶æ€ æœ‰ä»¥ä¸‹å‡ ç§ï¼š hï¼šè½¯ä»¶åŒ…è¢«å¼ºåˆ¶ä¿æŒ rï¼šå³ reinstall-requiredï¼Œéœ€è¦å¸è½½å¹¶é‡æ–°å®‰è£… xï¼šè½¯ä»¶åŒ…è¢«ç ´å å› æ­¤ ii è¡¨ç¤ºè¯¥è½¯ä»¶éœ€è¦å®‰è£…ä¸”å·²ç»å®‰è£…ï¼Œæ²¡æœ‰å‡ºçŽ°é”™è¯¯ï¼›iu è¡¨ç¤ºå·²ç»å®‰è£…è¯¥è½¯ä»¶ï¼Œä½†æœªæ­£ç¡®é…ç½®ï¼›rc è¡¨ç¤ºè¯¥è½¯ä»¶å·²ç»è¢«åˆ é™¤ï¼Œä½†é…ç½®æ–‡ä»¶æœªæ¸…ç†ã€‚ æŸ¥çœ‹å¤„äºŽ rc çŠ¶æ€çš„è½¯ä»¶åŒ…ï¼š123456$ dpkg -l | grep ^rcrc libmhash2:amd64 0.9.9.9-7 amd64 Library for cryptographic hashing and message authenticationrc linux-image-5.0.0-13-generic 5.0.0-13.14 amd64 Signed kernel image genericrc linux-modules-5.0.0-13-generic 5.0.0-13.14 amd64 Linux kernel extra modules for version 5.0.0 on 64 bit x86 SMPrc linux-modules-extra-5.0.0-13-generic 5.0.0-13.14 amd64 Linux kernel extra modules for version 5.0.0 on 64 bit x86 SMPrc zabbix-proxy-mysql 1:4.0.4+dfsg-1 amd64 network monitoring solution - proxy (using MySQL) æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ dpkg -l &lt;package_name_pattern&gt; å‘½ä»¤ç­›é€‰å‡ºåç§°ä¸­åŒ…å«æŒ‡å®šæ¨¡å¼çš„è½¯ä»¶åŒ…ã€‚12345678910111213$ dpkg -l &quot;nginx*&quot;æœŸæœ›çŠ¶æ€=æœªçŸ¥(u)/å®‰è£…(i)/åˆ é™¤(r)/æ¸…é™¤(p)/ä¿æŒ(h)| çŠ¶æ€=æœªå®‰è£…(n)/å·²å®‰è£…(i)/ä»…å­˜é…ç½®(c)/ä»…è§£åŽ‹ç¼©(U)/é…ç½®å¤±è´¥(F)/ä¸å®Œå…¨å®‰è£…(H)/è§¦å‘å™¨ç­‰å¾…(W)/è§¦å‘å™¨æœªå†³(T)|/ é”™è¯¯?=(æ— )/é¡»é‡è£…(R) (çŠ¶æ€ï¼Œé”™è¯¯ï¼šå¤§å†™=æ•…éšœ)||/ åç§° ç‰ˆæœ¬ ä½“ç³»ç»“æž„ æè¿°+++-==============-===============-============-=========================================================ii nginx 1.15.9-0ubuntu1 all small, powerful, scalable web/proxy serverii nginx-common 1.15.9-0ubuntu1 all small, powerful, scalable web/proxy server - common filesii nginx-core 1.15.9-0ubuntu1 amd64 nginx web/proxy server (standard version)un nginx-doc &lt;æ— &gt; &lt;æ— &gt; (æ— æè¿°)un nginx-extras &lt;æ— &gt; &lt;æ— &gt; (æ— æè¿°)un nginx-full &lt;æ— &gt; &lt;æ— &gt; (æ— æè¿°)un nginx-light &lt;æ— &gt; &lt;æ— &gt; (æ— æè¿°) å¸è½½è½¯ä»¶dpkg å‘½ä»¤çš„ -r é€‰é¡¹å¯ä»¥ç”¨æ¥å¸è½½å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œæ­¤æ—¶åªéœ€è¦æŒ‡å®šè½¯ä»¶çš„åç§°å³å¯ã€‚1234567$ sudo dpkg -r vim(æ­£åœ¨è¯»å–æ•°æ®åº“ ... ç³»ç»Ÿå½“å‰å…±å®‰è£…æœ‰ 252653 ä¸ªæ–‡ä»¶å’Œç›®å½•ã€‚)æ­£åœ¨å¸è½½ vim (2:8.1.0320-1ubuntu3.1) ...update-alternatives: ä½¿ç”¨ /usr/bin/vim.tiny æ¥åœ¨è‡ªåŠ¨æ¨¡å¼ä¸­æä¾› /usr/bin/vi (vi)update-alternatives: ä½¿ç”¨ /usr/bin/vim.tiny æ¥åœ¨è‡ªåŠ¨æ¨¡å¼ä¸­æä¾› /usr/bin/view (view)update-alternatives: ä½¿ç”¨ /usr/bin/vim.tiny æ¥åœ¨è‡ªåŠ¨æ¨¡å¼ä¸­æä¾› /usr/bin/ex (ex)update-alternatives: ä½¿ç”¨ /usr/bin/vim.tiny æ¥åœ¨è‡ªåŠ¨æ¨¡å¼ä¸­æä¾› /usr/bin/rview (rview) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ-r é€‰é¡¹åªä¼šç§»é™¤æŒ‡å®šçš„è½¯ä»¶åŒ…è€Œä¸å¯¹å…¶é…ç½®æ–‡ä»¶äº§ç”Ÿå½±å“ï¼Œå¯ä»¥ä½¿ç”¨ -P é€‰é¡¹åœ¨åˆ é™¤è½¯ä»¶åŒ…çš„åŒæ—¶æ¸…ç†é…ç½®æ–‡ä»¶ã€‚sudo dpkg -P &lt;package&gt; å…¶ä»–åŒ…ç®¡ç†æ“ä½œæŸ¥çœ‹è½¯ä»¶åŒ…çš„å†…å®¹dpkg -c &lt;package_file_path&gt;123456789101112131415161718192021$ dpkg -c fping_4.2-1_amd64.debdrwxr-xr-x root/root 0 2019-02-20 06:27 ./drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/bin/-rwxr-xr-x root/root 52128 2019-02-20 06:27 ./usr/bin/fpingdrwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/bug/-rwxr-xr-x root/root 118 2017-06-19 05:19 ./usr/share/bug/fpingdrwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/doc/drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/doc/fping/-rw-r--r-- root/root 495 2017-09-06 08:00 ./usr/share/doc/fping/NEWS.Debian.gz-rw-r--r-- root/root 1615 2019-02-20 06:27 ./usr/share/doc/fping/changelog.Debian.gz-rw-r--r-- root/root 3445 2017-12-07 04:09 ./usr/share/doc/fping/copyrightdrwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/lintian/drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/lintian/overrides/-rw-r--r-- root/root 41 2017-06-19 05:19 ./usr/share/lintian/overrides/fpingdrwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/man/drwxr-xr-x root/root 0 2019-02-20 06:27 ./usr/share/man/man8/-rw-r--r-- root/root 5733 2019-02-20 06:27 ./usr/share/man/man8/fping.8.gz-rw-r--r-- root/root 1512 2019-02-20 06:27 ./usr/share/man/man8/fping6.8.gzlrwxrwxrwx root/root 0 2019-02-20 06:27 ./usr/bin/fping6 -&gt; fping æŸ¥çœ‹è½¯ä»¶åŒ…ï¼ˆå·²å®‰è£…ï¼‰çš„è¯¦ç»†ä¿¡æ¯dpkg -s &lt;package&gt; æˆ– dpkg --status &lt;package&gt;1234567891011121314151617181920$ dpkg -s fpingPackage: fpingStatus: deinstall ok installedPriority: optionalSection: netInstalled-Size: 87Maintainer: Ubuntu Developers &lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;Architecture: amd64Version: 4.2-1Depends: libcap2-bin, netbase, libc6 (&gt;= 2.15)Enhances: netdata (&gt;= 1.5)Description: sends ICMP ECHO_REQUEST packets to network hosts fping is a ping like program which uses the Internet Control Message Protocol (ICMP) echo request to determine if a target host is responding. fping differs from ping in that you can specify any number of targets on the command line, or specify a file containing the lists of targets to ping. Instead of sending to one target until it times out or replies, fping will send out a ping packet and move on to the next target in a round-robin fashion.Original-Maintainer: Axel Beckert &lt;abe@debian.org&gt;Homepage: https://www.fping.org/ æŸ¥çœ‹è½¯ä»¶åŒ…çš„å®‰è£…ä½ç½®dpkg -L &lt;package&gt; æˆ– dpkg --list-files &lt;package&gt;123456789101112131415161718192021$ dpkg -L fping/./usr/usr/bin/usr/bin/fping/usr/share/usr/share/bug/usr/share/bug/fping/usr/share/doc/usr/share/doc/fping/usr/share/doc/fping/NEWS.Debian.gz/usr/share/doc/fping/changelog.Debian.gz/usr/share/doc/fping/copyright/usr/share/lintian/usr/share/lintian/overrides/usr/share/lintian/overrides/fping/usr/share/man/usr/share/man/man8/usr/share/man/man8/fping.8.gz/usr/share/man/man8/fping6.8.gz/usr/bin/fping6 ç­›é€‰å‡ºåŒ…å«æŒ‡å®šæ–‡ä»¶ï¼ˆæ¨¡å¼ï¼‰çš„è½¯ä»¶åŒ…dpkg -S &lt;filename_pattern&gt; æˆ– dpkg --search &lt;filename_pattern&gt;123456$ dpkg -S sites-availableapache2: /etc/apache2/sites-available/default-ssl.confapache2: /etc/apache2/sites-available/000-default.confnginx-common: /etc/nginx/sites-availablenginx-common: /etc/nginx/sites-available/defaultapache2: /etc/apache2/sites-available å‚è€ƒèµ„æ–™15 Practical Examples of â€œdpkg commandsâ€ for Debian Based DistrosLinuxè½¯ä»¶å®‰è£…ç®¡ç†ä¹‹â€”â€”dpkgä¸Žapt-*è¯¦è§£]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Package</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vimdiff å‘½ä»¤ä½¿ç”¨ä»‹ç»]]></title>
    <url>%2F2019%2F07%2F20%2Fvimdiff-manual%2F</url>
    <content type="text"><![CDATA[vimdiff ç­‰åŒäºŽ vim -d å‘½ä»¤ï¼Œå³ Vim ç¼–è¾‘å™¨çš„ diff æ¨¡å¼ã€‚è¯¥å‘½ä»¤åŽé¢é€šå¸¸ä¼šæŽ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶åä½œä¸ºå‚æ•°ï¼Œè¿™äº›æ–‡ä»¶ä¼šåŒæ—¶åœ¨ Vim ç¼–è¾‘å™¨çš„åˆ†å‰²çª—å£ä¸­æ‰“å¼€ï¼Œå¹¶é«˜äº®æ˜¾ç¤ºæ–‡ä»¶ä¸­å†…å®¹æœ‰å·®å¼‚çš„éƒ¨åˆ†ã€‚åŒæ—¶è¯¥æ¨¡å¼ä¸‹è¿˜æä¾›éƒ¨åˆ†å¿«æ·æŒ‰é”®ç”¨äºŽå®Œæˆæ–‡ä»¶å†…å®¹çš„åˆå¹¶ç­‰æ“ä½œã€‚ å¯åŠ¨ vimdiffvimdiff å‘½ä»¤å¸¸ç”¨äºŽç¼–è¾‘åŒä¸€æ–‡ä»¶çš„ä¸åŒåŽ†å²ç‰ˆæœ¬ï¼Œå¯¹å„æ–‡ä»¶çš„å†…å®¹è¿›è¡Œæ¯”å¯¹ä¸Žè°ƒæ•´ã€‚å¦‚ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶ï¼š123456789$ cat file1Line oneLine 2Line threeLine 4Line 5Line 6 123456789$ cat file2Line 1Line 2Line 3Line 4Line 5Line 6Line 7Line 8 å¯ä»¥ä½¿ç”¨ vim -O2 file1 file2 å‘½ä»¤ï¼Œåœ¨å·¦å³æŽ’åˆ—çš„ä¸¤ä¸ªçª—å£ä¸­åŒæ—¶æ‰“å¼€ file1 å’Œ file2 ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è€Œ vimdiff file1 file2 å‘½ä»¤ä¼šä»¥åŒæ ·çš„å½¢å¼æ‰“å¼€è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”ç”¨ä¸åŒçš„èƒŒæ™¯è‰²é«˜äº®æ˜¾ç¤ºå½¼æ­¤é—´æœ‰å·®åˆ«çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾ï¼š ä»Žä¸Šé¢çš„ä¸¤å¹…æˆªå›¾ä¸­å¯ä»¥å¾—å‡º vimdiff æ ‡è®°å·®åˆ«å†…å®¹æ—¶çš„å‡ ä¸ªè§„åˆ™ï¼š åªåœ¨æŸä¸€ä¸ªæ–‡ä»¶ä¸­å­˜åœ¨çš„è¡ŒèƒŒæ™¯è‰²è®¾ç½®ä¸ºè“è‰²ï¼Œè€Œå¦ä¸€æ–‡ä»¶ä¸­çš„å¯¹åº”ä½ç½®åˆ™è¢«æ ‡è®°ä¸ºç»¿è‰²ã€‚ï¼ˆæˆ–è€…è¯´ï¼Œç›¸å¯¹äºŽå¦ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“å‰æ–‡ä»¶ä¸­â€œå¤šä½™â€çš„è¡Œæ ‡è®°ä¸ºè“è‰²ï¼Œâ€œç¼ºå°‘â€çš„è¡Œåˆ™æ ‡è®°ä¸ºç»¿è‰²ï¼‰ ä¸¤ä¸ªæ–‡ä»¶ä¸­åŒæ—¶å­˜åœ¨ä½†æ˜¯å†…å®¹æœ‰å·®å¼‚çš„è¡Œï¼Œéƒ½æ ‡è®°ä¸ºç²‰è‰²ï¼Œè€Œå¼•èµ·å·®å¼‚çš„æ–‡å­—æ ‡è®°ä¸ºçº¢è‰² é™¤äº† vimdiff FILE_LEFT FILE_RIGHT æˆ–è€… vim -d FILE_LEFT FILE_RIGHT çš„å½¢å¼å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åœ¨ Vim ä¸­è¾“å…¥å‘½ä»¤è¿›å…¥ diff æ¨¡å¼ã€‚ æ¯”å¦‚å…ˆè¿›å…¥ Vim ç¼–è¾‘ FILE_LEFT æ–‡ä»¶ï¼ˆvim FILE_LEFTï¼‰ï¼Œå†è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›å…¥ diff æ¨¡å¼ï¼š:vertical diffsplit FILE_RIGHT å…‰æ ‡ç§»åŠ¨å¯ä»¥ä½¿ç”¨ä¸‹åˆ—ä¸¤ç§å¿«æ·é”®ï¼Œåœ¨æ–‡ä»¶çš„å„ä¸ªå·®å¼‚ç‚¹ä¹‹é—´å‰åŽç§»åŠ¨ï¼š ], cï¼šè·³è½¬åˆ°ä¸‹ä¸ªå·®å¼‚ç‚¹ [, cï¼šè·³è½¬åˆ°ä¸Šä¸ªå·®å¼‚ç‚¹ è‡³äºŽå…‰æ ‡åœ¨ä¸¤ä¸ªçª—å£ä¹‹å‰çš„åˆ‡æ¢ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æŒ‰é”®ï¼š Ctrl-w, lï¼šå…‰æ ‡åˆ‡æ¢åˆ°å³ä¾§çš„çª—å£ Ctrl-w, hï¼šå…‰æ ‡åˆ‡æ¢åˆ°å·¦ä¾§çš„çª—å£ Ctrl-w, wï¼šå…‰æ ‡åœ¨ä¸¤ä¸ªçª—å£é—´å½¼æ­¤åˆ‡æ¢ å†…å®¹åˆå¹¶å¯ä»¥ä½¿ç”¨ d, p ï¼ˆå³ diff putï¼‰å‘½ä»¤ï¼Œå°†å½“å‰å·®å¼‚ç‚¹ä¸­çš„å†…å®¹è¦†ç›–åˆ°å¦ä¸€æ–‡ä»¶ä¸­çš„å¯¹åº”ä½ç½®ã€‚å¦‚å½“å…‰æ ‡ä½äºŽå·¦ä¾§æ–‡ä»¶ï¼ˆfile1ï¼‰ä¸­çš„ç¬¬ä¸€è¡Œæ—¶ï¼Œä¾æ¬¡æŒ‰ä¸‹ dã€p é”®ï¼Œåˆ™ file1 ä¸­çš„ Line one è¢«æŽ¨é€åˆ°å³ä¾§ï¼Œå¹¶æ›¿æ¢æŽ‰ file2 ä¸­å¯¹åº”ä½ç½®ä¸Šçš„ Line 1 ã€‚æˆªå›¾å¦‚ä¸‹ï¼šå¯ä¸Žä¸Šä¸€å¹…æˆªå›¾å¯¹æ¯”æŸ¥çœ‹æ•ˆæžœã€‚ è€Œ d, o ï¼ˆå³ diff obtainï¼‰å‘½ä»¤å¯ä»¥å°†å¦ä¸€çª—å£ä¸­å·®å¼‚ç‚¹å¤„çš„å†…å®¹æ‹‰å–åˆ°å½“å‰ä½ç½®å¹¶è¿›è¡Œæ›¿æ¢æ“ä½œã€‚æˆªå›¾å¦‚ä¸‹ï¼š å³åœ¨ file1 çš„ç¬¬ä¸€è¡Œæ‰§è¡Œ d o å‘½ä»¤åŽï¼Œfile2 ä¸­çš„ç¬¬ä¸€è¡Œå†…å®¹ Line 1 è¢«æ‹‰å–åˆ° file1 ä¸­å¹¶æ›¿æ¢æŽ‰åŽŸæ¥ä½ç½®ä¸Šçš„ Line oneã€‚ åŒæ—¶æ“ä½œä¸¤ä¸ªæ–‡ä»¶vimdiff å®žé™…ä¸Šæ˜¯ Vim ç¼–è¾‘å™¨çš„ diff æ¨¡å¼ï¼Œå› æ­¤é€‚ç”¨äºŽ Vim ç¼–è¾‘å™¨çš„å‘½ä»¤å’Œå¿«æ·é”®ä¹ŸåŒæ ·å¯ä»¥åœ¨è¯¥æ¨¡å¼ä¸‹ä½¿ç”¨ã€‚å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤å¦‚ä¸‹ï¼š :qaï¼šé€€å‡ºæ‰€æœ‰æ–‡ä»¶ :waï¼šä¿å­˜æ‰€æœ‰æ–‡ä»¶ :wqaï¼šä¿å­˜å¹¶é€€å‡ºæ‰€æœ‰æ–‡ä»¶ qa!ï¼šå¼ºåˆ¶é€€å‡ºï¼ˆä¸ä¿å­˜ï¼‰æ‰€æœ‰æ–‡ä»¶ z oï¼šæŸ¥çœ‹è¢«æŠ˜å çš„å†…å®¹ z cï¼šé‡æ–°æŠ˜å  å…¶ä»–å¸¸ç”¨çš„å‘½ä»¤ä¸Žå¿«æ·é”®å¯å‚è€ƒ Vim é€ŸæŸ¥æ‰‹å†Œ]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Tricks</tag>
        <tag>Efficiency</tag>
        <tag>Vim</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Paramiko ä»£ç ç¤ºä¾‹]]></title>
    <url>%2F2019%2F07%2F20%2Fparamiko-examples%2F</url>
    <content type="text"><![CDATA[Paramiko æ˜¯ç”± Python è¯­è¨€ç¼–å†™çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œæä¾›äº†åŸºäºŽ SSHv2 åè®®ï¼ˆåŒ…æ‹¬å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼‰çš„å¤šç§åŠŸèƒ½å®žçŽ°ã€‚é€šå¸¸è¢«ç”¨æ¥è¿œç¨‹æŽ§åˆ¶ç±» UNIX ç³»ç»Ÿã€‚ Paramiko å¯ä»¥ç›´æŽ¥ä½¿ç”¨ pip å‘½ä»¤å®‰è£…ï¼š$ pip install paramiko æ­¤å¤„ä¸ä½œè¿‡å¤šä»‹ç»ï¼Œå‚è€ƒåŽæ–‡ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚ è¿œç¨‹æ‰§è¡Œ Linux å‘½ä»¤ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516import paramiko# åˆå§‹åŒ– SSH å®¢æˆ·ç«¯ï¼Œé€šè¿‡ç”¨æˆ·åå¯†ç è¿žæŽ¥è‡³è¿œç¨‹æœåŠ¡å™¨client = paramiko.SSHClient()client.set_missing_host_key_policy(paramiko.AutoAddPolicy)client.connect(hostname=&apos;remoteserver_ip&apos;, username=&apos;username&apos;, password=&apos;password&apos;)# é€šè¿‡ RSA ç§˜é’¥éªŒè¯çš„æ–¹å¼è¿žæŽ¥è‡³è¿œç¨‹ SSH æœåŠ¡# private_key = paramiko.RSAKey.from_private_key_file(&apos;~/.ssh/id_rsa&apos;)# client.connect(hostname=&quot;remoteserver_ip&quot;, username=&quot;username&quot;, pkey=private_key)# è¿œç¨‹æ‰§è¡Œ df -h å‘½ä»¤å¹¶æ‰“å°è¾“å‡ºstdin, stdout, stderr = client.exec_command(&apos;df -h&apos;)print(stdout.read().decode(&apos;utf-8&apos;))client.close() è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š SFTP æ–‡ä»¶ä¼ è¾“ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819import paramikotransport = paramiko.Transport((&apos;hostname_or_ip&apos;, port))# é€šè¿‡ç”¨æˆ·åå¯†ç å®ŒæˆéªŒè¯å»ºç«‹è¿žæŽ¥transport.connect(username=&apos;username&apos;, password=&apos;password&apos;)# é€šè¿‡ RSA ç§é’¥æ–‡ä»¶å®ŒæˆéªŒè¯å»ºç«‹è¿žæŽ¥# private_key = paramiko.RSAKey.from_private_key_file(&apos;/path/to/private_key_file&apos;)# transport.connect(username=&apos;username&apos;, pkey=private_key)sftp = paramiko.SFTPClient.from_transport(transport)localpath = &quot;localfile&quot;remotepath = &quot;remotefile_fullpath&quot;sftp.put(localpath, remotepath)print(&quot;Successfully uploaded&quot;)transport.close() ç»¼åˆç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼ˆæ–‡ä»¶å ssh_connection.pyï¼‰ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374import paramikoimport getpassimport osclass SSHConnection(): def __init__(self, user, host, port=22, password=&apos;&apos;): self.username = user self.host = host self.port = port self.password = password self.keyfile = self.get_keyfile() def get_keyfile(self, path=os.getcwd()): default_keyfile = os.path.join( os.environ[&apos;HOME&apos;], &apos;.ssh&apos;, &apos;id_rsa&apos;) if &apos;id_rsa&apos; in os.listdir(path): keyfile = os.path.join(path, &apos;id_rsa&apos;) elif os.path.isfile(default_keyfile): keyfile = default_keyfile else: keyfile = &apos;&apos; return keyfile def connect(self): transport = paramiko.Transport((self.host, self.port)) if self.password: transport.connect(username=self.username, password=self.password) elif self.keyfile: transport.connect( username=self.username, pkey=paramiko.RSAKey.from_private_key_file(self.keyfile)) else: password = getpass.getpass( &quot;Password for %s@%s: &quot; % (self.username, self.host)) transport.connect(username=self.username, password=password) self._transport = transport print(&quot;Connected to %s as %s&quot; % (self.host, self.username)) def close(self): self._transport.close() def run_cmd(self, command): ssh = paramiko.SSHClient() ssh._transport = self._transport stdin, stdout, stderr = ssh.exec_command(command) res = stdout.read().decode(&apos;utf-8&apos;) error = stderr.read().decode(&apos;utf-8&apos;) if error.strip(): return error else: return res def trans_file(self, localpath, remotepath, method=&apos;&apos;): sftp = paramiko.SFTPClient.from_transport(self._transport) if method == &apos;put&apos;: sftp.put(localpath, remotepath) print(&quot;File %s has uploaded to %s&quot; % (localpath, remotepath)) elif method == &apos;get&apos;: sftp.get(remotepath, localpath) print(&quot;File %s has saved as %s&quot; % (remotepath, localpath)) else: print(&apos;usage: trans_file(localpath, remotepath, method=&quot;get/put&quot;&apos;) def __del__(self): self.close() æµ‹è¯•ç»“æžœå¦‚ä¸‹ï¼š1234567891011121314(python3) D:\Program\python\devops&gt;pythonPython 3.7.2 (default, Jan 2 2019, 17:07:39) [MSC v.1915 64 bit (AMD64)] :: Anaconda, Inc. on win32Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; from ssh_connection import SSHConnection&gt;&gt;&gt; client = SSHConnection(&apos;starky&apos;,&apos;127.0.0.1&apos;)&gt;&gt;&gt; client.connect()Connected to 127.0.0.1 as starky&gt;&gt;&gt; client.run_cmd(&apos;uname -a&apos;)&apos;Linux server1 5.0.0-20-generic #21-Ubuntu SMP Mon Jun 24 09:32:09 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n&apos;&gt;&gt;&gt; client.trans_file(&apos;id_rsa.pub&apos;, &apos;/home/starky/id_rsa.pub&apos;, method=&apos;put&apos;)File id_rsa.pub has uploaded to /home/starky/id_rsa.pub&gt;&gt;&gt; client.run_cmd(&apos;ls -l /home/starky/id_rsa.pub&apos;)&apos;-rw-rw-r-- 1 starky starky 410 7æœˆ 20 15:01 /home/starky/id_rsa.pub\n&apos;&gt;&gt;&gt; exit() å‚è€ƒèµ„æ–™Github é¡¹ç›®ä¸»é¡µAPI æ‰‹å†Œ]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>DevOps</tag>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Development</tag>
        <tag>SSH</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IT è‡ªåŠ¨åŒ–å·¥å…· Ansible å…¥é—¨æŒ‡å—]]></title>
    <url>%2F2019%2F07%2F09%2Fansible-automate-tools-quickstart%2F</url>
    <content type="text"><![CDATA[Ansible æ˜¯ä¸€ä¸ªéžå¸¸ç®€å•çš„ IT è‡ªåŠ¨åŒ–å¼•æ“Žï¼Œå¯ä»¥å®Œæˆè¯¸å¦‚äº‘ç«¯èµ„æºè°ƒé…ã€é…ç½®ç®¡ç†ã€åº”ç”¨éƒ¨ç½²ã€æœåŠ¡åè°ƒç­‰ä¼—å¤š IT è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚å®ƒä¸éœ€è¦åœ¨å—æŽ§ç«¯å®‰è£…é…ç½®é¢å¤–çš„ agent è½¯ä»¶ï¼Œå› æ­¤éƒ¨ç½²æµç¨‹éžå¸¸ç®€å•ã€‚Ansible çš„è¿è¡Œæœºåˆ¶ä¹Ÿå¹¶ä¸å¤æ‚ï¼Œå®ƒé€šè¿‡ SSH åè®®å‘è¿œç¨‹èŠ‚ç‚¹æŽ¨é€ç‰¹å®šçš„â€œå°ç¨‹åºâ€ï¼ˆAnsible modulesï¼‰å¹¶è¿è¡Œï¼Œä¸€æ—¦è¿è¡Œå®Œæˆåˆ™å°†å…¶ç§»é™¤ã€‚åŒæ—¶ Ansible æä¾›äº†ä¸€ç§éžå¸¸ç®€å•æ˜“æ‡‚çš„è¯­è¨€ï¼ˆYAMLï¼‰ç”¨äºŽç¼–å†™è‡ªåŠ¨åŒ–ä»£ç ã€‚ ä¸€ã€ç®€ä»‹Ansible é€šå¸¸ä¼šè¢«æè¿°ä¸ºä¸€ä¸ªé…ç½®ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºŽ Chefã€Puppet å’Œ Salt ç­‰ã€‚é€šè¿‡é…ç½®ç®¡ç†å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æœåŠ¡å™¨ä¸»æœºå¤„äºŽæŸç§æœŸæœ›çš„çŠ¶æ€ï¼Œæ¯”å¦‚æŒ‡å®šçš„è½¯ä»¶åŒ…å·²å®‰è£…ï¼Œé…ç½®æ–‡ä»¶ä¸­åŒ…å«æ­£ç¡®çš„å€¼ï¼Œè¿è¡Œç€ç‰¹å®šçš„æœåŠ¡ç­‰ã€‚ä¸Žå…¶ä»–é…ç½®ç®¡ç†å·¥å…·ä¸€æ ·ï¼ŒAnsible ä¹ŸåŠ å…¥äº†è‡ªå·±çš„ DSLï¼ˆé¢†åŸŸä¸“ç”¨è¯­è¨€ï¼‰ç”¨æ¥æè¿°æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå³åŽé¢ä¼šä»‹ç»åˆ°çš„ç”¨äºŽç¼–å†™ Playbook çš„ YAML è¯­è¨€ã€‚ Ansible ä¹Ÿå¯ä»¥ç”¨äºŽéƒ¨ç½²ä»»åŠ¡ï¼Œæ¯”å¦‚é€šè¿‡æºä»£ç ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºæˆ–é™æ€èµ„æºå¹¶å‘å¸ƒåˆ°æœåŠ¡å™¨ï¼Œç„¶åŽå¼€å¯è¿œç¨‹ä¸»æœºä¸Šçš„å¯¹åº”æœåŠ¡ã€‚ç±»ä¼¼çš„å¼€æºéƒ¨ç½²å·¥å…·å¦‚ Fabric ç­‰ã€‚ è¿˜æœ‰ä¸€ç§éœ€æ±‚å«åšæµç¨‹ç¼–æŽ’ï¼Œé€šå¸¸ä¼šæ¶‰åŠåˆ°å¤šä¸ªè¿œç¨‹æœåŠ¡å™¨ï¼Œç”¨äºŽç¡®ä¿å„ç±»åž‹çš„ä»»åŠ¡ä»¥ç‰¹å®šé¡ºåºæ‰§è¡Œã€‚æ¯”å¦‚åœ¨å¼€å¯ Web æœåŠ¡å™¨ä¹‹å‰ç¡®ä¿æ•°æ®åº“æœåŠ¡å¤„äºŽå·²ç»è¿è¡Œçš„çŠ¶æ€ã€‚Ansible ä»Žè®¾è®¡ä¹‹åˆå³å…³æ³¨å¤šä¸ªæœåŠ¡å™¨çŠ¶æ€ä¸‹ä»»åŠ¡çš„æ‰§è¡Œï¼Œå®ƒæœ‰ä¸€ä¸ªéžå¸¸ç®€å•çš„æ¨¡å—ç”¨äºŽæŽ§åˆ¶åŠ¨ä½œçš„é¡ºåºã€‚ æ­¤å¤–ï¼ŒAnsible è¿˜æä¾›ä¼—å¤šçš„æ¨¡å—ç”¨æ¥ä¸Žå¸¸è§çš„äº‘æœåŠ¡è¿›è¡Œäº¤äº’ï¼ŒåŒ…æ‹¬ Amazon EC2ã€Azureã€Digital Oceanã€Linode ä»¥åŠä»»ä½•æ”¯æŒ OpenStack API çš„äº‘ç«¯æœåŠ¡ã€‚ ä¸€ä¸ªç®€å•çš„ Ansible è¿è¡Œå®žä¾‹å¦‚ä¸‹å›¾ï¼š äºŒã€Ansible å®‰è£…ç»å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆçš„è½¯ä»¶é•œåƒä¸­éƒ½é»˜è®¤åŒ…å«äº† Ansible çš„å®‰è£…åŒ…ï¼Œ å¯ä»¥ç›´æŽ¥é€šè¿‡å¯¹åº”çš„åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ã€‚å¦‚ Ubuntu ç³»ç»Ÿï¼š$ sudo apt-get install ansible Ansible æ˜¯åŸºäºŽ Python è¯­è¨€å¼€å‘çš„ï¼Œå› æ­¤ä¹Ÿå¯ä»¥é€šè¿‡ Python çš„åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ pip install ansible æˆ‘ç”¨ VirtualBox è½¯ä»¶æ­å»ºäº†ä¸¤å° Ubuntu 19.04 è™šæ‹Ÿæœºï¼Œé…ç½®äº†å†…éƒ¨ç½‘ç»œï¼ˆInternalï¼‰çš„è”ç½‘æ–¹å¼ã€‚server1 IP åœ°å€ä¸º 192.168.1.101ï¼Œç”¨äºŽå®‰è£… Ansible çŽ¯å¢ƒã€‚server2 IP åœ°å€ä¸º 192.168.1.102ï¼Œä½œä¸ºè¿œç¨‹ä¸»æœºè¿›è¡Œæµ‹è¯•ã€‚ä¸¤è€…å¯ä»¥ç›¸äº’ ping é€šã€‚ SSH çš„å¯†é’¥è®¤è¯ä¸ºäº†ä½¿å¾—æ¯æ¬¡è¿è¡Œ Ansible ä»»åŠ¡æ—¶ï¼Œä¸éœ€è¦é‡å¤è¾“å…¥è¿œç¨‹ä¸»æœºçš„è®¤è¯ä¿¡æ¯ï¼Œè¿™é‡Œå…ˆé…ç½®å¥½ SSH è¿žæŽ¥çš„æ— å¯†ç è®¤è¯ï¼ˆå³ RSA å¯†é’¥è®¤è¯ï¼‰ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š1234$ # ç”Ÿæˆ SSH å¯†é’¥æ–‡ä»¶$ ssh-keygen$ # å¤åˆ¶å…¬é’¥æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼ˆéœ€è¦è¾“å…¥å¯†ç ï¼‰$ ssh-copy-id remoteuser@remoteserver è¿è¡ŒæˆåŠŸåŽï¼Œä½¿ç”¨ $ ssh remoteuser@remoteserver å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼Œå¦‚å¯ä»¥è‡ªåŠ¨ç™»å½•ï¼Œåˆ™é…ç½®å®Œæˆã€‚ PSï¼šè¢«æŽ§åˆ¶çš„è¿œç¨‹ä¸»æœºä¸éœ€è¦å®‰è£…ä»»ä½•å®¢æˆ·ç«¯è½¯ä»¶ï¼Œä½†æ˜¯å¿…é¡»ç¡®ä¿å·²å®‰è£… Python ä¸” sshd æœåŠ¡å¤„äºŽè¿è¡ŒçŠ¶æ€ã€‚å¦‚ä¸¤è€…æœªæ­£ç¡®å®‰è£…ï¼Œå¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š12$ sudo apt-get install python$ sudo apt-get install openssh-server ä¸»æœºæ¸…å•ï¼ˆInventoryï¼‰Ansible é€šè¿‡ä¸€ä¸ªä¸»æœºæ¸…å•æ–‡ä»¶ï¼ˆhostsï¼‰å­˜æ”¾è¢«ç®¡ç†çš„æœåŠ¡å™¨çš„åˆ—è¡¨ã€‚åˆ›å»º playbooks ç›®å½•ä½œä¸ºå­˜æ”¾ ansible è„šæœ¬å’Œé…ç½®æ–‡ä»¶çš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œè¿›å…¥è¯¥ç›®å½•å¹¶ç¼–è¾‘å¦‚ä¸‹ hosts æ–‡ä»¶ï¼š1server2 ansible_ssh_host=192.168.1.102 ansible_ssh_user=skitar ansible_ssh_private_key_file=~/.ssh/id_rsa é€šè¿‡ hosts ä¸­å®šä¹‰çš„æœåŠ¡å™¨åˆ«åå’Œè¿žæŽ¥ä¿¡æ¯è®¿é—®è¿œç¨‹ä¸»æœºå¹¶æ‰§è¡Œ ping æ¨¡å—ï¼š$ ansible server2 -i hosts -m ping è¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š1234567server2 | SUCCESS =&gt; &#123; &quot;ansible_facts&quot;: &#123; &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot; &#125;, &quot;changed&quot;: false, &quot;ping&quot;: &quot;pong&quot;&#125; å¦‚çœ‹åˆ°ç±»ä¼¼ä¸Šé¢çš„è¾“å‡ºåˆ™ Ansible çŽ¯å¢ƒé…ç½®å®Œæˆã€‚ PSï¼šAnsible ä¸»æœºæ¸…å•çš„é…ç½®æ–‡ä»¶é»˜è®¤ä¸º /etc/ansible/hostsã€‚å¦‚éœ€ä½¿ç”¨å…¶ä»–ä½ç½®çš„ä¸»æœºæ¸…å•æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ -i é€‰é¡¹æ‰‹åŠ¨æŒ‡å®šï¼Œæˆ–è€…ä¿®æ”¹ ansible.cfg é…ç½®æ–‡ä»¶çš„ inventory é¡¹ã€‚ ansible.cfgansible.cfg æ–‡ä»¶ä¸­åŒ…å«äº† Ansible å·¥å…·çš„ä¸€äº›é»˜è®¤é…ç½®ï¼Œè¯¥æ–‡ä»¶é€šå¸¸ä½äºŽä»¥ä¸‹ä½ç½®ï¼š å½“å‰ç›®å½•ï¼ˆ./ansible.cfgï¼‰ Home ç›®å½•ï¼ˆ~/.ansible.cfgï¼‰ /etc/ansible/ansible.cfg åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º ansible.cfg æ–‡ä»¶å¹¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š12345[defaults]inventory = hostsremote_user = skitarprivate_key_file = ~/.ssh/id_rsahost_key_checking = False ç”±äºŽéƒ¨åˆ†é»˜è®¤é€‰é¡¹å·²é…ç½®ï¼Œæ­¤æ—¶çš„ hosts æ–‡ä»¶åˆ™å¯ä»¥çœç•¥ç”¨æˆ·åå’Œå¯†é’¥æ–‡ä»¶ç­‰ä¿¡æ¯ï¼Œç®€åŒ–ä¸ºå¦‚ä¸‹å½¢å¼ï¼š1server2 ansible_ssh_host=192.168.1.102 ä½¿ç”¨ ansible å‘½ä»¤æ—¶ä¹Ÿæ— éœ€å†é€šè¿‡ -i hosts é€‰é¡¹æ‰‹åŠ¨æŒ‡å®šä¸»æœºæ¸…å•æ–‡ä»¶ã€‚å³ä¹‹å‰çš„ ping æ¨¡å—å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š$ ansible server2 -m ping Ad-Hoc å‘½ä»¤å³é€šè¿‡å‘½ä»¤è¡Œçš„å½¢å¼ç›´æŽ¥è°ƒç”¨ Ansible æ¨¡å—ã€‚Ansible æœ‰ç€åŠŸèƒ½ä¸°å¯Œçš„å†…ç½®æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡ ansible-doc -l å‘½ä»¤æ˜¾ç¤ºæ‰€æœ‰çš„å†…ç½®æ¨¡å—ï¼Œé€šè¿‡ ansible-doc &lt;module&gt; å‘½ä»¤æŸ¥çœ‹æŒ‡å®šæ¨¡å—çš„ä»‹ç»ä»¥åŠä½¿ç”¨æ¡ˆä¾‹ã€‚ Ansible å†…ç½®çš„ command æ¨¡å—å¯ä»¥ç”¨æ¥åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œ Linux å‘½ä»¤ã€‚å¦‚æ‰§è¡Œ uptime å‘½ä»¤ï¼š123$ ansible server2 -m command -a uptimeserver2 | CHANGED | rc=0 &gt;&gt; 17:45:12 up 5:13, 1 user, load average: 0.12, 0.08, 0.02 å…¶ä¸­ -m ç”¨äºŽæŒ‡å®šè°ƒç”¨çš„æ¨¡å—ï¼Œ-a ç”¨äºŽæŒ‡å®šä¼ é€’ç»™è¯¥æ¨¡å—çš„é€‰é¡¹ï¼Œæ­¤å¤„å³æŸä¸ªå…·ä½“çš„å‘½ä»¤ã€‚ç”±äºŽ command æ¨¡å—å¾ˆå¸¸ç”¨ï¼Œå®ƒå…¶å®žæ˜¯ä¸æŒ‡å®šä»»ä½•æ¨¡å—æƒ…å†µä¸‹çš„é»˜è®¤æ¨¡å—ã€‚æ‰€ä»¥ä¸Šé¢çš„å‘½ä»¤ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å½¢å¼ï¼š$ ansible server2 -a uptime å½“è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œçš„å‘½ä»¤ä¸­åŒ…å«ç©ºæ ¼æ—¶ï¼Œéœ€è¦ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112$ ansible server2 -a &quot;tail /var/log/syslog&quot;server2 | CHANGED | rc=0 &gt;&gt;Jul 8 18:18:18 server2 systemd[6250]: Reached target Paths.Jul 8 18:18:18 server2 systemd[6250]: Listening on GnuPG cryptographic agent and passphrase cache (access for web browsers).Jul 8 18:18:18 server2 systemd[6250]: Listening on D-Bus User Message Bus Socket.Jul 8 18:18:18 server2 systemd[6250]: Reached target Sockets.Jul 8 18:18:18 server2 systemd[6250]: Reached target Basic System.Jul 8 18:18:18 server2 systemd[1]: Started User Manager for UID 1000.Jul 8 18:18:18 server2 systemd[1]: Started Session 47 of user skitar.Jul 8 18:18:18 server2 systemd[6250]: Reached target Default.Jul 8 18:18:18 server2 systemd[6250]: Startup finished in 75ms.Jul 8 18:18:19 server2 python3[6304]: ansible-command Invoked with _raw_params=tail /var/log/syslog warn=True _uses_shell=False stdin_add_newline=True strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None stdin=None å¯¹äºŽæŸäº›éœ€è¦ root æƒé™æ‰èƒ½æ‰§è¡Œçš„æ“ä½œï¼Œåˆ™éœ€è¦åŠ ä¸Š --become --ask-become-pass æˆ–è€… -b -K é€‰é¡¹é€šè¿‡ sudo æ‰§è¡Œã€‚å¦‚ä½¿ç”¨ service æ¨¡å—é‡å¯è¿œç¨‹ä¸»æœºä¸Šçš„ nginx æœåŠ¡ï¼š12345678910111213141516$ ansible server2 -b -K -m service -a &quot;name=nginx state=restarted&quot;BECOME password:server2 | CHANGED =&gt; &#123; &quot;ansible_facts&quot;: &#123; &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot; &#125;, &quot;changed&quot;: true, &quot;name&quot;: &quot;nginx&quot;, &quot;state&quot;: &quot;started&quot;, &quot;status&quot;: &#123; &quot;ActiveEnterTimestamp&quot;: &quot;Mon 2019-07-08 18:16:58 CST&quot;, &quot;ActiveEnterTimestampMonotonic&quot;: &quot;20685653757&quot;, &quot;ActiveExitTimestamp&quot;: &quot;Mon 2019-07-08 18:16:57 CST&quot;, &quot;ActiveExitTimestampMonotonic&quot;: &quot;20685035019&quot;, &quot;ActiveState&quot;: &quot;active&quot;,... å…¶ä»–å¸¸ç”¨çš„å†…ç½®æ¨¡å—è¿˜æœ‰ aptã€copyã€user ç­‰ã€‚ å¦‚é€šè¿‡ apt æ¨¡å—ç®¡ç†è¿œç¨‹ä¸»æœºä¸Šçš„è½¯ä»¶åŒ…ï¼š123456789101112$ ansible server2 --b -K -m apt -a &quot;name=nginx state=latest&quot;BECOME password: [WARNING]: Could not find aptitude. Using apt-get insteadserver2 | SUCCESS =&gt; &#123; &quot;ansible_facts&quot;: &#123; &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot; &#125;, &quot;cache_update_time&quot;: 1562598780, &quot;cache_updated&quot;: false, &quot;changed&quot;: false&#125; é€šè¿‡ copy æ¨¡å—å¤åˆ¶æœ¬åœ°æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœºï¼š1234567891011121314151617$ ansible server2 -m copy -a &quot;src=ansible.cfg dest=/home/skitar/ansible.cfg owner=skitar mode=644&quot;server2 | CHANGED =&gt; &#123; &quot;ansible_facts&quot;: &#123; &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot; &#125;, &quot;changed&quot;: true, &quot;checksum&quot;: &quot;2f4f9975ef1875adcc2a299d3962f70630f49965&quot;, &quot;dest&quot;: &quot;/home/skitar/ansible.cfg&quot;, &quot;gid&quot;: 1001, &quot;group&quot;: &quot;skitar&quot;, &quot;mode&quot;: &quot;0644&quot;, &quot;owner&quot;: &quot;skitar&quot;, &quot;path&quot;: &quot;/home/skitar/ansible.cfg&quot;, &quot;size&quot;: 109, &quot;state&quot;: &quot;file&quot;, &quot;uid&quot;: 1000&#125; é€šè¿‡ user æ¨¡å—ç®¡ç†è¿œç¨‹ä¸»æœºä¸Šçš„ç”¨æˆ·ï¼ˆéœ€è¦å…ˆé€šè¿‡ openssl å‘½ä»¤ç”Ÿæˆå¯†ç ï¼Œå› ä¸º user æ¨¡å—çš„ password å‚æ•°åªæŽ¥å—åŠ å¯†åŽçš„å€¼ï¼‰ï¼š1234567891011121314151617181920$ echo ansible | openssl passwd -1 -stdin$1$ZyNqkbXH$i.4R0EDQZV.zu8akyJAu10$ ansible server2 -b -K -m user -a &apos;name=starky password=&quot;$1$ZyNqkbXH$i.4R0EDQZV.zu8akyJAu10&quot; shell=/bin/bash&apos;BECOME password:server2 | CHANGED =&gt; &#123; &quot;ansible_facts&quot;: &#123; &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot; &#125;, &quot;append&quot;: false, &quot;changed&quot;: true, &quot;comment&quot;: &quot;&quot;, &quot;group&quot;: 1002, &quot;home&quot;: &quot;/home/starky&quot;, &quot;move_home&quot;: false, &quot;name&quot;: &quot;starky&quot;, &quot;password&quot;: &quot;NOT_LOGGING_PASSWORD&quot;, &quot;shell&quot;: &quot;/bin/bash&quot;, &quot;state&quot;: &quot;present&quot;, &quot;uid&quot;: 1001&#125; ä¸‰ã€PlaybooksPlaybooks å³ Ansible ç”¨äºŽæ‰§è¡Œè‡ªåŠ¨åŒ–é…ç½®çš„è„šæœ¬æ–‡ä»¶ã€‚å®ƒä½¿ç”¨éžå¸¸ç®€å•çš„ YAML è¯­è¨€æè¿°æœŸæœ›è¾¾åˆ°çš„çŠ¶æ€ï¼ŒYAML ä¹‹äºŽ JSON ç±»ä¼¼äºŽ Markdown ä¹‹äºŽ HTML ã€‚ ä¸€ä¸ªç®€å•çš„ç”¨äºŽé…ç½® nginx ç«™ç‚¹çš„ playbook ç¤ºä¾‹ï¼ˆweb-notls.ymlï¼‰å¦‚ä¸‹ï¼š123456789101112131415161718192021- name: Configure webserver with nginx hosts: webservers become: True tasks: - name: install nginx apt: name=nginx update_cache=yes - name: copy nginx config file copy: src=files/nginx.conf dest=/etc/nginx/sites-available/default - name: enable configuration file: &gt; dest=/etc/nginx/sites-enabled/default src=/etc/nginx/sites-available/default state=link - name: copy index.html template: src=templates/index.html.j2 dest=/var/www/html/index.html mode=0644 - name: restart nginx service: name=nginx state=restarted ç¼–è¾‘ nginx é…ç½®æ–‡ä»¶ï¼Œå³ playbook ä¸­ copy æ¨¡å—çš„ src é€‰é¡¹æŒ‡å®šçš„æ–‡ä»¶ï¼ˆfiles/nginx.confï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789101112server &#123; listen 80 default_server; root /var/www/html; index index.html; server_name 192.168.1.102; location / &#123; try_files $uri $uri/ =404; &#125;&#125; ç¼–è¾‘ nginx ç«™ç‚¹çš„ä¸»é¡µæ–‡ä»¶ï¼Œå³ playbook ä¸­ template æ¨¡å—çš„src é€‰é¡¹æŒ‡å®šçš„æ–‡ä»¶ï¼ˆtemplates/index.html.j2ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678910&lt;html&gt; &lt;head&gt; &lt;title&gt;Welcome to ansible&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;nginx, configured by Ansible&lt;/h1&gt; &lt;p&gt;If you see this, Ansible successfuly installed nginx.&lt;/p&gt; &lt;p&gt;Current time is &#123;&#123; now() &#125;&#125;&lt;/p&gt; &lt;/body&gt;&lt;/html&gt; ç¼–è¾‘ Inventory ï¼ˆä¸»æœºæ¸…å•ï¼‰å³hosts æ–‡ä»¶ï¼Œåˆ›å»º webservers ä¸»æœºç»„ï¼š12[webservers]server2 ansible_ssh_host=192.168.1.102 ä¸»æœºç»„ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹ä¸»æœºï¼Œä¾¿äºŽåŒæ—¶ç®¡ç†å¤šä¸ªè¿œç¨‹èŠ‚ç‚¹ã€‚ ä¸Šè¿°é…ç½®å®ŒæˆåŽï¼Œé€šè¿‡ ansible-playbook web-nolts.yml -K å‘½ä»¤è¿è¡Œ playbookï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627$ ansible-playbook web-notls.yml -KBECOME password:PLAY [Configure webserver with nginx] **********************************************************TASK [Gathering Facts] *************************************************************************ok: [server2]TASK [install nginx] *************************************************************************** [WARNING]: Could not find aptitude. Using apt-get insteadok: [server2]TASK [copy nginx config file] ******************************************************************changed: [server2]TASK [enable configuration] ********************************************************************ok: [server2]TASK [copy index.html] *************************************************************************changed: [server2]TASK [restart nginx] ***************************************************************************changed: [server2]PLAY RECAP *************************************************************************************server2 : ok=6 changed=3 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 æ³¨æ„ ansibe-playbook å‘½ä»¤çš„ -K é€‰é¡¹ï¼ˆå³ --ask-become-passï¼‰ï¼Œç”±äºŽ playbook ä¸­çš„éƒ¨åˆ†ä»»åŠ¡éœ€è¦ root æƒé™æ‰§è¡Œï¼ŒåŠ ä¸Š -K é€‰é¡¹åŽï¼Œæ‰§è¡Œ playbook æ—¶ä¼šå‡ºçŽ° BECOME password: æç¤ºç”¨äºŽè¾“å…¥ sudo å¯†ç ã€‚å¦åˆ™ä¼šæŠ¥é”™ã€‚ playbook æ‰§è¡ŒæˆåŠŸåŽï¼Œä½¿ç”¨ curl 192.168.1.102 å‘½ä»¤è®¿é—® server2 ä¸Šåˆšåˆšé…ç½®çš„ nginx ç«™ç‚¹ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š1234567891011$ curl 192.168.1.102&lt;html&gt; &lt;head&gt; &lt;title&gt;Welcome to ansible&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;nginx, configured by Ansible&lt;/h1&gt; &lt;p&gt;If you see this, Ansible successfuly installed nginx.&lt;/p&gt; &lt;p&gt;Current time is 2019-07-09 00:28:46.484053&lt;/p&gt; &lt;/body&gt;&lt;/html&gt; å‚è€ƒèµ„æ–™Ansible: Up and Running, 2nd Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Ansible</tag>
        <tag>DevOps</tag>
        <tag>Automate</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Arduinoï¼ˆé…åˆèˆµæœºã€è¶…å£°æ³¢ä¼ æ„Ÿå™¨ï¼‰å’Œ Processing åˆ¶ä½œâ€œå£°å‘â€æŽ¢æµ‹ç³»ç»Ÿ]]></title>
    <url>%2F2019%2F07%2F09%2Farduino-radar-with-servo-and-ultrasound-sensor%2F</url>
    <content type="text"><![CDATA[å‚è€ƒè‡ª Github é¡¹ç›® ArduinoRadar ã€‚åŽŸé¡¹ç›®ä¸­ Processing éƒ¨åˆ†ä»£ç æµ‹è¯•æœ‰ç–æ¼ï¼Œå·²ä¿®æ”¹å¹¶å®ŒæˆéªŒè¯ã€‚ä¸»è¦æ˜¯é€šè¿‡è¶…å£°æ³¢ä¼ æ„Ÿå™¨æµ‹é‡ç›®æ ‡è·ç¦»ï¼Œå¹¶å€ŸåŠ©èˆµæœºå®Œæˆæ‰«æå·¡è§†åŠ¨ä½œï¼Œæœ€åŽé€šè¿‡ Processing æ”¶é›†æµ‹é‡æ•°æ®ï¼Œå¹¶å®Œæˆç±»ä¼¼å£°çº³æ˜¾ç¤ºå™¨çš„å›¾å½¢ç»˜åˆ¶ã€‚ é¡¹ç›®å®žç‰©å›¾å¦‚ä¸‹ï¼š Processing ç»˜åˆ¶çš„ç±»ä¼¼ç›‘è§†å™¨ç•Œé¢çš„åŠ¨æ€å›¾å½¢å¦‚ä¸‹ï¼š ä¸€ã€å‡†å¤‡ææ–™è½¯ä»¶ï¼š Arduino IDEï¼šç¼–å†™ C è¯­è¨€æºä»£ç å¹¶ç¼–è¯‘ä¸Šä¼ è‡³ Ardunio å¼€å‘æ¿ã€‚ Processingï¼šé€šè¿‡ä¸²å£ä¸Ž Arduino å¼€å‘æ¿é€šä¿¡ï¼ŒèŽ·å–å®žæ—¶æ•°æ®å¹¶ç»˜åˆ¶ç±»ä¼¼ç›‘è§†å™¨ç”»é¢çš„åŠ¨æ€å›¾å½¢ã€‚ ç¡¬ä»¶ï¼š Arduino Uno æˆ–ä¸Žä¹‹å…¼å®¹çš„å¼€å‘ç‰ˆï¼šæŽ§åˆ¶ä¸­å¿ƒã€‚ è¶…å£°æ³¢ä¼ æ„Ÿå™¨ï¼šæµ‹é‡ç›®æ ‡è·ç¦»ã€‚ èˆµæœºï¼šæ‰¿è½½è¶…å£°æ³¢ä¼ æ„Ÿå™¨ï¼Œå®Œæˆæ‰«æåŠ¨ä½œã€‚ äºŒã€è¿žçº¿ç¤ºæ„å›¾çº¿è·¯è¿žæŽ¥ç¤ºæ„å›¾å¦‚ä¸‹ï¼š ä¸‰ã€æºä»£ç arduino C ç¨‹åºæºä»£ç  radar.inoï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354#include &lt;Servo.h&gt;. const int trigPin = 7;const int echoPin = 8;long duration;int distance;Servo myServo; void setup() &#123; pinMode(trigPin, OUTPUT); pinMode(echoPin, INPUT); Serial.begin(9600); myServo.attach(9); &#125;void loop() &#123; for(int i=15;i&lt;=165;i++)&#123; myServo.write(i); delay(30); distance = calculateDistance(); Serial.print(i); Serial.print(&quot;,&quot;); Serial.print(distance); Serial.print(&quot;.&quot;); &#125; for(int i=165;i&gt;15;i--)&#123; myServo.write(i); delay(30); distance = calculateDistance(); Serial.print(i); Serial.print(&quot;,&quot;); Serial.print(distance); Serial.print(&quot;.&quot;); &#125;&#125;int calculateDistance() &#123; digitalWrite(trigPin, LOW); delayMicroseconds(2); digitalWrite(trigPin, HIGH); delayMicroseconds(10); digitalWrite(trigPin, LOW); duration = pulseIn(echoPin, HIGH); distance= duration*0.034/2; return distance;&#125; Processing æºä»£ç  radar.pdeï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144import processing.serial.*; // imports library for serial communicationimport java.awt.event.KeyEvent; // imports library for reading the data from the serial portimport java.io.IOException;String Port = &quot;COM3&quot;; //Arduino portSerial myPort; String angle=&quot;&quot;;String distance=&quot;&quot;;String data=&quot;&quot;;String noObject;float pixsDistance;int iAngle, iDistance;int index1=0;int index2=0;PFont orcFont;void setup() &#123; size (1250, 650); //resolution smooth(); myPort = new Serial(this, Port, 9600); myPort.bufferUntil(&apos;.&apos;);&#125;void draw() &#123; fill(98,245,31); noStroke(); fill(0,4); rect(0, 0, width, height-height*0.065); fill(98,245,31); drawRadar(); drawLine(); drawObject(); drawText();&#125;void serialEvent (Serial myPort) &#123; data = myPort.readStringUntil(&apos;.&apos;); data = data.substring(0,data.length()-1); index1 = data.indexOf(&quot;,&quot;); angle= data.substring(0, index1); distance= data.substring(index1+1, data.length()); iAngle = int(angle); iDistance = int(distance);&#125;void drawRadar() &#123; pushMatrix(); translate(width/2,height-height*0.074); noFill(); strokeWeight(2); stroke(98,245,31); arc(0,0,(width-width*0.0625),(width-width*0.0625),PI,TWO_PI); arc(0,0,(width-width*0.27),(width-width*0.27),PI,TWO_PI); arc(0,0,(width-width*0.479),(width-width*0.479),PI,TWO_PI); arc(0,0,(width-width*0.687),(width-width*0.687),PI,TWO_PI); line(-width/2,0,width/2,0); line(0,0,(-width/2)*cos(radians(30)),(-width/2)*sin(radians(30))); line(0,0,(-width/2)*cos(radians(60)),(-width/2)*sin(radians(60))); line(0,0,(-width/2)*cos(radians(90)),(-width/2)*sin(radians(90))); line(0,0,(-width/2)*cos(radians(120)),(-width/2)*sin(radians(120))); line(0,0,(-width/2)*cos(radians(150)),(-width/2)*sin(radians(150))); line((-width/2)*cos(radians(30)),0,width/2,0); popMatrix();&#125;void drawObject() &#123; pushMatrix(); translate(width/2,height-height*0.074); strokeWeight(9); stroke(255,10,10); pixsDistance = iDistance*((height-height*0.1666)*0.025); if(iDistance&lt;40)&#123; //range limit line(pixsDistance*cos(radians(iAngle)),-pixsDistance*sin(radians(iAngle)),(width-width*0.505)*cos(radians(iAngle)),-(width-width*0.505)*sin(radians(iAngle))); &#125; popMatrix();&#125;void drawLine() &#123; pushMatrix(); strokeWeight(9); stroke(30,250,60); translate(width/2,height-height*0.074); line(0,0,(height-height*0.12)*cos(radians(iAngle)),-(height-height*0.12)*sin(radians(iAngle))); popMatrix();&#125;void drawText() &#123; pushMatrix(); fill(0,0,0); noStroke(); rect(0, height-height*0.0648, width, height); fill(98,245,31); textSize(15); text(&quot;10cm&quot;,width-width*0.3854,height-height*0.0833); text(&quot;20cm&quot;,width-width*0.281,height-height*0.0833); text(&quot;30cm&quot;,width-width*0.177,height-height*0.0833); text(&quot;40cm&quot;,width-width*0.0729,height-height*0.0833); textSize(30); text(&quot;Angle: &quot; + iAngle +&quot; Â°&quot;, width-width*0.48, height-height*0.0277); text(&quot;Distance: &quot;, width-width*0.26, height-height*0.0277); if(iDistance&lt;40) &#123; text(&quot; &quot; + iDistance +&quot; cm&quot;, width-width*0.225, height-height*0.0277); &#125; textSize(25); fill(98,245,60); translate((width-width*0.4994)+width/2*cos(radians(30)),(height-height*0.0907)-width/2*sin(radians(30))); rotate(-radians(-60)); text(&quot;30Â°&quot;,0,0); resetMatrix(); translate((width-width*0.503)+width/2*cos(radians(60)),(height-height*0.0888)-width/2*sin(radians(60))); rotate(-radians(-30)); text(&quot;60Â°&quot;,0,0); resetMatrix(); translate((width-width*0.507)+width/2*cos(radians(90)),(height-height*0.0833)-width/2*sin(radians(90))); rotate(radians(0)); text(&quot;90Â°&quot;,0,0); resetMatrix(); translate(width-width*0.513+width/2*cos(radians(120)),(height-height*0.07129)-width/2*sin(radians(120))); rotate(radians(-30)); text(&quot;120Â°&quot;,0,0); resetMatrix(); translate((width-width*0.5104)+width/2*cos(radians(150)),(height-height*0.0574)-width/2*sin(radians(150))); rotate(radians(-60)); text(&quot;150Â°&quot;,0,0); popMatrix();&#125; æ³¨æ„ radar.pde æ–‡ä»¶å¼€å¤´çš„ String Port = &quot;COM3&quot;; è¡Œä»£ç ï¼Œå°† Port å˜é‡çš„å€¼ COM3 æ”¹ä¸º Ardunio å¼€å‘æ¿å®žé™…è¿žæŽ¥çš„ä¸²å£å·ã€‚ å››ã€è¿è¡Œæ•ˆæžœæ¼”ç¤ºè§†é¢‘]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
        <tag>DIY</tag>
        <tag>Electronics</tag>
        <tag>Hardware</tag>
        <tag>Ardunio</tag>
        <tag>Maker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu 19.04 é…ç½® Zabbix ç›‘æŽ§ç³»ç»Ÿ]]></title>
    <url>%2F2019%2F07%2F06%2Fzabbix-moniter-system-for-ubuntu%2F</url>
    <content type="text"><![CDATA[Zabbix æ˜¯ä¸€ä¸ªç”¨äºŽç›‘æŽ§ IT è®¾æ–½çš„ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå®žæ—¶ç›‘æŽ§æ•°åƒå°æœåŠ¡å™¨ï¼Œè™šæ‹Ÿæœºå’Œç½‘ç»œè®¾å¤‡ï¼Œé‡‡é›†ç™¾ä¸‡çº§ç›‘æŽ§æŒ‡æ ‡ã€‚Zabbix å®Œå…¨å¼€æºå…è´¹ã€‚ ä¸€ã€ç‰¹æ€§ä¸Žæž¶æž„ç‰¹æ€§Zabbix ç›‘æŽ§ç³»ç»Ÿçš„ä¸»è¦ç‰¹æ€§å¦‚ä¸‹ï¼š ä¸€ä¸ªä¸­å¿ƒåŒ–çš„ç®€å•æ˜“ç”¨çš„ Web ç®¡ç†ç•Œé¢ï¼Œå†…ç½®ä¸°å¯Œçš„å›¾å½¢åŒ–å’Œå¯è§†åŒ–ç»„ä»¶ Zabbix Server å¯ä»¥è¿è¡Œåœ¨ç»å¤§å¤šæ•° UNIX-like æ“ä½œç³»ç»Ÿä¸Šï¼Œæä¾›åŽŸç”Ÿçš„å®¢æˆ·ç«¯ï¼ˆagentï¼‰ç¨‹åºï¼ˆæ”¯æŒç»å¤§å¤šæ•° UNIX-like ç³»ç»Ÿå’Œ Windows ç³»ç»Ÿï¼‰ å¯ä»¥ç›´æŽ¥ç›‘æŽ§ SNMP (SNMPv1, SNMPv2, SNMPv3) å’Œ IPMI è®¾å¤‡ é€šè¿‡ JMX å¯ä»¥ç›´æŽ¥ç›‘æŽ§ Java åº”ç”¨ï¼Œé€šè¿‡ VMware API å¯ä»¥ç›´æŽ¥ç›‘æŽ§ vCenter æˆ– vSphere å®žä¾‹ çµæ´»çš„é…ç½®ï¼ŒåŒ…æ‹¬ä¸°å¯Œçš„æ¨¡æ¿ç³»ç»Ÿã€‚æ–¹ä¾¿ä¸Žå…¶ä»–ç³»ç»Ÿé›†æˆçš„é€šçŸ¥ç³»ç»Ÿ ç³»ç»Ÿæž¶æž„ä¸€ä¸ªç®€å•çš„ Zabbix ç›‘æŽ§ç³»ç»Ÿçš„ç¤ºä¾‹æž¶æž„å¦‚ä¸‹å›¾ï¼š Zabbix ç”±ä»¥ä¸‹å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½ç»„ä»¶ç»„æˆï¼š Serverï¼šZabbix è½¯ä»¶çš„æ ¸å¿ƒç»„ä»¶ï¼Œagent å‘å…¶æŠ¥å‘Šå¯ç”¨æ€§ã€ç³»ç»Ÿå®Œæ•´æ€§å’Œå…¶ä»–ç»Ÿè®¡ä¿¡æ¯ æ•°æ®åº“ï¼šç”¨äºŽå­˜å‚¨æ‰€æœ‰é…ç½®ä¿¡æ¯ä»¥åŠ Zabbix é‡‡é›†åˆ°çš„æ•°æ® Web ç•Œé¢ï¼šå±žäºŽ Zabbix Server çš„ä¸€éƒ¨åˆ†ï¼Œä¾¿äºŽä»Žä»»ä½•åœ°æ–¹ã€ä»»ä½•è®¾å¤‡è®¿é—®å’Œé…ç½® Zabbix Proxyï¼šå¯ä»¥æ›¿ä»£ Zabbix Server è¿›è¡Œæ•°æ®çš„é‡‡é›†æ“ä½œï¼Œåœ¨ Zabbix çš„éƒ¨ç½²ä¸­æ˜¯å¯é€‰éƒ¨åˆ†ï¼Œä½†æ˜¯å¯ä»¥å¾ˆå¥½åœ°åˆ†æ‹…å•ä¸ª Server çš„è´Ÿè½½ agentï¼šZabbix agents éƒ¨ç½²åœ¨è¢«ç›‘æŽ§ç›®æ ‡ä¸Šï¼Œç”¨äºŽä¸»åŠ¨ç›‘æŽ§æœ¬åœ°èµ„æºå’Œåº”ç”¨ç¨‹åºï¼Œå¹¶å°†æ•°æ®å‘é€ç»™ Zabbix Server äºŒã€å®‰è£…èŽ·å– Zabbix ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š ä»Žå‘è¡ŒåŒ…å®‰è£… ä¸‹è½½æœ€æ–°ç‰ˆæºç åŒ…å¹¶ç¼–è¯‘ é€šè¿‡å®¹å™¨å®‰è£…éƒ¨ç½² è¿™é‡Œé€‰æ‹©ç¬¬ä¸€ç§å®‰è£…æ–¹å¼ã€‚Zabbix å®˜æ–¹çš„è½¯ä»¶ä»“åº“æœ‰æä¾› RPM å’Œ DEB æ ¼å¼çš„äºŒè¿›åˆ¶åŒ…ï¼Œæœ¬æ–‡å¹¶æ²¡æœ‰ä½¿ç”¨ã€‚ä½¿ç”¨çš„æ˜¯ Ubuntu 19.04 é»˜è®¤è½¯ä»¶ä»“åº“ä¸­æä¾›çš„å®‰è£…åŒ…ï¼Œå…·ä½“æ“ä½œå¤§åŒå°å¼‚ï¼Œè¯¦æƒ…å¯å‚è€ƒ Zabbix 4.0 äº§å“æ‰‹å†Œ ä½¿ç”¨ apt-get å‘½ä»¤å®‰è£… Zabbix ç³»åˆ—è½¯ä»¶ï¼š12$ sudo apt-get update$ sudo apt-get install zabbix-server-mysql zabbix-frontend-php zabbix-agent å…¶ä¸­ zabbix-server-mysql æ˜¯ä»¥ MySQL æ•°æ®åº“ä¸ºåŽç«¯çš„ Zabbix Server è½¯ä»¶ã€‚zabbix-frontend-php åˆ™æ˜¯ç”± PHP è¯­è¨€ç¼–å†™çš„ Web æŽ§åˆ¶å°ç•Œé¢ã€‚ å¯¼å…¥åˆå§‹æ•°æ®é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº† MySQL æ•°æ®åº“ï¼Œä½¿ç”¨ root ç”¨æˆ·ç™»å½•è¿› MySQL çš„å‘½ä»¤è¡Œç•Œé¢ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ•°æ®åº“å¹¶æŽˆæƒï¼š12345mysql&gt; CREATE DATABASE zabbix CHARACTER SET utf8 COLLATE utf8_bin;Query OK, 1 row affected (0.00 sec)mysql&gt; GRANT ALL ON zabbix.* TO zabbix@localhost IDENTIFIED BY &apos;password&apos;;Query OK, 0 rows affected, 1 warning (0.11 sec) ä»¥ä¸Šå‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªåä¸º zabbix çš„æ•°æ®åº“ï¼Œå¹¶æŽˆäºˆç”¨æˆ· zabbix ï¼ˆå¯†ç ä¸º passwordï¼‰å¯¹å®ƒçš„è®¿é—®æƒé™ã€‚zabbix æ•°æ®åº“ç”¨äºŽå­˜å‚¨ Zabbix Server çš„é…ç½®ä¿¡æ¯å’Œé‡‡é›†åˆ°çš„æ•°æ®ï¼Œåœ¨æ­£å¼å¯ç”¨å‰è¿˜éœ€è¦åˆ›å»ºæ•°æ®è¡¨å¹¶å¯¼å…¥åˆå§‹æ•°æ®ã€‚ Zabbix è½¯ä»¶åŒ…ä¸­å·²ç»åŒ…å«äº†ç”¨äºŽåˆ›å»ºè¿™äº›æ•°æ®è¡¨çš„ SQL è¯­å¥ï¼Œä¸€èˆ¬ä¿å­˜åœ¨ /usr/share/doc/zabbix-server-mysql/ æˆ–è€… /usr/share/zabbix-server-mysql/ ç›®å½•ä¸‹çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“å¤‡ä»½æ–‡ä»¶ä¸­ï¼Œç›´æŽ¥å¯¼å…¥å³å¯ã€‚ æˆ‘è¿™é‡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå¯¼å…¥ï¼š$ zcat /usr/share/zabbix-server-mysql/{schema,images,data}.sql.gz | mysql -u zabbix -p zabbixæŒ‰ç…§æç¤ºè¾“å…¥å¯†ç åŽå³å¯å®Œæˆå¯¼å…¥ã€‚ é…ç½®æ•°æ®åº“è¿žæŽ¥ä¿¡æ¯ä¿®æ”¹ Zabbix Server çš„é…ç½®æ–‡ä»¶ /etc/zabbix/zabbix_server.confï¼Œå°†å…¶ä¸­å¯¹åº”çš„é¡¹ç›®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š1234DBHost=localhostDBName=zabbixDBUser=zabbixDBPassword=password é‡å¯ zabbix-server æœåŠ¡ï¼š$ sudo systemctl restart zabbix-server Web å‰ç«¯é…ç½®é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº† Apache2 Web æœåŠ¡å™¨å’Œ PHP è¯­è¨€æ”¯æŒã€‚å¹¶ä¸”è¿˜éœ€è¦å®‰è£…ä»¥ä¸‹å‡ ä¸ª PHP æ¨¡å—ï¼š gd mysqli bcmath mbstring gettext å‰é¢å®‰è£…å®Œ zabbix-frontend-php è½¯ä»¶åŽï¼Œä¼šè‡ªåŠ¨åœ¨ /etc/apache2/conf-available/ ç›®å½•ä¸‹åˆ›å»º zabbix-frontend-php.conf æ–‡ä»¶ï¼Œä½œä¸º Zabbix Server ç½‘é¡µåŽå°çš„é…ç½®æ–‡ä»¶ã€‚ è¯¥æ–‡ä»¶çš„é»˜è®¤é…ç½®å¯ç›´æŽ¥ä½¿ç”¨ï¼Œåªéœ€è¦å¯ç”¨è¯¥é…ç½®å³å¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo a2enconf zabbix-frontend-phpæˆ–è€… $sudo ln -s /etc/apache2/conf-available/zabbix-frontend-php.conf /etc/apache2/conf-enabled/ æ­¤å¤–ï¼Œåœ¨æ­£å¼è®¿é—® Web é¡µé¢å®‰è£…ä¹‹å‰ï¼Œéœ€è¦å…ˆä¿®æ”¹æ—¶åŒºé…ç½®ã€‚ç¼–è¾‘ /etc/apache2/conf-enabled/zabbix-frontend-php.conf æ–‡ä»¶ï¼Œå°†æ—¶åŒºé…ç½®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼šphp_value date.timezone Asia/Shanghai Web å®‰è£…ç¨‹åºä»¥ä¸Šæ­¥éª¤å®ŒæˆåŽï¼Œé‡å¯ Apache2 æœåŠ¡ã€‚è¿›å…¥æµè§ˆå™¨è®¿é—® http://localhost/zabbix ,æ ¹æ®æç¤ºè¿›è¡Œæ“ä½œï¼Œéƒ¨åˆ†æˆªå›¾å¦‚ä¸‹ï¼š æ“ä½œå®ŒæˆåŽï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ zabbix.conf.php æ–‡ä»¶ï¼Œå†…å®¹å¤§è‡´å¦‚ä¸‹ï¼š12345678910111213141516171819&lt;?php// Zabbix GUI configuration file.global $DB;$DB[&apos;TYPE&apos;] = &apos;MYSQL&apos;;$DB[&apos;SERVER&apos;] = &apos;localhost&apos;;$DB[&apos;PORT&apos;] = &apos;3306&apos;;$DB[&apos;DATABASE&apos;] = &apos;zabbix&apos;;$DB[&apos;USER&apos;] = &apos;admin&apos;;$DB[&apos;PASSWORD&apos;] = &apos;password&apos;;// Schema name. Used for IBM DB2 and PostgreSQL.$DB[&apos;SCHEMA&apos;] = &apos;&apos;;$ZBX_SERVER = &apos;your_ip_address&apos;;$ZBX_SERVER_PORT = &apos;10051&apos;;$ZBX_SERVER_NAME = &apos;server1&apos;;$IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG; å¦‚è¯¥æ–‡ä»¶æœªè‡ªåŠ¨åœ¨ /etc/zabbix/ ç›®å½•ä¸‹ç”Ÿæˆï¼Œå¯å°†è¯¥æ–‡ä»¶ä¸‹è½½åŽç§»åŠ¨åˆ°å¯¹åº”ä½ç½®ã€‚ æ­¤æ—¶è®¿é—® http://localhost/zabbix ï¼Œå³å¯è¿›å…¥å®‰è£…é…ç½®å®Œæˆçš„ Zabbix ç›‘æŽ§ç³»ç»ŸæŽ§åˆ¶å°ã€‚é»˜è®¤ç™»å½•ç”¨æˆ·åä¸º Adminï¼Œå¯†ç ä¸º zabbixã€‚æˆªå›¾å¦‚ä¸‹ï¼š ä¸‰ã€ä¸»æœºä¸Žç›‘æŽ§é¡¹æœ¬æ–‡ä¸»è¦ä»‹ç» Zabbix ç›‘æŽ§ç³»ç»Ÿçš„å®‰è£…é…ç½®æµç¨‹ï¼Œå¯¹äºŽä¸»æœºåŠå…¶å…³è”çš„ç›‘æŽ§é¡¹çš„é…ç½®ï¼Œé™äºŽç¯‡å¹…ä¸ä½œè¿‡å¤šä»‹ç»ã€‚å»ºè®®å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚ å®žé™…ä¸Šå®Œæˆå®‰è£…ä¹‹åŽï¼ŒZabbix å·²ç»é»˜è®¤å…³è”äº†ä¸€ä¸ªåä¸º Zabbix server çš„ä¸»æœºï¼ˆå³å®‰è£… Zabbix Server çš„ Linux æœåŠ¡å™¨æœ¬èº«ï¼‰ï¼Œå…¶ä¸­é»˜è®¤é…ç½®äº†ä¼—å¤šç›‘æŽ§é¡¹ã€è§¦å‘å™¨ã€å›¾å½¢å’Œè‡ªåŠ¨å‘çŽ°è§„åˆ™ç­‰ã€‚å¯ä»¥æŸ¥çœ‹å®ƒä»¬çš„å…·ä½“é…ç½®ä¿¡æ¯ä½œä¸ºå‚è€ƒã€‚éƒ¨åˆ†æˆªå›¾å¦‚ä¸‹ï¼š å‚è€ƒèµ„æ–™Zabbix äº§å“æ‰‹å†ŒZabbix Network Monitoring, Second Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Zabbix</tag>
        <tag>Monitor</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux ç³»ç»Ÿ nginx æœåŠ¡å™¨å®‰è£…åŠè´Ÿè½½å‡è¡¡é…ç½®è¯¦è§£]]></title>
    <url>%2F2019%2F07%2F02%2Fconfigure-nginx-for-load-banlance%2F</url>
    <content type="text"><![CDATA[nginx(engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ HTTP å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€é‚®ä»¶ä»£ç†æœåŠ¡å™¨ä»¥åŠé€šç”¨çš„ TCP/UDP ä»£ç†æœåŠ¡å™¨ã€‚å…¶ç‰¹ç‚¹ä¸ºè½»é‡çº§ï¼ˆå ç”¨ç³»ç»Ÿèµ„æºå°‘ï¼‰ã€ç¨³å®šæ€§å¥½ã€å¯æ‰©å±•æ€§ï¼ˆæ¨¡å—åŒ–ç»“æž„ï¼‰ã€å¹¶å‘èƒ½åŠ›å¼ºã€é…ç½®ç®€å•ç­‰ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»åœ¨æµ‹è¯•çŽ¯å¢ƒä¸­é€šè¿‡ nginx å®žçŽ°åŸºæœ¬çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚ nginx å¯ä»¥æä¾› HTTP æœåŠ¡ï¼ŒåŒ…æ‹¬å¤„ç†é™æ€æ–‡ä»¶ï¼Œæ”¯æŒ SSL å’Œ TLS SNIã€GZIP ç½‘é¡µåŽ‹ç¼©ã€è™šæ‹Ÿä¸»æœºã€URL é‡å†™ç­‰åŠŸèƒ½ï¼Œå¯ä»¥æ­é… FastCGIã€uwsgi ç­‰ç¨‹åºå¤„ç†åŠ¨æ€è¯·æ±‚ã€‚ æ­¤å¤–ï¼Œnginx è¿˜å¯ä»¥ç”¨äºŽä»£ç†ã€åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€ç¼“å­˜ç­‰æœåŠ¡å™¨åŠŸèƒ½ï¼Œåœ¨é›†ç¾¤çŽ¯å¢ƒä¸­æ”¹å–„ç½‘ç»œè´Ÿè½½ã€æé«˜å¯ç”¨æ€§ã€‚ ä¸€ã€æ­å»ºæµ‹è¯•çŽ¯å¢ƒè¿™é‡Œçš„æµ‹è¯•çŽ¯å¢ƒä¸ºé€šè¿‡ VirtualBox å®‰è£…çš„ä¸¤å° Lubuntu 19.04 è™šæ‹Ÿæœºï¼ŒLinux ç³»ç»Ÿå®‰è£…æ–¹æ³•ä¸ä½œèµ˜è¿°ã€‚ä¸ºäº†ä¿è¯ä¸¤å° Linux è™šæ‹Ÿæœºä¹‹é—´çš„ç›¸äº’è®¿é—®ï¼Œè™šæ‹Ÿæœºçš„ç½‘ç»œé…ç½®é™¤äº†é»˜è®¤çš„ NAT æ–¹å¼å¤–ï¼Œè¿˜ä½¿ç”¨äº† VirtualBox è½¯ä»¶æä¾›çš„ å†…éƒ¨ç½‘ç»œï¼ˆInternalï¼‰ è”ç½‘æ–¹å¼ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦å°†ä¸¤å°è™šæ‹Ÿæœºä¸­ä¸Žâ€œå†…éƒ¨ç½‘ç»œâ€ç›¸å…³è”çš„ç½‘å¡ï¼Œç»‘å®šä¸ŠåŒä¸€ç½‘æ®µçš„é™æ€ IP åœ°å€ï¼Œåˆ™ä¸¤å°ä¸»æœºå½¢æˆå±€åŸŸç½‘ç»œï¼Œç›¸äº’ä¹‹é—´å¯ä»¥ç›´æŽ¥è®¿é—®ã€‚ ç½‘ç»œé…ç½®æ‰“å¼€ VirtualBox è½¯ä»¶ï¼Œåˆ†åˆ«è¿›å…¥ä¸¤å°è™šæ‹Ÿæœºçš„è®¾ç½®ç•Œé¢ï¼Œä¸ºå…¶æ·»åŠ è¿žæŽ¥æ–¹å¼ä¸ºå†…éƒ¨ç½‘ç»œçš„ç½‘ç»œè¿žæŽ¥ï¼Œæˆªå›¾å¦‚ä¸‹ï¼ˆä¸¤å°è™šæ‹Ÿæœºä½œåŒæ ·çš„é…ç½®ï¼‰ï¼š ç™»å½•è¿›è™šæ‹Ÿæœºç³»ç»Ÿï¼Œä½¿ç”¨ ip addr å‘½ä»¤æŸ¥çœ‹å½“å‰çš„ç½‘ç»œè¿žæŽ¥ä¿¡æ¯ï¼š123456789101112$ ip addr...2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether 08:00:27:38:65:a8 brd ff:ff:ff:ff:ff:ff inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3 valid_lft 86390sec preferred_lft 86390sec inet6 fe80::9a49:54d3:2ea6:1b50/64 scope link noprefixroute valid_lft forever preferred_lft forever3: enp0s8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether 08:00:27:0d:0b:de brd ff:ff:ff:ff:ff:ff inet6 fe80::2329:85bd:937e:c484/64 scope link noprefixroute valid_lft forever preferred_lft forever å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶çš„ enp0s8 ç½‘å¡è¿˜æ²¡æœ‰ç»‘å®š IPv4 åœ°å€ï¼Œéœ€è¦ä¸ºå…¶æ‰‹åŠ¨æŒ‡å®šé™æ€ IPã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»Ž Ubuntu 17.10 ç‰ˆæœ¬å¼€å§‹ï¼Œä¸€ä¸ªæ–°çš„åä¸º netplan çš„å·¥å…·è¢«å¼•å…¥ï¼ŒåŽŸæ¥çš„ç½‘ç»œé…ç½®æ–‡ä»¶ /etc/network/interfaces ä¸å†ç”Ÿæ•ˆã€‚ æ‰€ä»¥ä¸ºç½‘å¡è®¾ç½®é™æ€ IP æ—¶éœ€è¦ä¿®æ”¹ /etc/netplan/01-network-manager-all.yaml é…ç½®æ–‡ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011network: version: 2 renderer: NetworkManager ethernets: enp0s8: dhcp4: no dhcp6: no addresses: [192.168.1.101/24]# gateway4: 192.168.1.101# nameservers:# addresses: [192.168.1.101, 8.8.8.8] ç”±äºŽä¸¤å°ä¸»æœºå¤„äºŽåŒä¸€å­ç½‘ï¼Œç½‘å…³å’Œ DNS æœåŠ¡å™¨æœªé…ç½®çš„æƒ…å†µä¸‹ä»å¯ä»¥äº’ç›¸è®¿é—®ã€‚å¯¹åº”çš„é…ç½®é¡¹æš‚æ—¶å…ˆæ³¨é‡ŠæŽ‰ï¼ˆåŽç»­å¯ä»¥å°è¯•è‡ªè¡Œæ­å»º DNS æœåŠ¡å™¨ï¼‰ã€‚ ç¼–è¾‘å®ŒæˆåŽè¿è¡Œ sudo netplan apply å‘½ä»¤ï¼Œå‰é¢é…ç½®çš„é™æ€ IP å³å¯ç”Ÿæ•ˆã€‚12345678$ ip addr...3: enp0s8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether 08:00:27:0d:0b:de brd ff:ff:ff:ff:ff:ff inet 192.168.1.101/24 brd 192.168.1.255 scope global noprefixroute enp0s8 valid_lft forever preferred_lft forever inet6 fe80::a00:27ff:fe0d:bde/64 scope link valid_lft forever preferred_lft forever ç™»å½•è¿›å¦ä¸€å°è™šæ‹Ÿæœºä¸­ï¼Œæ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼ˆæ³¨æ„é…ç½®æ–‡ä»¶ä¸­çš„ addresses é¡¹æ”¹ä¸º [192.168.1.102/24]ï¼‰ã€‚ä¸¤å°è™šæ‹Ÿæœºçš„ç½‘ç»œå³é…ç½®å®Œæˆã€‚ æ­¤æ—¶æœ‰ Linux è™šæ‹Ÿæœº server1ï¼ŒIP åœ°å€ä¸º 192.168.1.101ï¼›Linux è™šæ‹Ÿæœº server2ï¼ŒIP åœ°å€ä¸º 192.168.1.102ã€‚ä¸¤å°ä¸»æœºå¯ç›¸äº’è®¿é—®ã€‚æµ‹è¯•å¦‚ä¸‹ï¼š12345678starky@server1:~$ ping 192.168.1.102 -c 2PING 192.168.1.102 (192.168.1.102) 56(84) bytes of data.64 bytes from 192.168.1.102: icmp_seq=1 ttl=64 time=0.951 ms64 bytes from 192.168.1.102: icmp_seq=2 ttl=64 time=0.330 ms--- 192.168.1.102 ping statistics ---2 packets transmitted, 2 received, 0% packet loss, time 2msrtt min/avg/max/mdev = 0.330/0.640/0.951/0.311 ms 12345678skitar@server2:~$ ping 192.168.1.101 -c 2PING 192.168.1.101 (192.168.1.101) 56(84) bytes of data.64 bytes from 192.168.1.101: icmp_seq=1 ttl=64 time=0.223 ms64 bytes from 192.168.1.101: icmp_seq=2 ttl=64 time=0.249 ms--- 192.168.1.101 ping statistics ---2 packets transmitted, 2 received, 0% packet loss, time 29msrtt min/avg/max/mdev = 0.223/0.236/0.249/0.013 ms äºŒã€å®‰è£… nginx æœåŠ¡å™¨nginx çš„å®‰è£…æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼š é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶ç¨‹åºã€‚è¿™æ˜¯æœ€ç®€å•å’Œæœ€å¿«é€Ÿçš„å®‰è£…æ–¹å¼ï¼Œå„ä¸»æµæ“ä½œç³»ç»Ÿéƒ½å¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ Ubuntu çš„ apt-getï¼‰å®‰è£…ã€‚æ­¤ç§æ–¹å¼ä¼šå®‰è£…å‡ ä¹Žæ‰€æœ‰çš„å®˜æ–¹æ¨¡å—æˆ–æ’ä»¶ã€‚ ä»Žæºä»£ç ç¼–è¯‘å®‰è£…ã€‚è¿™ç§æ–¹å¼ç›¸å¯¹äºŽå‰è€…æ›´åŠ çµæ´»ï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©éœ€è¦å®‰è£…çš„æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚ æœ¬ç¤ºä¾‹å¹¶æ²¡æœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œæ‰€ä»¥ç›´æŽ¥é€‰æ‹©ç¬¬ä¸€ç§å®‰è£…æ–¹å¼ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š12$ sudo apt-get update$ sudo apt-get install nginx å®‰è£…æˆåŠŸåŽï¼Œé€šè¿‡ systemctl status nginx å‘½ä»¤æŸ¥çœ‹ nginx æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼š1234567891011$ systemctl status nginxâ— nginx.service - A high performance web server and a reverse proxy server Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: en Active: active (running) since Tue 2019-07-02 01:22:07 CST; 26s ago Docs: man:nginx(8) Main PID: 3748 (nginx) Tasks: 2 (limit: 1092) Memory: 4.9M CGroup: /system.slice/nginx.service â”œâ”€3748 nginx: master process /usr/sbin/nginx -g daemon on; master_pro â””â”€3749 nginx: worker process é€šè¿‡ curl -I 127.0.0.1 å‘½ä»¤éªŒè¯ Web æœåŠ¡å™¨æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®ï¼š1234$ curl -I 127.0.0.1HTTP/1.1 200 OKServer: nginx/1.15.9 (Ubuntu)... ä¸‰ã€è´Ÿè½½å‡è¡¡é…ç½®è´Ÿè½½å‡è¡¡ï¼ˆload-balancingï¼‰å³æŒ‰ç…§ä¸€å®šçš„è§„åˆ™å°†è´Ÿè½½åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šæ‰§è¡Œï¼Œä»Žè€Œæé«˜æœåŠ¡çš„å¯ç”¨æ€§å’Œå“åº”é€Ÿåº¦ã€‚ç®€å•çš„ç¤ºä¾‹å›¾å¦‚ä¸‹ï¼š å¦‚æŸç½‘ç«™åº”ç”¨éƒ¨ç½²åœ¨å¤šå°ä¸»æœºæž„æˆçš„æœåŠ¡å™¨é›†ç¾¤ä¸Šï¼Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ä½äºŽç»ˆç«¯ç”¨æˆ·å’ŒæœåŠ¡å™¨é›†ç¾¤ä¹‹é—´ï¼Œè´Ÿè´£æŽ¥æ”¶ç»ˆç«¯ç”¨æˆ·çš„è®¿é—®æµé‡ï¼Œå¹¶æ ¹æ®ä¸€å®šçš„è§„åˆ™å°†ç”¨æˆ·è®¿é—®åˆ†å‘ç»™åŽç«¯çš„æœåŠ¡å™¨ä¸»æœºï¼Œä»Žè€Œæé«˜åœ¨é«˜å¹¶å‘çŠ¶æ€ä¸‹çš„å“åº”é€Ÿåº¦ã€‚ è´Ÿè½½å‡è¡¡æœåŠ¡å™¨nginx å¯ä»¥é€šè¿‡ upstream é€‰é¡¹é…ç½®è´Ÿè½½å‡è¡¡ã€‚è¿™é‡Œä½¿ç”¨è™šæ‹Ÿæœº server1 ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚ä¿®æ”¹ serve1 ä¸Šé»˜è®¤ç«™ç‚¹çš„é…ç½®æ–‡ä»¶ï¼ˆsudo vim /etc/nginx/sites-available/defaultï¼‰ï¼Œæ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š123456789101112upstream backend &#123; server 192.168.1.102:8000; server 192.168.1.102;&#125;server &#123; listen 80; location / &#123; proxy_pass http://backend; &#125;&#125; åŸºäºŽæµ‹è¯•çš„ç›®çš„ï¼Œå½“å‰åªæœ‰ä¸¤å°è™šæ‹Ÿæœºã€‚server1ï¼ˆ192.168.1.101ï¼‰å·²ç»ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œæ‰€ä»¥ä½¿ç”¨ server2ï¼ˆ192.168.1.102ï¼‰ä½œä¸ºåº”ç”¨æœåŠ¡å™¨ã€‚è¿™é‡Œå€ŸåŠ© nginx çš„è™šæ‹Ÿä¸»æœºåŠŸèƒ½ï¼Œåˆ†åˆ«å°† 192.168.1.102 å’Œ 192.168.1.102:8000 â€œæ¨¡æ‹Ÿâ€ä¸ºä¸¤å°ä¸åŒçš„åº”ç”¨æœåŠ¡å™¨ã€‚ åº”ç”¨æœåŠ¡å™¨ä¿®æ”¹ server2 ä¸Šé»˜è®¤ç«™ç‚¹çš„é…ç½®æ–‡ä»¶ï¼ˆsudo vim /etc/nginx/sites-available/defaultï¼‰ï¼Œæ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š12345678910111213server &#123; listen 80; root /var/www/html; index index.html index.htm index.nginx-debian.html; server_name 192.168.1.102; location / &#123; try_files $uri $uri/ =404; &#125;&#125; åœ¨ /var/www/html ç›®å½•ä¸‹åˆ›å»º index.html æ–‡ä»¶ï¼Œä½œä¸º default ç«™ç‚¹çš„ index é¡µé¢ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server1&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server1, Address 192.168.1.102.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; è¿è¡Œ sudo systemctl restart nginx å‘½ä»¤é‡å¯ nginx æœåŠ¡ï¼Œæ­¤æ—¶è®¿é—® http://192.168.1.102 å³å¯èŽ·å–åˆšåˆšåˆ›å»ºçš„ index.html é¡µé¢ï¼š123456789$ curl 192.168.1.102&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server1&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server1, Address 192.168.1.102.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; é…ç½®â€œå¦ä¸€å°ä¸»æœºâ€ä¸Šçš„ç«™ç‚¹ï¼Œåœ¨ server2 ä¸Šåˆ›å»º /etc/nginx/sites-available/server2 é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678910111213server &#123; listen 8000; root /var/www/html; index index2.html index.htm index.nginx-debian.html; server_name 192.168.1.102; location / &#123; try_files $uri $uri/ =404; &#125;&#125; æ³¨æ„ç›‘å¬ç«¯å£å’Œ index é¡µé¢çš„é…ç½®å˜åŒ–ã€‚åœ¨ /var/www/html ç›®å½•ä¸‹åˆ›å»º index2.html æ–‡ä»¶ï¼Œä½œä¸º server2 ç«™ç‚¹çš„ index é¡µé¢ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server2&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server2, Address 192.168.1.102:8000.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; PSï¼šä¸ºäº†æµ‹è¯•ç›®çš„ï¼Œdefault ç«™ç‚¹å’Œ server2 ç«™ç‚¹é…ç½®åœ¨åŒä¸€ä¸ªä¸»æœº server2 ä¸Šï¼Œä¸”é¡µé¢ç¨æœ‰ä¸åŒã€‚å®žé™…çŽ¯å¢ƒä¸­é€šå¸¸å°†è¿™ä¸¤ä¸ªç«™ç‚¹é…ç½®åœ¨ä¸åŒçš„ä¸»æœºä¸Šï¼Œä¸”å†…å®¹ä¸€è‡´ã€‚ è¿è¡Œ sudo ln -s /etc/nginx/sites-available/server2 /etc/nginx/sites-enabled/ å‘½ä»¤å¯ç”¨åˆšåˆšåˆ›å»ºçš„ server2 ç«™ç‚¹ã€‚é‡å¯ nginx æœåŠ¡ï¼Œæ­¤æ—¶è®¿é—® http://192.168.1.102:8000 å³å¯èŽ·å–åˆšåˆšåˆ›å»ºçš„ index2.html é¡µé¢ï¼š123456789$ curl 192.168.1.102:8000&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server2&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server2, Address 192.168.1.102:8000.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; è´Ÿè½½å‡è¡¡æµ‹è¯•å›žåˆ°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å³è™šæ‹Ÿæœº server1 ä¸Šï¼Œå…¶é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„åå‘ä»£ç† URL ä¸º http://backend ã€‚ç”±äºŽæœªæ›¾é…ç½®åŸŸåè§£æžæœåŠ¡ï¼Œæ— æ³•å°† URL http://backend å®šä½åˆ°æ­£ç¡®çš„ä½ç½®ã€‚ å¯ä»¥ä¿®æ”¹ server1 ä¸Šçš„ /etc/hosts æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä¸€æ¡è®°å½•ï¼š127.0.0.1 backendå³å¯å°†è¯¥åŸŸåè§£æžåˆ°æœ¬åœ° IP ï¼Œå®Œæˆå¯¹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„è®¿é—®ã€‚ é‡å¯ nginx æœåŠ¡ï¼Œåœ¨ server1 ä¸Šè®¿é—® http://backend ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536$ curl http://backend&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server1&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server1, Address 192.168.1.102.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt;$ curl http://backend&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server2&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server2, Address 192.168.1.102:8000.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt;$ curl http://backend&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server1&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server1, Address 192.168.1.102.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt;$ curl http://backend&lt;html&gt; &lt;head&gt; &lt;title&gt;Index Page From Server2&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;This is Server2, Address 192.168.1.102:8000.&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; ä»Žè¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºï¼Œserver1 å¯¹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ http://backend çš„è®¿é—®ï¼Œå®Œæˆäº†å¯¹åº”ç”¨æœåŠ¡å™¨ server2 ä¸Šä¸¤ä¸ª Web ç«™ç‚¹çš„è½®è¯¢ï¼Œèµ·åˆ°è´Ÿè½½å‡è¡¡çš„ä½œç”¨ã€‚ å››ã€è´Ÿè½½å‡è¡¡æ–¹æ³•nginx å¼€æºç‰ˆæœ¬æä¾›å››ç§è´Ÿè½½å‡è¡¡çš„å®žçŽ°æ–¹å¼ï¼Œç®€å•ä»‹ç»å¦‚ä¸‹ã€‚ 1. Round Robinç”¨æˆ·è¯·æ±‚å‡åŒ€åœ°åˆ†é…ç»™åŽç«¯æœåŠ¡å™¨é›†ç¾¤ï¼ˆå¯ä»¥é€šè¿‡ weight é€‰é¡¹è®¾ç½®è½®è¯¢çš„æƒé‡ï¼‰ï¼Œè¿™æ˜¯ nginx é»˜è®¤ä½¿ç”¨çš„è´Ÿè½½å‡è¡¡æ–¹å¼ï¼š1234upstream backend &#123; server backend1.example.com weight=5; server backend2.example.com;&#125; 2. Least Connectionsç”¨æˆ·è¯·æ±‚ä¼šä¼˜å…ˆè½¬å‘ç»™é›†ç¾¤ä¸­å½“å‰æ´»è·ƒè¿žæŽ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ã€‚åŒæ ·æ”¯æŒ weight é€‰é¡¹ã€‚12345upstream backend &#123; least_conn; server backend1.example.com; server backend2.example.com;&#125; 3. IP Hashç”¨æˆ·è¯·æ±‚ä¼šæ ¹æ®å®¢æˆ·ç«¯ IP åœ°å€è¿›è¡Œè½¬å‘ã€‚å³è¯¥æ–¹å¼æ„å›¾ä¿è¯æŸä¸ªç‰¹å®šçš„å®¢æˆ·ç«¯æœ€ç»ˆä¼šè®¿é—®åŒä¸€ä¸ªæœåŠ¡å™¨ä¸»æœºã€‚12345upstream backend &#123; ip_hash; server backend1.example.com; server backend2.example.com;&#125; 4. Generic Hashç”¨æˆ·è¯·æ±‚ä¼šæ ¹æ®ä¸€ä¸ªè‡ªå®šä¹‰é”®å€¼ç¡®å®šæœ€ç»ˆè½¬å‘çš„ç›®çš„åœ°ï¼Œè¯¥é”®å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å˜é‡æˆ–è€…ç»„åˆï¼ˆå¦‚æº IP å’Œç«¯å£å·ï¼‰ã€‚12345upstream backend &#123; hash $request_uri consistent; server backend1.example.com; server backend2.example.com;&#125; æƒé‡å‚è€ƒä¸‹é¢çš„ç¤ºä¾‹é…ç½®ï¼š12345upstream backend &#123; server backend1.example.com weight=5; server backend2.example.com; server 192.0.0.1 backup;&#125; é»˜è®¤æƒé‡ï¼ˆweightï¼‰ä¸º 1 ã€‚backup æœåŠ¡å™¨åªæœ‰åœ¨æ‰€æœ‰å…¶ä»–æœåŠ¡å™¨å…¨éƒ¨å®•æœºçš„æƒ…å†µä¸‹æ‰ä¼šæŽ¥æ”¶è¯·æ±‚ã€‚å¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ¯ 6 ä¸ªè¯·æ±‚ä¼šæœ‰ 5 ä¸ªè½¬å‘ç»™ backend1.example.comï¼Œ1 ä¸ªè½¬å‘ç»™ backend2.example.comã€‚åªæœ‰å½“ backend1 å’Œ backend2 å…¨éƒ¨å®•æœºæ—¶ï¼Œ192.0.0.1 æ‰ä¼šæŽ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ã€‚ å‚è€ƒèµ„æ–™HTTP Load Balancing]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Nginx</tag>
        <tag>WebDev</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰â€”â€” ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ ä¸‹ç¯‡]]></title>
    <url>%2F2019%2F06%2F29%2Fdjango-manual-4-admin%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡æŽ¥ä¸Šç¯‡ Django å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€” ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ ä¸­ç¯‡ï¼Œæ¶‰åŠåˆ°ä»£ç é‡æž„ï¼ˆåŸºäºŽé€šç”¨è§†å›¾ï¼‰å’Œ Django åŽå°ç®¡ç†ç³»ç»Ÿçš„å®šåˆ¶ã€‚ ä¸€ã€é€šç”¨è§†å›¾å‰é¢ç¼–å†™çš„ index()ã€detail() å’Œ results() è§†å›¾éƒ½å¾ˆç®€å•ä¸”å­˜åœ¨ä¸€å®šçš„å†—ä½™é—®é¢˜ã€‚å®ƒä»¬éƒ½éµå¾ª Web å¼€å‘ä¸­ä¸€ç§å¸¸è§çš„æ¨¡å¼ï¼Œå³æ ¹æ® URL ä¸­çš„å‚æ•°ä»Žæ•°æ®åº“ä¸­èŽ·å–æ•°æ®ã€è½½å…¥æ¨¡æ¿æ–‡ä»¶ç„¶åŽè¿”å›žæ¸²æŸ“åŽçš„é¡µé¢ã€‚è€Œé€šç”¨è§†å›¾å¯ä»¥å°†è¿™ç§å¸¸è§çš„æ¨¡å¼æŠ½è±¡åŒ–ï¼Œä½¿å¾—åœ¨ç¼–å†™åº”ç”¨æ—¶èƒ½å¤Ÿå‡å°‘å¤§é‡ä¸å¿…è¦çš„ä»£ç ã€‚ ä¿®æ”¹è§†å›¾å®šä¹‰æ–‡ä»¶ï¼ˆpolls/views.pyï¼‰ï¼Œå€ŸåŠ©é€šç”¨è§†å›¾æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š1234567891011121314151617181920212223242526272829303132333435363738from django.http import HttpResponseRedirectfrom django.shortcuts import render, get_object_or_404from django.urls import reversefrom django.views import genericfrom .models import Question, Choiceclass IndexView(generic.ListView): template_name = &apos;polls/index.html&apos; context_object_name = &apos;latest_question_list&apos; def get_queryset(self): return Question.objects.order_by(&apos;-pub_date&apos;)[:5]class DetailView(generic.DetailView): model = Question template_name = &apos;polls/detail.html&apos;class ResultsView(generic.DetailView): model = Question template_name = &apos;polls/results.html&apos;def vote(request, question_id): question = get_object_or_404(Question, pk=question_id) try: selected_choice = question.choice_set.get(pk=request.POST[&apos;choice&apos;]) except (KeyError, Choice.DoesNotExist): return render(request, &apos;polls/detail.html&apos;, &#123; &apos;question&apos;: question, &apos;error_message&apos;: &quot;You didn&apos;t select a choice.&quot;, &#125;) else: selected_choice.votes += 1 selected_choice.save() return HttpResponseRedirect(reverse(&apos;polls:results&apos;, args=(question.id,))) ListView å’Œ DetailView åˆ†åˆ«è¡¨ç¤ºæ˜¾ç¤ºè‹¥å¹²å¯¹è±¡çš„åˆ—è¡¨å’Œæ˜¾ç¤ºä¸€ä¸ªç‰¹å®šç±»åž‹å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ä¸¤ç§è§†å›¾æ¨¡æ¿ã€‚å…¶ä¸­æ¯ä¸ªé€šç”¨è§†å›¾éƒ½å¯ä»¥ç”¨ model å±žæ€§æŒ‡å®šå…¶ä½œç”¨äºŽå“ªä¸ªæ¨¡åž‹ã€‚æ­¤å¤–ï¼ŒDetailView æœŸæœ›ä»Ž URL ä¸­æ•èŽ·åä¸º â€œpkâ€ çš„ä¸»é”®å€¼ï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ polls/urls.py ä¸­çš„å…·ä½“å®šä¹‰ã€‚ è§†å›¾å¯¹åº”çš„è·¯ç”±å®šä¹‰ä¿®æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼ˆpolls/urls.pyï¼‰ï¼š12345678910from django.urls import pathfrom . import viewsapp_name = &apos;polls&apos;urlpatterns = [ path(&apos;&apos;,views.IndexView.as_view(), name=&apos;index&apos;), path(&apos;&lt;int:pk&gt;/&apos;, views.DetailView.as_view(), name=&apos;detail&apos;), path(&apos;&lt;int:pk&gt;/results/&apos;, views.ResultsView.as_view(), name=&apos;results&apos;), path(&apos;&lt;int:question_id&gt;/vote/&apos;, views.vote, name=&apos;vote&apos;),] äºŒã€è‡ªå®šä¹‰ç®¡ç†åŽå°è‡ªå®šä¹‰åŽå°è¡¨å•å½“å‰çš„ Django åŽå°ç®¡ç†ç•Œé¢å¦‚ä¸‹ï¼š å¯¹äºŽæŠ•ç¥¨é—®é¢˜ï¼ˆQuestionsï¼‰å’Œé€‰é¡¹ï¼ˆChoicesï¼‰å¯¹è±¡çš„ç¼–è¾‘éœ€è¦è¿›å…¥ä¸¤ä¸ªä¸åŒçš„é¡µé¢åˆ†åˆ«è¿›è¡Œä¿®æ”¹ï¼Œä½¿ç”¨çš„å‹å¥½æ€§ä¸Šæœ‰å¾…æå‡ã€‚ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼Œä¸º Questions å¯¹è±¡æ·»åŠ å…³è”çš„ Choices å¯¹è±¡ï¼Œå³åœ¨æŠ•ç¥¨é—®é¢˜çš„åŽå°é¡µé¢ä¸­æ·»åŠ ä¸Šä¿®æ”¹æŠ•ç¥¨é€‰é¡¹çš„æŽ¥å£ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªé¡µé¢åˆå¹¶ä¸ºåŒä¸€ä¸ªã€‚ ç¼–è¾‘åŽå°å®šä¹‰æ–‡ä»¶ï¼ˆpolls/admin.pyï¼‰ï¼š123456789101112131415from django.contrib import adminfrom .models import Question, Choiceclass ChoiceInline(admin.StackedInline): model = Choice extra = 3class QuestionAdmin(admin.ModelAdmin): fieldsets = [ (None, &#123;&apos;fields&apos;: [&apos;question_text&apos;]&#125;), (&apos;Date information&apos;, &#123;&apos;fields&apos;: [&apos;pub_date&apos;], &apos;classes&apos;: [&apos;collapse&apos;]&#125;), ] inlines = [ChoiceInline]admin.site.register(Question, QuestionAdmin) æ­¤æ—¶åŽå°ç•Œé¢å¦‚ä¸‹ï¼š ä¸è¿‡ä»æœ‰ç‚¹å°é—®é¢˜ï¼Œå³ä¿®æ”¹å¯¹è±¡æ—¶çš„åŽå°é¡µé¢å æ®äº†å¤§é‡çš„å±å¹•åŒºåŸŸç”¨æ¥æ˜¾ç¤º Choice å¯¹è±¡çš„å­—æ®µã€‚Django æä¾›äº†ä¸€ç§è¡¨æ ¼çš„å½¢å¼ç”¨æ¥æ˜¾ç¤ºå…³è”å¯¹è±¡ï¼Œåªéœ€ä½œå¦‚ä¸‹ä¿®æ”¹ï¼ˆpolls/admin.pyï¼‰ï¼š123...class ChoiceInline(admin.TabularInline):... æ•ˆæžœå¦‚ä¸‹ï¼š è‡ªå®šä¹‰åŽå°å¯¹è±¡é¡µé¢å½“å‰åŽå°ç®¡ç†ç³»ç»Ÿä¸­çš„å¯¹è±¡ä¸»é¡µï¼ˆå¦‚ Question å¯¹è±¡çš„ä¸»é¡µï¼‰å¸ƒå±€å¦‚ä¸‹ï¼š ä»Žè¯¥é¡µé¢ä¸­æ— æ³•ç›´æŽ¥çœ‹åˆ°é™¤ question_text ä¹‹å¤–çš„ä»»ä½•ä¿¡æ¯ã€‚ä¸‹é¢å°†å¯¹è¯¥é¡µé¢å¦‚ä¸‹å®šåˆ¶ï¼š æ˜¾ç¤ºæ›´å¤šçš„å­—æ®µä¿¡æ¯ï¼ˆå¦‚ pub_dateï¼‰ æ·»åŠ ä¸€ä¸ªç”¨æ¥ç­›é€‰æ•°æ®çš„è¿‡æ»¤å™¨ï¼ˆåŸºäºŽæ—¥æœŸï¼‰ æ·»åŠ æœç´¢åŠŸèƒ½ï¼ˆåŸºäºŽ question_textï¼‰ ä¿®æ”¹ polls/admin.py æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ 3 è¡Œä»£ç ï¼š123456...class QuestionAdmin(admin.ModelAdmin): list_display = (&apos;question_text&apos;, &apos;pub_date&apos;) list_filter = [&apos;pub_date&apos;] search_fields = [&apos;question_text&apos;]... æ•ˆæžœå¦‚ä¸‹ï¼š å‚è€ƒèµ„æ–™ Django 2.2 å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>WebDev</tag>
        <tag>Django</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰â€”â€” ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ ä¸Šç¯‡]]></title>
    <url>%2F2019%2F06%2F24%2Fdjango-manual-2-models%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡æŽ¥ä¸Šç¯‡ Django å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€” å¿«é€Ÿå»ºç«™ï¼Œå‰ææ˜¯å·²ç»å®Œæˆäº† Django å¼€å‘çŽ¯å¢ƒçš„æ­å»ºå’Œ MySQL æ•°æ®åº“çš„å…³è”ã€‚æœ¬æ•™ç¨‹å°†åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„æŠ•ç¥¨åº”ç”¨ç¨‹åºï¼ŒåŒ…å«ä¾›äººä»¬å‚ä¸ŽæŠ•ç¥¨çš„å…¬å…±ç«™ç‚¹å’Œä¸€ä¸ªå¯æ“ä½œåŽå°æ•°æ®çš„ç®¡ç†å¹³å°ã€‚ä¸»è¦å‚è€ƒè‡ª Django 2.2 å®˜æ–¹æ–‡æ¡£ã€‚ ä¸€ã€åˆ›å»ºé¡¹ç›®$ django-admin startproject mysite è¯¥å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª mysite ç›®å½•ï¼Œå¹¶ä¸”è¯¥æ¡†æž¶ä¸­å·²ç»åŒ…å«äº†ä¸€ä¸ªåˆå§‹ Django é¡¹ç›®å¿…éœ€çš„æ‰€æœ‰ç»„ä»¶ã€‚å…¶ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š1234567mysiteâ”œâ”€â”€ manage.pyâ””â”€â”€ mysite â”œâ”€â”€ __init__.py â”œâ”€â”€ settings.py â”œâ”€â”€ urls.py â””â”€â”€ wsgi.py è¿›å…¥ manage.py æ‰€åœ¨çš„ç›®å½•ä¸‹ï¼Œè¿è¡Œ python manage.py runserver 0000:8000 å³å¯è¿è¡Œä¸€ä¸ªç”¨äºŽå¼€å‘çš„ç®€æ˜“æœåŠ¡å™¨ï¼š12345678910$ python manage.py runserver 0.0.0.0:8000Watching for file changes with StatReloaderPerforming system checks...System check identified no issues (0 silenced).June 22, 2019 - 07:47:04Django version 2.2.2, using settings &apos;mysite.settings&apos;Starting development server at http://0.0.0.0:8000/Quit the server with CONTROL-C. è®¿é—®æ•ˆæžœå¦‚ä¸‹ï¼š äºŒã€åˆ›å»ºæŠ•ç¥¨åº”ç”¨ PSï¼šâ€œåº”ç”¨â€æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºŽåšæŸä»¶äº‹çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚åšå®¢æˆ–è€…ç®€å•çš„æŠ•ç¥¨ç¨‹åºï¼Œâ€œé¡¹ç›®â€åˆ™æ˜¯ä¸€ä¸ªç½‘ç«™æ‰€åŒ…å«çš„é…ç½®å’Œåº”ç”¨çš„åˆé›†ã€‚ä¸€ä¸ªé¡¹ç›®å¯ä»¥åŒ…å«å¤šä¸ªåº”ç”¨ï¼Œä¸€ä¸ªåº”ç”¨ä¹Ÿå¯ä»¥è¢«å¤šä¸ªé¡¹ç›®ä½¿ç”¨ã€‚ Django ä¸­çš„æ¯ä¸ªåº”ç”¨éƒ½æ˜¯ä¸€ä¸ª Python åŒ…ï¼Œå¯ä»¥é€šè¿‡ manage.py åˆ›å»ºåº”ç”¨çš„åŸºç¡€ç›®å½•ç»“æž„ï¼š$ python manage.py startapp polls å½“å‰ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š12345678910111213141516mysiteâ”œâ”€â”€ manage.pyâ”œâ”€â”€ mysiteâ”‚ â”œâ”€â”€ __init__.pyâ”‚ â”œâ”€â”€ settings.pyâ”‚ â”œâ”€â”€ urls.pyâ”‚ â””â”€â”€ wsgi.pyâ””â”€â”€ polls â”œâ”€â”€ admin.py â”œâ”€â”€ apps.py â”œâ”€â”€ __init__.py â”œâ”€â”€ migrations â”‚ â””â”€â”€ __init__.py â”œâ”€â”€ models.py â”œâ”€â”€ tests.py â””â”€â”€ views.py ç¼–è¾‘è§†å›¾ï¼ˆViewï¼‰ç¼–è¾‘ polls/views.py æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š1234from django.http import HttpResponsedef index(request): return HttpResponse(&quot;Hello Wrold. This is the index page.&quot;) åˆ›å»º URL æ˜ å°„åœ¨ polls ç›®å½•ä¸‹åˆ›å»º urls.py æ–‡ä»¶ï¼Œç¼–è¾‘è¾“å…¥å¦‚ä¸‹å†…å®¹ä»¥å®Œæˆåˆ° index é¡µé¢çš„ URL æ˜ å°„ï¼š123456from django.urls import pathfrom . import viewsurlpatterns = [ path(&apos;&apos;,views.index, name=&apos;index&apos;),] åœ¨æ ¹ URLconf æ–‡ä»¶ä¸­ï¼ˆå³ mysite/urls.pyï¼‰å¼•å…¥åˆšåˆšåˆ›å»ºçš„ polls.urls æ¨¡å—ï¼ˆå³ polls/urls.pyï¼‰ï¼š1234567from django.contrib import adminfrom django.urls import path, includeurlpatterns = [ path(&apos;polls/&apos;, include(&apos;polls.urls&apos;)), path(&apos;admin/&apos;, admin.site.urls),] è¿è¡Œæµ‹è¯•æœåŠ¡å™¨ï¼Œè®¿é—® http://127.0.0.1:8000/polls ï¼Œæœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š ä¸‰ã€åˆ›å»ºæ¨¡åž‹ï¼ˆModelï¼‰åœ¨ Django ä¸­ï¼Œå¯¹äºŽä¸€ä¸ªæ•°æ®é©±åŠ¨çš„ Web åº”ç”¨ï¼Œå®šä¹‰æ¨¡åž‹ï¼ˆå³æ•°æ®åº“çš„ç»“æž„è®¾è®¡ï¼‰æ˜¯éžå¸¸å¿…è¦çš„ä¸€ä¸ªæ“ä½œã€‚ æœ¬åº”ç”¨ä¸­éœ€è¦åˆ›å»ºä¸¤ä¸ªæ¨¡åž‹ï¼š é—®é¢˜ Question æ¨¡åž‹ï¼šåŒ…å«é—®é¢˜æè¿°å’Œå‘å¸ƒæ—¶é—´ é€‰é¡¹ Choice æ¨¡åž‹ï¼šåŒ…å«é€‰é¡¹æè¿°å’Œå½“å‰ç¥¨æ•° ç¼–è¾‘ polls/models.py æ–‡ä»¶ï¼Œå…·ä½“ç»“æž„å®šä¹‰å¦‚ä¸‹ï¼š12345678910from django.db import modelsclass Question(models.Model): question_text = models.CharField(max_length=200) pub_date = models.DateTimeField(&apos;date published&apos;)class Choice(model.Model): question = models.ForeignKey(Question, on_delete=models.CASCADE) choice_text = models.CharField(max_length=200) votes = models.IntegerField(default=0) ä¸Šè¿°æ¨¡åž‹ä»£ç å¯ä»¥è¢« Django ç”¨æ¥åˆ›å»ºæœ¬åº”ç”¨çš„æ•°æ®åº“ schemaï¼ˆç”Ÿæˆ CREATE TABLE è¯­å¥ï¼‰ã€‚ä¸è¿‡éœ€è¦å…ˆåœ¨ mysite/settings.py é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ INSTALLED_APPS å˜é‡ï¼ŒDjango éœ€è¦ä¾æ®è¯¥å˜é‡ä¸­å¯¹åº”ç”¨çš„æŒ‡å®šè¿›è¡Œæ•°æ®åº“è¿ç§»æ“ä½œã€‚ 123456789INSTALLED_APPS = [ &apos;polls.apps.PollsConfig&apos;, &apos;django.contrib.admin&apos;, &apos;django.contrib.auth&apos;, &apos;django.contrib.contenttypes&apos;, &apos;django.contrib.sessions&apos;, &apos;django.contrib.messages&apos;, &apos;django.contrib.staticfiles&apos;,] è¿è¡Œ python manage.py makemigrations polls å‘½ä»¤åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼š12345$ python manage.py makemigrations pollsMigrations for &apos;polls&apos;: polls/migrations/0001_initial.py - Create model Question - Create model Choice è¿è¡Œ python manage.py migrate å‘½ä»¤å®Œæˆæ•°æ®åº“è¿ç§»æ“ä½œï¼š123456$ python manage.py migrateOperations to perform: Apply all migrations: admin, auth, contenttypes, polls, sessionsRunning migrations: Applying polls.0001_initial... OK... PSï¼šåœ¨è¿è¡Œ migrate å‘½ä»¤ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ python manage.py sqlmigrate polls 0001 æŸ¥çœ‹è¯¥æ¬¡è¿ç§»æ“ä½œå…·ä½“ä¼šæ‰§è¡Œå“ªäº› SQL è¯­å¥ï¼š123456789101112 python manage.py sqlmigrate polls 0001BEGIN;---- Create model Question--CREATE TABLE &quot;polls_question&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;question_text&quot; varchar(200) NOT NULL, &quot;pub_date&quot; datetime NOT NULL);---- Create model Choice--CREATE TABLE &quot;polls_choice&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;choice_text&quot; varchar(200) NOT NULL, &quot;votes&quot; integer NOT NULL, &quot;question_id&quot; integer NOT NULL REFERENCES &quot;polls_question&quot; (&quot;id&quot;) DEFERRABLE INITIALLY DEFERRED);CREATE INDEX &quot;polls_choice_question_id_c5b4b260&quot; ON &quot;polls_choice&quot; (&quot;question_id&quot;);COMMIT; å››ã€æ•°æ®åº“ APIå¯ä»¥é€šè¿‡è¿è¡Œ python manage.py shell è¿›å…¥ Python äº¤äº’å¼å‘½ä»¤è¡Œï¼Œå°è¯• Django æä¾›çš„å„ç§æ•°æ®åº“ API ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122$ python manage.py shellPython 3.7.3 (default, Apr 3 2019, 05:39:12)[GCC 8.3.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.(InteractiveConsole)&gt;&gt;&gt; from polls.models import Choice, Question&gt;&gt;&gt; Question.objects.all()&lt;QuerySet []&gt;&gt;&gt;&gt; from django.utils import timezone&gt;&gt;&gt; q = Question(question_text=&quot;What&apos;s new?&quot;, pub_date=timezone.now())&gt;&gt;&gt; q.save()&gt;&gt;&gt; q.id1&gt;&gt;&gt; q.question_text&quot;What&apos;s new?&quot;&gt;&gt;&gt; q.pub_datedatetime.datetime(2019, 6, 24, 15, 34, 47, 614267, tzinfo=&lt;UTC&gt;)&gt;&gt;&gt; q.question_text = &quot;What&apos;s up&quot;&gt;&gt;&gt; q.save()&gt;&gt;&gt; Question.objects.all()&lt;QuerySet [&lt;Question: Question object (1)&gt;]&gt;&gt;&gt;&gt; ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ&lt;Question: Question object (1)&gt; ç±»åž‹çš„è¾“å‡ºä¸ä¾¿äºŽäº†è§£å¯¹è±¡çš„ç»†èŠ‚ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ Question æ¨¡åž‹çš„ä»£ç æ¥æ”¹å˜ Question.objects.all() å‡½æ•°çš„è¡Œä¸ºã€‚å°† polls/models.py å†…å®¹æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12345678910111213141516from django.db import modelsclass Question(models.Model): question_text = models.CharField(max_length=200) pub_date = models.DateTimeField(&apos;date published&apos;) def __str__(self): return self.question_textclass Choice(models.Model): question = models.ForeignKey(Question, on_delete=models.CASCADE) choice_text = models.CharField(max_length=200) votes = models.IntegerField(default=0) def __str__(self): return self.choice_text æ­¤æ—¶å†æ¬¡å°è¯•ä½¿ç”¨æ•°æ®åº“ API ï¼š123456789$ python manage.py shellPython 3.7.3 (default, Apr 3 2019, 05:39:12)[GCC 8.3.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.(InteractiveConsole)&gt;&gt;&gt; from polls.models import Choice, Question&gt;&gt;&gt; Question.objects.all()&lt;QuerySet [&lt;Question: What&apos;s up&gt;]&gt;&gt;&gt;&gt; ç»™æ¨¡åž‹å¢žåŠ  __str__() æ–¹æ³•åªæ˜¯å…¶ä¸­ä¸€ç§å½¢å¼ï¼Œå®žé™…ä¸Šå¯ä»¥æ·»åŠ ä»»æ„éœ€è¦çš„å‡½æ•°ä»¥ä¾›åŽæœŸè°ƒç”¨ã€‚ äº”ã€åŽå°ç®¡ç†ç³»ç»Ÿï¼ˆDjango adminï¼‰Django admin æ˜¯ä»»ä½•ä¸€ä¸ªåˆå§‹çš„ Django é¡¹ç›®ï¼ˆå®Œæˆæ•°æ®åº“åŒæ­¥ä¹‹åŽï¼‰é»˜è®¤å¼€å¯çš„åº”ç”¨ï¼Œç”¨äºŽå¯¹é¡¹ç›®å…³è”çš„æ•°æ®åº“è¡¨è¿›è¡ŒåŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥æ“ä½œã€‚ é¦–å…ˆéœ€è¦åˆ›å»ºç”¨äºŽç™»å½•åŽå°ç³»ç»Ÿçš„ç®¡ç†å‘˜è´¦æˆ·ï¼š123456$ python manage.py createsuperuserUsername (leave blank to use &apos;starky&apos;):Email address:Password:Password (again):Superuser created successfully. å¼€å¯æµ‹è¯•æœåŠ¡å™¨ï¼ˆpython manage.py runserver 0000:8000ï¼‰ï¼Œè®¿é—® http://127.0.0.1:8000/admin/ï¼Œä½¿ç”¨åˆšåˆšåˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š å°† poll åº”ç”¨æ·»åŠ è‡³åŽå°ä¿®æ”¹ polls/admin.py æ–‡ä»¶ï¼Œå°† Question å¯¹è±¡æ·»åŠ è‡³åŽå°é¢æ¿ï¼š1234from django.contrib import adminfrom .models import Questionadmin.site.register(Question) å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨ï¼Œè®¿é—®åŽå°é¡µé¢æ•ˆæžœå¦‚ä¸‹ï¼š PSï¼šä¸­æ–‡ç•Œé¢å¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ mysite/settings.pyï¼Œå°† LANGUAGE_CODE é¡¹æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼šLANGUAGE_CODE = &#39;zh-Hans&#39; ä¹‹åŽä¾¿å¯ä»¥åœ¨åŽå°é¡µé¢ç›´æŽ¥å¯¹ä¹‹å‰ MySQL ä¸­åˆ›å»ºçš„ polls_question æ•°æ®è¡¨è¿›è¡Œç¼–è¾‘æ“ä½œï¼š å‚è€ƒèµ„æ–™ Django 2.2 å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>WebDev</tag>
        <tag>Django</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€” ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ ä¸­ç¯‡]]></title>
    <url>%2F2019%2F06%2F24%2Fdjango-manual-3-views%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡æŽ¥ä¸Šç¯‡ Django å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰â€”â€” ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ ä¸Šç¯‡ï¼Œå‰ææ˜¯å·²ç»å®Œæˆäº† Django é¡¹ç›®çš„åˆå§‹åŒ–ä»¥åŠæ•°æ®æ¨¡åž‹çš„åˆ›å»ºã€‚æœ¬ç¯‡ä¸»è¦è®²è§†å›¾ï¼ˆViewï¼‰çš„åˆ›å»ºï¼Œè§†å›¾å³ä¸€ç±»å…·æœ‰ç›¸åŒåŠŸèƒ½å’Œæ¨¡æ¿çš„ç½‘é¡µçš„é›†åˆã€‚ æœ¬åº”ç”¨ä¸­éœ€è¦ç”¨åˆ°ä¸€ä¸‹å‡ ä¸ªè§†å›¾ï¼š é—®é¢˜ç´¢å¼•é¡µï¼šå±•ç¤ºæœ€è¿‘å‡ ä¸ªé—®é¢˜çš„åˆ—è¡¨ é—®é¢˜è¯¦æƒ…é¡µï¼šå±•ç¤ºæŸä¸ªéœ€è¦æŠ•ç¥¨çš„é—®é¢˜åŠå…¶é€‰é¡¹ é—®é¢˜ç»“æžœé¡µï¼šå±•ç¤ºæŸä¸ªæŠ•ç¥¨çš„ç»“æžœ æŠ•ç¥¨å¤„ç†å™¨ï¼šå“åº”ç”¨æˆ·ä¸ºæŸä¸ªé—®é¢˜çš„ç‰¹å®šé€‰é¡¹æŠ•ç¥¨çš„æ“ä½œ ä¸€ã€æ¨¡æ¿ç†è®ºä¸Šè®²ï¼Œè§†å›¾å¯ä»¥ä»Žæ•°æ®åº“è¯»å–è®°å½•ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“Žï¼ˆDjango è‡ªå¸¦çš„æˆ–è€…ç¬¬ä¸‰æ–¹æ¨¡æ¿ï¼‰ï¼Œå¯ä»¥è¾“å‡º XMLï¼Œåˆ›å»ºåŽ‹ç¼©æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•æƒ³ç”¨çš„ Python åº“ã€‚ å¿…é¡»çš„è¦æ±‚åªæ˜¯è¿”å›žä¸€ä¸ª HttpResponse å¯¹è±¡ï¼Œæˆ–è€…æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ å€ŸåŠ© Django æä¾›çš„æ•°æ®åº“ APIï¼Œä¿®æ”¹è§†å›¾ï¼ˆpolls/views.py æ–‡ä»¶ï¼‰ä¸­çš„ index() å‡½æ•°ï¼Œä½¿å¾—åº”ç”¨é¦–é¡µå¯ä»¥å±•ç¤ºæ•°æ®åº“ä¸­ä»¥å‘å¸ƒæ—¶é—´æŽ’åºçš„æœ€è¿‘ 5 ä¸ªé—®é¢˜ï¼š123456789from django.http import HttpResponsefrom .models import Questiondef index(request): latest_question_list = Question.objects.order_by(&apos;-pub_date&apos;)[:5] output = &apos;/n&apos;.join([q.question_text for q in latest_question_list]) if output: output = &apos;Em...there is no questions. Please add some.&apos; return HttpResponse(output) å¼€å¯æµ‹è¯•æœåŠ¡å™¨ï¼Œè¿›å…¥ Django åŽå°ç®¡ç†ç³»ç»Ÿï¼ˆhttp://127.0.0.1:8000/adminï¼‰ï¼Œæ·»åŠ æµ‹è¯•é—®é¢˜ï¼š è®¿é—® index è§†å›¾ï¼ˆhttp://127.0.0.1:8000/pollsï¼‰æ•ˆæžœå¦‚ä¸‹ï¼š åœ¨å½“å‰çš„ä»£ç ä¸­ï¼Œé¡µé¢çš„å¸ƒå±€å®šä¹‰æ˜¯å›ºå®šåœ¨è§†å›¾å‡½æ•°ä¸­çš„ï¼Œé¡µé¢è®¾è®¡å˜æ›´æ—¶åˆ™éœ€è¦å¯¹ Python ä»£ç è¿›è¡Œæ”¹åŠ¨ã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡ä½¿ç”¨ Django çš„æ¨¡æ¿ç³»ç»Ÿï¼Œå°†é¡µé¢è®¾è®¡ä»Žä¸šåŠ¡ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ã€‚ åœ¨ polls ç›®å½•ä¸‹åˆ›å»º templates ç›®å½•ï¼ŒDjango ä¼šè‡ªåŠ¨åœ¨è¯¥ç›®å½•ä¸‹å¯»æ‰¾æ¨¡æ¿æ–‡ä»¶ã€‚åœ¨ polls/templates ç›®å½•ä¸‹åˆ›å»º polls ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»º index.html æ–‡ä»¶ï¼ˆå³æœ€ç»ˆçš„æ¨¡æ¿æ–‡ä»¶ä¸º polls/templates/polls/index.htmlï¼‰ã€‚ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š123456789&#123;% if latest_question_list %&#125; &lt;ul&gt; &#123;% for question in latest_question_list %&#125; &lt;li&gt;&lt;a href=&quot;/polls/&#123;&#123; question.id &#125;&#125;/&quot;&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/a&gt;&lt;/li&gt; &#123;% endfor %&#125; &lt;/ul&gt;&#123;% else %&#125; &lt;p&gt;No polls are available.&lt;/p&gt;&#123;% endif %&#125; ä¿®æ”¹è§†å›¾å‡½æ•°ï¼ˆpolls/view.pyï¼‰å·²ä½¿ç”¨åˆšåˆšåˆ›å»ºçš„æ¨¡æ¿ï¼š1234567from django.shortcuts import renderfrom .models import Questiondef index(request): latest_question_list = Question.objects.order_by(&apos;-pub_date&apos;)[:5] context = &#123;&apos;latest_question_list&apos;: latest_question_list&#125; return render(request, &apos;polls/index.html&apos;, context) render() å‡½æ•°ç”¨äºŽåŠ è½½æ¨¡å—å¹¶å¡«å……ä¸Šä¸‹æ–‡ï¼Œç„¶åŽè¿”å›žç”Ÿæˆçš„ HttpResponse å¯¹è±¡ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼š 404 é”™è¯¯æ­¤æ—¶è®¿é—®é—®é¢˜è¯¦æƒ…é¡µé¢ï¼ˆå³ç‚¹å‡» index é¡µé¢ä¸­çš„ test quesion é“¾æŽ¥ï¼‰ï¼Œä¼šæç¤º Page not found é”™è¯¯ï¼ŒåŽŸå› æ˜¯æ¨¡æ¿ï¼ˆindex.htmlï¼‰ä¸­æŒ‡å®šçš„ polls// è¿˜æ²¡æœ‰åˆ›å»ºå¯¹åº”çš„è·¯ç”±åŠå…¶ç»‘å®šçš„é¡µé¢ã€‚ è¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ªé—®é¢˜è¯¦æƒ…é¡µçš„è§†å›¾ï¼Œç”¨äºŽæ˜¾ç¤ºæŒ‡å®šé—®é¢˜çš„è¯¦ç»†ä¿¡æ¯ã€‚åŒæ—¶å½“è®¿é—®çš„é—®é¢˜ä¸å­˜åœ¨æ—¶ï¼Œè¯¥è§†å›¾ä¼šæŠ›å‡º Http404 å¼‚å¸¸ã€‚è§†å›¾ä»£ç ï¼ˆpolls/views.pyï¼‰å¦‚ä¸‹ï¼š123456789101112131415from django.http import Http404from django.shortcuts import renderfrom .models import Questiondef index(request): latest_question_list = Question.objects.order_by(&apos;-pub_date&apos;)[:5] context = &#123;&apos;latest_question_list&apos;: latest_question_list&#125; return render(request, &apos;polls/index.html&apos;, context)def detail(request, question_id): try: question = Question.objects.get(pk=question_id) except Question.DoesNotExist: raise Http404(&quot;Question does not exist&quot;) return render(request, &apos;polls/detail.html&apos;, &#123;&apos;question&apos;: question&#125;) åˆ›å»ºå¯¹åº” detail è§†å›¾çš„æ¨¡æ¿æ–‡ä»¶ï¼ˆpolls/templates/polls/detail.htmlï¼‰ï¼š123456&lt;h1&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/h1&gt;&lt;ul&gt;&#123;% for choice in question.choice_set.all %&#125; &lt;li&gt;&#123;&#123; choice.choice_text &#125;&#125;&lt;/li&gt;&#123;% endfor %&#125;&lt;/ul&gt; å…¶ä¸­ choice æ¨¡åž‹è¿˜æ²¡æœ‰å…³è”è‡³åŽå°é¡µé¢å¹¶æ·»åŠ æ•°æ®ï¼Œä¸è¿‡æš‚æ—¶ä¸å½±å“é¡µé¢æ˜¾ç¤ºã€‚ ä¿®æ”¹è·¯ç”±é…ç½®æ–‡ä»¶ï¼ˆpolls/urls.pyï¼‰ï¼Œæ·»åŠ å…³è” detail é¡µé¢çš„è·¯ç”±ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678from django.urls import pathfrom . import viewsapp_name = &apos;polls&apos;urlpatterns = [ path(&apos;&apos;,views.index, name=&apos;index&apos;), path(&apos;&lt;int:question_id&gt;/&apos;, views.detail, name=&apos;detail&apos;),] è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š åŽ»é™¤ç¡¬ç¼–ç  URLpolls/index.html æ¨¡æ¿ä¸­çš„é—®é¢˜è¯¦æƒ…é¡µé“¾æŽ¥å½“å‰æ˜¯å¦‚ä¸‹å½¢å¼ï¼š&lt;li&gt;&lt;a href=&quot;/polls//&quot;&gt;&lt;/a&gt;&lt;/li&gt; è¿™ç§ç¡¬ç¼–ç å½¢å¼çš„é“¾æŽ¥åœ¨åŒ…å«å¤šä¸ªåº”ç”¨çš„é¡¹ç›®ä¸­ï¼Œç›¸å¯¹è€Œè¨€å¹¶ä¸æ–¹ä¾¿ä¿®æ”¹ã€‚å› ä¸ºä¹‹å‰åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ polls/urls.py çš„ url() å‡½æ•°ä¸­é€šè¿‡ name å‚æ•°å¯¹ URL è¿›è¡Œäº†å‘½åï¼ˆpath(&#39;&lt;int:question_id&gt;/&#39;, views.detail, name=&#39;detail&#39;),ï¼‰ï¼Œæ‰€ä»¥ä¹‹å‰æ¨¡æ¿æ–‡ä»¶ä¸­çš„ç¡¬ç¼–ç é“¾æŽ¥å¯ä»¥ä¿®æ”¹ä¸ºå¦‚ä¸‹å½¢å¼çš„é“¾æŽ¥ï¼š1&lt;li&gt;&lt;a href=&quot;&#123;% url &apos;detail&apos; question.id %&#125;&quot;&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/a&gt;&lt;/li&gt; åŒæ—¶ï¼Œå¯¹äºŽåŒ…å«å¤šä¸ªåº”ç”¨çš„é¡¹ç›®ï¼Œä¸ºäº†é¿å… URL é‡åçš„æƒ…å†µå‡ºçŽ°ï¼Œå¯ä»¥ä¸º URL åç§°æ·»åŠ å‘½åç©ºé—´ã€‚å³ polls/urls.py æ–‡ä»¶ä¸­çš„å¦‚ä¸‹ä»£ç è¡Œï¼šapp_name = &#39;polls&#39; æ­¤æ—¶æ¨¡æ¿æ–‡ä»¶ï¼ˆpolls/templates/polls/index.htmlï¼‰ä¸­çš„é“¾æŽ¥å³æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š1&lt;li&gt;&lt;a href=&quot;&#123;% url &apos;polls:detail&apos; question.id %&#125;&quot;&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/a&gt;&lt;/li&gt; å®Œæ•´ index.html ä»£ç å¦‚ä¸‹ï¼š123456789&#123;% if latest_question_list %&#125; &lt;ul&gt; &#123;% for question in latest_question_list %&#125; &lt;li&gt;&lt;a href=&quot;&#123;% url &apos;polls:detail&apos; question.id %&#125;&quot;&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/a&gt;&lt;/li&gt; &#123;% endfor %&#125; &lt;/ul&gt;&#123;% else %&#125; &lt;p&gt;No polls are available.&lt;/p&gt;&#123;% endif %&#125; äºŒã€è¡¨å•ä¿®æ”¹é—®é¢˜è¯¦æƒ…é¡µçš„æ¨¡æ¿æ–‡ä»¶ï¼ˆpolls/templates/polls/detail.htmlï¼‰ï¼Œæ·»åŠ  &lt;form&gt; è¡¨å•ï¼š1234567891011&lt;h1&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/h1&gt;&#123;% if error_message %&#125;&lt;p&gt;&lt;strong&gt;&#123;&#123; error_message &#125;&#125;&lt;/strong&gt;&lt;/p&gt;&#123;% endif %&#125;&lt;form action=&quot;&#123;% url &apos;polls:vote&apos; question.id %&#125;&quot; method=&quot;post&quot;&gt;&#123;% csrf_token %&#125;&#123;% for choice in question.choice_set.all %&#125; &lt;input type=&quot;radio&quot; name=&quot;choice&quot; id=&quot;choice&#123;&#123; forloop.counter &#125;&#125;&quot; value=&quot;&#123;&#123; choice.id &#125;&#125;&quot;&gt; &lt;label for=&quot;choice&#123;&#123; forloop.counter &#125;&#125;&quot;&gt;&#123;&#123; choice.choice_text &#125;&#125;&lt;/label&gt;&lt;br&gt;&#123;% endfor %&#125;&lt;input type=&quot;submit&quot; value=&quot;Vote&quot;&gt;&lt;/form&gt; ä¸Šé¢çš„æ¨¡æ¿åœ¨ Question ä¸­çš„æ¯ä¸ª Choice å‰æ·»åŠ ä¸€ä¸ªå•é€‰æŒ‰é’®ï¼Œå…¶ value ä¸º â€œchoice.idâ€ ï¼Œå³æ¯æ¬¡é€‰æ‹©å¹¶æäº¤è¡¨å•åŽï¼Œå®ƒå°†å‘é€ä¸€ä¸ª POST æ•°æ® choice=#choice_id ã€‚ è¡¨å•çš„ action ä¸º url &#39;polls:vote&#39; question_idï¼Œä¸” action æ–¹æ³•ä¸º POSTã€‚forloop.counter ç”¨äºŽæŒ‡ç¤º for æ ‡ç­¾å½“å‰å¾ªçŽ¯çš„æ¬¡æ•°ã€‚ csrf_token ç”¨äºŽé˜²å¾¡è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ã€‚ æŽ¥ä¸‹æ¥éœ€è¦åœ¨è§†å›¾æ–‡ä»¶ï¼ˆpolls/views.pyï¼‰ä¸­æ·»åŠ å®šä¹‰ vote è§†å›¾çš„å‡½æ•°ï¼š1234567891011121314151617181920212223242526272829303132from django.http import HttpResponse, HttpResponseRedirectfrom django.shortcuts import render, get_object_or_404from django.urls import reversefrom .models import Question, Choicedef index(request): latest_question_list = Question.objects.order_by(&apos;-pub_date&apos;)[:5] context = &#123;&apos;latest_question_list&apos;: latest_question_list&#125; return render(request, &apos;polls/index.html&apos;, context)def detail(request, question_id): question = get_object_or_404(Question, pk=question_id) return render(request, &apos;polls/detail.html&apos;, &#123;&apos;question&apos;: question&#125;)def vote(request, question_id): question = get_object_or_404(Question, pk=question_id) try: selected_choice = question.choice_set.get(pk=request.POST[&apos;choice&apos;]) except (KeyError, Choice.DoesNotExist): return render(request, &apos;polls/detail.html&apos;, &#123; &apos;question&apos;: question, &apos;error_message&apos;: &quot;You didn&apos;t select a choice.&quot;, &#125;) else: selected_choice.votes += 1 selected_choice.save() return HttpResponseRedirect(reverse(&apos;polls:results&apos;, args=(question.id,)))def results(request, question_id): question = get_object_or_404(Question, pk=question_id) return render(request, &apos;polls/results.html&apos;, &#123;&apos;question&apos;: question&#125;) å…¶ä¸­ get_object_or_404() æ˜¯ä¸€ä¸ªç”¨äºŽèŽ·å–å¯¹è±¡æˆ–è€…æŠ›å‡º Http404 å¼‚å¸¸çš„å¿«æ·å‡½æ•°ã€‚HttpResponseRedirect ç”¨äºŽå°†ç”¨æˆ·é‡å®šå‘è‡³æŒ‡å®šé¡µé¢ï¼ˆæŠ•ç¥¨ç»“æžœ results é¡µï¼‰ã€‚ æ‰€ä»¥è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª polls/templates/polls/results.html æ¨¡æ¿æ–‡ä»¶ï¼š123456789&lt;h1&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/h1&gt;&lt;ul&gt;&#123;% for choice in question.choice_set.all %&#125; &lt;li&gt;&#123;&#123; choice.choice_text &#125;&#125; -- &#123;&#123; choice.votes &#125;&#125; vote&#123;&#123; choice.votes|pluralize &#125;&#125;&lt;/li&gt;&#123;% endfor %&#125;&lt;/ul&gt;&lt;a href=&quot;&#123;% url &apos;polls:detail&apos; question.id %&#125;&quot;&gt;Vote again?&lt;/a&gt; ä¿®æ”¹ polls/urls.py æ–‡ä»¶ï¼Œæ·»åŠ ä¸Š vote å’Œ results çš„è·¯ç”±é…ç½®ï¼š12345678910from django.urls import pathfrom . import viewsapp_name = &apos;polls&apos;urlpatterns = [ path(&apos;&apos;,views.index, name=&apos;index&apos;), path(&apos;&lt;int:question_id&gt;/&apos;, views.detail, name=&apos;detail&apos;), path(&apos;&lt;int:question_id&gt;/results/&apos;, views.results, name=&apos;results&apos;), path(&apos;&lt;int:question_id&gt;/vote/&apos;, views.vote, name=&apos;vote&apos;),] é¡¹ç›®è¿›è¡Œåˆ°è¿™é‡Œç®—æ˜¯åŸºæœ¬å‘Šä¸€æ®µè½äº†ã€‚ä¸ºäº†å¯ä»¥åœ¨ Django åŽå°ç³»ç»Ÿä¸­æ“ä½œ Choice æ¨¡åž‹å…³è”çš„æ•°æ®åº“ï¼Œè¿˜éœ€è¦å°† polls/admin.py æ–‡ä»¶æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12345from django.contrib import adminfrom .models import Question, Choiceadmin.site.register(Question)admin.site.register(Choice) æ­¤æ—¶è¿è¡Œæµ‹è¯•æœåŠ¡å™¨ï¼Œæœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š å‚è€ƒèµ„æ–™ Django 2.2 å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>WebDev</tag>
        <tag>Django</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Django å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€” å¿«é€Ÿå»ºç«™]]></title>
    <url>%2F2019%2F06%2F20%2Fdjango-manual-1-simple-site%2F</url>
    <content type="text"><![CDATA[Django æ˜¯ä¸€ä¸ªåŸºäºŽ MVCï¼ˆModel-View-Controllerï¼‰æ¨¡å¼çš„æœåŠ¡å™¨ç«¯çš„ Web æ¡†æž¶ï¼Œç”± Python è¯­è¨€ç¼–å†™ã€‚å…¶åˆ›å»ºä¹‹åˆä¸»è¦æ˜¯ç”¨æ¥ä¸Žå…³ç³»åž‹æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œéšç€æŠ€æœ¯çš„ä¸æ–­é©æ–°ï¼ŒDjango ä¹Ÿé€æ¸èžåˆäº†ä¼—å¤šæ›´çŽ°ä»£çš„ Web å¼€å‘è¶‹åŠ¿ã€‚ä½œä¸ºä¸€ä¸ªæˆç†Ÿçš„ Web å¼€å‘æ¡†æž¶ï¼ŒDjango æœ‰ç€ä¼—å¤šä¼ä¸šçº§çš„åº”ç”¨ï¼Œå¦‚ Instagramã€Pinterestã€National Geographic ç­‰ã€‚ Django è®¾è®¡åŽŸåˆ™ Donâ€™t Repeat Yourself (DRY) Explicit Is Better Than Implicit Loosely Coupled Architecture ä¸€ã€çŽ¯å¢ƒæ­å»ºUbuntu ç³»ç»Ÿã€‚ä¸ºäº†ä¿è¯å¤šä¸ª Python è¿è¡ŒçŽ¯å¢ƒä¹‹é—´å½¼æ­¤ä¸å—å½±å“ï¼Œè¿™é‡Œé€šè¿‡ virtualenv åˆ›å»ºç‹¬ç«‹çš„è™šæ‹Ÿå¼€å‘çŽ¯å¢ƒã€‚ ä½¿ç”¨ apt-get å‘½ä»¤å®‰è£… virtualenv ï¼š$ sudo apt-get install python3-virtualenv æˆ–è€…ä½¿ç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼ˆpip å‘½ä»¤ï¼‰å®‰è£…ï¼š$ python3 -m pip install virtualenv ä½¿ç”¨ virtualenv å‘½ä»¤åˆ›å»ºç‹¬ç«‹çš„è™šæ‹Ÿè¿è¡ŒçŽ¯å¢ƒï¼š$ virtualenv --python=python3 mydjango æ¿€æ´»åˆšåˆšåˆ›å»ºçš„è™šæ‹ŸçŽ¯å¢ƒï¼š$ source activate mydjango/bin/activate å®‰è£… Django æ¡†æž¶ï¼š$ pip install django äºŒã€åˆ›å»ºåˆå§‹é¡¹ç›®Django æ¡†æž¶å®‰è£…æˆåŠŸä»¥åŽï¼Œä¼šæä¾› django-admin å‘½ä»¤ç”¨äºŽå¸¸è§çš„ç®¡ç†æ“ä½œã€‚å¦‚ django-admin startproject å‘½ä»¤ç”¨äºŽåˆ›å»ºä¸€ä¸ªåˆå§‹é¡¹ç›®çš„éª¨æž¶ï¼š$ django-admin startproject testproject è¯¥å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º testproject æ–‡ä»¶å¤¹ï¼Œç»“æž„å¦‚ä¸‹ï¼š1234567testprojectâ”œâ”€â”€ manage.pyâ””â”€â”€ testproject â”œâ”€â”€ __init__.py â”œâ”€â”€ settings.py â”œâ”€â”€ urls.py â””â”€â”€ wsgi.py å…¶ä¸­å„æ–‡ä»¶çš„ä½œç”¨å¦‚ä¸‹ï¼š manage.pyï¼šç±»ä¼¼äºŽ django-admin å‘½ä»¤ï¼Œç”¨äºŽæ‰§è¡Œä¸€äº›é¡¹ç›®ç›¸å…³çš„ä»»åŠ¡ settings.pyï¼šDjango é¡¹ç›®çš„é…ç½®è®¾ç½® urls.pyï¼šDjango é¡¹ç›®çš„ URL æ¨¡å¼ wsgi.pyï¼šDjango é¡¹ç›®çš„ WSGI é…ç½®ã€‚WSGI æ˜¯ Django åº”ç”¨éƒ¨ç½²åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­çš„æŽ¨èæ–¹å¼ è¿è¡Œæµ‹è¯•æœåŠ¡è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œè¿è¡Œ python manage.py runserver &lt;IP:Port&gt; å‘½ä»¤å¼€å¯æµ‹è¯•æœåŠ¡ï¼Œä¸€ä¸ªå¯ä¾›è®¿é—®çš„æœ€ç®€å•çš„ Web ç«™ç‚¹å³æ­å»ºæˆåŠŸï¼š12345678910$ python manage.py runserver 0.0.0.0:8000Watching for file changes with StatReloaderPerforming system checks...System check identified no issues (0 silenced).June 20, 2019 - 09:03:29Django version 2.2.2, using settings &apos;testproject.settings&apos;Starting development server at http://0.0.0.0:8000/Quit the server with CONTROL-C. æ•ˆæžœå¦‚ä¸‹ï¼š ä¸‰ã€æ•°æ®åº“é…ç½®åˆ›å»ºæ•°æ®åº“ django å¹¶æŽˆäºˆç”¨æˆ· admin è®¿é—®æƒé™ï¼š12345678mysql&gt; CREATE DATABASE django;Query OK, 1 row affected (0.00 sec)mysql&gt; GRANT ALL ON django.* TO admin IDENTIFIED BY &apos;password&apos;;Query OK, 0 rows affected, 1 warning (0.07 sec)mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.00 sec) Django ä½¿ç”¨ SQLite3 ä½œä¸ºé»˜è®¤çš„æ•°æ®åº“å¼•æ“Žï¼Œç›¸å…³é…ç½®ä½äºŽ settings.py é…ç½®æ–‡ä»¶ä¸­ï¼š1234567...DATABASES = &#123; &apos;default&apos;: &#123; &apos;ENGINE&apos;: &apos;django.db.backends.sqlite3&apos;, &apos;NAME&apos;: os.path.join(BASE_DIR, &apos;db.sqlite3&apos;), &#125;... å¦‚éœ€ä½¿ç”¨ MySQL æ•°æ®åº“ï¼Œå°† settings.py æ–‡ä»¶ä¸­çš„å¯¹åº”éƒ¨åˆ†æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š12345678910DATABASES = &#123; &apos;default&apos;: &#123; &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;, &apos;HOST&apos;: &apos;127.0.0.1&apos;, &apos;NAME&apos;: &apos;django&apos;, &apos;PASSWORD&apos;: &apos;password&apos;, &apos;PORT&apos;: &apos;3306&apos;, &apos;USER&apos;: &apos;admin&apos;, &#125;&#125; å®‰è£… Python æ“ä½œ MySQL çš„ä¾èµ–åº“ï¼š12$ sudo apt-get install python3-dev libmysqlclient-dev$ pip install mysqlclient ä½¿ç”¨ python manage.py migrate å‘½ä»¤å®Œæˆæ•°æ®åº“è¿ç§»æ“ä½œï¼š123456789101112131415161718192021$ python manage.py migrateOperations to perform: Apply all migrations: admin, auth, contenttypes, sessionsRunning migrations: Applying contenttypes.0001_initial... OK Applying auth.0001_initial... OK Applying admin.0001_initial... OK Applying admin.0002_logentry_remove_auto_add... OK Applying admin.0003_logentry_add_action_flag_choices... OK Applying contenttypes.0002_remove_content_type_name... OK Applying auth.0002_alter_permission_name_max_length... OK Applying auth.0003_alter_user_email_max_length... OK Applying auth.0004_alter_user_username_opts... OK Applying auth.0005_alter_user_last_login_null... OK Applying auth.0006_require_contenttypes_0002... OK Applying auth.0007_alter_validators_add_error_messages... OK Applying auth.0008_alter_user_username_max_length... OK Applying auth.0009_alter_user_last_name_max_length... OK Applying auth.0010_alter_group_name_max_length... OK Applying auth.0011_update_proxy_permissions... OK Applying sessions.0001_initial... OK å››ã€Django ç®¡ç†åŽå°ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼ŒDjango å°†é¡¹ç›®ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å’ŒåŠŸèƒ½ä»¥æ¨¡å—åŒ–çš„æ–¹å¼ï¼ˆDjango Appï¼‰è¿›è¡Œç»„ç»‡ï¼Œä¸€èˆ¬ç”¨æˆ·è‡ªå®šä¹‰çš„åº”ç”¨ä½äºŽé¡¹ç›®ç›®å½•ä¸‹æŸä¸ªå•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº› App å¯ä»¥åœ¨ settings.py æ–‡ä»¶ä¸­è¿›è¡Œå¯ç”¨æˆ–ç¦ç”¨ï¼š12345678INSTALLED_APPS = [ &apos;django.contrib.admin&apos;, &apos;django.contrib.auth&apos;, &apos;django.contrib.contenttypes&apos;, &apos;django.contrib.sessions&apos;, &apos;django.contrib.messages&apos;, &apos;django.contrib.staticfiles&apos;,] ä»Žä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»»ä½•ä¸€ä¸ªåˆå§‹çš„ Django é¡¹ç›®é»˜è®¤å·²ç»å¼€å¯äº†ä¸€ä¸ªåŸºæœ¬çš„â€œåŽå°ç®¡ç†ç³»ç»Ÿâ€ï¼ˆdjango.contrib.adminï¼‰ï¼Œå¯ä»¥å¯¹é¡¹ç›®å…³è”çš„æ•°æ®åº“è¿›è¡ŒåŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥æ“ä½œã€‚ è¯¥ admin åº”ç”¨çš„è·¯ç”±å®šä¹‰åœ¨ urls.py æ–‡ä»¶ä¸­ï¼š123456from django.contrib import adminfrom django.urls import pathurlpatterns = [ path(&apos;admin/&apos;, admin.site.urls),] æ•°æ®åº“è¿ç§»æ“ä½œå®ŒæˆåŽï¼Œå¯åŠ¨æµ‹è¯•æœåŠ¡ï¼Œå³å¯è®¿é—® http://127.0.0.1:8000/admin è¿›å…¥åŽå°ç®¡ç†ç³»ç»Ÿï¼š æ­¤æ—¶ç”¨äºŽç™»å½•çš„åŽå°ç®¡ç†å‘˜è¿˜æœªåˆ›å»ºï¼Œå¯ä»¥ä½¿ç”¨ python manage.py createsuperuser å‘½ä»¤ç”Ÿæˆç®¡ç†å‘˜è´¦æˆ·ï¼š123456$ python manage.py createsuperuserç”¨æˆ·å (leave blank to use &apos;starky&apos;):ç”µå­é‚®ä»¶åœ°å€:Password:Password (again):Superuser created successfully. ç™»å½•æˆåŠŸåŽæ•ˆæžœå¦‚ä¸‹ï¼š å³æ— éœ€ç¼–å†™ä»»ä½•ä¸šåŠ¡ä»£ç ï¼Œåªæ­å»º Django çŽ¯å¢ƒå³å¯ç”Ÿæˆä¸€ä¸ªåŸºæœ¬çš„â€œåŽå°ç®¡ç†ç³»ç»Ÿâ€ã€‚ å‚è€ƒèµ„æ–™Beginning Django]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>WebDev</tag>
        <tag>Django</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ laravel-admin é…ç½®åŽå°ç®¡ç†ç³»ç»Ÿ]]></title>
    <url>%2F2019%2F06%2F08%2Fbuild-management-console-with-laravel-admin%2F</url>
    <content type="text"><![CDATA[å†…å®¹æœ‰ç‚¹å¤šï¼Œå°±ä¸è¯´åˆ«çš„äº†ã€‚ã€‚éœ€è¦ä¸€ä¸ªç®€å•çš„åŽå°ç®¡ç†ç³»ç»Ÿï¼Œå¯¹æŽ¥æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯è¡¨ï¼Œå®ŒæˆåŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥æ“ä½œã€‚æœ€å¥½æ”¯æŒæƒé™ç®¡ç†ï¼›æœ‰ä¾¿æ·çš„æŽ¥å£å¯ä¾›è°ƒç”¨ï¼ˆä¸éœ€è¦æ·±åº¦å®šåˆ¶ï¼‰ï¼›å‰ç«¯ç•Œé¢å’Œäº¤äº’ç¾Žè§‚ç®€æ´ï¼Œè¶³å¤Ÿâ€œçŽ°ä»£åŒ–â€ï¼›æž¶æž„æ˜Žæ™°ï¼Œé…ç½®ç®€å•ï¼Œå¯å¿«é€Ÿæˆåž‹ç­‰ç­‰ã€‚å‡ ç»æŸ¥æ‰¾ï¼Œæ„Ÿè§‰ laravel-admin è¿™ä¸ªæ¡†æž¶è¿˜ä¸é”™ã€‚è™½è¯´æ–‡æ¡£ç®—ä¸ä¸Šå®Œå–„ï¼Œå°è¸©å‡ å‘ï¼Œæ²¡æ€Žä¹ˆå¤ªè´¹äº‹å°±æž„å»ºå¥½äº†ã€‚å€¼å¾—è®°å½•ä¸€ä¸‹ã€‚ ä¸€ã€å®‰è£… Laravel çŽ¯å¢ƒlaravel-admin éœ€è¦ PHP 7+ å’Œ Lavavel 5.5+ ï¼Œæˆ‘å½“å‰ä½¿ç”¨çš„æ˜¯ VirtualBox è™šæ‹Ÿæœºé‡Œçš„ Ubuntu 19.04 ç³»ç»Ÿï¼Œé…ç½®èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚Laravel å®˜æ–¹çš„å®šä¹‰æ˜¯ The PHP Framework For Web Artisans ï¼Œä¼˜é›…å’Œå¿«é€Ÿæˆåž‹ã€‚ä¾èµ–äºŽ PHP &gt;= 7.1.3 å’Œä¸€äº› PHP æ‰©å±•ç»„ä»¶ã€‚å¯ä»¥ä½¿ç”¨ Linux ç³»ç»Ÿè‡ªå¸¦çš„åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo apt-get install php7.2 php7.2-bcmath php7.2-json php7.2-mbstring php7.2-mysql php7.2-xml php7.2-zip php7.2-common å®‰è£… composer å¹¶é…ç½®å›½å†…é•œåƒComposer æ˜¯ PHP è¯­è¨€çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºŽ Node.js ä¸‹çš„ npm ã€‚åŽé¢éœ€è¦ç”¨åˆ°çš„ Laravel ã€laravel-admin åŠå…¶ç›¸å…³çš„ä¾èµ–é¡¹éƒ½å¯ä»¥é€šè¿‡ composer å‘½ä»¤å®‰è£…ã€‚$ sudo apt-get install composer ä¸ºäº†æé«˜è®¿é—®é€Ÿåº¦ï¼Œå¯ä»¥æŠŠ composer çš„é•œåƒæºæ”¹ä¸ºå›½å†…ç‰ˆæœ¬ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼š$ composer config -g repo.packagist composer https://packagist.laravel-china.org å®‰è£… Laravel å¹¶åˆå§‹åŒ–é¡¹ç›®ä½¿ç”¨ composer å‘½ä»¤å®‰è£… Laravel ï¼šcomposer global require laravel/installer å°† Laravel å®‰è£…è·¯å¾„æ·»åŠ åˆ° PATH çŽ¯å¢ƒå˜é‡ï¼š$ echo export PATH=&quot;$PATH:~/.config/composer/vendor/bin&quot; &gt;&gt; ~/.zshrc &amp;&amp; source ~/.zshrc åˆå§‹åŒ– Laravel é¡¹ç›®ï¼š$ laravel new admin ä»¥ä¸Šæ­¥éª¤å®ŒæˆåŽï¼Œè¿›å…¥ admin é¡¹ç›®ç›®å½•ï¼Œè¿è¡Œ $ php artisan serve å‘½ä»¤å³å¯å¼€å¯ä¸€ä¸ªæœ€åŸºæœ¬çš„ Laravel ç«™ç‚¹ã€‚ é…ç½®æ•°æ®åº“å®‰è£… mysql æ•°æ®åº“ï¼š$ sudo apt-get install mysql-server åˆ›å»ºæ•°æ®åº“ admin å¹¶æŽˆæƒç»™æµ‹è¯•è´¦æˆ·ï¼ˆç”¨æˆ·å test_user ï¼Œå¯†ç  test_passwordï¼‰ï¼š12345678mysql&gt; CREATE DATABASE admin;Query OK, 1 row affected (0.00 sec)mysql&gt; GRANT ALL ON admin.* to test_user IDENTIFIED BY &apos;test_password&apos;;Query OK, 0 rows affected, 1 warning (0.00 sec)mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.00 sec) ä¿®æ”¹æ•°æ®åº“é…ç½®æ–‡ä»¶ç¼–è¾‘ config/database.php æ–‡ä»¶ï¼ˆå·²ç»é»˜è®¤ä½¿ç”¨ mysql æ•°æ®åº“ï¼‰ï¼Œä¿®æ”¹ mysql é…ç½®éƒ¨åˆ†ï¼Œå°† url æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š&#39;url&#39; =&gt; env(&#39;DATABASE_URL&#39;, &#39;mysql://test_user:test_password@127.0.0.1/admin&#39;),ï¼ˆæ•°æ®åº“ URL çš„æ ¼å¼ä¸º mysql://ç”¨æˆ·å:å¯†ç @IPåœ°å€/æ•°æ®åº“åï¼‰ äºŒã€å®‰è£… laravel-adminæ•°æ®åº“é…ç½®å®ŒæˆåŽï¼Œå³å¯æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®‰è£…é…ç½® laravel-admin ã€‚ åœ¨ admin ç›®å½•ä¸‹ï¼Œä½¿ç”¨ composer å‘½ä»¤å®‰è£… laravel-admin ï¼š$ composer require encore/laravel-admin å‘å¸ƒèµ„æºï¼š$ php artisan vendor:publish --provider=&quot;Encore\Admin\AdminServiceProvider&quot; ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®Œæˆå®‰è£…ï¼š$ php artisan admin:install è¿è¡ŒæœåŠ¡æŸ¥çœ‹æ•ˆæžœï¼š$ php artisan serve è®¿é—® http://127.0.0.1:8000/admin ï¼Œä½¿ç”¨ç”¨æˆ·å admin å’Œå¯†ç  admin ç™»å½•ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š å®‰è£…å®ŒæˆåŽï¼Œlaravel-admin æ‰€æœ‰çš„é…ç½®éƒ½åœ¨ config/admin.php æ–‡ä»¶ä¸­ï¼ˆå¦‚ç«™ç‚¹åç§°ã€logoã€ç™»å½•ç•Œé¢çš„èƒŒæ™¯ç­‰ï¼‰ï¼Œè€Œé¡¹ç›®æ–‡ä»¶çš„å®‰è£…ç›®å½•ä¸º app/Admin ï¼Œç›®å½•ç»“æž„å¦‚ä¸‹ï¼š123456app/Adminâ”œâ”€â”€ Controllersâ”‚ â”œâ”€â”€ ExampleController.phpâ”‚ â””â”€â”€ HomeController.phpâ”œâ”€â”€ bootstrap.phpâ””â”€â”€ routes.php å…¶ä¸­ app/Admin/routes.php æ–‡ä»¶ç”¨æ¥é…ç½®åŽå°è·¯ç”±ï¼›app/Admin/bootstrap.php æ˜¯ laravel-admin çš„å¯åŠ¨æ–‡ä»¶ï¼›app/Admin/Controllers ç›®å½•ç”¨æ¥å­˜æ”¾åŽå°æŽ§åˆ¶å™¨æ–‡ä»¶ï¼Œè¯¥ç›®å½•ä¸‹çš„HomeController.php æ–‡ä»¶æ˜¯åŽå°é¦–é¡µçš„æ˜¾ç¤ºæŽ§åˆ¶å™¨ã€‚ ä¸‰ã€ä¸€äº›å¿…è¦çš„é…ç½®é¡¹ç›®è¿›è¡Œåˆ°è¿™é‡Œï¼Œå·²ç»å…·å¤‡äº†ä¸€ä¸ªåŽå°ç®¡ç†ç³»ç»Ÿçš„æ‰€æœ‰åŸºæœ¬è¦ç´ ï¼Œåªæ˜¯åœ¨æ·»åŠ æˆ–è€…ä¿®æ”¹ç”¨æˆ·æ—¶ï¼Œä¼šæŠ¥å‡ºä¸‹å›¾æ‰€ç¤ºçš„ Config error ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ª Disk é…ç½®ï¼š ç¼–è¾‘ config/filesystems.php æ–‡ä»¶ï¼Œåœ¨ &#39;disks&#39; é…ç½®ä¸‹æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š123456&apos;admin&apos; =&gt; [ &apos;driver&apos; =&gt; &apos;local&apos;, &apos;root&apos; =&gt; public_path(&apos;upload&apos;), &apos;visibility&apos; =&gt; &apos;public&apos;, &apos;url&apos; =&gt; env(&apos;APP_URL&apos;).&apos;/public/puload/&apos;, ], ä¸­æ–‡é…ç½®é…ç½®ç•Œé¢è¯­è¨€ä¸ºä¸­æ–‡å¯ä»¥ä¿®æ”¹ config/app.php æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„ locale =&gt; en æ”¹ä¸º locale =&gt; zh-CN å³å¯ã€‚ å…¶ä»–å¸¸ç”¨çš„é…ç½®å¦‚ç«™ç‚¹åç§°ã€é¡µé¢å¸ƒå±€ç­‰å¯ä»¥ç¼–è¾‘ config/admin.php æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­çš„æ³¨é‡Šä¿¡æ¯éžå¸¸è¯¦ç»†ï¼Œæ ¹æ®éœ€æ±‚ç›´æŽ¥ä¿®æ”¹å³å¯ã€‚ å››ã€ç»‘å®šè‡ªå·±çš„æ•°æ®åº“å‰é¢ç”Ÿæˆçš„ç®—æ˜¯æ¼”ç¤ºç”¨çš„ç¤ºä¾‹é¡µé¢ï¼Œå¦‚æžœéœ€è¦ç»‘å®šå’Œç®¡ç†è‡ªå·±çš„æ•°æ®åº“è¡¨æ ¼ï¼Œæ“ä½œä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ åˆ›å»ºæ•°æ®åº“è¡¨æ ¼åœ¨ä¹‹å‰åˆ›å»ºçš„ admin æ•°æ®åº“ä¸­æ·»åŠ åä¸º employee çš„è¡¨æ ¼ï¼š12345678mysql&gt; CREATE TABLE employee ( -&gt; id int(6) unsigned AUTO_INCREMENT PRIMARY KEY, -&gt; number int(6) unsigned NOT NULL UNIQUE, -&gt; name varchar(10) NOT NULL, -&gt; mail varchar(60) UNIQUE, -&gt; password varchar(30), -&gt; department varchar(40) NOT NULL DEFAULT &apos;&apos; -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; åˆ›å»ºæ¨¡åž‹æ–‡ä»¶$ php artisan make:model Employee ä¸Šè¿°å‘½ä»¤ä¼šåˆ›å»º app/Employee.php æ¨¡åž‹æ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š1234567891011&lt;?phpnamespace App;use Illuminate\Database\Eloquent\Model;class Employee extends Model&#123; protected $table = &apos;employee&apos;; public $timestamps = false;&#125; PSï¼šå…³äºŽæ¨¡åž‹çš„ä½¿ç”¨å¯ä»¥å‚è€ƒ Laravel å®˜æ–¹æ–‡æ¡£ æ·»åŠ æŽ§åˆ¶å™¨é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªå¯¹æŽ¥ app/employee æ¨¡åž‹çš„æŽ§åˆ¶å™¨ï¼š12$ php artisan admin:make EmployeeController --model=App\\EmployeeApp\Admin\Controllers\EmployeeController created successfully. æ·»åŠ è·¯ç”±ç¼–è¾‘è·¯ç”±é…ç½®æ–‡ä»¶ app/Admin/routers.php ï¼Œåœ¨æ ¹ URL çš„è·¯ç”±ä¸‹æ·»åŠ å¦‚ä¸‹ä¸€è¡Œå†…å®¹ï¼š$router-&gt;resource(&#39;employee&#39;, EmployeeController::class); æ·»åŠ ç½‘é¡µèœå•è®¿é—® http://127.0.0.1:8000/admin/auth/menu ï¼Œæ·»åŠ é¡µé¢å·¦ä¾§çš„èœå•é¡¹ï¼Œç”¨äºŽæŒ‡å‘å‰é¢åˆ›å»ºçš„åŽå°æ•°æ®ã€‚ ä¸Šè¿°æ­¥éª¤å®ŒæˆåŽï¼Œè®¿é—® http://127.0.0.1:8000/admin/employee ï¼Œæœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š äº”ã€ä¼˜åŒ–ç­›é€‰å’Œå¯†ç æ˜¾ç¤ºä¸Šé¢å®Œæˆçš„é¡¹ç›®ä¸­ï¼Œç­›é€‰æŒ‰é’®åªæ”¯æŒé€šè¿‡ ID æœç´¢ï¼Œå¯†ç ä¹Ÿæ˜¯ç›´æŽ¥æ˜¾ç¤ºã€‚è¿™äº›å’Œè¡¨æ ¼ç›¸å…³çš„è¡Œä¸ºéƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹ app/Admin/Controllers/EmployeeController.php æ–‡ä»¶è¿›è¡ŒæŽ§åˆ¶ã€‚ ä¿®æ”¹ EmployeeController.php æ–‡ä»¶ä¸­å¯¹è¡¨æ ¼ç›¸å…³è¡Œä¸ºçš„å®šä¹‰ï¼š123456789101112131415161718192021222324252627protected function grid()&#123; $grid = new Grid(new Employee); // ä¸æ˜¾ç¤º ID åˆ— //$grid-&gt;id(&apos;ID&apos;);^M $grid-&gt;number(&apos;å·¥å·&apos;);^M $grid-&gt;name(&apos;å§“å&apos;);^M $grid-&gt;mail(&apos;é‚®ç®±&apos;);^M // éšè—å¯†ç åˆ— //$grid-&gt;password(&apos;Password&apos;);^M $grid-&gt;department(&apos;éƒ¨é—¨&apos;); $grid-&gt;filter(function($filter)&#123; // åŽ»æŽ‰é»˜è®¤çš„ id è¿‡æ»¤å™¨ $filter-&gt;disableIdFilter(); // æ·»åŠ æ–°çš„å­—æ®µè¿‡æ»¤å™¨ï¼ˆé€šè¿‡å·¥å·è¿‡æ»¤ï¼‰ $filter-&gt;like(&apos;number&apos;, &apos;å·¥å·&apos;); &#125;); return $grid;&#125; å®žé™…æ•ˆæžœå¦‚ä¸‹ï¼š å…­ã€nginx æœåŠ¡å™¨é…ç½®é¦–å…ˆéœ€è¦ç»ˆæ­¢é»˜è®¤å®‰è£…çš„ Apache2 æœåŠ¡å¹¶å®‰è£… nginx å’Œ php-fpmï¼š123$ sudo systemctl stop apache2$ sudo systemctl disable apache2$ sudo apt-get install nginx php7.2-fpm åˆ›å»ºæ–°çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼ˆ/etc/nginx/sites-available/admin.confï¼‰å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š123456789101112131415161718192021222324252627282930313233server &#123; listen 80; server_name 127.0.0.1; root &lt;your-project-path&gt;/public; add_header X-Frame-Options &quot;SAMEORIGIN&quot;; add_header X-XSS-Protection &quot;1; mode=block&quot;; add_header X-Content-Type-Options &quot;nosniff&quot;; index index.html index.htm index.php; charset utf-8; location / &#123; try_files $uri $uri/ /index.php?$query_string; &#125; location = /favicon.ico &#123; access_log off; log_not_found off; &#125; location = /robots.txt &#123; access_log off; log_not_found off; &#125; error_page 404 /index.php; location ~ \.php$ &#123; fastcgi_pass unix:/var/run/php/php7.2-fpm.sock; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name; include fastcgi_params; &#125; location ~ /\.(?!well-known).* &#123; deny all; &#125;&#125; ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨æ–°çš„ç«™ç‚¹é…ç½®å¹¶é‡å¯ nginx æœåŠ¡ï¼š12$ sudo ln -s /etc/nginx/sites-available/admin.conf /etc/nginx/sites-enabled/$ sudo systemctl restart nginx éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œapp/storage ç›®å½•çš„å±žä¸»åº”è¯¥ä¸Žè¿è¡Œ nginx æœåŠ¡çš„ç”¨æˆ·ï¼ˆé»˜è®¤ä¸º www-dataï¼‰ä¸€è‡´ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹ï¼š$ sudo chown -R www-data storage å‚è€ƒèµ„æ–™laravel-admin å®˜æ–¹æ–‡æ¡£Laravel å®˜ç½‘]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Mysql</tag>
        <tag>Program</tag>
        <tag>Laravel</tag>
        <tag>laravel-admin</tag>
        <tag>Web</tag>
        <tag>PHP</tag>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘èŽ“æ´¾ä½¿ç”¨ snowboy é…ç½®è¯­éŸ³å”¤é†’]]></title>
    <url>%2F2019%2F05%2F17%2Fpython-snowboy-voice-arousal%2F</url>
    <content type="text"><![CDATA[è¯­éŸ³å”¤é†’ç®—æ˜¯è¯­éŸ³è¯†åˆ«é¢†åŸŸé‡Œæœ€åŸºç¡€çš„åº”ç”¨ï¼Œå…·ä½“çš„åœºæ™¯å¦‚ Android æ‰‹æœºé‡Œçš„ â€œOK, Googleâ€ æˆ–è€…è‹¹æžœè®¾å¤‡é‡Œçš„ â€œHey, Siriâ€ã€‚ç®€å•æ¥è¯´å°±æ˜¯åœ¨åŽå°é™é»˜åœ°è¿è¡Œç€ä¸€ä¸ªå ç”¨è¾ƒå°‘ç³»ç»Ÿèµ„æºçš„æœåŠ¡ï¼ˆè¯­éŸ³è¯†åˆ«ç»„ä»¶ï¼‰ï¼Œè¯¥ç»„ä»¶ä¸€ç›´å¤„äºŽç›‘è§†éº¦å…‹é£Žè¾“å…¥çš„çŠ¶æ€ï¼Œå¦‚æžœæœ‰æ£€æµ‹åˆ°ç‰¹å®šçš„è¯­éŸ³è¾“å…¥ï¼ˆå³å”¤é†’è¯æˆ–â€œçƒ­è¯â€ï¼‰ï¼Œåˆ™æ¿€æ´»ä¸Žä¹‹ç»‘å®šçš„æŸä¸ªç¨‹åºâ€œå¼€å…³â€ã€‚ç›¸å½“äºŽä¸€ä¸ªç®€åŒ–ç‰ˆçš„è¯­éŸ³åŠ©æ‰‹å§ï¼Œåªå¯¹æŸä¸€ä¸ªç‰¹å®šçš„è¯æ±‡è¿›è¡Œå“åº”ï¼Œè¯†åˆ«åŽä¹Ÿåªå®ŒæˆæŸä¸€ä»¶æŒ‡å®šçš„ä»»åŠ¡ã€‚å¦‚æžœè¯´åŒè¯­éŸ³åŠ©æ‰‹çš„äº¤äº’æ˜¯ä¸€æ®µæŒç»­çš„äº¤æµï¼Œé‚£ä¹ˆè¯­éŸ³å”¤é†’å³å¯ä½œä¸ºè¿™ç§è¿žç»­äº¤æµçš„å…¥å£ï¼ˆæ‰“æ‹›å‘¼ï¼‰ã€‚ snowboy æ˜¯ä¸€ä¸ªå¼€æºçš„ã€è½»é‡çº§è¯­éŸ³å”¤é†’å¼•æ“Žï¼Œå¯ä»¥é€šè¿‡å®ƒå¾ˆè½»æ¾åœ°åˆ›å»ºå±žäºŽè‡ªå·±çš„ç±»ä¼¼â€œhey, Siriâ€ çš„å”¤é†’è¯ã€‚å®ƒçš„ä¸»è¦ç‰¹æ€§å¦‚ä¸‹ï¼š é«˜åº¦å¯å®šåˆ¶æ€§ã€‚å¯è‡ªç”±åˆ›å»ºå’Œè®­ç»ƒå±žäºŽè‡ªå·±çš„å”¤é†’è¯ å§‹ç»ˆå€¾å¬ã€‚å¯ç¦»çº¿ä½¿ç”¨ï¼Œæ— éœ€è”ç½‘ï¼Œä¿æŠ¤éšç§ã€‚ç²¾ç¡®åº¦é«˜ï¼Œä½Žå»¶è¿Ÿ è½»é‡å¯åµŒå…¥ã€‚è€—è´¹èµ„æºéžå¸¸ä½Žï¼ˆå•æ ¸ 700MHz æ ‘èŽ“æ´¾åªå ç”¨ 10% CPUï¼‰ å¼€æºè·¨å¹³å°ã€‚å¼€æ”¾æºä»£ç ï¼Œæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œå¯ç»‘å®šå¤šç§ç¼–ç¨‹è¯­è¨€ è¯¦ç»†çœ‹äº†å®˜ç½‘æä¾›çš„å®‰è£…é…ç½®æ•™ç¨‹ï¼ˆå·²ç»å¾ˆä¹…æ²¡æ›´æ–°ï¼Œæœ‰ç‚¹è¿‡äºŽç¹çäº†ï¼‰ï¼Œå‡ ç•ªå°è¯•ä¹‹åŽï¼Œæ„Ÿè§‰ä¸‹é¢çš„ä»‹ç»ç®—æ˜¯æœ€æ–°ä¹Ÿç›¸å¯¹æœ€ç®€å•çš„æ–¹æ³•äº†å§ã€‚ PSï¼šåªé’ˆå¯¹ Linux ç³»ç»Ÿï¼ˆåŒ…å«æ ‘èŽ“æ´¾ï¼‰ï¼Œå…¶ä»–å¹³å°å¯å‚è€ƒ Github ä¸€ã€èŽ·å–æºä»£ç å¹¶ç¼–è¯‘å®‰è£…ä¾èµ–æ ‘èŽ“æ´¾åŽŸç”Ÿçš„éŸ³é¢‘è®¾å¤‡æ˜¯ä¸æ”¯æŒè¯­éŸ³è¾“å…¥çš„ï¼ˆæ— æ³•å½•éŸ³ï¼‰ï¼Œéœ€è¦åœ¨ç½‘ä¸Šè´­ä¹°ä¸€æ”¯å…é©±åŠ¨çš„USBéŸ³é¢‘é©±åŠ¨ï¼ˆä¾¿æºå¼çš„å’Œ U ç›˜å·®ä¸å¤šï¼‰ï¼Œä¸€èˆ¬æ’ä¸Šå³å¯ç›´æŽ¥ä½¿ç”¨ã€‚å»ºè®®å®‰è£…ä¸‹ pulseaudio è½¯ä»¶ï¼Œå‡å°‘éŸ³é¢‘é…ç½®çš„æ­¥éª¤ï¼š$ sudo apt-get install pulseaudio å®‰è£… sox è½¯ä»¶æµ‹è¯•å½•éŸ³ä¸Žæ’­æ”¾åŠŸèƒ½ï¼š$ sudo apt-get install sox å®‰è£…å®ŒæˆåŽè¿è¡Œ sox -d -d å‘½ä»¤ï¼Œå¯¹ç€éº¦å…‹é£Žè¯´è¯ï¼Œç¡®è®¤å¯ä»¥å¬åˆ°è‡ªå·±çš„å£°éŸ³ã€‚ å®‰è£…å…¶ä»–è½¯ä»¶ä¾èµ–ï¼š å®‰è£… PyAudioï¼š$ sudo apt-get install python3-pyaudio å®‰è£… SWIGï¼ˆ&gt;3.0.10)ï¼š$ sudo apt-get install swig å®‰è£… ATLSï¼š$ sudo apt-get install libatls-base-dev ç¼–è¯‘æºä»£ç èŽ·å–æºä»£ç ï¼š$ git clone https://github.com/Kitt-AI/snowboy.gitç¼–è¯‘ Python3 ç»‘å®šï¼š$ cd snowboy/swig/Python3 &amp;&amp; make æµ‹è¯•ï¼šè¿›å…¥å®˜æ–¹ç¤ºä¾‹ç›®å½• snowboy/examples/Python3 å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š$ python3 demo.py resources/models/snowboy.umdlï¼ˆ å‘½ä»¤ä¸­çš„ snowboy.umdl æ–‡ä»¶å³è¯­éŸ³è¯†åˆ«æ¨¡åž‹ï¼‰ ç„¶åŽå¯¹ç€éº¦å…‹é£Žæ¸…æ™°åœ°è®²å‡ºâ€œsnowboyâ€ï¼Œå¦‚æžœå¯ä»¥å¬åˆ°â€œæ»´â€çš„å£°éŸ³ï¼Œåˆ™å®‰è£…é…ç½®æˆåŠŸã€‚å‘½ä»¤è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š PSï¼šå®˜æ–¹æºä»£ç ä½¿ç”¨ Python3 æµ‹è¯•æœ‰æŠ¥é”™ï¼Œç»æµ‹è¯•éœ€ä¿®æ”¹ snowboy/examples/Python3 ç›®å½•ä¸‹çš„ snowboydecoder.py æ–‡ä»¶ã€‚å°†ç¬¬ 5 è¡Œä»£ç  from * import snowboydetect æ”¹ä¸º import snowboydetect å³å¯ç›´æŽ¥è¿è¡Œã€‚ äºŒã€è®¾ç½®è‡ªå·±çš„å”¤é†’è¯å¯å°†åŒ…å«è‡ªå®šä¹‰å”¤é†’è¯çš„éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ è‡³ snowboy å®˜ç½‘ï¼ˆéœ€è¦ç™»å½•ï¼‰ï¼Œä»¥è®­ç»ƒç”Ÿæˆè‡ªå·±å–œæ¬¢çš„è¯­éŸ³æ¨¡åž‹ã€‚éœ€è¦ä¸Šä¼ çš„éŸ³é¢‘æ–‡ä»¶æ•°é‡ä¸º 3 ä¸ªï¼Œwav æ ¼å¼ã€‚æˆ‘è¯•è¿‡ç›´æŽ¥åœ¨çº¿å½•åˆ¶ï¼Œè²Œä¼¼æœ‰ Bug ã€‚ã€‚ã€‚ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘æµè§ˆå™¨çš„é—®é¢˜ï¼‰ è®­ç»ƒå®Œæˆå¹¶æµ‹è¯•é€šè¿‡åŽï¼Œå³å¯ä¸‹è½½ PMDL åŽç¼€çš„æ¨¡åž‹æ–‡ä»¶äº†ã€‚ #####æµ‹è¯•å°†ä»¥ä¸‹æ–‡ä»¶å¤åˆ¶åˆ°è‡ªå·±çš„é¡¹ç›®ç›®å½•ä¸‹ï¼š ä¸Šä¸€æ­¥ä¸­ä¸‹è½½å¥½çš„ model.pmdl æ¨¡åž‹æ–‡ä»¶ ä¹‹å‰ snowboy/swig/Python3 ç›®å½•ä¸‹ç¼–è¯‘å¥½çš„ _snowboydetect.so åº“ snowboy/examples/Python3 ç›®å½•ä¸‹çš„ demo.pyã€snowboydecoder.pyã€snowboydetect.py æ–‡ä»¶ä»¥åŠ resources ç›®å½• åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ $ python3 demo.py model.pmdl å¹¶ä½¿ç”¨è‡ªå·±çš„å”¤é†’è¯è¿›è¡Œæµ‹è¯• ä¸‰ã€è‡ªå®šä¹‰å“åº”å®˜æ–¹æä¾›çš„ç¤ºä¾‹ demo.py æ–‡ä»¶çš„æºä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233import snowboydecoderimport sysimport signalinterrupted = Falsedef signal_handler(signal, frame): global interrupted interrupted = Truedef interrupt_callback(): global interrupted return interruptedif len(sys.argv) == 1: print(&quot;Error: need to specify model name&quot;) print(&quot;Usage: python demo.py your.model&quot;) sys.exit(-1)model = sys.argv[1]# capture SIGINT signal, e.g., Ctrl+Csignal.signal(signal.SIGINT, signal_handler)detector = snowboydecoder.HotwordDetector(model, sensitivity=0.5)print(&apos;Listening... Press Ctrl+C to exit&apos;)# main loopdetector.start(detected_callback=snowboydecoder.play_audio_file, interrupt_check=interrupt_callback, sleep_time=0.03)detector.terminate() é€šè¿‡é˜…è¯»ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºå”¤é†’è¯è¯†åˆ«æˆåŠŸä»¥åŽï¼Œç¨‹åºå“åº”çš„å…·ä½“å†…å®¹ç”±ç¨‹åºæœ«å°¾ detector.start() å‡½æ•°çš„ detected_callback å‚æ•°æŒ‡å®šã€‚å³é‡æ–°ç»‘å®š detected_callback å¯¹åº”çš„å‡½æ•°ï¼Œå¯æ”¹å˜ç¨‹åºæœ€ç»ˆçš„å“åº”ã€‚å¦‚ï¼š123456789101112131415161718192021222324252627282930313233343536import snowboydecoderimport sysimport signalinterrupted = Falsedef signal_handler(signal, frame): global interrupted interrupted = Truedef interrupt_callback(): global interrupted return interrupteddef detected(): print(&quot;Great! I have recognized your words.\n&quot;)if len(sys.argv) == 1: print(&quot;Error: need to specify model name&quot;) print(&quot;Usage: python demo.py your.model&quot;) sys.exit(-1)model = sys.argv[1]# capture SIGINT signal, e.g., Ctrl+Csignal.signal(signal.SIGINT, signal_handler)detector = snowboydecoder.HotwordDetector(model, sensitivity=0.5)print(&apos;Listening... Press Ctrl+C to exit&apos;)# main loopdetector.start(detected_callback=detected, interrupt_check=interrupt_callback, sleep_time=0.03)detector.terminate() æ³¨æ„æ·»åŠ çš„ detected å‡½æ•°ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼š æ›´å¤æ‚çš„åº”ç”¨å½¢å¼ï¼ˆå¦‚æŽ§åˆ¶ LED å°ç¯ç­‰ï¼‰ä¹Ÿæ˜¯åŸºæœ¬ä¸Šä¸€æ ·çš„æ€è·¯ï¼Œå…·ä½“ç¤ºä¾‹ä»£ç å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚ å‚è€ƒèµ„æ–™snowboy Githubsnowboy å®˜ç½‘snowboy å®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Voice</tag>
        <tag>Intelligence</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Termux è¯¦è§£â€”â€” Android å¹³å°ä¸Šå®Œç¾Žç§»æ¤çš„ Linux å·¥å…·é›†]]></title>
    <url>%2F2019%2F05%2F15%2FTermux-app-details%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘æ¢äº†æ–°æ‰‹æœºï¼Œç³»ç»Ÿæ˜¯åŸºäºŽ Android Pieï¼ˆå³ Android 9ï¼‰å®šåˆ¶çš„ MIUI 10 ã€‚Android ç›¸å¯¹è€Œè¨€ç®—å¾—ä¸Šæ˜¯æ¯”è¾ƒå¼€æ”¾çš„å¹³å°ï¼Œå¦‚æ­¤è¯´æ¥ï¼Œä¸è¶æ­¤æœºä¼šä¹±æžä¸€ä¸‹éš¾å…æœ‰äº›è¯´ä¸è¿‡åŽ»ã€‚ã€‚ã€‚é¢ï¼Œæ–°æ‰‹æœºï¼Œåˆ·æœºRootæ¥ä¸€å¥—æœ‰ç‚¹èˆä¸å¾—ï¼Œå¥½åœ¨æœ‰ Termux è¿™ä¸ªåº”ç”¨ã€‚æ¥ï¼Œè€ä¸€è€çœ‹ä¸ŠåŽ»èƒ½å¤Ÿå½°æ˜¾â€œç¡¬æ ¸â€èŒƒå„¿çš„ä¸œè¥¿ã€‚ ä¸€ã€ç®€ä»‹Termux æ˜¯ Android å¹³å°ä¸Šçš„ä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œå®ƒå°†ä¼—å¤š Linux ä¸Šè¿è¡Œçš„è½¯ä»¶å’Œå·¥å…·è¿‘ä¹Žå®Œç¾Žçš„ç§»æ¤åˆ°äº†æ‰‹æœºç«¯ã€‚æ— éœ€ä»»ä½•å¤æ‚çš„å®‰è£…å’Œé…ç½®è¿‡ç¨‹ï¼Œè½¯ä»¶è£…å¥½ä»¥åŽå³ä¼šè‡ªåŠ¨é…ç½®ä¸€ä¸ªåŸºæœ¬çš„è¿è¡ŒçŽ¯å¢ƒï¼Œç”¨ä»¥æ‰§è¡Œä¸€äº›å¸¸è§çš„ Linux å‘½ä»¤ã€‚æœ€ä¸ºå…³é”®çš„æ˜¯ï¼Œå®ƒè¿˜å†…ç½®äº†åŠŸèƒ½å¥å…¨çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºŽ Ubuntu ç³»ç»Ÿçš„ apt ï¼ˆæˆ– pkgï¼‰å‘½ä»¤å®‰è£…é¢å¤–çš„è½¯ä»¶åŒ…ã€‚ ä¹‹æ‰€ä»¥ç§°å®ƒä¸ºâ€œæ¨¡æ‹Ÿå™¨â€è€Œéžâ€œè™šæ‹Ÿæœºâ€ï¼Œæ˜¯å› ä¸ºå®ƒå¹¶éžåƒ PC ç«¯çš„ VirtualBox ç­‰è™šæ‹Ÿæœºè½¯ä»¶é‚£æ ·ï¼Œåœ¨å®¿ä¸»æœºä¸­è™šæ‹Ÿå‡ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹ä¸”å®Œæ•´çš„ç³»ç»ŸçŽ¯å¢ƒï¼Œè€Œæ˜¯ç±»ä¼¼äºŽ Mingw ç­‰è½¯ä»¶ï¼Œåªæ˜¯æä¾›ä¸€ä¸ªæŽ¥å£ï¼Œä»¥å®‰è£…å’Œè¿è¡Œé¢å‘æ–°çŽ¯å¢ƒäº¤å‰ç¼–è¯‘åŽçš„ç¨‹åºã€‚ ä¹Ÿå¯ä»¥å°†æ­¤æ—¶çš„æ‰‹æœºçœ‹ä½œæ˜¯å®‰è£…äº† Linux ç³»ç»Ÿçš„æ ‘èŽ“æ´¾ï¼Œå¯ä»¥åƒ PC ç«¯ç³»ç»Ÿé‚£æ ·è¿è¡Œå„ç§ç±»åž‹çš„è½¯ä»¶ï¼Œåªä¸è¿‡è¿™äº›è½¯ä»¶éƒ½æ˜¯é’ˆå¯¹ç‰¹å®šçš„ CPU æž¶æž„å’Œç¡¬ä»¶è®¾å¤‡ç¼–è¯‘è¿‡çš„ï¼ˆäº¤å‰ç¼–è¯‘æˆ–è€…åœ¨æ ‘èŽ“æ´¾ç³»ç»Ÿä¸­æœ¬åœ°ç¼–è¯‘ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºŽç§»åŠ¨ç«¯å’Œ PC ç«¯ç¡¬ä»¶è®¾å¤‡çš„å·¨å¤§å·®å¼‚ï¼ŒåŠ ä¸Š Android å†…æ ¸å’Œæ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼Œèƒ½å¤Ÿç›´æŽ¥è¿è¡Œçš„ç¨‹åºæ¯•ç«Ÿæ˜¯å°‘æ•°ã€‚ä¸è¿‡æˆ‘åˆšåˆšç®—äº†ä¸€ä¸‹ï¼Œå®žé™…ä¸Šå¯ç›´æŽ¥å®‰è£…è¿è¡Œçš„è½¯ä»¶è¶³è¶³æœ‰ 910 ä¸ªï¼ äºŒã€è½¯ä»¶åŒ…å‰é¢æåˆ°çš„å¯ä¾›å®‰è£…çš„è¿‘ä¸€åƒä¸ªï¼ˆç®—ä¸Šä¸ºæ•°ä¼—å¤šçš„åŸºç¡€å·¥å…·ã€åº“æ–‡ä»¶å’Œå¼€å‘ç‰ˆè½¯ä»¶åŒ…ï¼‰ç¨‹åºå’Œè½¯ä»¶ï¼Œæ•°é‡è™½ç„¶è¿œä¸åŠæ¡Œé¢ç³»ç»Ÿï¼Œé¢å¯¹æ—¥å¸¸ä½¿ç”¨ã€å­¦ä¹ ä»»åŠ¡ç”šè‡³å¾ˆå¤šé«˜é˜¶åº”ç”¨ä¹Ÿå·²ç»ç®—å¾—ä¸Šç»°ç»°æœ‰ä½™äº†ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼ŒTermux æ˜¯å¯ä»¥ç›´æŽ¥å®‰è£…é…ç½® Python ç¼–ç¨‹çŽ¯å¢ƒçš„ã€‚æƒ³æƒ³ Python ç¤¾åŒºé‡Œæµ©å¦‚çƒŸæµ·çš„ç¬¬ä¸‰æ–¹åº“ï¼Œç”šè‡³è¿˜å¯ä»¥æ ¹æ®ç‰¹å®šçš„éœ€æ±‚è‡ªè¡Œç¼–å†™ç¨‹åºæºä»£ç ã€‚è¿™é‡Œé¢åŒ…å«ç€æ— é™çš„å¯èƒ½æ€§ã€‚ å½“ç„¶è¿™ä¹Ÿåªæ˜¯ Python ç½¢äº†ï¼Œé‚£ä¹ˆ Perlã€Rubyã€Nodejsã€Luaã€C/C++ã€Golangã€Rustâ€¦â€¦æˆ‘ä¸ä¼šæ‹¿å®ƒåŽ»å¯¹æ ‡ç”µè„‘ä¸Šå®Œå¤‡çš„ç³»ç»ŸçŽ¯å¢ƒï¼Œå•è¯´è¿™ç§ä¼¼ä¹Žæ— é™çš„å¯èƒ½æ€§ï¼Œå°±å·²ç»å¾ˆå€¼å¾—çŽ©å‘³äº†ã€‚ è¿™é‡Œç®€å•çš„åˆ—ä¸¾ä¸‹æˆ‘æ‰€ç†Ÿæ‚‰çš„éƒ¨åˆ†è½¯ä»¶ï¼š åŸºç¡€å·¥å…·ï¼šaptã€bashã€busyboxã€dpkgã€gitã€htopã€makeã€zsh â€¦â€¦ ç¼–ç¨‹è¯­è¨€ï¼šbinutilsã€clangã€dartã€erlangã€golangã€luaã€nodejsã€perlã€phpã€pythonã€rubyã€rust â€¦â€¦ æœåŠ¡å™¨è½¯ä»¶ï¼šapache2ã€lighttpdã€nginxã€openssh â€¦â€¦ æ•°æ®åº“è½¯ä»¶ï¼šmariadbã€memcachedã€mosquittoã€postgresqlã€redisã€sqlite â€¦â€¦ æ–‡æœ¬å·¥å…·å’Œç¼–è¾‘å™¨ï¼šemacsã€gawkã€nanoã€sedã€vim â€¦â€¦ åª’ä½“å·¥å…·ï¼šffmpegã€imagemagickã€mpvã€sox â€¦â€¦ ç½‘ç»œå·¥å…·ï¼šcurlã€httpingã€nmapã€wget â€¦â€¦ æ¸¸æˆå’Œå¨±ä¹ï¼šbastetã€cmatrixã€cowsayã€fortuneã€moon-buggyã€nsnakeã€sl â€¦â€¦ ä¸‰ã€æœ‰è¶£çš„ Terminal å°å‘½ä»¤å°±å…ˆä¸è¯´å…·ä½“çš„çŽ¯å¢ƒæ­å»ºçš„æ­¥éª¤äº†ï¼ŒåŒ…å«çš„ä¸œè¥¿å¾ˆå¤šï¼Œå®žé™…ä¸Šè·Ÿç”µè„‘ç«¯çš„æ“ä½œå¹¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ã€‚å°±ç®€å•åˆ—ä¸¾ä¸€äº›æˆ‘ä¸ªäººéžå¸¸å–œæ¬¢çš„å¥½çŽ©å„¿çš„å°å‘½ä»¤å§ã€‚ fortuneï¼šè¾“å‡ºä¸€æ®µæ ¼è¨€è­¦å¥ã€åè‘—èŠ‚é€‰æˆ–è€…å°ç¬‘è¯ç­‰ cowsayï¼šå°†è¾“å‡ºçš„æ–‡å­—å†…å®¹åŒ…å«åœ¨ç”± ASCII å­—ç¬¦ç»„æˆçš„åŠ¨ç‰©å½¢è±¡çš„æ°”æ³¡å†… lolcatï¼šå°†è‹ç™½çš„è¾“å‡ºæ–‡å­—å˜æˆç»šä¸½çš„å½©è™¹è‰² å®‰è£…æ–¹æ³•ï¼š fortuneï¼š$ apt install fortune cowsayï¼š$ apt install cowsay æˆ–è€… $ gem install cowsay lolcatï¼š$ gem install lolcat å…¶ä¸­ apt ç‰ˆæœ¬çš„ cowsay ä¾èµ– Perl ï¼Œå®‰è£…åŒ…æ•´ä¸ªç®—èµ·æ¥æœ‰ç‚¹å¤§ã€‚æ‰€ä»¥æˆ‘æ¯”è¾ƒå€¾å‘äºŽä½¿ç”¨ gem å‘½ä»¤å®‰è£…ï¼Œå³ä½œä¸º Ruby çš„ç¬¬ä¸‰æ–¹åº“ã€‚å½“ç„¶ä¸ºäº†ä½¿ç”¨ gem å‘½ä»¤æ˜¯è¦å…ˆå®‰è£…å¥½ Ruby çš„ï¼š$ apt install ruby æ•ˆæžœæˆªå›¾ï¼š è™½ç„¶åå­—å« cowsay ï¼Œä½†å®ƒæ‰€åŒ…å«çš„åŠ¨ç‰©å½¢è±¡äº‹å®žä¸Šä¸åªâ€œç‰›â€è¿™ä¸€ç§ã€‚å¯ä»¥ä½¿ç”¨ cowsay -l å‘½ä»¤åˆ—å‡ºæ‰€æœ‰å¯ä¾›é€‰æ‹©çš„åŠ¨ç‰©å½¢è±¡ï¼Œå¹¶é€šè¿‡ cowsay -f animal_name æ‰‹åŠ¨æŒ‡å®šå¦ä¸€ç§åŠ¨ç‰©ã€‚ å¦å¤–ï¼Œå…¶å®ž cowsay çš„æ¯ä¸ªåŠ¨ç‰©å½¢è±¡éƒ½æ˜¯ç”±å¯¹åº”çš„ cow æ–‡ä»¶ï¼ˆåŸºæœ¬å°±æ˜¯ ASCII Art å½¢å¼çš„æ–‡æœ¬æ–‡ä»¶ï¼‰å®šä¹‰çš„ï¼Œå¯ä»¥è‡ªå·±æ‰©å……ï¼Œç¯‡å¹…æœ‰é™ä¸èµ˜è¿°ã€‚ç±»ä¼¼çš„å°çŽ©æ„å„¿è¿˜æœ‰ slï¼ˆçªçªçš„å°ç«è½¦ï¼‰ã€cmatrixï¼ˆå…¨å±æ»šåŠ¨ä¹±ç ï¼‰ï¼Œè¯•è¯•å°±çŸ¥é“äº†ã€‚ é…ç½® ssh æœåŠ¡å‰é¢çš„æˆªå›¾ï¼Œä¼°è®¡å·²ç»æš´éœ²äº†ã€‚ã€‚ã€‚æˆ‘æ˜¯åœ¨ç”µè„‘ä¸Šæˆªçš„å›¾ï¼Œä½†ç¨‹åºç¡®å®žæ˜¯åœ¨æ‰‹æœºä¸Šè¿è¡Œçš„ã€‚åªæ˜¯åœ¨æ‰‹æœºç«¯ Termux ä¸Šå®‰è£…äº† SSH æœåŠ¡ï¼Œè¿œç¨‹ç™»å½•è€Œå·²ã€‚æ­¥éª¤ä¹Ÿéžå¸¸ç®€å•ï¼š è½¯ä»¶å®‰è£…ï¼š$ apt install openssh è®¾ç½®è¿œç¨‹ç™»å½•å¯†ç ï¼š$ passwd ç”µè„‘ç«¯ç™»å½•ï¼š$ ssh phone_ip -p 8022 ç”µè„‘ä¸Šçš„ ssh å®¢æˆ·ç«¯å¯è‡ªè¡Œé€‰æ‹©ï¼Œå°¤å…¶è¦æ³¨æ„ï¼Œè¿™é‡Œ SSH æœåŠ¡ç›‘å¬çš„ç«¯å£æ˜¯ 8022 ã€‚å‘ƒï¼Œå·®ç‚¹å¿˜è®°äº†ã€‚è¿œç¨‹è¿žæŽ¥ä¹‹å‰ï¼Œå…ˆåœ¨æ‰‹æœºç«¯è¿è¡Œä¸‹ sshd å‘½ä»¤å¯åŠ¨ SSH æœåŠ¡ã€‚ã€‚ã€‚ å››ã€é«˜ç«¯çš„å‘½ä»¤è¡Œæ¸¸æˆmoon-buggymoon-buggy æ˜¯ä¸€ä¸ªéžå¸¸â€œé…·ç‚«â€çš„å‘½ä»¤è¡Œç‰ˆæœ¬çš„è·‘é…·æ¸¸æˆã€‚è™½è¯´æ¸¸æˆç•Œé¢å®Œå…¨ç”± ASCII å­—ç¬¦æž„æˆï¼Œå®ƒä»ç„¶å…·å¤‡äº†ä¸€ä¸ªè·‘é…·æ¸¸æˆå¿…éœ€çš„æ‰€æœ‰çš„åŸºæœ¬è¦ç´ ã€‚çŽ©ä¸‹å°±æ‡‚äº†ï¼Œè›®ç¥žå¥‡çš„ã€‚ çŽ©å„¿åˆ°åŽé¢è²Œä¼¼è¿˜æœ‰è¿Žé¢é£žæ¥çš„éšœç¢ç‰©ï¼Œè¿˜å¯ä»¥å‘å°„æ­¦å™¨å¼¹è¯ï¼Ÿè®°ä¸å¤ªæ¸…æ¥šäº†ã€‚ã€‚ã€‚ nsnakeå—¯ï¼Œä¸å¤šè¯´äº†ï¼Œçœ‹åå­—å°±çŸ¥é“ï¼Œè´ªåƒè›‡ã€‚ã€‚ã€‚åˆå§‹çš„ç§»åŠ¨é€Ÿåº¦æœ‰ç‚¹æ…¢ï¼Œå»ºè®®åœ¨æ¸¸æˆé€‰é¡¹é‡Œé¢æ”¹ä¸€ä¸‹ã€‚ bastetå°±æ˜¯å¤§åé¼Žé¼Žçš„ä¿„ç½—æ–¯æ–¹å—å•¦ã€‚çœ‹å›¾ï¼š äº”ã€oh-my-zshæ‰‹æœºç«¯è¾“å…¥å‘½ä»¤æ€»è§‰å¾—æœ‰ç‚¹åˆ«æ‰­ï¼Œå¯èƒ½è¿˜æ˜¯ä¸ä¹ æƒ¯å§ã€‚è¿™æ—¶å€™æœ‰ä¸ª oh-my-zsh å°±æ˜¾å¾—å¾ˆæœ‰å¿…è¦äº†ã€‚åæ­£æˆ‘ä¸ªäººè§‰å¾—æŒºå¥½ç”¨çš„ï¼Œå°¤å…¶æ­é…ä¸Š zsh-completionsã€zsh-autosuggestionsã€zsh-syntax-highlighting ç­‰æ’ä»¶ã€‚å¯ä»¥å¯¹å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤è¿›è¡Œè¯­æ³•é«˜äº®ã€è‡ªåŠ¨è¡¥å…¨ç­‰ï¼Œæžå¤§åœ°æé«˜äº†è¾“å…¥æ•ˆçŽ‡ã€‚ è½¯ä»¶å®‰è£… oh-my-zsh 12$ apt install zsh curl$ sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot; zsh-autosuggestions$ git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions zsh-completions$ git clone https://github.com/zsh-users/zsh-completions ~/.oh-my-zsh/custom/plugins/zsh-completions zsh-syntax-highlighting$ git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting è½¯ä»¶é…ç½®ï¼šç¼–è¾‘ ~/.zshrc æ–‡ä»¶ï¼Œå°†ä¸Šè¿°æ’ä»¶æ·»åŠ åˆ° plugins é¡¹åŽé¢ï¼š PSï¼šTermux è²Œä¼¼æ˜¯æ²¡æœ‰é»˜è®¤ SHELL çš„é…ç½®çš„ï¼Œæ‰€ä»¥å®‰è£…å¥½ oh-my-zsh ä»¥åŽï¼Œæ‰“å¼€è½¯ä»¶è¿˜æ˜¯ç›´æŽ¥è¿›å…¥ Bash ç•Œé¢ã€‚æˆ‘æ²¡æœ‰ç‰¹åˆ«åŽ»æ‰¾é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè€Œæ˜¯ç”¨äº†å¦å¤–ä¸€ç§æ–¹æ¡ˆï¼Œï¼Œï¼Œæ‰‹åŠ¨è¾“å…¥ zsh å‘½ä»¤è¿›å…¥ï¼Œæˆ–è€…ï¼Œåœ¨ ~/.bashrc æ–‡ä»¶ä¸­åŠ å…¥ zsh ä¸€è¡Œå†…å®¹ã€‚ã€‚ã€‚ å…­ã€è®¿é—®æ‰‹æœºæ–‡ä»¶åŠ Termux-Apiæ ¹æ®é»˜è®¤çš„ Android ç³»ç»Ÿçš„æƒé™è®¾å®šï¼ŒTermux æ˜¯æ— æ³•è®¿é—®æ‰‹æœºå­˜å‚¨çš„ã€‚å½“ç„¶å¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œä¿®æ”¹ã€‚åªéœ€è¦è¾“å…¥ termux-setup-storage å‘½ä»¤ï¼Œå³ä¼šå¼¹å‡ºæŽˆæƒçª—å£ï¼Œå…è®¸å³å¯ã€‚è¯¥å‘½ä»¤ä¼šåœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ç”Ÿæˆ storage æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å³åŒ…å«äº†åˆ°ç³»ç»Ÿä¸»è¦èµ„æºï¼ˆå¦‚æ‰‹æœºå†…å­˜ã€å¤–ç½®å­˜å‚¨å¡ã€Downloads æ–‡ä»¶å¤¹ã€ç…§ç‰‡ç­‰ï¼‰çš„é“¾æŽ¥ã€‚ Termux-Api æ˜¯ Termux è½¯ä»¶çš„ä¸€ä¸ªæ’ä»¶ï¼Œéœ€è¦å®‰è£…é¢å¤–çš„ APK åŒ…ã€‚å¹¶ä¸”å‘½ä»¤è¡Œä¸­ä¹Ÿéœ€è¦ä½¿ç”¨ $ apt install termux-api å‘½ä»¤å®‰è£…å…·ä½“çš„å·¥å…·ã€‚å®ƒæä¾›äº†ä¸€ç§ä»¥ API çš„å½¢å¼ç›´æŽ¥è®¿é—® Android ç³»ç»Ÿç¡¬ä»¶å’Œèµ„æºï¼ˆå¦‚ç›¸æœºã€ç”µæ± ã€WiFiã€çŸ­ä¿¡ã€é€šè®¯å½•ã€æŒ‡çº¹ã€GPSç­‰ï¼‰çš„é€”å¾„ã€‚ å¦‚èŽ·å–ç”µæ± çŠ¶æ€å’Œ WiFi è¿žæŽ¥ä¿¡æ¯ï¼š è¿™ä¸ªæ„Ÿè§‰å¯ä»¥æ·±æŒ–ï¼Œç”¨å¥½äº†å¯ä»¥è¾¾åˆ°æ›¾ç»çš„å®‰å“ç¥žå™¨ Tasker çš„æ•ˆæžœã€‚ ä»Šå¤©ä¹Ÿä¸æ—©äº†ï¼Œï¼Œï¼Œå°±å…ˆè¿™æ ·å§ã€‚ç†¬ï¼Œé™„ä¸ªè½¯ä»¶é“¾æŽ¥å§ã€‚ã€‚Termux and Termux-Api æå–ç ï¼ši37yBy the wayï¼Œå½•äº†æ®µè›®ç®€é™‹çš„è§†é¢‘æ¼”ç¤ºï¼Œé¢ï¼Œç¬¬ä¸€æ¬¡å‰ªã€‚ã€‚ã€‚ å‚è€ƒèµ„æ–™Termux Wiki]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Android</tag>
        <tag>Software</tag>
        <tag>Fun</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Tricks â€”â€” ä½¿ç”¨ keyboard å½•åˆ¶é”®ç›˜äº‹ä»¶]]></title>
    <url>%2F2019%2F05%2F11%2Fpython-capture-keyboard-events%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰åœ¨æŸæœ¬ä¹¦ä¸Šçœ‹åˆ°ä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥é€šè¿‡ Python è®°å½•ä¸‹å…¨å±€èŒƒå›´å†…çš„é”®ç›˜äº‹ä»¶ï¼Œä½¿ç”¨çš„æ˜¯ ctypes åº“ã€‚åŽæ¥å‡ ç»å°è¯•ï¼Œå§‹ç»ˆä¸èƒ½æˆåŠŸè¿è¡Œã€‚åŽŸæ¥å®ƒåªæ”¯æŒ Python2 å’Œ 32 ä½çš„ Windows ç³»ç»Ÿã€‚ã€‚ã€‚Excuse meï¼ŸäºŽæ˜¯åœ¨ç½‘ä¸ŠæŸ¥æ‰¾å¯è¡Œçš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ¯”å¦‚ pyHook ã€‚å‘ƒï¼Œä¸åˆèƒƒå£ã€‚å®‰è£…æ¯”è¾ƒç¹çï¼ˆæœ‰ä¾èµ–åº“ä¸”ä¸èƒ½é€šè¿‡ pip å‘½ä»¤å®‰è£…ï¼‰ï¼Œåªæ”¯æŒ Windows ç³»ç»Ÿï¼Œå†µä¸”åˆæ˜¯åå¹´å‰å°±æ²¡å†æ›´æ–°çš„é¡¹ç›®ã€‚ã€‚ã€‚çœ‹äº†ä¸‹å‡½æ•°è°ƒç”¨ä¹Ÿç®—ä¸ä¸Šç®€æ´ç›´è§‚ã€‚ åŽæ¥åˆå¤šç•ªæœç´¢ï¼Œç»ˆäºŽæ‰¾åˆ°äº†ä¸€ä¸ªåä¸º keyboard çš„ Python åº“ï¼Œå¯ä»¥ç»‘å®šå…¨å±€äº‹ä»¶ã€å½•åˆ¶åŠæ¨¡æ‹Ÿé”®ç›˜è¾“å…¥ã€è®¾ç½®çƒ­é”®ç­‰ã€‚å°¤å…¶æ˜¯å®‰è£…å’Œä½¿ç”¨è¶³å¤Ÿç®€å•ï¼Œæ¯”è¾ƒåˆæˆ‘çš„å¿ƒæ„ï¼ˆæ¯•ç«Ÿ Github ä¸Šå°†è¿‘ 1.5K çš„å°æ˜Ÿæ˜Ÿï¼‰ã€‚ ä¸€ã€ç‰¹æ€§ å…¨å±€èŒƒå›´å†…çš„é”®ç›˜äº‹ä»¶ç»‘å®šã€‚å³ç¨‹åºå¯ä»¥åŽå°è¿è¡Œï¼Œæ•æ‰å…¶ä»–è½¯ä»¶ä¸‹çš„æŒ‰é”®åŠ¨ä½œã€‚ è·¨å¹³å°ï¼Œæ”¯æŒ Windows ã€Linux ä»¥åŠ MacOS ç³»ç»Ÿã€‚æ”¯æŒ Python2 å’Œ Python3 ã€‚ çº¯ Python ä»£ç ï¼Œæ— éœ€ç¼–è¯‘ C è¯­è¨€æ¨¡å—ã€‚æ— ä¾èµ–åº“ï¼Œå®‰è£…ç®€å•ï¼ˆåªæ˜¯å¤åˆ¶æ–‡ä»¶å°±å¯ä»¥ï¼‰ã€‚ é€šè¿‡ç‹¬ç«‹çš„çº¿ç¨‹æ•æ‰äº‹ä»¶ï¼Œä¸é˜»å¡žä¸»ç¨‹åºçš„è¿è¡Œã€‚ å¾ˆè¯¦ç»†çš„æ–‡æ¡£ï¼Œå‚è§é¡¹ç›®ä¸»é¡µçš„ README ã€‚ å…¶å®žæˆ‘çœŸçš„æœ‰ç‚¹æ„Ÿè§‰ï¼Œè¿™æ‰æ˜¯æˆ‘å¿ƒç›®ä¸­æ¯”è¾ƒâ€œçŽ°ä»£â€çš„å·¥å…·ã€‚ äºŒã€å½•åˆ¶åŠæ¨¡æ‹ŸæŒ‰é”®åŠ¨ä½œå°±åƒå‰é¢æåˆ°çš„ï¼Œå®‰è£… keyboard çš„æµç¨‹éžå¸¸ç®€å•ï¼Œæ— éœ€è€ƒè™‘ä»»ä½•å…¼å®¹æ€§æˆ–è€…ä¾èµ–é—®é¢˜ï¼Œåªéœ€è¦ä¸€æ¡ç®€çŸ­çš„å‘½ä»¤ï¼š$ pip install keyboard å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å½•åˆ¶ 10 ç§’é’Ÿçš„é”®ç›˜äº‹ä»¶ï¼Œå¹¶å°†å…¶å›žæ”¾ä¸€éï¼ˆå³é‡å¤æŒ‰ä¸‹ä¹‹å‰æ“ä½œçš„æŒ‰é”®ï¼‰ï¼š1234567import keyboardimport timekeyboard.start_recording()time.sleep(10)events = keyboard.stop_recording()keyboard.replay(events) å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç åˆ¶ä½œä¸€ä¸ªç®€å•çš„â€œé”®ç›˜å½•åˆ¶å™¨â€ï¼ˆæ‰“å°è¾“å‡ºå…¨å±€èŒƒå›´å†…çš„æŒ‰é”®åŠ¨ä½œï¼Œå¹¶å°†æŒ‰é”®é¡ºåºä¿å­˜åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ï¼‰ï¼š1234567891011import keyboarddef print_pressed_keys(e): line = &apos;, &apos;.join(str(code) for code in keyboard._pressed_events) print(line) with open(&apos;keylogger.txt&apos;, &apos;a+&apos;) as f: f.write(line + &apos;\n&apos;)keyboard.hook(print_pressed_keys)keyboard.wait() PSï¼šä¸Šè¿°ä»£ç ä¸­çš„ code å¹¶ä¸æ˜¯å¯¹åº”æŒ‰é”®çš„ ASCII ç ï¼Œè€Œæ˜¯æ ¹æ®é”®ç›˜å¸ƒå±€ä¸ºæŒ‰é”®æŒ‡å®šçš„æ•°å€¼ï¼ˆå¦‚ a é”®ä¸º 30ï¼Œb é”®ä¸º 42 ç­‰ç­‰ï¼‰ï¼Œå¯ä»¥é€šè¿‡è‡ªè¡Œæµ‹è¯•ç¡®è®¤å…·ä½“çš„å¯¹åº”å…³ç³»ã€‚å¦‚åŒæ—¶æŒ‰ä¸‹ä¸¤ä¸ªæˆ–å¤šä¸ªæŒ‰é”®ï¼Œåˆ™ä¸Šè¿°ç¨‹åºä¼šä»¥ code, code... çš„å½¢å¼è¾“å‡ºã€‚ ä¸‰ã€çƒ­é”®æ•èŽ·åŠç»‘å®šå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç å½•åˆ¶çƒ­é”®å¹¶ä¸ºè¯¥çƒ­é”®ç»‘å®šä¸Šç‰¹å®šçš„è§¦å‘äº‹ä»¶ï¼š1234567891011import keyboardprint(&apos;Press and release your desired hotkey: &apos;)hotkey = keyboard.read_hotkey()print(&apos;Hotkey selected: &apos;, hotkey)def on_triggered(): print(&quot;Triggered!&quot;)keyboard.add_hotkey(hotkey, on_triggered)print(&quot;Press ESC to stop.&quot;) å…¶ä»–çš„ä½¿ç”¨æ–¹å¼å°±ä¸å†ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œå¯ä»¥å‚è€ƒ keyboard é¡¹ç›®çš„ Github ä¸»é¡µã€‚å‡ ç§å¸¸è§çš„ä½¿ç”¨ç¤ºä¾‹ä¹Ÿå·²ç»åŒ…å«åœ¨é¡¹ç›®ä»£ç çš„ examples ç›®å½•ä¸‹ã€‚ å‚è€ƒkeyboard]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Security</tag>
        <tag>Tricks</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ImageMagick å›¾ç‰‡å¤„ç†å¸¸ç”¨å®žä¾‹ç®€ä»‹]]></title>
    <url>%2F2019%2F04%2F11%2Fexamples-about-processing-images-by-imagemagick%2F</url>
    <content type="text"><![CDATA[ImageMagick æ˜¯ä¸€æ•´å¥—ç”¨äºŽå›¾åƒå¤„ç†çš„è·¨å¹³å°çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆéƒ½å¯ä»¥ç›´æŽ¥é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆå¦‚ Ubuntu ç³»ç»Ÿï¼šsudo apt-get install imagemagickï¼‰ã€‚å…¶ä»–å¹³å°ä¹Ÿå¯ä»¥ä»Žå®˜ç½‘ä¸‹è½½å¯¹åº”çš„ç¼–è¯‘å¥½çš„ç¨‹åºã€‚é€šè¿‡å‘½ä»¤è¡Œï¼ŒImageMagick å¯ä»¥å¾ˆé«˜æ•ˆçš„å¯¹å›¾ç‰‡è¿›è¡Œç¼–è¾‘ã€è½¬æ¢å’Œåˆ›ä½œï¼Œä¹Ÿæ”¯æŒæ‰¹é‡å¤„ç†å¤šå¼ å›¾ç‰‡ï¼Œæˆ–è€…å†…åµŒåˆ° Bash è„šæœ¬ä¸­ã€‚è¿™é‡Œç®€å•ä»‹ç»ä¸‹ ImageMagick å¸¸è§çš„å‡ ç§ç”¨æ³•ã€‚ æ ¼å¼è½¬æ¢ImageMagick æä¾›äº† convert å‘½ä»¤ç”¨äºŽæŽ¥æ”¶å›¾ç‰‡æ–‡ä»¶å¹¶å¯¹å…¶è¿›è¡Œç‰¹å®šçš„æ“ä½œåŽè¾“å‡ºã€‚å…¶ä¸­æœ€åŸºæœ¬çš„ç”¨æ³•å³æ”¹å˜å›¾ç‰‡çš„æ ¼å¼ã€‚ å¦‚å°† PNG æ ¼å¼çš„å›¾ç‰‡è½¬ä¸º JPEG æ ¼å¼ï¼š$ convert image.png image.jpg å¯¹äºŽ JPEG å›¾ç‰‡ï¼Œåœ¨è½¬æ¢æ—¶è¿˜å¯ä»¥æŒ‡å®šåŽ‹ç¼©ç­‰çº§ï¼Œå¦‚ï¼š$ convert image.png -quality 95 image.jpg å…¶ä¸­åŽ‹ç¼©ç­‰çº§ï¼ˆ-qualityï¼‰çš„å€¼ä¸º 1-100ï¼Œé»˜è®¤ä½¿ç”¨è¾“å…¥å›¾ç‰‡çš„åŽ‹ç¼©ç­‰çº§ã€‚å¦‚è¯¥å€¼ä¸ºç©ºï¼Œåˆ™åŽ‹ç¼©ç­‰çº§é»˜è®¤ä¸º 92 ã€‚ æ”¹å˜å›¾ç‰‡å¤§å°convert å‘½ä»¤è¿˜å¯ä»¥ç”¨æ¥æ”¹å˜å›¾ç‰‡çš„å¤§å°ã€‚å¦‚ä¸‹é¢çš„å‘½ä»¤å¯ä»¥å°†åŽŸå›¾ç‰‡è½¬æˆå¤§å°ä¸º 200x100 åƒç´ çš„å›¾ç‰‡ï¼š$ convert image.png -resize 200x100 out.png éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼ŒImageMagick ä¼šä¼˜å…ˆä¿æŒåŽŸå›¾ç‰‡çš„æ¯”ä¾‹ï¼ˆå¦åˆ™å›¾ç‰‡ä¼šå‘ç”Ÿä¸€å®šç¨‹åº¦çš„å˜å½¢ï¼‰ã€‚è¿™æ ·çš„ç»“æžœæ˜¯ï¼Œæ”¹å˜åŽçš„å›¾ç‰‡å¯ä»¥æ­£å¥½æ”¾è¿›ä¸€ä¸ª 200x100 å¤§å°çš„åŒºåŸŸï¼Œä½†å›¾ç‰‡æœ¬èº«å¹¶ä¸ä¸€å®šæ˜¯ç²¾ç¡®çš„ 200x100 åƒç´ ã€‚ å¦‚æžœå°±æ˜¯éœ€è¦å°†åŽŸå›¾ç‰‡è½¬æ¢ä¸ºç‰¹å®šå¤§å°ï¼Œè€Œä¸ç”¨è€ƒè™‘å½¢å˜çš„å½±å“ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š$ convert image.png -resize 200x100! out.png å½“ç„¶æ›´å¤šçš„æ—¶å€™ï¼ŒæŒ‡å®šè¾“å‡ºå›¾ç‰‡çš„å¤§å°æ—¶å¹¶éžä¸€å®šéœ€è¦â€œå®½xé«˜â€è¿™æ ·çš„å½¢å¼ï¼Œå…¶å®žåªéœ€è¦æŒ‡å®šå®½æˆ–è€…é«˜ä¸­çš„ä¸€é¡¹å³å¯ã€‚å¦‚æŒ‡å®šè¾“å‡ºå›¾ç‰‡çš„å®½åº¦ï¼š$ convert image.png -resize 200 out.png æˆ–è€…æŒ‡å®šè¾“å‡ºå›¾ç‰‡çš„é«˜åº¦ï¼š$ convert image.png -resize x100 out.png æ—‹è½¬ä¸Žç¿»è½¬å°†åŽŸå›¾ç‰‡æ—‹è½¬ 90Â° åŽè¾“å‡ºï¼š$ convert image.jpg -rotate 90 image-rotated.jpg æŒ‡å®šçš„è§’åº¦ä¸ºæ­£æ—¶å³é¡ºæ—¶é’ˆæ—‹è½¬å›¾ç‰‡ï¼Œä¸ºè´Ÿæ—¶é€†æ—¶é’ˆæ—‹è½¬ã€‚ å·¦å³ç¿»è½¬ï¼š$ convert image.png -flop out.pngä¸Šä¸‹ç¿»è½¬ï¼š$ convert image.png -flip out.png PSï¼šåŒ…æ‹¬å‰é¢çš„å‡ ç§æƒ…å†µåœ¨å†…ï¼Œå¦‚æžœè¾“å‡ºå›¾ç‰‡çš„æ–‡ä»¶åå’ŒåŽŸå›¾ç‰‡ç›¸åŒï¼Œåˆ™æ”¹å˜åŽçš„å›¾ç‰‡ä¼šç›´æŽ¥è¦†ç›–æŽ‰åŽŸå›¾ç‰‡ã€‚ è£å‰ªä¸Žç¼©æ”¾convert å‘½ä»¤æ”¯æŒç­‰æ¯”ä¾‹ç¼©æ”¾å›¾ç‰‡ï¼Œå¦‚å°†å›¾ç‰‡ç¼©å°ä¸ºåŽŸæ¥çš„ä¸€åŠï¼š$ convert image.png -scale 50% out.png åŒæ—¶ convert ä¹Ÿå¯ä»¥å¯¹å›¾ç‰‡è¿›è¡Œè£å‰ªï¼ŒåŒ…æ‹¬è‡ªåŠ¨è£å‰ªï¼ˆå‰”é™¤å›¾ç‰‡å‘¨å›´ç©ºç™½çš„éƒ¨åˆ†æˆ–è¾¹æ¡†ç­‰ï¼‰å’Œè‡ªå®šä¹‰èŒƒå›´çš„è£å‰ªã€‚ è‡ªåŠ¨è£å‰ªï¼š$ convert image.png -trim out.png è‡ªå®šä¹‰è£å‰ªï¼š$ convert image.jpg -crop 600x600+240+240 out.jpg å…¶ä¸­ -crop çš„å‚æ•°ä¸º å®½xé«˜+æ¨ªåæ ‡åç§»é‡+çºµåæ ‡åç§»é‡ çš„å½¢å¼ï¼Œå³å®½å’Œé«˜ç”¨æ¥å®šä¹‰è£å‰ªçš„çŸ©å½¢åŒºåŸŸçš„èŒƒå›´ï¼Œæ¨ªçºµåç§»é‡ç”¨æ¥æŒ‡å®šè£å‰ªåŒºåŸŸçš„ç›¸å¯¹ä½ç½®ï¼ˆéƒ½ä¸º 0 æ—¶è¡¨ç¤ºä»Žæœ€å·¦ä¸Šè§’å¼€å§‹ï¼‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç”¨ -crop é€‰é¡¹è£å‰ª PNG å’Œ GIF æ ¼å¼çš„å›¾ç‰‡æ—¶ï¼ˆè¿™ä¸¤ç§æ ¼å¼çš„å›¾ç‰‡åŒ…å«â€œè™šæ‹Ÿç”»å¸ƒâ€ï¼‰ï¼Œå¹¶ä¸æ˜¯ä»¥ç”»é¢çš„å®žé™…åƒç´ ä¸ºåŸºå‡†ï¼Œè€Œæ˜¯éœ€è¦å‚è€ƒâ€œç”»å¸ƒâ€çš„å¤§å°å’Œä½ç½®ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¹¶ä¸ä¼šè¾¾åˆ°é¢„æœŸçš„æ•ˆæžœã€‚è¯¦ç»†ä»‹ç»å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ Cutting and Bordering ã€‚ shaveè£å‰ªå›¾ç‰‡æœ‰æ—¶å€™å¯ä»¥é‡‡å–ç›¸åçš„æ€è·¯ï¼Œå³å‰”é™¤å›¾ç‰‡ä¸­ä¸éœ€è¦çš„éƒ¨åˆ†ï¼š$ convert image.png -shave 100x50 out.pngå°†è¾“å…¥å›¾ç‰‡çš„å·¦å³ä¸¤è¾¹å‰”é™¤ 100 åƒç´ ï¼Œä¸Šä¸‹ä¸¤è¾¹å‰”é™¤ 50 åƒç´ ï¼ŒèŽ·å–å‰©ä½™çš„éƒ¨åˆ†å¹¶è¾“å‡ºã€‚ è‰²å½©ã€äº®åº¦ä¸Žé¥±å’Œåº¦convert å‘½ä»¤å¯ä»¥é€šè¿‡ -modulate é€‰é¡¹è°ƒæ•´å›¾ç‰‡çš„è‰²å½©ã€äº®åº¦å’Œé¥±å’Œåº¦ã€‚å¦‚ï¼š$ convert image.png -modulate 150,100,100 out.png ä¸Šè¿°å‘½ä»¤ä¼šå°†åŽŸå›¾ç‰‡çš„äº®åº¦å¢žå¤§ä¸ºåŽŸæ¥çš„ 150% ã€‚å…¶ä¸­ 150,100,100 ä¸‰ä¸ªæ•°å€¼åˆ†åˆ«è¡¨ç¤ºäº®åº¦ã€é¥±å’Œåº¦å’Œè‰²ç›¸ã€‚100 ä¸ºåŸºå‡†å€¼ï¼Œå³å¤§äºŽ 100 è¡¨ç¤ºå¢žå¼ºæŸç§å±žæ€§ï¼Œå°äºŽ 100 è¡¨ç¤ºå‡å¼±æŸç§å±žæ€§ã€‚ é€æ˜Žåº¦ã€è‰²å½©ä¸Žä½æ·±åº¦ å°†é€æ˜Žï¼ˆalphaï¼‰é€šé“æ›¿æ¢ä¸ºçº¯é»‘è‰²ï¼š$ convert image.png -flatten out.png å°†åŽŸå½©è‰²å›¾ç‰‡è½¬ä¸ºç°åº¦æ¨¡å¼ï¼š$ convert image.png -type Grayscale out.png é™ä½Žå›¾ç‰‡çš„ä½æ·±åº¦ï¼ˆbits per pixelï¼‰ï¼š$ convert image.png -depth 8 out.png å‡å°‘å›¾ç‰‡è‰²å½©ï¼š$ convert image.png -dither -colors 256 out.png PSï¼šdither ä¼šå¢žåŠ åƒç´ ç‚¹ï¼Œå¦‚éœ€è¦åœ¨å‡å°‘è‰²å½©çš„åŒæ—¶ä¸åº”ç”¨ dither æ•ˆæžœï¼Œå°†å‘½ä»¤ä¸­çš„ -dither æ›¿æ¢ä¸º +dither ã€‚ é”åŒ–ä¸Žè™šåŒ–é”åŒ–$ convert image.png -sharpen 2 out.png æ¨¡ç³Š$ convert image.png -blur 1 out.png æ·»åŠ æ–‡å­—å’Œè¾¹æ¡†æ·»åŠ æ°´å°$ convert image.jpg -fill red -draw &quot;text 20 20 &#39;Â© 2019 example.com&#39;&quot; out.jpg å¯ä»¥è‡ªè¡Œå®šä¹‰æ·»åŠ æ–‡å­—çš„ä½ç½®ï¼ˆé»˜è®¤ä¸ºå·¦ä¸Šè§’ï¼‰å’Œå­—ä½“ç±»åž‹ï¼š$ convert image.jpg -fill red -gravity SouthEast -font arial -draw &quot;text 20 20 &#39;Â© 2019 example.com&#39;&quot; out.jpg æ·»åŠ è¾¹æ¡†$ convert image.png -bordercolor blue -border 50 out.pngå…¶ä¸­ -bordercolor ç”¨äºŽæŒ‡å®šè¾¹æ¡†é¢œè‰²ï¼Œ-border ç”¨äºŽæŒ‡å®šè¾¹æ¡†å®½åº¦ï¼Œå¯ä»¥ä¸ºç™¾åˆ†æ¯”ã€‚ ç»„åˆå åŠ ç»„åˆå¤šå¼ å›¾ç‰‡ï¼ˆåž‚ç›´æ–¹å‘ï¼‰$ convert x1.png x2.png x3.png -append out.png ç»„åˆå¤šå¼ å›¾ç‰‡ï¼ˆæ°´å¹³æ–¹å‘ï¼‰$ convert x1.png x2.png x3.png +append out.png å åŠ å›¾ç‰‡$ composite -gravity center img1.png img2.png out.pngå°† img1.png å åŠ åˆ° img2.png ä¸Šå¹¶ä½œä¸º out.png è¾“å‡ºï¼ˆæ–¹ä½ä¸ºæ­£ä¸­é—´) åº”ç”¨æ•ˆæžœImageMagick å¯ä»¥å¯¹å›¾ç‰‡åº”ç”¨å¤šç§æ ·å¼çš„ç‰¹æ•ˆã€‚å¦‚ â€œcharcoalâ€ æ•ˆæžœï¼š$ convert image.png -charcoal 2 out.pngå…¶ä¸­ -charcoal åŽé¢çš„æ•°å­— 2 ç”¨äºŽæŒ‡å®šè¯¥æ•ˆæžœçš„å¼ºåº¦ã€‚ â€œimplodeâ€ æ•ˆæžœï¼š$ convert image.png -implode 1 out.png ç»“åˆå¤šç§æ“ä½œå‰é¢æåˆ°çš„å¤šç§å¤„ç†æ–¹å¼å®žé™…ä¸Šå¯ä»¥ä»»æ„ç»„åˆä½¿ç”¨ï¼Œä½¿å¾—åªç”¨ä¸€æ¡å‘½ä»¤å³å¯ä»¥åŒæ—¶å®Œæˆå¤šç§æ“ä½œã€‚å¦‚ï¼š$ convert image.png -resize 400x400 -rotate 180 -charcoal 4 -quality 95 out.jpg æ‰¹é‡å¤„ç†å€ŸåŠ© Bash è„šæœ¬ï¼ˆLinux ç³»ç»Ÿï¼‰çš„å¼ºå¤§åŠŸèƒ½ï¼ŒImageMagick å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰¹é‡å¤„ç†å¤šå¼ å›¾ç‰‡ã€‚å¦‚ä¸‹é¢çš„å‘½ä»¤å¯ä»¥æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ PNG å›¾ç‰‡ï¼Œå°†å®ƒä»¬æ¯ä¸€å¼ éƒ½æ—‹è½¬ 90Â°ï¼Œå†å°†åŽŸæ–‡ä»¶åæ·»åŠ  â€œrotated-â€ å‰ç¼€åŽä¿å­˜ï¼š$ for file in *.png; do convert $file -rotate 90 rotated-$file; done Windows ç³»ç»Ÿä¸Šæ˜¯æ²¡æœ‰åŽŸç”Ÿçš„ Bash Shell çš„ï¼Œä½†æ˜¯å¯ä»¥ä¸‹è½½å®‰è£…æŸäº›è½¯ä»¶ä»¥æ”¯æŒ Bash çŽ¯å¢ƒï¼Œæ¯”å¦‚ Git for Windowsã€‚å…¶å®žä½¿ç”¨ Windows ç³»ç»Ÿè‡ªå¸¦çš„ PowerShell ä¹Ÿå¯ä»¥å®ŒæˆåŒæ ·çš„æ‰¹é‡æ“ä½œï¼šPS &gt; dir *.png | foreach { convert $_ -rotate 90 rotated-$($_.basename).png } æœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥å¤šçŽ©å‡ ä¸‹ã€‚ GIF åŠ¨å›¾åˆ¶ä½œå¯ä»¥å€ŸåŠ© convert å‘½ä»¤å°†å¤šå¼ å›¾ç‰‡ç»„åˆä¸ºä¸€å¼ é‡å¤æ’­æ”¾çš„ GIF åŠ¨å›¾ï¼š$ convert -delay 20 -loop 0 *.png out.gif å…¶ä¸­ -delay é€‰é¡¹ç”¨äºŽæŒ‡å®šå›¾ç‰‡åˆ‡æ¢çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚ å‚è€ƒæ–‡ç« ImageMagick TutorialImageMagick basics æ‹“å±•é˜…è¯»Examples of ImageMagick Usageï¼ˆå¾ˆè¯¦ç»†ï¼‰]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Tricks</tag>
        <tag>Image</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Tricks â€”â€” ç®€å•çš„ HTTP å’Œ FTP æœåŠ¡]]></title>
    <url>%2F2019%2F04%2F07%2Fpython-simple-http-and-ftp-service%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰æœ‰ä½åŒäº‹ï¼Œéœ€è¦åœ¨ä¸¤å°ç”µè„‘é—´ä¼ è¾“ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œå‰ææ˜¯åªå¼€æ”¾äº† 80 ç«¯å£ã€‚æˆ‘ä»¥ä¸ºä»–ä¼šé…ä¸ª Apache ä¹‹ç±»çš„ HTTP æœåŠ¡æˆ–è€… WebDAV ä»€ä¹ˆçš„ã€‚ä»–åªç”¨äº†ä¸€æ¡å‘½ä»¤ï¼špython -m http.server 80ã€‚åŽæ¥æˆ‘æƒ³ä¹Ÿæ˜¯ï¼Œæœ‰æ—¶å€™é¢å¯¹é—®é¢˜ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„ä¸”è¿˜ç®—å®Œç¾Žçš„æ–¹æ¡ˆï¼Œå³ä¾¿ä¸æ˜¯é€šç”¨çš„æˆ–è€…å®Œå¤‡çš„ï¼Œå°±è§£å†³é—®é¢˜è€Œè¨€ï¼Œæœªå°ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚ http.serverhttp.server) æ˜¯ Python3 çš„ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œæºä»£ç åœ¨ Lib/http/server.py ä¸­ï¼Œå®ƒå®šä¹‰äº†ç”¨æ¥å®žçŽ° HTTP æœåŠ¡çš„ç±»ã€‚ å…¶ä¸­çš„ SimpleHTTPRequestHandler ç±»å¯ä»¥ç”¨æ¥åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ HTTP æœåŠ¡ï¼š12345678910import http.serverimport socketserverPORT = 8000Handler = http.server.SimpleHTTPRequestHandlerwith socketserver.TCPServer((&quot;&quot;, PORT), Handler) as httpd: print(&quot;serving at port&quot;, PORT) httpd.serve_forever() è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345$ python test.pyserving at port 8000127.0.0.1 - - [06/Apr/2019 22:55:26] &quot;GET / HTTP/1.1&quot; 200 -127.0.0.1 - - [06/Apr/2019 22:55:41] &quot;GET /pyqt/ HTTP/1.1&quot; 200 -127.0.0.1 - - [06/Apr/2019 22:55:56] &quot;GET /test.py HTTP/1.1&quot; 200 - å› ä¸ºå½“å‰ç›®å½•ä¸‹æ²¡æœ‰ index.html æ–‡ä»¶ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ˜¯ç±»ä¼¼ FTP ç«™ç‚¹ä¸Šçš„é‚£ç§æ–‡ä»¶åˆ—è¡¨ã€‚ å½“ç„¶ï¼Œhttp.server ä¹Ÿå¯ä»¥é€šè¿‡ Python çš„ -m é€‰é¡¹åœ¨å‘½ä»¤è¡Œä¸­ç›´æŽ¥è°ƒç”¨ï¼š$ python -m http.server é»˜è®¤ä¼šåœ¨ 8000 ç«¯å£æ‰“å¼€ HTTP æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šç«¯å£ï¼š$ python -m http.server 8080 åŒæ—¶ï¼Œè¯¥æœåŠ¡ä¼šç»‘å®šæœ¬æœºçš„æ‰€æœ‰ç½‘ç»œæŽ¥å£ï¼ˆ0.0.0.0ï¼‰ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼š$ python -m http.server 8000 -b 127.0.0.1 å…¶ä»–æ”¯æŒçš„å‘½ä»¤è¡Œé€‰é¡¹å¯ä»¥å‚è€ƒå¸®åŠ©ä¿¡æ¯ï¼š123456789101112131415$ python -m http.server -husage: server.py [-h] [--cgi] [--bind ADDRESS] [--directory DIRECTORY] [port]positional arguments: port Specify alternate port [default: 8000]optional arguments: -h, --help show this help message and exit --cgi Run as CGI Server --bind ADDRESS, -b ADDRESS Specify alternate bind address [default: all interfaces] --directory DIRECTORY, -d DIRECTORY Specify alternative directory [default:current directory] pyftpdlibpyftpdlib æ˜¯ä¸€ä¸ªéžå¸¸é«˜æ•ˆçš„å¼‚æ­¥çš„ FTP åº“ï¼Œå¯ä»¥ä¸º Python ç¼–å†™ FTP æœåŠ¡æä¾›é«˜çº§çš„å¯ç§»æ¤çš„ç¼–ç¨‹æŽ¥å£ã€‚pyftpdlib æ˜¯ Python çš„ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ï¼špip install pyftpdlib å®‰è£…æˆåŠŸä»¥åŽï¼Œä¸€ä¸ªæœ€åŸºæœ¬çš„ FTP æœåŠ¡å™¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®žçŽ°ï¼š12345678910111213141516171819202122232425262728293031323334353637383940import osfrom pyftpdlib.authorizers import DummyAuthorizerfrom pyftpdlib.handlers import FTPHandlerfrom pyftpdlib.servers import FTPServerdef main(): # åˆå§‹åŒ–éªŒè¯å™¨ authorizer = DummyAuthorizer() # åˆ›å»ºæœ‰è¯»å†™æƒé™çš„ç”¨æˆ·å’Œåªè¯»æƒé™çš„åŒ¿åç”¨æˆ· authorizer.add_user(&apos;user&apos;, &apos;12345&apos;, &apos;.&apos;, perm=&apos;elradfmwMT&apos;) authorizer.add_anonymous(os.getcwd()) # å®žä¾‹åŒ– FTPHandler ç±» handler = FTPHandler handler.authorizer = authorizer # è‡ªå®šä¹‰æç¤ºä¿¡æ¯ handler.banner = &quot;pyftpdlib based ftpd ready.&quot; # Specify a masquerade address and the range of ports to use for # passive connections. Decomment in case you&apos;re behind a NAT. #handler.masquerade_address = &apos;151.25.42.11&apos; #handler.passive_ports = range(60000, 65535) # FTP æœåŠ¡ç›‘å¬äºŽ 0.0.0.0:2121 address = (&apos;&apos;, 2121) server = FTPServer(address, handler) # è¿žæŽ¥é™åˆ¶ server.max_cons = 256 server.max_cons_per_ip = 5 # å¼€å¯ FTP æœåŠ¡ server.serve_forever()if __name__ == &apos;__main__&apos;: main() æ•ˆæžœå¦‚ä¸‹ï¼š123456789$ python ftp.py[I 2019-04-07 15:08:37] &gt;&gt;&gt; starting FTP server on :::2121, pid=9952 &lt;&lt;&lt;[I 2019-04-07 15:08:37] concurrency model: async[I 2019-04-07 15:08:37] masquerade (NAT) address: None[I 2019-04-07 15:08:37] passive ports: None[I 2019-04-07 15:08:44] ::1:63265-[] FTP session opened (connect)[I 2019-04-07 15:08:44] ::1:63265-[anonymous] USER &apos;anonymous&apos; logged in.[I 2019-04-07 15:08:44] ::1:63265-[anonymous] CWD D:\Program\python 250[I 2019-04-07 15:08:44] ::1:63265-[anonymous] FTP session closed (disconnect). pyftpdlib ä»Ž 0.6.0 ç‰ˆæœ¬å¼€å§‹æ˜¯å®Œå…¨æ”¯æŒ FTPS (FTP over TLS/SSL) çš„ï¼Œéœ€è¦æå‰å®‰è£…å¥½ PyOpenSSL æ¨¡å—ï¼špip install pyopenssl ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425&quot;&quot;&quot;An RFC-4217 asynchronous FTPS server supporting both SSL and TLS.Requires PyOpenSSL module (http://pypi.python.org/pypi/pyOpenSSL).&quot;&quot;&quot;from pyftpdlib.servers import FTPServerfrom pyftpdlib.authorizers import DummyAuthorizerfrom pyftpdlib.handlers import TLS_FTPHandlerdef main(): authorizer = DummyAuthorizer() authorizer.add_user(&apos;user&apos;, &apos;12345&apos;, &apos;.&apos;, perm=&apos;elradfmwMT&apos;) authorizer.add_anonymous(&apos;.&apos;) handler = TLS_FTPHandler handler.certfile = &apos;keycert.pem&apos; handler.authorizer = authorizer # requires SSL for both control and data channel #handler.tls_control_required = True #handler.tls_data_required = True server = FTPServer((&apos;&apos;, 21), handler) server.serve_forever()if __name__ == &apos;__main__&apos;: main() TLS_FTPHandler ç±»éœ€è¦è‡³å°‘ä¸€ä¸ª certfile å’Œä¸€ä¸ªå¯é€‰çš„ keyfileã€‚å¯ä»¥å‚è€ƒ Apache FAQs è‡ªè¡Œç”Ÿæˆè¯ä¹¦æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä¸‹è½½ pyftpdlib æä¾›çš„ç¤ºä¾‹æ–‡ä»¶ keycert.pemã€‚ FTP å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ WinSCPï¼Œæˆªå›¾å¦‚ä¸‹ï¼š è¿è¡Œæ•ˆæžœï¼š12345678$ python ftps.py[I 2019-04-07 17:20:24] &gt;&gt;&gt; starting FTP+SSL server on :::21, pid=5028 &lt;&lt;&lt;[I 2019-04-07 17:20:24] concurrency model: async[I 2019-04-07 17:20:24] masquerade (NAT) address: None[I 2019-04-07 17:20:24] passive ports: None[I 2019-04-07 17:20:36] ::1:64934-[] FTP session opened (connect)[I 2019-04-07 17:20:36] ::1:64934-[user] USER &apos;user&apos; logged in.[I 2019-04-07 17:20:36] ::1:64934-[user] CWD D:\Program\python 250 åŒ http.server ç±»ä¼¼ï¼Œpyftpdlib ä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡ python -m ç›´æŽ¥è°ƒç”¨ï¼š12345$ python -m pyftpdlib[I 2019-04-07 17:27:51] &gt;&gt;&gt; starting FTP server on 0.0.0.0:2121, pid=1100 &lt;&lt;&lt;[I 2019-04-07 17:27:51] concurrency model: async[I 2019-04-07 17:27:51] masquerade (NAT) address: None[I 2019-04-07 17:27:51] passive ports: None åŒ¿åç”¨æˆ·æœ‰å†™æƒé™ï¼š$ python -m pyftpdlib -w è®¾ç½®ç‰¹å®šçš„ç›‘å¬åœ°å€ã€ç«¯å£å·å’Œ home ç›®å½•ï¼š$ python -m pyftpdlib -i localhost -p 8021 -d /home/someone è®¾ç½®ç™»å½•ç”¨æˆ·å’Œå¯†ç ï¼ˆåŒ¿åç”¨æˆ·åˆ™ä¼šè¢«ç¦ç”¨ï¼‰$ python -m pyftpdlib -u username -P password èŽ·å–å¸®åŠ©ä¿¡æ¯ï¼š$ python -m pyftpdlib -h æ‹“å±•èµ„æ–™http.server æºç http.server æ–‡æ¡£pyftpdlib æ–‡æ¡£]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Tricks</tag>
        <tag>Python</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows PowerShell å­¦ä¹ ç¬”è®°å…¶ä¸‰ï¼ˆå­—ç¬¦ä¸²ä¸Žæ•°ç»„ï¼‰]]></title>
    <url>%2F2019%2F03%2F10%2Fwindows-powershell-cookbook-3%2F</url>
    <content type="text"><![CDATA[å­—ç¬¦ä¸²ä»‹ç»ä¸¤ç§ç±»åž‹PowerShell ä¸‹çš„å­—ç¬¦ä¸²ä¸»è¦æœ‰ä¸¤ç§ç±»åž‹ï¼šéžæ‰©å±•ï¼ˆnonexpandingï¼‰å’Œæ‰©å±•ï¼ˆexpandingï¼‰åž‹ã€‚è¿™é‡Œçš„â€œæ‰©å±•â€å’Œâ€œéžæ‰©å±•â€æŒ‡çš„æ˜¯å¯¹å­—ç¬¦ä¸²ä¸­åŒ…å«çš„å˜é‡å’Œè½¬ä¹‰ç¬¦æ˜¯å¦è¿›è¡Œè§£æžã€‚æ‰©å±•åž‹å­—ç¬¦ä¸²éœ€è¦ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œè€Œéžæ‰©å±•åž‹å­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·ã€‚ å®žé™…æ•ˆæžœå¦‚ä¸‹ï¼š123456PS &gt; $username = &quot;starky&quot;PS &gt; echo &quot;hi, my name is $username. `nAnother line&quot;hi, my name is starky.Another linePS &gt; echo &apos;hi, my name is $username. `nwithin the same line&apos;hi, my name is $username. `nwithin the same line åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒåŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²å¯¹å˜é‡ $username å’Œè½¬ä¹‰ç¬¦ `nï¼ˆç­‰åŒäºŽ bash é‡Œçš„ \nï¼‰è¿›è¡Œäº†è§£æžï¼Œè‡ªåŠ¨æ›¿æ¢ä¸ºå˜é‡å’Œè½¬ä¹‰ç¬¦ä»£è¡¨çš„å†…å®¹ã€‚è€Œå•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²åˆ™åªæ˜¯å°†ç¾Žå…ƒç¬¦ã€åå¼•å·ç­‰ç¬¦å·è§†ä¸ºæ™®é€šçš„å­—ç¬¦ï¼Œä¸åšä»»ä½•å¤„ç†ç›´æŽ¥æ‰“å°è¾“å‡ºã€‚ PSï¼šPowerShell é‡Œçš„è½¬ä¹‰ç¬¦æ˜¯åå¼•å· ` è€Œä¸æ˜¯ bash é‡Œçš„åæ–œæ  å¤šè¡Œæ ¼å¼åŒ–æ–‡æœ¬PowerShell æ”¯æŒåˆ›å»º here stringï¼Œå³å¤šè¡Œæ ¼å¼åŒ–æ–‡æœ¬ï¼Œç±»ä¼¼ Python é‡Œçš„ä¸‰å¼•å·ã€‚åªéœ€è¦å°†å¤šè¡Œæ–‡æœ¬åŒ…è£¹åœ¨æˆå¯¹çš„ @&quot; å’Œ &quot;@ ç¬¦å·ä¸­å³å¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112PS &gt; $mystring = @&quot;&gt;&gt; This is the first line&gt;&gt; of a very long string. A &quot;here string&quot;&gt;&gt; lets you create blocks of text&gt;&gt; that span several lines.&gt;&gt; &quot;@&gt;&gt;PS &gt; $mystringThis is the first lineof a very long string. A &quot;here string&quot;lets you create blocks of textthat span several lines. å­—ç¬¦ä¸²ä¸­çš„åŠ¨æ€å†…å®¹å‰é¢æœ‰æåˆ°è¿‡ï¼Œç”±åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸ºâ€œæ‰©å±•â€åž‹å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¯¹å…¶ä¸­åŒ…å«çš„å˜é‡ç­‰è‡ªåŠ¨è¿›è¡Œæ›¿æ¢ã€‚å…¶å®žä¹Ÿå¯ä»¥åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œä»¥ $(expression) çš„æ ¼å¼æ’å…¥è¡¨è¾¾å¼æˆ–ä¸€ç³»åˆ— PowerShell å‘½ä»¤ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š12PS &gt; &quot;1 + 2 equals $(1 + 2)&quot;1 + 2 equals 3 è¿˜å¯ä»¥ä½¿ç”¨ PowerShell çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–æ“ä½œç¬¦åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥åŠ¨æ€å†…å®¹ï¼Œå®ƒéµå¾ªå’Œ .NET ä¸€æ ·çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–è§„åˆ™ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š12345PS &gt; $header = &quot;Report for Today&quot;PS &gt; $mystring = &quot;&#123;0&#125;`n&#123;1&#125;&quot; -f $header,(&apos;-&apos; * $header.Length)PS &gt; $mystringReport for Today---------------- ç¤ºä¾‹ 2ï¼š123456PS &gt; $number1 = 10PS &gt; $number2 = 32PS &gt; &quot;$number2 divided by $number1 is $($number2 / $number1)&quot;32 divided by 10 is 3.2PS &gt; &quot;&#123;0&#125; divided by &#123;1&#125; is &#123;2&#125;&quot; -f $number2, $number1, ($number2 / $number1)32 divided by 10 is 3.2 å­—ç¬¦ä¸²æ“ä½œæ£€ç´¢ä¸Žæ›¿æ¢PowerShell æä¾›äº†å¤šç§ç”¨äºŽå­—ç¬¦ä¸²æœç´¢å’ŒåŒ¹é…çš„æ–¹æ³•ã€‚ -like-like æ“ä½œç¬¦ç”¨äºŽåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç‰¹å®šçš„æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸­å¯ä»¥åŒ…å«é€šé…ç¬¦ï¼š 12PS &gt; &quot;Hello World&quot; -like &quot;*llo W*&quot;True -match-match æ“ä½œç¬¦ç”¨äºŽåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç‰¹å®šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š 12PS &gt; &quot;Hello World&quot; -match &apos;.*l[l-z]o W.*$&apos;True Contains()Contains() æ–¹æ³•ç”¨äºŽåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«äº†å¦ä¸€ä¸ªè¾ƒçŸ­çš„å­—ç¬¦ä¸²ï¼š 12PS &gt; &quot;Hello World&quot;.Contains(&quot;World&quot;)True IndexOf()IndexOf() æ–¹æ³•å¯ä»¥ç”¨æ¥èŽ·å–ä¸€ä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ç´¢å¼•ï¼š 12PS &gt; &quot;Hello World&quot;.IndexOf(&quot;World&quot;)6 Replace()Replace() æ–¹æ³•ç”¨äºŽå°†å­—ç¬¦ä¸²ä¸­çš„ä¸€éƒ¨åˆ†æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š 12PS &gt; &quot;Hello World&quot;.Replace(&quot;World&quot;, &quot;PowerShell&quot;)Hello PowerShell å¦å¤–ï¼Œä½¿ç”¨ PowerShell çš„ -replace æ“ä½œç¬¦æ­é…ä¸Šæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥å®Œæˆæ›´åŠ é«˜çº§çš„æ›¿æ¢ä»»åŠ¡ï¼š12PS &gt; &quot;Hello World&quot; -replace &apos;(.*) (.*)&apos;, &apos;$2 $1&apos;World Hello åˆ†å‰²ã€åˆå¹¶ã€ä¿®å‰ª -split-split æ“ä½œç¬¦å¯ä»¥ç”¨æ¥å°†æŒ‡å®šå­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ç³»åˆ—çš„å­—ç¬¦ç‰‡æ®µï¼š 12345678PS &gt; &quot;a-b-c-d-e-f&quot; -split &quot;-c-&quot;a-bd-e-fPS &gt; &quot;a-b-c-d-e-f&quot; -split &quot;b|[d-e]&quot;a--c---f -join-join æ“ä½œç¬¦ç”¨äºŽå°†å¤šä¸ªå­—ç¬¦ç‰‡æ®µåˆå¹¶ä¸ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸² 123456PS &gt; $list = &quot;Hello&quot;,&quot;World&quot;PS &gt; $listHelloWorldPS &gt; $list -join &quot;, &quot;Hello, World Trim()Trim() æ–¹æ³•ç”¨äºŽåŽ»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºç™½å­—ç¬¦ï¼š 123PS &gt; $text = &quot; `t Test String`t `t&quot;PS &gt; &quot;|&quot; + $text.Trim() + &quot;|&quot;|Test String| åˆ—è¡¨ã€æ•°ç»„ä¸Žå“ˆå¸Œè¡¨åˆ›å»ºæ•°ç»„å’Œåˆ—è¡¨åˆ›å»ºå’Œåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„åœ¨ PowerShell é‡Œéžå¸¸ç®€å•ï¼Œç”¨å¾ˆå¸¸è§çš„èµ‹å€¼è¯­å¥å³å¯ï¼š12345PS &gt; $myArray = 1,2,&quot;HelloWorld&quot;PS &gt; $myArray12HelloWorld ç”¨ä¸Šè¿°æ–¹æ³•åˆ›å»ºçš„æ•°ç»„æ˜¯æ²¡æœ‰æ•°æ®ç±»åž‹é™åˆ¶çš„ï¼Œå³è¯¥æ•°ç»„åœ¨åˆå§‹åŒ–æ—¶å¯ä»¥åŒ…å«ä»»ä½•ç±»åž‹çš„æ•°æ®ã€‚ åˆ›å»ºæŒ‡å®šé•¿åº¦çš„æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨ New-Object å‘½ä»¤ï¼š1234567891011121314PS &gt; $myArray = New-Object &quot;int32[]&quot; 4PS &gt; $myArray[3] = 3PS &gt; $myArray0003PS &gt; $myArray[4] = 4ç´¢å¼•è¶…å‡ºäº†æ•°ç»„ç•Œé™ã€‚æ‰€åœ¨ä½ç½® è¡Œ:1 å­—ç¬¦: 1+ $myArray[4] = 4+ ~~~~~~~~~~~~~~~ + CategoryInfo : OperationStopped: (:) [], IndexOutOfRangeException + FullyQualifiedErrorId : System.IndexOutOfRangeException åˆ›å»ºæŒ‡å®šç±»åž‹çš„æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨ .NET æ¡†æž¶æä¾›çš„å¼ºç±»åž‹çš„é›†åˆï¼š12345678910PS &gt; $list = New-Object Collections.Generic.list[Int]PS &gt; $list.add(10)PS &gt; $list.add(&quot;Hello&quot;)æ— æ³•å°†â€œAddâ€çš„å‚æ•°â€œitemâ€(å…¶å€¼ä¸ºâ€œHelloâ€)è½¬æ¢ä¸ºç±»åž‹â€œSystem.Int32â€:â€œæ— æ³•å°†å€¼â€œHelloâ€è½¬æ¢ä¸ºç±»åž‹â€œSystem.Int32â€ã€‚é”™è¯¯:â€œè¾“å…¥å­—ç¬¦ä¸²çš„æ ¼å¼ä¸æ­£ç¡®ã€‚â€â€æ‰€åœ¨ä½ç½® è¡Œ:1 å­—ç¬¦: 1+ $list.add(&quot;Hello&quot;)+ ~~~~~~~~~~~~~~~~~~ + CategoryInfo : NotSpecified: (:) [], MethodException + FullyQualifiedErrorId : MethodArgumentConversionInvalidCastArgument å¤šç»´æ•°ç»„PowerShell å¯ä»¥ä½¿ç”¨ @() å½¢å¼çš„è¯­æ³•åˆ›å»ºå¤šç»´æ•°ç»„ï¼š12345678PS &gt; $jagged = @(&gt;&gt; (1,2,3,4),&gt;&gt; (5,6,7,8)&gt;&gt; )PS &gt; $jagged[0][0]1PS &gt; $jagged[1][3]8 ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼š123456789101112PS &gt; $multidimensional = New-Object &quot;int32[,]&quot; 2,4PS &gt; $multidimensional[0,0] = 1PS &gt; $multidimensional[1,3] = 8PS &gt; $multidimensional10000008 æ“ä½œæ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥é€šè¿‡ä½ç½®ç´¢å¼•ï¼ˆä»Ž 0 å¼€å§‹ï¼‰èŽ·å–æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ ï¼š12345PS &gt; $myArray = 1,2,&quot;Hello World&quot;PS &gt; $myArray[0]1PS &gt; $myArray[2]Hello World å½“ç„¶ä¹Ÿå¯ä»¥å¯¹æ•°ç»„è¿›è¡Œåˆ†ç‰‡æ“ä½œï¼Œå³èŽ·å–æ•°ç»„ä¸­çš„æŸâ€œä¸€æ®µâ€å…ƒç´ ï¼š1234567PS &gt; $myArray12Hello WorldPS &gt; $myArray[1..2]2Hello World åœ¨å¯¹æ•°ç»„è¿›è¡Œåˆ†ç‰‡æ—¶ï¼ŒPowerShell æä¾›äº†å¦‚ä¸‹çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œå¯ä»¥å¯¹è¾“å‡ºåŽçš„å…ƒç´ è¿›è¡Œçµæ´»çš„æŽ’åºï¼š12345678PS &gt; $myArray = 0,1,2,3,4,5PS &gt; $myArray[3..5 + 2 + 0..1]345201 Foreach-Objectå¦‚æžœéœ€è¦æŒ¨ä¸ªè®¿é—®æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ Foreach-Object å‘½ä»¤ï¼š12345PS &gt; $myArray = 1,2,3PS &gt; $sum = 0PS &gt; $myArray | Foreach-Object &#123; $sum += $_ &#125;PS &gt; $sum6 å½“ç„¶ä¹Ÿå¯ä»¥ç¨å¾®å¤æ‚ç‚¹ï¼Œé€šè¿‡ä½ç½®ç´¢å¼•å’Œ for å¾ªçŽ¯è®¿é—®æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼š1234567PS &gt; $myArray = 1,2,3PS &gt; $sum = 0PS &gt; for($i = 0; $i -lt $myArray.Count; $i++) &#123;&gt;&gt; $sum += $myArray[$i]&gt;&gt; &#125;PS &gt; $sum6 æŽ’åºä½¿ç”¨ Sort-Object å‘½ä»¤å¯ä»¥å¯¹æ•°ç»„å…ƒç´ è¿›è¡ŒæŽ’åºåŽå†è¾“å‡ºï¼š123456789101112131415161718192021PS &gt; dir ç›®å½•: D:\Program\pythonMode LastWriteTime Length Name---- ------------- ------ ----d----- 2019/2/28 22:43 pyqtd----- 2019/3/3 0:17 speech-a---- 2019/3/6 22:13 26434 test.html-a---- 2019/3/6 22:00 174 test.mdPS &gt; Get-ChildItem | Sort-Object -Descending Length | select Name,LengthName Length---- ------test.html 26434test.md 174pyqtspeech ä½¿ç”¨ Get-ChildItem èŽ·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„åˆ—è¡¨ï¼Œå†æŠŠè¯¥åˆ—è¡¨ä¼ é€’ç»™ Sort-Object ï¼Œæ ¹æ®æ–‡ä»¶å ç”¨ç©ºé—´çš„å¤§å°ï¼ˆLengthï¼‰é€†åºè¾“å‡º Name å’Œ Length é¡¹ã€‚ åœ¨ä½¿ç”¨ Sort-Object å¯¹å…ƒç´ è¿›è¡ŒæŽ’åºæ—¶ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©æŽ’åºä¾æ®çš„æ¡ä»¶ã€‚å¦‚æ ¹æ®é¦–å­—æ¯å¯¹å­—ç¬¦ä¸²è¿›è¡ŒæŽ’åºï¼š12345PS &gt; &quot;Hello&quot;,&quot;World&quot;,&quot;And&quot;,&quot;Shell&quot; | Sort-ObjectAndHelloShellWorld æ ¹æ®æ¬¡å­—æ¯å¯¹å­—ç¬¦ä¸²è¿›è¡ŒæŽ’åºï¼š12345PS &gt; &quot;Hello&quot;,&quot;World&quot;,&quot;And&quot;,&quot;Shell&quot; | Sort-Object &#123; $_.Substring(1,1) &#125;HelloShellAndWorld æ•°ç»„ä¸Žè¿ç®—ç¬¦ç¡®å®šæ•°ç»„ä¸Žå…ƒç´ çš„åŒ…å«å…³ç³»ç¡®å®šæ•°ç»„ä¸Žå…ƒç´ çš„åŒ…å«å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨ -contains æˆ–è€… -in æ“ä½œç¬¦ï¼š12345678PS &gt; &quot;Hello&quot;,&quot;World&quot; -contains &quot;Hello&quot;TruePS &gt; &quot;Hello&quot;,&quot;World&quot; -contains &quot;Shell&quot;FalsePS &gt; &quot;Hello&quot; -in &quot;Hello&quot;,&quot;World&quot;TruePS &gt; &quot;Shell&quot; -in &quot;Hello&quot;,&quot;World&quot;False åˆå¹¶æ•°ç»„å¯ä»¥ä½¿ç”¨ç®—æœ¯è¿ç®—ç¬¦ + å¯¹æ•°ç»„è¿›è¡Œåˆå¹¶æ“ä½œï¼š12345678910111213141516PS &gt; $firstArray = &quot;Element 1&quot;,&quot;Element 2&quot;,&quot;Element 3&quot;PS &gt; $secondArray = 1,2,3PS &gt; $firstArray + $secondArrayElement 1Element 2Element 3123PS &gt; $array = 1,2PS &gt; $array += 3,4PS &gt; $array1234 åŒ¹é…æ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥ä½¿ç”¨ -eqã€-matchã€-like æ“ä½œç¬¦å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡ŒåŒ¹é…ï¼š12345678910PS &gt; $array = &quot;Item 1&quot;,&quot;Item 2&quot;,&quot;Item 3&quot;,&quot;Item 1&quot;,&quot;Item 12&quot;PS &gt; $array -eq &quot;Item 1&quot;Item 1Item 1PS &gt; $array -like &quot;*1*&quot;Item 1Item 1Item 12PS &gt; $array -match &quot;Item ..&quot;Item 12 å…¶ä¸­ -eq è¡¨ç¤ºå®Œå…¨åŒ¹é…ï¼Œ-like æ”¯æŒä½¿ç”¨é€šé…ç¬¦ï¼Œ-match æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚ æ›´å¤æ‚çš„åŒ¹é…æ¡ä»¶å¯ä»¥ä½¿ç”¨ Where-Object ï¼š123PS &gt; $array = &quot;Item 1&quot;,&quot;Item 2&quot;,&quot;Item 3&quot;,&quot;Item 1&quot;,&quot;Item 12&quot;PS &gt; $array | Where-Object &#123; $_.Length -gt 6 &#125;Item 12 ç§»é™¤æ•°ç»„ä¸­çš„å…ƒç´ ä¸ºäº†ç§»é™¤æ•°ç»„ä¸­ç¬¦åˆç‰¹æ®Šè§„åˆ™çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ -neã€-notlikeã€-notmatch ç­‰æ¯”è¾ƒæ“ä½œç¬¦ï¼š12345678910111213PS &gt;$array = &quot;Item 1&quot;,&quot;Item 2&quot;,&quot;Item 3&quot;,&quot;Item 1&quot;,&quot;Item 12&quot;PS &gt;$array -ne &quot;Item 1&quot;Item 2Item 3Item 12PS &gt; $array -notlike &quot;*1*&quot;Item 2Item 3PS &gt; $array -notmatch &quot;Item ..&quot;Item 1Item 2Item 3Item 1 èŽ·å–å¤§äºŽæˆ–å°äºŽç‰¹å®šå€¼çš„å…ƒç´ -gtã€-geã€-ltã€-le ç­‰æ¯”è¾ƒæ“ä½œç¬¦å¯ä»¥ç”¨æ¥èŽ·å–æ•°ç»„ä¸­å¤§äºŽæˆ–å°äºŽæŸä¸ªç‰¹å®šå€¼çš„å…ƒç´ ã€‚ PSï¼šå…¶ä¸­ -gt è¡¨ç¤ºå¤§äºŽï¼ˆgreat thanï¼‰ï¼Œ-ge è¡¨ç¤ºå¤§äºŽç­‰äºŽï¼ˆgreat and equalï¼‰ï¼Œ-lt è¡¨ç¤ºå°äºŽï¼ˆless thanï¼‰ï¼Œ-le è¡¨ç¤ºå°äºŽç­‰äºŽï¼ˆless and equalï¼‰ã€‚1234567PS &gt; $array = &quot;Item 1&quot;,&quot;Item 2&quot;,&quot;Item 3&quot;,&quot;Item 1&quot;,&quot;Item 12&quot;PS &gt; $array -ge &quot;Item 3&quot;Item 3PS &gt; $array -lt &quot;Item 2&quot;Item 1Item 1Item 12 ArrayListé€šè¿‡ç±»ä¼¼ $array = 1,2,3,4 è¿™ç§èµ‹å€¼çš„æ–¹å¼åˆ›å»ºçš„æ•°ç»„ï¼Œå…¶é•¿åº¦æ˜¯å›ºå®šçš„ã€‚å¯ä»¥é€šè¿‡ä½ç½®ç´¢å¼•è®¿é—®å…¶ä¸­çš„æŸä¸ªå€¼ï¼Œå¹¶å¯¹å®ƒé‡æ–°èµ‹å€¼ã€‚ä½†æ˜¯ä¸èƒ½ç›´æŽ¥æ·»åŠ æˆ–è€…åˆ é™¤æ•°ç»„ä¸­çš„å…ƒç´ ï¼š12345678910111213141516PS &gt; $array = 0,1,2,3PS &gt; $array[1]1PS &gt; $array[0]=1PS &gt; $array1123PS &gt; $array.Add(4)ä½¿ç”¨â€œ1â€ä¸ªå‚æ•°è°ƒç”¨â€œAddâ€æ—¶å‘ç”Ÿå¼‚å¸¸:â€œé›†åˆçš„å¤§å°æ˜¯å›ºå®šçš„ã€‚â€æ‰€åœ¨ä½ç½® è¡Œ:1 å­—ç¬¦: 1+ $array.add(4)+ ~~~~~~~~~~~~~ + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : NotSupportedException å¦‚æžœéœ€è¦åœ¨æ•°ç»„ä¸­æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ +ã€-neã€-matchã€-gt ç­‰æ¯”è¾ƒæ“ä½œç¬¦ï¼ŒèŽ·å–æ•°ç»„ä¸­åŒ¹é…æŸä¸ªæ¡ä»¶çš„å…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬èµ‹å€¼ç»™æ–°çš„å˜é‡ï¼ŒåŽŸæ•°ç»„ä¸­å…ƒç´ çš„å€¼åˆ™ä¸å—å½±å“ï¼š12345678910111213141516171819202122PS &gt; $original = 1,2,3,4PS &gt; $new1 = $original + 5PS &gt; $new112345PS &gt; $new2 = $original -ne 4PS &gt; $new2123PS &gt; $new3 = $original -gt 2PS &gt; $new334PS &gt; $original1234 åœ¨é¢å¯¹é•¿åº¦å¾ˆå¤§çš„æ•°ç»„æ—¶ï¼Œä¸Šè¿°çš„æ·»åŠ ã€ç§»é™¤ã€æœç´¢ç­‰æ“ä½œå°±ä¼šç¨å¾®æ˜¾å¾—æ•ˆçŽ‡è¾ƒä½Žã€‚æ‰€ä»¥ PowerShell æä¾›äº† ArrayList æ•°æ®ç±»åž‹ï¼Œå¯ä»¥ç›´æŽ¥å¯¹æ•°ç»„æœ¬èº«è¿›è¡Œæ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œï¼š123456789101112131415PS &gt; $collection = New-Object System.Collections.ArrayListPS &gt; [void] $collection.Add(&quot;Hello&quot;)PS &gt; [void] $collection.AddRange((&quot;World&quot;,&quot;How&quot;,&quot;Are&quot;,&quot;You&quot;))PS &gt; $collectionHelloWorldHowAreYouPS &gt; $collection.RemoveAt(1)PS &gt; $collectionHelloHowAreYou [void] å¯ä»¥çœç•¥æ“ä½œæ‰§è¡ŒåŽè¿”å›žçš„çŠ¶æ€å€¼ã€‚ å“ˆå¸Œè¡¨å¯ä»¥ä½¿ç”¨ @{} å½¢å¼çš„è¯­æ³•åˆ›å»ºå“ˆå¸Œè¡¨ï¼ˆæˆ–å…³è”æ•°ç»„ï¼‰ã€‚123456789PS &gt; $myHashtable = @&#123; Key1 = &quot;Value1&quot;; &quot;Key 2&quot; = 1,2,3 &#125;PS &gt; $myHashtable[&quot;New Item&quot;] = 5PS &gt; $myHashtableName Value---- -----Key 2 &#123;1, 2, 3&#125;Key1 Value1New Item 5 æŒ‰å“ˆå¸Œè¡¨çš„é”®æˆ–å€¼æŽ’åº1234567891011121314151617181920212223242526272829303132PS &gt; $myHashtable = @&#123;&#125;PS &gt; $myHashtable[&quot;Hello&quot;] = 3PS &gt; $myHashtable[&quot;Ali&quot;] = 2PS &gt; $myHashtable[&quot;Alien&quot;] = 4PS &gt; $myHashtable[&quot;Duck&quot;] = 1PS &gt; $myHashtableName Value---- -----Hello 3Duck 1Alien 4Ali 2PS &gt; $myHashtable.GetEnumerator() | Sort NameName Value---- -----Ali 2Alien 4Duck 1Hello 3PS &gt; $myHashtable.GetEnumerator() | Sort ValueName Value---- -----Duck 1Ali 2Hello 3Alien 4 å‚è€ƒä¹¦ç±Windows PowerShell Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Windows</tag>
        <tag>Program</tag>
        <tag>Script</tag>
        <tag>PowerShell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§†é¢‘å¤„ç†å·¥å…· FFmpeg å¸¸ç”¨å®žä¾‹è¯¦è§£]]></title>
    <url>%2F2019%2F03%2F10%2Fffmpeg-user-manual-and-practical-examples%2F</url>
    <content type="text"><![CDATA[FFmpeg æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¤šåª’ä½“æ¡†æž¶ï¼Œèƒ½å¤Ÿè§£ç ã€ç¼–ç ã€è½¬ç ã€å¤ç”¨ã€è§£å¤ç”¨ã€æµå¼ä¼ è¾“ã€è¿‡æ»¤å’Œæ’­æ”¾å‡ ä¹Žæ‰€æœ‰æ ¼å¼çš„åª’ä½“æ–‡ä»¶ã€‚å…¶æ ¸å¿ƒå°±æ˜¯ FFmpeg ç¨‹åºæœ¬èº«ï¼Œæ˜¯ä¸€ä¸ªåŸºäºŽå‘½ä»¤è¡Œçš„è§†é¢‘å’ŒéŸ³é¢‘å¤„ç†å·¥å…·ï¼Œå¤šç”¨äºŽè§†é¢‘è½¬ç ã€åŸºç¡€ç¼–è¾‘ï¼ˆä¿®å‰ªå’Œåˆå¹¶ï¼‰ã€è§†é¢‘ç¼©æ”¾ã€åŽæœŸæ•ˆæžœåˆ¶ä½œç­‰åœºæ™¯ã€‚è¿™é‡Œé€šè¿‡ä¸€äº›ç¤ºä¾‹ç®€å•åœ°ä»‹ç»ä¸‹ ffmpeg å‘½ä»¤çš„åŸºæœ¬ä½¿ç”¨ã€‚ ä¸€ã€èŽ·å–è¯¦ç»†ä¿¡æ¯ffmpeg -i &lt;inputfile&gt; -hide_bannerå…¶ä¸­ -hide_banner é€‰é¡¹ç”¨äºŽåœ¨è¾“å‡ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯æ—¶çœç•¥ ffmpeg çš„ç‰ˆæœ¬ä¿¡æ¯å’Œç¼–è¯‘é€‰é¡¹ç­‰ã€‚12345678910111213141516171819202122232425262728$ ffmpeg -i bbb.mp4 -hide_bannerInput #0, mov,mp4,m4a,3gp,3g2,mj2, from &apos;bbb.mp4&apos;: Metadata: major_brand : isom minor_version : 1 compatible_brands: isomavc1 creation_time : 2013-12-17T16:40:26.000000Z title : Big Buck Bunny, Sunflower version artist : Blender Foundation 2008, Janus Bager Kristensen 2013 comment : Creative Commons Attribution 3.0 - http://bbb3d.renderfarming.net genre : Animation composer : Sacha Goedegebure Duration: 00:10:34.53, start: 0.000000, bitrate: 8487 kb/s Stream #0:0(und): Video: h264 (High) (avc1 / 0x31637661), yuv420p, 3840x2160 [SAR 1:1 DAR 16:9], 8002 kb/s, 60 fps, 60 tbr, 60k tbn, 120 tbc (default) Metadata: creation_time : 2013-12-17T16:40:26.000000Z handler_name : GPAC ISO Video Handler Stream #0:1(und): Audio: mp3 (mp4a / 0x6134706D), 48000 Hz, stereo, fltp, 160 kb/s (default) Metadata: creation_time : 2013-12-17T16:40:28.000000Z handler_name : GPAC ISO Audio Handler Stream #0:2(und): Audio: ac3 (ac-3 / 0x332D6361), 48000 Hz, 5.1(side), fltp, 320 kb/s (default) Metadata: creation_time : 2013-12-17T16:40:28.000000Z handler_name : GPAC ISO Audio Handler Side data: audio service type: mainAt least one output file must be specified äºŒã€æ ¼å¼è½¬æ¢ffmpeg -i &lt;inputfile&gt; &lt;outputfile&gt; FFmpeg æ˜¯ä¸€ä¸ªå¼ºå¤§çš„éŸ³é¢‘å’Œè§†é¢‘æ ¼å¼è½¬æ¢å™¨ï¼Œå‡ ä¹Žæ”¯æŒå½“å‰æ‰€æœ‰å¸¸ç”¨çš„æ ¼å¼ï¼Œå¦‚ï¼š$ ffmpeg -i input.avi output.mp4 æˆ–è€…ç»å¸¸éœ€è¦ç”¨åˆ°çš„ï¼Œå°†è§†é¢‘æ–‡ä»¶è½¬ä¸º GIF åŠ¨å›¾ï¼š$ ffmpeg -i input.mp4 output.gif å¦‚æžœåœ¨æ ¼å¼è½¬æ¢æ—¶éœ€è¦ä¿ç•™æºè§†é¢‘çš„è´¨é‡ï¼Œå¯ä»¥æ·»åŠ ä¸Š -qscale 0 é€‰é¡¹ï¼ˆ-qscale çš„å€¼è¶Šä½Žï¼Œè¾“å‡ºè§†é¢‘çš„è´¨é‡è¶Šé«˜ï¼‰ï¼š$ ffmpeg -i input.webm -qscale 0 output.mp4 å¯ä»¥ä½¿ç”¨ -formats é€‰é¡¹åˆ—å‡º ffmpeg å‘½ä»¤æ”¯æŒçš„æ‰€æœ‰æ ¼å¼ï¼ˆå¾ˆé•¿å¾ˆé•¿çš„ä¸€ä¸ªåˆ—è¡¨ã€‚ã€‚ã€‚ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233$ ffmpeg -formats -hide_bannerFile formats: D. = Demuxing supported .E = Muxing supported -- D 3dostr 3DO STR E 3g2 3GP2 (3GPP2 file format) E 3gp 3GP (3GPP file format) D 4xm 4X Technologies E a64 a64 - video for Commodore 64 D aa Audible AA format files D aac raw ADTS AAC (Advanced Audio Coding) DE ac3 raw AC-3 D acm Interplay ACM D act ACT Voice file format D adf Artworx Data Format D adp ADP D ads Sony PS2 ADS E adts ADTS AAC (Advanced Audio Coding) DE adx CRI ADX D aea MD STUDIO audio D afc AFC DE aiff Audio IFF D aix CRI AIX DE alaw PCM A-law D alias_pix Alias/Wavefront PIX image DE amr 3GPP AMR D amrnb raw AMR-NB D amrwb raw AMR-WB D anm Deluxe Paint Animation D apc CRYO APC D ape Monkey&apos;s Audio... ä¸‰ã€æŒ‡å®šç¼–ç å¯ä»¥é€šè¿‡ -c é€‰é¡¹æ‰‹åŠ¨æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„ç¼–ç ï¼Œå¦‚ï¼š$ ffmpeg -i input.mp4 -c:v vp9 -c:a libvorbis output.mkvå…¶ä¸­ -c:v ç”¨äºŽæŒ‡å®šè§†é¢‘ç¼–ç ï¼Œ-c:a æŒ‡å®šéŸ³é¢‘ç¼–ç  PSï¼šè§†é¢‘æ–‡ä»¶çš„åŽç¼€å¦‚ mp4ã€mkvã€avi ç­‰åªæ˜¯è¡¨ç¤ºç”¨æ¥è£…è½½åª’ä½“æµçš„â€œå®¹å™¨â€ç±»åž‹ï¼Œè€Œç¼–ç æ—¶ä½¿ç”¨çš„ç¼–ç æ–¹å¼åˆ™å¦éœ€æŒ‡å®šã€‚å½“ç„¶å¾ˆå¤šæ—¶å€™ ffmpeg ä¼šæ ¹æ®è¾“å‡ºæ–‡ä»¶çš„åŽç¼€è‡ªè¡Œé€‰æ‹©é»˜è®¤çš„ç¼–ç æ–¹å¼ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šã€‚ åªæ”¹å˜è§†é¢‘æˆ–è€…éŸ³é¢‘æµçš„ç¼–ç å¯ä»¥åœ¨æŒ‡å®šç¼–ç æ—¶ï¼Œåªæ”¹å˜è§†é¢‘æˆ–è€…éŸ³é¢‘ç¼–ç ä¸­çš„ä¸€é¡¹ï¼Œå¦ä¸€é¡¹åˆ™ä¿æŒåŽŸæ¥çš„æ ¼å¼ï¼š$ ffmpeg -i input.webm -c:v copy -c:a flac output.mkv-c:v copy è¡¨ç¤ºå¤åˆ¶è¾“å…¥æ–‡ä»¶ä¸­çš„è§†é¢‘æµåˆ°è¾“å‡ºæ–‡ä»¶ï¼Œä¸é‡æ–°è¿›è¡Œç¼–ç  åªæ”¹å˜æ–‡ä»¶åŽç¼€å³è¾“å…¥æ–‡ä»¶ä¸­çš„è§†é¢‘æµå’ŒéŸ³é¢‘æµåŒæ—¶å¤åˆ¶åˆ°è¾“å‡ºæ–‡ä»¶ï¼Œåªæ”¹å˜æ–‡ä»¶åŽç¼€ï¼š$ ffmpeg -i input.webm -c:av copy output.mkv ç¼–ç åˆ—è¡¨æŸ¥çœ‹ FFmpeg æ”¯æŒçš„æ‰€æœ‰éŸ³è§†é¢‘ç¼–ç æ ¼å¼ï¼ˆåˆä¸€ä¸ªå¾ˆé•¿çš„åˆ—è¡¨ã€‚ã€‚ã€‚ï¼‰ï¼š123456789101112131415161718192021222324252627$ ffmpeg -codecs -hide_bannerCodecs: D..... = Decoding supported .E.... = Encoding supported ..V... = Video codec ..A... = Audio codec ..S... = Subtitle codec ...I.. = Intra frame-only codec ....L. = Lossy compression .....S = Lossless compression ------- ... DEV.L. flv1 FLV / Sorenson Spark / Sorenson H.263 (Flash Video) (decoders: flv ) (encoders: flv ) D.V..S fmvc FM Screen Capture Codec D.VI.S fraps Fraps D.VI.S frwu Forward Uncompressed D.V.L. g2m Go2Meeting D.V.L. gdv Gremlin Digital Video DEV..S gif GIF (Graphics Interchange Format) DEV.L. h261 H.261 DEV.L. h263 H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2 D.V.L. h263i Intel H.263 DEV.L. h263p H.263+ / H.263-1998 / H.263 version 2 DEV.LS h264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (decoders: h264 h264_qsv h264_cuvid ) (encoders: libx264 libx264rgb h264_amf h264_nvenc h264_qsv nvenc nvenc_h264 ) DEVIL. hap Vidvox Hap DEV.L. hevc H.265 / HEVC (High Efficiency Video Coding) (decoders: hevc hevc_qsv hevc_cuvid ) (encoders: libx265 nvenc_hevc hevc_amf hevc_nvenc hevc_qsv )... å››ã€è§†é¢‘åŽ‹ç¼©ç¼–ç ä¸Žæ¯”ç‰¹çŽ‡æœ‰äº›æ—¶å€™ï¼ŒåŸºäºŽç£ç›˜ç©ºé—´å’Œç½‘ç»œä¼ è¾“çš„è€ƒè™‘ï¼Œéœ€è¦å¯¹è§†é¢‘æ–‡ä»¶è¿›è¡ŒåŽ‹ç¼©å¤„ç†ã€‚å…¶ä¸­ä¸€ç§æ–¹æ³•å°±æ˜¯æ”¹å˜è§†é¢‘çš„æ¯”ç‰¹çŽ‡ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯”ç‰¹çŽ‡çš„é€‚å½“ç¼©å‡å¯¹è§†é¢‘çš„è§‚çœ‹æ•ˆæžœå¹¶ä¸ä¼šäº§ç”Ÿå¤ªå¤§çš„å½±å“ï¼ˆäººçœ¼å¯Ÿè§‰çš„èŒƒå›´å†…ï¼‰ã€‚å½“ç„¶ç¼–ç çš„é€‰æ‹©ä¹Ÿä¼šå¯¹è¾“å‡ºæ–‡ä»¶çš„å¤§å°äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š $ ffmpeg -i input.webm -c:a copy -c:v vp9 -b:v 1M output.mkv-b:v ç”¨äºŽæŒ‡å®šè§†é¢‘çš„æ¯”ç‰¹çŽ‡ã€‚ å¸§çŽ‡å¦ä¸€ç§æ–¹å¼å°±æ˜¯æ”¹å˜è§†é¢‘æ–‡ä»¶çš„å¸§çŽ‡ï¼Œä¹Ÿå°±æ˜¯äººä»¬å¸¸å¸¸æåˆ°çš„FPSã€‚ $ ffmpeg -i input.webm -c:a copy -c:v vp9 -r 30 output.mkv-r 30 é€‰é¡¹ç”¨äºŽæŒ‡å®šè¾“å‡ºè§†é¢‘çš„å¸§çŽ‡ä¸º 30 FPSã€‚ åˆ†è¾¨çŽ‡è§†é¢‘çš„åˆ†è¾¨çŽ‡ä¹Ÿä¼šå½±å“æ–‡ä»¶çš„å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ -s é€‰é¡¹æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åˆ†è¾¨çŽ‡ã€‚å½“ç„¶ï¼Œè§†é¢‘çš„ç”»å¹…å¤§å°ä¹Ÿä¼šäº§ç”Ÿç›¸åº”çš„å˜åŒ–ï¼š $ ffmpeg -i input.mkv -c:a copy -s hd720 output.mkvæˆ–$ ffmpeg -i input.mkv -c:a copy -s 1280x720 output.mkv äº”ã€æå–éŸ³é¢‘é€šè¿‡æ ¼å¼è½¬æ¢ï¼ŒFFmpeg å¯ä»¥ç›´æŽ¥å°†è§†é¢‘æ–‡ä»¶è½¬ä¸ºéŸ³é¢‘æ–‡ä»¶ï¼Œåªéœ€è¦æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ä¸º .mp3 æˆ– .ogg ç­‰ã€‚å¦‚ï¼š$ ffmpeg -i input.mp4 output.mp3 åŒæ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨è½¬æ¢æ—¶æŒ‡å®šéŸ³é¢‘çš„æ ¼å¼é€‰é¡¹ï¼š$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -ab 320 -f mp3 output.mp3 å…¶ä¸­ï¼š-vn ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶ä¸­ç¦ç”¨è§†é¢‘-ar ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶ä¸­éŸ³é¢‘çš„é‡‡æ ·çŽ‡-acï¼šæŒ‡å®šéŸ³é¢‘çš„é€šé“æ•°-abï¼šæŒ‡å®šéŸ³é¢‘çš„æ¯”ç‰¹çŽ‡-fï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ å…­ã€å¸¸ç”¨å®žç”¨å‘½ä»¤é›†é”¦è°ƒæ•´åˆ†è¾¨çŽ‡å°†æŸè§†é¢‘æ–‡ä»¶çš„åˆ†è¾¨çŽ‡æ”¹ä¸º 1280x720ï¼š$ ffmpeg -i input.mp4 -filter:v scale=1280:720 output.mp4æˆ–è€…ï¼š$ ffmpeg -i input.mp4 -s 1280x720 output.mp4 åŽ‹ç¼©è§†é¢‘æ–‡ä»¶$ ffmpeg -i input.mp4 -vf scale=1280:-1 -c:v libx264 -preset veryslow -crf 24 output.mp4 ä¹Ÿå¯ä»¥æ·»åŠ å¦‚ä¸‹é€‰é¡¹åŒæ—¶å¯¹éŸ³é¢‘æµè¿›è¡ŒåŽ‹ç¼©ï¼š-c:a aac -strict -2 -b:a 128k ç§»é™¤éŸ³é¢‘$ ffmpeg -i input.mp4 -an output.mp4-an é€‰é¡¹è¡¨ç¤ºåœ¨è¾“å‡ºæ–‡ä»¶ä¸­ç¦ç”¨éŸ³é¢‘ æå–å›¾ç‰‡$ ffmpeg -i input.mp4 -r 1 -f image2 image-%2d.png å…¶ä¸­å„é€‰é¡¹çš„å«ä¹‰ï¼š-r ï¼šè®¾ç½®å¸§çŽ‡ï¼Œå³æ¯ç§’æœ‰å¤šå°‘å¸§ç”»é¢è¢«æå–åˆ°å›¾ç‰‡ä¸­ã€‚é»˜è®¤ä¸º 25-f ï¼šæŒ‡å®šè¾“å‡ºçš„æ ¼å¼ã€‚æœ¬ä¾‹ä¸­ä¸ºå›¾ç‰‡ï¼ˆimage2ï¼‰-image-%2d.png ï¼šæŒ‡å®šæå–å‡ºçš„å›¾ç‰‡çš„å‘½åæ–¹å¼ã€‚æœ¬ä¾‹ä¸­æœ€ç»ˆçš„å‘½åä¸º image-01.pngã€image-02.png ç­‰ã€‚å¦‚ä½¿ç”¨ image-%3d.png ï¼Œåˆ™æœ€ç»ˆçš„å‘½åä¸º image-001.pngã€imag-002.png ç­‰ è£å‰ªè§†é¢‘å³æˆªå–æŒ‡å®šèŒƒå›´å†…çš„è§†é¢‘ç”»é¢ï¼Œè£åˆ‡æŽ‰å¤šä½™çš„éƒ¨åˆ†ï¼š$ ffmpeg -i input.mp4 -vf &quot;crop=w:h:x:y&quot; output.mp4 å…¶ä¸­ crop=w:h:x:y ç”¨äºŽæŒ‡å®šâ€œè£å‰ªæ¡†â€çš„å¤§å°å’Œä½ç½®ã€‚w è¡¨ç¤ºè£å‰ªéƒ¨åˆ†çš„å®½åº¦ï¼ˆé»˜è®¤ä¸ºæºè§†é¢‘çš„å®½åº¦ iwï¼‰ï¼›h è¡¨ç¤ºè£å‰ªéƒ¨åˆ†çš„é«˜åº¦ï¼ˆé»˜è®¤ä¸ºæºè§†é¢‘çš„é«˜åº¦ ihï¼›x è¡¨ç¤º x è½´ä¸Šè£å‰ªçš„èµ·å§‹ä½ç½®ï¼ˆæœ€å·¦è¾¹ä¸º 0ï¼Œé»˜è®¤ä¸ºæºè§†é¢‘çš„ä¸­é—´ä½ç½®ï¼‰ï¼›y è¡¨ç¤º y è½´ä¸Šè£å‰ªçš„èµ·å§‹ä½ç½®ï¼ˆæœ€é¡¶éƒ¨ä¸º 0ï¼Œé»˜è®¤ä¸ºæºè§†é¢‘çš„ä¸­é—´ä½ç½®ï¼‰ã€‚ æ”¹å˜è§†é¢‘æ¯”ä¾‹è§†é¢‘æ¯”ä¾‹å³è§†é¢‘ç”»å¹…çš„é•¿å®½æ¯”ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„ 4:3 å’Œ 16:9 ç­‰ã€‚$ ffmpeg -i input.mp4 -aspect 16:9 output.mp4 è®¾ç½®éŸ³é¢‘å°é¢å³åˆ›å»ºä»¥ä¸€å¼ é™æ­¢çš„å›¾ç‰‡ä¸ºç”»é¢çš„è§†é¢‘ã€‚ $ ffmpeg -loop 1 -i inputimage.jpg -i inputaudio.wav -c:v libx264 -tune stillimage -c:a aac -b:a 192k -shortest output.mp4å…¶ä¸­çš„é€‰é¡¹å’Œå‚æ•°å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œä¿®æ”¹å’Œçœç•¥ã€‚ æˆªå–è§†é¢‘ç‰‡æ®µ$ ffmpeg -i input.mp4 -ss 00:00:50 -codec copy -t 60 output.mp4æˆªå–è§†é¢‘ä¸­ä»Žç¬¬ 50 ç§’å¼€å§‹ï¼ŒæŒç»­æ—¶é—´ä¸ºä¸€åˆ†é’Ÿçš„è§†é¢‘ç‰‡æ®µã€‚ å…¶ä¸­ -ss ç”¨äºŽæŒ‡å®šè§†é¢‘ç‰‡æ®µçš„å¼€å§‹æ—¶é—´ï¼›-t æŒ‡å®šè§†é¢‘ç‰‡æ®µçš„æŒç»­æ—¶é—´ï¼Œå•ä½éƒ½ä¸ºç§’ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š$ ffmpeg -i audio.mp3 -ss 00:01:54 -to 00:06:53 -c copy output.mp3 ä»¥ä¸Šå‘½ä»¤ä¹Ÿé€‚ç”¨äºŽéŸ³é¢‘æ–‡ä»¶ã€‚ è§†é¢‘åˆ†å‰²$ ffmpeg -i input.mp4 -t 00:00:30 -c copy part1.mp4 -ss 00:00:30 -codec copy part2.mp4å°†è¾“å…¥çš„è§†é¢‘æ–‡ä»¶åˆ†å‰²ä¸ºä¸¤æ®µï¼Œç¬¬ä¸€æ®µä¸ºä»Žæœ€å¼€å§‹åˆ°ç¬¬ 30 ç§’ï¼›ç¬¬äºŒæ®µä¸ºç¬¬ 30 ç§’åˆ°è§†é¢‘ç»“æŸã€‚ å…¶ä¸­ -t 00:00:30 å‰é¢çœç•¥äº† -ss 00:00:00ï¼›-ss 00:00:30 åŽé¢çœç•¥äº† -t å‰©ä½™æ—¶é—´ã€‚ æœ‰ç‚¹ç±»ä¼¼äºŽæˆªå–å¤šä¸ªè¿žç»­çš„è§†é¢‘ç‰‡æ®µã€‚ è§†é¢‘åˆå¹¶é¦–å…ˆåˆ›å»ºåŒ…å«å„åª’ä½“æ–‡ä»¶è·¯å¾„åˆ—è¡¨çš„æ–‡æœ¬æ–‡ä»¶ join.txt ï¼š123file &apos;~/myvideos/part1.mp4&apos;file &apos;~/myvideos/part2.mp4&apos;file &apos;~/myvideos/part3.mp4&apos; ä½¿ç”¨ -f concat é€‰é¡¹å¯¹å¤šä¸ªè§†é¢‘è¿›è¡Œåˆå¹¶ï¼š$ ffmpeg -f concat -i join.txt -c copy output.mp4 æ·»åŠ å­—å¹•æ–‡ä»¶$ ffmpeg -i input.mp4 -i subtitle.srt -map 0 -map 1 -c copy -c:v libx264 -crf 23 -preset veryfast output.mp4 æ”¹å˜è§†é¢‘æ’­æ”¾é€Ÿåº¦ï¼ˆéŸ³é¢‘ä¸å—å½±å“ï¼‰$ ffmpeg -i input.mp4 -vf &quot;setpts=0.5*PTS&quot; output.mp4 ä¸Šè¿°å‘½ä»¤ä¼šåŠ å¿«è§†é¢‘ç”»é¢çš„æ’­æ”¾é€Ÿåº¦ï¼ŒéŸ³é¢‘æ’­æ”¾é€Ÿåº¦ä¸å˜ã€‚ å¦‚æžœæƒ³æ”¾æ…¢è§†é¢‘ç”»é¢çš„åˆ‡æ¢é€Ÿåº¦ï¼Œå¯ä»¥ç›¸åº”åœ°å°† setpts=0.5*PTS ä¸­çš„ 0.5 æ”¹ä¸ºå¤§äºŽ 1 çš„æ•°å€¼ã€‚ Paddingå³å®½é“¶å¹•è§†é¢‘ä¸­ä¸Šä¸‹çš„ä¸¤é“â€œé»‘è¾¹â€ï¼Œå¯ä»¥ä½¿ç”¨ FFmpeg å‘½ä»¤æ·»åŠ ç±»ä¼¼çš„æ•ˆæžœï¼š1$ ffmpeg -i input.mp4 -vf &quot;scale=1920:1080:force_original_aspect_ratio=decrease,pad=1920:1080:(ow-iw)/2:(oh-ih)/2:black&quot; output.mp4 è¯¥æ•ˆæžœç”± -vf é€‰é¡¹çš„ pad å‚æ•°æŒ‡å®šï¼Œå¯ä»¥æ ¹æ®æƒ…å†µè‡ªè¡Œä¿®æ”¹ã€‚ ä»Žå›¾ç‰‡åˆ›å»ºè§†é¢‘$ ffmpeg -framerate 1 -i img%02d.jpg -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4æŠŠå½“å‰ç›®å½•ä¸‹çš„å¤šå¼ å›¾ç‰‡ï¼ˆåå­—ä¸º img01.jpgã€img02.jpg çš„å½¢å¼ï¼‰ç»„åˆä¸ºä¸€ä¸ªè§†é¢‘æ–‡ä»¶ï¼Œæ•ˆæžœç±»ä¼¼äºŽè‡ªåŠ¨æ’­æ”¾çš„ PPTã€‚æ¯ç§’åˆ‡æ¢ä¸€å¼ å›¾ç‰‡ã€‚ $ ffmpeg -framerate 30 -i img%02d.jpg -c:v libx264 -pix_fmt yuv420p output.mp4ä¹Ÿæ˜¯å°†å½“å‰ç›®å½•ä¸‹çš„å¤šå¼ å›¾ç‰‡ç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„è§†é¢‘ï¼Œè¯¥è§†é¢‘å¸§çŽ‡ä¸º 30 FPSã€‚æ¯å¸§åˆ‡æ¢ä¸€å¼ å›¾ç‰‡ã€‚ å‚è€ƒèµ„æ–™20 FFmpeg Commands For BeginnersHow to create a video from images with FFmpeg?]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Media</tag>
        <tag>Video</tag>
        <tag>FFmpeg</tag>
        <tag>Audio</tag>
        <tag>Script</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨ Python å®žçŽ°è‡ªå·±çš„æ™ºèƒ½è¯­éŸ³åŠ©ç†ï¼ˆç™¾åº¦è¯­éŸ³ + å›¾çµæœºå™¨äººï¼‰]]></title>
    <url>%2F2019%2F03%2F03%2Fpython-voice-assistant%2F</url>
    <content type="text"><![CDATA[ä¾ç¨€è®°å¾—åŽ»å¹´ç”Ÿæ—¥ï¼Œå¯¹ç€ Google è¯´ â€œSing me Happy Birthdayâ€ ã€‚å¥¹çœŸçš„ç»™æˆ‘å”±äº†è‹±æ–‡ç‰ˆçš„ç”Ÿæ—¥æ­Œï¼Œæ»¡æ€€æ·±æƒ…åœ°ï¼ˆæˆ‘æ„Ÿè§‰â€¦â€¦ï¼‰ã€‚æœ€åŽè¿˜åŠ äº†ä¸€ä¸²è°ƒçš®çš„é¼“å£°ã€‚æˆ‘è½¬å¤´å¯¹ç€å…¬å¸çš„å‰å°å°å§å§è¯´ï¼Œçœ‹è§æ²¡æœ‰ï¼Œä½ çš„ Siri ä¸çˆ±æˆ‘ã€‚ã€‚ã€‚ å‘ƒï¼Œä¸çžŽæ‰¯äº†ã€‚åŸºäºŽä»¥ä¸Šçš„æ¸Šæºï¼Œæˆ‘ç”¨ Python å†™äº†ä¸€ä¸ªè¿˜ç®—å¾—ä¸Šæ™ºèƒ½çš„è¯­éŸ³åŠ©ç†ã€‚ æˆªå›¾å¦‚ä¸‹ï¼š æ¼”ç¤ºè§†é¢‘ï¼šç”¨ Python å®žçŽ°çš„æ™ºèƒ½è¯­éŸ³æœºå™¨äººï¼ˆä¸€ï¼‰ æºä»£ç  ä¸è¦æ…Œï¼Œç”¨çš„çŽ°æˆçš„æ¡†æž¶å’Œå…¬å…± APIï¼Œä¸€ç™¾æ¥è¡Œä»£ç è€Œå·²ï¼Œæƒå½“æ¸¸æˆã€‚ ä¸€ã€æ•´ä½“ç»“æž„æ²¡æœ‰åšè¿‡å¤šçš„è®¾è®¡ï¼ˆä¸æ‡‚ã€‚ã€‚ã€‚ï¼‰ï¼Œæ•´ä½“å°±æ˜¯ä¸€ä¸ªç®€å•çš„çº¿æ€§ç»“æž„ï¼Œé¡ºåºæ‰§è¡Œã€‚ä¸€æ¬¡äº¤äº’å®Œæ¯•åŽï¼Œä»Žå¤´å¼€å§‹é‡å¤æ‰§è¡Œã€‚ SpeechRecognitionï¼ˆå½•éŸ³ï¼‰--&gt; ç™¾åº¦è¯­éŸ³ï¼ˆSpeech-to-Textï¼‰--&gt; å›¾çµæœºå™¨äººï¼ˆè¯­ä¹‰åˆ†æžåŠåº”ç­”ï¼‰--&gt; ç™¾åº¦è¯­éŸ³ï¼ˆText-to-Speechï¼‰--&gt; PyAudioï¼ˆéŸ³é¢‘æ’­æ”¾ï¼‰ äºŒã€SpeechRecognitionSpeechRecogintion æ˜¯ Python çš„ä¸€ä¸ªè¯­éŸ³è¯†åˆ«æ¡†æž¶ï¼Œå·²ç»å¯¹æŽ¥äº†å¦‚è°·æ­Œå’Œå¾®è½¯çš„ STT ï¼ˆè¯­éŸ³è½¬æ–‡æœ¬ï¼‰æœåŠ¡ã€‚ æœ¬é¡¹ç›®é‡Œçš„è¯­éŸ³è¯†åˆ«åŠåˆæˆç”¨çš„æ˜¯ç™¾åº¦çš„å¼€æ”¾æœåŠ¡ï¼Œæ‰€ä»¥åªæ˜¯éœ€è¦ SpeechRecogintion çš„å½•éŸ³åŠŸèƒ½ã€‚å®ƒå¯ä»¥æ£€æµ‹è¯­éŸ³ä¸­çš„åœé¡¿è‡ªåŠ¨ç»ˆæ­¢å½•éŸ³å¹¶ä¿å­˜ï¼Œæ¯” PyAudio æ›´äººæ€§åŒ–ï¼ˆä»£ç å†™èµ·æ¥ä¹Ÿæ›´ç®€å•ï¼‰ã€‚ å®‰è£…ä¾èµ–åº“Windowså®‰è£… SpeechRecognition éœ€è¦æå‰è£…å¥½ Python çš„ PyAudio æ¡†æž¶ã€‚PyAudio è²Œä¼¼éœ€è¦ç¼–è¯‘å®‰è£…ï¼ŒWindows ç³»ç»Ÿä¸Šä¼°è®¡ä¼šæœ‰ç‚¹éº»çƒ¦ã€‚ æˆ‘ç”¨çš„æ˜¯ Anaconda è½¯ä»¶ï¼ŒWindows ç³»ç»Ÿä¸Šç”¨å®ƒç®¡ç† Python åŒ…å¾ˆæ–¹ä¾¿ã€‚å«Œè¿™ä¸ªè½¯ä»¶å¤ªå¤§çš„è¯ï¼Œä¹Ÿæœ‰ç®€åŒ–ç‰ˆçš„ Miniconda ã€‚è£…å¥½ä»¥åŽç›´æŽ¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ conda çš„è™šæ‹ŸçŽ¯å¢ƒé‡Œå®‰è£…ï¼Œä¸èµ˜è¿°ï¼‰ï¼šconda install pyaudio PyAudio è£…å¥½ä»¥åŽï¼Œç›´æŽ¥ä½¿ç”¨ Python çš„åŒ…ç®¡ç†å·¥å…· pip å®‰è£… SpeechRecognition å³å¯ï¼špip install SpeechRecognition LinuxLinux ç³»ç»Ÿä¸‹å°±æ˜¾å¾—çœäº‹ä¸€ç‚¹äº†ã€‚å¯ä»¥ç›´æŽ¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„åŒ…ç®¡ç†å™¨å®‰è£… PyAudio ï¼ˆå¦‚ Ubuntu å’Œ Raspbian ç³»ç»Ÿçš„ apt-getï¼‰$ sudo apt-get install python3-pyaudio å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ pip å‘½ä»¤å®‰è£…ï¼Œä¸è¿‡éœ€è¦æå‰è£…å¥½ç¼–è¯‘ç”¨çš„ä¾èµ–åº“ portaudio19 ï¼š12$ sudo apt-get install portaudio19-dev$ pip install pyaudio åŒæ ·çš„ï¼ŒPyAudio è£…å¥½ä»¥åŽï¼Œå®‰è£… SpeechRecognition ï¼špip install SpeechRecognition å½•éŸ³ä»£ç 123456789101112import speech_recognition as srdef rec(rate=16000): r = sr.Recognizer() with sr.Microphone(sample_rate=rate) as source: print(&quot;please say something&quot;) audio = r.listen(source) with open(&quot;recording.wav&quot;, &quot;wb&quot;) as f: f.write(audio.get_wav_data())rec() ä»Žç³»ç»Ÿéº¦å…‹é£Žæ‹¾å–éŸ³é¢‘æ•°æ®ï¼Œé‡‡æ ·çŽ‡ä¸º 16000ï¼ˆè²Œä¼¼ç™¾åº¦è¯­éŸ³ API æœ€é«˜å°±æ”¯æŒåˆ° 16k çš„é‡‡æ ·çŽ‡ï¼‰ã€‚ä¹‹åŽæŠŠé‡‡é›†åˆ°çš„éŸ³é¢‘æ•°æ®ä»¥ wav æ ¼å¼ä¿å­˜åœ¨å½“å‰ç›®å½•ä¸‹çš„ recording.wav æ–‡ä»¶ä¸­ï¼Œä¾›åŽé¢çš„ç¨‹åºä½¿ç”¨ã€‚ å½•éŸ³å®ŒæˆåŽï¼Œå¯ä»¥æ‰¾åˆ°å½•å¥½çš„éŸ³é¢‘æ–‡ä»¶è¯•å¬ä¸€ä¸‹æ•ˆæžœã€‚ ä¸‰ã€ç™¾åº¦è¯­éŸ³ï¼ˆSTTï¼‰åˆ›å»ºåº”ç”¨ç™¾åº¦è¯­éŸ³æ˜¯ç™¾åº¦äº‘ AI å¼€æ”¾å¹³å°æä¾›çš„æ”¯æŒè¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆçš„æœåŠ¡ï¼Œæ³¨å†Œä»¥åŽå°±å¯ä»¥ç›´æŽ¥è®¿é—®å®ƒçš„ REST API äº†ï¼Œå¹¶ä¸”æœ‰å‘æ™®é€šç”¨æˆ·æä¾›å…è´¹çš„è°ƒç”¨é¢åº¦ã€‚ æ³¨å†ŒæˆåŠŸä»¥åŽï¼Œè¿›å…¥è¯­éŸ³æœåŠ¡çš„æŽ§åˆ¶å°åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ï¼Œè®°ä¸‹è‡ªå·±çš„ AppIDã€API Key å’Œ Secret Keyã€‚ è¯­éŸ³è¯†åˆ«ä»£ç ç™¾åº¦ AI æœ‰æä¾›é¢å‘ Python çš„æ¡†æž¶ baidu-aip ï¼Œæ„Ÿè§‰å°±ç›¸å½“äºŽé‡æ–°æ‰“åŒ…ä»¥åŽçš„ requests åº“ï¼Œç”¨æ¥è®¿é—® REST APIã€‚è¿™é‡Œç®€å•èµ·è§ï¼Œç›´æŽ¥ä½¿ç”¨è¯¥æ¡†æž¶ã€‚å®‰è£…ï¼špip install baidu-aip è¯­éŸ³è¯†åˆ«ä»£ç å¦‚ä¸‹ï¼ˆä»£ç ä¸­çš„ Key æ›¿æ¢æˆè‡ªå·±çš„ï¼‰ï¼š1234567891011121314151617181920212223from aip import AipSpeechAPP_ID = &apos;Your AppID&apos;API_KEY = &apos;Your API Key&apos;SECRET_KEY = &apos;Your Secret Key&apos;client = AipSpeech(APP_ID, API_KEY, SECRET_KEY)def listen(): with open(&apos;recording.wav&apos;, &apos;rb&apos;) as f: audio_data = f.read() result = client.asr(audio_data, &apos;wav&apos;, 16000, &#123; &apos;dev_pid&apos;: 1536, &#125;) result_text = result[&quot;result&quot;][0] print(&quot;you said: &quot; + result_text) return result_textlisten() ç®€å•æ¥è¯´ï¼Œå°† SpeechRecognition å½•åˆ¶çš„éŸ³é¢‘ä¸Šä¼ è‡³ç™¾åº¦è¯­éŸ³çš„æœåŠ¡ï¼Œè¿”å›žè¯†åˆ«åŽçš„æ–‡æœ¬ç»“æžœå¹¶è¾“å‡ºã€‚ å››ã€å›¾çµæœºå™¨äººå›¾çµæœºå™¨äººæ˜¯ä¸€ä¸ªæä¾›ï¼ˆä¸€å®šé¢åº¦å†…ï¼‰å…è´¹çš„æ™ºèƒ½èŠå¤©æœåŠ¡çš„å¹³å°ï¼Œæ³¨å†Œä»¥åŽå°±å¯ä»¥åˆ›å»ºè‡ªå·±çš„èŠå¤©æœºå™¨äººå¹¶æŽ¥å…¥åˆ°é¡¹ç›®ä¸­ã€‚ é¦–å…ˆè¿›å…¥å›¾çµæœºå™¨äººçš„æŽ§åˆ¶å°å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„èŠå¤©æœºå™¨äººï¼Œè®°ä¸‹åˆ†é…åˆ°çš„ apikeyã€‚ è¯¥å¹³å°ä¹Ÿæä¾›äº†å¼€æ”¾çš„ REST API ï¼Œä½†æ˜¯ä¸åƒç™¾åº¦é‚£æ ·æœ‰æ‰“åŒ…è‡ªå·±çš„ SDK ã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨ Python çš„ requests åº“è®¿é—®ï¼Œä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536import requestsimport jsonTURING_KEY = &quot;Your apikey&quot;URL = &quot;http://openapi.tuling123.com/openapi/api/v2&quot;HEADERS = &#123;&apos;Content-Type&apos;: &apos;application/json;charset=UTF-8&apos;&#125;def robot(text=&quot;&quot;): data = &#123; &quot;reqType&quot;: 0, &quot;perception&quot;: &#123; &quot;inputText&quot;: &#123; &quot;text&quot;: &quot;&quot; &#125;, &quot;selfInfo&quot;: &#123; &quot;location&quot;: &#123; &quot;city&quot;: &quot;æ­å·ž&quot;, &quot;street&quot;: &quot;ç½‘å•†è·¯&quot; &#125; &#125; &#125;, &quot;userInfo&quot;: &#123; &quot;apiKey&quot;: TURING_KEY, &quot;userId&quot;: &quot;starky&quot; &#125; &#125; data[&quot;perception&quot;][&quot;inputText&quot;][&quot;text&quot;] = text response = requests.request(&quot;post&quot;, URL, json=data, headers=HEADERS) response_dict = json.loads(response.text) result = response_dict[&quot;results&quot;][0][&quot;values&quot;][&quot;text&quot;] print(&quot;the AI said: &quot; + result) return resultrobot(&quot;ä½ å¥½&quot;) ç®€å•æ¥è¯´å°±æ˜¯ä¸Šä¼ ä¸€ä¸ª json æ ¼å¼çš„è¯·æ±‚ï¼ˆåŒ…å«èŠå¤©å†…å®¹å’Œä¸ªäººä¿¡æ¯ç­‰ï¼‰ï¼ŒèŽ·å–åˆ°å›žå¤ã€‚å†ä»Žæ”¶åˆ°çš„å¯¹è±¡ä¸­æå–å‡ºå›žå¤çš„æ–‡æœ¬ã€‚ äº”ã€ç™¾åº¦è¯­éŸ³ï¼ˆTTSï¼‰å…¶å®žå¤§éƒ¨åˆ†ç³»ç»Ÿéƒ½æœ‰å†…ç½®çš„ TTS ï¼ˆå³æ–‡æœ¬è½¬è¯­éŸ³ï¼‰å¼•æ“Žï¼Œå¦‚ MacOS çš„ say å‘½ä»¤ï¼Œåªä¸è¿‡å…¶ä¸­æœ‰å¾ˆå¤šéƒ½æ˜¾å¾—å¤ªâ€œæœºæ¢°â€ï¼Œå‘ƒï¼Œç¼ºå°‘â€œäººæƒ…å‘³å„¿â€ã€‚ã€‚ã€‚ ç™¾åº¦çš„ TTS å¼•æ“Žè¯­éŸ³æ•ˆæžœå¬èµ·æ¥è¿˜æ˜¯å¾ˆå¡å“‡ä¼Šï¼ˆ4 å·é€‰æ‰‹åº¦ä¸«ä¸«ï¼‰çš„ï¼Œæ¯”è¾ƒè¶…å‡ºæˆ‘çš„é¢„æœŸã€‚ æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819from aip import AipSpeechAPP_ID = &apos;Your AppID&apos;API_KEY = &apos;Your API Key&apos;SECRET_KEY = &apos;Your Secret Key&apos;client = AipSpeech(APP_ID, API_KEY, SECRET_KEY)def speak(text=&quot;&quot;): result = client.synthesis(text, &apos;zh&apos;, 1, &#123; &apos;spd&apos;: 4, &apos;vol&apos;: 5, &apos;per&apos;: 4, &#125;) if not isinstance(result, dict): with open(&apos;audio.mp3&apos;, &apos;wb&apos;) as f: f.write(result)speak(&quot;ä½ å¥½å•Š&quot;) å°±æ˜¯æŠŠéœ€è¦è½¬æ¢æˆè¯­éŸ³çš„æ–‡æœ¬å†…å®¹ä¸Šä¼ ï¼Œå†å°†è¿”å›žçš„æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ã€‚è²Œä¼¼åªèƒ½ç”Ÿæˆ mp3 æ ¼å¼ã€‚ å…­ã€PyAudio æ’­æ”¾è¿™ä¸ªæˆ‘æœ‰ç‚¹æ–¹ã€‚ã€‚ã€‚æ²¡æ‰¾åˆ° Python æ’­æ”¾ MP3 çš„åˆé€‚çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨ os.system è°ƒç”¨ç³»ç»Ÿä¸­çš„ sox å‘½ä»¤å°† MP3 è½¬ä¸º wav æ ¼å¼ï¼Œå†ç”¨ PyAudio æ’­æ”¾ã€‚ sox å®‰è£…SoX æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è·¨å¹³å°çš„éŸ³é¢‘å¤„ç†å·¥å…·ï¼ŒLinux ç³»ç»Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ï¼š$ sudo apt-get install sox libsox-fmt-mp3 Windows ç³»ç»Ÿå®‰è£…çš„é»˜è®¤çš„ SoX æ˜¯ä¸åŒ…å« mp3 æ ¼å¼æ”¯æŒçš„ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±ç¼–è¯‘ï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰æˆ–è€…ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„ dll æ–‡ä»¶ï¼ˆlibmad.dll å’Œ libmp3lame.dllï¼Œæ”¾ç½®åœ¨ SoX çš„å®‰è£…ç›®å½•ä¸‹ã€‚æœ€åŽå°†å®‰è£…ç›®å½•æ·»åŠ è‡³ç³»ç»Ÿçš„ PATH çŽ¯å¢ƒå˜é‡å³å¯ã€‚ ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132import pyaudioimport waveimport osimport timedef play(): os.system(&apos;sox audio.mp3 audio.wav&apos;) wf = wave.open(&apos;audio.wav&apos;, &apos;rb&apos;) p = pyaudio.PyAudio() def callback(in_data, frame_count, time_info, status): data = wf.readframes(frame_count) return (data, pyaudio.paContinue) stream = p.open(format=p.get_format_from_width(wf.getsampwidth()), channels=wf.getnchannels(), rate=wf.getframerate(), output=True, stream_callback=callback) stream.start_stream() while stream.is_active(): time.sleep(0.1) stream.stop_stream() stream.close() wf.close() p.terminate()play() ä¸ƒã€æœ€ç»ˆä»£ç åŠè§†é¢‘æ¼”ç¤ºæ•´åˆåŽçš„æœ€ç»ˆä»£ç æˆ‘å°±ä¸å†è´´ä¸€éäº†ï¼Œ100 è¡Œå·¦å³ï¼Œå·²ä¸Šä¼ è‡³ Github ã€‚ç¬¬äºŒä¸ªè§†é¢‘ï¼šç”¨ Python å®žçŽ°çš„æ™ºèƒ½è¯­éŸ³æœºå™¨äººï¼ˆäºŒï¼‰ èŠå¤©æˆªå›¾ï¼š å¯¹äº†ï¼Œè¿™ä¸ªæ˜¯æ”¯æŒæ ‘èŽ“æ´¾çš„ã€‚ä¸è¿‡éœ€è¦é¢å¤–è£…ä¸€ä¸ªUSBéŸ³é¢‘é©±åŠ¨ä½œä¸ºå½•éŸ³è®¾å¤‡ã€‚å‚è€ƒæ ‘èŽ“æ´¾3 éŸ³é¢‘é…ç½®åŠå…¶åº”ç”¨åœºæ™¯ï¼ˆå½•éŸ³ã€VoIP ç”µè¯ç­‰ï¼‰ å‚è€ƒèµ„æ–™SpeechRecognitionç™¾åº¦è¯­éŸ³å›¾çµæœºå™¨äººPyAudioSoX]]></content>
      <categories>
        <category>Program</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Program</tag>
        <tag>Audio</tag>
        <tag>AI</tag>
        <tag>chatbot</tag>
        <tag>SpeechRecognition</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows PowerShell å­¦ä¹ ç¬”è®°å…¶äºŒï¼ˆå˜é‡ä¸ŽæŽ§åˆ¶è¯­å¥ï¼‰]]></title>
    <url>%2F2019%2F02%2F28%2Fwindows-powershell-cookbook-2%2F</url>
    <content type="text"><![CDATA[é‡å®šå‘ä¸Žç®¡é“é‡å®šå‘å¯ä»¥å€ŸåŠ©ç®¡é“ç¬¦å’Œ Out-File å‘½ä»¤å°†æŸä¸ªå‘½ä»¤çš„è¾“å‡ºå†…å®¹é‡å®šå‘è‡³æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ å¦‚ï¼šGet-ChildItem | Out-File files.txté€šè¿‡ Get-ChildItemï¼ˆå³ dirï¼‰èŽ·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå†å€ŸåŠ©ç®¡é“å’Œ Out-File å°†åˆ—è¡¨ä¿å­˜åœ¨ files.txt æ–‡ä»¶ä¸­ã€‚ åœ¨ä½¿ç”¨ Out-File å‘½ä»¤æ—¶å¯ä»¥å¸¦ä¸Š -Encoding ç­‰é€‰é¡¹æ¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„ç¼–ç ç­‰å±žæ€§ï¼šGet-Content filename.cs | Out-File -Encoding ASCII file.txtGet-ChildItem | Out-File -Width 120 files.cs æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼ bash é‡Œçš„ &gt; ç¬¦å·ï¼šGet-ChildItem &gt; files.txtGet-ChildItem 2&gt; errors.txtGet-ChildItem n&gt; otherStreams.txt åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å†…å®¹åœ¨ä½¿ç”¨ Out-File å‘½ä»¤çš„åŒæ—¶ï¼Œå¯ä»¥é™„åŠ ä¸Š -Append é€‰é¡¹ç”¨æ¥æŒ‡æ˜Žåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å†…å®¹ï¼Œå¦‚ï¼šGet-ChildItem | Out-File -Append files.txt åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºŽ bash ä¸­çš„ &gt;&gt; ç¬¦å·ï¼šGet-ChildItem &gt;&gt; files.txt ç®¡é“ç®€å•æ¥è¯´ï¼Œç®¡é“å¯ä»¥ç”¨æ¥è¿žæŽ¥å¤šä¸ªå‘½ä»¤ï¼Œä½¿å¾—ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œä»Žè€Œå°†å¤šä¸ªå‘½ä»¤ä»¥â€œé¦–å°¾ç›¸æŽ¥â€çš„æ–¹å¼æ‰§è¡Œã€‚ Get-Process | Where-Object WorkingSet -gt 100mb | Sort-Object -Descending WSèŽ·å–ç³»ç»Ÿå½“å‰çš„è¿›ç¨‹ä¿¡æ¯ï¼Œå¹¶ç­›é€‰å‡ºå†…å­˜å ç”¨å¤§äºŽ 100MB çš„è¿›ç¨‹ï¼Œå†å°†ç­›é€‰ç»“æžœæŒ‰ç…§å ç”¨çš„å†…å­˜ç”±å¤§åˆ°å°æŽ’åºåŽè¾“å‡ºã€‚12345678910PS C:\Users\starky&gt; Get-Process | Where-Object WorkingSet -gt 100mb | Sort-Object -Descending WSHandles NPM(K) PM(K) WS(K) CPU(s) Id SI ProcessName------- ------ ----- ----- ------ -- -- ----------- 997 75 342180 249576 1,265.59 8516 0 MsMpEng 1598 103 147168 203348 40.02 5992 3 SearchUI 806 29 167004 173960 186.02 5288 3 chrome 1757 182 75120 153712 195.45 13116 3 chrome 2816 134 89428 124596 126.25 1480 3 explorer 367 38 83872 116840 74.64 416 3 chrome ç­›é€‰ï¼ˆWhere-Objectï¼‰Where-Object å‘½ä»¤å¯ä»¥å¯¹æŸä¸ªåˆ—è¡¨å†…å®¹æˆ–å‘½ä»¤çš„è¾“å‡ºåº”ç”¨å„ç§ç±»åž‹çš„ç­›é€‰æ¡ä»¶ã€‚å®ƒçš„é»˜è®¤åˆ«åä¸º where å’Œ ?ã€‚ Get-Process | Where-Object { $_.Name -like &quot;Baidu*&quot; }èŽ·å–å½“å‰ç³»ç»Ÿä¸­åå­—ä»¥â€œBaiduâ€å¼€å¤´çš„è¿›ç¨‹åŠå…¶ä¿¡æ¯ ä¸Šé¢çš„å‘½ä»¤åŒæ—¶ä¹Ÿå¯ä»¥è¿™æ ·è¡¨è¿°ï¼šGet-Process | Where-Object Name -like &quot;Baidu*&quot; å³å…ˆé€šè¿‡ Get-Process å‘½ä»¤èŽ·å–å…¨éƒ¨è¿›ç¨‹ä¿¡æ¯ï¼Œå†å°†å®ƒä»¬ä¼ é€’ç»™ Where-Object å‘½ä»¤ã€‚è€Œ Where-Object åˆæŒ‡å®šæ¯ä¸€ä¸ªè¿›ç¨‹çš„ Name å±žæ€§ï¼ˆå³è¿›ç¨‹åç§°ï¼‰ä¸Žæ¨¡å¼ Baidu* è¿›è¡ŒåŒ¹é…ï¼Œæœ€åŽåªè¾“å‡ºåŒ¹é…çš„ç»“æžœã€‚123456PS C:\Users\starky&gt; gps | where &#123; $_.Name -like &quot;Baidu*&quot; &#125;Handles NPM(K) PM(K) WS(K) CPU(s) Id SI ProcessName------- ------ ----- ----- ------ -- -- ----------- 1030 251 58288 98076 552.59 204 3 BaiduNetdisk 187 14 11952 8628 0.06 4856 3 BaiduNetdiskHost å…¶ä»–ç¤ºä¾‹å¦‚ç­›é€‰æœªå“åº”çš„è¿›ç¨‹ï¼šGet-Process | where { -not $_.Responding } ç­›é€‰å·²ç»åœæ­¢çš„æœåŠ¡ï¼šGet-Process | where { $_.Status -eq &quot;Stopped&quot; } éåŽ†ï¼ˆForeach-Objectï¼‰Foreach-Object å‘½ä»¤ï¼ˆé»˜è®¤åˆ«åä¸º foreach å’Œ %ï¼‰ç”¨äºŽå¯¹æŸä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡æŒ‡å®šç‰¹å®šçš„æ“ä½œã€‚å¦‚ï¼š123456PS C:\Users\starky&gt; 1..5 | Foreach-Object &#123; $_ * 2 &#125;246810 åˆæ¯”å¦‚ç­›é€‰å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶åŽ»æŽ‰å®ƒä»¬çš„åªè¯»å±žæ€§ï¼šGet-ChildItem *.txt | Foreach-Object { attrib -r $_ } å…¶ä¸­ $_ è¡¨ç¤ºä¼ é€’ç»™ Foreach-Object çš„æ¯ä¸€ä¸ªå¯¹è±¡ã€‚attrib -r $_ å³è¡¨ç¤ºå¯¹ Get-ChildItem *.txt èŽ·å–åˆ°çš„æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶åŽ»é™¤åªè¯»å±žæ€§ã€‚ åˆå¦‚ï¼š12345PS C:\Users\starky&gt; $myArray = 1,2,3,4,5PS C:\Users\starky&gt; $sum = 0PS C:\Users\starky&gt; $myArray | Foreach-Object &#123; $sum += $_ &#125;PS C:\Users\starky&gt; $sum15 ä¸Šé¢çš„å‘½ä»¤ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å½¢å¼ï¼š123PS C:\Users\starky&gt; $myArray = 1,2,3,4,5PS C:\Users\starky&gt; $myArray | Foreach-Object &#123; $sum = 0 &#125; &#123; $sum += $_ &#125; &#123; $sum &#125;15 æ ¼å¼åŒ–è¾“å‡ºPowerShell ä¸­çš„è®¸å¤šå‘½ä»¤é»˜è®¤æƒ…å†µä¸‹æ˜¯ä»¥â€œè¡¨æ ¼â€çš„å½¢å¼æ¥æ ¼å¼åŒ–è¾“å‡ºçš„ï¼Œå¦‚ï¼š123456PS C:\Users\starky&gt; Get-Process PowerShellHandles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 410 41 60444 75004 550 3.21 4212 powershell 428 43 60688 56684 561 4.04 5288 powershell å®žé™…ä¸Šåœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œå‘½ä»¤çš„â€œçœŸå®žâ€è¾“å‡ºåŒ…å«äº†æ›´åŠ ä¸°å¯Œçš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ Format-List å‘½ä»¤æ¯”è¾ƒä¸€ä¸‹æ•ˆæžœï¼š123456789101112131415161718192021222324252627PS C:\Users\starky&gt; Get-Process PowerShell | Format-List *__NounName : ProcessName : powershellHandles : 404VM : 575397888WS : 76754944PM : 61808640NPM : 41736Path : C:\WINDOWS\system32\WindowsPowerShell\v1.0\powershell.exeCompany : Microsoft CorporationCPU : 3.2136206FileVersion : 6.3.9600.16406 (winblue_gdr_oob.130926-1103)ProductVersion : 6.3.9600.16406Description : Windows PowerShellProduct : MicrosoftÂ® WindowsÂ® Operating SystemId : 4212PriorityClass : NormalHandleCount : 404WorkingSet : 76754944PagedMemorySize : 61808640PrivateMemorySize : 61808640VirtualMemorySize : 575397888TotalProcessorTime : 00:00:03.2136206BasePriority : 8... Format-List æ˜¯ 4 ç§æ ¼å¼åŒ–è¾“å‡ºçš„å‘½ä»¤ä¹‹ä¸€ï¼Œå…¶ä»–è¿˜æœ‰ Format-Tableã€Format-Wideã€Format-Customã€‚Format-List ç”¨æ¥æŽ¥æ”¶è¾“å…¥å†…å®¹å¹¶å°†å…¶ä»¥åˆ—è¡¨çš„å½¢å¼è¾“å‡ºã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¸¦ä»»ä½•å‚æ•°çš„æ ¼å¼åŒ–å‘½ä»¤åªä¼šè¾“å‡ºå¯¹è±¡çš„ä¸€å°éƒ¨åˆ†å±žæ€§ï¼Œå¦‚ï¼š1234567891011PS C:\Users\starky&gt; Get-Process PowerShell | Format-ListId : 4212Handles : 428CPU : 3.4632222Name : powershellId : 5288Handles : 392CPU : 4.1028263Name : powershell è€Œ Format-List * åˆ™ä¼šæ˜¾ç¤ºè¾“å…¥å¯¹è±¡çš„æ‰€æœ‰å±žæ€§ã€‚ åŒæ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨æ ¼å¼åŒ–å‘½ä»¤åŽé¢æ‰‹åŠ¨æŒ‡å®šéœ€è¦æ˜¾ç¤ºçš„å±žæ€§æˆ–å‚æ•°ï¼Œå¦‚ï¼š123456PS C:\Users\starky&gt; Get-Process PowerShell | Format-Table Id,Name,CPU,WS -Auto Id Name CPU WS -- ---- --- --4212 powershell 3.7128238 787046405288 powershell 4.1028263 58068992 å˜é‡ä¸Žå¯¹è±¡å˜é‡åœ¨ PowerShell ä¸­ï¼Œå¯ä»¥å°†å‘½ä»¤çš„è¾“å‡ºæˆ–å…¶ä»–å†…å®¹å…ˆä¿å­˜åœ¨æŸä¸ªå˜é‡ï¼ˆä»¥ $ ç¬¦å·ä¸ºå‰ç¼€ï¼‰ä¸­ï¼Œä»¥ä¾›åŽç»­ä½¿ç”¨ï¼ˆç”šè‡³å¯ä»¥æŠŠå˜é‡ç›´æŽ¥ä¼ é€’ç»™ç®¡é“ç¬¦ï¼‰ã€‚ 1234567891011PS C:\Users\starky&gt; $result = 2 + 2PS C:\Users\starky&gt; $result4PS C:\Users\starky&gt; $processes = Get-ProcessPS C:\Users\starky&gt; $processes.Count64PS C:\Users\starky&gt; $processes | Where-Object &#123; $_.ID -eq 0 &#125;Handles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 0 0 0 24 0 0 Idle è®¿é—®çŽ¯å¢ƒå˜é‡PowerShell å¯ä»¥å¾ˆè½»æ¾åœ°è®¿é—®ç³»ç»Ÿä¸­å®šä¹‰çš„çŽ¯å¢ƒå˜é‡ï¼Œå¦‚ä½¿ç”¨ Get-ChildItem env: å‘½ä»¤èŽ·å–å½“å‰ç³»ç»Ÿå·²å®šä¹‰çš„æ‰€æœ‰çŽ¯å¢ƒå˜é‡çš„åˆ—è¡¨ï¼š12345678910111213141516PS C:\Users\starky&gt; Get-ChildItem env:Name Value---- -----ALLUSERSPROFILE C:\ProgramDataAPPDATA C:\Users\starky\AppData\RoamingCommonProgramFiles C:\Program Files\Common FilesCommonProgramFiles(x86) C:\Program Files (x86)\Common FilesCommonProgramW6432 C:\Program Files\Common FilesCOMPUTERNAME Starky-LenovoComSpec C:\windows\system32\cmd.exeFP_NO_HOST_CHECK NOHOMEDRIVE C:HOMEPATH \Users\starkyLOCALAPPDATA C:\Users\starky\AppData\Local... ä¹Ÿå¯ä»¥ä½¿ç”¨ $env:variablename å½¢å¼çš„å˜é‡åç›´æŽ¥è¡¨ç¤ºç³»ç»ŸçŽ¯å¢ƒå˜é‡ã€‚å‡ ç§å½¢å¼çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516PS C:\Users\starky&gt; Get-ChildItem env:usernameName Value---- -----USERNAME starkyPS C:\Users\starky&gt; Get-ChildItem Environment::usernameName Value---- -----USERNAME starkyPS C:\Users\H19038&gt; $env:usernamestarky ä½œç”¨åŸŸåˆ›å»ºä¸€ä¸ªåªåœ¨ç‰¹å®šèŒƒå›´å†…ç”Ÿæ•ˆçš„å˜é‡ï¼Œä½¿ç”¨å¦‚ä¸‹å½¢å¼çš„è¯­æ³•ï¼š$SCOPE:variable = value èŽ·å–ç‰¹å®šçš„ä½œç”¨åŸŸé‡ŒæŸä¸ªå˜é‡çš„å€¼ï¼Œä½¿ç”¨å¦‚ä¸‹å½¢å¼çš„è¯­æ³•ï¼š$SCOPE:variable å¦‚åˆ›å»ºä¸€ä¸ªåœ¨è„šæœ¬æ‰§è¡Œå®Œæ¯•åŽä»æ—§æœ‰æ•ˆçš„å˜é‡ï¼Œä½¿ç”¨ GLOBAL ä½œç”¨åŸŸï¼š$GLOBAL:variable = value åœ¨æŸä¸ªå‡½æ•°å†…éƒ¨æ›´æ”¹è„šæœ¬èŒƒå›´å†…çš„å˜é‡ï¼Œéœ€è¦æ˜¾å¼åœ°æŒ‡å®š SCRIPT ä½œç”¨åŸŸï¼š$SCRIPT:variable = value PowerShell ä¸­å˜é‡çš„ä½œç”¨åŸŸï¼Œå°±æ˜¯æŽ§åˆ¶å„å˜é‡åœ¨ä¸åŒèŒƒå›´å†…çš„å¯è§æ€§ã€‚æ¯”å¦‚å½“è¿›å…¥ä¸€ä¸ªä»£ç å—ã€å‡½æ•°æˆ–åˆ«åæ—¶ï¼Œå½“å‰çš„ä½œç”¨åŸŸæˆä¸ºæ–°çš„â€œæœ¬åœ°ä½œç”¨åŸŸâ€ï¼ˆå­ä½œç”¨åŸŸï¼‰ï¼ŒåŽŸæ¥çš„ä½œç”¨åŸŸåˆ™æˆä¸ºâ€œçˆ¶ä½œç”¨åŸŸâ€ã€‚å­ä½œç”¨åŸŸå¯ä»¥è®¿é—®çˆ¶ä½œç”¨åŸŸä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ç›´æŽ¥ä¿®æ”¹è¿™äº›å˜é‡çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå­ä½œç”¨åŸŸå¯ä»¥ä¿®æ”¹åœ¨çˆ¶ä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡ï¼Œä½†æ˜¯è¿™ç§ä¿®æ”¹ä¸ä¼šå°†æ–°å€¼è‡ªåŠ¨åŒæ­¥åˆ°çˆ¶ä½œç”¨åŸŸã€‚ .NET å¯¹è±¡PowerShell å¯ä»¥ç›´æŽ¥è®¿é—® .NET å¯¹è±¡çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®žä¾‹ï¼‰å’Œå±žæ€§ï¼Œæ¯”å¦‚è®¿é—®æŸä¸ªé™æ€æ–¹æ³•ï¼š[ClassName]::MethodName(parameter list) è®¿é—®æŸä¸ªå¯¹è±¡å®žä¾‹ç»‘å®šçš„æ–¹æ³•ï¼š$objectReference.MethodName(parameter list) è®¿é—®æŸä¸ªç±»çš„é™æ€å±žæ€§ï¼š[ClassName]::PropertyName è®¿é—®æŸä¸ªå¯¹è±¡å®žä¾‹çš„å±žæ€§ï¼š$objectReference.PropertyName ä¸‹é¢æ˜¯ä¸€äº›å…·ä½“çš„ä¾‹å­ã€‚ é™æ€æ–¹æ³•ï¼š12345PS C:\Users\starky&gt; [System.Diagnostics.Process]::GetProcessById(0)Handles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 0 0 0 24 0 0 Idle å®žä¾‹æ–¹æ³•ï¼š123PS C:\Users\starky&gt; $now = Get-DatePS C:\Users\starky&gt; $now.ToString()2019/2/27 15:34:21 é™æ€å±žæ€§ï¼š123PS C:\Users\starky&gt; [System.DateTime]::Now2019å¹´2æœˆ27æ—¥ 15:36:09 å®žä¾‹å±žæ€§ï¼š123PS C:\Users\starky&gt; $today = Get-DatePS C:\Users\starky&gt; $today.DayOfWeekWednesday åˆ›å»ºå¯¹è±¡çš„å®žä¾‹ä½¿ç”¨ New-Object å‘½ä»¤å¯ä»¥åˆ›å»ºæŸä¸ª .NET å¯¹è±¡çš„å®žä¾‹ã€‚å¦‚ï¼š123PS C:\Users\starky&gt; $generator = New-Object System.RandomPS C:\Users\starky&gt; $generator.NextDouble()0.697396862179691 ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºå®žä¾‹çš„åŒæ—¶ç›´æŽ¥ä½¿ç”¨å®ƒï¼š12345PS C:\Users\starky&gt; (New-Object Net.WebClient).DownloadString(&quot;http://www.baidu.com&quot;)&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;head&gt;... é€šå¸¸çš„åšæ³•æ˜¯ï¼Œåˆ›å»ºå¯¹è±¡å®žä¾‹çš„åŒæ—¶ï¼Œè¿˜è¦ä¸ºå…¶æŒ‡å®šæŸäº›å±žæ€§ã€‚å¦‚ï¼š1234567891011PS C:\Users\starky&gt; $startInfo = New-Object Diagnostics.ProcessStartInfo -Property @&#123;&gt;&gt; &apos;Filename&apos; = &quot;powershell.exe&quot;;&gt;&gt; &apos;WorkingDirectory&apos; = $HOMEPATH;&gt;&gt; &apos;Verb&apos; = &quot;RunAs&quot;&gt;&gt; &#125;&gt;&gt;PS C:\Users\starky&gt; [Diagnostics.Process]::Start($startInfo)Handles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 4 2 260 1224 6 0.00 6248 powershell ä¸Šè¿°å‘½ä»¤ä¸­åˆ›å»º Diagnostics.ProcessStartInfo å¯¹è±¡çš„è¯­å¥ä¹Ÿå¯ä»¥ç®€å†™ä¸ºå¦‚ä¸‹å½¢å¼ï¼š12345$startInfo = [Diagnostics.ProcessStartInfo] @&#123; &apos;Filename&apos; = &quot;powershell.exe&quot;; &apos;WorkingDirectory&apos; = $HOMEPATH; &apos;Verb&apos; = &quot;RunAs&quot;&#125; æœ‰æ—¶å€™ä¸ºäº†ç®€å†™ .NET ç±»çš„å®Œæ•´åç§°ï¼Œå¯ä»¥å€ŸåŠ©å˜é‡èµ‹å€¼ï¼Œå¦‚ï¼š12345PS C:\Users\starky&gt; $math = [System.Math]PS C:\Users\starky&gt; $math::Min(1,10)1PS C:\Users\starky&gt; $math::Sin(3.14)0.00159265291648683 å¾ªçŽ¯ä¸Žæµç¨‹æŽ§åˆ¶æ¯”è¾ƒä¸Žé€»è¾‘è¿ç®—PowerShell æ”¯æŒçš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼š-eq, -ne, -gt, -in, -notin, -lt, -le, -like, -notlike, -match, -notmatch, -contains, -notcontains, -is, -isnot é€»è¾‘è¿ç®—ç¬¦ï¼š-and, -or, -xor, -not é€»è¾‘ä¸Žæ¯”è¾ƒè¿ç®—ç¬¦å¯ä»¥ç”¨æ¥åœ¨æ•°æ®é—´è¿›è¡Œæ¯”è¾ƒï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æµ‹è¯•å½“å‰æŸäº›ç‰¹å®šçš„æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚å¦‚åˆ¤æ–­å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°æ˜¯å¦å¤§äºŽç­‰äºŽ 4ï¼š12PS C:\Users\starky&gt; (dir).Count -ge 4True æŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç‰¹å®šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š12PS C:\Users\starky&gt; &quot;Hello World&quot; -match &quot;H.*World&quot;True é»˜è®¤æƒ…å†µä¸‹ï¼ŒPowerShell é‡Œçš„æ¯”è¾ƒè¿ç®—æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå¦‚æžœæƒ³ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ç‰ˆæœ¬çš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼š-ceq, -cne, -cge, -cgt, -cin, -clt, -cle, -clike, -cnotlike, -cmatch, -cnotmatch, -ccontains, -cnotcontains é€»è¾‘è¿ç®—ç¬¦å¯ä»¥ç»„åˆå¤šä¸ªå€¼ä¸º true æˆ– false çš„è¯­å¥ï¼Œå¹¶æ ¹æ®è¿ç®—ç¬¦å·çš„ä¸åŒè¿”å›žç‰¹å®šçš„é€»è¾‘è¿ç®—ç»“æžœã€‚æ¯”å¦‚åˆ¤æ–­æŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç‰¹å®šæ¨¡å¼ï¼Œä¸”å­—ç¬¦ä¸²é•¿åº¦å¤§äºŽ 10ï¼š123PS C:\Users\starky&gt; $data = &quot;Hello World&quot;PS C:\Users\starky&gt; ($data -like &quot;*llo W*&quot;) -and ($data.Length -gt 10)True æ¡ä»¶è¯­å¥PowerShell ä¸­çš„ if è¯­å¥åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š123456789101112131415161718$temperature = 35if($temperature -le 0)&#123; &quot;Freezing&quot;&#125;elseif($temperature -le 10)&#123; &quot;Cold&quot;&#125;elseif($temperature -le 20)&#123; &quot;Warm&quot;&#125;else&#123; &quot;Hot&quot;&#125; é™¤äº†æµç¨‹æŽ§åˆ¶ï¼Œæ¡ä»¶è¯­å¥ä¹Ÿç»å¸¸ç”¨æ¥å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œå½¢å¼å¦‚ä¸‹ï¼š123456PS C:\Users\starky&gt; $result = if(Get-Process -n notepad) &#123; &quot;Running&quot; &#125; else &#123; &quot;Not running&quot; &#125;Get-Process : æ‰¾ä¸åˆ°åä¸ºâ€œnotepadâ€çš„è¿›ç¨‹ã€‚è¯·éªŒè¯è¯¥è¿›ç¨‹åç§°ï¼Œç„¶åŽå†æ¬¡è°ƒç”¨ cmdletã€‚...PS C:\Users\starky&gt; $resultNot running é€šå¸¸æƒ…å†µä¸‹ï¼Œä½¿ç”¨ switch è¯­å¥å¯ä»¥æ›¿ä»£åŒ…å«å¤§é‡ if ... elseif ... else çš„è¯­å¥ã€‚PowerShell çš„ switch åœ¨å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œæ¡ä»¶åˆ¤æ–­æ—¶ï¼Œæ”¯æŒå¤šç§é€‰é¡¹çš„ä½¿ç”¨ï¼Œå¦‚é€šé…ç¬¦ã€æ­£åˆ™è¡¨è¾¾å¼ç”šè‡³ç®€çŸ­çš„ä»£ç å—ï¼Œç›¸æ¯”äºŽ C å’Œ C++ ä¸­çš„ switch è¯­å¥æ›´æ˜¾å¾—å¼ºå¤§ã€‚ 12345678910$temperature = 35switch($temperature)&#123; &#123; $_ -lt 0 &#125; &#123; &quot;Below Freezing&quot;; break &#125; 32 &#123; &quot;Exactly Freezing&quot;; break &#125; &#123; $_ -le 10 &#125; &#123; &quot;Cold&quot;; break &#125; &#123; $_ -le 20 &#125; &#123; &quot;Warm&quot;; break &#125; default &#123; &quot;Hot&quot; &#125;&#125; å¾ªçŽ¯for å¾ªçŽ¯ï¼š1234for($counter = 1; $counter -le 10; $counter++)&#123; &quot;Loop number $counter&quot;&#125; foreach å¾ªçŽ¯ï¼š1234foreach($file in dir)&#123; &quot;File name: &quot; + $file.Name&#125; æˆ–è€…ï¼šdir | foreach { &quot;File name: &quot; + $_.Name } while å¾ªçŽ¯ï¼š12345$response = &quot;&quot;while($response -ne &quot;QUIT&quot;)&#123; $response = Read-Host &quot;Type something&quot;&#125; do..while å¾ªçŽ¯ï¼š12345$response = &quot;&quot;do&#123; $response = Read-Host &quot;Type something&quot;&#125; while($response -ne &quot;QUIT&quot;) do..until å¾ªçŽ¯ï¼š12345$response = &quot;&quot;do&#123; $response = Read-Host &quot;Type something&quot;&#125; until($response -eq &quot;QUIT&quot;) å‚è€ƒä¹¦ç±Windows PowerShell Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Windows</tag>
        <tag>Program</tag>
        <tag>Script</tag>
        <tag>PowerShell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows PowerShell å­¦ä¹ ç¬”è®°å…¶ä¸€ï¼ˆç‰¹æ€§ä»‹ç»ï¼‰]]></title>
    <url>%2F2019%2F02%2F26%2Fwindows-powershell-cookbook-1%2F</url>
    <content type="text"><![CDATA[PowerShell æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è‡ªåŠ¨åŒ–å’Œé…ç½®å·¥å…·ï¼ˆæ¡†æž¶ï¼‰ï¼Œåœ¨å¤„ç†ç»“æž„åŒ–æ•°æ®ï¼ˆå¦‚ JSONã€CSVã€XML ç­‰ï¼‰ã€REST API å’Œå¯¹è±¡æ¨¡åž‹æ–¹é¢åšäº†å¤§é‡é’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäºŽä»»åŠ¡çš„å‘½ä»¤è¡Œç»ˆç«¯ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªæž„å»ºåœ¨ .NET ä¸Šçš„è„šæœ¬è¯­è¨€ã€‚å¯¹äºŽè‡ªåŠ¨åŒ–ç³»ç»Ÿç®¡ç†ä»»åŠ¡æœ‰æžå¤§çš„å¸®åŠ©ã€‚ å…¶åŸºæœ¬ç‰¹æ€§å¦‚ä¸‹ï¼š PowerShell å¯ä»¥ä¸ŽåŸºç¡€çš„ Windows å‘½ä»¤å’Œåº”ç”¨å®Œç¾Žæ•´åˆ å¼•å…¥äº†ä¸€ç§æ–°çš„å‘½ä»¤å½¢å¼ï¼ˆcmdletsï¼‰ï¼Œä½¿ç”¨ Verb-Noun å½¢å¼çš„è¯­æ³•ï¼Œå¯¹æ¯”æ™®é€šå‘½ä»¤æœ‰æ›´é«˜çš„çµæ´»åº¦ PowerShell èƒ½å¤Ÿâ€œç†è§£â€å¯¹è±¡ï¼Œå¯ä»¥ç›´æŽ¥å¤„ç†ç»“æž„åŒ–çš„æ•°æ®å¯¹è±¡ï¼ŒåŒºåˆ«äºŽæ™®é€š Shell çš„â€œçº¯æ–‡æœ¬â€ å¯ä»¥åŒå¤šç§æŠ€æœ¯ç›´æŽ¥æ•´åˆä½¿ç”¨ã€‚å¦‚ .NETã€COMã€WMIã€XML å’Œæ´»åŠ¨ç›®å½•ç­‰ ç®€å•åŒ– data store çš„ç®¡ç†ï¼ˆä½¿ç”¨å’Œç®¡ç†æ–‡ä»¶åŒæ ·çš„æŠ€æœ¯ï¼‰ ç»“æž„åŒ–å‘½ä»¤ï¼ˆCmdletsï¼‰PowerShell å¼•å…¥äº†ä¸€ç§åä¸º Cmdlets çš„æ–°åž‹å‘½ä»¤ã€‚æ‰€æœ‰çš„ cmdlets å‘½ä»¤éƒ½ä»¥ Verb-Noun çš„å½¢å¼å‘½åï¼Œå¦‚ Get-Processã€Get-Contentã€Stop-Process ç­‰ã€‚123456789PS C:\Users\starky&gt; Get-Process -Name chromeHandles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 285 36 80040 93808 620 104.61 1384 chrome 201 16 9000 7296 121 0.05 3572 chrome 1061 73 57324 99924 550 145.21 4052 chrome 221 17 8864 7952 131 0.08 5832 chrome 260 30 209528 154748 534 118.55 6408 chrome åœ¨äº¤äº’å¼çš„å‘½ä»¤è¡ŒçŽ¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;TAB&gt; é”®è‡ªåŠ¨è¡¥å…¨å‘½ä»¤å’Œå‚æ•°ã€‚å¦‚ä¸Šè¿°å‘½ä»¤ä¹Ÿå¯ä»¥è¿™æ ·è¾“å…¥ï¼šGet-Pr&lt;TAB&gt; -N&lt;TAB&gt; c&lt;TAB&gt; å¤§éƒ¨åˆ† Verb-Noun å½¢å¼çš„å‘½ä»¤æ‰‹åŠ¨è¾“å…¥æ—¶ä»æ˜¾å¾—æœ‰äº›é•¿ï¼Œæ‰€ä»¥ PowerShell ä¸ºæ‰€æœ‰å¸¸ç”¨çš„å‘½ä»¤æä¾›äº†ç®€çŸ­çš„åˆ«åã€‚å¦‚ Get-Process çš„åˆ«åå³ä¸º gps ã€‚123456789101112131415161718192021222324252627282930313233PS C:\Users\starky&gt; gps -n explorerHandles NPM(K) PM(K) WS(K) VM(M) CPU(s) Id ProcessName------- ------ ----- ----- ----- ------ -- ----------- 841 56 36280 35632 279 6.36 2552 explorerPS C:\Users\starky&gt; Get-AliasCommandType Name ModuleName----------- ---- ----------Alias % -&gt; ForEach-ObjectAlias ? -&gt; Where-ObjectAlias ac -&gt; Add-ContentAlias asnp -&gt; Add-PSSnapinAlias cat -&gt; Get-ContentAlias cd -&gt; Set-LocationAlias chdir -&gt; Set-LocationAlias clc -&gt; Clear-ContentAlias clear -&gt; Clear-HostAlias clhy -&gt; Clear-HistoryAlias cli -&gt; Clear-ItemAlias clp -&gt; Clear-ItemPropertyAlias cls -&gt; Clear-HostAlias clv -&gt; Clear-VariableAlias cnsn -&gt; Connect-PSSessionAlias compare -&gt; Compare-ObjectAlias copy -&gt; Copy-ItemAlias cp -&gt; Copy-ItemAlias cpi -&gt; Copy-ItemAlias cpp -&gt; Copy-ItemPropertyAlias curl -&gt; Invoke-WebRequest... ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œgps å³ Get-Process å‘½ä»¤çš„åˆ«åï¼Œ-n é€‰é¡¹ç­‰åŒäºŽ -Nameã€‚å®žé™…ä¸Š -n é€‰é¡¹æ­¤å¤„ä¹Ÿå¯ä»¥çœç•¥ï¼ˆé»˜è®¤å³æ ¹æ®åç§°ç­›é€‰è¿›ç¨‹ï¼‰ã€‚ å¯¹è±¡çš„æ·±åº¦æ•´åˆPowerShell å¯ä»¥ç›´æŽ¥å¤„ç†å¤æ‚çš„ç»“æž„åŒ–æ•°æ®å’ŒåŠŸèƒ½å®Œæ•´çš„å¯¹è±¡ã€‚å¦‚ä»¥ä¸‹å‘½ä»¤ç”¨äºŽåˆ›å»ºä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼š12PS C:\Users\starky&gt; &quot;Hello World&quot;Hello World äº‹å®žä¸Šåˆšåˆšåˆ›å»ºçš„ â€œHello Worldâ€ å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå…·æœ‰å®Œæ•´åŠŸèƒ½çš„å¯¹è±¡ï¼ˆæ¥æºäºŽ .NET æ¡†æž¶ï¼‰ï¼Œå¯ä»¥é€šè¿‡ . ç¬¦å·è®¿é—®å…¶å±žæ€§ï¼š12PS C:\Users\starky&gt; &quot;Hello World&quot;.Length11 æ‰€æœ‰çš„ PowerShell å‘½ä»¤éƒ½ä¼šå°†å…¶è¾“å‡ºå†…å®¹ä½œä¸ºå¯¹è±¡ï¼ŒåŒæ—¶è¯¥å¯¹è±¡å¯ä»¥è¢«èµ‹å€¼ç»™ä»»æ„ä¸€ä¸ªå˜é‡ã€‚å¦‚ Get-Process cmdlet ä¼šç”Ÿæˆä¸€ä¸ª System.Diagnostics.Process å¯¹è±¡ã€‚12345PS C:\Users\starky&gt; notepadPS C:\Users\starky&gt; $process = Get-Process notepadPS C:\Users\starky&gt; $process.kill()PS C:\Users\starky&gt; Get-Process notepadGet-Process : æ‰¾ä¸åˆ°åä¸ºâ€œnotepadâ€çš„è¿›ç¨‹ã€‚è¯·éªŒè¯è¯¥è¿›ç¨‹åç§°ï¼Œç„¶åŽå†æ¬¡è°ƒç”¨ cmdletã€‚ ç®¡ç†å‘˜ä½œä¸ºâ€œç¬¬ä¸€ç­‰çº§â€ç”¨æˆ·PowerShell å§‹ç»ˆå°†ç®¡ç†å‘˜æ‰§è¡Œçš„ä»»åŠ¡ä½œä¸ºå…³æ³¨çš„ç„¦ç‚¹ï¼Œæ¯”å¦‚åœ¨ç»ˆç«¯ä¸­å¯ä»¥ç›´æŽ¥å®Œæˆæ­¤ç§ç±»åž‹çš„è®¡ç®—ï¼š12PS C:\Users\starky&gt; 40GB / 650MB63.0153846153846 å€ŸåŠ©äºŽ .NET æ¡†æž¶æä¾›çš„æ”¯æŒï¼ŒPowerShell è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„â€œæ—¥åŽ†â€åº”ç”¨ï¼š12PS C:\Users\starky&gt; [DateTime]::IsLeapYear(2008)True 12345678PS C:\Users\starky&gt; [DateTime]::Now2019å¹´2æœˆ18æ—¥ 21:32:03PS C:\Users\starky&gt; $result = [DateTime] &quot;06/21/2019&quot; - [DateTime]::NowPS C:\Users\starky&gt; $result.TotalDays122.102253218295 ç»„åˆå‘½ä»¤å¯ä»¥ä½¿ç”¨ç®¡é“ç¬¦ï¼ˆ|ï¼‰å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘è‡³å¦ä¸€ä¸ªå‘½ä»¤ä½œä¸ºè¾“å…¥ï¼Œå’Œ Bash ä¸­ç®¡é“ç¬¦çš„ä½¿ç”¨ä¸€æ ·ã€‚å¦‚ï¼šGet-Item Path1\* | Move-Item -Destination Path2ä¸Šè¿°å‘½ä»¤å°† Path1 ä¸­çš„æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ° Path2 ç›®å½•ä¸‹ã€‚ æ›´å¤æ‚çš„å½¢å¼å¦‚ï¼š123456789101112131415PS C:\Users\starky&gt; Get-Process | Where-Object &#123; $_.Handles -ge 1000 &#125; | Sort-Object Handles | Format-Table Handles,Name,Desciption -AutoHandles Name Description------- ---- ----------- 1023 dwm æ¡Œé¢çª—å£ç®¡ç†å™¨ 1025 chrome Google Chrome 1096 SkypeApp SkypeApp 1107 Microsoft.Photos Microsoft.Photos.exe 1126 svchost Windows æœåŠ¡ä¸»è¿›ç¨‹ 1236 svchost Windows æœåŠ¡ä¸»è¿›ç¨‹ 1425 SearchUI Search and Cortana application 1437 lsass Local Security Authority Process 1712 chrome Google Chrome 2592 explorer Windows èµ„æºç®¡ç†å™¨ 3410 System é€šè¿‡ Get-Process å‘½ä»¤èŽ·å–å½“å‰æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯ï¼Œä½¿ç”¨ Where-Object { $_.Handles -ge 1000 } å‘½ä»¤ç­›é€‰å‡º Handles åœ¨ 1000 ä»¥ä¸Šçš„å¯¹è±¡ï¼ŒSort-Object Handles å‘½ä»¤ç”¨æ¥é€šè¿‡ Handles å±žæ€§æŽ’åºï¼ŒFormat-Table ... å‘½ä»¤ç”¨æ¥å¯¹è¾“å‡ºç»“æžœè¿›è¡Œæ ¼å¼åŒ–ã€‚ é€šè¿‡åˆ«åçš„ç®€åŒ–ï¼Œä¸Šè¿°å‘½ä»¤ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å½¢å¼ï¼šgps | ? { $_.Handles -ge 1000 } | sort Handles | ft Handles,Name,Description -Auto â€œå‘çŽ°â€å‘½ä»¤å¯ä»¥é€šè¿‡ Get-Command cmdlet è¿›è¡Œæ¨¡ç³Šæœç´¢ï¼ŒæŸ¥è¯¢å¯èƒ½ç”¨åˆ°çš„å‘½ä»¤ï¼Œå¦‚éœ€è¦ä½¿ç”¨â€œè¿›ç¨‹â€ç›¸å…³çš„å‘½ä»¤ï¼š123456789101112131415161718PS C:\Users\starky&gt; Get-Command *process*CommandType Name Version Source----------- ---- ------- ------Function Get-AppvVirtualProcess 1.0.0.0 AppvClientFunction Start-AppvVirtualProcess 1.0.0.0 AppvClientCmdlet ConvertTo-ProcessMitigationPolicy 1.0.11 ProcessMitigationsCmdlet Debug-Process 3.1.0.0 Microsoft.PowerShell.ManagementCmdlet Enter-PSHostProcess 3.0.0.0 Microsoft.PowerShell.CoreCmdlet Exit-PSHostProcess 3.0.0.0 Microsoft.PowerShell.CoreCmdlet Get-Process 3.1.0.0 Microsoft.PowerShell.ManagementCmdlet Get-ProcessMitigation 1.0.11 ProcessMitigationsCmdlet Get-PSHostProcessInfo 3.0.0.0 Microsoft.PowerShell.CoreCmdlet Set-ProcessMitigation 1.0.11 ProcessMitigationsCmdlet Start-Process 3.1.0.0 Microsoft.PowerShell.ManagementCmdlet Stop-Process 3.1.0.0 Microsoft.PowerShell.ManagementCmdlet Wait-Process 3.1.0.0 Microsoft.PowerShell.ManagementApplication qprocess.exe 10.0.17... C:\Windows\system32\qprocess.exe å¦‚éœ€è¦èŽ·å–æŸä¸ªå‘½ä»¤çš„å…·ä½“å¸®åŠ©ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ Get-Help cmdletï¼š12345678910111213141516171819202122232425262728293031323334353637383940PS C:\Users\starky&gt; Get-Help Stop-Processåç§° Stop-Processæ‘˜è¦ Stops one or more running processes.è¯­æ³• Stop-Process [-Id] &lt;Int32[]&gt; [-Confirm] [-Force] [-PassThru] [-WhatIf] [&lt;CommonParameters&gt;] Stop-Process [-InputObject] &lt;Process[]&gt; [-Confirm] [-Force] [-PassThru] [-WhatIf] [&lt;CommonParameters&gt;] Stop-Process [-Confirm] [-Force] -Name &lt;String[]&gt; [-PassThru] [-WhatIf] [&lt;CommonParameters&gt;]è¯´æ˜Ž The Stop-Process cmdlet stops one or more running processes. You can specify a process by process name or process I D (PID), or pass a process object to Stop-Process . Stop-Process works only on processes running on the local compu ter. On Windows Vista and later versions of the Windows operating system, to stop a process that is not owned by the cur rent user, you must start Windows PowerShell by using the Run as administrator option. Also, you are prompted for c onfirmation unless you specify the Force parameter.ç›¸å…³é“¾æŽ¥ Online Version: http://go.microsoft.com/fwlink/?LinkId=821642 Debug-Process Get-Process Start-Process Stop-Process Wait-Processå¤‡æ³¨ è‹¥è¦æŸ¥çœ‹ç¤ºä¾‹ï¼Œè¯·é”®å…¥: &quot;get-help Stop-Process -examples&quot;. æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·é”®å…¥: &quot;get-help Stop-Process -detailed&quot;. è‹¥è¦èŽ·å–æŠ€æœ¯ä¿¡æ¯ï¼Œè¯·é”®å…¥: &quot;get-help Stop-Process -full&quot;. æœ‰å…³åœ¨çº¿å¸®åŠ©ï¼Œè¯·é”®å…¥: &quot;get-help Stop-Process -online&quot; PowerShell å¯ä»¥ç›´æŽ¥æ“ä½œä»Ž .NET æ¡†æž¶ä¸­å¼•å…¥çš„æ•°æ®å¯¹è±¡ï¼Œé€šè¿‡å°†æŸä¸ªå¯¹è±¡ä¼ é€’ç»™ Get-Member cmdletï¼Œå¯ä»¥èŽ·å–ç»‘å®šäºŽè¯¥å¯¹è±¡çš„å±žæ€§å’Œæ–¹æ³•ç­‰ï¼š1234567891011121314151617181920212223PS C:\Users\starky&gt; &quot;Hello World&quot; | Get-Member TypeName:System.StringName MemberType Definition---- ---------- ----------...IndexOf Method int IndexOf(char value), int IndexOf(char value, int startIndex), int IndexOf...IndexOfAny Method int IndexOfAny(char[] anyOf), int IndexOfAny(char[] anyOf, int startIndex), i...Insert Method string Insert(int startIndex, string value)IsNormalized Method bool IsNormalized(), bool IsNormalized(System.Text.NormalizationForm normaliz...LastIndexOf Method int LastIndexOf(char value), int LastIndexOf(char value, int startIndex), int...LastIndexOfAny Method int LastIndexOfAny(char[] anyOf), int LastIndexOfAny(char[] anyOf, int startI...Normalize Method string Normalize(), string Normalize(System.Text.NormalizationForm normalizat...PadLeft Method string PadLeft(int totalWidth), string PadLeft(int totalWidth, char paddingChar)PadRight Method string PadRight(int totalWidth), string PadRight(int totalWidth, char padding...Remove Method string Remove(int startIndex, int count), string Remove(int startIndex)Replace Method string Replace(char oldChar, char newChar), string Replace(string oldValue, s...Split Method string[] Split(Params char[] separator), string[] Split(char[] separator, int...StartsWith Method bool StartsWith(string value), bool StartsWith(string value, System.StringCom...Substring Method string Substring(int startIndex), string Substring(int startIndex, int length)... åŽå°è¿è¡ŒPowerShell å¯ä»¥é€šè¿‡ Start-Job å°†æŒ‡å®šå‘½ä»¤ä»¥åŽå°ä»»åŠ¡çš„å½¢å¼è¿è¡Œã€‚å¦‚ï¼š1234567891011121314151617PS C:\Users\starky&gt; Start-Job &#123; while($true) &#123; Get-Random; Start-Sleep 5 &#125; &#125; -Name SleeperId Name PSJobTypeName State HasMoreData Location Command-- ---- ------------- ----- ----------- -------- -------2 Sleeper BackgroundJob Running True localhost while($true) &#123; Get-Ra...PS C:\Users\starky&gt; Receive-Job Sleeper20136626437901827701345543150PS C:\Users\starky&gt; Stop-Job SleeperPS C:\Users\starky&gt; Get-JobId Name PSJobTypeName State HasMoreData Location Command-- ---- ------------- ----- ----------- -------- -------2 Sleeper BackgroundJob Stopped True localhost while($true) &#123; Get-Ra... å…¶ä¸­ Receive-Job ç”¨äºŽèŽ·å–åŽå°ä»»åŠ¡çš„å‘½ä»¤è¾“å‡ºï¼ŒStop-Job ç”¨äºŽåœæ­¢ä»»åŠ¡çš„è¿è¡Œï¼ŒGet-Job ç”¨äºŽèŽ·å–å½“å‰ä¼šè¯å·²ç»‘å®šçš„æ‰€æœ‰ä»»åŠ¡ã€‚æ­¤å¤–è¿˜æœ‰ Remove-Job ç”¨äºŽå°†æ´»åŠ¨ä»»åŠ¡ä»Žåˆ—è¡¨é‡Œç§»é™¤ã€‚ é™¤äº†ä½¿ç”¨ Start-Job cmdlet ç”ŸæˆåŽå°ä»»åŠ¡ï¼Œè¿˜å¯ä»¥é€šè¿‡åœ¨å¾ˆå¤š cmdlets åŽé¢åŠ ä¸Š -AsJob é€‰é¡¹å°†å…¶æŒ‡å®šä¸ºåŽå°è¿è¡Œã€‚ è„šæœ¬è¯­è¨€PowerShell å®žé™…ä¸Šä¸åªæ˜¯ä¸€ä¸ªç®€å•çš„äº¤äº’å¼ç»ˆç«¯ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å¼ºå¤§çš„è„šæœ¬è¯­è¨€ã€‚æ‰€ä»¥æ”¯æŒä¼—å¤šçš„ç¼–ç¨‹ç‰¹æ€§ï¼Œå¦‚ï¼š1234PS C:\Users\starky&gt; $handleCount = 0PS C:\Users\starky&gt; foreach($process in Get-Process) &#123; $handleCount += $process.Handles &#125;PS C:\Users\starky&gt; $handleCount69841 ç”šè‡³å¦‚ä¸‹çš„å½¢å¼ï¼š123456789101112131415PS C:\Users\starky&gt; $webClient = New-Object System.Net.WebClientPS C:\Users\starky&gt; $content = $webClient.DownloadString(&quot;http://blogs.msdn.com/PowerShell/rss.aspx&quot;)PS C:\Users\starky&gt; $content.Substring(0,500)&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;rss version=&quot;2.0&quot; xmlns:content=&quot;http://purl.org/rss/1.0/modules/content/&quot; xmlns:wfw=&quot;http://wellformedweb.org/CommentAPI/&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; xmlns:sy=&quot;http://purl.org/rss/1.0/modules/syndication/&quot; xmlns:slash=&quot;http://purl.org/rss/1.0/modules/slash/&quot; &gt;&lt;channel&gt; &lt;title&gt;PowerShell Team Blog&lt;/title&gt; &lt;atom:link href=&quot;https://blogs.msdn.microsoft.com/powershell/feed/&quot; rel=&quot;s æ•´åˆå…¶ä»–æŠ€æœ¯PowerShell ä¹Ÿæ”¯æŒæ“ä½œ WMIï¼ˆWindows Management Instrumentationï¼‰å’Œ CIM å¯¹è±¡ï¼š12345678PS C:\Users\starky&gt; Get-CimInstance Win32_BiosSMBIOSBIOSVersion : D5CN31WWManufacturer : LENOVOName : D5CN31WWSerialNumber : PF0F77WRVersion : LENOVO - 1 åˆå¦‚æ“ä½œ COM å¯¹è±¡ï¼š1234567891011121314PS C:\Users\starky&gt; $firewall = New-Object -com HNetCfg.FwMgrPS C:\Users\Administrator&gt; $firewall.LocalPolicy.CurrentProfileType : 1FirewallEnabled : TrueExceptionsNotAllowed : FalseNotificationsDisabled : FalseUnicastResponsesToMulticastBroadcastDisabled : FalseRemoteAdminSettings : System.__ComObjectIcmpSettings : System.__ComObjectGloballyOpenPorts : System.__ComObjectServices : System.__ComObjectAuthorizedApplications : System.__ComObject ProvidersPowerShell å¯ä»¥é€šè¿‡ Providers åƒæµè§ˆç›®å½•é‚£æ ·æµè§ˆç³»ç»Ÿä¸­çš„ data storeã€‚å¦‚æµè§ˆæ³¨å†Œè¡¨çš„æŸä¸ªåˆ†æ”¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041PS C:\Users\starky&gt; Set-Location HKCU:\Software\Microsoft\WindowsPS HKCU:\Software\Microsoft\Windows&gt; Get-ChildItem Hive: HKEY_CURRENT_USER\Software\Microsoft\WindowsName Property---- --------AssignedAccessConfigurationCurrentVersionDWM Composition : 1 ColorizationColor : 3288365271 ColorizationColorBalance : 89 ColorizationAfterglow : 3288365271 ColorizationAfterglowBalance : 10 ColorizationBlurBalance : 1 EnableWindowColorization : 0 ColorizationGlassAttribute : 1 AccentColor : 4292311040 ColorPrevalence : 0 EnableAeroPeek : 1 AlwaysHibernateThumbnails : 0 UseDpiScaling : 0ShellTabletPCWindows Error Reporting LastQueuePesterTime : 131873467252566492WinlogonPS HKCU:\Software\Microsoft\Windows&gt; Set-Location CurrentVersion\RunPS HKCU:\Software\Microsoft\Windows\CurrentVersion\Run&gt; Get-ItemProperty .OneDrive : &quot;C:\Users\Administrator\AppData\Local\Microsoft\OneDrive\OneDrive.exe&quot; /backgroundLantern : &quot;C:\Users\Administrator\AppData\Roaming\Lantern\lantern.exe&quot; -startupPSPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunPSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersionPSChildName : RunPSDrive : HKCUPSProvider : Microsoft.PowerShell.Core\Registry å³ä½¿ç”¨ Set-Locationï¼ˆæˆ– cdï¼‰å’Œ Get-ChildItemï¼ˆæˆ– dir ï¼‰åƒæµè§ˆæœ¬åœ°ç›®å½•ä¸€æ ·æµè§ˆè®¿é—®æ³¨å†Œè¡¨ã€‚ åŒæ ·çš„æ–¹å¼ä¹Ÿé€‚ç”¨äºŽç³»ç»Ÿé‡Œçš„è¯ä¹¦åº“ï¼š1234567891011121314PS C:\users\starky&gt; Set-Location cert:\CurrentUser\RootPS Cert:\CurrentUser\Root&gt; Get-ChildItem PSParentPath:Microsoft.PowerShell.Security\Certificate::CurrentUser\RootThumbprint Subject---------- -------CDD4EEAE6000AC7F40C3802C171E30148030C072 CN=Microsoft Root Certificate Authority, DC=microsoft, DC=comBE36A4562FB2EE05DBB3D32323ADF445084ED656 CN=Thawte Timestamping CA, OU=Thawte Certification, O=Thawte, L=Durbanvill...A43489159A520F0D93D032CCAF37E7FE20A8B419 CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 19...92B46C76E13054E104F230517E6E504D43AB10B5 CN=Symantec Enterprise Mobile Root for Microsoft, O=Symantec Corporation, ...8F43288AD272F3103B6FB1428485EA3014C0BCFE CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=R...... å‚è€ƒä¹¦ç±Windows PowerShell Cookbook, 3rd Edition]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Windows</tag>
        <tag>Program</tag>
        <tag>PowerShell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Arduino IDE æ­å»º ESP8266 å¼€å‘çŽ¯å¢ƒåŠé¡¹ç›®æ¼”ç¤º]]></title>
    <url>%2F2019%2F01%2F11%2Fprogramming-esp8266-with-arduino-ide%2F</url>
    <content type="text"><![CDATA[ESP8266 æ˜¯ä¸€æ¬¾ç”±ä¹é‘« Espressif å…¬å¸åˆ¶ä½œçš„ä½Žæˆæœ¬çš„ Wi-Fi èŠ¯ç‰‡ï¼Œå…·æœ‰å®Œæ•´çš„ TCP / IP åè®®æ ˆå’Œå¾®æŽ§åˆ¶å™¨åŠŸèƒ½ã€‚å®ƒä¸“ä¸ºç§»åŠ¨è®¾å¤‡ã€å¯ç©¿æˆ´ç”µå­äº§å“å’Œç‰©è”ç½‘åº”ç”¨è®¾è®¡ï¼ŒåŠŸè€—å¾ˆä½Žä¸”ä»·æ ¼éžå¸¸ä½Žå»‰ã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„ NodeMcu å¼€å‘æ¿å³æ­è½½äº†è¿™æ¬¾èŠ¯ç‰‡ã€‚ Arduino IDE æ˜¯ç”± Arduino å®˜æ–¹æä¾›çš„æ”¯æŒ C è¯­è¨€çš„é›†æˆå¼€å‘çŽ¯å¢ƒï¼Œä¸»è¦æ˜¯é’ˆå¯¹ Arduino ç³»åˆ—çš„å¼€å‘æ¿è¿›è¡Œç¼–ç¨‹ã€‚é€šè¿‡ç®€å•çš„é…ç½®ï¼Œå¯ä»¥åœ¨åŽŸæœ¬çš„ç¼–ç¨‹çŽ¯å¢ƒé‡Œæ·»åŠ ä¸Šå¯¹ ESP8266 å¼€å‘æ¿çš„æ”¯æŒã€‚å¯¹äºŽç†Ÿæ‚‰ Arduino å‡½æ•°åº“å’Œå¼€å‘æµç¨‹çš„ç”¨æˆ·ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰ä»»ä½•ä½¿ç”¨ä¸Šçš„åŒºåˆ«ã€‚ ä¸€ã€æ·»åŠ  ESP8266 æ”¯æŒé¦–å…ˆä»Ž Arduino å®˜ç½‘ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Arduino IDE è½¯ä»¶å¹¶å®‰è£…ã€‚å®‰è£…å®Œæˆä»¥åŽï¼Œè¿›å…¥é¦–é€‰é¡¹ï¼ˆPreferencesï¼‰ï¼Œæ‰¾åˆ°é™„åŠ å¼€å‘æ¿ç®¡ç†å™¨åœ°å€ï¼ˆAdditional Board Manager URLsï¼‰ï¼Œå¹¶åœ¨å…¶åŽæ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼šhttp://arduino.esp8266.com/stable/package_esp8266com_index.json ä¹‹åŽç‚¹å‡»å·¥å…· - å¼€å‘æ¿ - å¼€å‘æ¿ç®¡ç†å™¨ï¼Œè¿›å…¥å¼€å‘æ¿ç®¡ç†å™¨ç•Œé¢ï¼š æ‰¾åˆ° esp8266 å¹¶å®‰è£…ï¼š å®‰è£…å®ŒæˆåŽï¼Œé‡å¯ Arduino IDE è½¯ä»¶ã€‚åœ¨å·¥å…· - å¼€å‘æ¿é€‰é¡¹ä¸­å³ä¼šçœ‹åˆ° ESP8266 å¼€å‘æ¿çš„é€‰é¡¹ï¼š äºŒã€æµ‹é‡æ¸©æ¹¿åº¦æœ¬ä¾‹ä¸­ä½¿ç”¨ DHT11 æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨æµ‹é‡å®¤å†…æ¸©åº¦å’Œæ¹¿åº¦ï¼Œå†æŠŠæµ‹é‡æ‰€å¾—çš„ç»“æžœè¾“å‡ºè‡³ Arduino IDE çš„ä¸²å£ç›‘è§†å™¨ä¸­ã€‚ æºä»£ç åœ¨ Arduino IDE ä¸­æ–°å»ºé¡¹ç›®å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233#include &quot;DHT.h&quot;#define DHTPIN 5#define DHTTYPE DHT11// Initialize DHT sensorDHT dht(DHTPIN, DHTTYPE, 15);void setup() &#123; // Start Serial Serial.begin(115200); // Init DHT dht.begin();&#125;void loop() &#123; // Reading temperature and humidity float h = dht.readHumidity(); float t = dht.readTemperature(); // Display data Serial.print(&quot;Humidity: &quot;); Serial.print(h); Serial.print(&quot; %\t&quot;); Serial.print(&quot;Temperature: &quot;); Serial.print(t); Serial.println(&quot; *C &quot;); // Wait a few seconds between measurements. delay(2000);&#125; ç”±äºŽæºä»£ç ä¸­é¦–è¡Œå¼•å…¥çš„ DHT åº“å¹¶ä¸æ˜¯ Arduino IDE å†…ç½®çš„åº“æ–‡ä»¶ï¼Œéœ€è¦å…ˆç‚¹å‡»é¡¹ç›® - åŠ è½½åº“ - ç®¡ç†åº“è¿›å…¥åº“ç®¡ç†å™¨ï¼Œæœç´¢å®‰è£…å¦‚ä¸‹ä¸¤ä¸ªä¾èµ–åº“ï¼ˆAdafruit Unified Sensor å’Œ DHT sensor libraryï¼‰ï¼š çº¿è·¯è¿žæŽ¥è¯¥æµ‹è¯•é¡¹ç›®åªéœ€è¦è¿žæŽ¥å¥½ NodeMcu å¼€å‘æ¿ä¸Ž DHT11 æ¸©æ¹¿åº¦æ¨¡å—ï¼ˆæˆ–è€…å•ç‹¬çš„ DHT11 å…ƒä»¶é…åˆ 5kÎ© çš„ä¸Šæ‹‰ç”µé˜»ï¼‰ï¼Œæ— éœ€é¢å¤–çš„ä¼ æ„Ÿå™¨æ¨¡å—å’Œç”µå­ç»„ä»¶ã€‚ çº¿è·¯è¿žæŽ¥ç¤ºæ„å›¾å¦‚ä¸‹ï¼š NodeMcu DHT11 3V3 VCCï¼ˆPin1ï¼‰ GND GNDï¼ˆPin4ï¼‰ D1 DATA(Pin2ï¼‰ 3V3 5k ç”µé˜» - DATAï¼ˆPin2ï¼‰ ç¼–è¯‘è¿è¡ŒArduino IDE å®žé™…ä¸Šæ”¯æŒéžå¸¸å¤šçš„åŸºäºŽ ESP8266 èŠ¯ç‰‡è®¾è®¡çš„å¼€å‘æ¿ï¼Œå¦‚ Adafruit Feather HUZZAH ESP8266ã€LOLIN (WEMOS) D1 mini ç­‰ã€‚å¯ä»¥æ ¹æ®è‡ªå·±è´­ä¹°çš„å¼€å‘æ¿çš„å…·ä½“åž‹å·ï¼Œåœ¨ç¼–è¯‘å‰é€‰æ‹©å¯¹åº”çš„å¼€å‘æ¿é€‰é¡¹ï¼ˆå·¥å…· - å¼€å‘æ¿ï¼‰ã€‚ æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯å¼€æºçš„ NodeMcu v1.0 å¼€å‘æ¿ï¼Œç¼–è¯‘ä»£ç å‰ç¡®ä¿é€‰æ‹©æ­£ç¡®ï¼š æœ€ç»ˆçš„è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼šå‘ƒï¼Œï¼Œå—æ–¹çš„å†¬å¤©ï¼Œå¤–é¢åœ¨ä¸‹é›¨ã€‚å®¤å†…ï¼Œæ²¡å¼€ç©ºè°ƒã€‚ã€‚ã€‚ï¼ˆåŽé¢æ¸©æ¹¿åº¦å‡é«˜æ˜¯å› ä¸ºï¼Œæˆ‘å¯¹ç€ä¼ æ„Ÿå™¨å“ˆæ°”äº†ã€‚ã€‚ã€‚ï¼‰ æ³¨æ„äº‹é¡¹å¯ä»¥çœ‹åˆ°ï¼Œæºä»£ç ä¸­çš„ DHTPIN ï¼ˆå³ä¼ æ„Ÿå™¨ DATA å¼•è„šéœ€è¦è¿žæŽ¥çš„å¼€å‘æ¿å¼•è„š ï¼‰å®šä¹‰ä¸º 5 ï¼Œä½†å¼€å‘æ¿å®žé™…è¿žæŽ¥çš„æ˜¯ D1 å¼•è„šï¼ˆè€Œä¸æ˜¯ D5ï¼‰ã€‚ ESP8266 èŠ¯ç‰‡æœ‰è‡ªå·±çš„å¼•è„šï¼ˆGPIOï¼‰å¸ƒå±€ï¼Œä½†æ˜¯åŸºäºŽè¯¥èŠ¯ç‰‡è®¾è®¡çš„ä¼—å¤šå¼€å‘æ¿ï¼Œå¯¹äºŽèŠ¯ç‰‡ä¸Š GPIO çš„å¼•å‡ºæ–¹å¼å´æœ‰è‡ªå·±çš„è§„åˆ™ã€‚å³æºä»£ç ä¸­çš„ 5 æŒ‡çš„å¹¶ä¸æ˜¯å¼€å‘æ¿çš„å¼•è„š D5 ï¼Œè€Œæ˜¯ ESP8266 çš„å¼•è„š GPIO 5 ï¼Œå¯¹åº”åˆ°å¼€å‘æ¿ä¸Šå³æ˜¯ D1 å¼•è„šã€‚ ç›¸å…³çš„å¼•è„šå¸ƒå±€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‰ã€Wi-Fi è¿žæŽ¥ESP8266 æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å…¶è¶…ä½Žæˆæœ¬çš„ Wi-Fi å®žçŽ°ã€‚è¿™é‡Œç®€å•è´´å‡ºå…¶è¿žæŽ¥ Wi-Fi çš„ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324252627// Import required libraries#include &lt;ESP8266WiFi.h&gt;// WiFi parametersconst char* ssid = &quot;your_wifi_name&quot;;const char* password = &quot;your_wifi_password&quot;;void setup(void)&#123; // Start Serial Serial.begin(115200); // Connect to WiFi WiFi.begin(ssid, password); while (WiFi.status() != WL_CONNECTED) &#123; delay(500); Serial.print(&quot;.&quot;); &#125; Serial.println(&quot;&quot;); Serial.println(&quot;WiFi connected&quot;); // Print the IP address Serial.println(WiFi.localIP());&#125; void loop() &#123;&#125; è¿è¡Œç»“æžœå¦‚ä¸‹ï¼š å››ã€aRESTaREST æ¡†æž¶å¯ä»¥ä¸ºä¸€äº›å¸¸è§çš„åµŒå…¥å¼å¼€å‘æ¿æä¾› RESTful æŽ¥å£ï¼Œæ”¯æŒé€šè¿‡ä¸²å£ã€Wi-Fiã€ä»¥å¤ªç½‘ã€è“ç‰™ç­‰ç¡¬ä»¶å‘é€å‘½ä»¤è‡³å¼€å‘æ¿ï¼Œæ¿€å‘ç‰¹å®šçš„æ“ä½œï¼Œå¹¶å°†æ•°æ®ä»¥ JSON çš„æ ¼å¼è¿”å›žç»™æŽ§åˆ¶ç«¯ç”¨æˆ·ã€‚ ä½¿ç”¨ aREST æ¡†æž¶æ—¢å¯ä»¥åœ¨æœ¬åœ°ç½‘ç»œçŽ¯å¢ƒä¸­æŽ§åˆ¶è”ç½‘è®¾å¤‡ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©äº‘ç«¯å¹³å°è¿›è¡Œè¿œç¨‹æ“ä½œæˆ–ç›‘æŽ§ã€‚ ç»“åˆä¹‹å‰çš„æ¸©æ¹¿åº¦é¡¹ç›®ï¼Œå¯ä»¥å°†è¿žæŽ¥ Wi-Fi åŽçš„ NodeMcu å¼€å‘æ¿ä½œä¸ºä¸€ä¸ªå®žçŽ°äº† REST API çš„æœ¬åœ°æœåŠ¡å™¨ï¼Œé€šè¿‡è®¿é—®å…¶ IP åœ°å€æ¥èŽ·å–ç›¸åº”çš„æ¸©æ¹¿åº¦æ•°æ®ï¼ˆJSON æ ¼å¼ï¼‰ã€‚ ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// Import required libraries#include &quot;ESP8266WiFi.h&quot;#include &lt;aREST.h&gt;#include &quot;DHT.h&quot;// DHT11 sensor pins#define DHTPIN 5#define DHTTYPE DHT11// Create aREST instanceaREST rest = aREST();// Initialize DHT sensorDHT dht(DHTPIN, DHTTYPE, 15);// WiFi parametersconst char* ssid = &quot;wifi-name&quot;;const char* password = &quot;wifi-pass&quot;;// The port to listen for incoming TCP connections #define LISTEN_PORT 80// Create an instance of the serverWiFiServer server(LISTEN_PORT);// Variables to be exposed to the APIfloat temperature;float humidity;void setup(void)&#123; // Start Serial Serial.begin(115200); // Init DHT dht.begin(); // Init variables and expose them to REST API rest.variable(&quot;temperature&quot;,&amp;temperature); rest.variable(&quot;humidity&quot;,&amp;humidity); // Give name and ID to device rest.set_id(&quot;1&quot;); rest.set_name(&quot;esp8266&quot;); // Connect to WiFi WiFi.begin(ssid, password); while (WiFi.status() != WL_CONNECTED) &#123; delay(500); Serial.print(&quot;.&quot;); &#125; Serial.println(&quot;&quot;); Serial.println(&quot;WiFi connected&quot;); // Start the server server.begin(); Serial.println(&quot;Server started&quot;); // Print the IP address Serial.println(WiFi.localIP());&#125;void loop() &#123; // Reading temperature and humidity humidity = dht.readHumidity(); temperature = dht.readTemperature(); // Handle REST calls WiFiClient client = server.available(); if (!client) &#123; return; &#125; while(!client.available())&#123; delay(1); &#125; rest.handle(client);&#125; è¿è¡Œæ•ˆæžœï¼š ä»¥ä¸Šåªæ˜¯ä¸€äº›åŸºç¡€çš„ä½¿ç”¨ä»‹ç»å§ï¼Œï¼Œï¼ŒåŽç»­æ¯”å¦‚æ›´åŠ å¤æ‚çš„ç½‘ç»œæœåŠ¡ã€å¯¹æŽ¥å…¬å…±çš„ç‰©è”ç½‘äº‘å¹³å°åŠ MQTT åè®®ç­‰å†…å®¹ï¼Œæœ‰æ—¶é—´å†çœ‹çœ‹ã€‚æˆ‘åŽ»ï¼Œå…‰ç€è„šï¼Œ12â„ƒã€‚å†»æ­»æˆ‘äº†ã€‚ã€‚ã€‚ å‚è€ƒèµ„æ–™Internet of Things with ESP8266 (English Edition)]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>Programming</tag>
        <tag>Arduino</tag>
        <tag>IoT</tag>
        <tag>ESP8266</tag>
        <tag>NodeMcu</tag>
        <tag>Wi-Fi</tag>
        <tag>Sensor</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘èŽ“æ´¾3 éŸ³é¢‘é…ç½®åŠå…¶åº”ç”¨åœºæ™¯ï¼ˆå½•éŸ³ã€VoIP ç”µè¯ç­‰ï¼‰]]></title>
    <url>%2F2019%2F01%2F06%2Fraspberry-pi-audio-configuration-and-applications%2F</url>
    <content type="text"><![CDATA[ä»Žç½‘ä¸Šçœ‹åˆ°ä¸€æœ¬å…³äºŽæ ‘èŽ“æ´¾çš„ç”µå­ä¹¦ Raspberry Pi for Secret Agentsï¼Œåˆ©ç”¨æ ‘èŽ“æ´¾æ‰“é€ â€œç‰¹å·¥è£…å¤‡â€ã€‚å…¶ä¸­æœ‰ä¸€ç« è®²åˆ°éŸ³é¢‘è®¾å¤‡çš„é…ç½®å’Œå‡ ä¸ªç›¸å…³çš„åº”ç”¨åœºæ™¯ï¼ˆæ¯”å¦‚å½•éŸ³ã€ç›‘å¬ã€æ­å»ºç”µè¯ç³»ç»Ÿç­‰ï¼‰ï¼Œæ„Ÿè§‰æ¯”è¾ƒæœ‰æ„æ€ã€‚ ä¸€ã€éŸ³é¢‘ç³»ç»Ÿç®€å•é…ç½®1. ALSAALSA (Advanced Linux Sound Architecture) æ˜¯ä¸€ä¸ªæ‰¿è½½æ ‘èŽ“æ´¾ä¸ŠéŸ³é¢‘ç³»ç»Ÿçš„åº•å±‚æ¡†æž¶ï¼Œä¸ºæ ‘èŽ“æ´¾åŠå…¶å¤–æŽ¥çš„æ’­æ”¾æˆ–å½•åˆ¶è®¾å¤‡æä¾›å†…æ ¸é©±åŠ¨ç¨‹åºã€‚åŒæ—¶è¯¥æ¡†æž¶ä¹ŸåŒ…å«ç”¨äºŽåˆ¶ä½œéŸ³é¢‘åº”ç”¨çš„ç¨‹åºä»£ç ï¼Œå’Œä¸€äº›æ–¹ä¾¿çš„å‘½ä»¤è¡Œå®žç”¨ç¨‹åºã€‚ åœ¨ ALSA çš„å®šä¹‰é‡Œï¼Œç³»ç»Ÿä¸­çš„æ¯ä¸€ä¸ªéŸ³é¢‘è®¾å¤‡éƒ½ç§°ä½œâ€œå£°å¡â€ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ—å‡ºæ‰€æœ‰å·²è¿žæŽ¥çš„éŸ³é¢‘è®¾å¤‡ï¼š123$ cat /proc/asound/cards 0 [ALSA ]: bcm2835_alsa - bcm2835 ALSA bcm2835 ALSA å¯ä»¥çœ‹åˆ°æ­¤æ—¶ç³»ç»Ÿä¸­åªæœ‰æ ‘èŽ“æ´¾é»˜è®¤çš„å£°å¡ 0 bcm2835 ALSAã€‚ 2. è°ƒèŠ‚éŸ³é‡å¤§å°å¯ä»¥ä½¿ç”¨ alsamixer å‘½ä»¤æ‰“å¼€ AlsaMixer å®žç”¨ç¨‹åºï¼Œå¯¹éŸ³é‡ç­‰å£°éŸ³ç³»ç»Ÿå‚æ•°è¿›è¡Œè°ƒèŠ‚ï¼š ç•Œé¢ä¸­ View é€‰é¡¹åŽé¢çš„ Playbackã€Captureã€All åˆ†åˆ«å¯¹åº”æ’­æ”¾ã€å½•åˆ¶å’Œå…¨éƒ¨ã€‚å¯ä»¥æŒ‰é”®ç›˜ä¸Šçš„ TAB é”®åˆ‡æ¢åˆ°å¯¹åº”çš„ç•Œé¢ã€‚æŒ‰ä¸‹ fn+F6 æˆ– S é”®åˆ‡æ¢å£°å¡è®¾å¤‡ï¼ˆæ­¤æ—¶åªæœ‰ä¸€ä¸ªå£°å¡ï¼‰ ä½¿ç”¨ â†‘ â†“ æ–¹å‘é”®è°ƒèŠ‚éŸ³é‡ï¼Œè®¾ç½®å®ŒæˆåŽæŒ‰ ESC é”®é€€å‡º AlsaMixerã€‚ 3. åˆ‡æ¢éŸ³é¢‘è¾“å‡ºæ ‘èŽ“æ´¾æä¾›ä¸¤ç§éŸ³é¢‘è¾“å‡ºæŽ¥å£ï¼š3.5mm æ¨¡æ‹ŸéŸ³é¢‘æŽ¥å£å’Œ HDMIã€‚å¯ä»¥é€šè¿‡ $sudo raspi-config å‘½ä»¤ï¼ˆé€‰æ‹© Advanced Options - Audioï¼‰é…ç½®éŸ³é¢‘è¾“å‡ºæ–¹å‘ï¼Œä½¿éŸ³é¢‘è¾“å‡ºå›ºå®šä½¿ç”¨ 3.5mm æŽ¥å£æˆ– HDMIï¼š ç±»ä¼¼çš„æ“ä½œä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡ amixer å‘½ä»¤å®Œæˆï¼š$ amixer cset numid=3 1 ï¼šæŒ‡å®šéŸ³é¢‘è¾“å‡ºæŽ¥å£ä¸º 3.5mm è€³æœºæŽ¥å£$ amixer cset numid=3 2 ï¼šæŒ‡å®šéŸ³é¢‘è¾“å‡ºæŽ¥å£ä¸º HDMI1234$ amixer cset numid=3 1numid=3,iface=MIXER,name=&apos;PCM Playback Route&apos; ; type=INTEGER,access=rw------,values=1,min=0,max=2,step=0 : values=1 4. æ’­æ”¾æµ‹è¯•å¯ä»¥ä½¿ç”¨ $ speaker-test -c2 -t wav å‘½ä»¤æµ‹è¯•éŸ³é¢‘æ’­æ”¾æ˜¯å¦æ­£å¸¸ã€‚å¦‚ä¸€åˆ‡é¡ºåˆ©ï¼Œåˆ™ä¼šä¾æ¬¡ä»Žå·¦è€³è€³æœºï¼ˆæˆ–éŸ³ç®±ï¼‰å¬åˆ° Front Leftï¼Œä»Žå³è€³è€³æœºå¬åˆ° Front Right çš„å¥³å£°è¯­éŸ³ï¼Œç›´åˆ°æŒ‰ä¸‹ Ctrl + C ç»ˆæ­¢æµ‹è¯•ã€‚ äºŒã€éŸ³é¢‘å½•åˆ¶è®¾å¤‡1. USBå£°å¡æ ‘èŽ“æ´¾æä¾›çš„éŸ³é¢‘æŽ¥å£æ˜¯ä¸æ”¯æŒè¯­éŸ³è¾“å…¥çš„ã€‚ä½¿ç”¨ alsamixer å‘½ä»¤è¿›å…¥ AlsaMixer ç¨‹åºï¼ŒæŒ‰ä¸‹ TAB é”®åˆ‡æ¢åˆ° Caputre ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°æ­¤è®¾å¤‡æ— éŸ³é¢‘é‡‡é›†æŽ§åˆ¶çš„æç¤ºï¼š ä¸ºäº†å½•åˆ¶éŸ³é¢‘ï¼Œéœ€è¦ä½¿ç”¨å¤–æŽ¥çš„éŸ³é¢‘è¾“å…¥è®¾å¤‡ã€‚å¯ä»¥ä»Žç½‘ä¸Šè´­ä¹°ä¸€ä¸ªä¾¿æºå¼çš„ USB å…é©±åŠ¨å£°å¡ã€‚æ’å…¥USBå£°å¡åŽï¼Œé€šè¿‡ $ cat /proc/asound/cards å‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ£€æµ‹åˆ°çš„éŸ³é¢‘è®¾å¤‡ï¼š12345$ cat /proc/asound/cards 0 [ALSA ]: bcm2835_alsa - bcm2835 ALSA bcm2835 ALSA 1 [Device ]: USB-Audio - USB Audio Device GeneralPlus USB Audio Device at usb-3f980000.usb-1.3, full speed æ­¤æ—¶è¾“å‡ºä¿¡æ¯ä¸­å¤šäº†ä¸€ä¸ªåºå·ä¸º 1 çš„å£°å¡è®¾å¤‡ USB-Audioã€‚å¯ä»¥ä½¿ç”¨ $ speaker-test -D plughw:1 -c2 -t wav æµ‹è¯• USB å£°å¡çš„éŸ³é¢‘æ’­æ”¾æ˜¯å¦æ­£å¸¸ï¼ˆæ³¨æ„å‘½ä»¤ä¸­çš„ -D plughw:1ï¼‰ã€‚ ä½¿ç”¨ alsamixer -c1 å‘½ä»¤è°ƒèŠ‚æ–°å£°å¡çš„å…·ä½“å‚æ•°ã€‚å…¶ä¸­ -c1 é€‰é¡¹ç”¨äºŽæŒ‡å®šç¼–å·ä¸º 1 çš„å£°å¡è®¾å¤‡ï¼Œå³æ–°æ’å…¥çš„ USB å£°å¡ã€‚ æŒ‰ä¸‹ fn+F4 æˆ– TAB é”®å°†è§†å›¾åˆ‡æ¢åˆ° Capture ç•Œé¢ï¼Œç¡®ä¿ Mic ä¸Šæ–¹æœ‰å‡ºçŽ° CAPTURE å­—æ ·ï¼ˆè¯´æ˜Žå·²å¼€å¯å½•åˆ¶åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ç©ºæ ¼é”®åˆ‡æ¢å¼€å…³çŠ¶æ€ï¼‰ï¼š 2. éº¦å…‹é£Žæµ‹è¯•é¦–å…ˆå®‰è£… SoX å·¥å…·åŠå…¶ mp3 æ ¼å¼æ”¯æŒï¼š$sudo apt-get install sox libsox-fmt-mp3SoX æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€ä¸ªå¼ºå¤§çš„éŸ³é¢‘å¤„ç†å·¥å…·ï¼Œè¯¦ç»†ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šSoX â€” éŸ³é¢‘å¤„ç†å·¥å…·é‡Œçš„ç‘žå£«å†›åˆ€ã€‚ sox å‘½ä»¤çš„åŸºæœ¬æ ¼å¼ä¸º sox &lt;input&gt; &lt;output&gt; ã€‚å…¶ä¸­çš„ &lt;input&gt; å’Œ &lt;output&gt; æ—¢å¯ä»¥æ˜¯æŸä¸ªå…·ä½“çš„éŸ³é¢‘æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªç‰¹å®šçš„éŸ³é¢‘è®¾å¤‡ã€‚æ‰€ä»¥å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼Œsox å·¥å…·å°±æ˜¯å¯¹éŸ³é¢‘è¿›è¡Œâ€œä¼ å¯¼â€ï¼š ä»Žæ–‡ä»¶åˆ°è®¾å¤‡å³ä¸ºæ’­æ”¾ sox music.mp3 &lt;device&gt; ä»Žè®¾å¤‡åˆ°æ–‡ä»¶å³ä¸ºå½•åˆ¶ sox &lt;device&gt; myrec.wav ä»Žæ–‡ä»¶åˆ°æ–‡ä»¶å³ä¸ºè½¬ç  sox input.wav output.mp3 å¯ä»¥ä½¿ç”¨ $ sox -t alsa plughw:1 -t alsa plughw:1 å‘½ä»¤å¯¹éº¦å…‹é£Žè¿›è¡Œæµ‹è¯•ã€‚å…¶ä¸­ -t alsa plughw:1 è¡¨ç¤º ALSA å£°å¡è®¾å¤‡ 1ï¼ˆå³USBå£°å¡ï¼‰ã€‚ä¸Šè¿°å‘½ä»¤è¡¨ç¤ºæ—¢ä½¿ç”¨USBå£°å¡ï¼ˆéº¦å…‹é£Žï¼‰ ä½œä¸ºéŸ³é¢‘è¾“å…¥ï¼Œåˆç”¨å®ƒï¼ˆè€³æœºï¼‰ä½œä¸ºéŸ³é¢‘è¾“å‡ºã€‚ å¦‚ä¸€åˆ‡æ­£å¸¸ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡è€³æœºå¬åˆ°è‡ªå·±å¯¹ç€éº¦å…‹é£Žè®²è¯çš„å£°éŸ³ã€‚ 3. åˆ‡æ¢é»˜è®¤çš„éŸ³é¢‘è®¾å¤‡å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°†æ ‘èŽ“æ´¾é»˜è®¤ç”¨äºŽæ’­æ”¾å’Œå½•åˆ¶çš„éŸ³é¢‘è®¾å¤‡ï¼ˆå³æ ‘èŽ“æ´¾å†…ç½®å£°å¡ï¼‰ï¼Œæ”¹ä¸ºå½“å‰æ’å…¥çš„USBå£°å¡ã€‚ç¼–è¾‘ ~/.asoundrc æ–‡ä»¶ï¼Œæ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š123456789pcm.!default &#123; type hw card 1&#125;ctl.!default &#123; type hw card 1&#125; å…¶å®žå°±æ˜¯å°†é…ç½®æ–‡ä»¶ä¸­çš„ card 0 æ”¹ä¸º card 1ã€‚ æ­¤æ—¶å¯ç›´æŽ¥ä½¿ç”¨ $ sox -d -d å‘½ä»¤æµ‹è¯•USBå£°å¡ä¸Šè¿žæŽ¥çš„éº¦å…‹é£Žå’Œè€³æœºï¼Œæ— éœ€å†é€šè¿‡ -t alsa plughw:1 é€‰é¡¹æ‰‹åŠ¨æŒ‡å®šUSBå£°å¡ï¼ˆ-d é€‰é¡¹è¡¨ç¤ºé»˜è®¤éŸ³é¢‘è®¾å¤‡ï¼Œå³å·²é…ç½®æˆé»˜è®¤çš„USBå£°å¡ï¼‰ã€‚ 4. å½•åˆ¶ä¸Žæ’­æ”¾é»˜è®¤éŸ³é¢‘è®¾å¤‡åˆ‡æ¢ä¸ºUSBå£°å¡åŽï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å½•åˆ¶ä¸€æ®µéŸ³é¢‘å¹¶å°†å…¶ä¿å­˜åœ¨ myrec.mp3 æ–‡ä»¶ä¸­ï¼š$ sox -d myrec.mp3 æˆ– $ rec myrec.mp3 æ’­æ”¾å‰é¢å½•åˆ¶çš„éŸ³é¢‘æ–‡ä»¶å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š$ sox myrec.mp3 -d æˆ– $ play myrec.mp3 å¦‚æœªèƒ½é…ç½®USBå£°å¡ä¸ºé»˜è®¤éŸ³é¢‘è®¾å¤‡æˆ–é…ç½®ä¸æˆåŠŸï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå½•åˆ¶ä¸Žæ’­æ”¾ï¼šå½•åˆ¶ï¼š$ sox -t alsa plughw:1 myrec.mp3æ’­æ”¾ï¼š$ sox myrec.mp3 -t alsa plughw:1 å½•åˆ¶å›ºå®šé•¿åº¦çš„éŸ³é¢‘ç‰‡æ®µï¼ˆå¦‚ 30 åˆ†é’Ÿï¼‰å¹¶ä¿å­˜åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ï¼š$ sox -t alsa plughw:1 myrec.wav trim 0 00:30:00 æŒç»­å½•åˆ¶å¾ˆé•¿æ—¶é—´çš„éŸ³é¢‘ï¼Œä¿å­˜åœ¨å‡ ä¸ªä¸åŒçš„æ–‡ä»¶ä¸­ï¼Œæ¯éš”ä¸€å°æ—¶ä¿å­˜ä¸€æ¬¡ï¼š$ sox -t alsa plughw:1 myrec.wav trim 0 01:00:00 : newfile : restart ä¸‰ã€è¿œç¨‹ç›‘å¬å¯ä»¥é€šè¿‡æ ‘èŽ“æ´¾çš„ SSH æœåŠ¡ï¼Œåœ¨å¦ä¸€å°ç”µè„‘ä¸Šè¿œç¨‹æ”¶å¬æ ‘èŽ“æ´¾é€šè¿‡USBå£°å¡æ”¶é›†åˆ°çš„éŸ³é¢‘æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æ ‘èŽ“æ´¾çš„éº¦å…‹é£Žå½•åˆ¶å‘¨å›´çŽ¯å¢ƒçš„å£°éŸ³ï¼ŒåŒæ—¶åœ¨è¿œç¨‹çš„å¦ä¸€å°ç”µè„‘ä¸Šå®žæ—¶åœ°ï¼ˆæœ‰çŸ­æš‚å»¶è¿Ÿï¼‰æ”¶å¬å½•åˆ¶çš„å†…å®¹ï¼Œè¾¾åˆ°ç›‘å¬çš„æ•ˆæžœã€‚ åœ¨ç”µè„‘ç«¯ï¼ˆä¹Ÿéœ€è¦å®‰è£… sox ç¨‹åºï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š$ ssh pi@[IP address] sox -t alsa plughw:1 -t sox - | sox -q -t sox - -d å¯¹äºŽ Windows ç³»ç»Ÿï¼Œé™¤å®‰è£… SoX å·¥å…·å¤–ï¼Œè¿˜éœ€è¦å…ˆä¸‹è½½å®Œæ•´ç‰ˆ PuTTY å·¥å…·ï¼Œå¹¶ç¡®ä¿è¿™ä¸¤ä¸ªå·¥å…·çš„å®‰è£…è·¯å¾„éƒ½å·²æ·»åŠ è‡³ PATH çŽ¯å¢ƒå˜é‡ã€‚ åˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤é€šè¿‡æ ‘èŽ“æ´¾è¿›è¡Œè¿œç¨‹ç›‘å¬ï¼šplink pi@[IP address] -pw [password] sox -t alsa plughw:1 -t sox - | sox -q -t sox - -t waveaudio default å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå°†è¿œç¨‹æ ‘èŽ“æ´¾æ”¶é›†åˆ°çš„éŸ³é¢‘æ•°æ®ç›´æŽ¥ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­ï¼š$ ssh pi@[IP address] sox -t alsa plughw:1 -t mp3 - &gt; ~/Desktop/myrec.mp3æˆ– plink pi@[IP address] sox -t alsa plughw:1 -t mp3 - &gt; D:\myrec.mp3 ï¼ˆWindows ç³»ç»Ÿï¼‰ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œè®©æœ¬åœ°ç”µè„‘ä½œä¸ºéŸ³é¢‘è¾“å…¥æºï¼Œå°†å…¶éº¦å…‹é£Žæ”¶é›†åˆ°çš„éŸ³é¢‘æ•°æ®ï¼Œé€šè¿‡ SSH å‘é€åˆ°è¿œç¨‹æ ‘èŽ“æ´¾ä¸Šè¿›è¡Œæ’­æ”¾ã€‚ä¹Ÿå°±æ˜¯å°†è‡ªå·±å¯¹ç€æœ¬åœ°ç”µè„‘è®²çš„è¯é€šè¿‡æ ‘èŽ“æ´¾è¿›è¡Œè¿œç¨‹å¹¿æ’­ï¼š$ sox -d -t sox - | ssh pi@[IP address] sox -q -t sox - -dæˆ– sox -t waveaudio default -t sox - | plink pi@[IP address] -pw [password] sox -q -t sox - -d ï¼ˆWindows ç³»ç»Ÿï¼‰ åŒæ ·çš„åŽŸç†ï¼Œä¹Ÿå¯ä»¥å°†æœ¬åœ°ç£ç›˜ä¸Šçš„éŸ³é¢‘æ–‡ä»¶ç›´æŽ¥å‘é€åˆ°è¿œç¨‹çš„æ ‘èŽ“æ´¾ä¸Šè¿›è¡Œæ’­æ”¾ï¼š$ cat ~/Desktop/media/audios/Faded.wav | ssh pi@[IP address] sox -t wav - -dæˆ– type D:\myrec.mp3 | plink pi@[IP address] -pw [password] sox -t mp3 - -d ï¼ˆWindows ç³»ç»Ÿï¼‰ å››ã€è“ç‰™è€³æœºæ ‘èŽ“æ´¾ 3 ä»£ B+ è‡ªå¸¦äº† WIFI å’Œè“ç‰™åŠŸèƒ½ï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡è“ç‰™è¿žæŽ¥éŸ³é¢‘è®¾å¤‡ã€‚ 1. ä½¿ç”¨ hciconfig å‘½ä»¤èŽ·å–è“ç‰™æ¨¡å—çš„ç›¸å…³ä¿¡æ¯ï¼š1234567891011121314151617$ hciconfig -ahci0: Type: Primary Bus: UART BD Address: B8:27:EB:C3:38:31 ACL MTU: 1021:8 SCO MTU: 64:1 UP RUNNING RX bytes:4181 acl:136 sco:0 events:135 errors:0 TX bytes:5065 acl:128 sco:0 commands:60 errors:0 Features: 0xbf 0xfe 0xcf 0xfe 0xdb 0xff 0x7b 0x87 Packet type: DM1 DM3 DM5 DH1 DH3 DH5 HV1 HV2 HV3 Link policy: RSWITCH SNIFF Link mode: SLAVE ACCEPT Name: &apos;raspberrypi&apos; Class: 0x480000 Service Classes: Capturing, Telephony Device Class: Miscellaneous, HCI Version: 4.2 (0x8) Revision: 0xfc LMP Version: 4.2 (0x8) Subversion: 0x6119 Manufacturer: Broadcom Corporation (15) 2. ä½¿ç”¨ hcitool scan å‘½ä»¤æ‰«æé™„è¿‘å¯ä¾›è¿žæŽ¥çš„è“ç‰™è®¾å¤‡ï¼Œå¹¶è®°ä¸‹è“ç‰™è€³æœºå¯¹åº”çš„ MAC åœ°å€1234$ hcitool scanScanning ... FC:58:FA:F4:67:33 A2 50:8F:4C:0D:31:3A Starky 3. é€šè¿‡ MAC åœ°å€ä¸Žè“ç‰™è€³æœºè¿›è¡Œé…å¯¹ä½¿ç”¨ bluetoothctl å‘½ä»¤è¿›å…¥è“ç‰™æŽ§åˆ¶å°ï¼Œä¾æ¬¡é€šè¿‡ power on ã€agent on ã€scan on ã€pair ã€trust ã€connect ç­‰å‘½ä»¤è¿žæŽ¥è“ç‰™è®¾å¤‡ã€‚ æ³¨æ„æ­¤å¤„è¿žæŽ¥è“ç‰™ä½¿ç”¨çš„æ˜¯è“ç‰™è®¾å¤‡çš„ MAC åœ°å€ã€‚123456789101112131415161718192021$ bluetoothctl[NEW] Controller B8:27:EB:C3:38:31 raspberrypi [default][NEW] Device 50:8F:4C:0D:31:3A Starky...[bluetooth]# power onChanging power on succeeded[bluetooth]# agent onAgent registered[bluetooth]# scan onDiscovery started[bluetooth]# pair FC:58:FA:F4:67:33Attempting to pair with FC:58:FA:F4:67:33Pairing successful[bluetooth]# trust FC:58:FA:F4:67:33[CHG] Device FC:58:FA:F4:67:33 Trusted: yesChanging FC:58:FA:F4:67:33 trust succeeded[bluetooth]# connect FC:58:FA:F4:67:33Attempting to connect to FC:58:FA:F4:67:33[CHG] Device FC:58:FA:F4:67:33 Connected: yesConnection successful[A2]# é€€å‡ºè“ç‰™æŽ§åˆ¶å°ï¼Œä½¿ç”¨ hcitool con å‘½ä»¤æŸ¥çœ‹å½“å‰å·²è¿žæŽ¥çš„è“ç‰™è®¾å¤‡ï¼Œç¡®è®¤è¿žæŽ¥æˆåŠŸï¼š123$ hcitool conConnections: &gt; ACL FC:58:FA:F4:67:33 handle 11 state 1 lm SLAVE AUTH ENCRYPT 4. å°†éŸ³é¢‘è¾“å‡ºè®¾å¤‡åˆ‡æ¢ä¸ºè“ç‰™è€³æœºé¦–å…ˆå®‰è£… PulseAudio è½¯ä»¶åŒ…ï¼š$ sudo apt-get install pulseaudio pulseaudio-module-bluetooth å¯åŠ¨ PulseAudio å®ˆæŠ¤è¿›ç¨‹ï¼š$ pulseaudio --start åˆ—å‡º PulseAudio æ£€æµ‹åˆ°çš„éŸ³é¢‘è®¾å¤‡åç§°ï¼š1234$ pacmd list-sinks short | grep -e &apos;name:&apos; name: &lt;alsa_output.platform-soc_audio.analog-mono&gt; name: &lt;bluez_sink.FC_58_FA_F4_67_33.headset_head_unit&gt; ä½¿ç”¨ pactl å‘½ä»¤å°†è“ç‰™è€³æœºä½œä¸ºé»˜è®¤çš„éŸ³é¢‘è®¾å¤‡ï¼š$ pactl set-default-sink bluez_sink.FC_58_FA_F4_67_33.headset_head_unit æ­¤æ—¶ï¼Œå³å¯ç›´æŽ¥ä½¿ç”¨ play å‘½ä»¤é€šè¿‡è“ç‰™è€³æœºæ’­æ”¾éŸ³é¢‘æ–‡ä»¶ï¼š å¦‚æžœéœ€è¦å°†éŸ³é¢‘è¾“å‡ºåˆ‡æ¢å›žç³»ç»Ÿé»˜è®¤ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š$ pactl set-default-sink alsa_output.platform-soc_audio.analog-mono æˆ–è€…è‡ªå·±å¯¹å½“å‰çš„éŸ³é¢‘é…ç½®æœ‰ç‚¹æ··ä¹±äº†ã€‚ã€‚ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤é‡ç½®ï¼š$ sudo /etc/init.d/alsa-utils reset 5. æ³¨æ„äº‹é¡¹ç»è¿‡æµ‹è¯•ï¼Œå‘çŽ°è“ç‰™è€³æœºè¿žæŽ¥åŽéŸ³è´¨ç›¸å·®å¤ªå¤§ï¼Œæ’­æ”¾é€Ÿåº¦æ˜Žæ˜¾æ”¾ç¼“ï¼Œæœªç¡®å®šæ˜¯å“ªé‡Œçš„é—®é¢˜ã€‚ åŒæ—¶æˆ‘çš„è“ç‰™è€³æœºå¼€å¯åŽä¼šè‡ªåŠ¨è¿žæŽ¥è‡³æ ‘èŽ“æ´¾ï¼Œå¦‚æ— æ³•è‡ªåŠ¨è¿žæŽ¥æˆ–è€…è¿žæŽ¥ä»¥åŽå¹¶æ²¡æœ‰è¢« PulseAudio æ£€æµ‹åˆ°ï¼Œå¯ä»¥å…ˆä½¿ç”¨ bluetoothctl å‘½ä»¤è¿›å…¥è“ç‰™æŽ§åˆ¶å°ï¼šä¾æ¬¡è¾“å…¥ power offã€power on å‘½ä»¤é‡å¯è“ç‰™ï¼Œä½¿ç”¨ connect &lt;MAC address&gt; å‘½ä»¤é‡æ–°è¿žæŽ¥è“ç‰™è€³æœºï¼ˆæ— éœ€å†é…å¯¹å’Œä¿¡ä»»ï¼Œç›´æŽ¥è¿žæŽ¥ï¼‰ã€‚ è“ç‰™è€³æœºä¸ºé»˜è®¤éŸ³é¢‘è®¾å¤‡åŽï¼Œä¹‹å‰é…ç½® USB å£°å¡ä¸ºé»˜è®¤çš„æ“ä½œä¸å†ç”Ÿæ•ˆï¼ˆé™¤éžæ–­å¼€è“ç‰™æˆ–å…³é—­è“ç‰™è€³æœºï¼‰ã€‚å¯ä»¥åœ¨æ’­æ”¾æˆ–å½•åˆ¶æ—¶é€šè¿‡ -t alsa plughw:1 é€‰é¡¹æ‰‹åŠ¨æŒ‡å®š USB å£°å¡ã€‚å¦‚ $ sox -t alsa plughw:1 -d ï¼šä½¿ç”¨ USB å£°å¡ä½œä¸ºéŸ³é¢‘è¾“å…¥æºï¼Œå†å°†é‡‡é›†åˆ°çš„éŸ³é¢‘è¾“å‡ºåˆ°é»˜è®¤è®¾å¤‡ï¼ˆè“ç‰™è€³æœºï¼‰ è¿™ä¸€ç« çš„è“ç‰™ä»‹ç»åªä¾›å‚è€ƒï¼ŒæŽ¨èä½¿ç”¨ USB å£°å¡è¿›è¡ŒéŸ³é¢‘çš„å½•åˆ¶å’Œæ’­æ”¾ã€‚ äº”ã€é…ç½® VoIP æœåŠ¡å™¨VoIP å³ Voice over Internet Protocol ï¼Œå°±æ˜¯å°†å£°éŸ³ä¿¡å·ç»è¿‡åŽ‹ç¼©ä¸Žå°åŒ…ä¹‹åŽï¼Œä»¥æ•°æ®å°åŒ…çš„å½¢å¼åœ¨IPç½‘ç»œé—´è¿›è¡Œä¼ è¾“ã€‚é€šä¿—åœ°è¯´ä¹Ÿå°±æ˜¯äº’è”ç½‘ç”µè¯æˆ–IPç”µè¯ã€‚ è¿™é‡Œä½¿ç”¨ Linux å¹³å°ä¸Šçš„ SIP Witch è½¯ä»¶ä½œä¸º VoIP ç³»ç»Ÿçš„æœåŠ¡ç«¯ã€‚ 1. å®‰è£… SIP Witch$ sudo apt-get install sipwitch 2. ç¼–è¾‘é…ç½®æ–‡ä»¶/etc/default/sipwtich ï¼šæ‰¾åˆ° PLUGINS é€‰é¡¹ï¼Œåˆ é™¤è¯¥è¡Œå‰é¢çš„æ³¨é‡Š /etc/sipwitch.conf ï¼šç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼Œåœ¨ &lt;provision&gt; æ ‡ç­¾ä¸‹æ·»åŠ ç”¨æˆ·æ³¨å†Œä¿¡æ¯ï¼š12345678910&lt;user id=&quot;phone1&quot;&gt; &lt;extension&gt;201&lt;/extension&gt; &lt;secret&gt;SecretSauce201&lt;/secret&gt; &lt;display&gt;Agent 201&lt;/display&gt;&lt;/user&gt;&lt;user id=&quot;phone2&quot;&gt; &lt;extension&gt;202&lt;/extension&gt; &lt;secret&gt;SecretSauce202&lt;/secret&gt; &lt;display&gt;Agent 202&lt;/display&gt;&lt;/user&gt; å…¶ä¸­çš„ id è¡¨ç¤ºæ³¨å†Œç”¨æˆ·ç™»å½•æ—¶éœ€è¦è¾“å…¥çš„ç”¨æˆ·åï¼Œ&lt;secret&gt; è¡¨ç¤ºç™»å½•æ—¶ä½¿ç”¨çš„å¯†ç ã€‚ æ‰¾åˆ° &lt;stack&gt; æ ‡ç­¾ï¼Œå¹¶åœ¨å…¶åŽæ·»åŠ å¦‚ä¸‹ä¸€è¡Œé…ç½®ï¼Œç”¨äºŽæŒ‡å®š VoIP æœåŠ¡å™¨çš„IPåœ°å€ï¼š&lt;localnames&gt;[Your Pi&#39;s IP address]&lt;/localnames&gt; ç¼–è¾‘å®ŒæˆåŽï¼Œé‡å¯ sipwitch æœåŠ¡ï¼š$ sudo systemctl restart sipwitch 3. å®¢æˆ·ç«¯é…ç½®Windows ç³»ç»Ÿâ€œè½¯ç”µè¯â€å¯ä½¿ç”¨ MicroSIP è½¯ä»¶ï¼ŒAndroid å®¢æˆ·ç«¯å¯ä½¿ç”¨ CSipSimpleï¼ŒMac å®¢æˆ·ç«¯æœ‰ Telephoneã€‚ ä½¿ç”¨ /etc/sipwitch.conf æ–‡ä»¶ä¸­å®šä¹‰çš„ç”¨æˆ·IDã€å¯†ç ä»¥åŠæœåŠ¡å™¨åœ°å€å®Œæˆç”¨æˆ·æ³¨å†Œï¼Œå„å®¢æˆ·ç«¯ä¹‹é—´å³å¯ç›´æŽ¥æ‹¨æ‰“è¯­éŸ³ç”µè¯ã€‚ å‚è€ƒèµ„æ–™Raspberry Pi for Secret Agents - Third Edition]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>Media</tag>
        <tag>Audio</tag>
        <tag>Raspberrypi</tag>
        <tag>SecretAgent</tag>
        <tag>sox</tag>
        <tag>VoIP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NodeMCU å¼€å‘æ¿åˆ·å…¥ MicroPython å›ºä»¶å¹¶é€šè¿‡ Atom è¿›è¡Œç¼–ç¨‹]]></title>
    <url>%2F2018%2F12%2F28%2Fprogramming-esp8266-with-micropython%2F</url>
    <content type="text"><![CDATA[MicroPython æ˜¯å¯¹ Python 3 è¯­è¨€çš„ä¸€ç§ç²¾ç®€çš„å®žçŽ°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨å¾®æŽ§åˆ¶å™¨è¿™ç§ç¡¬ä»¶èµ„æºå—é™çš„çŽ¯å¢ƒä¸­å¯ä»¥é«˜æ•ˆåœ°è¿è¡Œï¼Œå› æ­¤åšäº†å¾ˆå¤šé’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚å®ƒç±»ä¼¼äºŽä¸€ä¸ªå°åž‹çš„ Python æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡ä¸²å£ä¸Žå†…ç½®çš„ Python è§£é‡Šå™¨ç›´æŽ¥äº¤äº’ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ ç¨‹åºæ–‡ä»¶åœ¨å¼€æœºä¸Šç”µåŽè‡ªåŠ¨è¿è¡Œã€‚MicroPython æ”¯æŒå¤šç§å¼€å‘æ¿ï¼ŒåŒ…æ‹¬ä»·æ ¼å¾ˆå®žæƒ çš„åŸºäºŽ ESP8266 èŠ¯ç‰‡çš„ NodeMCUã€‚ ä¸€ã€åˆ·å…¥å›ºä»¶æˆ‘è¿™é‡Œä½¿ç”¨çš„å¼€å‘æ¿æ˜¯ä»Žç½‘ä¸Šè´­ä¹°çš„ NodeMCU ï¼Œå‡ºåŽ‚æ—¶é¢„å…ˆåˆ·å¥½äº†åŸºäºŽ Lua è¯­è¨€ç¼–ç¨‹çš„å›ºä»¶ã€‚ä¸ºäº†ä½¿ç”¨ MicroPython ï¼Œéœ€è¦å…ˆå¯¹è¯¥å¼€å‘æ¿é‡æ–°åˆ·å†™å›ºä»¶ã€‚ 1. å‡†å¤‡å·¥ä½œé¦–å…ˆè¿›å…¥ MicroPython å®˜æ–¹çš„ä¸‹è½½é¡µé¢ï¼Œä¸‹è½½æœ€æ–°ç‰ˆçš„é’ˆå¯¹ ESP8266 ç¡¬ä»¶çš„å›ºä»¶åŒ…ã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ esp8266-20180511-v1.9.4.bin ã€‚ åˆ·å†™è½¯ä»¶å¯ä»¥ä½¿ç”¨æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿçš„å‘½ä»¤è¡Œå·¥å…· esptoolã€‚å¯¹äºŽå·²ç»è£…å¥½ Python çŽ¯å¢ƒçš„ç”µè„‘ï¼Œç›´æŽ¥ä½¿ç”¨ pip å‘½ä»¤å®‰è£…å³å¯ï¼špip install esptool 2. åˆ·å…¥å›ºä»¶é¦–å…ˆå°† NodeMCU å¼€å‘æ¿è¿žæŽ¥è‡³ç”µè„‘ï¼ŒMac ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ ls /dev/tty.usbserial* å‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿå·²ç»æ£€æµ‹åˆ°çš„ USB ä¸²å£ï¼š12$ ls /dev/tty.usbserial*/dev/tty.usbserial-14110 ä½¿ç”¨ esptool.py -p &lt;SerialPort&gt; flash_id å‘½ä»¤ç¡®è®¤è¯¥ä¸²å£æ˜¯å¦èƒ½æˆåŠŸæ£€æµ‹åˆ° ESP8266 è®¾å¤‡ï¼š123456789101112131415$ esptool.py -p /dev/tty.usbserial-14110 flash_idesptool.py v2.5.1Serial port /dev/tty.usbserial-14110Connecting....Detecting chip type... ESP8266Chip is ESP8266EXFeatures: WiFiMAC: 2c:3a:e8:06:aa:7eUploading stub...Running stub...Stub running...Manufacturer: c8Device: 4016Detected flash size: 4MBHard resetting via RTS pin... ä½¿ç”¨ esptool.py -p &lt;SerialPort&gt; erase_flash å‘½ä»¤å¯¹å¼€å‘æ¿è¿›è¡Œæ“¦é™¤æ“ä½œï¼ˆä»¥é˜²ä¸‡ä¸€ï¼‰ï¼š1234567891011121314$ esptool.py -p /dev/tty.usbserial-14110 erase_flashesptool.py v2.5.1Serial port /dev/tty.usbserial-14110Connecting....Detecting chip type... ESP8266Chip is ESP8266EXFeatures: WiFiMAC: 2c:3a:e8:06:aa:7eUploading stub...Running stub...Stub running...Erasing flash (this may take a while)...Chip erase completed successfully in 2.5sHard resetting via RTS pin... æ“¦é™¤å®ŒæˆåŽå³å¯ä½¿ç”¨ esptool å·¥å…·çš„ write_flash å‘½ä»¤å°† MicroPython å›ºä»¶åˆ·å…¥å¼€å‘æ¿ã€‚ï¼ˆå®Œæ•´å‘½ä»¤ä¸ºï¼šesptool.py -p &lt;SerialPort&gt; --baud 460800 write_flash --flash_size=detect -fm dio 0 &lt;FirmwareFile&gt;ï¼‰12345678910111213141516171819202122$ esptool.py -p /dev/tty.usbserial-14110 --baud 460800 write_flash --flash_size=detect -fm dio 0 ~/Downloads/esp8266-20180511-v1.9.4.binesptool.py v2.5.1Serial port /dev/tty.usbserial-14110Connecting....Detecting chip type... ESP8266Chip is ESP8266EXFeatures: WiFiMAC: 2c:3a:e8:06:aa:7eUploading stub...Running stub...Stub running...Changing baud rate to 460800Changed.Configuring flash size...Auto-detected Flash size: 4MBFlash params set to 0x0240Compressed 604872 bytes to 394893...Wrote 604872 bytes (394893 compressed) at 0x00000000 in 9.9 seconds (effective 490.0 kbit/s)...Hash of data verified.Leaving...Hard resetting via RTS pin... äºŒã€å›ºä»¶æµ‹è¯•åˆ·å†™å›ºä»¶çš„æ“ä½œå®ŒæˆåŽï¼Œå¯ä»¥ä½¿ç”¨ Mac ç³»ç»Ÿè‡ªå¸¦çš„ä¸²å£è°ƒè¯•å·¥å…· cu è¿žæŽ¥ USB ä¸²å£ï¼Œå¯¹åˆšåˆ·å¥½çš„å¼€å‘ç‰ˆè¿›è¡Œæµ‹è¯•ï¼šsudo cu -l &lt;SerialPort&gt; -s &lt;BaudRateSpeed&gt;æ•ˆæžœå¦‚ä¸‹ï¼š12$ sudo cu -l /dev/tty.usbserial-14110 -s 115200Connected. ç»ˆç«¯çª—å£æç¤º Connected ä¹‹åŽï¼ŒæŒ‰ä¸‹ NodeMCU æ¿å­ä¸Šçš„ RST (Reset) æŒ‰é’®ã€‚å¦‚å›ºä»¶åˆ·å†™æˆåŠŸï¼Œåˆ™ç»ˆç«¯åœ¨è¾“å‡ºéƒ¨åˆ†ä¹±ç åŽä¼šç«‹å³è¿›å…¥ Python è§£é‡Šå™¨ç•Œé¢ï¼š123MicroPython v1.9.4-8-ga9a3caad0 on 2018-05-11; ESP module with ESP8266Type &quot;help()&quot; for more information.&gt;&gt;&gt; åœ¨è§£é‡Šå™¨ç•Œé¢ä¸‹ï¼Œè¾“å…¥ help() å‘½ä»¤èŽ·å–åŸºæœ¬çš„å¸®åŠ©ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728MicroPython v1.9.4-8-ga9a3caad0 on 2018-05-11; ESP module with ESP8266Type &quot;help()&quot; for more information.&gt;&gt;&gt; help()Welcome to MicroPython!For online docs please visit http://docs.micropython.org/en/latest/esp8266/ .For diagnostic information to include in bug reports execute &apos;import port_diag&apos;.Basic WiFi configuration:import networksta_if = network.WLAN(network.STA_IF); sta_if.active(True)sta_if.scan() # Scan for available access pointssta_if.connect(&quot;&lt;AP_name&gt;&quot;, &quot;&lt;password&gt;&quot;) # Connect to an APsta_if.isconnected() # Check for successful connection# Change name/password of ESP8266&apos;s AP:ap_if = network.WLAN(network.AP_IF)ap_if.config(essid=&quot;&lt;AP_NAME&gt;&quot;, authmode=network.AUTH_WPA_WPA2_PSK, password=&quot;&lt;password&gt;&quot;)Control commands: CTRL-A -- on a blank line, enter raw REPL mode CTRL-B -- on a blank line, enter normal REPL mode CTRL-C -- interrupt a running program CTRL-D -- on a blank line, do a soft reset of the board CTRL-E -- on a blank line, enter paste modeFor further help on a specific object, type help(obj)&gt;&gt;&gt; æ›´å¤šçš„äº¤äº’å‘½ä»¤å’Œè¯¦ç»†çš„æŒ‡å¯¼æ‰‹å†Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿè®© GPIO2 ä¸Šè¿žæŽ¥çš„ LEDï¼ˆå³ ESP8266 æ¨¡å—å†…ç½®çš„è“è‰² LEDï¼‰ä»¥ 1s çš„é¢‘çŽ‡é—ªçƒï¼š1234567891011&gt;&gt;&gt; from machine import Pin&gt;&gt;&gt; import time&gt;&gt;&gt; p=Pin(2,Pin.OUT)&gt;&gt;&gt; while True:... p.on()... time.sleep(1)... p.off()... time.sleep(1)......... ä¸‰ã€é…ç½® Atom ç¼–ç¨‹çŽ¯å¢ƒå½“å‰å¯ä»¥ä½¿ç”¨å¤šç§è½¯ä»¶ä½œä¸ºç®€å•çš„ IDE å¯¹ MicroPython å¼€å‘æ¿è¿›è¡Œç¼–ç¨‹ã€‚ä¸»è¦æ˜¯æä¾›è¿žæŽ¥ä¸²å£çš„ç»ˆç«¯ï¼Œå¯ä»¥äº¤äº’åœ°æ‰§è¡Œ Python å‘½ä»¤ï¼Œä»¥åŠç¨‹åºæ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ã€‚ æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ Atom ç¼–è¾‘å™¨æ­é…ä¸Š pymakr-atom æ’ä»¶ã€‚ Atom çš„é…ç½®è¾ƒç®€å•ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š ä»Ž Atom å®˜ç½‘ä¸‹è½½å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…ç¨‹åºå¹¶å®‰è£… é€šè¿‡ Atom å†…ç½®çš„æ’ä»¶ç®¡ç†å™¨æœç´¢å®‰è£… pymakr æ’ä»¶ï¼Œå®‰è£…å®ŒæˆåŽé‡å¯ç¼–è¾‘å™¨ ç¼–è¾‘å™¨é‡å¯åŽåº•éƒ¨è‡ªåŠ¨å‡ºçŽ° pymakr çš„ç»ˆç«¯çª—å£ï¼Œç‚¹å‡»ç»ˆç«¯å³ä¸Šè§’è®¾ç½® - å…¨å±€è®¾ç½®ï¼Œæ‰¾åˆ°è®¾å¤‡åœ°å€å¹¶æ”¹ä¸ºå¼€å‘æ¿è¿žæŽ¥çš„ç«¯å£å· ç›´æŽ¥ç‚¹å‡»ç»ˆç«¯é¡¶éƒ¨çš„è¿žæŽ¥æŒ‰é’®å³å¯å®Œæˆä¸²å£è¿žæŽ¥ æ­¤æ—¶çš„ Atom ç¼–è¾‘å™¨ï¼Œå¯ä»¥é€šè¿‡åº•éƒ¨çš„ç»ˆç«¯çª—å£ç›´æŽ¥è¾“å…¥ Python å‘½ä»¤ã€‚ä¹Ÿå¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­æ–°å»ºé¡¹ç›®ç›®å½•ï¼Œå¹¶åˆ›å»º main.py æºæ–‡ä»¶ã€‚ç¼–è¾‘å¥½ Python ä»£ç åŽï¼Œç‚¹å‡»æ‰§è¡ŒæŒ‰é’®å³å¯ç›´æŽ¥è¿è¡Œï¼Œæˆ–è€…ç‚¹å‡»ä¸Šä¼ æŒ‰é’®å°†ä»£ç æ–‡ä»¶ä¸Šä¼ è‡³å¼€å‘æ¿ã€‚ å‚è€ƒèµ„æ–™MicroPython documentation]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Programming</tag>
        <tag>IoT</tag>
        <tag>ESP8266</tag>
        <tag>Microcontroller</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SoX â€” éŸ³é¢‘å¤„ç†å·¥å…·é‡Œçš„ç‘žå£«å†›åˆ€]]></title>
    <url>%2F2018%2F12%2F18%2Fprocessing-audio-with-sox%2F</url>
    <content type="text"><![CDATA[SoXï¼ˆå³ Sound eXchangeï¼‰æ˜¯ä¸€ä¸ªè·¨å¹³å°ï¼ˆWindowsï¼ŒLinuxï¼ŒMacOS ç­‰ï¼‰çš„å‘½ä»¤è¡Œå®žç”¨ç¨‹åºï¼Œå¯ä»¥å°†å„ç§æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶è½¬æ¢ä¸ºéœ€è¦çš„å…¶ä»–æ ¼å¼ã€‚SoX è¿˜å¯ä»¥å¯¹è¾“å…¥çš„éŸ³é¢‘æ–‡ä»¶åº”ç”¨å„ç§æ•ˆæžœï¼Œä¹Ÿæ”¯æŒåœ¨å¤§å¤šæ•°å¹³å°ä¸Šæ’­æ”¾å’Œå½•åˆ¶éŸ³é¢‘æ–‡ä»¶ã€‚ ä¸€ã€ç®€ä»‹SoX å¯ä»¥è¯»å–å’Œå†™å…¥å¸¸è§æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­é€‰æ‹©æ€§çš„åŠ å…¥ä¸€äº›å£°éŸ³æ•ˆæžœã€‚å®ƒå¯ä»¥ç»„åˆå¤šä¸ªè¾“å…¥æºåŠåˆæˆéŸ³æ•ˆï¼Œåœ¨è®¸å¤šç³»ç»Ÿä¸Šä¹Ÿå¯ä»¥ä½œä¸ºéŸ³é¢‘æ’­æ”¾å™¨æˆ–å¤šè½¨å½•éŸ³æœºä½¿ç”¨ã€‚SoX å·¥å…·åœ¨å¤§éƒ¨åˆ† Linux ç³»ç»Ÿä¸Šéƒ½å¯ä»¥ç›´æŽ¥é€šè¿‡è½¯ä»¶åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆå¦‚ sudo apt-get install soxï¼‰ï¼ŒMac ç³»ç»Ÿä¸Šåˆ™å¯ä»¥ä½¿ç”¨ brew install sox å‘½ä»¤ã€‚ SoX å¤„ç†éŸ³é¢‘çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼šInput(s) -&gt; Combiner -&gt; Effects -&gt; Output(s) SoX å·¥å…·çš„æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„ sox å‘½ä»¤åŠç›¸åº”çš„é€‰é¡¹å®žçŽ°ã€‚ä½†å®ƒåŒæ—¶æä¾›äº† play å‘½ä»¤ç”¨äºŽæ’­æ”¾éŸ³é¢‘æ–‡ä»¶ï¼Œrec å‘½ä»¤ç”¨äºŽå½•åˆ¶éŸ³é¢‘ï¼Œä»¥åŠ soxi å‘½ä»¤ç”¨äºŽèŽ·å–éŸ³é¢‘çš„æ–‡ä»¶å¤´ä¸­åŒ…å«çš„ä¿¡æ¯ã€‚ ä¸Šè¿°å‡ ä¸ªå‘½ä»¤çš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š12345678910111213SYNOPSIS sox [global-options] [format-options] infile1 [[format-options] infile2] ... [format-options] outfile [effect [effect-options]] ... play [global-options] [format-options] infile1 [[format-options] infile2] ... [format-options] [effect [effect-options]] ... rec [global-options] [format-options] outfile [effect [effect-options]] ... soxi [-V[level]] [-T] [-t|-r|-c|-s|-d|-D|-b|-B|-p|-e|-a] infile1 ... äºŒã€åŸºæœ¬ä½¿ç”¨1. èŽ·å–éŸ³é¢‘æ–‡ä»¶çš„å…ƒæ•°æ®soxi æˆ– sox --i å‘½ä»¤å¯ä»¥é€šè¿‡åˆ†æžéŸ³é¢‘æ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼ŒèŽ·å–å…¶å…ƒæ•°æ®ï¼ˆå¦‚é€šé“æ•°ã€é‡‡æ ·çŽ‡ã€ç¼–ç ç­‰ï¼‰ã€‚12345678910$ soxi Faded.wavInput File : &apos;Faded.wav&apos;Channels : 2Sample Rate : 44100Precision : 16-bitDuration : 00:03:32.63 = 9376836 samples = 15947 CDDA sectorsFile Size : 37.5MBit Rate : 1.41MSample Encoding: 16-bit Signed Integer PCM soxi å‘½ä»¤è·Ÿä¸ŠæŸä¸ªç‰¹å®šçš„é€‰é¡¹å¯ä»¥åªèŽ·å–è¯¥é€‰é¡¹å¯¹åº”çš„ä¿¡æ¯ï¼Œå¦‚åªæ˜¾ç¤ºæŸéŸ³é¢‘æ–‡ä»¶ Faded.wav çš„æ¯”ç‰¹çŽ‡ï¼ˆBit Rateï¼‰ï¼š12$ soxi -B Faded.wav1.41M soxi å‘½ä»¤æ”¯æŒçš„æ‰€æœ‰é€‰é¡¹åŠå…¶å«ä¹‰å¦‚ä¸‹ï¼š1234567891011121314151617$ soxiUsage: soxi [-V[level]] [-T] [-t|-r|-c|-s|-d|-D|-b|-B|-p|-e|-a] infile1 ...-t Show detected file-type-r Show sample-rate-c Show number of channels-s Show number of samples (0 if unavailable)-d Show duration in hours, minutes and seconds (0 if unavailable)-D Show duration in seconds (0 if unavailable)-b Show number of bits per sample (0 if not applicable)-B Show the bitrate averaged over the whole file (0 if unavailable)-p Show estimated sample precision in bits-e Show the name of the audio encoding-a Show file comments (annotations) if availableWith no options, as much information as is available is shown foreach given file. 2. èŽ·å–éŸ³é¢‘çš„ç»Ÿè®¡ä¿¡æ¯å¯ä»¥ä½¿ç”¨ sox &lt;inputfile&gt; -n stat å‘½ä»¤èŽ·å–æŸéŸ³é¢‘æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516$ sox Faded.wav -n statSamples read: 18753672Length (seconds): 212.626667Scaled by: 2147483647.0Maximum amplitude: 0.977417Minimum amplitude: -0.977478Midline amplitude: -0.000031Mean norm: 0.229415Mean amplitude: -0.000006RMS amplitude: 0.302594Maximum delta: 1.765564Minimum delta: 0.000000Mean delta: 0.202369RMS delta: 0.273320Rough frequency: 6339Volume adjustment: 1.023 3. æ’­æ”¾ä¸Žå½•åˆ¶play å’Œ rec å‘½ä»¤æä¾›äº†æœ€åŸºæœ¬çš„æ’­æ”¾å’Œå½•åˆ¶åŠŸèƒ½ã€‚æ’­æ”¾ï¼š$ play existing-file.wavå½•åˆ¶ï¼š$ rec new-file.wav ä¸Šè¿°å‘½ä»¤ç­‰åŒäºŽ sox å‘½ä»¤çš„å¦‚ä¸‹å½¢å¼ï¼š$ sox existing-file.wav âˆ’dï¼ˆæ’­æ”¾ï¼‰å’Œ sox âˆ’d new-file.wavï¼ˆå½•åˆ¶ï¼‰å…¶ä¸­ -d é€‰é¡¹ç”¨äºŽæŒ‡å®šæ’­æ”¾æˆ–å½•åˆ¶æ—¶ä½¿ç”¨çš„éŸ³é¢‘è®¾å¤‡ï¼Œä¸æŒ‡å®šæ—¶åˆ™è¡¨ç¤ºä½¿ç”¨é»˜è®¤è®¾å¤‡ã€‚ å¯ä»¥è¿™æ ·ç†è§£ï¼š sox existing-file.wav -d å°±æ˜¯ä»Ž existing-file.wav æ–‡ä»¶ä¸­è¯»å–å…¶åŒ…å«çš„éŸ³é¢‘æ•°æ®ï¼Œå†è¾“å‡ºåˆ° -d ï¼ˆé»˜è®¤éŸ³é¢‘è®¾å¤‡ï¼Œæ‰¬å£°å™¨ï¼‰è¿›è¡Œæ’­æ”¾ï¼› sox -d new-file.wav å°±æ˜¯ä»Ž -d ï¼ˆé»˜è®¤éŸ³é¢‘è®¾å¤‡ï¼Œéº¦å…‹é£Žï¼‰ä¸­è¯»å–éŸ³é¢‘æ•°æ®ï¼Œå†è¾“å‡ºï¼ˆå½•åˆ¶ï¼‰åˆ° new-file.wav æ–‡ä»¶ä¸­ã€‚ å…¶å®žéƒ½éµå¾ªäº†ä¸€ä¸ªåŸºæœ¬çš„æ ¼å¼ï¼Œå³ sox &lt;input&gt; &lt;output&gt; ã€‚è€Œå…¶ä¸­çš„ &lt;input&gt; å’Œ &lt;output&gt; æ ¹æ®éœ€è¦æ—¢å¯ä»¥ä¸ºæŸä¸ªå…·ä½“çš„éŸ³é¢‘æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªå…·ä½“çš„éŸ³é¢‘è®¾å¤‡ã€‚ æ’­æ”¾æˆ–å½•åˆ¶çš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥å¯¹éŸ³é¢‘æ–‡ä»¶åº”ç”¨æŒ‡å®šçš„ç¼–è¾‘æ“ä½œæˆ–æ•ˆæžœé€‰é¡¹ï¼Œå› æ­¤åœ¨å¯¹éŸ³é¢‘æ•°æ®åº”ç”¨æŸæ•ˆæžœå‰ï¼Œå¯ä»¥å…ˆä½¿ç”¨ play å‘½ä»¤è¿›è¡Œâ€œé¢„è§ˆâ€ã€‚ å¦‚ trim æ•ˆæžœå¯ä»¥ä»ŽéŸ³é¢‘æ–‡ä»¶ä¸­è£å‰ªæå–æŒ‡å®šçš„ç‰‡æ®µåˆ°è¾“å‡ºæ–‡ä»¶ã€‚play å‘½ä»¤é€šè¿‡è¯¥æ•ˆæžœå¯ä»¥ç›´æŽ¥æ’­æ”¾æŒ‡å®šç‰‡æ®µï¼š$ play foo.wav trim 10.0 5.0 æˆ– $ play foo.wav trim 10.0 =15.0æ’­æ”¾ foo.wav æ–‡ä»¶ä¸­ 10-15s ä¹‹é—´çš„éŸ³é¢‘ç‰‡æ®µ ä½¿ç”¨ echo æ•ˆæžœæ’­æ”¾ Faded.wav æ–‡ä»¶ï¼š123456789101112$ play Faded.wav echo 0.8 0.88 200.0 0.4Faded.wav: File Size: 37.5M Bit Rate: 1.41M Encoding: Signed PCM Channels: 2 @ 16-bitSamplerate: 44100HzReplaygain: off Duration: 00:03:32.63In:12.1% 00:00:25.82 [00:03:06.81] Out:1.14M [-=====|=====-] Hd:2.7 Clip:0 4. éŸ³é¢‘æ ¼å¼è½¬æ¢æ–‡ä»¶æ ¼å¼ç±»åž‹å¯¹äºŽéŸ³é¢‘æ•°æ®æ ¼å¼çš„æè¿°ï¼Œä¸»è¦é€šè¿‡ä»¥ä¸‹ 4 ç§å±žæ€§ï¼š é‡‡æ ·çŽ‡ï¼ˆsample rateï¼‰ï¼šæŒ‡å£°éŸ³ç”±æ¨¡æ‹Ÿä¿¡å·è½¬æ¢æˆæ•°å­—ä¿¡å·çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ç§’ä»Žè¿žç»­ä¿¡å·ä¸­æå–çš„ç”¨äºŽç»„æˆç¦»æ•£ä¿¡å·çš„æ ·æœ¬ä¸ªæ•°ã€‚éŸ³é¢‘CDæ‰€ç”¨çš„é‡‡æ ·çŽ‡ä¸º 44100 Hzï¼Œæ•°å­—éŸ³é¢‘ç£å¸¦å’Œè®¸å¤šè®¡ç®—æœºç³»ç»Ÿä½¿ç”¨ 48000 Hzï¼Œä¸“ä¸šçº§éŸ³é¢‘ç³»ç»Ÿé€šå¸¸ä½¿ç”¨ 96000 Hzã€‚ é‡‡æ ·å¤§å°ï¼ˆsample size æˆ– Precisionï¼‰ï¼šéŸ³é¢‘é‡‡æ ·æ—¶ç”¨äºŽå­˜å‚¨æ¯ä¸ªæ ·æœ¬çš„æ•°æ®ä½æ•°ï¼ˆbitsï¼‰ã€‚å¦‚ä»Š 16 bit çš„é‡‡æ ·å¤§å°å·²è¢«å¹¿æ³›ä½¿ç”¨ï¼Œ24 bit ä¸»è¦ç”¨äºŽä¸“ä¸šéŸ³é¢‘é¢†åŸŸã€‚ ç¼–ç æ ¼å¼ï¼ˆdata encodingï¼‰ï¼šå³æ¯ä¸ªéŸ³é¢‘æ ·æœ¬çš„è¡¨ç¤ºï¼ˆå³â€œç¼–ç â€ï¼‰æ–¹å¼ã€‚å¸¸ç”¨çš„ç¼–ç ç±»åž‹åŒ…æ‹¬ floating-pointã€Î¼-lawã€ADPCMã€singed-integer PCMã€MP3 å’Œ FLAC ç­‰ã€‚ é€šé“ï¼ˆchannelï¼‰ï¼šå³æ–‡ä»¶ä¸­åŒ…å«çš„éŸ³é¢‘é€šé“çš„æ•°é‡ã€‚å…¶ä¸­å•å£°é“ï¼ˆmonoï¼‰å’ŒåŒå£°é“ï¼ˆstereoï¼‰æ˜¯æœ€å¸¸è§çš„ä¸¤ç§ï¼Œâ€œçŽ¯ç»•å£°â€éŸ³é¢‘ï¼ˆSurround soundï¼‰é€šå¸¸åŒ…å«å…­ä¸ªæˆ–æ›´å¤šå£°é“ã€‚ æ­¤å¤–ï¼ŒéŸ³é¢‘æ–‡ä»¶è¿˜ä½¿ç”¨æ¯”ç‰¹çŽ‡ï¼ˆBit Rateï¼‰è¡¨ç¤ºä¸€ä¸ªå•ä½æ—¶é—´å†…ç¼–ç éŸ³é¢‘ä¿¡å·å ç”¨çš„å­˜å‚¨ç©ºé—´å¤§å°ï¼Œ å®ƒçš„æ•°å€¼ä¸€èˆ¬å–å†³äºŽæ‰€æœ‰çš„ä¸Šè¿°å››ä¸ªå‚æ•°ã€‚MP3 ç¼–ç çš„ç«‹ä½“å£°éŸ³ä¹é€šå¸¸å…·æœ‰ 128-196kbps çš„æ¯”ç‰¹çŽ‡ï¼Œ FLAC ç¼–ç çš„ç«‹ä½“å£°éŸ³ä¹é€šå¸¸å…·æœ‰ 550-760kbps çš„æ¯”ç‰¹çŽ‡ã€‚ æˆ‘ä¸ªäººæ˜¯è¿™æ ·æƒ³çš„ï¼Œï¼Œï¼Œå¯ä»¥å°†ä¸€æ®µéŸ³é¢‘æ•°æ®çœ‹æˆå¾ˆé•¿å¾ˆé•¿çš„ä¸€æŽ’è‹¹æžœæ ‘ï¼Œä»Žå¤´èµ°åˆ°å°¾ï¼Œæ¯éš”ä¸€æ®µè·ç¦»åœä¸‹ï¼Œæ‘˜ä¸‹æ»¡æ»¡ä¸€ç­è‹¹æžœã€‚ã€‚ã€‚ç­çš„å¤§å°å°±æ˜¯é‡‡æ ·å¤§å°ï¼Œåœä¸‹æ¥é‡‡æ‘˜çš„æ¬¡æ•°å°±æ˜¯é‡‡æ ·é¢‘çŽ‡ï¼Œæ¯”ç‰¹çŽ‡å°±æ˜¯æŠŠä¸€å®šæ•°é‡çš„è‹¹æžœâ€œæ¦¨æˆæ±â€ï¼ˆä»¥ç‰¹å®šçš„æ ¼å¼å¯¹éŸ³é¢‘ç¼–ç ï¼‰ä»¥åŽçš„é‡é‡ï¼Œå½“ç„¶æœ‰äº›æ¦¨æ±æ–¹æ³•ä¼šé€ æˆä¸€å®šçš„æŸå¤±ã€‚ æ ¼å¼è½¬æ¢å½¢å¼æœ€ç®€å•çš„ sox å‘½ä»¤å³ä½¿ç”¨ä¸¤ä¸ªæ–‡ä»¶åä½œä¸ºå‚æ•°ï¼Œå¦‚ï¼š$ sox Faded.wav Faded.mp3 ï¼šå°† Faded.wav æ–‡ä»¶çš„æ ¼å¼ç”± wav è½¬ä¸º mp3 ä¸Šè¿°å‘½ä»¤æ‰§è¡Œæ—¶ï¼ŒSoX ä¼šå…ˆä»Ž Faded.wav æ–‡ä»¶ä¸­è¯»å–éŸ³é¢‘æ•°æ®ï¼Œå†å°†å…¶è¾“å‡ºåˆ° Faded.mp3 æ–‡ä»¶ä¸­ã€‚è€Œ SoX ç¨‹åºä¼šæ ¹æ®å‚æ•°ä¸­æ–‡ä»¶åçš„åŽç¼€æŽ¨æ–­å‡ºç›¸åº”çš„æ ¼å¼ï¼Œå¹¶åœ¨å¤åˆ¶éŸ³é¢‘æ•°æ®çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨è¿›è¡Œè½¬ç ã€‚ SoX å¯ä»¥å¤„ç† self-describing å’Œ raw æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ã€‚self-describing æ ¼å¼ï¼ˆå¦‚ WAVã€FLACã€MP3ï¼‰çš„æ–‡ä»¶åŒ…å«ä¸€ä¸ªç”¨äºŽæè¿°ä¿¡å·å’Œç¼–ç å±žæ€§çš„æ–‡ä»¶å¤´ï¼Œè€Œ raw æˆ– headless æ ¼å¼çš„éŸ³é¢‘åˆ™ä¸åŒ…å«è¿™äº›ä¿¡æ¯ã€‚ æ‰€ä»¥å½“ raw æ ¼å¼çš„éŸ³é¢‘ä½œä¸ºè¾“å…¥æ–‡ä»¶æ—¶ï¼Œéœ€è¦åœ¨ sox å‘½ä»¤çš„æ ¼å¼é€‰é¡¹é‡ŒæŒ‡å®šå…¶ä¿¡å·å’Œç¼–ç å±žæ€§ã€‚ å¸¸ç”¨çš„éŸ³é¢‘æ ¼å¼é€‰é¡¹ï¼š é€‰é¡¹ æè¿° b æ¯ä¸ªç¼–ç æ ·æœ¬å ç”¨çš„æ•°æ®ä½æ•° c éŸ³é¢‘æ–‡ä»¶åŒ…å«çš„é€šé“æ•° e éŸ³é¢‘æ–‡ä»¶çš„ç¼–ç ç±»åž‹ r éŸ³é¢‘æ–‡ä»¶çš„é‡‡æ ·çŽ‡ t éŸ³é¢‘æ–‡ä»¶çš„æ–‡ä»¶ç±»åž‹ ä¸Šè¿°é€‰é¡¹é€‚ç”¨äºŽè¾“å…¥æˆ–è¾“å‡ºæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºŽè¯´æ˜Ž rawï¼ˆæˆ– headlessï¼‰æ–‡ä»¶ä½œä¸ºè¾“å…¥æ—¶çš„æ ¼å¼ä¿¡æ¯ï¼Œæˆ–æ ¼å¼è½¬æ¢æ—¶æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„å…·ä½“å‚æ•°ã€‚ $ sox âˆ’r 48k âˆ’e float âˆ’b 32 âˆ’c 2 input.raw output.wavå°†æŸä¸ªç‰¹å®šçš„ raw æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶è½¬æ¢ä¸º wav æ ¼å¼ $ sox Faded.wav Faded.rawå°†éŸ³é¢‘æ–‡ä»¶ Faded.wav è½¬ä¸º raw æ ¼å¼ $ play -r 44800 -b 16 -e signed-integer -c 2 Faded.rawæ’­æ”¾ raw æ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ $ sox Faded.wav -c 1 Faded-mono.wavå°† Faded.wav æ–‡ä»¶è½¬æ¢æˆå•å£°é“ï¼ˆ-c 1ï¼‰åŽè¾“å‡º ä¸‰ã€éŸ³é¢‘æ•ˆæžœSoX å·¥å…·å¯ä»¥åœ¨éŸ³é¢‘å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹è¾“å…¥çš„éŸ³é¢‘æ•°æ®åº”ç”¨ä¼—å¤šçš„æ•ˆæžœã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰æ•ˆæžœçš„å¸®åŠ©ä¿¡æ¯ï¼š1234567891011121314151617181920212223$ sox --help-effect all | lesssox: SoX vEffect usage:allpass frequency width[h|k|q|o]band [-n] center [width[h|k|q|o]]bandpass [-c] frequency width[h|k|q|o]bandreject frequency width[h|k|q|o]bass gain [frequency(100) [width[s|h|k|q|o]](0.5s)]bend [-f frame-rate(25)] [-o over-sample(16)] &#123;start,cents,end&#125;: ä¹Ÿå¯ä»¥ç›´æŽ¥æŸ¥çœ‹å…·ä½“æŸä¸ªéŸ³é¢‘æ•ˆæžœçš„ä½¿ç”¨æ–¹æ³•ï¼š123456$ sox --help-effect echosox: SoX vEffect usage:echo gain-in gain-out delay decay [ delay decay ... ] ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„åº”ç”¨åœºæ™¯ã€‚ 1. æ›´æ”¹å£°é“æ•°sox å‘½ä»¤å¯ä»¥æ›´æ”¹éŸ³é¢‘æ–‡ä»¶ä¸­å£°é“çš„æ•°ç›®ï¼Œå¦‚å°†å•å£°é“éŸ³é¢‘è½¬æ¢æˆåŒå£°é“ï¼š$ sox foo.wav foostereo.wav channels 2 æˆ– $ sox foo.wav -c 2 foostereo.wav ä½†æ˜¯ä¸Šè¿°å‘½ä»¤å¹¶æ²¡æœ‰åˆ›å»ºä¸€ä¸ªâ€œçœŸå®žâ€çš„åŒå£°é“éŸ³é¢‘ï¼Œè€Œæ˜¯å°†å•å£°é“éŸ³é¢‘å¤åˆ¶æˆå®Œå…¨ä¸€è‡´çš„ä¸¤ä¸ªå£°é“å†åˆå¹¶åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ã€‚ å¯ä»¥é€šè¿‡ sox å‘½ä»¤çš„ -M é€‰é¡¹å°†å·¦å³ä¸¤ä¸ªå£°é“çš„å•å£°é“éŸ³é¢‘åˆå¹¶æˆä¸€ä¸ªåŒå£°é“æ–‡ä»¶ï¼š$ sox -M left.wav right.wav stereo.wav å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯¹åŒå£°é“æ–‡ä»¶ä¸­ä¸¤ä¸ªå£°é“çš„å‡ä¸€åŒ–å¤„ç†ï¼Œå°†å…¶è¾“å‡ºä¸ºå•å£°é“éŸ³é¢‘ï¼š$ sox original.wav mono.wav channels 1 æˆ– $ sox original.wav -c 1 mono.wav remixé€šè¿‡ sox å‘½ä»¤çš„ remix æ•ˆæžœä¹Ÿå¯ä»¥å®Œæˆå¯¹å£°é“æ•°æ®çš„æå–æˆ–èžåˆã€‚ æå–åŒå£°é“éŸ³é¢‘æ–‡ä»¶ä¸­å•ä¸ªå£°é“çš„æ•°æ®å¹¶ä½œä¸ºå•å£°é“éŸ³é¢‘è¾“å‡ºï¼š$ sox stereo.wav left.wav remix 1 ï¼ˆæå–å·¦å£°é“éŸ³é¢‘ï¼‰$ sox stereo.wav right.wav remix 2 ï¼ˆæå–å³å£°é“éŸ³é¢‘ï¼‰ èžåˆåŒå£°é“æ–‡ä»¶ä¸­ä¸¤ä¸ªå£°é“çš„éŸ³é¢‘æ•°æ®å¹¶ä½œä¸ºå•å£°é“éŸ³é¢‘è¾“å‡ºï¼š$ sox stereo.wav mono.wav remix 1,2 æˆ–$ sox stereo.wav mono.wav remix 1-2 æ­¤å¤–ï¼Œremix è¿˜å¯ä»¥å°†è¾“å…¥æ–‡ä»¶ä¸­çš„å¤šä¸ªå£°é“æ•°æ®åˆ†åˆ«è¿›è¡Œèžåˆã€‚å¦‚ä½¿ç”¨ -M é€‰é¡¹å°†ä¸¤ä¸ªåŒå£°é“éŸ³é¢‘åˆå¹¶ï¼Œå†é€šè¿‡ remix å°†åˆå¹¶å¾—åˆ°çš„å››ä¸ªå£°é“ä¸¤ä¸¤èžåˆï¼Œç”Ÿæˆä¸€ä¸ªåªåŒ…å«ä¸¤ä¸ªå£°é“çš„è¾“å‡ºæ–‡ä»¶ã€‚$ sox -M stereo1.wav stereo2.wav output.wav remix 1,3 2,4 2. æ”¹å˜éŸ³é‡sox å‘½ä»¤çš„ -v é€‰é¡¹å¯ä»¥ç”¨æ¥ï¼ˆæˆå€åœ°ï¼‰æ”¹å˜éŸ³é‡çš„å¤§å°ï¼š$ sox -v 0.5 foo.wav bar.wavä¸Šè¿°å‘½ä»¤å°† foo.wav éŸ³é¢‘æ”¾å¤§ 0.5 å€éŸ³é‡åŽè¾“å‡ºè‡³ bar.wav æ–‡ä»¶ å¯ä»¥å°†éŸ³é‡æ”¾å¤§åŠŸèƒ½ä¸Ž stat æ•ˆæžœç»“åˆã€‚ä»¥ sox foo.wav -n stat -v å‘½ä»¤è¿”å›žçš„æ•°å­—ä½œä¸ºæ”¾å¤§å€æ•°ï¼Œå°†æœ€å¤§åŒ– foo.wav çš„éŸ³é‡è€Œä¸è‡³äºŽå‡ºçŽ°å‰Šæ³¢ï¼š12$ sox foo.wav -n stat -v 2&gt; vc$ sox -v `cat vc` foo.wav foo-maxed.wav æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé€‰é¡¹ --norm ç”¨æ¥å½’ä¸€åŒ–éŸ³é¢‘å“åº¦ã€‚ä¸ºäº†æœ€å¤§åŒ–éŸ³é¢‘çš„å£°éŸ³å¼ºåº¦ï¼Œå¯ä»¥åœ¨å¤„ç†è¾“å…¥éŸ³é¢‘æ—¶å°†è¯¥é€‰é¡¹è®¾ç½®ä¸º -1ï¼šsox --norm=-1 &lt;inputfile&gt; &lt;outputfile&gt; 3. æå–æ–‡ä»¶çš„æŸä¸ªéƒ¨åˆ†sox å‘½ä»¤çš„ trim æ•ˆæžœå¯ä»¥å°†è¾“å…¥éŸ³é¢‘çš„æŸä¸€æ®µè£å‰ªå‡ºæ¥å¹¶æå–åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ã€‚ trim æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä½œä¸ºè£å‰ªç‰‡æ®µçš„èµ·å§‹ä½ç½®ï¼Œå¦ä¸€ä¸ªä½œä¸ºè¯¥ç‰‡æ®µæŒç»­çš„æ—¶é—´ã€‚å¯ä»¥ä½¿ç”¨æ•´æ•°+sæ ¼å¼çš„å‚æ•°ä»¥æ ·æœ¬ä¸ªæ•°ä½œä¸ºè®¡é‡å•ä½ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨ ((hh:)mm:)ss(.fs) å½¢å¼çš„æ—¶é—´å‚æ•°ã€‚å½“å‚æ•°ä¸ºçº¯æ•´æ•°æ—¶ï¼Œå•ä½ä¸ºç§’ã€‚ $ sox Input.wav Half1.wav trim 0 30:00 æˆªå–è¾“å…¥æ–‡ä»¶ä¸­å‰ 30 åˆ†é’Ÿçš„éŸ³é¢‘$ sox Input.wav Half2.wav trim 30:00 30:00 æˆªå–è¾“å…¥æ–‡ä»¶ä¸­ä»Žç¬¬ 30 åˆ†é’Ÿå¼€å§‹åˆ°ç¬¬ 60 åˆ†é’Ÿçš„éŸ³é¢‘ 4. æ‹¼æŽ¥æ–‡ä»¶ä¸Žå‰é¢è£å‰ªæå–çš„æ“ä½œç›¸åï¼Œsox å‘½ä»¤è¿˜å¯ä»¥å®žçŽ°å¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªéŸ³é¢‘æ–‡ä»¶çš„æ‹¼æŽ¥ã€‚ $ sox Half1.wav Half2.wav Full.wavå°† Half1.wav å’Œ Half2.wav åˆå¹¶è‡³ Full.wav æ–‡ä»¶ã€‚æ³¨æ„åˆå¹¶å‰çš„éŸ³é¢‘æ–‡ä»¶éœ€ä¿æŒä¸€è‡´çš„ç±»åž‹å’Œé‡‡æ ·çŽ‡ç­‰ã€‚ 5. åˆæˆéŸ³é¢‘sox å‘½ä»¤å¯ä»¥é€šè¿‡ synth æ•ˆæžœåˆæˆè®¸å¤šæ ‡å‡†æ³¢å½¢å’Œå™ªå£°ç±»åž‹ã€‚ $ sox -n sine.wav synth 1.0 sine 1000.0åˆæˆé¢‘çŽ‡ä¸º 1000 Hz é•¿åº¦ä¸º 1 ç§’çš„æ­£å¼¦æ³¢ï¼Œä¿å­˜è‡³ sine.wav æ–‡ä»¶ä¸­ã€‚ synth æ”¯æŒåˆæˆçš„å£°éŸ³ç±»åž‹åŒ…æ‹¬ sineã€squareã€triangleã€sawtoothã€trapetz (trapezoidal)ã€exp (exponential)ã€whitenoiseã€pinknoise å’Œ brownnoiseã€‚ 6. é™éŸ³æ•ˆæžœsox å‘½ä»¤å¯ä»¥åˆ›å»ºé™éŸ³çŠ¶æ€çš„éŸ³é¢‘ç‰‡æ®µï¼Œä½¿ç”¨ -n é€‰é¡¹è¡¨ç¤ºæ²¡æœ‰è¾“å…¥ï¼Œé€šè¿‡ trim æ•ˆæžœæŒ‡å®šéœ€è¦é™éŸ³çš„ç‰‡æ®µã€‚ $ sox -n -r 48000 silence.wav trim 0.0 0.250åœ¨ slience.wav æ–‡ä»¶ä¸­åˆ›å»ºä¸€æ®µé•¿åº¦ä¸º 250ms é‡‡æ ·çŽ‡ä¸º 48000Hz çš„é™éŸ³ç‰‡æ®µã€‚ 7. æ··åˆéŸ³é¢‘sox å‘½ä»¤çš„ -m é€‰é¡¹å¯ä»¥å°†ä¸¤ä¸ªéŸ³é¢‘æ–‡ä»¶æ··åˆä»¥åŽç”Ÿæˆè¾“å‡ºæ–‡ä»¶ã€‚ $ sox -m sine100.wav sine250.wav sine100-250.wavå°† sine100.wav å’Œ sine250.wav ä¸¤ä¸ªéŸ³é¢‘æ–‡ä»¶èžåˆä»¥åŽä½œä¸º sine100-250.wav æ–‡ä»¶çš„éŸ³é¢‘æ•°æ®ã€‚ $ sox -m -v0.5 music.mp3 -v2 speech.wav presentation.wavå°†èƒŒæ™¯éŸ³ä¹ï¼ˆmusic.mp3ï¼‰éŸ³é‡é™ä½Žä¸€åŠåŽä¸Žæ”¾å¤§ 2 å€éŸ³é‡çš„äººå£°æ•°æ®ï¼ˆspeech.wavï¼‰èžåˆã€‚ å¦‚æžœä¸ç¡®å®šèžåˆæ•ˆæžœï¼Œå¯ä»¥å…ˆé€šè¿‡ play å‘½ä»¤ä½¿ç”¨ç›¸åŒçš„å‚æ•°å¯¹ç»“æžœè¿›è¡Œâ€œé¢„è§ˆâ€ï¼š$ play -m -v0.5 music.mp3 -v2 speech.wav PSï¼šä¸Žå‰é¢çš„ -M é€‰é¡¹ä¸åŒï¼Œ-m é€‰é¡¹å€¾å‘äºŽå¯¹å£°é“æ•°æ®çš„æ··åˆï¼Œå³ä¸¤ä¸ªå•å£°é“æ–‡ä»¶é€šè¿‡ -m æ··åˆä»¥åŽè¾“å‡ºä»æ˜¯å•å£°é“æ•°æ®ã€‚è¾“å‡ºæ–‡ä»¶ä¸­çš„å•ä¸ªå£°é“åŒ…å«äº†è¾“å…¥çš„ä¸¤ä¸ªå£°é“çš„ç‰¹å¾ã€‚ è€Œ -M é€‰é¡¹æ›´å€¾å‘äºŽå¯¹éŸ³é¢‘æ–‡ä»¶çš„åˆå¹¶ï¼Œé»˜è®¤ä¸å¯¹å£°é“æ•°æ®è¿›è¡Œæ··åˆã€‚æ‰€ä»¥ä¸¤ä¸ªå•å£°é“æ–‡ä»¶é€šè¿‡ -M åˆå¹¶ä»¥åŽé»˜è®¤è¾“å‡ºåŒå£°é“éŸ³é¢‘ã€‚è¾“å‡ºæ–‡ä»¶ä¸­çš„ä¸¤ä¸ªå£°é“åˆ†åˆ«å¯¹åº”äºŽè¾“å…¥çš„ä¸¤ä¸ªå£°é“ï¼ˆæ•°æ®æ²¡æœ‰æ··åˆï¼‰ã€‚é™¤éžé€šè¿‡ -c é€‰é¡¹æ‰‹åŠ¨æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„å£°é“æ•°é‡ã€‚ 8. æ”¹å˜æ’­æ”¾é€Ÿåº¦å¯ä»¥é€šè¿‡ stretch æ•ˆæžœæ”¹å˜éŸ³é¢‘æ–‡ä»¶çš„æ’­æ”¾é€Ÿåº¦ï¼ŒåŒæ—¶ä¸ä¼šå¯¼è‡´éŸ³é«˜çš„å˜åŒ–ã€‚ å¦‚ä»¥ 2x å€é€Ÿæ’­æ”¾ Faded.wav æ–‡ä»¶ï¼š$ play Faded.wav stretch 0.5 ä¹Ÿå¯ä»¥é€šè¿‡ speed æ•ˆæžœè°ƒèŠ‚æ’­æ”¾é€Ÿåº¦ï¼ˆç›¸åº”åœ°éŸ³é«˜ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼‰ï¼š$ play Faded.wav speed 2 æ­¤å¤–ï¼Œå¯ä»¥ä½¿ç”¨ pitch æ•ˆæžœè°ƒèŠ‚éŸ³é¢‘ç‰‡æ®µçš„éŸ³é«˜ï¼Œä»¥éŸ³åˆ†ï¼ˆcentsï¼‰ä¸ºå•ä½ã€‚ $ play Faded.wav pitch 200å°† Faded.wav æ–‡ä»¶ä¸­çš„éŸ³é¢‘æé«˜ 200 éŸ³åˆ†ï¼Œå³æé«˜ 2 ä¸ªåŠéŸ³çš„éŸ³ç¨‹ï¼ˆæ¯ä¸€ä¸ªåŠéŸ³çš„éŸ³ç¨‹ç­‰äºŽ 100 éŸ³åˆ†ï¼‰ã€‚ å‚è€ƒèµ„æ–™SoXUsing SoxHow to process audio files from the command line with SoX]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Software</tag>
        <tag>Media</tag>
        <tag>Audio</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux ä½¿ç”¨ crontab åˆ›å»ºå®šæ—¶ä»»åŠ¡]]></title>
    <url>%2F2018%2F12%2F14%2Fmake-schedule-using-crontab%2F</url>
    <content type="text"><![CDATA[Linux ç³»ç»Ÿé‡Œçš„ cron å®ˆæŠ¤è¿›ç¨‹ï¼Œå¯ä»¥è·Ÿéšç³»ç»Ÿå¯åŠ¨ï¼Œæ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºå®šæ—¶ä»»åŠ¡çš„åŸºæœ¬å·¥å…·ã€‚æ‰€è°“å®šæ—¶æˆ–è®¡åˆ’ä»»åŠ¡ï¼ŒæŒ‡çš„æ˜¯åœ¨æŸäº›ç‰¹å®šçš„æ—¶é—´ç‚¹è‡ªåŠ¨åœ°æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ã€‚è¿™äº›ç›¸å¯¹åº”çš„æ—¶é—´ç‚¹å’Œå‘½ä»¤å¯ä»¥åœ¨å…¶é…ç½®æ–‡ä»¶ Crontab ä¸­è®¾ç½®ã€‚ Crontabcrontab å³ cron table çš„ç¼©å†™ï¼Œæ˜¯ cron ç¨‹åºçš„é…ç½®æ–‡ä»¶ã€‚å…¶ä¸­åŒ…å«äº†å¯¹æ¯ä¸€æ¡è®¡åˆ’ä»»åŠ¡çš„å…·ä½“é…ç½®ã€‚å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ crontab -e å‘½ä»¤å¯¹è¯¥é…ç½®æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚ ä½¿ç”¨é™åˆ¶ åªæœ‰å½“ç”¨æˆ·çš„è´¦å·å‡ºçŽ°åœ¨ /usr/lib/cron/cron.allow æ–‡ä»¶ä¸­æ—¶ï¼Œè¯¥ç”¨æˆ·æ‰å¯ä»¥ä½¿ç”¨ crontab å‘½ä»¤ å¦‚ /usr/lib/cron/cron.allow æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè€Œç”¨æˆ·çš„è´¦å·æ²¡æœ‰å‡ºçŽ°åœ¨ /usr/lib/cron/cron.deny æ–‡ä»¶ä¸­ï¼Œè¯¥ç”¨æˆ·å¯ä»¥ä½¿ç”¨ crontab å‘½ä»¤ å½“åªå­˜åœ¨ cron.deny æ–‡ä»¶ä¸”è¯¥æ–‡ä»¶å†…å®¹ä¸ä¸ºç©ºï¼Œåˆ™ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨ crontab ä¸¤ä¸ªæ–‡ä»¶éƒ½ä¸å­˜åœ¨æ—¶ï¼Œåˆ™åªæœ‰ root ç”¨æˆ·å¯ä»¥è®¿é—® crontab å‘½ä»¤é€‰é¡¹ crontab filename ä»Ž filename æ–‡ä»¶ä¸­å¯¼å…¥é…ç½®ï¼Œå¹¶æ›¿ä»£ä¹‹å‰çš„å†…å®¹ crontab -e ç¼–è¾‘é…ç½®æ–‡ä»¶ crontab çš„å†…å®¹ï¼Œå®šä¹‰è®¡åˆ’ä»»åŠ¡ crontab -l åˆ—å‡ºå½“å‰ç”¨æˆ·å·²ç»å®šä¹‰å¥½çš„è®¡åˆ’ä»»åŠ¡ crontab -r ç§»é™¤å½“å‰ç”¨æˆ·çš„ crontab é…ç½®æ–‡ä»¶ï¼ˆåˆ é™¤è¯¥ç”¨æˆ·æ‰€æœ‰çš„è®¡åˆ’ä»»åŠ¡ï¼‰é…ç½®æ–‡ä»¶æ ¼å¼crontab é…ç½®æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå†…å®¹éƒ½ä»£è¡¨äº†å¯¹æŸä¸ªè®¡åˆ’çš„å®šä¹‰ï¼Œä¸€å…±åˆ†æˆ 6 ä¸ªå­—æ®µã€‚å‰ 5 ä¸ªå­—æ®µå®šä¹‰æ—¶é—´ï¼Œæœ€åŽä¸€ä¸ªå­—æ®µè¡¨æ˜Žæ‰§è¡Œçš„å‘½ä»¤ã€‚å…·ä½“å¦‚ä¸‹ï¼šminute hour day month weekday command å„æ—¶é—´å­—æ®µçš„å«ä¹‰å’Œå–å€¼èŒƒå›´å¦‚ä¸‹ï¼š å­—æ®µ æè¿° å–å€¼èŒƒå›´ minute å…·ä½“æŸåˆ†é’Ÿ 0 åˆ° 59 hour å…·ä½“æŸå°æ—¶ 0 åˆ° 23 day ä¸€ä¸ªæœˆå†…çš„æŸå¤© 1 åˆ° 31 month å…·ä½“æŸä¸ªæœˆä»½ 1 åˆ° 12 weekday ä¸€å‘¨å†…çš„æŸå¤© 0 åˆ° 6ï¼ˆ0=å‘¨æ—¥ï¼‰ æ—¶é—´å­—æ®µçš„åˆæ³•æ ¼å¼ï¼š å•ç‹¬çš„æ•°å­—ï¼ˆnï¼‰ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´å•ä½ä¸‹æŸä¸ªç‰¹å®šçš„æ—¶é—´ç‚¹ è¢« - è¿žæŽ¥çš„ä¸¤ä¸ªæ•°å­—ï¼ˆn1-n2ï¼‰ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´å•ä½ä¸‹çš„æŸä¸ªæ—¶é—´èŒƒå›´ ç”±é€—å·åˆ†éš”çš„å¤šä¸ªæ•°å­—æˆ–èŒƒå›´ï¼ˆn1,n2,n3...ï¼‰ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´å•ä½ä¸‹å¤šä¸ªæ—¶é—´ç‚¹ï¼ˆæ®µï¼‰ æ˜Ÿå·ï¼ˆ*ï¼‰ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´èŒƒå›´ä¸‹çš„æ‰€æœ‰æ—¶é—´ç‚¹ï¼ˆæ®µï¼‰ æ—¶é—´èŒƒå›´å’Œæ­¥é•¿ï¼ˆn1-n2/nï¼‰ï¼šè¡¨ç¤ºåœ¨æŸä¸ªæ—¶é—´èŒƒå›´å†…ï¼Œæ¯éš”ä¸€æ®µå›ºå®šçš„æ—¶é•¿ï¼Œæ‰§è¡Œä¸€æ¬¡ç‰¹å®šçš„å‘½ä»¤ å¦‚ï¼š minute hour day/month month day/week ä»»åŠ¡æ‰§è¡Œæ—¶é—´ 30 9 14 3 * æ¯å¹´3æœˆ14å·çš„ä¸Šåˆ9ç‚¹30åˆ† 0 2 * * 6 æ¯ä¸ªå‘¨å…­çš„å‡Œæ™¨2ç‚¹æ•´ 45 8 * * 1-5 æ¯å‘¨ä¸€åˆ°å‘¨äº”çš„ä¸Šåˆ8ç‚¹45åˆ† 0 0 1,15 * * æ¯ä¸ªæœˆ1å·æˆ–15å·åŠå¤œ0ç‚¹ 0 * 13 * 5 æ¯ä¸ªæœˆ13å·çš„æ•´ç‚¹ï¼Œæˆ–è€…æ¯ä¸ªå‘¨äº”çš„æ•´ç‚¹ */10 * * * * æ¯éš”10åˆ†é’Ÿ äºŒã€é…ç½®ç¤ºä¾‹ 30 1 * * * find /tmp -atime +3 -type f -exec rm -f {} &#39;;&#39;æ¯å¤©å‡Œæ™¨1ç‚¹åŠï¼Œä½¿ç”¨ find å‘½ä»¤æŸ¥æ‰¾ /tmp ç›®å½•ä¸‹æ‰€æœ‰3å¤©ä»¥ä¸Šæ²¡æœ‰è¢«è®¿é—®è¿‡çš„æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬å…¨éƒ¨åˆ é™¤ 30 2 * * 1 cd /home/joe/project; makeæ¯å¤©å‡Œæ™¨2ç‚¹åŠï¼Œè¿›å…¥ /home/joe/project ç›®å½•å¹¶æ‰§è¡Œ make å‘½ä»¤]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘å–œæ¬¢çš„å¼€æºè½¯ä»¶åˆé›†ï¼ˆè®¾è®¡ç±»ï¼‰]]></title>
    <url>%2F2018%2F12%2F11%2Fmy-favorite-opensource-design-software%2F</url>
    <content type="text"><![CDATA[æœ¬äººéžä¸“ä¸šè®¾è®¡äººå‘˜ï¼Œç”šè‡³è¿žä¸šä½™éƒ½ç®—ä¸ä¸Šã€‚ã€‚ã€‚åªæ˜¯å¹³æ—¶æ— èŠï¼Œå¶å°”åšç‚¹å°ä¸œè¥¿èŠä»¥è‡ªå¨±ã€‚ä¸‹é¢åˆ—å‡ºçš„è½¯ä»¶å¤šä¸ºè‡ªå·±å¹³æ—¶ç”¨è¿‡æˆ–è€…æƒ³è¦å­¦ä¹ çš„ä¸€äº›å¼€æºè½¯ä»¶ï¼Œä¸»è¦é¢å‘è®¾è®¡ç±»å·¥ä½œï¼ˆå¦‚å›¾åƒç¼–è¾‘ã€éŸ³è§†é¢‘å‰ªè¾‘ã€CADå’Œç”µå­ç”µè·¯ç­‰ï¼‰ã€‚ç¨ä½œæ€»ç»“ï¼Œå¹¶æ— è¶³å¤Ÿçš„ä¸“ä¸šæ€§ä¸Žå‚è€ƒä»·å€¼ã€‚ ä¸€ã€å›¾åƒå¤„ç†1. GIMPGIMP (GNU Image Manipulation Program) æ˜¯ä¸€ä¸ªå¼€æºçš„å›¾åƒå¤„ç†å·¥å…·ï¼Œæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿã€‚å…¶åŸºæœ¬ç†å¿µå’Œæ“ä½œéƒ½å’Œ Adobe Photoshop ç±»ä¼¼ï¼Œå¯¹äºŽä½¿ç”¨è¿‡åŒç±»è½¯ä»¶çš„äººåŸºæœ¬æ²¡æœ‰å…¥æ‰‹éš¾åº¦ã€‚ GIMP æ—¢å¯ä»¥ä½œä¸ºç®€å•çš„ç”»å›¾ç¨‹åºï¼Œä¹Ÿèƒ½ä½œä¸ºä¸“å®¶çº§çš„ç…§ç‰‡å¤„ç†ï¼ˆåŒ…æ‹¬ç…§ç‰‡æ¶¦é¥°ã€å›¾åƒåˆæˆå’Œåˆ›å»ºå›¾åƒç­‰ï¼‰ç¨‹åºï¼Œæˆ–åœ¨çº¿æ‰¹å¤„ç†ç³»ç»Ÿã€æ‰¹é‡å›¾åƒæ¸²æŸ“å™¨ï¼Œä»¥åŠå›¾åƒæ ¼å¼è½¬æ¢å·¥å…·ç­‰ã€‚GIMP å…·æœ‰å¯å»¶ä¼¸æ€§å’Œå¯æ‰©å±•æ€§ï¼Œèƒ½é€šè¿‡æ‰©å±•æ’ä»¶å®Œæˆå„ç§äº‹æƒ…ã€‚å…¶é«˜çº§è„šæœ¬æŽ¥å£å…è®¸ç”¨æˆ·é€šè¿‡ç¼–å†™ç®€å•çš„è„šæœ¬å®Œæˆä»Žæœ€ç®€å•åˆ°æœ€å¤æ‚çš„å„ç§å›¾åƒå¤„ç†è¿‡ç¨‹ã€‚ ç‰¹æ€§ä¸ŽåŠŸèƒ½ å®Œæ•´çš„å›¾åƒå·¥å…·å¥—ä»¶ï¼ŒåŒ…æ‹¬ç”»ç¬”ã€é“…ç¬”ã€å–·æžªã€å…‹éš†ç­‰ã€‚ åŸºäºŽå¹³é“º(Tile-based)çš„å†…å­˜ç®¡ç†ä½¿å›¾åƒå¤§å°é™åˆ¶åœ¨å¯ç”¨çš„ç£ç›˜ç©ºé—´å†…ã€‚ å¯¹æ‰€æœ‰æ¶‚ç”»å·¥å…·éƒ½ä½¿ç”¨æ¬¡åƒç´ (Sub-pixel)å–æ ·ï¼Œèƒ½äº§ç”Ÿé«˜å“è´¨çš„åé”¯é½¿æ•ˆæžœã€‚ å®Œå…¨çš„ Alpha é€šé“æ”¯æŒã€‚ æ”¯æŒå›¾å±‚å’Œé€šé“ã€‚ å…è®¸ä»Žå¤–éƒ¨ç¨‹åº(å¦‚ Script-Fu) è°ƒç”¨ GIMP å†…éƒ¨å‘½ä»¤ã€‚ å…ˆè¿›çš„è„šæœ¬åŒ–å¤„ç†èƒ½åŠ›ã€‚ å¤šçº§æ’¤æ¶ˆ/é‡åš(åªå—ç£ç›˜ç©ºé—´å¤§å°é™åˆ¶)ã€‚ å˜æ¢å·¥å…·åŒ…æ‹¬æ—‹è½¬ï¼Œç¼©æ”¾ï¼Œåˆ‡å˜å’Œç¿»è½¬ã€‚ æ”¯æŒåŒ…æ‹¬ GIFã€JPEGã€PNGã€XPMã€TIFFã€TGAã€MPEGã€PSã€PDFã€PCXã€BMP åœ¨å†…çš„å¤šç§æ–‡ä»¶æ ¼å¼ã€‚ é€‰æ‹©å·¥å…·åŒ…æ‹¬çŸ©å½¢ã€æ¤­åœ†ã€è‡ªç”±ã€æ¨¡ç³Šã€è´èµ›å°”æ›²çº¿å’Œæ™ºèƒ½å‰ªåˆ€ã€‚ é€šè¿‡æ’ä»¶å¯ä»¥è½»æ¾åœ°æ·»åŠ å¯¹æ–°æ–‡ä»¶æ ¼å¼çš„æ”¯æŒå’Œæ•ˆæžœæ»¤é•œã€‚ ç›¸å…³èµ„æº GIMP å®˜ç½‘ ç”¨æˆ·æ‰‹å†Œ å®˜æ–¹æ•™ç¨‹ 2. InkscapeInkscape æ˜¯ä¸€ä¸ªå¼€æºçš„çŸ¢é‡å›¾å½¢ç¼–è¾‘è½¯ä»¶ï¼ŒåŠŸèƒ½ç±»ä¼¼äºŽ Adobe Illustratorã€‚åªä¸è¿‡å®ƒä½¿ç”¨ SVG (Scalable Vector Graphics) ä½œä¸ºåŽŸç”Ÿçš„æ ¼å¼ã€‚ Inkscape æ‹¥æœ‰å¤æ‚çš„ç»˜å›¾å·¥å…·ï¼Œå¸¸è¢«è®¾è®¡ä»Žä¸šäººå‘˜åŠçˆ±å¥½è€…ç”¨äºŽåˆ›å»ºå„ç§å›¾å½¢ï¼Œå¦‚æ’å›¾ï¼Œå›¾æ ‡ï¼Œå¾½æ ‡ï¼Œå›¾è¡¨ï¼Œåœ°å›¾å’Œ Web å›¾å½¢ã€‚åŒæ—¶ä¹Ÿæ”¯æŒå¯¼å…¥å’Œå¯¼å‡ºå„ç§æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬ SVGï¼ŒAIï¼ŒEPSï¼ŒPDFï¼ŒPS å’Œ PNGã€‚ ç›¸å…³èµ„æº Inkscape å®˜ç½‘ è½¯ä»¶åŠŸèƒ½ä¸Žç‰¹æ€§ å®˜æ–¹æ•™ç¨‹ Logos By Nick çš„è§†é¢‘æ•™ç¨‹ï¼ˆYouTubeï¼‰ 3. KritaKrita æ˜¯ä¸€æ¬¾å¼€æºçš„ä¸“ä¸šç»˜ç”»è½¯ä»¶ï¼Œå…¶ç›®æ ‡æ˜¯æ‰“é€ ä¸€æ¬¾äººäººéƒ½ç”¨å¾—èµ·çš„æ•°å­—ç»˜ç”»å·¥å…·ã€‚é€‚ç”¨äºŽï¼š æ¦‚å¿µç¾Žæœ¯è®¾è®¡ æè´¨ä¸Žç”µå½±å¸ƒæ™¯ æ’ç”»å’Œæ¼«ç”»ç­‰ ç›¸å…³èµ„æº Krita å®˜ç½‘ åŠŸèƒ½ä»‹ç» ç”¨æˆ·æ‰‹å†Œ äºŒã€éŸ³è§†é¢‘å‰ªè¾‘1. AudacityAudacity æ˜¯ä¸€æ¬¾å¼€æºçš„å¤šè½¨é“éŸ³é¢‘ç¼–è¾‘è½¯ä»¶ã€‚è™½ç„¶ç•Œé¢çœ‹èµ·æ¥æœ‰ç‚¹å¤å¤ã€‚ã€‚ã€‚ä½†æ˜¯åŠŸèƒ½å¾ˆå®žç”¨ä¸”éžå¸¸å®¹æ˜“ä¸Šæ‰‹ã€‚ è½¯ä»¶ç‰¹æ€§ Audacity å¯ä»¥é€šè¿‡éº¦å…‹é£Žæˆ–æ··éŸ³å™¨å½•åˆ¶çŽ°åœºéŸ³é¢‘ï¼Œæˆ–è€…å°†å…¶ä»–åª’ä½“ä¸Šçš„å½•éŸ³æ•°å­—åŒ– å¯¼å…¥ã€ç¼–è¾‘å’Œç»„åˆå£°éŸ³æ–‡ä»¶ï¼Œå¹¶ä»¥å¤šç§ä¸åŒçš„æ–‡ä»¶æ ¼å¼å¯¼å‡ºå½•åˆ¶å†…å®¹ é€šè¿‡é‡é‡‡æ ·å’ŒæŠ–åŠ¨å®Œæˆé«˜è´¨é‡çš„é‡‡æ ·çŽ‡å’Œæ ¼å¼è½¬æ¢ï¼Œæ”¯æŒ 16ä½ã€24ä½å’Œ32ä½éŸ³é¢‘ æ”¯æŒ LADSPAã€LV2ã€Nyquistã€VST å’Œ Audio Unit æ•ˆæžœæ’ä»¶ã€‚å¯ä»¥åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­è½»æ¾ä¿®æ”¹æ•ˆæžœï¼Œç”šè‡³å¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶ã€‚ é€šè¿‡å‰ªåˆ‡ã€å¤åˆ¶ã€ç²˜è´´å’Œåˆ é™¤è½»æ¾ç¼–è¾‘éŸ³é¢‘æ•°æ®ï¼Œæ— é™åˆ¶åœ°é¡ºåºæ’¤é”€å’Œé‡åš LADSPAã€LV2ã€VST å’ŒéŸ³é¢‘å•å…ƒï¼ˆmacOSï¼‰æ•ˆæžœçš„å®žæ—¶é¢„è§ˆ å¯ä»¥ä½¿ç”¨é”®ç›˜å¿«æ·é”®å®Œå…¨æ“çºµéŸ³é¢‘è½¨é“å’Œé€‰åŒº é¢‘è°±å›¾è§†å›¾æ¨¡å¼ç”¨äºŽå¯è§†åŒ–å’Œé€‰æ‹©é¢‘çŽ‡ï¼› Plot Spectrum çª—å£ç”¨äºŽè¯¦ç»†çš„é¢‘è°±åˆ†æž ç›¸å…³èµ„æºAudacity å®˜ç½‘å®˜æ–¹æ–‡æ¡£ï¼ˆåœ¨çº¿ç‰ˆï¼‰ 2. ShotcutShotcut æ˜¯ä¸€ä¸ªå¼€æºä¸”è·¨å¹³å°çš„è§†é¢‘å‰ªè¾‘è½¯ä»¶ï¼Œé€‚ç”¨äºŽ Windowsã€Mac å’Œ Linux ç³»ç»Ÿã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬å¤šç§éŸ³è§†é¢‘æ ¼å¼çš„æ”¯æŒã€åŽŸç”Ÿæ—¶é—´çº¿ç¼–è¾‘ã€åˆ†è¾¨çŽ‡æ”¯æŒ 4k ç­‰ã€‚ ç›¸å…³èµ„æº Shotcut å®˜ç½‘ åŠŸèƒ½ä¸Žç‰¹æ€§ å®˜æ–¹æ•™ç¨‹ 3. HandBrakeHandBrake æ˜¯ä¸€ç§è§†é¢‘æ ¼å¼è½¬æ¢å™¨ï¼Œå¯ä»¥å°†è§†é¢‘ä»Žå‡ ä¹Žä»»ä½•æ ¼å¼è½¬æ¢ä¸ºå½“å‰å—å¹¿æ³›æ”¯æŒçš„ç¼–ç æ ¼å¼ã€‚ ç›¸å…³èµ„æº Handbrake å®˜ç½‘ ç‰¹æ€§ å®˜æ–¹æ–‡æ¡£ ä¸‰ã€3Då»ºæ¨¡ä¸ŽCAD1. BlenderBlender æ˜¯ä¸€ä¸ªå¼€æºçš„3DåŠ¨ç”»å¥—ä»¶ï¼Œæ”¯æŒæ•´ä¸ª 3Då»ºæ¨¡ã€è£…é…ã€åŠ¨ç”»ã€æ¨¡æ‹Ÿã€æ¸²æŸ“ã€åˆæˆå’Œè¿åŠ¨è·Ÿè¸ªç­‰åˆ›ä½œæµç¨‹ï¼Œç”šè‡³åŒ…å«è§†é¢‘ç¼–è¾‘å’Œæ¸¸æˆåˆ›å»ºåŠŸèƒ½ã€‚ Blender æ˜¯éžå¸¸æƒŠè‰³çš„ Big Buck Bunny ç­‰å¼€æºåŠ¨ç”»ç”µå½±çš„ä¸»è¦åˆ¶ä½œå·¥å…·ã€‚å—¯ï¼Œä¸æ˜Žè§‰åŽ‰ã€‚ã€‚ã€‚ ç›¸å…³èµ„æºBlender å®˜ç½‘åŠŸèƒ½ä¸Žç‰¹æ€§å®˜æ–¹æ”¯æŒï¼ˆæ–‡æ¡£ã€ç¤ºä¾‹ç­‰ï¼‰Blender 2.79 ä¸­æ–‡æ‰‹å†Œ 2. OpenSCADOpenSCAD æ˜¯ç”¨äºŽåˆ›å»ºå®žä½“3D CADæ¨¡åž‹çš„å¼€æºè½¯ä»¶ã€‚ä¸Žä¸»è¦ç”¨äºŽåˆ›ä½œ3DåŠ¨ç”»çš„å¼€æºè½¯ä»¶ Blender ä¸åŒï¼Œå®ƒæ›´å…³æ³¨äºŽ3Då»ºæ¨¡çš„CADæ–¹é¢ã€‚OpenSCAD ä¸æ˜¯ä¸€ä¸ªäº¤äº’å¼å»ºæ¨¡è½¯ä»¶ã€‚ç›¸åï¼Œå®ƒç±»ä¼¼äºŽ3Dç¼–è¯‘å™¨ï¼Œè¯»å…¥æè¿°å¯¹è±¡çš„è„šæœ¬æ–‡ä»¶å¹¶é€šè¿‡è„šæœ¬ä¸­å®šä¹‰çš„å»ºæ¨¡è¿‡ç¨‹å‘ˆçŽ°3Dæ¨¡åž‹ã€‚ OpenSCAD æä¾›äº†ä¸¤ç§ä¸»è¦çš„å»ºæ¨¡æŠ€æœ¯ï¼šå»ºè®¾æ€§çš„å®žä½“å‡ ä½•ï¼ˆonstructive solid geometryï¼‰ä»¥åŠå¯¹2Dè½®å»“çš„æŒ¤åŽ‹ã€‚Autocad DXFæ–‡ä»¶å¯ç”¨ä½œæ­¤ç±»2Dè½®å»“çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚ ç›¸å…³èµ„æºOpenSCAD å®˜ç½‘å®˜æ–¹æ–‡æ¡£Github ä¸»é¡µ 2. QCADQCAD æ˜¯ä¸€ä¸ªç”¨äºŽäºŒç»´è®¡ç®—æœºè¾…åŠ©ç»˜å›¾ï¼ˆCADï¼‰çš„å¼€æºè½¯ä»¶ã€‚å¯ä»¥ç”¨å…¶åˆ›å»ºå»ºç­‘ç‰©ã€å®¤å†…è®¾è®¡ã€æœºæ¢°éƒ¨ä»¶æˆ–ç”µè·¯å›¾ç­‰æŠ€æœ¯å›¾è¡¨ã€‚æ”¯æŒ Windows, macOS å’Œ Linux ç³»ç»Ÿï¼Œå…¶æºä»£ç åœ¨ GPLv3 åè®®ä¸‹å‘å¸ƒã€‚ ç›¸å…³èµ„æºQCAD å®˜ç½‘åŠŸèƒ½ä¸Žç‰¹æ€§å®˜æ–¹æ–‡æ¡£ 3. SketchUpSketchUp æ˜¯ä¸€ä¸ªé—­æºçš„3Då»ºæ¨¡è½¯ä»¶ï¼Œé€‚ç”¨äºŽå»ºç­‘å­¦ã€å®¤å†…è®¾è®¡ã€æ™¯è§‚å»ºè®¾ã€åœŸæœ¨å’Œæœºæ¢°å·¥ç¨‹ã€ç”µå½±å’Œè§†é¢‘æ¸¸æˆè®¾è®¡ç­‰å¤šç§ç»˜å›¾åœºæ™¯ã€‚SketchUp æ˜¯ä¸€ç§ä»¥æ˜“ç”¨æ€§è‘—ç§°çš„ CAD è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºå°±åƒä½¿ç”¨ç¬”å’Œçº¸ç»˜å›¾ä¸€æ ·ç®€å•ã€‚å®ƒé‡‡ç”¨ç›´æŽ¥æŽ¨æ‹‰çš„ç¼–è¾‘æŠ€æœ¯ï¼Œç¡®ä¿å¯ä»¥å¿«é€Ÿç”Ÿæˆæ—¥å¸¸ç”¨å“çš„æ¨¡åž‹ã€‚ SketchUp åŒ…æ‹¬ä¸€ä¸ªå…è´¹çš„åœ¨çº¿ç‰ˆåº”ç”¨ç¨‹åº SketchUp Freeï¼Œä¸€ä¸ªå…è´¹çš„æ¡Œé¢ç‰ˆåº”ç”¨ç¨‹åº SketchUp Makeï¼ˆ2017å¹´12æœˆä»¥åŽåœæ­¢æ›´æ–°ï¼Œè¿ç§»åˆ°åœ¨çº¿ç‰ˆã€‚ä½†ä»æä¾›ä¸‹è½½ï¼‰ï¼Œå’Œä¸€ä¸ªå¸¦æœ‰é™„åŠ åŠŸèƒ½çš„ä»˜è´¹ç‰ˆæœ¬ SketchUp Proã€‚SketchUp è¿˜æä¾›ä¸€ä¸ªåœ¨çº¿çš„æ¨¡åž‹ç»„ä»¶åº“ï¼ˆé—¨çª—ã€æ¡Œæ¤…ã€èŠ±è‰ç­‰ç­‰ï¼‰3D Warehouseï¼Œç”¨æˆ·å¯ä»¥å‘å…¶ä¸Šä¼ è‡ªå·±åˆ›ä½œçš„æ¨¡åž‹ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒæ¨¡åž‹çš„å…è´¹ä¸‹è½½ã€‚ ç›¸å…³èµ„æºSketchUp å®˜ç½‘å¸®åŠ©ä¸­å¿ƒå®˜æ–¹ YouTube ç”µå­ç”µè·¯1. EAGLEAutodesk EAGLE æ˜¯ä¸€æ¬¾é—­æºçš„ç”µå­è®¾è®¡è‡ªåŠ¨åŒ–ï¼ˆEDAï¼‰è½¯ä»¶ã€‚å®ƒä½¿å¾—å°åˆ·ç”µè·¯æ¿ï¼ˆPCBï¼‰è®¾è®¡äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å®ŒæˆåŽŸç†å›¾è®¾è®¡ã€å…ƒä»¶å¸ƒå±€ã€PCBå¸ƒçº¿ç­‰å·¥ä½œã€‚EAGLE æœ‰æä¾›å…è´¹ç‰ˆä¾›çˆ±å¥½è€…å’Œåˆ›å®¢ä½¿ç”¨ã€‚ åŽŸç†å›¾ç¼–è¾‘å™¨ ä½¿ç”¨ä¸€æ•´å¥—SPICEä»¿çœŸæ–¹æ³•å¿«é€Ÿæµ‹è¯•æ–¹æ¡ˆå¹¶éªŒè¯ç”µè·¯æ€§èƒ½ åœ¨é¡¹ç›®ä¹‹é—´è‡ªç”±æ‹–æ”¾å¯é‡å¤ä½¿ç”¨çš„åŒºå—ï¼Œè‡ªåŠ¨åŒæ­¥åŽŸç†å›¾å’ŒPCBç”µè·¯ é€šè¿‡ä¸€æ•´å¥—ç”µå­è§„åˆ™æ£€æŸ¥éªŒè¯åŽŸç†å›¾è®¾è®¡ PCBå¸ƒå±€ç¼–è¾‘å™¨ ä½¿ç”¨ä¸€æ•´å¥—å¯¹é½å·¥å…·ç²¾ç¡®åœ°ç»„åˆä¸ŽæŽ’åˆ—PCBè®¾è®¡å¯¹è±¡ æ ¹æ®é¢„å…ˆå®šä¹‰çš„è®¾è®¡åŽŸåˆ™è‡ªé€‚åº”åœ°ã€äº¤äº’å¼åœ°å®Œæˆè·¯å¾„é€‰æ‹© é€šè¿‡å®Œå…¨å¯å®šåˆ¶çš„PCBè®¾è®¡è§„åˆ™å’Œçº¦æŸæŽ§åˆ¶è®¾è®¡æµç¨‹ï¼Œé¿å…æ— æ³•é¢„æ–™çš„æ„å¤–æƒ…å†µã€‚ å†ä¸€æ¬¡ä¸æ˜Žè§‰åŽ‰ã€‚ã€‚ã€‚æœ‰ç‚¹å°´å°¬ ç›¸å…³èµ„æºEAGLE å®˜ç½‘ç‰¹æ€§ä¸ŽåŠŸèƒ½å®˜æ–¹å­¦ä¹ ä¸­å¿ƒ 2. FritzingFritzing æ˜¯ä¸€æ¬¾ç”µå­è®¾è®¡è‡ªåŠ¨åŒ–è½¯ä»¶ï¼Œå­¦ä¹ éš¾åº¦éžå¸¸ä½Žï¼Œå¾ˆé€‚åˆåˆ›å®¢å’Œä¸šä½™çˆ±å¥½è€…ä»¬çš„éœ€æ±‚ï¼Œåœ¨ Arduino å’Œ Raspberry Pi ç”¨æˆ·ä¸­éžå¸¸å—æ¬¢è¿Žã€‚å®ƒæä¾›äº†çœŸå®žçš„â€œé¢åŒ…æ¿â€è§†å›¾ï¼Œå…¶ä¸°å¯Œçš„é›¶ä»¶åº“ä¸­ä¹ŸåŒ…å«äº†è®¸å¤šå¸¸ç”¨çš„é«˜çº§ç»„ä»¶ï¼ˆå¦‚å„ç§åž‹å·çš„ Arduino æ¿ï¼‰ã€‚Fritzing è¿˜å¯ä»¥å°†å®žç‰©åŒ–çš„ç”µå­è®¾è®¡è½¬æ¢æˆå¯ç”¨äºŽç”Ÿäº§çš„PCBå¸ƒå±€ï¼Œä¸è¿‡è²Œä¼¼åŠŸèƒ½å¾ˆåŸºç¡€ã€‚ã€‚ã€‚ ç›¸å…³èµ„æºFritzing å®˜ç½‘Github ä¸»é¡µå®˜æ–¹æ–‡æ¡£ 3. TinkercadTinkercadæ˜¯ä¸€æ¬¾å…è´¹çš„ç”¨äºŽ3Dè®¾è®¡ã€ç”µå­ç”µè·¯å’Œç¼–ç¨‹çš„åœ¨çº¿è½¯ä»¶ï¼Œä¸»è¦é¢å‘è€å¸ˆã€å­©å­ã€ä¸šä½™çˆ±å¥½è€…å’Œè®¾è®¡å¸ˆã€‚è¯¥è½¯ä»¶ä¸»è¦ç”± 3D Designs å’Œ Circuits ä¸¤ä¸ªæ¨¡å—æž„æˆï¼Œä¹‹æ‰€ä»¥æ”¾åœ¨ç”µå­ç”µè·¯è¿™ä¸€å°èŠ‚ï¼Œä¸»è¦æ˜¯æˆ‘ä¸ªäººå¯¹å®ƒçš„ 3Dè®¾è®¡æ¨¡å—ä¸å¤ªæ„Ÿå†’ï¼ˆæœ‰ç‚¹å„¿ç«¥åŒ–ï¼Ÿï¼‰ã€‚ã€‚ã€‚ä¸è¿‡åˆ›å»ºç”¨äºŽ 3Dæ‰“å°çš„æ¨¡åž‹åº”è¯¥æ˜¯æŒºæ–¹ä¾¿çš„ã€‚ å€’æ˜¯ç”µè·¯æ¨¡å—æ¯”è¾ƒå¸å¼•æˆ‘ï¼Œç•Œé¢ç±»ä¼¼äºŽ Fritzing ï¼Œå¯ä»¥åˆ©ç”¨ Blocks æˆ–è€…çº¯ä»£ç ç¼–å†™ç¨‹åºã€‚ç«Ÿç„¶è¿˜æ”¯æŒä»¿çœŸï¼Œèƒ½å¤ŸçœŸå®žåœ°æ¨¡æ‹Ÿå‡ºå®žé™…ç”µè·¯çš„è¿è¡ŒçŠ¶æ€ï¼ˆæ¯”å¦‚ LED é—ªçƒã€èˆµæœºè½¬åŠ¨ç­‰ï¼‰ã€‚ ç›¸å…³èµ„æºTkinercad å®˜ç½‘ç´ æåº“å®˜æ–¹æ•™ç¨‹ å…¶ä»–ï¼ˆä¸ªäººçˆ±å¥½ï¼‰StellariumStellarium æ˜¯ä¸€æ¬¾å…è´¹å¼€æºçš„å¤©æ–‡é¦†è½¯ä»¶ï¼Œå¯ä»¥ç”¨æ¥æ˜¾ç¤ºé€¼çœŸçš„ 3Dæ˜Ÿç©ºæ™¯è§‚ï¼Œå°±åƒç”¨è‚‰çœ¼ã€åŒç­’æœ›è¿œé•œæˆ–å¤©æ–‡æœ›è¿œé•œçœ‹åˆ°çš„ä¸€æ ·ã€‚ã€‚ã€‚æœ‰æ‰‹æœºç‰ˆï¼Œä¸è¿‡å¥½åƒä»Ž Google åº”ç”¨å•†åº—ä¸‹è½½æ˜¯ä»˜è´¹çš„ã€‚ç§»åŠ¨ç‰ˆå¯ä»¥å¼€å¯â€œè·Ÿéšâ€æ¨¡å¼ï¼Œæ ¹æ®æ‰‹æœºæ–¹å‘çš„å˜åŠ¨è‡ªåŠ¨åˆ‡æ¢æ˜¾ç¤ºçš„æ˜Ÿç©ºåŒºåŸŸï¼Œé‡Žå¤–çœ‹æ˜Ÿæ˜Ÿçš„åˆ©å™¨ã€‚ ç›¸å…³èµ„æºStellarium å®˜ç½‘ é™„æ³¨å‘ƒï¼Œæœ‰ç‚¹åˆ’æ°´äº†ã€‚ã€‚åŸºæœ¬ä¸Šç›¸å…³èµ„æºéƒ½æ˜¯å®˜ç½‘çš„é“¾æŽ¥ï¼Œï¼Œæœ‰æ—¶é—´å¥½å¥½æ‰¾æ‰¾å…¶ä»–åœ°æ–¹æœ‰ä»·å€¼çš„èµ„æ–™ã€‚ã€‚]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Software</tag>
        <tag>Opensource</tag>
        <tag>Design</tag>
        <tag>media</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux find å‘½ä»¤è¯¦è§£]]></title>
    <url>%2F2018%2F12%2F05%2FLinux-find-reference-manual%2F</url>
    <content type="text"><![CDATA[Linux ä¸Šçš„ find å‘½ä»¤æ˜¯ findutil è½¯ä»¶åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œä¸€èˆ¬å·²ç»é»˜è®¤é›†æˆåœ¨äº†å‡ ä¹Žæ‰€æœ‰çš„å‘è¡Œç‰ˆä¸­ã€‚find å‘½ä»¤æœ‰éžå¸¸å¤§çš„çµæ´»æ€§ï¼Œå¯ä»¥å‘å…¶æŒ‡å®šä¸°å¯Œçš„æœç´¢æ¡ä»¶ï¼ˆå¦‚æ–‡ä»¶æƒé™ã€å±žä¸»ã€å±žç»„ã€æ–‡ä»¶ç±»åž‹ã€æ—¥æœŸå’Œå¤§å°ç­‰ï¼‰æ¥å®šä½ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚æ­¤å¤–ï¼Œfind è¿˜æ”¯æŒå¯¹æœç´¢åˆ°çš„ç»“æžœè¿›è¡Œå¤šç§ç±»åž‹çš„å‘½ä»¤æ“ä½œã€‚ ä¸€ã€ç®€ä»‹find å‘½ä»¤çš„åŸºæœ¬ç»“æž„å¦‚ä¸‹ï¼šfind [paths] [expression] [actions] find å‘½ä»¤æŽ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªè·¯å¾„ï¼ˆpathsï¼‰ä½œä¸ºæœç´¢èŒƒå›´ï¼Œå¹¶åœ¨è¯¥è·¯å¾„ä¸‹é€’å½’åœ°æœç´¢ã€‚å³æ£€ç´¢å®ŒæŒ‡å®šçš„ç›®å½•åŽï¼Œè¿˜ä¼šå¯¹è¯¥ç›®å½•ä¸‹çš„å­ç›®å½•è¿›è¡Œæ£€ç´¢ï¼Œä»¥åŠå­ç›®å½•ä¸‹çš„å­ç›®å½•ã€‚ã€‚ã€‚ç›´åˆ°åˆ°è¾¾ç›®å½•æ ‘åº•éƒ¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ˆä¸å¸¦ä»»ä½•æœç´¢æ¡ä»¶ï¼‰ï¼Œfind å‘½ä»¤ä¼šè¿”å›žæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥å¸¸å¸¸éœ€è¦é€šè¿‡ç‰¹å®šçš„ expression å¯¹ç»“æžœè¿›è¡Œç­›é€‰ã€‚ find å‘½ä»¤é»˜è®¤çš„ action æ˜¯å°†æ‰€æœ‰æ£€ç´¢ç»“æžœæ‰“å°è‡³æ ‡å‡†è¾“å‡ºã€‚å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ action ï¼Œè®© find å‘½ä»¤å¯¹æœç´¢åˆ°çš„ç»“æžœæ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚ è¿™é‡Œå…ˆä¸åšè¯¦ç»†è§£é‡Šï¼Œç®€å•åœ°æµ‹è¯•ä¸‹ find å‘½ä»¤ï¼š æœ‰å¦‚ä¸‹ç»“æž„çš„ç¤ºä¾‹ç›®å½• directory 1234567891011121314$ tree directorydirectoryâ”œâ”€â”€ file1â”œâ”€â”€ file2â”œâ”€â”€ sub-dir1â”‚ â”œâ”€â”€ file1â”‚ â”œâ”€â”€ file2â”‚ â””â”€â”€ file3â””â”€â”€ sub-dir2 â”œâ”€â”€ file2 â””â”€â”€ sub-subdir1 â””â”€â”€ file13 directories, 7 files é»˜è®¤çš„ find å‘½ä»¤ä¼šåˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ 123456789101112$ find directorydirectorydirectory/sub-dir1directory/sub-dir1/file3directory/sub-dir1/file2directory/sub-dir1/file1directory/file2directory/sub-dir2directory/sub-dir2/file2directory/sub-dir2/sub-subdir1directory/sub-dir2/sub-subdir1/file1directory/file1 ä¸º find å‘½ä»¤æŒ‡å®š expression ä»¥ç­›é€‰å‡ºç‰¹å®šçš„æ–‡ä»¶ 1234$ find directory -name file2directory/sub-dir1/file2directory/file2directory/sub-dir2/file2 ä¸º find å‘½ä»¤æŒ‡å®šç‰¹æ®Šçš„ actionï¼ˆæ­¤å¤„ -delete è¡¨ç¤ºåˆ é™¤æœç´¢ç»“æžœï¼‰ 12345678910$ find directory -name file2 -delete$ find directorydirectorydirectory/sub-dir1directory/sub-dir1/file3directory/sub-dir1/file1directory/sub-dir2directory/sub-dir2/sub-subdir1directory/sub-dir2/sub-subdir1/file1directory/file1 äºŒã€æœç´¢æ¡ä»¶ï¼ˆexpressionï¼‰1. æ ¹æ®æ–‡ä»¶åæ£€ç´¢find å‘½ä»¤ä¸­çš„ -name é€‰é¡¹å¯ä»¥æ ¹æ®æ–‡ä»¶åç§°è¿›è¡Œæ£€ç´¢ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚å¦‚éœ€è¦å¿½ç•¥æ–‡ä»¶åä¸­çš„å¤§å°å†™ï¼Œå¯ä»¥ä½¿ç”¨ -iname é€‰é¡¹ã€‚ -name å’Œ -iname ä¸¤ä¸ªé€‰é¡¹éƒ½æ”¯æŒ wildcards ã€‚å¦‚ï¼š ? å¯ä»¥è¡¨ç¤ºä»»æ„ä¸€ä¸ªå•ä¸€çš„ç¬¦å· * å¯ä»¥è¡¨ç¤ºä»»æ„æ•°é‡ï¼ˆåŒ…æ‹¬ 0ï¼‰çš„æœªçŸ¥ç¬¦å· find /usr -name &#39;*.txt&#39; æŸ¥æ‰¾ /usr ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åä»¥ .txt ç»“å°¾çš„æ–‡ä»¶find /usr -name &#39;????&#39; æŸ¥æ‰¾ /usr ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ååˆšå¥½ä¸º 4 ä¸ªå­—ç¬¦çš„æ–‡ä»¶ æœ‰äº›æ—¶å€™ï¼Œä½ éœ€è¦åœ¨æœç´¢æ—¶åŒ¹é…æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å®Œæ•´è·¯å¾„ï¼Œè€Œä¸ä»…ä»…æ˜¯åŒ¹é…æ–‡ä»¶åã€‚å¯ä»¥ä½¿ç”¨ -path æˆ– -ipath é€‰é¡¹ã€‚ å¦‚æŸ¥æ‰¾ /usr ä¸‹æ‰€æœ‰æ–‡ä»¶åä»¥ .txt ç»“å°¾çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”è¯¥æ–‡ä»¶çš„çˆ¶ç›®å½•å¿…é¡»æ˜¯ srcã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šfind /usr -path &#39;*/src/*.txt&#39; 2. æ ¹æ®æ–‡ä»¶ç±»åž‹æ£€ç´¢å¦‚æžœåªæƒ³æœç´¢å¾—åˆ°æ–‡ä»¶æˆ–ç›®å½•ï¼Œå³ä¸æƒ³å®ƒä»¬åŒæ—¶å‡ºçŽ°åœ¨ç»“æžœä¸­ã€‚å¯ä»¥ä½¿ç”¨ -type é€‰é¡¹æŒ‡å®šæ–‡ä»¶ç±»åž‹ã€‚ -type é€‰é¡¹æœ€å¸¸ç”¨çš„å‚æ•°å¦‚ä¸‹ï¼š f: æ–‡ä»¶ d: ç›®å½• l: ç¬¦å·é“¾æŽ¥ find /usr -type d -name &#39;python*&#39; æ£€ç´¢ /usr ä¸‹æ‰€æœ‰æ–‡ä»¶åä»¥ python å¼€å¤´çš„ç›®å½• 3. æ£€ç´¢ç©ºæ–‡ä»¶find å‘½ä»¤æ”¯æŒ -empty é€‰é¡¹ç”¨æ¥æ£€ç´¢ä¸ºç©ºçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ç©ºæ–‡ä»¶å³æ–‡ä»¶é‡Œæ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œç©ºç›®å½•å³ç›®å½•ä¸­æ²¡æœ‰ä»»ä½•æ–‡ä»¶æˆ–å­ç›®å½•ã€‚ find ~ -type d -empty æ£€ç´¢ç”¨æˆ·ä¸»ç›®å½•ä¸‹æ‰€æœ‰çš„ç©ºç›®å½• 4. åä¹‰åŒ¹é…find å‘½ä»¤ä¹Ÿå…è®¸ç”¨æˆ·å¯¹å½“å‰çš„åŒ¹é…æ¡ä»¶è¿›è¡Œâ€œåä¹‰â€ï¼ˆç±»ä¼¼äºŽé€»è¾‘éžæ“ä½œï¼‰ã€‚ å¦‚éœ€è¦æ£€ç´¢ /usr ä¸‹æ‰€æœ‰æ–‡ä»¶åä¸ä»¥ .txt ä¸ºåŽç¼€çš„æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šfind /usr -type f ! -name &#39;*.txt&#39; ä¹Ÿå¯ä»¥â€œç¿»è½¬â€ä»»ä½•å…¶ä»–çš„ç­›é€‰æ¡ä»¶ï¼Œå¦‚ï¼šfind /usr -type f ! -empty æ£€ç´¢ /usr ä¸‹æ‰€æœ‰å†…å®¹ä¸ä¸ºç©ºçš„æ–‡ä»¶ 5. æ ¹æ®æ–‡ä»¶çš„æ‰€å±žæƒæ£€ç´¢ä¸ºäº†æ£€ç´¢å½’å±žäºŽç‰¹å®šç”¨æˆ·çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ -user é€‰é¡¹ã€‚ find / -type f -user starky æ£€ç´¢æ ¹ç›®å½•ä¸‹æ‰€æœ‰å±žä¸»ä¸º starky çš„æ–‡ä»¶ ç±»ä¼¼äºŽ -useré€‰é¡¹ï¼Œ-group é€‰é¡¹åˆ™å¯ä»¥æ ¹æ®æ–‡ä»¶æˆ–ç›®å½•çš„å±žç»„è¿›è¡Œæ£€ç´¢ã€‚ 6. æ ¹æ®æ—¶é—´æ—¥æœŸè¿›è¡Œæ£€ç´¢æœ‰äº›æ—¶å€™ï¼Œéœ€è¦æ ¹æ®æ–‡ä»¶åˆ›å»ºæˆ–ä¿®æ”¹çš„æ—¶é—´è¿›è¡Œæ£€ç´¢ã€‚ Linux ç³»ç»Ÿä¸­ï¼Œä¸Žæ–‡ä»¶ç›¸å…³è”çš„æ—¶é—´å‚æ•°æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š ä¿®æ”¹æ—¶é—´ï¼ˆModification timeï¼‰ï¼šæœ€åŽä¸€æ¬¡æ–‡ä»¶å†…å®¹æœ‰è¿‡æ›´æ”¹çš„æ—¶é—´ç‚¹ è®¿é—®æ—¶é—´ï¼ˆAccess timeï¼‰ï¼šæœ€åŽä¸€æ¬¡æ–‡ä»¶æœ‰è¢«è¯»å–è¿‡çš„æ—¶é—´ç‚¹ å˜æ›´æ—¶é—´ï¼ˆChange timeï¼‰ï¼šæœ€åŽä¸€æ¬¡æ–‡ä»¶æœ‰è¢«å˜æ›´è¿‡çš„æ—¶é—´ç‚¹ï¼ˆå¦‚å†…å®¹è¢«ä¿®æ”¹ï¼Œæˆ–æƒé™ç­‰ metadata è¢«ä¿®æ”¹ï¼‰ ä¸Žæ­¤å¯¹åº”çš„æ˜¯ find å‘½ä»¤ä¸­çš„ -mtimeï¼Œ-atime å’Œ -ctime ä¸‰ä¸ªé€‰é¡¹ã€‚ è¿™ä¸‰ä¸ªé€‰é¡¹çš„ä½¿ç”¨éµå¾ªä»¥ä¸‹ç¤ºä¾‹ä¸­çš„è§„åˆ™ï¼š -mtime 2ï¼šè¯¥æ–‡ä»¶ 2 å¤©å‰è¢«ä¿®æ”¹è¿‡ -mtime -2ï¼šè¯¥æ–‡ä»¶ 2 å¤©ä»¥å†…è¢«ä¿®æ”¹è¿‡ -mtime +2ï¼šè¯¥æ–‡ä»¶è·ç¦»ä¸Šæ¬¡ä¿®æ”¹å·²ç»è¶…è¿‡ 2 å¤©æ—¶é—´ find /usr -type f -mtime 2 æ£€ç´¢ /usr ä¸‹ä¸¤å¤©å‰è¢«ä¿®æ”¹è¿‡çš„æ–‡ä»¶ å¦‚æžœè§‰å¾— -mtime ç­‰é€‰é¡¹ä»¥å¤©ä¸ºå•ä½æ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ -mminï¼Œ-aminï¼Œ-cmin ä¸‰ä¸ªé€‰é¡¹ï¼šfind /usr -type f -mtime +50 -mtime -100 æ£€ç´¢ /usr ä¸‹ 50 åˆ° 100 å¤©ä¹‹å‰ä¿®æ”¹è¿‡çš„æ–‡ä»¶find /usr -type f -mtime 2 -amin 5 æ£€ç´¢ /usr ä¸‹ä¸¤å¤©å‰è¢«ä¿®æ”¹è¿‡ä¸” 5 åˆ†é’Ÿå‰åˆè¯»å–è¿‡çš„æ–‡ä»¶ 7. æ ¹æ®æ–‡ä»¶å¤§å°æ£€ç´¢-size é€‰é¡¹å…è®¸ç”¨æˆ·é€šè¿‡æ–‡ä»¶å¤§å°è¿›è¡Œæœç´¢ï¼ˆåªé€‚ç”¨äºŽæ–‡ä»¶ï¼Œç›®å½•æ²¡æœ‰å¤§å°â€¦â€¦ï¼‰ã€‚ è¡¨ç¤ºæ–‡ä»¶å¤§å°çš„å•ä½ç”±ä»¥ä¸‹å­—ç¬¦ç»„æˆï¼š cï¼šå­—èŠ‚ kï¼šKb Mï¼šMb Gï¼šGb å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ + æˆ– - ç¬¦å·è¡¨ç¤ºå¤§äºŽæˆ–å°äºŽå½“å‰æ¡ä»¶ã€‚ find / -size +1G æ£€ç´¢æ–‡ä»¶å¤§å°é«˜äºŽ 1 GB çš„æ–‡ä»¶ 8. æ ¹æ®æ–‡ä»¶æƒé™æ£€ç´¢find å‘½ä»¤å¯ä»¥ä½¿ç”¨ -perm é€‰é¡¹ä»¥æ–‡ä»¶æƒé™ä¸ºä¾æ®è¿›è¡Œæœç´¢ã€‚ ä½¿ç”¨ç¬¦å·å½¢å¼å¦‚éœ€è¦æ£€ç´¢ /usr ç›®å½•ä¸‹æƒé™ä¸º rwxr-xr-x çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šfind /usr -perm u=rwx,g=rx,o=rx æœç´¢ /usr ç›®å½•ä¸‹æ‰€æœ‰æƒé™ä¸º r-xr-xr-xï¼ˆå³ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½åªæœ‰è¯»å†™æƒé™ï¼‰çš„æ–‡ä»¶å’Œç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šfind /usr -perm a=rx å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³åŒ¹é…æ–‡ä»¶æƒé™çš„ä¸€ä¸ªå­é›†ã€‚æ¯”å¦‚ï¼Œæ£€ç´¢å¯ä»¥ç›´æŽ¥è¢«ä»»ä½•ç”¨æˆ·æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå³åªå…³å¿ƒæ–‡ä»¶çš„æ‰§è¡Œæƒé™ï¼Œè€Œä¸ç”¨ç®¡å…¶è¯»å†™æƒé™æ˜¯ä»€ä¹ˆã€‚ ä¸Šè¿°çš„éœ€æ±‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®žçŽ°ï¼šfind / -type f -perm /a=xå…¶ä¸­ a=x å‰é¢çš„ / ç¬¦å·å³ç”¨æ¥è¡¨ç¤ºåªåŒ¹é…æƒé™çš„æŸä¸ªå­é›†ï¼ˆæ‰§è¡Œæƒé™ï¼‰ï¼Œè€Œä¸ç”¨å…³å¿ƒå…¶ä»–æƒé™çš„å…·ä½“è®¾ç½®ã€‚ ä½¿ç”¨æ•°å­—å½¢å¼-perm é€‰é¡¹ä¹Ÿæ”¯æŒæ•°å­—å½¢å¼çš„æ–‡ä»¶æƒé™æ ‡è®°ã€‚ find /usr -perm 644 æœç´¢ /usr ç›®å½•ä¸‹æƒé™ä¸º 644ï¼ˆå³ rwxr-xr-xï¼‰çš„æ–‡ä»¶ 9. é™åˆ¶éåŽ†çš„å±‚æ•°find å‘½ä»¤é»˜è®¤æ˜¯ä»¥é€’å½’çš„æ–¹å¼æ£€ç´¢é¡¹ç›®çš„ï¼Œè¿™æœ‰æ—¶å€™ä¼šå¯¼è‡´å¾—åˆ°çš„ç»“æžœæ•°é‡éžå¸¸å·¨å¤§ã€‚å¯ä»¥ä½¿ç”¨ -maxdepth é™åˆ¶ find å‘½ä»¤é€’å½’çš„å±‚æ•°ã€‚ find / -maxdepth 3 æœç´¢æ—¶å‘ä¸‹é€’å½’çš„å±‚æ•°æœ€å¤§ä¸º 3 10. é€»è¾‘ç»„åˆåœ¨ä¹‹å‰çš„ä¾‹å­ä¸­æœ‰å‡ºçŽ°å¤šä¸ªæœç´¢æ¡ä»¶çš„ç»„åˆä»¥åŠå¯¹æŸä¸ªæœç´¢æ¡ä»¶çš„åè½¬ã€‚å®žé™…ä¸Š find å‘½ä»¤æ”¯æŒ â€œandâ€ å’Œ â€œorâ€ ä¸¤ç§é€»è¾‘è¿ç®—ï¼Œå¯¹åº”çš„å‘½ä»¤é€‰é¡¹åˆ†åˆ«æ˜¯ -a å’Œ -oã€‚é€šè¿‡è¿™ä¸¤ä¸ªé€‰é¡¹å¯ä»¥å¯¹æœç´¢æ¡ä»¶è¿›è¡Œæ›´å¤æ‚çš„ç»„åˆã€‚ æ­¤å¤–è¿˜å¯ä»¥ä½¿ç”¨å°æ‹¬å·å¯¹æœç´¢æ¡ä»¶è¿›è¡Œåˆ†ç»„ã€‚æ³¨æ„ find å‘½ä»¤ä¸­çš„å°æ‹¬å·å¸¸éœ€è¦ç”¨å•å¼•å·åŒ…è£¹èµ·æ¥ã€‚å› å°æ‹¬å·åœ¨ Shell ä¸­æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚ å¦‚æ£€ç´¢ /usr ä¸‹æ–‡ä»¶åä»¥ python å¼€å¤´ä¸”ç±»åž‹ä¸ºç›®å½•çš„æ–‡ä»¶find /usr -type d -name &#39;python*&#39; è¯¥å‘½ä»¤ç­‰åŒäºŽï¼šfind /usr -type d -a -name &#39;python*&#39; æ›´å¤æ‚çš„ç»„åˆå½¢å¼å¦‚ï¼šfind / &#39;(&#39; -mmin -5 -o -mtime +50 &#39;)&#39; -a -type f ä¸‰ã€å¯¹æœç´¢ç»“æžœæ‰§è¡Œå‘½ä»¤1. åˆ é™¤æ–‡ä»¶-delete é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ é™¤æœç´¢åˆ°çš„æ–‡ä»¶å’Œç›®å½•ã€‚ å¦‚åˆ é™¤ home ç›®å½•ä¸‹æ‰€æœ‰çš„ç©ºç›®å½•ï¼šfind ~ -type d -empty -delete 2. æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤-exec é€‰é¡¹å¯ä»¥å¯¹æœç´¢åˆ°çš„ç»“æžœæ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ã€‚ å¦‚éœ€è¦å°† home ç›®å½•ä¸‹æ‰€æœ‰çš„ MP3 éŸ³é¢‘æ–‡ä»¶å¤åˆ¶åˆ°ç§»åŠ¨å­˜å‚¨è®¾å¤‡ï¼ˆå‡è®¾è·¯å¾„æ˜¯ /media/MyDriveï¼‰ï¼Œå¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼šfind ~ -type f -name &#39;*.mp3&#39; -exec cp {} /media/MyDrive &#39;;&#39; å…¶ä¸­çš„å¤§æ‹¬å·ï¼ˆ{}ï¼‰ä½œä¸ºæ£€ç´¢åˆ°çš„æ–‡ä»¶çš„ å ä½ç¬¦ ï¼Œè€Œåˆ†å·ï¼ˆ ;ï¼‰ä½œä¸ºå‘½ä»¤ç»“æŸçš„æ ‡å¿—ã€‚å› ä¸ºåˆ†å·æ˜¯ Shell ä¸­æœ‰ç‰¹æ®Šå«ä¹‰çš„ç¬¦å·ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥ã€‚æ¯å½“ find å‘½ä»¤æ£€ç´¢åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ï¼Œä¼šä½¿ç”¨å…¶å®Œæ•´è·¯å¾„å–ä»£å‘½ä»¤ä¸­çš„ {}ï¼Œç„¶åŽæ‰§è¡Œ -exec åŽé¢çš„å‘½ä»¤ä¸€æ¬¡ã€‚ å¦ä¸€ä¸ªå¾ˆé‡è¦çš„ç”¨æ³•æ˜¯ï¼Œåœ¨å¤šä¸ªæ–‡ä»¶ä¸­æ£€ç´¢æŸä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚å¦‚åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸­æ£€ç´¢å­—ç¬¦ä¸² hello ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼šfind ~ -type f -exec grep -l hello {} &#39;;&#39; -exec é€‰é¡¹ä¸­çš„ + ç¬¦å·åˆ›å»º Gzip æ ¼å¼çš„åŽ‹ç¼©æ–‡ä»¶çš„å‘½ä»¤ä¸ºï¼štar -czvf filename.tar.gz &lt;list of files&gt; çŽ°åœ¨å‡è®¾éœ€è¦å°†ç”¨æˆ·ä¸»ç›®å½•ä¸‹æ‰€æœ‰çš„ MP3 æ–‡ä»¶æ·»åŠ åˆ°åŽ‹ç¼©åŒ… music.tar.gz ä¸­ï¼Œç›´è§‚çš„æ„Ÿè§‰æ˜¯ï¼Œå…¶å‘½ä»¤åº”ä¸ºå¦‚ä¸‹å½¢å¼ï¼šfind ~ -type f -name &#39;*.mp3&#39; -exec tar -czvf music.tar.gz {} &#39;;&#39; å®žé™…æƒ…å†µæ˜¯ï¼Œè¿™æ ·å¾—åˆ°çš„ music.tar.gz å…¶å®žåªåŒ…å«ä¸€ä¸ª MP3 æ–‡ä»¶ã€‚åŽŸå› æ˜¯ find å‘½ä»¤æ¯æ¬¡å‘çŽ°ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œéƒ½ä¼šå†æ‰§è¡Œä¸€æ¬¡ -exec é€‰é¡¹åŽé¢çš„åŽ‹ç¼©å‘½ä»¤ã€‚å¯¼è‡´å…ˆå‰ç”Ÿæˆçš„åŽ‹ç¼©åŒ…è¢«è¦†ç›–ã€‚ å¯ä»¥å…ˆè®© find å‘½ä»¤æ£€ç´¢å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„éŸ³é¢‘æ–‡ä»¶ï¼Œå†å°†å¾—åˆ°çš„æ–‡ä»¶åˆ—è¡¨ä¼ é€’ç»™åŽé¢çš„åŽ‹ç¼©å‘½ä»¤ã€‚å®Œæ•´çš„å‘½ä»¤å¦‚ä¸‹ï¼šfind ~ -type f -name &#39;*.mp3&#39; -exec tar -czvf music.tar.gz {} + æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯å¦‚æžœæƒ³æµè§ˆæœç´¢åˆ°çš„æ–‡ä»¶ï¼ˆç›®å½•ï¼‰çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚æƒé™å’Œå¤§å°ç­‰ï¼‰ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ -ls é€‰é¡¹ã€‚ find / -type file -size +1G -ls æµè§ˆæ‰€æœ‰ 1G ä»¥ä¸Šå¤§å°çš„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ å››ã€å¸¸ç”¨å‚æ•°æ±‡æ€» å‚æ•° è§£æž -atime n[smhdw] è·ç¦»æ–‡ä»¶ä¸Šæ¬¡è¢«è®¿é—®æ—¶çš„æ—¶é—´é—´éš” -ctime n[smhdw] è·ç¦»æ–‡ä»¶åˆ›å»ºæ—¶çš„æ—¶é—´é—´éš” -delete åˆ é™¤æ£€ç´¢åˆ°çš„æ–‡ä»¶ -depth n æ£€ç´¢æ·±åº¦ä¸º n çš„æ–‡ä»¶ï¼Œå³ä½äºŽæŒ‡å®šç›®å½•ä»¥ä¸‹ n å±‚çš„æ–‡ä»¶ -empty æ£€ç´¢ç©ºæ–‡ä»¶æˆ–ç©ºç›®å½• -fstype type æŒ‡å®šæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶ç³»ç»Ÿçš„ç±»åž‹ -group gname æŒ‡å®šæ–‡ä»¶çš„å±žç»„ -iname pattern åŒ -nameï¼Œå¿½ç•¥å¤§å°å†™ -ipath pattern åŒ -pathï¼Œå¿½ç•¥å¤§å°å†™ -ls æ‰“å°æœç´¢åˆ°çš„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ -maxdepth n æŒ‡å®šé€’å½’çš„æœ€å¤§å±‚æ•°ä¸º n -mtime n[smhdw] è·ç¦»æ–‡ä»¶ä¸Šæ¬¡å‘ç”Ÿå˜æ›´æ—¶çš„æ—¶é—´é—´éš” -name pattern æœç´¢æ—¶ä½¿ç”¨ pattern å¯¹æ–‡ä»¶åè¿›è¡ŒåŒ¹é… -path pattern æœç´¢æ—¶ä½¿ç”¨ pattern å¯¹æ–‡ä»¶è·¯å¾„è¿›è¡ŒåŒ¹é… -perm mode æ ¹æ®æ–‡ä»¶æƒé™æœç´¢ -size n[ckMGTP] æ ¹æ®æ–‡ä»¶å¤§å°æœç´¢ -type t æ ¹æ®æ–‡ä»¶ç±»åž‹æœç´¢ -user uname æŒ‡å®šæ–‡ä»¶çš„å±žä¸» å‚è€ƒèµ„æ–™A Guide to the Linux â€œFindâ€ Commandfind å‘½ä»¤æ‰‹å†Œï¼šman find]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Commands</tag>
        <tag>Shell</tag>
        <tag>Manual</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ JavaScript å¯¹ Arduino ç¼–ç¨‹]]></title>
    <url>%2F2018%2F12%2F03%2Fjavascript-arduino-programming%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å‘ Arduino åˆ·å…¥ Firmata å›ºä»¶ Firmata æ˜¯ä¸€ç§å¼€æ”¾çš„ç±»ä¼¼äºŽ MIDI çš„åè®®ã€‚å®ƒå¯ä»¥å°†å¾®æŽ§åˆ¶å™¨ï¼ˆmicrocontrollerï¼‰å˜æˆâ€œå®¢æˆ·ç«¯â€ï¼Œé€šè¿‡ä¸²å£é€šä¿¡ç›´æŽ¥è¢«â€œä¸»æœºâ€ç”µè„‘è®¿é—®å’ŒæŽ§åˆ¶ã€‚é€šè¿‡ Firmata åè®®ï¼Œå¯ä»¥åœ¨ä¸»æœºä¸Šä½¿ç”¨ Rubyã€Pythonã€JavaScript ç­‰å¤šç§è¯­è¨€ä¸Žåˆ·å…¥äº† Firmata å›ºä»¶çš„ arduino æ¿â€œäº¤æµâ€ã€‚ é¦–å…ˆå®‰è£… firmata-party å·¥å…·ï¼š$ npm install -g firmata-partyå®‰è£…æˆåŠŸåŽé€šè¿‡ USB çº¿å°† Arduino æ¿è¿žæŽ¥è‡³ç”µè„‘ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š123456$ firmata-party uno --debugfound uno on port /dev/tty.usbserial-14110connectedreset complete.flashing, please wait...flash complete. åˆ·å†™å®Œæ¯•åŽï¼Œå¯ä»¥é€šè¿‡ Firmata Test Program è¿›è¡Œç®€å•çš„æµ‹è¯•ã€‚ äºŒã€ä½¿ç”¨ JavaScript ç¼–ç¨‹Blink LEDå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¼€å§‹ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼š123$ mkdir test &amp;&amp; cd test$ npm init -y$ npm install --save firmata ç¼–è¾‘æºä»£ç æ–‡ä»¶ï¼ˆblink_led.jsï¼‰ç”¨æ¥æŽ§åˆ¶ LED é—ªçƒï¼š123456789101112131415161718192021222324252627282930313233// åŠ è½½ä¾èµ–åº“var Board = require(&apos;firmata&apos;);// è¿žæŽ¥åˆå§‹åŒ–Board.requestPort(function(error, port) &#123; if (error) &#123; console.log(error); return; &#125; var board = new Board(port.comName); // ç­‰å¾…è¿žæŽ¥ board.on(&quot;ready&quot;,function() &#123; console.log(&quot;Ready!&quot;); var ledOn = true; // è®¾ç½® pin 13 ä¸ºè¾“å‡ºå¼•è„š board.pinMode(13, board.MODES.OUTPUT); // ä½¿ LED é—ªçƒ setInterval(function() &#123; if (ledOn) &#123; console.log(&apos;ON&apos;); board.digitalWrite(13, board.HIGH); &#125; else &#123; console.log(&apos;OFF&apos;); board.digitalWrite(13, board.LOW); &#125; ledOn = !ledOn; &#125;, 1000); &#125;);&#125;); è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š123456$ node blink_led2.jsReady!ONOFFON... ä»£ç æ‰§è¡ŒåŽ arduino æ¿å­ä¸Š 13 å·å¼•è„šä¸ŠæŽ¥çš„ LED å¼€å§‹ä»¥ 1 ç§’çš„é—´éš”é—ªçƒï¼ŒåŒæ—¶ç”µè„‘çš„ç»ˆç«¯ç•Œé¢ä¸åœåœ°è¾“å‡º ON å’Œ OFF è¡¨ç¤ºå½“å‰ LED çš„å¼€å…³çŠ¶æ€ã€‚ Analog InputArduino æ¿å­ä¸Šçš„ A0 - A5 å¼•è„šå¯ä»¥è¯»å–æ¨¡æ‹Ÿè¾“å…¥ä¿¡å·ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344// åŠ è½½ä¾èµ–åº“var Board = require(&apos;firmata&apos;);// å¼•è„šå®šä¹‰const LED = 5;const POT = 0;// åˆå§‹åŒ–å˜é‡var ledOn = 0;var delay = 0;// map å‡½æ•°ã€‚å°†åˆå§‹çš„æ•°å€¼èŒƒå›´è½¬å˜æˆéœ€è¦çš„æ•°å€¼èŒƒå›´function map(x, in_min, in_max, out_min, out_max)&#123; return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;&#125;// è¿žæŽ¥åˆå§‹åŒ–Board.requestPort(function(error, port) &#123; if (error) &#123; console.log(error); return; &#125; var board = new Board(port.comName); // ç­‰å¾…è¿žæŽ¥ board.on(&quot;ready&quot;, function() &#123; // æŽ§åˆ¶ LED é—ªçƒçš„ blink() å‡½æ•° function blink() &#123; board.digitalWrite(LED, ledOn); ledOn = !ledOn; setTimeout(blink, delay); &#125; // è¯»å–å¹¶æ›´æ–°å¯å˜ç”µé˜»æä¾›çš„æ¨¡æ‹Ÿè¾“å…¥ board.analogRead(0, function(d) &#123; delay = map(d, 0, 1023, 400, 1600); &#125;); blink(); &#125;);&#125;); çº¿è·¯è¿žæŽ¥å›¾å¦‚ä¸‹ï¼š å³é€šè¿‡ Arduino æ¿ A0 å¼•è„šå¯ä»¥è¯»å–æ¨¡æ‹Ÿè¾“å…¥çš„åŠŸèƒ½ï¼ˆè¿žæŽ¥å¯å˜ç”µé˜»çš„ä¸­é—´å¼•è„šï¼‰ï¼ŒèŽ·å–å¯å˜ç”µé˜»çš„å–å€¼ï¼ˆ0-1023ï¼‰ã€‚å†é€šè¿‡ç¨‹åºä¸­çš„ map å‡½æ•°å°† 0-1023 çš„å–å€¼è½¬å˜æˆ 400-1600ï¼Œä½œä¸ºæŽ¥åœ¨ 5 å·å¼•è„šä¸Š LED çš„é—ªçƒé¢‘çŽ‡ã€‚ ç¨‹åºè¿è¡ŒåŽï¼Œè°ƒèŠ‚å¯å˜ç”µé˜»çš„æ—‹é’®ï¼ŒLED å³ä»¥ä¸åŒçš„æ—¶é—´é—´éš”ï¼ˆ0.4s - 1.6sï¼‰é—ªçƒã€‚ PWM (Pulse-Width Modulation)PWM å³è„‰å®½è°ƒåˆ¶ï¼Œå…¶æœºåˆ¶ä¸ºï¼šé€šè¿‡ MCU å†…éƒ¨çš„è®¡æ—¶å™¨è®¾ç½®å¼•è„šçš„çŠ¶æ€ï¼Œä½¿è¯¥å¼•è„šåœ¨ä¸€ä¸ªå‘¨æœŸå†…çš„æŸæ®µæ—¶é—´ä¿æŒ HIGH çŠ¶æ€ï¼Œåœ¨è¯¥å‘¨æœŸå†…çš„å…¶ä½™æ—¶é—´ä¿æŒ LOW çŠ¶æ€ã€‚å¹³å‡ä¸‹æ¥çœ‹ï¼Œè¯¥å¼•è„šçš„è¾“å‡ºç”µåŽ‹å³ä»‹äºŽæœ€ä½Žå’Œæœ€é«˜è¾“å‡ºç”µåŽ‹ä¹‹é—´ï¼ˆå³ 0~5 V ä¹‹é—´ï¼‰ã€‚æ‰€ä»¥ä¸€èˆ¬å¯ä»¥è¿‘ä¼¼åœ°ä½œä¸ºæ¨¡æ‹Ÿç”µåŽ‹è¾“å‡ºã€‚1234567891011121314151617181920212223242526272829303132333435// åŠ è½½ä¾èµ–åº“var Board = require(&apos;firmata&apos;);// å˜é‡å®šä¹‰const LED = 5;var brightness = 0;var fadeAmount = 5;// è¿žæŽ¥åˆå§‹åŒ–Board.requestPort(function(error, port) &#123; if (error) &#123; console.log(error); return; &#125; var board = new Board(port.comName); // ç­‰å¾…è¿žæŽ¥ board.on(&quot;ready&quot;, function() &#123; // è®¾ç½® LED å¼•è„šä¸º PWM æ¨¡å¼ board.pinMode(LED, board.MODES.PWM); // æ¯éš” 30 ms æé«˜æˆ–é™ä½Ž LED äº®åº¦ï¼Œå¾ªçŽ¯æ‰§è¡Œ function fadeLed() &#123; brightness += fadeAmount; if (brightness ==0 || brightness == 255) &#123; fadeAmount = -fadeAmount; &#125; board.analogWrite(LED, brightness); setTimeout(fadeLed, 30); &#125; fadeLed(); &#125;);&#125;); è¯¥ç¨‹åºæ‰§è¡ŒåŽï¼Œ5 å·å¼•è„šä¸Šçš„ LED ç¯å…ˆæ˜¯ç¼“æ…¢å˜äº®ï¼Œè¾¾åˆ°æœ€äº®ä»¥åŽå†ç¼“æ…¢å˜æš—ã€‚ä¾ç…§æ­¤è§„åˆ™å¾ªçŽ¯ã€‚ é™„å½•ï¼šJavaScript çš„ä¸²å£é€šä¿¡å³ä½¿ Arduino æ¿å­æœªåˆ·å…¥ Firmata å›ºä»¶ï¼Œè¿è¡Œçš„æ˜¯æ™®é€šçš„ç¨‹åºã€‚ä¹Ÿå¯ä»¥åˆ©ç”¨ Node.js çš„ serialport åº“å’Œä¸²å£é€šä¿¡å®Œæˆ Arduino ä¸Žä¸»æœºçš„å¯¹è¯ã€‚ é¦–å…ˆåˆå§‹åŒ–é¡¹ç›®å¹¶å®‰è£…ä¾èµ–åº“ï¼š123$ mkdir test2 &amp;&amp; cd test2$ npm init -y$ npm install --save-dev serialport æ‰«æä¸²å£è®¾å¤‡12345678910$ cat list_ports.jsvar serialPort = require(&quot;serialport&quot;);serialPort.list(function (error, ports) &#123; ports.forEach(function(port) &#123; console.log(port.comName); &#125;);&#125;);$ node list_ports.js/dev/tty.Bluetooth-Incoming-Port/dev/tty.usbserial-14110 ä»Ž Arduino æ”¶å–æ•°æ®é¦–å…ˆé€šè¿‡ Arduino IDE åˆ·å…¥ä»¥ä¸‹ counter.ino æ–‡ä»¶ï¼Œä½œä¸ºå‘é€ç«¯ç¨‹åºï¼š123456789void setup() &#123; Serial.begin(9600);&#125;int i=0;void loop() &#123; Serial.println(i++); delay(1000);&#125; ä¸Šè¿°ä»£ç ä»¥ 1000 ms çš„é—´éš”ç”Ÿæˆä»Ž 0 å¼€å§‹ä¸æ–­é€’å¢žçš„æ•°å­—å¹¶å‘é€è‡³ä¸²å£ã€‚ ç”µè„‘ç«¯çš„æŽ¥æ”¶ç¨‹åº read_port.js ä»£ç å¦‚ä¸‹ï¼š123456const SerialPort = require(&apos;serialport&apos;)const Readline = require(&apos;@serialport/parser-readline&apos;)const port = new SerialPort(&apos;/dev/cu.usbserial-14110&apos;)const parser = port.pipe(new Readline(&#123; delimiter: &apos;\n&apos; &#125;))parser.on(&apos;data&apos;, console.log) è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼šå‘é€ç«¯ä¸æ–­ç”Ÿæˆæ–°çš„æ•°å­—å¹¶å‘é€è‡³ä¸²å£ï¼ŒæŽ¥æ”¶ç«¯é€šè¿‡ä¸²å£æŽ¥æ”¶è¯¥æ•°å­—åŽå°†å…¶æ‰“å°åˆ°ç»ˆç«¯è¾“å‡ºã€‚ å‘ Arduino å‘é€æ•°æ®é¦–å…ˆé€šè¿‡ Arduino IDE åˆ·å…¥ä»¥ä¸‹ receiver.ino æ–‡ä»¶ï¼Œä½œä¸ºæŽ¥æ”¶ç«¯ç¨‹åºï¼š1234567891011121314void setup() &#123; Serial.begin(9600);&#125;void loop() &#123; int incoming = 0; if (Serial.available() &gt; 0) &#123; incoming = Serial.parseInt(); if (Serial.read() == &apos;\n&apos;) &#123; Serial.println(incoming); &#125; &#125;&#125; å‘é€ç«¯çš„ write_port.js ç¨‹åºä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617var SerialPort = require(&apos;serialport&apos;);var Stream = require(&apos;stream&apos;);var modem = &apos;cu.usbserial-14110&apos;;var ws = new Stream();ws.writable = true;ws.write = function(data) &#123; serialPort.write(data);&#125;;ws.end = function(buf) &#123; console.log(&apos;bye&apos;);&#125;var serialPort = new SerialPort(&apos;/dev/&apos; + modem);process.stdin.pipe(ws); è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š ç”µè„‘ç«¯å‘é€ç¨‹åºè¿è¡ŒåŽï¼ˆ$ node write_port.jsï¼‰ï¼Œæ‰“å¼€ Arduino IDE çš„ Serial Monitorã€‚åœ¨å‘½ä»¤è¡Œè¾“å…¥ä»»ä½•ä¸€ä¸ªæ•°å­—å¹¶æŒ‰å›žè½¦è¿›è¡Œç¡®è®¤ï¼ŒArduino æ¿å­æŽ¥æ”¶åˆ°è¯¥æ•°å­—åŽï¼Œåˆå°†å…¶æ‰“å°åˆ°ä¸²å£è¾“å‡ºï¼ˆå³ Serial Monitor ä¸­æ˜¾ç¤ºçš„å†…å®¹ï¼‰ å‚è€ƒèµ„æ–™Node.js for Embedded Systems: Using Web Technologies to Build Connected Devices 1st EditionNode SerialPort]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
        <tag>Maker</tag>
        <tag>JavaScript</tag>
        <tag>Programming</tag>
        <tag>Arduino</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shell è„šæœ¬ç¼–ç¨‹ï¼ˆé«˜çº§ç¯‡ï¼‰]]></title>
    <url>%2F2018%2F12%2F03%2Fshell-script-programming-professional%2F</url>
    <content type="text"><![CDATA[é«˜çº§ç¯‡ä¸€ã€å¤„ç†ç”¨æˆ·è¾“å…¥1. è¯»å–è„šæœ¬å‚æ•°Bash Shell å°†å‘½ä»¤è¡Œä¸­ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°èµ‹å€¼ç»™ä¸€ç»„ç‰¹æ®Šçš„å˜é‡ï¼Œå«åšä½ç½®å˜é‡ï¼ˆpositional parametersï¼‰ã€‚ä½ç½®å˜é‡ç”¨ $number çš„å½¢å¼è¡¨ç¤ºã€‚å¦‚ $0 è¡¨ç¤ºè„šæœ¬æ–‡ä»¶çš„åç§°ï¼Œ$1 è¡¨ç¤ºè„šæœ¬æ”¶åˆ°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ$2 è¡¨ç¤ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œç›´åˆ° $9 è¡¨ç¤ºç¬¬ä¹ä¸ªå‚æ•°ã€‚ä»Žç¬¬åä¸ªå‚æ•°èµ·ï¼Œä½¿ç”¨ ${number} çš„å½¢å¼ã€‚å³ç¬¬åä¸ªå‚æ•°è¡¨ç¤ºä¸º ${10}ã€‚ ç¤ºä¾‹ç¨‹åºï¼š1234567891011$ cat add.sh#!/bin/bashtotal=$[ $1 + $2 ]echo &quot;The first parameter is $1&quot;echo &quot;The second parameter is $2&quot;echo &quot;The total value is $total&quot;$ ./add.sh 2 5The first parameter is 2The second parameter is 5The total value is 7 2. å‚æ•°æ£€æŸ¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°æ—¶ï¼Œä¸€èˆ¬éœ€è¦å…ˆå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ£€æŸ¥ã€‚å¦‚è„šæœ¬æ‰§è¡Œæ—¶æ²¡æœ‰æŽ¥æ”¶åˆ°é¢„æƒ³çš„å‚æ•°ï¼Œå¾€å¾€ä¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ¥å‡ºé”™è¯¯ã€‚å¦‚ï¼š12345$ ./add.sh 2./add.sh: line 3: 2 + : syntax error: operand expected (error token is &quot; &quot;)The first parameter is 2The second parameter isThe total value is æ‰€ä»¥å‚æ•°æ£€æŸ¥æ˜¯å†™è„šæœ¬æ—¶å¾ˆæœ‰å¿…è¦çš„æ­¥éª¤ï¼š12345678910111213$ cat check_parameter.sh#!/bin/bashif [ -n &quot;$1&quot; ]then echo Hello $1, glad to meet you.else echo &quot;Sorry, you did not identify youself&quot;fi$ ./check_parameter.sh starkyHello starky, glad to meet you.$ ./check_parameter.shSorry, you did not identify youself 3. ç‰¹æ®Šå‚æ•°å˜é‡å‚æ•°è®¡æ•°ä¸Šé¢æœ‰æåˆ°ï¼Œåº”è¯¥åœ¨ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å‰å…ˆæ£€æŸ¥å…¶æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚å¯¹äºŽæŽ¥æ”¶å¤šä¸ªå‚æ•°çš„è„šæœ¬ï¼Œæœ‰æ—¶å€™éœ€è¦èŽ·å–å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‚æ•°æ•°é‡ã€‚Shell è„šæœ¬ä¸­çš„ $# å˜é‡ä¿å­˜äº†è¯¥è„šæœ¬æ‰§è¡Œæ—¶æŽ¥æ”¶åˆ°çš„å‚æ•°çš„æ•°é‡ã€‚å¦‚ï¼š12345678910$ cat count_parameters.sh#!/bin/bashecho There were $# parameters supplied.$ ./count_parameters.shThere were 0 parameters supplied.$ ./count_parameters.sh testThere were 1 parameters supplied.$ ./count_parameters.sh test testThere were 2 parameters supplied. é€šè¿‡ $# å˜é‡çš„ä½¿ç”¨ï¼Œå¯ä»¥å°†ä¹‹å‰çš„ add.sh è„šæœ¬ä¼˜åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼š1234567891011121314151617$ cat add2.sh#!/bin/bashif [ $# -ne 2 ]then echo Usage: add2.sh a belse total=$[ $1 + $2 ] echo The total is $totalfi$ ./add2.shUsage: add2.sh a b$ ./add2.sh 2Usage: add2.sh a b$ ./add2.sh 2 4The total is 6 èŽ·å–æ‰€æœ‰å‚æ•°æŸäº›æƒ…å†µä¸‹éœ€è¦èŽ·å–å‘½ä»¤è¡Œæä¾›çš„æ‰€æœ‰å‚æ•°ã€‚é™¤äº†é€šè¿‡ $# å˜é‡ä½¿ç”¨å¾ªçŽ¯ï¼Œè¿˜å¯ä»¥ç›´æŽ¥ä½¿ç”¨å¦å¤–ä¸¤ä¸ªç‰¹æ®Šçš„å˜é‡ã€‚ $* å’Œ $@ å˜é‡éƒ½å¯ä»¥åŒ…å«å‘½ä»¤è¡Œè¾“å…¥çš„æ‰€æœ‰å‚æ•°ã€‚å…¶ä¸­ $* å˜é‡æŽ¥æ”¶æ‰€æœ‰å‚æ•°å¹¶å°†å®ƒä»¬ä¿å­˜åœ¨ä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²ä¸­ã€‚$@ å˜é‡æŽ¥æ”¶æ‰€æœ‰å‚æ•°å¹¶å°†å®ƒä»¬ä¿å­˜åœ¨åˆ†å¼€çš„å­—ç¬¦ä¸²ä¸­ã€‚å³ $* å˜é‡å°†æ”¶åˆ°çš„æ‰€æœ‰å‚æ•°ä½œä¸ºæ•´ä½“çš„ä¸€ä¸ªå‚æ•°å¯¹å¾…ï¼Œè€Œ $@ å˜é‡å°†æ”¶åˆ°çš„æ‰€æœ‰å‚æ•°ä½œä¸ºä¸åŒçš„å¤šä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ for å‘½ä»¤è¿›è¡ŒéåŽ†ã€‚ è¿™ä¸¤ä¸ªå˜é‡çš„åŒºåˆ«å¯ä»¥é€šè¿‡ä»¥ä¸‹è„šæœ¬æ¥åŒºåˆ†ï¼š123456789101112131415161718192021222324$ cat iterate_parameters.sh#!/bin/bashcount=1for param in &quot;$*&quot;do echo &quot;\$* Parameter $count = $param&quot; count=$[ $count + 1 ]doneechocount=1for param in &quot;$@&quot;do echo &quot;\$@ Parameter $count = $param&quot; count=$[ count + 1 ]done$ ./iterate_parameters.sh rich barbara katie jessica$* Parameter 1 = rich barbara katie jessica$@ Parameter 1 = rich$@ Parameter 2 = barbara$@ Parameter 3 = katie$@ Parameter 4 = jessica 4. shift å‘½ä»¤shift å‘½ä»¤å¯ä»¥ç”¨æ¥æ“ä½œå‘½ä»¤è¡Œå‚æ•°ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ•´ä½“çš„ç§»ä½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œshift å‘½ä»¤ä¼šå°†æ‰€æœ‰çš„å‘½ä»¤è¡Œå‚æ•°æ•´ä½“çš„å‘å·¦ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚å³ $3 å˜é‡çš„å€¼ç§»åŠ¨åˆ° $2ï¼Œ$2 å˜é‡çš„å€¼ç§»åŠ¨åˆ° $1ã€‚å¦‚ï¼š123456789$ cat shift.sh#!/bin/bashecho &quot;The original parameters: $*&quot;shift 2echo &quot;Here&apos;s the new parameters: $*&quot;$ ./shift.sh 1 2 3 4 5The original parameters: 1 2 3 4 5Here&apos;s the new parameters: 3 4 5 äºŒã€å‡½æ•°1. å‡½æ•°å®šä¹‰Bash Shell è„šæœ¬ä¸­çš„å‡½æ•°å¯ä»¥ç”¨ä»¥ä¸‹ä¸¤ç§æ ¼å¼å®šä¹‰ï¼š123function name &#123; commands&#125; æˆ–123name() &#123; commands&#125; å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526$ cat func1.sh#!/bin/bashfunction func1 &#123; echo &quot;This is an example of a function&quot;&#125;count=1while [ $count -le 5 ]do func1 count=$[ $count + 1 ]doneecho &quot;This is the end of the loop&quot;func1echo &quot;Now this is the end of the script&quot;$ ./func1.shThis is an example of a functionThis is an example of a functionThis is an example of a functionThis is an example of a functionThis is an example of a functionThis is the end of the loopThis is an example of a functionNow this is the end of the script 2. å‡½æ•°è¿”å›žå€¼é€€å‡ºçŠ¶æ€é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŸä¸ªå‡½æ•°çš„å®ŒæˆçŠ¶æ€ï¼ˆå³é€€å‡ºç ï¼‰å³æ˜¯è¯¥å‡½æ•°ä¸­æœ€åŽä¸€æ¡å‘½ä»¤çš„é€€å‡ºç ã€‚åœ¨è¯¥å‡½æ•°æ‰§è¡ŒåŽï¼Œå¯ä»¥ä½¿ç”¨ $? å˜é‡èŽ·å–å…¶é€€å‡ºçŠ¶æ€ç ã€‚12345678910111213141516$ cat exit_status.sh#!/bin/bashfunc1() &#123; echo &quot;trying to display a non-existent file&quot; ls -l badfile&#125;echo &quot;testing the function: &quot;func1echo &quot;The exit status is: $?&quot;$ ./exit_status.shtesting the function:trying to display a non-existent filels: badfile: No such file or directoryThe exit status is: 1 å› ä¸ºå‡½æ•° func1 ä¸­çš„æœ€åŽä¸€æ¡å‘½ä»¤ ls -l badfile æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼Œæ‰€ä»¥å‡½æ•°æ‰§è¡Œå®ŒåŽï¼Œå˜é‡ $? çš„å€¼ä¸º 1 è€Œä¸æ˜¯ 0 return å‘½ä»¤Bash Shell å¯ä»¥ä½¿ç”¨ return å‘½ä»¤æŒ‡å®šå‡½æ•°é€€å‡ºæ—¶çš„çŠ¶æ€å€¼ï¼ˆæ•´æ•°ï¼‰ã€‚123456789101112131415$ cat return.sh#!/bin/bashfunction db1 &#123; read -p &quot;Enter a value: &quot; value echo &quot;doubling the value&quot; return $[ $value *2 ]&#125;db1echo &quot;The new value is $?&quot;$ ./return.shEnter a value: 32doubling the valueThe new value is 64 PS: æ³¨æ„å‡½æ•°æ‰§è¡Œç»“æŸåŽéœ€è¦ç«‹å³ä½¿ç”¨ $? èŽ·å–å…¶è¿”å›žå€¼ï¼Œå‰é¢ä¸èƒ½éš”æœ‰å…¶ä»–å‘½ä»¤ï¼›ä½¿ç”¨ return æŒ‡å®šçš„é€€å‡ºç å¿…é¡»ä»‹äºŽ 0 åˆ° 255 ä¹‹é—´ 3. å‡½æ•°è¾“å‡ºå°±åƒå¯ä»¥æŠŠå‘½ä»¤çš„è¾“å‡ºå†…å®¹èµ‹å€¼ç»™ Shell å˜é‡ä¸€æ ·ï¼Œå‡½æ•°çš„è¾“å‡ºåŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡ variable=$(function_name) çš„å½¢å¼èµ‹å€¼ç»™æŸä¸ªå˜é‡ã€‚12345678910111213$ cat func2.sh#!/bin/bashfunction db1 &#123; read -p &quot;Enter a value: &quot; value echo $[ $value * 2 ]&#125;result=$(db1)echo &quot;The new value is $result&quot;$ ./func2.shEnter a value: 32The new value is 64 4. å‡½æ•°ä¸­çš„å˜é‡å‘å‡½æ•°ä¼ é€’å‚æ•°Bash Shell å¯¹å¾…å‡½æ•°å°±åƒå¯¹å¾…æ™®é€šçš„è„šæœ¬æ–‡ä»¶ä¸€æ ·ã€‚æˆ‘ä»¬å¯ä»¥å‘è„šæœ¬ç¨‹åºä¼ é€’å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä»¥ç±»ä¼¼çš„æ–¹å¼å‘å‡½æ•°ä¼ é€’å‚æ•°ã€‚ å‡½æ•°å¯ä»¥ä½¿ç”¨æ ‡å‡†å‚æ•°ï¼ˆå¦‚ $#ï¼‰çŽ¯å¢ƒå˜é‡ä»£è¡¨å®ƒä»Žå‘½ä»¤è¯­å¥é‡ŒæŽ¥æ”¶åˆ°çš„å‚æ•°ã€‚å¦‚å‡½æ•°æœ¬èº«çš„åç§°ç”± $0 å®šä¹‰ï¼Œ$1 ä»£è¡¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ$# ä»£è¡¨æŽ¥æ”¶åˆ°çš„å‚æ•°çš„æ•°ç›®ï¼Œ$* è¡¨ç¤ºå‡½æ•°æŽ¥æ”¶åˆ°çš„æ‰€æœ‰å‚æ•° ($1 $2 ...) ï¼Œ&quot;$@&quot; è¡¨ç¤ºå‡½æ•°æŽ¥æ”¶åˆ°çš„æ‰€æœ‰å‚æ•°ï¼Œä¸”æ¯ä¸€ä¸ªå‚æ•°éƒ½è¢«åŒå¼•å·åŒ…è£¹ (&quot;$1&quot; &quot;$2&quot; ...) 123456789101112131415161718192021222324252627282930313233343536$ cat parameter.sh#!/bin/bashfunction addem &#123; if [ $# -eq 0 ] || [ $# -gt 2 ] then echo -1 elif [ $# -eq 1 ] then echo $[ $1 + $1 ] else echo $[ $1 + $2 ] fi&#125;echo &quot;Adding 10 and 15:&quot;value=$(addem 10 15)echo $valueecho &quot;Try adding just one number:&quot;value=$(addem 10)echo $valueecho &quot;Now trying adding no numbers:&quot;value=$(addem)echo $valueecho &quot;Finally, try adding three numbers:&quot;value=$(addem 10 15 20)echo $value$ ./parameter.shAdding 10 and 15:25Try adding just one number:20Now trying adding no numbers:-1Finally, try adding three numbers:-1 ä¸Šè¿°è„šæœ¬ä¸­çš„ addem å‡½æ•°é€šè¿‡ $# å˜é‡æ£€æŸ¥ä¼ é€’ç»™å®ƒçš„å‚æ•°çš„æ•°é‡ï¼š å¦‚æžœå‚æ•°æ•°é‡ç­‰äºŽ 0 æˆ–å¤§äºŽ 2ï¼ˆ[ $# -eq 0 ] || [ $# -gt 2 ]ï¼‰ï¼Œåˆ™è¿”å›ž -1 è¡¨ç¤ºç¨‹åºéžæ­£å¸¸é€€å‡ºã€‚ å¦‚æžœå‚æ•°æ•°é‡ç­‰äºŽ 1ï¼ˆ[ $# -eq 1 ]ï¼‰ï¼Œåˆ™è¿”å›žä¸¤å€äºŽè¯¥å‚æ•°çš„å€¼ï¼ˆ$[ $1 + $1 ]ï¼‰ã€‚ å¦‚æžœå‚æ•°æ•°é‡ç­‰äºŽ 2ï¼ˆ[ $# -eq 2 ]ï¼‰ï¼Œåˆ™è¿”å›žè¿™ä¸¤ä¸ªå‚æ•°çš„åŠ å’Œï¼ˆ$[ $1 + $2 ]ï¼‰ å…¨å±€å˜é‡ä¸Žå±€éƒ¨å˜é‡å˜é‡çš„ä½œç”¨åŸŸæ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“å¼•èµ·é—®é¢˜çš„ç‚¹ã€‚å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡å¯ä»¥æ‹¥æœ‰åŒºåˆ«äºŽæ™®é€šå˜é‡çš„ä½œç”¨åŸŸï¼Œå³å®ƒä»¬å¯ä»¥å¯¹è„šæœ¬ä¸­çš„å…¶ä»–éƒ¨åˆ†â€œä¸å¯è§â€ã€‚ å‡½æ•°ä½¿ç”¨ä¸¤ç§ç±»åž‹çš„å˜é‡ï¼š å…¨å±€å˜é‡ å±€éƒ¨å˜é‡ å…¨å±€å˜é‡æ˜¯åœ¨æ•´ä¸ªè„šæœ¬ä¸­éƒ½ä¿æŒæœ‰æ•ˆçš„å˜é‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒShell è„šæœ¬ä¸­çš„ä»»ä½•å˜é‡éƒ½æ˜¯å…¨å±€å˜é‡ã€‚12345678910111213$ cat global.sh#!/bin/bashfunction db1 &#123; value=$[ $value * 2 ]&#125;read -p &quot;Enter a value: &quot; valuedb1echo &quot;The new value is: $value&quot;$ ./global.shEnter a value: 24The new value is: 48 åŒºåˆ«äºŽå‡½æ•°ä¸­çš„å…¨å±€å˜é‡ï¼Œä»»ä½•åªåœ¨å‡½æ•°å†…éƒ¨ç”Ÿæ•ˆçš„å˜é‡å¯ä»¥å£°æ˜Žä¸ºå±€éƒ¨å˜é‡ï¼Œåªéœ€è¦åœ¨å˜é‡çš„å£°æ˜Žå‰é¢åŠ ä¸Š local å…³é”®å­—å³å¯ã€‚ 1234567891011121314151617$ cat local.sh#!/bin/bashfunction func1 &#123; local temp=$[ $value + 5 ] result=$[ $temp * 2 ]&#125;temp=4value=6func1echo &quot;The result is $result&quot;echo &quot;The temp value is $temp&quot;$ ./local.shThe result is 22The temp value is 4 ç”±äºŽä½¿ç”¨äº† local å…³å¥å­—æŒ‡å®šå‡½æ•°å†…éƒ¨çš„ $temp å˜é‡ä¸ºå±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥å‡½æ•° func1 ä¸­ $temp å˜é‡å€¼çš„å˜åŒ–ï¼ˆå˜ä¸º 11ï¼‰å¹¶ä¸å½±å“å‡½æ•°å¤–éƒ¨ $temp å˜é‡çš„å€¼ï¼ˆä»ä¸º 4ï¼‰ã€‚ 5. å‡½æ•°é€’å½’è¿™é‡Œç”¨ä¸€ä¸ªè®¡ç®—é˜¶ä¹˜çš„ç¤ºä¾‹ç®€å•è¯´æ˜Žä¸‹ Shell è„šæœ¬ä¸­çš„å‡½æ•°é€’å½’ã€‚1234567891011121314151617181920$ cat factorial.sh#!/bin/bashfunction factorial &#123; if [ $1 -eq 1 ] then echo 1 else local temp=$[ $1 - 1 ] local result=$(factorial $temp) echo $[ $result * $1 ] fi&#125;read -p &quot;Enter value: &quot; valueresult=$(factorial $value)echo &quot;The factorial of $value is: $result&quot;$ ./factorial.shEnter value: 4The factorial of 4 is: 24 6. åº“å‡½æ•°çš„ä½¿ç”¨å¯ä»¥å‡å°‘è„šæœ¬ä¸­çš„é‡å¤ä»£ç ã€‚å³å¯ä»¥åœ¨è„šæœ¬çš„å…¶ä»–éƒ¨åˆ†ç›´æŽ¥ä½¿ç”¨å‡½æ•°åè°ƒç”¨å‡½æ•°ï¼Œå®Œæˆè¯¥å‡½æ•°å®šä¹‰çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€å†é‡æ–°è¾“å…¥ä¸€éå®šä¹‰è¯¥å‡½æ•°çš„å¤§æ®µè¯­å¥ã€‚ è¿™ç§å½¢å¼çš„ä»£ç å¤ç”¨å¯ä»¥æ‰©å±•åˆ°å¤šä¸ªè„šæœ¬æ–‡ä»¶ã€‚Bash Shell å…è®¸ç”¨æˆ·åˆ›å»ºåº“æ–‡ä»¶ï¼Œå…¶ä»– Shell è„šæœ¬å¯ä»¥é€šè¿‡å¼•ç”¨è¯¥åº“æ–‡ä»¶ä½¿ç”¨å…¶ä¸­å®šä¹‰çš„å‡½æ•°ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334$ cat myfuncsfunction addem &#123; echo $[ $1 + $2 ]&#125;function multem &#123; echo $[ $1 * $2 ]&#125;function divem &#123; if [ $2 -ne 0 ] then echo $[ $1 / $2 ] else echo -1 fi&#125;$ cat use_myfuncs.sh. ./myfuncsvalue1=10value2=5result1=$(addem $value1 $value2)result2=$(multem $value1 $value2)result3=$(divem $value1 $value2)echo &quot;The result of adding them is: $result1&quot;echo &quot;The result of multiplying them is: $result2&quot;echo &quot;The result of dividing them is: $result3&quot;$ ./use_myfuncs.shThe result of adding them is: 15The result of multiplying them is: 50The result of dividing them is: 2 å…¶ä¸­ myfuncs åº“æ–‡ä»¶ä¸­åˆ†åˆ«å®šä¹‰äº† addem multem divem ä¸‰ä¸ªå‡½æ•°ï¼Œuse_myfuncs.sh è„šæœ¬ç”¨æ¥å¼•ç”¨ myfuncs åº“å¹¶ä½¿ç”¨å…¶ä¸­å®šä¹‰çš„å‡½æ•°ï¼ˆè¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½éœ€è¦æœ‰æ‰§è¡Œæƒé™ï¼‰ã€‚ é‡ç‚¹åœ¨äºŽ use_myfuncs.sh è„šæœ¬ä¸­çš„ç¬¬ä¸€è¡Œå‘½ä»¤ . ./myfuncsã€‚å…¶ä¸­ç¬¬ä¸€ä¸ª . æ˜¯ source å‘½ä»¤çš„ç¼©å†™ã€‚source å‘½ä»¤çš„ä½œç”¨æ˜¯åœ¨å½“å‰è¯­å¢ƒä¸‹è°ƒç”¨å¦ä¸€ä¸ªè„šæœ¬ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ Shell ä¼šè¯ã€‚è¿™æ · myfuncs ä¸­çš„å‡½æ•°å°±å¯ä»¥ç›´æŽ¥è¢« use_myfuncs.sh è„šæœ¬ä½¿ç”¨ã€‚ å‚è€ƒèµ„æ–™Linux Command Line and Shell Scripting Bible 3rd Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Shell</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shell è„šæœ¬ç¼–ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰]]></title>
    <url>%2F2018%2F11%2F15%2Fshell-script-programming-basic%2F</url>
    <content type="text"><![CDATA[åŸºç¡€ç¯‡ä¸€ã€è¾“å‡ºä¿¡æ¯å¤§éƒ¨åˆ† Shell å‘½ä»¤éƒ½ä¼šç”Ÿæˆè‡ªå·±çš„è¾“å‡ºä¿¡æ¯ï¼Œåœ¨è„šæœ¬è¿è¡Œæ—¶æ‰“å°åˆ°ç»ˆç«¯å±å¹•ä¸Šã€‚ä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œä»éœ€è¦åœ¨è¾“å‡ºçš„ä¿¡æ¯ä¸­æ·»åŠ ä¸Šè‡ªå·±çš„å†…å®¹ï¼Œä»¥æç¤ºç”¨æˆ·è„šæœ¬è¿è¡Œæ—¶ç©¶ç«Ÿå‘ç”Ÿç€ä»€ä¹ˆï¼Œè¾¾åˆ°æ›´å¥½çš„äº¤äº’æ•ˆæžœã€‚ echo å‘½ä»¤å¯ä»¥ç”¨æ¥æ‰“å°å­—ç¬¦ä¸²å†…å®¹ã€‚123$ echo This is a testThis is a test$ PSï¼šé»˜è®¤æ˜¯ä¸éœ€è¦å°† echo å‘½ä»¤åŽé¢çš„å­—ç¬¦ä¸²åŒ…å«åœ¨ä¸€å¯¹å¼•å·ä¸­çš„ echo å¯ä»¥ä½¿ç”¨å¼•å·ä½œä¸ºæ–‡æœ¬å­—ç¬¦ä¸²çš„åˆ†éš”ç¬¦ã€‚å¦‚ï¼š1234$ echo &apos;Hello&gt; World&apos;HelloWorld å½“è¾“å‡ºçš„æ–‡æœ¬å†…å®¹ä¸­æœ¬æ¥å°±æœ‰å¼•å·å‡ºçŽ°æ—¶ï¼Œå¦‚ï¼ˆLet&#39;s see if this&#39;ll workï¼‰ï¼Œå¯ä»¥ç»“åˆå•ã€åŒå¼•å·çš„ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨è½¬ä¹‰ç¬¦ï¼ˆ\ï¼‰å‰ç¼€123456789# å¼•å·ä½œä¸ºå­—ç¬¦ä¸²åˆ†éš”ç¬¦è€Œä¸æ˜¯æ–‡æœ¬å†…å®¹$ echo Let&apos;s see if this&apos;ll workLets see if thisll work# ä½¿ç”¨ \ å‰ç¼€è¿›è¡Œè½¬ä¹‰$ echo Let\&apos;s see if this\&apos;ll workLet&apos;s see if this&apos;ll work# ä½¿ç”¨åŒå¼•å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå•å¼•å·ä½œä¸ºä¸­é—´çš„æ–‡æœ¬æ­£å¸¸è¾“å‡º$ echo &quot;Let&apos;s see if this&apos;ll work&quot;Let&apos;s see if this&apos;ll work è„šæœ¬çš„æ‰§è¡Œæƒé™é»˜è®¤åˆ›å»ºçš„è„šæœ¬æ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œä¸èƒ½ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œã€‚å¦‚åˆ›å»ºåŒ…å«ä»¥ä¸‹å†…å®¹çš„è„šæœ¬æ–‡ä»¶ info.sh ï¼š123456#!/bin/bashecho The time and date are:dateecho &quot;Let&apos;s see who&apos;s logged into the system:&quot;who ç›´æŽ¥æ‰§è¡Œä¸Šè¿°è„šæœ¬æ—¶ä¼šæç¤º permission denied é”™è¯¯ï¼š12$ ./info.shzsh: permission denied: ./info.sh éœ€è¦ä½¿ç”¨ chomd +x filename å‘½ä»¤ä¸ºè¯¥è„šæœ¬æ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™åŽå†è¿è¡Œï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678$ chmod +x info.sh$ ./info.shThe time and date are:Wed Oct 31 11:48:07 CST 2018Let&apos;s see who&apos;s logged into the system:starky console Oct 28 12:42starky ttys000 Oct 29 16:52starky ttys001 Oct 31 11:23 äºŒã€å˜é‡1. ç³»ç»ŸçŽ¯å¢ƒå˜é‡åœ¨ Shell è„šæœ¬ä¸­å¯ä»¥ç›´æŽ¥è®¿é—®ç³»ç»Ÿä¸­çš„çŽ¯å¢ƒå˜é‡ï¼Œä»¥èŽ·å–ç›¸å…³çš„ç³»ç»Ÿä¿¡æ¯ï¼ˆå¦‚è®¡ç®—æœºåç§°ï¼Œå½“å‰ç™»å½•ç”¨æˆ·çš„è´¦æˆ·åã€ UID å’Œä¸»ç›®å½•ç­‰ï¼‰ã€‚å½“å‰å®šä¹‰çš„æ‰€æœ‰çŽ¯å¢ƒå˜é‡å¯ä»¥é€šè¿‡ set å‘½ä»¤èŽ·å–ã€‚12345678910$ set...HISTCMD=2217HISTFILE=/Users/starky/.zsh_historyHISTSIZE=50000HOME=/Users/starkyHOST=skitars-MacBook-Pro.localIFS=$&apos; \t\n\C-@&apos;ITERM_PROFILE=starky... å½“éœ€è¦åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å…·ä½“æŸä¸ªçŽ¯å¢ƒå˜é‡çš„å€¼æ—¶ï¼Œå¯ä»¥ç”¨çŽ¯å¢ƒå˜é‡åç§°åŠ ä¸Š $ å‰ç¼€è¡¨ç¤ºï¼ˆå¦‚ $HOSTï¼‰ã€‚ç¼–è¾‘å¦‚ä¸‹ sys_info.sh æ–‡ä»¶ï¼š12345#!/bin/bashecho User info for userid: $USERecho UID: $UIDecho HOME: $HOME è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345$ chmod +x sys_info.sh$ ./sys_info.shUser info for userid: starkyUID: 501HOME: /Users/starky PSï¼šç”±äºŽåœ¨ Shell è„šæœ¬ä¸­ï¼Œ$ ä½œä¸ºå˜é‡çš„å‰ç¼€ç¬¦ï¼Œæ‰€ä»¥å½“éœ€è¦åœ¨æ–‡æœ¬è¾“å‡ºä¸­æ˜¾ç¤º $ æ—¶ï¼Œåº”ä½¿ç”¨è½¬ä¹‰ã€‚123456# $15 è¢«å½“æˆäº†ä»£å…¥åˆ°å­—ç¬¦ä¸²ä¸­çš„â€œå˜é‡â€$ echo &quot;The cost of the item is $15&quot;The cost of the item is# ä½¿ç”¨ \ è½¬ä¹‰åŽæ­£å¸¸æ‰“å° $ å­—ç¬¦$ echo &quot;The cost of the item is \$15&quot;The cost of the item is $15 2. ç”¨æˆ·è‡ªå®šä¹‰å˜é‡Shell è„šæœ¬å…è®¸ç”¨æˆ·è‡ªè¡Œå®šä¹‰å’Œä½¿ç”¨å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥å°†è„šæœ¬ä¸­ç”¨åˆ°çš„æ•°æ®ä¸´æ—¶å­˜å‚¨åœ¨æŒ‡å®šçš„å˜é‡ä¸­ï¼Œä½¿ç”¨æ—¶å†é€šè¿‡ $å˜é‡å çš„å½¢å¼èŽ·å–ã€‚ å˜é‡èµ‹å€¼ï¼švar=value ï¼ˆæ³¨æ„ = å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå³ var = value æ˜¯é”™è¯¯çš„ï¼‰ å˜é‡ä½¿ç”¨ï¼š$var PSï¼šShell è„šæœ¬ä¸­çš„å˜é‡ååŒºåˆ†å¤§å°å†™Shell è„šæœ¬ä¼šè‡ªåŠ¨åˆ¤æ–­å˜é‡å€¼çš„æ•°æ®ç±»åž‹å˜é‡çš„æœ‰æ•ˆæ€§è´¯ç©¿è„šæœ¬çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå³è„šæœ¬æ‰§è¡Œå®Œæ¯•åŽå˜é‡ä¼šè‡ªè¡Œåˆ é™¤ ç¼–è¾‘å¦‚ä¸‹ variables.sh æ–‡ä»¶ï¼š123456789#!/bin/bashdays=10guest=&quot;Katie&quot;echo &quot;$guest checked in $days days ago&quot;days=5guest=&quot;Jessica&quot;echo &quot;$guest checked in $days days ago&quot; è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345$ chmod +x variables.sh$ ./variables.shKatie checked in 10 days agoJessica checked in 5 days ago$ echo $days å¯ä»¥çœ‹åˆ°ï¼Œè„šæœ¬é€€å‡ºåŽï¼Œè„šæœ¬ä¸­å®šä¹‰çš„ $days å˜é‡åˆæ¢å¤ä¸ºæœªå®šä¹‰çš„çŠ¶æ€ã€‚ ä¸‰ã€å‘½ä»¤æ›¿æ¢Shell è„šæœ¬æœ€æœ‰ç”¨å¤„çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå°±æ˜¯å®ƒå¯ä»¥æå–æŸä¸ªå‘½ä»¤çš„è¾“å‡ºä¿¡æ¯ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å°†å‘½ä»¤è¾“å‡ºèµ‹å€¼ç»™å˜é‡ï¼š åå•å¼•å·ï¼ˆ`ï¼‰ $() æ ¼å¼ å¦‚ï¼š1234567891011# ä½¿ç”¨ date å‘½ä»¤èŽ·å–å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´$ dateThu Nov 1 01:03:02 CST 2018# å°† date å‘½ä»¤çš„è¾“å‡ºï¼ˆå³å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼‰èµ‹å€¼ç»™ var1 å˜é‡$ var1=`date`$ echo Today is: $var1Today is: Thu Nov 1 01:03:15 CST 2018# å°† date å‘½ä»¤çš„è¾“å‡ºèµ‹å€¼ç»™ var2 å˜é‡ï¼ˆä½¿ç”¨ $() æ ¼å¼ï¼‰$ var2=$(date)$ echo Today is: $var2Today is: Thu Nov 1 01:03:36 CST 2018 ç¤ºä¾‹ç¨‹åºï¼šä½¿ç”¨å‘½ä»¤æ›¿æ¢å®Œæˆä¸€ä¸ªè„šæœ¬ï¼ˆlog.shï¼‰ï¼Œè¯¥è„šæœ¬å¯ä»¥åˆ›å»ºä»¥å½“å‰æ—¶é—´æ°´å°ä¸ºåŽç¼€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹ä¸º /usr/bin ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ã€‚12345#!/bin/bashtoday=$(date +%y%m%d%H%M%S)ls -al /usr/bin &gt; log.$todayecho The file log.$today has been created, you can check it later. å…¶ä¸­ date +%y%m%d%H%M%S å‘½ä»¤å¯ä»¥è¾“å‡ºçº¯æ•°å­—æ ¼å¼çš„æ—¥æœŸå’Œæ—¶é—´è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516$ chmod +x log.sh$ ./log.shThe file log.181101012159 has been created, you can check it later.$ ls log*log.181101012159 log.sh$ head log.181101012159total 103992drwxr-xr-x 971 root wheel 31072 Oct 13 17:44 .drwxr-xr-x@ 9 root wheel 288 Sep 21 12:01 ..-rwxr-xr-x 4 root wheel 925 Aug 18 08:45 2to3-lrwxr-xr-x 1 root wheel 74 Oct 13 17:44 2to3-2.7 -&gt; ../../System/Library/Frameworks/Python.framework/Versions/2.7/bin/2to3-2.7-rwxr-xr-x 1 root wheel 55072 Sep 21 12:16 AssetCacheLocatorUtil-rwxr-xr-x 1 root wheel 53472 Sep 21 12:16 AssetCacheManagerUtil-rwxr-xr-x 1 root wheel 48256 Sep 21 12:17 AssetCacheTetheratorUtil-rwxr-xr-x 1 root wheel 18320 Sep 21 12:17 BuildStrings-rwxr-xr-x 1 root wheel 18288 Sep 21 12:17 CpMac å››ã€é‡å®šå‘è¾“å…¥å’Œè¾“å‡º1. è¾“å‡ºé‡å®šå‘æœ€åŸºæœ¬çš„é‡å®šå‘ï¼Œå°±æ˜¯é€šè¿‡å¤§äºŽå·ï¼ˆ&gt;ï¼‰ï¼Œå°†æŸä¸ªå‘½ä»¤çš„è¾“å‡ºå†…å®¹ä¿å­˜è‡³ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ æ ¼å¼ï¼šcommand &gt; outputfile 12345$ date &gt; current_date.txt$ ls -l current_date.txt-rw-r--r-- 1 starky staff 29 Nov 1 01:29 current_date.txt$ cat current_date.txtThu Nov 1 01:29:45 CST 2018 PSï¼šå¦‚ä½¿ç”¨é‡å®šå‘æ—¶ï¼ŒæŒ‡å®šçš„æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™è¯¥æ–‡ä»¶çš„åŽŸå§‹å†…å®¹ä¼šè¢«æ–°å†…å®¹è¦†ç›–ã€‚å¦‚æžœåªæ˜¯æƒ³åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åŒå¤§äºŽå·ï¼ˆ&gt;&gt;ï¼‰1234$ date &gt;&gt; current_date.txt$ cat current_date.txtThu Nov 1 01:29:45 CST 2018Thu Nov 1 01:34:03 CST 2018 2. è¾“å…¥é‡å®šå‘è¾“å…¥é‡å®šå‘å’Œè¾“å‡ºé‡å®šå‘ç›¸åã€‚å³ä»Žæ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œå¹¶å°†è¯¥å†…å®¹ä¼ é€’ç»™æŸä¸ªå‘½ä»¤ã€‚ æ ¼å¼ï¼šcommand &lt; inputfile 12345678910111213141516171819202122$ ls -l /Users/starkytotal 49864drwx------@ 3 starky staff 96 Oct 13 18:00 Applicationsdrwx------+ 23 starky staff 736 Oct 31 19:14 Desktopdrwx------+ 21 starky staff 672 Oct 31 19:15 Documentsdrwx------+ 37 starky staff 1184 Oct 30 20:18 Downloadsdrwx------+ 72 starky staff 2304 Oct 27 01:38 Librarydrwx------+ 6 starky staff 192 Oct 29 10:34 Moviesdrwx------+ 3 starky staff 96 Sep 27 13:13 Music...$ cat directory.txt/Users/starky$ ls -l &lt; directory.txttotal 49864drwx------@ 3 starky staff 96 Oct 13 18:00 Applicationsdrwx------+ 23 starky staff 736 Oct 31 19:14 Desktopdrwx------+ 21 starky staff 672 Oct 31 19:15 Documentsdrwx------+ 37 starky staff 1184 Oct 30 20:18 Downloadsdrwx------+ 72 starky staff 2304 Oct 27 01:38 Librarydrwx------+ 6 starky staff 192 Oct 29 10:34 Moviesdrwx------+ 3 starky staff 96 Sep 27 13:13 Music... 3. ç®¡é“æœ‰äº›æ—¶å€™ï¼Œéœ€è¦å°†æŸä¸ªå‘½ä»¤çš„è¾“å‡ºå†…å®¹ä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚å¦‚ï¼š123456$ ls -al &gt; tmp_file$ grep vim &lt; tmp_filedrwxr-xr-x 3 starky staff 96 Oct 20 15:45 .vim-rw------- 1 starky staff 23799 Nov 1 01:40 .viminfo-rw-r--r-- 1 starky staff 3935 Oct 21 01:31 .vimrc-rw-r--r-- 1 starky staff 24849808 Oct 25 21:02 vim.tar.gz ä¸Šé¢çš„å‘½ä»¤å…ˆå°†å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆls -alï¼‰ä¿å­˜åœ¨ tmp_file ä¸­ï¼Œå†ä½¿ç”¨ grep å‘½ä»¤è¯»å– tmp_file çš„å†…å®¹ï¼Œç­›é€‰æ–‡ä»¶åä¸­åŒ…å« vim çš„æ–‡ä»¶ã€‚ å…¶å®žå¯ä»¥é€šè¿‡ç®¡é“ï¼ˆ|ï¼‰çš„ä½¿ç”¨ï¼Œå°†å‰é¢å‘½ä»¤çš„è¾“å‡ºï¼Œå®šå‘ç»™åŽé¢çš„å‘½ä»¤ä½œä¸ºè¾“å…¥ã€‚ æ ¼å¼ï¼šcommand1 | command2 12345ls -al | grep vimdrwxr-xr-x 3 starky staff 96 Oct 20 15:45 .vim-rw------- 1 starky staff 23799 Nov 1 01:40 .viminfo-rw-r--r-- 1 starky staff 3935 Oct 21 01:31 .vimrc-rw-r--r-- 1 starky staff 24849808 Oct 25 21:02 vim.tar.gz äº”ã€æ•°å­¦è¿ç®—æ“ä½œæ•°å­¦è¿ç®—å¯¹äºŽä»»ä½•ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ã€‚ä½†æ˜¯ Shell è„šæœ¬å¹¶ä¸èƒ½ç›´æŽ¥å®Œæˆç®—æœ¯è¿ç®—çš„æ“ä½œï¼Œåªèƒ½é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥å®žçŽ°ã€‚ 1. expr å‘½ä»¤Shell æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„å‘½ä»¤ï¼ˆexprï¼‰ç”¨æ¥å¤„ç†æ•°å­¦ç®—å¼ï¼Œå¦‚ï¼š12$ expr 1 + 23 PSï¼šæ³¨æ„ç®—å¼ä¸­ + å·ä¸¤è¾¹çš„ç©ºæ ¼expr å‘½ä»¤æ”¯æŒçš„ç®—æœ¯æ“ä½œç¬¦å¦‚ä¸‹ï¼š æ“ä½œç¬¦ å«ä¹‰ ARG1 åŒç®¡é“ç¬¦ ARG2 å¦‚æžœä¸¤ä¸ªå‚æ•°å€¼éƒ½ä¸ä¸º null æˆ– 0ï¼Œè¿”å›ž ARG1ï¼Œå¦åˆ™è¿”å›ž ARG2 ARG1 &amp;&amp; ARG2 å¦‚æžœä¸¤ä¸ªå‚æ•°å€¼éƒ½ä¸ä¸º null æˆ– 0ï¼Œè¿”å›ž ARG1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 &lt; ARG2 å¦‚æžœ ARG1 å°äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 &gt; ARG2 å¦‚æžœ ARG1 å¤§äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 = ARG2 å¦‚æžœ ARG1 ç­‰äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 &gt;= ARG2 å¦‚æžœ ARG1 å¤§äºŽæˆ–ç­‰äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 &lt;= ARG2 å¦‚æžœ ARG1 å°äºŽæˆ–ç­‰äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 != ARG2 å¦‚æžœ ARG1 ä¸ç­‰äºŽ ARG2ï¼Œè¿”å›ž 1ï¼Œå¦åˆ™è¿”å›ž 0 ARG1 + ARG2 è¿”å›ž ARG1 ä¸Ž ARG2 çš„æ•°å­—åŠ å’Œ ARG1 - ARG2 æ±‚ ARG1 å‡åŽ» ARG2 çš„æ•°å­—å·® ARG1 * ARG2 è¿”å›ž ARG1 ä¸Ž ARG2 çš„æ•°å­—ä¹˜ç§¯ ARG1 / ARG2 æ±‚ ARG1 é™¤ä»¥ ARG2 çš„æ•°å­—å•†ï¼ˆç»“æžœä¸ºæ•´æ•°ï¼‰ ARG1 % ARG2 å¯¹ ARG1 å’Œ ARG2 è¿›è¡Œæ±‚ä½™æ“ä½œ æ•°å­¦è¿ç®—ç¤ºä¾‹ï¼ˆdivide.shï¼‰ï¼š 1234567#!/bin/bashvar1=10var2=20var3=`expr $var2 / $var1`echo $var2 divided by $var1 equals $var3 è¿è¡Œæ•ˆæžœï¼š123$ chmod +x divide.sh$ ./divide.sh20 divided by 10 equals 2 2. ä½¿ç”¨ä¸­æ‹¬å·Bash Shell ä¸­çš„ expr å‘½ä»¤ä¸»è¦æ˜¯ä¸ºäº†ä¿æŒå’Œ Bourne Shell çš„å…¼å®¹æ€§ï¼Œå®ƒå…¶å®žè¿˜æä¾›äº†ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ç”¨æ¥å¤„ç†æ•°å­¦è¿ç®—ã€‚å³ä½¿ç”¨è¿™æ ·çš„å½¢å¼ï¼š$[ operation ] å¦‚ä¸‹é¢çš„è„šæœ¬ï¼ˆcompute.shï¼‰12345678#!/bin/bashvar1=100var2=50var3=45result=$[$var1 * ($var2 - $var3)]echo The final result is $result è¿è¡Œæ•ˆæžœï¼š123$ chmod +x compute.sh$ ./compute.shThe final result is 500 ä½†æ˜¯åœ¨è¿›è¡Œé™¤æ³•è¿ç®—æ—¶ï¼Œä¸Šé¢çš„æ–¹å¼åªæ”¯æŒæ•´æ•°ã€‚å¦‚ä¸¤ä¸ªæ•°ç›¸é™¤ç»“æžœä¸ºå°æ•°ï¼Œåˆ™è¯¥ç»“æžœä¼šèˆåŽ»å°æ•°éƒ¨åˆ†åªä¿ç•™æ•´æ•°ã€‚12345$ var1=10$ var2=3$ result=$[$var1 / $var2]$ echo The result is $resultThe result is 3 3. æµ®ç‚¹æ•°è¿ç®—æœ‰å¾ˆå¤šç§æ–¹æ¡ˆå¯ä»¥å…‹æœ bash çš„æ•´æ•°é™åˆ¶ï¼Œæœ€å¸¸ç”¨çš„ä¸€ç§å°±æ˜¯ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„ bash calculatorï¼Œå³ bc ç¨‹åºã€‚bash calculator å…¶å®žæ˜¯ä¸€ç§æ”¯æŒæµ®ç‚¹æ•°è¿ç®—çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¯ä»¥è¯†åˆ«ä»¥ä¸‹å‡ ç§ç±»åž‹çš„æ•°æ®ï¼š æ•°å­—ï¼ˆæ•´æ•°å’Œæµ®ç‚¹æ•°ï¼‰ å˜é‡ï¼ˆç®€å•å˜é‡å’Œæ•°ç»„ï¼‰ æ³¨é‡Šï¼ˆå•è¡Œæ³¨é‡Š # å’Œå¤šè¡Œæ³¨é‡Š /* */ï¼‰ è¡¨è¾¾å¼ ç¼–ç¨‹è¯­å¥ï¼ˆå¦‚ if-then è¯­å¥ï¼‰ å‡½æ•° 12345678910$ bcbc 1.06Copyright 1991-1994, 1997, 1998, 2000 Free Software Foundation, Inc.This is free software with ABSOLUTELY NO WARRANTY.For details type `warranty&apos;.12 * 5.464.83.156 * (3 + 5)25.248quit è®¡ç®—ç»“æžœç²¾ç¡®åˆ°çš„å°æ•°ä½æ•°æ˜¯é€šè¿‡ä¸€ä¸ªå†…å»ºçš„ scale å˜é‡å®šä¹‰çš„ï¼Œé»˜è®¤çš„ scale æ•°å€¼ä¸º 0ï¼ˆå³é»˜è®¤èˆåŽ»å•†çš„å°æ•°ä½æ•°ï¼‰ï¼š1234567$ bc -q3.44 / 50scale=43.44 / 5.6880quit bc ç¨‹åºä¹Ÿæ”¯æŒè‡ªå®šä¹‰å˜é‡ï¼š12345678$ bc -qvar1=10var1 * 440var2=var1 / 5print var22quit 4. åœ¨è„šæœ¬ä¸­ä½¿ç”¨ bcå¯ä»¥é€šè¿‡ç®¡é“å°†æ•°å­¦è¡¨è¾¾å¼ä¼ é€’ç»™ bc ç¨‹åºï¼Œå†å°†è®¡ç®—å¾—å‡ºçš„ç»“æžœé€šè¿‡èµ‹å€¼è¯­å¥èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼švariable=$(echo &quot;options; expression&quot; | bc) å…¶ä¸­ variable=$(...) ç”¨äºŽæå–å‘½ä»¤çš„è¾“å‡ºå¹¶èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼ˆå‚è€ƒç¬¬ä¸‰ç« å‘½ä»¤æ›¿æ¢ï¼‰ å¦‚ä¸‹é¢çš„è„šæœ¬ï¼ˆbc1.shï¼‰:1234567#!/bin/bashvar1=100var2=45var3=$(echo &quot;scale=4; $var1 / $var2&quot; | bc)echo The answer for this is $var3 è¿è¡Œæ•ˆæžœï¼š123$ chmod +x bc1.sh$ ./bc1.shThe answer for this is 2.2222 æ›´å¤æ‚çš„å½¢å¼åœ¨è„šæœ¬ä¸­ä½¿ç”¨ bc è¿˜å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å½¢å¼ï¼š123456variable=$(bc &lt;&lt; EOFoptionsstatementsexpressionsEOF) ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼ˆbc2.shï¼‰ï¼š 12345678910111213141516#!/bin/bashvar1=10.46var2=43.67var3=33.2var4=71var5=$(bc &lt;&lt; EOFscale = 4a1=$var1 * $var2b1=$var3 * $var4a1 + b1EOF)echo The final answer for this mess is $var5 è¿è¡Œç»“æžœï¼š123$ chmod +x bc2.sh$ ./bc2.shThe final answer for this mess is 2813.9882 å‚è€ƒèµ„æ–™Linux Command Line and Shell Scripting Bible 3rd Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Shell</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shell è„šæœ¬ç¼–ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰]]></title>
    <url>%2F2018%2F11%2F15%2Fshell-script-programming-medium%2F</url>
    <content type="text"><![CDATA[ä¸­çº§ç¯‡ä¸€ã€ç»“æž„åŒ–å‘½ä»¤åœ¨åŸºç¡€ç¯‡çš„ç¤ºä¾‹ä¸­ï¼ŒShell å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä»¥é¡ºåºçš„æ–¹å¼ä¾æ¬¡æ‰§è¡Œè„šæœ¬ä¸­çš„æ¯ä¸€æ¡æŒ‡ä»¤ã€‚ä½†æ˜¯åœ¨å®žé™…æƒ…å†µä¸­ï¼Œå¾ˆå¤šç¨‹åºéƒ½éœ€è¦å¯¹è„šæœ¬ä¸­å‘½ä»¤çš„é€»è¾‘æµè¿›è¡ŒæŽ§åˆ¶ã€‚å³æ ¹æ®æŸäº›æ¡ä»¶å’ŒçŠ¶æ€å®Œæˆåˆ¤æ–­ï¼Œå†å†³å®šå…¶åŽçš„ç¨‹åºè¯¥ä»¥æ€Žæ ·çš„è§„åˆ™æ‰§è¡Œã€‚Shell è„šæœ¬æ”¯æŒä¸€éƒ¨åˆ†ç»“æž„åŒ–æŒ‡ä»¤ï¼Œå¦‚ if-thenã€case ç­‰ï¼Œç”¨äºŽä¿®æ”¹ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ 1. if-thenæœ€åŸºæœ¬çš„ç»“æž„åŒ–è¯­å¥å³ if-thenï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š1234if commandthen commandsfi Bash Shell ä¸­çš„ if-then è¯­å¥å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»ä¼¼è¯­å¥ç¨æœ‰äº›ä¸åŒï¼Œå…¶ä½œç”¨å¦‚ä¸‹ï¼š é¦–å…ˆæ‰§è¡Œ if åŽé¢è·Ÿéšçš„å‘½ä»¤ command å¦‚æžœè¯¥å‘½ä»¤ command çš„ç»“æŸçŠ¶æ€ï¼ˆexit statusï¼‰ä¸º 0ï¼ˆå³è¯¥å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼‰ï¼Œåˆ™ then åŽé¢çš„å‘½ä»¤ä¾æ¬¡è¢«æ‰§è¡Œ å¦‚æžœè¯¥å‘½ä»¤ command çš„ç»“æŸçŠ¶æ€ä¸ºä»»ä½•éž 0 çš„å€¼ï¼ˆè¯¥å‘½ä»¤éžæ­£å¸¸é€€å‡ºï¼‰ï¼Œåˆ™ä¸æ‰§è¡Œ then åŽé¢çš„å‘½ä»¤ï¼ŒBash Shell ç§»åŠ¨åˆ°è„šæœ¬ä¸­çš„ä¸‹ä¸€æ¡å‘½ä»¤ï¼ˆå³ fi åŽé¢çš„å†…å®¹ï¼‰ å¦‚ä¸‹é¢çš„ä¸¤ä¸ªç¤ºä¾‹ï¼š1234567891011121314151617181920212223$ cat if1.sh#!/bin/bashif pwdthen echo &quot;It worked&quot;fiecho &quot;We are outside the if statement&quot;$ ./if1.sh/Users/starky/program/scripts/shellIt workedWe are outside the if statement$ cat if2.sh#!/bin/bashif IamNotaCommandthen echo &quot;It worked&quot;fiecho &quot;We are outside the if statement&quot;$ ./if2.sh./if2.sh: line 3: IamNotaCommand: command not foundWe are outside the if statement åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œif1.sh è„šæœ¬é‡Œ if åŽé¢çš„å‘½ä»¤ï¼ˆpwdï¼‰æˆåŠŸæ‰§è¡Œï¼Œåˆ™ then åŽé¢çš„ echo å‘½ä»¤ä¹Ÿè·Ÿç€æ‰§è¡Œã€‚è€Œ if2.sh è„šæœ¬é‡Œ if åŽé¢çš„å‘½ä»¤ï¼ˆIamNotaCommandï¼‰æ‰§è¡Œå‡ºé”™ï¼Œåˆ™ then åŽé¢çš„ echo å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œã€‚æ— è®ºå¦‚ä½•ï¼Œåˆ¤æ–­ç»“æŸåŽéƒ½ä¼šç»§ç»­æ‰§è¡Œ fi åŽé¢çš„è¯­å¥ã€‚ 2. if-else-thenif-else-then è¯­å¥çš„æ ¼å¼ä¸ºï¼š123456if commandthen commandselse commandsfi å½“ if åŽé¢çš„å‘½ä»¤æ‰§è¡ŒåŽè¿”å›žå€¼ä¸º 0 æ—¶ï¼Œåˆ™ then åŽé¢çš„å‘½ä»¤è¢«æ‰§è¡Œã€‚å¦‚æžœ if åŽé¢çš„å‘½ä»¤æ‰§è¡ŒåŽè¿”å›žå€¼ä¸ä¸º 0ï¼Œåˆ™æ‰§è¡Œ else åŽé¢çš„å‘½ä»¤ã€‚ ç¤ºä¾‹ï¼ˆif3.shï¼‰å¦‚ä¸‹ï¼š123456789101112#!/bin/bashtestuser=starkyif ls -d /Users/$testuserthen echo &quot;The bash files for user $testuser are:&quot; ls -a /Users/$testuser/.b* echoelse echo &quot;The user $testuser does not exist on this system.&quot; echofi è¿è¡Œç»“æžœï¼š1234567$ chmod +x if3.sh$ ./if3.sh/Users/starkyThe bash files for user starky are:/Users/starky/.bash_history /Users/starky/.bash_profile/Users/starky/.bash_sessions:... ä½†æ˜¯å°†ä¸Šè¿°è„šæœ¬ä¸­ testuser å˜é‡çš„å€¼æ”¹ä¸ºç³»ç»Ÿä¸­å¹¶ä¸å­˜åœ¨çš„ç”¨æˆ·æ—¶ï¼ˆå¦‚ NoSuchUserï¼‰ï¼Œåˆ™è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š12345678910111213141516$ cat if3.sh#!/bin/bashtestuser=NoSuchUserif ls -d /Users/$testuserthen echo &quot;The bash files for user $testuser are:&quot; ls -a /Users/$testuser/.b* echoelse echo &quot;The user $testuser does not exist on this system.&quot; echofi$ ./if3.shls: /Users/NoSuchUser: No such file or directoryThe user NoSuchUser does not exist on this system. å…¶ä»–ç»“æž„å½¢å¼çš„ if-else-then è¯­å¥è¿˜åŒ…æ‹¬ï¼š12345678if command1then commandselif command2then more commandsfi å½“ç„¶ç†è®ºä¸Šè®²å¯ä»¥ä½¿ç”¨è¶³å¤Ÿçš„ if-then-elif-then è¯­å¥ï¼Œåªä¸è¿‡ç±»ä¼¼æƒ…å†µä¸‹å¤šä½¿ç”¨æ›´ä¸ºæ°å½“çš„ case è¯­å¥ã€‚ 3. test å‘½ä»¤ä¸Šé¢æåˆ°çš„ if-then è¯­å¥ï¼Œå¤§å¤šæ˜¯è¿™æ ·çš„å½¢å¼ï¼š1234if commandthen commands... å³ if åŽé¢è·Ÿçš„æ˜¯ä¸€æ¡æ™®é€šçš„ Shell å‘½ä»¤ï¼Œæ ¹æ®è¯¥å‘½ä»¤æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œæ¥ç¡®å®š then åŽé¢çš„å‘½ä»¤æ˜¯å¦æ‰§è¡Œã€‚ å¯ä»¥å€ŸåŠ© test å‘½ä»¤ï¼Œä½¿ç”¨å¦‚ä¸‹å½¢å¼çš„ if-then è¯­å¥ï¼š1234if test conditionthen commandsfi å¦‚æžœ test å‘½ä»¤åŽé¢çš„ condition è®¡ç®—åŽä¸º TRUEï¼Œåˆ™ test å‘½ä»¤é€€å‡ºå¹¶è¿”å›žä¸€ä¸ªå€¼ä¸º 0 çš„çŠ¶æ€å€¼ã€‚then åŽé¢çš„å‘½ä»¤è¢«æ‰§è¡Œã€‚å¦‚æžœ test å‘½ä»¤åŽé¢çš„ condition è®¡ç®—åŽä¸º FALSEï¼Œåˆ™ test å‘½ä»¤é€€å‡ºå¹¶è¿”å›žä¸€ä¸ªéžé›¶çš„çŠ¶æ€å€¼ã€‚è·³å‡ºå½“å‰çš„ if-then å¹¶ç»§ç»­æ‰§è¡ŒåŽé¢çš„å†…å®¹ã€‚ å¦‚ä¸‹é¢çš„ä¸¤ä¸ªä¾‹å­ï¼š1234567891011121314151617181920212223242526$ cat test_condition.sh#!/bin/bashmy_variable=&quot;Full&quot;if test $my_variablethen echo &quot;The $my_variable expression returns a True&quot;else echo &quot;The $my_variable expression returns a False&quot;fi$ ./test_condition.shThe Full expression returns a True$ cat test_condition2.sh#!/bin/bashmy_variable=&quot;&quot;if test $my_variablethen echo &quot;The $my_variable expression returns a True&quot;else echo &quot;The $my_variable expression returns a False&quot;fi$ ./test_condition2.shThe expression returns a False Bash Shell è¿˜æä¾›äº†å¦å¤–ä¸€ç§ä¸éœ€è¦ä½¿ç”¨ test å‘½ä»¤æ¥å®Œæˆæ¡ä»¶æ£€æŸ¥çš„ if-then è¯­å¥ï¼š1234if [ condition ]then commandsfi æ–¹æ‹¬å·ä¸­çš„å†…å®¹ç”¨æ¥å®šä¹‰åˆ¤æ–­æ¡ä»¶ã€‚æ³¨æ„æ–¹æ‹¬å·å’Œ condition ä¹‹é—´çš„ç©ºæ ¼ã€‚æ”¯æŒä¸‰ç§å½¢å¼çš„åˆ¤æ–­æ¡ä»¶ï¼š æ•°å­—æ¯”è¾ƒ å­—ç¬¦ä¸²æ¯”è¾ƒ æ–‡ä»¶æ¯”è¾ƒ æ•°å­—æ¯”è¾ƒ æ“ä½œ æè¿° n1 -eq n2 æ£€æŸ¥ n1 æ˜¯å¦ç­‰äºŽ n2 n1 -ge n2 æ£€æŸ¥ n1 æ˜¯å¦å¤§äºŽæˆ–ç­‰äºŽ n2 n1 -gt n2 æ£€æŸ¥ n1 æ˜¯å¦å¤§äºŽ n2 n1 -le n2 æ£€æŸ¥ n1 æ˜¯å¦å°äºŽæˆ–ç­‰äºŽ n2 n1 -lt n2 æ£€æŸ¥ n1 æ˜¯å¦ å°äºŽ n2 n1 -ne n2 æ£€æŸ¥ n1 æ˜¯å¦ä¸ç­‰äºŽ n2 ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920$ cat numeric_test.sh#!/bin/bashvalue1=10value2=11if [ $value1 -gt 5 ]then echo &quot;The test value $value1 is greater than 5&quot;fiif [ $value1 -eq $value2 ]then echo &quot;The values are equal&quot;else echo &quot;The values are different&quot;fi$ ./numeric_test.shThe test value 10 is greater than 5The values are different å­—ç¬¦ä¸²æ¯”è¾ƒ æ“ä½œ æè¿° str1 = str2 æ£€æŸ¥ str1 å’Œ str2 æ˜¯å¦ç›¸åŒ str1 != str2 æ£€æŸ¥ str1 å’Œ str2 æ˜¯å¦ä¸ç›¸åŒ str1 &lt; str2 æ£€æŸ¥ str1 æ˜¯å¦å°äºŽ str2 str1 &gt; str2 æ£€æŸ¥ str1 æ˜¯å¦å¤§äºŽ str2 -n str1 æ£€æŸ¥ str1 æ˜¯å¦é•¿åº¦å¤§äºŽ 0ï¼ˆä¸ä¸ºç©ºï¼‰ -z str1 æ£€æŸ¥ str1 æ˜¯å¦é•¿åº¦ä¸º 0ï¼ˆä¸ºç©ºï¼‰ ç¤ºä¾‹1ï¼š12345678910111213$ cat welcome.sh#!/bin/bashtestuser=starkyif [ $USER = $testuser ]then echo &quot;Welcome $testuser&quot;else echo &quot;This is not $testuser&quot;fi$ ./welcome.shWelcome starky PSï¼šåœ¨ä½¿ç”¨ str1 &gt; str2 æˆ– str1 &lt; str2 è¿™ç§ç±»åž‹çš„æ¡ä»¶æ—¶ï¼Œéœ€åŠ ä¸Šè½¬ä¹‰ç¬¦å·ã€‚å¦åˆ™å¤§äºŽå·æˆ–å°äºŽå·ä¼šè¢«å½“ä½œé‡å®šå‘å¤„ç†ã€‚ ç¤ºä¾‹2ï¼š1234567891011121314$ cat compare.sh#!/bin/bashval1=Testingval2=testingif [ $val1 \&gt; $val2 ]then echo &quot;$val1 is greater than $val2&quot;else echo &quot;$val1 is less than $val2&quot;fi$ ./compare.shTesting is less than testing PSï¼šif æ¡ä»¶ä¸­çš„æ¯”è¾ƒä¾æ®çš„æ˜¯åŸºæœ¬ ASCII é¡ºåºï¼Œé€šè¿‡æ¯ä¸ªå­—ç¬¦ï¼ˆä»Žé¦–å­—æ¯å¼€å§‹ï¼‰çš„ ASCII å€¼çš„æ¯”è¾ƒæ¥åˆ¤æ–­å¤§å°é¡ºåºã€‚ -n å’Œ -z å¸¸å¸¸ç”¨æ¥ç¡®å®šæŒ‡å®šå­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºã€‚ç¤ºä¾‹3ï¼š123456789101112131415161718192021222324252627282930$ cat empty.sh#!/bin/bashval1=testingval2=&apos;&apos;if [ -n $val1 ]then echo &quot;The string &apos;$val1&apos; is not empty&quot;else echo &quot;The string &apos;$val1&apos; is empty&quot;fiif [ -z $val2 ]then echo &quot;The string &apos;$val2&apos; is empty&quot;else echo &quot;The string &apos;$val2&apos; is not empty&quot;fiif [ -z $val3 ]then echo &quot;The string &apos;$val3&apos; is empty&quot;else echo &quot;The string &apos;$val3&apos; is not empty&quot;fi$ ./empty.shThe string &apos;testing&apos; is not emptyThe string &apos;&apos; is emptyThe string &apos;&apos; is empty ä¸Šè¿°è„šæœ¬ä¸­ val3 å˜é‡è‡ªå§‹è‡³ç»ˆæ²¡æœ‰è¢«å®šä¹‰ï¼Œè¢«è‡ªåŠ¨åˆ¤æ–­ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ æ–‡ä»¶æ¯”è¾ƒ æ“ä½œ æè¿° -d file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªç›®å½• -e file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ -f file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªæ–‡ä»¶ -r file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”å¯è¯» -s file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸ºç©º -w file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”å¯å†™ -x file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”å¯æ‰§è¡Œ -O file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”å…¶å±žä¸»ä¸ºå½“å‰ç”¨æˆ· -G file æ£€æŸ¥ file æ˜¯å¦å­˜åœ¨ä¸”å…¶é»˜è®¤æ•°ç»„å’Œå½“å‰ç”¨æˆ·ç›¸åŒ file1 -nt file2 æ£€æŸ¥ file1 æ˜¯å¦æ¯” file2 æ›´æ–°ï¼ˆnewer thanï¼‰ file1 -ot file2 æ£€æŸ¥ file1 æ˜¯å¦æ¯” file2 æ›´è€ï¼ˆolder thanï¼‰ ç¤ºä¾‹1ï¼Œç›®å½•æ£€æŸ¥ï¼š1234567891011121314151617$ cat check_dir.sh#!/bin/bashdirectory=/Users/starkyif [ -d $directory ]then echo &quot;The $directory directory exists&quot; cd $directory lselse echo &quot;The $directory directory does not exist&quot;fi$ ./check_dir.shThe /Users/starky directory existsApplications Downloads Music extract.sh programDesktop Library Pictures id_rsa.pub softwareDocuments Movies Public miniconda3 vim.tar.gz ç¤ºä¾‹2ï¼Œåˆ é™¤ç©ºæ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334$ cat check_empty.sh#!/bin/bashfile_name=empty# æ£€æŸ¥è¯¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨if [ -f $file_name ]then # è¯¥æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ç»§ç»­æ£€æŸ¥å…¶å†…å®¹æ˜¯å¦éžç©º if [ -s $file_name ] then # å†…å®¹ä¸ä¸ºç©º echo &quot;The $file_name file exists and has data in it.&quot; echo &quot;Will not remove this file&quot; else # å†…å®¹ä¸ºç©º echo &quot;The $file_name file exists, but is empty.&quot; echo &quot;Deleting empty file...&quot; rm $file_name fielse # è¯¥æ–‡ä»¶ä¸å­˜åœ¨ echo &quot;File, $file_name, does not exist.&quot;fi$ ./check_empty.shFile, empty, does not exist.$ touch empty$ ls emptyempty$ ./check_empty.shThe empty file exists, but is empty.Deleting empty file...$ ls emptyls: empty: No such file or directory 4. ç»„åˆåˆ¤æ–­if-then è¯­å¥å…è®¸ä½¿ç”¨å¸ƒå°”é€»è¾‘æ¥å®Œæˆå¤šä¸ªæ¡ä»¶çš„ç»„åˆåˆ¤æ–­ã€‚ [ condition1 ] &amp;&amp; [ condition2 ] é€»è¾‘ä¸Ž [ condition1 ] || [ condition2 ] é€»è¾‘æˆ– ç¤ºä¾‹ï¼š1234567891011121314cat compound_test.sh#!/bin/bashif [ -d $HOME ] &amp;&amp; [ -w $HOME/testing ]then echo &quot;The file exists and you can write to it&quot;else echo &quot;I cannot write to the file&quot;fi$ ./compound_test.shI cannot write to the file$ touch ~/testing$ ./compound_test.shThe file exists and you can write to it if-then ä¸­çš„åŒæ‹¬å·Bash Shell åœ¨ if-then è¯­å¥ä¸­è¿˜æä¾›äº†ä¸€äº›æ›´é«˜çº§çš„ç‰¹æ€§ï¼š åŒå°æ‹¬å·ï¼ˆæ•°å­¦è¡¨è¾¾å¼ï¼‰ åŒä¸­æ‹¬å·ï¼ˆå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼‰ ä½¿ç”¨åŒå°æ‹¬å·åŒå°æ‹¬å·å…è®¸åœ¨æ¡ä»¶æµ‹è¯•æ—¶ä½¿ç”¨ï¼ˆç›¸å¯¹äºŽ test å‘½ä»¤ï¼‰æ›´é«˜çº§çš„æ•°å­¦è¡¨è¾¾å¼ã€‚æ ¼å¼ï¼š(( expression ))å…¶ä¸­ expression é™¤äº†æ”¯æŒå‰é¢æåˆ°è¿‡çš„åŸºæœ¬çš„æ•°å­¦æ“ä½œç¬¦å¤–ï¼Œè¿˜æ”¯æŒä»¥ä¸‹æ“ä½œç¬¦ï¼š æ“ä½œç¬¦ æè¿° val++ Post-increment valâ€“ Post-decrement ++val Pre-increment â€“val Pre-decrement ! é€»è¾‘éž ~ æŒ‰ä½å¦å®š ** å¹‚ &lt;&lt; å‘å·¦æŒ‰ä½ç§»ä½ &gt;&gt; å‘å³æŒ‰ä½ç§»ä½ &amp; æŒ‰ä½é€»è¾‘ä¸Ž ç®¡é“ç¬¦ æŒ‰ä½é€»è¾‘æˆ– &amp;&amp; é€»è¾‘ä¸Ž åŒç®¡é“ç¬¦ é€»è¾‘æˆ– ç¤ºä¾‹ï¼š123456789101112$ cat parenthesis.sh#!/bin/bashval1=10if (( $val1 ** 2 &gt; 90 ))then (( val2 = $val1 ** 2 )) echo &quot;The square of $val1 is $val2&quot;fi$ ./parenthesis.shThe square of 10 is 100 ä½¿ç”¨åŒä¸­æ‹¬å·åŒä¸­æ‹¬å·ä¸º test å‘½ä»¤ä¸­çš„å­—ç¬¦ä¸²æ¯”è¾ƒæä¾›äº†æ›´é«˜çº§çš„ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯æ”¯æŒ æ¨¡å¼åŒ¹é…ã€‚ç¤ºä¾‹ï¼š1234567891011cat pattern.sh#!/bin/bashif [[ $USER == s* ]]then echo &quot;Hello $USER&quot;else echo &quot;Sorry, I do not know you&quot;fi$ ./pattern.shHello starky 4. case å‘½ä»¤å¾ˆå¤šæ—¶å€™ï¼ŒæŸä¸ªä½œä¸ºåˆ¤æ–­æ¡ä»¶çš„å˜é‡æœ‰å¤šä¸ªå¯èƒ½çš„å–å€¼ï¼Œè€Œä½ éœ€è¦æ ¹æ®ä¸åŒçš„å–å€¼æŒ‡å¯¼ç¨‹åºåŽ»åšå¯¹åº”çš„æ“ä½œã€‚å¦‚æžœä½¿ç”¨ if-then-else è¯­å¥ï¼Œä»£ç å…ä¸äº†ä¼šæ‹‰å¾—æœ‰äº›é•¿ã€‚ã€‚ã€‚ ä¸åŒäºŽ if è¯­å¥ï¼ˆé€šè¿‡ ifã€elif ä¾æ¬¡æ£€æŸ¥åŒä¸€ä¸ªå˜é‡çš„æ‰€æœ‰å–å€¼ï¼‰ï¼Œcase å‘½ä»¤ä»¥ç±»ä¼¼åˆ—è¡¨çš„å½¢å¼æ£€æŸ¥åŒä¸€ä¸ªå˜é‡çš„æ‰€æœ‰å–å€¼ï¼š12345case variable in pattern1 | pattern2) commands1;; pattern3) commands2;; *) default commands;;esac case å‘½ä»¤å°†æŒ‡å®šçš„å˜é‡ä¸Žå¤šä¸ªä¸åŒçš„æ¨¡å¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æžœåŒ¹é…ï¼Œåˆ™æ‰§è¡Œè¯¥æ¨¡å¼åŽé¢çš„å‘½ä»¤ã€‚å¯ä»¥åœ¨åŒä¸€è¡Œä¸­å®šä¹‰å¤šä¸ªæ¨¡å¼ï¼ˆä½¿ç”¨ | ç¬¦å·åˆ†éš”ï¼‰ã€‚æ˜Ÿå·è¡¨ç¤ºå½“ä¹‹å‰çš„æ‰€æœ‰æ¨¡å¼éƒ½ä¸èƒ½è¢«åŒ¹é…æ—¶ï¼Œé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚ ç¤ºä¾‹ï¼š12345678910111213141516$ cat case_user.sh#!/bin/bashcase $USER in rich | barbara) echo &quot;Welcome, $USER&quot; echo &quot;Please enjoy your visit&quot;;; testing) echo &quot;Special testing account&quot;;; jessica) echo &quot;Do not forget to logout when you&apos;re done&quot;;; *) echo &quot;Sorry, you are not allowed here&quot;;;esac$ ./case_user.shSorry, you are not allowed here ä¸Šé¢çš„è„šæœ¬ç­‰åŒäºŽä½¿ç”¨å¦‚ä¸‹çš„ if è¯­å¥ï¼š123456789101112131415161718$ cat if_user.sh#!/bin/bashif [[ $USER = &quot;rich&quot; || $USER = &quot;barbara&quot; ]]then echo &quot;Welcome $USER&quot; echo &quot;Please enjoy your visit&quot;elif [ $USER = &quot;testing&quot; ]then echo &quot;Special testing account&quot;elif [ $USER = &quot;jessica&quot; ]then echo &quot;Do not forget to logout when you&apos;re done&quot;else echo &quot;Sorry, you are not allowed here&quot;fi$ ./if_user.shSorry, you are not allowed here äºŒã€æ›´å¤šç»“æž„åŒ–å‘½ä»¤1. for å‘½ä»¤å¾ˆå¤šæ—¶å€™ï¼Œéœ€è¦é‡å¤åœ°æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ç›´åˆ°æŸä¸ªç‰¹å®šçš„æƒ…å†µå‡ºçŽ°ã€‚for å‘½ä»¤å…è®¸åˆ›å»ºä¸€ä¸ªå¾ªçŽ¯æ¥éåŽ†æŸäº›å€¼ï¼Œå¹¶åœ¨å¾ªçŽ¯è¿‡ç¨‹ä¸­ä½¿ç”¨éåŽ†åˆ°çš„å€¼æ‰§è¡Œä¸€ç³»åˆ—ç‰¹å®šçš„æŒ‡ä»¤ã€‚è¯­æ³•æ ¼å¼ï¼š1234for var in listdo commandsdone éåŽ†åˆ—è¡¨12345678910111213$ cat for_list.sh#!/bin/bashfor state in Alabama Alaska Arizonado echo The next state is $statedoneecho &quot;The last state we visited was $state&quot;$ ./for_list.shThe next state is AlabamaThe next state is AlaskaThe next state is ArizonaThe last state we visited was Arizona æ¯æ¬¡ for å‘½ä»¤éåŽ†ç”±åŽé¢åˆ—è¡¨ï¼ˆAlabama Alaska Arizonaï¼‰æä¾›çš„å€¼æ—¶ï¼Œä¼šæŠŠåˆ—è¡¨ä¸­å½“å‰é¡¹ç›®çš„å€¼èµ‹å€¼ç»™ $state å˜é‡ï¼ˆå³ç¬¬ä¸€æ¬¡éåŽ†æŠŠ Alabama èµ‹å€¼ç»™ $stateï¼Œç¬¬äºŒæ¬¡æ˜¯ Alaskaï¼‰ï¼Œè¯¥ $state å˜é‡å¯ä»¥åœ¨åŽé¢çš„ do ... done ç»“æž„ä¸­ä½¿ç”¨ã€‚ for å¾ªçŽ¯ç»“æŸåŽ $state å˜é‡ä¾æ—§æœ‰æ•ˆï¼Œå³ä¿ç•™æœ€åŽä¸€æ¬¡éåŽ†æ—¶å¾—åˆ°çš„å€¼ï¼ˆåˆ—è¡¨çš„æœ€åŽä¸€é¡¹ Arizonaï¼‰è€Œä¸ä¼šè¢«é”€æ¯ã€‚ éåŽ†å­—ç¬¦ä¸²ä¸­çš„åˆ—è¡¨Bash Shell ä¸­çš„for å¾ªçŽ¯å¯ä»¥ç›´æŽ¥æŽ¥æ”¶å•ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå¹¶é€šè¿‡å…¶ä¸­çš„ç©ºæ ¼å°†è¯¥å­—ç¬¦ä¸²åˆ†å‰²æˆå¤šä¸ªéåŽ†çš„é¡¹ç›®ã€‚123456789101112131415$ cat for_variable.sh#!/bin/bashstates=&quot;Alabama Alaska Arizona&quot;states=$states&quot; Arkansas&quot;for state in $statesdo echo &quot;Have you ever visited $state?&quot;done$ ./for_variable.shHave you ever visited Alabama?Have you ever visited Alaska?Have you ever visited Arizona?Have you ever visited Arkansas? è„šæœ¬ä¸­ state=$state&quot; Arkansas&quot; å¯ä»¥ç”¨æ¥åœ¨ $state å˜é‡ä¸­çš„å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ æ–°çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿç­‰åŒäºŽåœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ äº†æ–°çš„é¡¹ç›®ã€‚ ä»Žå‘½ä»¤ä¸­èŽ·å–éåŽ†çš„åˆ—è¡¨å¯ä»¥é€šè¿‡å‘½ä»¤æ›¿æ¢å°†å‘½ä»¤çš„è¾“å‡ºä½œä¸º for å‘½ä»¤å¾ªçŽ¯éåŽ†çš„åˆ—è¡¨ï¼š12345678910111213$ cat states.txtAlabama Alaska Arizona$ cat for_command.sh#!/bin/bashfor state in $(cat states.txt)do echo &quot;Visit beautiful $state&quot;done$ ./for_command.shVisit beautiful AlabamaVisit beautiful AlaskaVisit beautiful Arizona éåŽ†æ–‡ä»¶ç›®å½•å¯ä»¥ä½¿ç”¨ for å‘½ä»¤ç›´æŽ¥å¾ªçŽ¯ç›®å½•ä¸­çš„æ–‡ä»¶ï¼ˆç»“åˆ * ç¬¦å·ï¼‰ï¼š1234567891011121314151617181920$ cat for_dir.sh#!/bin/bashfor file in /Users/starky/.vim* /Users/starky/badtestdo if [ -d &quot;$file&quot; ] then echo &quot;$file is a directory&quot; elif [ -f &quot;$file&quot; ] then echo &quot;$file is a file&quot; else echo &quot;$file doesn&apos;t exit&quot; fidone$ ./for_dir.sh/Users/starky/.vim is a directory/Users/starky/.viminfo is a file/Users/starky/.vimrc is a file/Users/starky/badtest doesn&apos;t exit æ³¨æ„è„šæœ¬ä¸­çš„ if [ -d &quot;$file&quot; ] æ®µä»£ç ï¼Œ &quot;$file&quot; è¢«åŒå¼•å·åŒ…è£¹äº†èµ·æ¥ã€‚åŽŸå› æ˜¯æ–‡ä»¶åä¸­åŒ…å«ç©ºæ ¼æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚æžœ $file å˜é‡çš„å€¼åŒ…å«ç©ºæ ¼ï¼Œåˆ™ä¸èƒ½ç›´æŽ¥åœ¨ if [ -d ... ] ä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨äº†åŒå¼•å·ã€‚ 2. C è¯­æ³•çš„ for å‘½ä»¤Bash Shell ä¹Ÿæ”¯æŒè¯­æ³•ç±»ä¼¼äºŽ C è¯­è¨€å½¢å¼çš„ for å¾ªçŽ¯ï¼šfor (( variable assignment ; condition ; iteration process )) 123456789101112131415161718$ cat for_c.sh#!/bin/bashfor (( i=1; i &lt;= 10; i++ ))do echo &quot;The next number is $i&quot;done$ ./for_c.shThe next number is 1The next number is 2The next number is 3The next number is 4The next number is 5The next number is 6The next number is 7The next number is 8The next number is 9The next number is 10 3. while å‘½ä»¤while å‘½ä»¤å…è®¸ç”¨æˆ·å®šä¹‰ä¸€ä¸ªåˆ¤æ–­æŒ‡ä»¤ï¼Œç„¶åŽå¾ªçŽ¯æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ï¼Œå¹¶åœ¨æ¯æ¬¡æ‰§è¡Œå‰æ£€æŸ¥åˆ¤æ–­æŒ‡ä»¤çš„è¿”å›žå€¼ï¼ˆexit statusï¼‰ã€‚ç›´åˆ°åˆ¤æ–­æŒ‡ä»¤çš„è¿”å›žå€¼ä¸ä¸º 0ï¼Œç»ˆæ­¢å¾ªçŽ¯ã€‚ while å‘½ä»¤çš„æ ¼å¼ä¸ºï¼š1234while test commanddo other commandsdone ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š123456789101112131415$ cat while.sh#!/bin/bashvar=5while [ $var -gt 0 ]do echo $var var=$[ $var -1 ]done$ ./while.sh54321 4. break å‘½ä»¤break å‘½ä»¤ç”¨äºŽè·³å‡ºå¾ªçŽ¯ 123456789101112131415161718$ cat break.sh#!/bin/bashfor var in 1 2 3 4 5 6 7 8 9 10do if [ $var -eq 5 ] then break fi echo &quot;Iteration number: $var&quot;doneecho &quot;The for loop is completed&quot;$ ./break.shIteration number: 1Iteration number: 2Iteration number: 3Iteration number: 4The for loop is completed 5. å¤„ç†å¾ªçŽ¯çš„è¾“å‡ºå¯ä»¥ä½¿ç”¨ç®¡é“æˆ–é‡å®šå‘å¤„ç†å¾ªçŽ¯çš„è¾“å‡ºä¿¡æ¯ï¼Œç›´æŽ¥å°†ç®¡é“æˆ–é‡å®šå‘å‘½ä»¤åŠ åœ¨å¾ªçŽ¯è¯­å¥å—çš„æœ«å°¾å³å¯ã€‚ 12345678910111213141516$ cat output.sh#!/bin/bashfor (( a = 1; a &lt; 5; a++ ))do echo &quot;The number is $a&quot;done &gt; numbers.txtecho &quot;The command is finished&quot;$ ./output.shThe command is finished$ cat numbers.txtThe number is 1The number is 2The number is 3The number is 4 å‚è€ƒèµ„æ–™Linux Command Line and Shell Scripting Bible 3rd Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Shell</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘èŽ“æ´¾ä½œä¸º FM å‘å°„å°å’Œ Webcam æœåŠ¡å™¨ï¼ˆè§†é¢‘ç›‘æŽ§ï¼‰]]></title>
    <url>%2F2018%2F11%2F11%2Fraspberry-pi-fm-emitter-and-webcam-server%2F</url>
    <content type="text"><![CDATA[åœ¨ç½‘ä¸Šå‘çŽ°ä¸¤ä¸ªå¾ˆæœ‰æ„æ€çš„æ ‘èŽ“æ´¾å°é¡¹ç›®ã€‚ä¸€ä¸ªæ˜¯ä½œä¸º FM å‘å°„å™¨ï¼Œå‘çŸ­è·ç¦»å†…çš„ FM æ”¶éŸ³æœºå‘é€å£°æ³¢ä¿¡å·ã€‚ä¸€ä¸ªæ˜¯ä½œä¸ºè§†é¢‘ç›‘æŽ§ï¼ˆé…åˆæ‘„åƒå¤´ï¼‰ï¼Œå¯ä»¥è¿œç¨‹è®¿é—®ç½‘é¡µå®¢æˆ·ç«¯èŽ·å–æ‘„åƒå¤´ç›‘æŽ§çš„ç”»é¢ã€‚å®žé™…å°è¯•äº†ä¸‹æ•ˆæžœéƒ½è¿˜ä¸é”™ã€‚ ä¸€ã€FM å‘å°„å™¨é¡¹ç›®åœ°å€ï¼šPiFmRdsè¯¥å‘å°„å™¨ä½¿ç”¨æ ‘èŽ“æ´¾çš„ PWM ç”Ÿæˆå™¨ æ¥äº§ç”Ÿ VHFï¼ˆç”šé«˜é¢‘ï¼‰ ä¿¡å·ã€‚ ç¼–è¯‘å®‰è£…PiFmRds éœ€è¦ä»Žæºä»£ç ç¼–è¯‘ï¼Œè€Œç¼–è¯‘æ—¶ä¾èµ– sndfile åº“ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š$ sudo apt-get install libsndfile1-devä¹‹åŽä½¿ç”¨å¦‚ä¸‹å‘½ä»¤èŽ·å–æºä»£ç å¹¶å®Œæˆç¼–è¯‘ï¼š1234$ git clone https://github.com/ChristopheJacquet/PiFmRds.git$ cd PiFmRds/src$ make clean$ make ç¼–è¯‘å®ŒæˆåŽ src ç›®å½•ä¸‹çš„æ–‡ä»¶å¦‚ä¸‹å›¾ï¼š å…¶ä¸­çš„ pi_fm_rds å³ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ç¨‹åºï¼Œå¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼ˆæ³¨æ„å‘½ä»¤å¼€å¤´çš„ sudoï¼‰ï¼š$ sudo ./pi_fm_rds -audio sound.wavè¯¥å‘½ä»¤ä¼šä»¥ 107.9M HZ çš„é¢‘çŽ‡å‘ç©ºä¸­å‘å°„åŒ…å« sound.wav æ–‡ä»¶éŸ³é¢‘çš„ç”µç£æ³¢ã€‚ è¯¦ç»†ä½¿ç”¨ä¸ºäº†ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥å°†ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ç¨‹åºç§»åŠ¨åˆ° /usr/local/bin ç›®å½•å¹¶æ”¹åä¸º fm å‘½ä»¤:$ sudo cp pi_fm_rds /usr/local/bin/fm fm å‘½ä»¤ä¸»è¦æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼š -audio ç”¨æ¥æŒ‡å®šç”Ÿæˆç”µç£å£°æ³¢çš„åª’ä½“æ–‡ä»¶ -freq ç”¨æ¥æŒ‡å®šç”Ÿæˆçš„ç”µç£å£°æ³¢çš„é¢‘çŽ‡ 1234567891011$ sudo fm -audio ~/Music/Faded_Alan\ Walker.wav -freq 108Using mbox device /dev/vcio.Allocating physical memory: size = 3403776 mem_ref = 5 bus_addr = fe7b0000 virt_addr = 0x768dc000ppm corr is 0.0000, divider is 1096.4912 (1096 + 2012*2^-12) [nominal 1096.4912].Using audio file: /home/pi/Music/Faded_Alan Walker.wavInput: 44100 Hz, upsampling factor: 5.172 channels, generating stereo multiplex.Created low-pass FIR filter for audio channels, with cutoff at 12000.0 HzPI: 1234, PS: &lt;Varying&gt;.RT: &quot;PiFmRds: live FM-RDS transmission from the RaspberryPi&quot;Starting to transmit on 108.0 MHz. ä¸‹é¢æ˜¯ç”¨å°ç±³æ‰‹æœºè‡ªå¸¦çš„ FM Radio å½•åˆ¶çš„ä¸€æ®µï¼Œå‘ƒï¼Œæˆªå›¾ã€‚ã€‚ã€‚ å¯¹äºŽä¼ è¾“ mp3 æ ¼å¼æ–‡ä»¶ï¼Œå¯ä»¥å€ŸåŠ© sox å·¥å…·ï¼š$ sudo apt-get install sox å†é€šè¿‡ sox å‘½ä»¤å°† mp3 æ ¼å¼æ–‡ä»¶è½¬æ¢ä¸º wav æ ¼å¼çš„éŸ³é¢‘æµï¼Œé‡å®šå‘ç»™ fm å‘½ä»¤ï¼šsox -t mp3 ~/Music/baby-alian.mp3 -t wav - | sudo fm -freq 108 -audio - å®žé™…çš„ä½¿ç”¨æ•ˆæžœè¿˜æ˜¯éžå¸¸æ£’çš„ï¼Œè¿‘è·ç¦»å†…æ”¶éŸ³å¾ˆæ¸…æ™°ã€‚å¦‚æžœéœ€è¦å¢žåŠ æ”¶éŸ³è·ç¦»ï¼Œå¯ä»¥åœ¨æ ‘èŽ“æ´¾çš„ GPIO 4ï¼ˆå³ 7 å·å¼•è„šï¼‰æ’ä¸Šä¸€æ ¹ æœé‚¦çº¿ ä½œä¸ºå¤©çº¿ã€‚ äºŒã€è§†é¢‘ç›‘æŽ§ä¸Šé¢çš„å›¾ç‰‡å³æ ‘èŽ“æ´¾ 3 ä»£ B+ è£…ä¸Šä¸“ç”¨çš„æ‘„åƒå¤´æ¨¡å—åŽçš„æ ·å­ã€‚è¯¥æ¨¡å—æŸå®ä¸Šå¯ä»¥è½»æ¾ä¹°åˆ°ï¼Œä¸é™„é“¾æŽ¥ã€‚æ ‘èŽ“æ´¾ä¹Ÿæ”¯æŒå¤§å¤šæ•°å¸¸ç”¨çš„ USB æ‘„åƒå¤´ï¼Œæ²¡å°è¯•è¿‡ï¼Œä¸ç»†è¯´ã€‚ æ‹ç…§å’Œæ‘„åƒæ ‘èŽ“æ´¾éœ€è¦å…ˆåœ¨è½¯ä»¶é…ç½®é‡Œå¼€å¯æ‘„åƒå¤´æ¨¡å—ã€‚å¯ä»¥ä½¿ç”¨ sudo raspi-config å‘½ä»¤ï¼Œé€‰æ‹© 5 Interfacing Options -&gt; P1 Cameraã€‚ ä¹‹åŽå°±å¯ä»¥ä½¿ç”¨ raspistill å‘½ä»¤æ‹ç…§å’Œ raspivid å‘½ä»¤å½•åˆ¶è§†é¢‘äº†ã€‚ 1234# æ‹æ‘„ç…§ç‰‡å¹¶ä¿å­˜è‡³ image1.jpg æ–‡ä»¶$ raspistill -o image1.jpg# æ‹æ‘„é•¿åº¦ä¸º 10000 æ¯«ç§’çš„è§†é¢‘å¹¶ä¿å­˜è‡³ video.h264 æ–‡ä»¶$ raspivid -o video.h264 -t 10000 mjpg-streamermjpg-streamer æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥é€šè¿‡å¤šç§è¾“å…¥å’Œè¾“å‡ºæ’ä»¶å°† JPEG å¸§ä½œä¸ºè§†é¢‘æµä¼ è¾“ã€‚æ”¯æŒæ ‘èŽ“æ´¾æ‘„åƒå¤´æ¨¡å—ã€‚é¡¹ç›®åœ°å€ï¼šmjpg-streamer ç¼–è¯‘å®‰è£…ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤èŽ·å– mjpg-streamer æºä»£ç å¹¶ç¼–è¯‘å®‰è£…ï¼š1234567# å®‰è£…ä¾èµ–åº“å’Œç¼–è¯‘å·¥å…· cmake$ sudo apt-get install cmake libjpeg8-dev libv4l-dev# èŽ·å–æºä»£ç å¹¶ç¼–è¯‘$ git clone https://github.com/jacksonliam/mjpg-streamer.git$ cd mjpg-streamer/mjpg-streamer-experimental$ make$ sudo make install å®‰è£…æˆåŠŸåŽä¾¿å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å¼€å¯è§†é¢‘æµï¼š12345678910111213141516171819$ mjpg_streamer -i &quot;input_raspicam.so -x 640 -y 480 -fps 30&quot; -o &quot;output_http.so -w ./www&quot;MJPG Streamer Version: git rev: ddb69b7b4f114f3c2ca01adf55712792ca8aed43 i: fps.............: 30 i: resolution........: 640 x 480 i: camera parameters..............:Sharpness 0, Contrast 0, Brightness 50Saturation 0, ISO 0, Video Stabilisation No, Exposure compensation 0Exposure Mode &apos;auto&apos;, AWB Mode &apos;auto&apos;, Image Effect &apos;none&apos;Metering Mode &apos;average&apos;, Colour Effect Enabled No with U = 128, V = 128Rotation 0, hflip No, vflip NoROI x 0.000000, y 0.000000, w 1.000000 h 1.000000 o: www-folder-path......: ./www/ o: HTTP TCP port........: 8080 o: HTTP Listen Address..: (null) o: username:password....: disabled o: commands.............: enabled i: Starting CameraEncoder Buffer Size 81920 å…¶ä¸­ -i é€‰é¡¹åŽé¢çš„ input_rapsicam.so ç”¨äºŽæŒ‡å®šè¾“å…¥æ’ä»¶ï¼Œ-x å’Œ -y é€‰é¡¹æŒ‡å®šè§†é¢‘æµçš„åˆ†è¾¨çŽ‡ï¼Œ-fps é€‰é¡¹æŒ‡å®šå¸§çŽ‡ã€‚-o é€‰é¡¹åŽé¢çš„ output_http.so ç”¨äºŽæŒ‡å®šè¾“å‡ºæ’ä»¶ï¼Œ-w æŒ‡å®š Webcam æœåŠ¡å™¨ä½¿ç”¨çš„ç½‘é¡µæºæ–‡ä»¶ã€‚ ä½¿ç”¨æµ‹è¯•Webcam æœåŠ¡å™¨åœ°å€ä¸ºï¼šIP_Address:8080ä½¿ç”¨æµè§ˆå™¨è®¿é—®æ—¶æ•ˆæžœå¦‚ä¸‹ï¼š å¯ä»¥å€ŸåŠ© VLC æˆ– iina è§†é¢‘æ’­æ”¾å™¨çš„ æ‰“å¼€ URL åŠŸèƒ½ï¼Œè¿œç¨‹æ’­æ”¾è§†é¢‘æµã€‚URL ä¸º IP_Address:8080/?action=stream ã€‚æ•ˆæžœå¦‚ä¸‹ï¼š å‘ƒï¼Œå®žè¯è¯´ï¼Œæœ‰ç‚¹å°å¡ã€‚ã€‚ã€‚å“ˆå“ˆå“ˆ å‚è€ƒèµ„æ–™Raspberry Pi Cookbook, 2nd EditionRaspberry Pi for Secret Agents (English Edition)]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Hardware</tag>
        <tag>RaspberryPi</tag>
        <tag>Raspbian</tag>
        <tag>Camera</tag>
        <tag>Webcam</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡ JavaScript (Johnny-Five) æŽ§åˆ¶ Ardunio]]></title>
    <url>%2F2018%2F10%2F25%2Fprogramming-arduino-with-javascript%2F</url>
    <content type="text"><![CDATA[Johnnt-Five æ˜¯ä¸€ä¸ªæ”¯æŒ JavaScript è¯­è¨€ç¼–ç¨‹çš„æœºå™¨äººå’Œ IOT å¼€å‘å¹³å°ï¼ŒåŸºäºŽ Firmata åè®®ã€‚è¯¥é¡¹ç›®åœ¨ Github ä¸Šæœ‰ç€å¾ˆå¥½çš„æ´»è·ƒåº¦ï¼Œå®˜ç½‘ä¸Šä¹Ÿæœ‰éžå¸¸è¯¦å°½çš„ API æ–‡æ¡£å’Œä¸°å¯Œçš„å®žä¾‹(http://johnny-five.io/examples/)ã€‚ ä¸€ã€çŽ¯å¢ƒæ­å»ºå®‰è£… Arduino IDEå®‰è£… Arduino IDE ä¸»è¦æ˜¯ä¸ºäº†å‘å¼€å‘æ¿ä¸­åˆ·å…¥ Firmata ç¨‹åºã€‚Firmata æ˜¯è®¡ç®—æœºè½¯ä»¶å’Œå¾®æŽ§åˆ¶å™¨ä¹‹é—´çš„ä¸€ç§é€šä¿¡åè®®ã€‚å½“å¼€å‘æ¿ä¸­åˆ·å…¥äº† Firmata å›ºä»¶åŽï¼Œç”µè„‘ç«¯å°±å¯ä»¥ä½¿ç”¨åŒæ ·åŸºäºŽ Firmata åè®®çš„æ¡†æž¶å¯¹å¼€å‘æ¿è¿›è¡Œç¼–ç¨‹ã€‚ Arduino IDE å¯ä»¥ç›´æŽ¥ä»Žå®˜ç½‘ä¸‹è½½å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…åŒ…è¿›è¡Œå®‰è£…ã€‚å®‰è£…å®ŒæˆåŽè¿›å…¥ æ–‡ä»¶ - ç¤ºä¾‹ - Firmata - StandardFirmataPlus ï¼Œå°†è¯¥ç¨‹åºåˆ·å…¥ Arduino å¼€å‘æ¿å³å¯ã€‚ Johnny-Five æ¡†æž¶Johnny-Five æ¡†æž¶éœ€è¦ç”µè„‘ç³»ç»Ÿé‡Œå®‰è£… Node.js ç¨‹åºã€‚å¯ä»¥ç›´æŽ¥ä»Žå®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ nvm ç­‰ç‰ˆæœ¬ç®¡ç†å·¥å…·å®‰è£…éœ€è¦çš„ç‰ˆæœ¬nvm æ–¹å¼å¯å‚è€ƒç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼ˆnvmã€virtualenv(wrapper) å’Œ rbenv çš„å®‰è£…ä¸Žä½¿ç”¨ï¼‰ å®‰è£…å®ŒæˆåŽç›´æŽ¥åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ npm å‘½ä»¤å³å¯ï¼š$ npm install johnny-five äºŒã€Hello Worldåœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º blink.js æ–‡ä»¶ï¼š12345678910111213var five = require(&quot;johnny-five&quot;);var board = new five.Board();// The board&apos;s pins will not be accessible until the board has reported that it is readyboard.on(&quot;ready&quot;, function() &#123; console.log(&quot;Ready!&quot;); // Create a standard `led` component instance var led = new five.Led(13); // &quot;blink&quot; the led in 500ms led.blink(500);&#125;); ä½¿ç”¨ node blink.js å‘½ä»¤è¿è¡Œé¡¹ç›®ï¼Œæ•ˆæžœå¦‚ä¸‹ï¼šæ­¤æ—¶ Arduino æ¿å­ä¸ŠæŽ¥ 13 å¼•è„šçš„çº¢è‰² LED å¼€å§‹ä»¥ 500 æ¯«ç§’çš„é—´éš”é—ªçƒï¼Œä½¿ç”¨ .exit å‘½ä»¤é€€å‡º nodejs çš„ Repl åŽåœæ­¢é—ªçƒã€‚ REPLåœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º repl.js æ–‡ä»¶ï¼š12345678910111213141516171819var five = require(&quot;johnny-five&quot;);var board = new five.Board();board.on(&quot;ready&quot;, function() &#123; console.log(&quot;Ready event. Repl instance auto-initialized!&quot;); var led = new five.Led(13); this.repl.inject(&#123; // Allow limited on/off control access to the // Led instance from the REPL. on: function() &#123; led.on(); &#125;, off: function() &#123; led.off(); &#125; &#125;);&#125;); è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼šå¯ä»¥åœ¨ nodejs çš„ Repl ä¸­ä½¿ç”¨ on() å’Œ off() å¯¹ LED13 è¿›è¡Œæ‰“å¼€å’Œå…³é—­æ“ä½œã€‚ ä¸‰ã€Buttonåˆ›å»º button.js æ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031var five = require(&quot;johnny-five&quot;), board, button;board = new five.Board();board.on(&quot;ready&quot;, function() &#123; // Create a new `button` hardware instance. button = new five.Button(2); // Inject the `button` hardware into the Repl instance&apos;s context; board.repl.inject(&#123; button: button &#125;); // &quot;down&quot; the button is pressed button.on(&quot;down&quot;, function() &#123; console.log(&quot;down&quot;); &#125;); // &quot;hold&quot; the button is pressed for specified time. // defaults to 500ms (1/2 second) button.on(&quot;hold&quot;, function() &#123; console.log(&quot;hold&quot;); &#125;); // &quot;up&quot; the button is released button.on(&quot;up&quot;, function() &#123; console.log(&quot;up&quot;); &#125;);&#125;); çº¿è·¯æŽ¥æ³•å¦‚ä¸‹ï¼š è¿è¡Œæ•ˆæžœï¼š æŒ‰ä¸‹å¹¶é‡Šæ”¾æŒ‰é”®æ—¶ Repl ä¸­è¾“å‡º down å’Œ upã€‚æŒ‰ä½æŒ‰é”®æ—¶è¾“å‡º holdã€‚ å°¬å°´ï¼ŒJavaScript ä¸å¤ªç†Ÿæ‚‰ï¼Œä»¥åŽæœ‰æ—¶é—´å¤šåšå°è¯•ã€‚å®˜æ–¹æ–‡æ¡£çœŸçš„å¾ˆè¯¦ç»†ã€‚ã€‚ã€‚]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
        <tag>JavaScript</tag>
        <tag>Programming</tag>
        <tag>Arduino</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ Docker åˆ›å»ºç®€å•çš„ Web åº”ç”¨]]></title>
    <url>%2F2018%2F10%2F19%2Fsimple-web-application-with-docker%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Flask å°ç¨‹åºé¦–å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„ Flask å°ç¨‹åºï¼Œç”¨æ¥è¿”å›žä¸€ä¸ªæ¯”è¾ƒåŽŸå§‹çš„ HTML é¡µé¢ã€‚è¯¥é¡¹ç›®çš„æ–‡ä»¶ç»“æž„å¦‚ä¸‹ï¼š1234avatarâ”œâ”€â”€ Dockerfileâ”œâ”€â”€ app â””â”€â”€ avatar.py å…¶ä¸­çš„ Dockerfile ç”¨äºŽåˆ›å»ºè¿è¡Œè¯¥é¡¹ç›®çš„å®¹å™¨ï¼Œapp ç›®å½•ä¸‹çš„ avatar.py ä¸ºç¨‹åºçš„æºæ–‡ä»¶ã€‚ avatar.py çš„æºä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122from flask import Flaskapp = Flask(__name__)default_name = &apos;skitarniu&apos;# åˆ›å»ºå…³è”äºŽç½‘ç«™æ ¹ URLï¼ˆ&apos;/&apos;ï¼‰çš„è·¯ç”±ã€‚å½“è¯¥ URL è¢«è¯·æ±‚æ—¶ï¼Œå°†è¿”å›ž get_avatar() å‡½æ•°çš„ç»“æžœ@app.route(&apos;/&apos;)def get_avatar(): name = default_name header = &apos;&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&apos; body = &apos;&apos;&apos;&lt;form method=&quot;POST&quot;&gt; Hello &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;&#123;&#125;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt; &lt;/form&gt; &lt;p&gt;You look like a: &lt;img src=&quot;&quot;/&gt; &apos;&apos;&apos;.format(name) footer = &apos;&lt;/body&gt;&lt;/html&gt;&apos; return header + body + footer# åˆå§‹åŒ– web æœåŠ¡å™¨if __name__ == &apos;__main__&apos;: app.run(debug=True, host=&apos;0.0.0.0&apos;) ç¼–è¾‘ Dockerfileç”¨äºŽæž„å»ºå®¹å™¨çš„ Dockerfile å†…å®¹å¦‚ä¸‹ï¼š123456789101112# åˆå§‹é•œåƒä¸º Docker Hub ä¸Šçš„ Python:3.6 é•œåƒFROM python:3.6# æ‰§è¡Œ pip å‘½ä»¤å®‰è£… flask æ¡†æž¶RUN pip install Flask==1.0.2# å·¥ä½œç›®å½•è®¾ç½®ä¸ºå®¹å™¨ä¸­çš„ /appWORKDIR /app# å°†æœ¬åœ°ä¸»æœºä¸Šçš„é¡¹ç›®æºç æ–‡ä»¶å¤¹å¤åˆ¶åˆ°å®¹å™¨ä¸­COPY app /app# å®¹å™¨è¿è¡Œæ—¶å…¶å†…éƒ¨æ‰§è¡Œçš„å‘½ä»¤CMD [&quot;python&quot;, &quot;avatar.py&quot;] æž„å»ºå®¹å™¨å¹¶è¿è¡Œé¡¹ç›®å¯ä»¥ä½¿ç”¨ docker build å‘½ä»¤æ ¹æ® Dockerfile ä¸­çš„æ­¥éª¤åˆ›å»ºå®¹å™¨çš„é•œåƒæ–‡ä»¶ï¼Œä¹‹åŽä½¿ç”¨ docker run å‘½ä»¤åˆ©ç”¨åˆšåˆšåˆ›å»ºçš„é•œåƒåŠ è½½å®¹å™¨å¹¶è¿è¡Œé¡¹ç›®ã€‚12345678$ docker build -t avatar ....$ docker run -d -p 5000:5000 --name simple-flask avatare90b14c39b23fb97956af8128ae01c73b9bd5e8917578d755e477efd6337e740$ curl localhost:5000&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt;... å…¶ä¸­ docker run å‘½ä»¤çš„ -d é€‰é¡¹æŒ‡å®šå®¹å™¨åœ¨åŽå°è¿è¡Œï¼›-p 5000:5000 ç”¨æ¥æŒ‡å®šæœ¬åœ°ä¸»æœºåˆ°å®¹å™¨çš„ç«¯å£æ˜ å°„ï¼ˆå³è®¿é—®æœ¬åœ°ä¸»æœºçš„ 5000 ç«¯å£ç­‰åŒäºŽè®¿é—®å®¹å™¨ä¸­ 5000 ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ï¼‰ï¼›--name simple_flask ç”¨äºŽæŒ‡å®šå®¹å™¨çš„åå­—ä¸º simple_flask ï¼›æœ€åŽçš„ avatar æŒ‡å®šä½¿ç”¨çš„é•œåƒæ–‡ä»¶ã€‚ å¯ä»¥ä½¿ç”¨ docker logs &lt;container_name&gt; å‘½ä»¤æŸ¥çœ‹åŽå°è¿è¡Œçš„å®¹å™¨çš„è¾“å‡ºï¼š12345678910111213$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESe90b14c39b23 avatar &quot;python avatar.py&quot; 11 minutes ago Up 11 minutes 0.0.0.0:5000-&gt;5000/tcp simple_flask$ docker logs simple_flask * Serving Flask app &quot;avatar&quot; (lazy loading) ... * Debug mode: on * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit) * Restarting with stat * Debugger is active! * Debugger PIN: 495-921-379172.17.0.1 - - [10/Oct/2018 11:28:31] &quot;GET / HTTP/1.1&quot; 200 -10.2.67.88 - - [10/Oct/2018 11:32:02] &quot;GET / HTTP/1.1&quot; 200 - Bind Mountså¯ä»¥åœ¨æ‰§è¡Œ docker run å‘½ä»¤æ—¶ä½¿ç”¨ -v HOST_DIR:CONTAINER_DIR é€‰é¡¹ï¼Œå°†æœ¬åœ°ä¸»æœºä¸Šçš„é¡¹ç›®ç›®å½•æ˜ å°„åˆ°å®¹å™¨ä¸­ï¼Œå¹¶è¦†ç›–å®¹å™¨ä¸­åŽŸç›®å½•ä¸‹çš„å†…å®¹ã€‚è¿™æ ·å½“æœ¬åœ°ä¸»æœºä¸Šçš„é¡¹ç›®æºç è¢«ä¿®æ”¹åŽï¼Œæ›´æ–°çš„å†…å®¹ä¼šç›´æŽ¥åŒæ­¥è‡³å®¹å™¨ä¸­çš„å¯¹åº”æ–‡ä»¶ï¼Œå°±ä¸éœ€è¦é‡æ–°æž„å»ºå®¹å™¨äº†ã€‚123456789101112131415$ docker stop $(docker ps -lq)e90b14c39b23$ docker rm $(docker ps -lq)e90b14c39b23$ docker run -d -p 5000:5000 -v &quot;$(pwd)&quot;/app:/app avatar899831690d5eb7e2e1f7882c00bfef7284f629518e66b581bd5979f3712bf241$ curl localhost:5000&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt;...$ sed -i &apos;s/Avatar/Avatar_Modified/&apos; app/avatar.py$ curl localhost:5000&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar_Modified&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt;... ä»¥ä¸Šçš„å‘½ä»¤ä¸­ï¼Œdocker stop å’Œ docker rm ç”¨äºŽåœæ­¢å¹¶åˆ é™¤å½“å‰çš„å®¹å™¨ã€‚docker run å‘½ä»¤ä¸­çš„ -v &quot;$(pwd)&quot;/app:/app é€‰é¡¹ç”¨æ¥å°†æœ¬åœ°ä¸»æœºä¸Šçš„é¡¹ç›®ç›®å½•ï¼ˆ&quot;$(pwd)&quot;/appï¼‰å…³è”ç»™å®¹å™¨ä¸­çš„ /app ç›®å½•ã€‚æ‰€ä»¥å½“ä½¿ç”¨ sed -i å‘½ä»¤å°†æºç ä¸­çš„ Avatar æ›¿æ¢ä¸º Avatar_Modified ä¹‹åŽï¼Œä¸éœ€è¦é‡æ–°æž„å»ºï¼Œå®¹å™¨è¿”å›žçš„ HTML æ–‡æ¡£ä¸­çš„ æ ‡ç­¾å·²ç»å˜æˆæ–°å€¼ã€‚ äºŒã€uWSGI æœåŠ¡å™¨WSGIï¼ˆå³ Web Server Gateway Interfaceï¼‰æ˜¯ Web æœåŠ¡å™¨ï¼ˆå¦‚ nginxï¼‰å’Œ Web åº”ç”¨ç¨‹åºæˆ–æ¡†æž¶ï¼ˆå¦‚ Flaskï¼‰ä¹‹é—´çš„ä¸€ç§é€šç”¨æŽ¥å£ã€‚å®ƒå°±åƒæ˜¯ä¸€ä¸ªæ¡¥æ¢ï¼Œä¸€è¾¹è¿žç€ Web æœåŠ¡å™¨ï¼Œä¸€è¾¹è¿žç€ Web åº”ç”¨ç¨‹åºã€‚ å¾ˆå¤šæ¡†æž¶éƒ½è‡ªå¸¦äº† WSGI serverï¼ˆå¦‚ Flask çš„ webserverï¼‰ï¼Œä½†æ›´å¤šæ˜¯æµ‹è¯•ç”¨é€”ï¼Œå‘å¸ƒæ—¶åˆ™ä½¿ç”¨ç”Ÿäº§çŽ¯å¢ƒçš„ WSGI server æˆ–æ˜¯è”åˆ nginx åš uwsgi ã€‚ è€Œ uWSGI æ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®žçŽ°äº† WSGIã€uwsgiã€http ç­‰åè®®ã€‚ è¿™é‡Œä½¿ç”¨ uWSGI æ›¿ä»£ Flask è‡ªå¸¦çš„ webserverï¼Œå¯å¯¹ä¹‹å‰çš„ Dockerfile åšå¦‚ä¸‹ä¿®æ”¹ï¼š1234567FROM python:3.6RUN pip install Flask==1.0.2 uWSGI==2.0.17.1WORKDIR /appCOPY app /appCMD [&quot;uwsgi&quot;, &quot;--http&quot;, &quot;0.0.0.0:9090&quot;, &quot;--wsgi-file&quot;, &quot;/app/avatar.py&quot;, &quot;--callable&quot;, &quot;app&quot;, &quot;--stats&quot;, &quot;0.0.0.0:9191&quot;] é‡æ–°æž„å»º docker é•œåƒå¹¶è¿è¡Œå®¹å™¨ï¼š12345678$ docker build -t avatar ....$ docker run -d -p 9090:9090 -p 9191:9191 avatar2ca0aed60d53803a7eaaf6ca9146c1786593f3d1d1c86b498ea4577cade854e8$ curl localhost:9090&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar_Modified&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt;... ä¸Šé¢çš„ uWSGI æ˜¯åœ¨ root ç”¨æˆ·ä¸‹è¿è¡Œçš„ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ã€‚éœ€è¦å°† Dockerfile æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š1234567891011121314FROM python:3.6# åˆ›å»ºç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œåä¸º uwsgiRUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgiRUN pip install Flask==1.0.2 uWSGI==2.0.17.1WORKDIR /appCOPY app /app# ä½¿ç”¨ EXPOSE å£°æ˜Žå¯ä¾›å¤–éƒ¨è®¿é—®çš„ç«¯å£å·EXPOSE 9090 9191# USER ç”¨äºŽæŒ‡å®šæŸä¸ªç”¨æˆ·ï¼Œå…¶åŽçš„æ‰€æœ‰å‘½ä»¤ï¼ˆåŒ…æ‹¬ CMD å’Œ ENTRYPOINTï¼‰éƒ½å°†ç”±è¯¥ç”¨æˆ·æ‰§è¡ŒUSER uwsgiCMD [&quot;uwsgi&quot;, &quot;--http&quot;, &quot;0.0.0.0:9090&quot;, &quot;--wsgi-file&quot;, &quot;/app/avatar.py&quot;, &quot;--callable&quot;, &quot;app&quot;, &quot;--stats&quot;, &quot;0.0.0.0:9191&quot;] åŒºåˆ†æµ‹è¯•å’Œç”Ÿäº§çŽ¯å¢ƒå¯ä»¥å°† Dockerfile ä¸­ CMD è°ƒç”¨çš„å‘½ä»¤å•ç‹¬å­˜æ”¾åœ¨ä¸€ä¸ª Shell è„šæœ¬ä¸­ã€‚å¦‚åœ¨ avatar ç›®å½•ä¸‹æ–°å»º cmd.sh æ–‡ä»¶å¹¶æ·»åŠ æ‰§è¡Œæƒé™ï¼ˆchmod +x cmd.shï¼‰ï¼Œå†æ·»åŠ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š1234567891011#!/bin/bashset -eif [ &quot;$ENV&quot; = &apos;DEV&apos; ]; then echo &quot;Running Development Server&quot; exec python &quot;avatar.py&quot;else echo &quot;Running Production Server&quot; exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/avatar.py \ --callable app --stats 0.0.0.0:9191fi æ­¤æ—¶çš„ Dockerfile å†…å®¹å¦‚ä¸‹ï¼š12345678910111213FROM python:3.6RUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgiRUN pip install Flask==1.0.2 uWSGI==2.0.17.1WORKDIR /appCOPY app /appCOPY cmd.sh /EXPOSE 9090 9191USER uwsgi# CMD é€‰é¡¹æ”¹ä¸ºåŒ…å«ä¸€ç³»åˆ—å‘½ä»¤ä¸”æ‹¥æœ‰æ‰§è¡Œæƒé™çš„è„šæœ¬æ–‡ä»¶CMD [&quot;/cmd.sh&quot;] é‡æ–°æž„å»º Docker é•œåƒï¼Œåœ¨æµ‹è¯•çŽ¯å¢ƒä¸‹è¿è¡Œæ—¶ä½¿ç”¨$ docker run -e &quot;ENV=DEV&quot; -p 5000:5000 avatarå…¶ä¸­ -e é€‰é¡¹ç”¨äºŽæŒ‡å®šçŽ¯å¢ƒå˜é‡ åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸‹è¿è¡Œæ—¶åˆ™ä½¿ç”¨$ docker run -d -p 9090:9090 -p 9191 avatar ä¸‰ã€Docker ComposeCompose å·¥å…·ç”¨äºŽå¿«é€Ÿåœ°æ­å»ºå’Œè¿è¡Œ Docker å¼€å‘çŽ¯å¢ƒã€‚å®ƒä½¿ç”¨ YAML æ–‡ä»¶ä¿å­˜å®¹å™¨é›†ç¾¤çš„é…ç½®ä¿¡æ¯ã€‚ å®‰è£… ComposeUbuntu ç³»ç»Ÿä¸‹å®‰è£… Compose å¯å‚è€ƒä»¥ä¸‹å‘½ä»¤ï¼š1234# ä»Ž Github ä¸ŠèŽ·å– Docker Compose çš„äºŒè¿›åˆ¶ç¨‹åº$ sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.22.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose# ä¸ºèŽ·å–åˆ°çš„ compose ç¨‹åºæ·»åŠ æ‰§è¡Œæƒé™$ sudo chmod +x /usr/local/bin/docker-compose ç¼–è¾‘ docker-compose æ–‡ä»¶åœ¨ avatar ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªåä¸º docker-compose.yml çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯ docker-compose å‘½ä»¤è¿è¡Œæ—¶å‚è€ƒçš„é…ç½®æ–‡ä»¶ï¼š12345678avatar: build: . ports: - &quot;5000:5000&quot; environment: ENV:DEV volumes: - ./app:/app å…¶ä¸­ç¬¬ä¸€è¡Œçš„ avatar ç”¨äºŽå£°æ˜Žéœ€è¦æž„å»ºçš„å®¹å™¨çš„åç§°ï¼ŒåŒä¸€ä¸ª YAML æ–‡ä»¶ä¸­å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªå®¹å™¨çš„å®šä¹‰ï¼›ç¬¬äºŒè¡Œçš„ build: . è¡¨ç¤ºç”¨äºŽæž„å»ºå®¹å™¨é•œåƒæ–‡ä»¶çš„ Dockerfile ä½äºŽå½“å‰ç›®å½•ä¸‹ï¼›ports é¡¹ç­‰åŒäºŽ docker run å‘½ä»¤ä¸­çš„ -p é€‰é¡¹ï¼Œç”¨äºŽå®šä¹‰ç«¯å£è½¬å‘ï¼›environment é¡¹ç­‰åŒäºŽ docker run å‘½ä»¤ä¸­çš„ -e é€‰é¡¹ï¼Œç”¨äºŽå®šä¹‰å®¹å™¨ä¸­çš„çŽ¯å¢ƒå˜é‡ï¼›volumes é¡¹ç­‰åŒäºŽ docker run å‘½ä»¤ä¸­çš„ -v é€‰é¡¹ï¼Œç”¨äºŽå®šä¹‰å­˜å‚¨å·ã€‚ è¿è¡Œé¡¹ç›®å¯ç›´æŽ¥ä½¿ç”¨ docker-compose up å‘½ä»¤æž„å»ºå®¹å™¨å¹¶æ‰§è¡Œé¡¹ç›®ï¼š12345678910111213$ docker-compose upBuilding avatar...Successfully built 1f883bd34e9fSuccessfully tagged avatar_avatar:latestWARNING: Image for service avatar was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.Creating avatar_avatar_1 ... doneAttaching to avatar_avatar_1avatar_1 | Running Development Serveravatar_1 | * Serving Flask app &quot;avatar&quot; (lazy loading)...avatar_1 | * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)... å››ã€å…³è”å…¶ä»–é•œåƒï¼ˆdnmonsterï¼‰dnmonster é•œåƒæ˜¯ä¸€ä¸ªæ•´åˆåœ¨ Docker å®¹å™¨ä¸­çš„ Node.js åº”ç”¨ï¼Œå¯ä»¥ç›´æŽ¥ä»Ž Docker Hub ä¸Šæ‹‰å–åˆ°æœ¬åœ°ã€‚å®ƒæä¾›äº†ä¸€ä¸ª RESTful APIï¼Œå½“è®¿é—® http://0.0.0.0:8080/monster/MY_ID æ—¶ï¼Œè¿”å›žä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„â€œæ€ªå…½â€å¤´åƒã€‚1234$ docker pull amouat/dnmonster...$ docker run -d -p 8080:8080 amouat/dnmonster... æ­¤æ—¶æ‰“å¼€æµè§ˆå™¨è®¿é—® http://ip_address:8080/monster/some_string?size=200 ï¼Œç»“æžœå¦‚å›¾æ‰€ç¤ºï¼š æ•´åˆ dnmonster é•œåƒå‰é¢çš„ flask åº”ç”¨åªåŒ…å«ä¸€ä¸ªæœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œå³è®¿é—®å®ƒçš„ä¸»é¡µæ—¶è¿”å›žä¸€ä¸ªç®€å•çš„ HTML é¡µé¢ï¼Œé¡µé¢ä¸­åŒ…å«ä¸€ä¸ªèŽ·å–ç”¨æˆ·è¾“å…¥çš„è¡¨å•ï¼Œå’Œä¸€ä¸ª src å±žæ€§å€¼ä¸ºç©ºå­—ç¬¦ä¸²çš„ &lt;img&gt; æ ‡ç­¾ï¼ˆâ€œç©ºç™½â€å›¾ç‰‡ï¼‰ã€‚ ç»“åˆ dnmonster é•œåƒçš„ä½¿ç”¨ï¼Œå¯ä»¥å°†è¡¨å•ä¸­èŽ·å–åˆ°çš„è¾“å…¥æ•´åˆåˆ°å›¾ç‰‡æ ‡ç­¾ çš„ src å±žæ€§ä¸­ï¼ˆ/monster/&lt;user_input&gt;ï¼‰ å°†è¯¥å›¾ç‰‡çš„ URL è·¯å¾„ ï¼ˆ/monster/&lt;user_input&gt;ï¼‰ç»‘å®šç»™å¦ä¸€ä¸ªå‡½æ•°ï¼ˆget_avatarï¼‰ï¼Œè¯¥å‡½æ•°è®¿é—® dnmonster å®¹å™¨ä¸­çš„ RESTful APIï¼Œæ‰€ä»¥ç½‘é¡µä¸­æœ€ç»ˆæ˜¾ç¤ºçš„æ˜¯ä»Ž dnmonster å®¹å™¨èŽ·å–åˆ°çš„å¤´åƒå›¾ç‰‡ï¼Œå¹¶éšç”¨æˆ·è¾“å…¥è€Œæ›´æ–°ã€‚ app/avatar.py æ–‡ä»¶çš„å…·ä½“ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940from flask import Flask, Response, requestimport requestsimport hashlibapp = Flask(__name__)default_name = &apos;skitarniu&apos;# å£°æ˜Žç½‘ç«™ä¸»é¡µå°†ä¼šå¤„ç† GET å’Œ POST è¯·æ±‚ï¼ˆå› ä¸ºè¡¨å•çš„æäº¤å±žäºŽ POST è¯·æ±‚ï¼‰ï¼Œä¸»é¡µç»‘å®š mainpage å‡½æ•°@app.route(&apos;/&apos;, methods=[&apos;GET&apos;,&apos;POST&apos;])def mainpage(): name = default_name# è¡¨å•æäº¤æ—¶ï¼ŒèŽ·å–ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œè°ƒç”¨ hashlib åº“å°†å…¶å˜æˆ hash å½¢å¼ï¼Œä¿å­˜åœ¨ name_hash å˜é‡ä¸­ if request.method == &apos;POST&apos;: name = request.form[&apos;name&apos;] name_hash = hashlib.sha256(name.encode()).hexdigest() header = &apos;&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar_Modified&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&apos; body = &apos;&apos;&apos;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt; &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;&#123;0&#125;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt; &lt;/form&gt; &lt;p&gt;You look like a: &lt;img src=&quot;/monster/&#123;1&#125;&quot;/&gt; &apos;&apos;&apos;.format(name, name_hash)# img æ ‡ç­¾çš„ src å±žæ€§ç”± name_hash çš„å€¼ç¡®å®šï¼Œå³ç½‘é¡µä¸­å›¾ç‰‡çš„æºè·¯å¾„æ ¹æ®ç”¨æˆ·è¾“å…¥è‡ªè¡Œæ›´æ–° footer = &apos;&lt;/body&gt;&lt;/html&gt;&apos; return header + body + footer# ç½‘é¡µä¸­å›¾ç‰‡çš„ URL ç»‘å®šç»™ get_avatar å‡½æ•°ï¼Œè¯¥å‡½æ•°é€šè¿‡ requests åº“è®¿é—® dnmonster å®¹å™¨ä¸­çš„ API ä»¥èŽ·å–â€œæ€ªå…½â€å›¾åƒ@app.route(&apos;/monster/&lt;name&gt;&apos;)def get_avatar(name): r = requests.get(&apos;http://dnmonster:8080/monster/&apos; + name + &apos;?size=200&apos;) image = r.content return Response(image, mimetype=&apos;image/png&apos;)if __name__ == &apos;__main__&apos;: app.run(debug=True, host=&apos;0.0.0.0&apos;) ç„¶åŽåœ¨ Dockerfile é‡Œæ·»åŠ ä¸Šå‰é¢ç”¨åˆ°çš„ requests æ¨¡å—123456789101112FROM python:3.6RUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgiRUN pip install Flask==1.0.2 uWSGI==2.0.17.1 requests==2.5.1WORKDIR /appCOPY app /appCOPY cmd.sh /EXPOSE 9090 9191USER uwsgiCMD [&quot;/cmd.sh&quot;] è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿è¡Œé¡¹ç›®ï¼š123456$ docker build -t avatar ....$ docker run -d --name dnmonster amouat/dnmonster48f77f0e0f7ac503b27786f73ea8d25fa4237eea042dfb5cc1331bb07001dae3$ docker run -d -p 5000:5000 -e &quot;ENV=DEV&quot; --link dnmonster:dnmonster avatar8cf94a54744f92c206917c474dc8619c417d7b7937fd6d38df3cd05d5813d5fd å…¶ä¸­ docker build å‘½ä»¤ç”¨äºŽé‡æ–°æž„å»ºå®¹å™¨ã€‚docker run -d --name dnmonster amouat/dnmonster å‘½ä»¤ç”¨äºŽåŠ è½½ dnmonster å®¹å™¨å¹¶æŒ‡å®šå…¶åç§°ï¼ˆ--nameï¼‰ä¸º dnmonster ã€‚docker run -d -p 5000:5000 -e &quot;ENV=DEV&quot; --link dnmonster:dnmonster avatar å‘½ä»¤ä¸­çš„ --link dnmonster:dnmonster é€‰é¡¹ç”¨äºŽå°† flask åº”ç”¨å®¹å™¨å’Œ dnmonster å®¹å™¨å…³è”èµ·æ¥ã€‚å…¶ä¸­ç¬¬ä¸€ä¸ª dnmonster ç”¨äºŽæŒ‡å®šå…³è”å®¹å™¨çš„åç§°ï¼Œç¬¬äºŒä¸ª dnmonster ç”¨äºŽæŒ‡å®šè¯¥å®¹å™¨çš„åˆ«åã€‚å…³è”åŽ flask åº”ç”¨å®¹å™¨å°±å¯ä»¥é€šè¿‡åˆ«åç›´æŽ¥è®¿é—® dnmonster å®¹å™¨ï¼Œè€Œæ— éœ€èŽ·çŸ¥å…¶ IP åœ°å€ï¼ˆæ‰€ä»¥æºæ–‡ä»¶ app/avatar.py ä¸­ get_avatar å‡½æ•°æ‰å¯ä»¥é€šè¿‡ http://dnmonster:8080/ ç±»ä¼¼çš„ URL è®¿é—® dnmonster çš„ APIï¼‰ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼šè¾“å…¥ä¸åŒçš„å­—ç¬¦ä¸²å¹¶æäº¤ï¼Œå°†å¾—åˆ°ä¸ä¸€æ ·çš„å¤´åƒå›¾ç‰‡ã€‚ ä½¿ç”¨ Docker Composeä¸Šé¢çš„ä¾‹å­è™½ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†è¿è¡Œé¡¹ç›®æ—¶æ‰‹åŠ¨è¾“å…¥ docker run å‘½ä»¤è¿‡äºŽç¹çã€‚å¯ä»¥é€šè¿‡ä¿®æ”¹ docker-compose.yml é…ç½®æ–‡ä»¶ï¼Œå€ŸåŠ© Compose çš„â€œè‡ªåŠ¨åŒ–â€ç®€åŒ–æ“ä½œæ­¥éª¤ã€‚ 12345678910111213avatar: build: . ports: - &quot;5000:5000&quot; environment: ENV: DEV volumes: - ./app:/app links: - dnmonsterdnmonster: image: amouat/dnmonster å…¶ä¸­ links é¡¹å®šä¹‰äº† avatar å®¹å™¨åˆ° dnmonster å®¹å™¨çš„å…³è”dnmonster åŠåŽé¢çš„å†…å®¹åˆ™å®šä¹‰äº† dnmonster å®¹å™¨çš„é…ç½®ä¿¡æ¯ï¼Œé€šè¿‡ image é¡¹æŒ‡å®šç”¨äºŽç”Ÿæˆè¯¥å®¹å™¨çš„é•œåƒæ–‡ä»¶ã€‚ åœæ­¢å¹¶åˆ é™¤ä¹‹å‰çš„å®¹å™¨ï¼Œé‡æ–°æž„å»ºè¿è¡Œé¡¹ç›®ï¼š123456789$ docker-compose build...$ docker-compose up -dCreating avatar_dnmonster_1 ... doneCreating avatar_avatar_1 ... done$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES1f85363c7ed4 avatar_avatar &quot;/cmd.sh&quot; 10 seconds ago Up 9 seconds 9090/tcp, 0.0.0.0:5000-&gt;5000/tcp, 9191/tcp avatar_avatar_15cca0f851ac5 amouat/dnmonster &quot;npm start&quot; 11 seconds ago Up 9 seconds 8080/tcp avatar_dnmonster_1 äº”ã€æ·»åŠ ç¼“å­˜æ”¯æŒï¼ˆRedisï¼‰å½“å‰çš„ flask åº”ç”¨ï¼Œæ¯èŽ·å–ä¸€æ¬¡â€œæ€ªå…½â€å¤´åƒï¼Œdnmonster æœåŠ¡å°±ä¼šæ”¶åˆ°ä¸€æ¬¡æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„è¯·æ±‚ã€‚ç”±äºŽé€šè¿‡ç‰¹å®šçš„è¾“å…¥ç”Ÿæˆçš„å›¾ç‰‡æ˜¯ä¿æŒä¸å˜çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ç¼“å­˜å¯¹åº”ç”¨è¿›è¡Œä¼˜åŒ–ã€‚ Redis æ˜¯ä¸€ç§åŸºäºŽå†…å­˜çš„ Key-Value ç±»åž‹çš„æ•°æ®åº“ï¼Œé€‚åˆæ­¤å¤„çš„åº”ç”¨åœºæ™¯ã€‚ æœ€ç»ˆçš„é¡¹ç›®æ–‡ä»¶ç»“æž„å¦‚ä¸‹ï¼š123456avatarâ”œâ”€â”€ appâ”‚ â””â”€â”€ avatar.pyâ”œâ”€â”€ cmd.shâ”œâ”€â”€ docker-compose.ymlâ””â”€â”€ Dockerfile app/avatar.py:1234567891011121314151617181920212223242526272829303132333435363738394041from flask import Flask, Response, requestimport requestsimport hashlibimport redisapp = Flask(__name__)cache = redis.StrictRedis(host=&apos;redis&apos;, port=6379, db=0)default_name = &apos;skitarniu&apos;@app.route(&apos;/&apos;, methods=[&apos;GET&apos;,&apos;POST&apos;])def mainpage(): name = default_name if request.method == &apos;POST&apos;: name = request.form[&apos;name&apos;] name_hash = hashlib.sha256(name.encode()).hexdigest() header = &apos;&lt;html&gt;&lt;head&gt;&lt;title&gt;Avatar_Modified&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&apos; body = &apos;&apos;&apos;&lt;form method=&quot;POST&quot;&gt; &lt;h3&gt;Hello&lt;/h3&gt; &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;&#123;0&#125;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt; &lt;/form&gt; &lt;p&gt;You look like a: &lt;img src=&quot;/monster/&#123;1&#125;&quot;/&gt; &apos;&apos;&apos;.format(name, name_hash) footer = &apos;&lt;/body&gt;&lt;/html&gt;&apos; return header + body + footer@app.route(&apos;/monster/&lt;name&gt;&apos;)def get_avatar(name): image = cache.get(name) if image is None: print(&quot;Cache miss&quot;, flush=True) r = requests.get(&apos;http://dnmonster:8080/monster/&apos; + name + &apos;?size=200&apos;) image = r.content cache.set(name, image) return Response(image, mimetype=&apos;image/png&apos;)if __name__ == &apos;__main__&apos;: app.run(debug=True, host=&apos;0.0.0.0&apos;) Dockerfile:123456789101112FROM python:3.6RUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgiRUN pip install Flask==1.0.2 uWSGI==2.0.17.1 requests==2.5.1 redis==2.10.6WORKDIR /appCOPY app /appCOPY cmd.sh /EXPOSE 9090 9191USER uwsgiCMD [&quot;/cmd.sh&quot;] docker-compose.yml:1234567891011121314151617avatar: build: . ports: - &quot;5000:5000&quot; environment: ENV: DEV volumes: - ./app:/app links: - dnmonster - redisdnmonster: image: amouat/dnmonsterredis: image: redis cmd.sh æ–‡ä»¶ä¿æŒä¹‹å‰çš„ç‰ˆæœ¬å³å¯ã€‚ç„¶åŽå°±å¯ä»¥å…ˆä½¿ç”¨ docker-compose stop å‘½ä»¤åœæ­¢ä¹‹å‰ç‰ˆæœ¬çš„å®¹å™¨ï¼Œå†ä½¿ç”¨ docker-compose build å’Œ docker-compose up -d å‘½ä»¤é‡æ–°æž„å»ºå¹¶è¿è¡Œæ–°ç‰ˆæœ¬çš„å®¹å™¨ã€‚ 1234567891011$ docker-compose builddnmonster uses an image, skippingredis uses an image, skippingBuilding avatar...Successfully built d1aa92c39f97Successfully tagged avatar_avatar:latest$ docker-compose up -dCreating avatar_redis_1 ... doneCreating avatar_dnmonster_1 ... doneCreating avatar_avatar_1 ... done å‚è€ƒèµ„æ–™Using Docker: Developing and Deploying Software with Containers]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>Development</tag>
        <tag>Docker</tag>
        <tag>Service</tag>
        <tag>Operation</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘èŽ“æ´¾ 3B+ è¿žæŽ¥ WPA2 ä¼ä¸šçº§åŠ å¯†çš„ WIFI]]></title>
    <url>%2F2018%2F10%2F16%2Fraspberry-pi-wifi-wpa2-eap%2F</url>
    <content type="text"><![CDATA[é™ªä¼´æˆ‘ä¸‰å¹´å¤šçš„æ ‘èŽ“æ´¾äºŒä»£ç›®å‰é˜µå­æŒ‚æŽ‰äº†ï¼Œç”µæºæŒ‡ç¤ºç¯å¼‚å¸¸ã€‚æƒ³ä¿®ï¼Œæ— ä»Žä¸‹æ‰‹ã€‚å«æ³ªé€åˆ«ï¼Œç„¶åŽä¹°äº†ä¸ªä¸‰ä»£ç›®ã€‚ã€‚ã€‚å·²ç»ç®—é©¾è½»å°±ç†Ÿäº†ã€‚ç›´æŽ¥åˆ·å¥½ç³»ç»Ÿï¼Œèµ°èµ·ã€‚ç»“æžœè¿ž WIFI çš„æ—¶å€™å‡ºäº†ç‚¹å°çŠ¶å†µ æ ‘èŽ“æ´¾ 3 ä»£ B+ å·²è‡ªå¸¦äº†è“ç‰™å’Œ WIFI æ¨¡å—ï¼Œä¸”æ”¯æŒ 2.4/5G HZ åŒé¢‘æ®µæ— çº¿ç½‘ç»œã€‚æœ¬ä»¥ä¸ºè¿žä¸‹ WIFI å°±æ˜¯åŠ¨åŠ¨æ‰‹æŒ‡çš„äº‹æƒ…ã€‚ååå…¬å¸æ˜¯ WPA2 ä¼ä¸šçº§åŠ å¯†çš„æ— çº¿ç½‘ï¼Œå›¾å½¢ç•Œé¢ä¸‹æ˜¾ç¤ºçš„ WIFI åç§°æ˜¯ç°è‰²çš„ï¼Œæ— æ³•ç›´æŽ¥è¿žæŽ¥ã€‚æ— å¥ˆåªå¥½é€šè¿‡å‘½ä»¤è¡Œé…ç½®ã€‚ æ ‘èŽ“æ´¾ç”¨çš„æ˜¯å½“å‰æœ€æ–°ç‰ˆæœ¬çš„ Raspbian ç³»ç»Ÿï¼ˆ2018-10-09ï¼‰ï¼Œæ— çº¿ç½‘ç»œé…ç½®æ–‡ä»¶ä¸º /etc/wpa_supplicant/wpa_supplicant.confã€‚æ‰€ä»¥ç›´æŽ¥å°† WIFI çš„è¿žæŽ¥ä¿¡æ¯è¡¥å……åˆ°è¯¥é…ç½®æ–‡ä»¶ä¸­å³å¯ã€‚ ä¸€ã€è¿žæŽ¥æ™®é€š WIFIè¿žæŽ¥â€œæœ€ç®€å•â€çš„ WIFI ï¼ˆå¦‚æ‰‹æœºçƒ­ç‚¹ï¼‰æ—¶é…ç½®å¦‚ä¸‹ï¼š12345678ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdevupdate_config=1country=CNnetwork=&#123; ssid=&quot;your_AP_name&quot; psk=&quot;password&quot;&#125; å…¶ä¸­ WIFI çš„è¿žæŽ¥ä¿¡æ¯ä¸»è¦æ˜¯ network é¡¹ä¸­çš„å†…å®¹ã€‚ å¤šä¸ª WIFI è®¾ç½®ä¼˜å…ˆçº§å¦‚æžœéœ€è¦åŒæ—¶é…ç½®å¤šä¸ª WIFI çš„è¿žæŽ¥å¹¶ä¸ºå…¶è®¾ç½®ä¼˜å…ˆçº§ï¼Œå¯å‚è€ƒä»¥ä¸‹é…ç½®ï¼š12345678910111213network=&#123; ssid=&quot;your_AP_name1&quot; psk=&quot;password1&quot; priority=1 id_str=&quot;Home1&quot;&#125;network=&#123; ssid=&quot;your_AP_name2&quot; psk=&quot;password2&quot; priority=2 id_str=&quot;Home2&quot;&#125; å…¶ä¸­ priority é¡¹ç”¨äºŽè®¾ç½®ä¼˜å…ˆçº§ï¼Œè¯¥å€¼è¶Šå¤§åˆ™ä¼˜å…ˆçº§è¶Šé«˜ã€‚ äºŒã€è¿žæŽ¥éšè— WIFIéšè— WIFI ä¸èƒ½è¢«è‡ªåŠ¨æœç´¢åˆ°ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ è¿žæŽ¥ã€‚12345network=&#123; ssid=&quot;your_AP_name&quot; scan_ssid=1 psk=&quot;password&quot;&#125; ä¸»è¦æ˜¯æ·»åŠ  scan_ssid=1 é¡¹ã€‚ ä¸‰ã€è¿žæŽ¥ WPA2 ä¼ä¸šçº§åŠ å¯†çš„ WIFIç¤ºä¾‹é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼ˆå°´å°¬ï¼Œä¸æ˜¯å¾ˆæ‡‚ã€‚ä½†æˆ‘æ˜¯å¯ä»¥è¿žçš„ã€‚ã€‚ï¼‰ï¼š1234567891011network=&#123; ssid=&quot;your_AP_name&quot; key_mgmt=WPA-EAP pairwise=CCMP TKIP group=CCMP TKIP eap=PEAP identity=&quot;your_username&quot; password=&quot;password&quot; phase1=&quot;peaplabel=auto pepver=auto&quot; phase2=&quot;MSCHAPV2&quot;&#125; æ›´å¤š wpa_supplicant.conf æ–‡ä»¶çš„é…ç½®å®žä¾‹å¯å‚è€ƒ man wap_supplicant.conf é™„å½•wpa_supplicant.conf æ–‡ä»¶çš„é…ç½®è¯´æ˜Žå¯å‚è€ƒè¿™ç¯‡åšå®¢ï¼ˆå†…å®¹å¤ªè¯¦ç»†äº†ï¼Œï¼Œæ²¡ç»†çœ‹ï¼‰]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Network</tag>
        <tag>IoT</tag>
        <tag>Wi-Fi</tag>
        <tag>RaspberryPi</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker åˆæŽ¢]]></title>
    <url>%2F2018%2F10%2F09%2Fdocker-beginning-guide%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å®¹å™¨ï¼ˆContainerï¼‰ç®€å•æ¥è¯´ï¼Œå®¹å™¨æ˜¯å¯¹åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–åº“çš„ä¸€ç§å°è£…ã€‚ ä¹çœ‹ä¸ŠåŽ»ï¼Œå®¹å™¨å°±åƒä¸€ä¸ªè½»é‡çº§çš„è™šæ‹Ÿæœºç³»ç»Ÿï¼ˆVMï¼‰ï¼Œä¹Ÿå°è£…äº†ä¸€ä¸ªæ“ä½œç³»ç»Ÿå®žä¾‹ç”¨æ¥è¿è¡ŒæŸäº›åº”ç”¨ç¨‹åºã€‚ç›¸æ¯”äºŽä¼ ç»Ÿçš„è™šæ‹Ÿæœºï¼Œå®¹å™¨çš„ä¼˜åŠ¿ä¸»è¦åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š å®¹å™¨ä¸Žå®¿ä¸»æœºå…±äº«èµ„æºï¼Œä½¿å¾—å…¶æ•ˆçŽ‡æœ‰äº†å¾ˆå¤§çš„æå‡ã€‚ä¸Žä¸»æœºä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºç›¸æ¯”ï¼Œåœ¨å®¹å™¨ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºå‡ ä¹Žæ²¡æœ‰ä»»ä½•é¢å¤–çš„å¼€é”€ã€‚ å®¹å™¨å¯ç§»æ¤çš„ç‰¹æ€§å¯ä»¥è§£å†³ç”±äºŽè¿è¡ŒçŽ¯å¢ƒçš„å¾®å°å˜åŒ–å¼•å‘çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚ å®¹å™¨çš„è½»é‡çº§ç‰¹æ€§æ„å‘³ç€å¼€å‘äººå‘˜å¯ä»¥åŒæ—¶è¿è¡Œæ•°åä¸ªå®¹å™¨ï¼Œä»Žè€Œå¯ä»¥æ¨¡æ‹Ÿå‡ºç”Ÿäº§çº§åˆ«çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ å¯¹äºŽä¸ä½¿ç”¨äº‘ç«¯åº”ç”¨çš„ç”¨æˆ·å’Œå¼€å‘è€…ï¼Œç”¨æˆ·å¯ä»¥èŠ‚çœä¸‹å¤§é‡çš„å®‰è£…å’Œé…ç½®æ—¶é—´ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒç³»ç»Ÿçš„ä¾èµ–å†²çªç­‰é—®é¢˜ã€‚è€Œå¼€å‘è€…åŒæ—¶ä¹Ÿå¯ä»¥é¿å…ç”±äºŽç”¨æˆ·ç³»ç»ŸçŽ¯å¢ƒçš„å·®å¼‚å¯¼è‡´çš„å¯ç”¨æ€§é—®é¢˜ã€‚ æ€»çš„æ¥è¯´ï¼Œè™šæ‹Ÿæœºçš„åŸºæœ¬ç›®æ ‡ï¼Œæ˜¯å®Œæ•´åœ°è™šæ‹Ÿå‡ºä¸€ä¸ªå¤–éƒ¨ï¼ˆç‹¬ç«‹ï¼‰çš„ç³»ç»ŸçŽ¯å¢ƒï¼Œè€Œå®¹å™¨æ˜¯ä¸ºäº†è¾¾åˆ°åº”ç”¨ç¨‹åºçš„å¯ç§»æ¤å’Œè‡ªæˆä¸€ä½“ã€‚ è€Œ Docker Engine ä¸ºè¿è¡Œå®¹å™¨æä¾›äº†å¿«æ·æ–¹ä¾¿çš„äº¤äº’æŽ¥å£ã€‚ äºŒã€Docker å®‰è£…ï¼ˆLinuxï¼‰Linux ç³»ç»Ÿä¸Šçš„ Docker å®‰è£…ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„å®‰è£…è„šæœ¬ï¼ˆhttps://get.docker.comï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š$ sudo wget -qO- https://get.docker.com/ | shæˆ–$ sudo curl -sSL https://get.docker.com/ | sh Mac OS å’Œ Windows ç³»ç»Ÿä¸Šçš„ Docker å®‰è£…ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ Docker for Mac å’Œ Docker for Windows Docker å®˜æ–¹é•œåƒè®¿é—®ç¼“æ…¢ï¼Œå¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘æä¾›çš„åŠ é€ŸæœåŠ¡ï¼ˆå‚è€ƒ é•œåƒåŠ é€Ÿå™¨ï¼‰ Docker éœ€è¦ç‰¹å®šçš„æƒé™æ‰èƒ½è¿è¡Œï¼Œå³æ™®é€šç”¨æˆ·æ‰§è¡Œ docker å‘½ä»¤æ—¶éœ€è¦åŠ ä¸Š sudo ã€‚12345678910$ docker versionClient: Version: 18.06.1-ce API version: 1.38 Go version: go1.10.3 Git commit: e68fc7a Built: Tue Aug 21 17:24:51 2018 OS/Arch: linux/amd64 Experimental: falseGot permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.38/version: dial unix /var/run/docker.sock: connect: permission denied å¯ä»¥å°†æœ¬åœ°ç”¨æˆ·æ·»åŠ åˆ° docker ç”¨æˆ·ç»„ä¸­ï¼ŒåŽç»­ä½¿ç”¨ docker å‘½ä»¤æ—¶å³æ— éœ€åŠ ä¸Š sudo å‰ç¼€ã€‚$ sudo usermod -aG docker &lt;username&gt;12345678910111213141516171819$ docker versionClient: Version: 18.06.1-ce API version: 1.38 Go version: go1.10.3 Git commit: e68fc7a Built: Tue Aug 21 17:24:51 2018 OS/Arch: linux/amd64 Experimental: falseServer: Engine: Version: 18.06.1-ce API version: 1.38 (minimum version 1.12) Go version: go1.10.3 Git commit: e68fc7a Built: Tue Aug 21 17:23:15 2018 OS/Arch: linux/amd64 Experimental: false ä¸‰ã€æ“ä½œå…¥é—¨Hello World1234567$ docker run debian echo &quot;Hello World&quot;Unable to find image &apos;debian:latest&apos; locallylatest: Pulling from library/debian05d1a5232b46: Pull completeDigest: sha256:07fe888a6090482fc6e930c1282d1edf67998a39a09a0b339242fbfa2b602fffStatus: Downloaded newer image for debian:latestHello World docker run å‘½ä»¤ç”¨äºŽåŠ è½½å®¹å™¨å¹¶æ‰§è¡ŒæŸä¸ªå‘½ä»¤ã€‚ä¸Šè¿°å‘½ä»¤ä¸­çš„ debian ç”¨äºŽæŒ‡å®šæ‰€ä½¿ç”¨çš„é•œåƒçš„åå­—ã€‚å¦‚æœ¬åœ°ç£ç›˜ä¸Šæ²¡æœ‰åä¸º debian çš„é•œåƒæ–‡ä»¶ï¼Œåˆ™ Docker ä¼šæ£€æŸ¥åœ¨çº¿çš„ Docker Hub å¹¶å°†æœ€æ–°ç‰ˆæœ¬çš„ Debian é•œåƒä¸‹è½½åˆ°æœ¬åœ°ã€‚ä¹‹åŽå°†ä¸‹è½½å¥½çš„é•œåƒè½¬åŒ–æˆè¿è¡Œçš„å®¹å™¨ï¼Œå¹¶åœ¨å®¹å™¨ä¸­æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚å‘½ä»¤æ‰§è¡Œå®Œæ¯•åŽï¼Œè¾“å‡ºçš„ç»“æžœä¼ é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œå®¹å™¨åœæ­¢è¿è¡Œã€‚ äº¤äº’å¼ Shell12345$ docker run -i -t debian /bin/bashroot@4af9c13b78d7:/# echo &quot;Hello from Container&quot;Hello from Containerroot@4af9c13b78d7:/# exitexit ä¸Šé¢çš„å‘½ä»¤ä¼šåœ¨å®¹å™¨ä¸­æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼ Shell ï¼ˆå°±åƒæ˜¯ ssh åˆ°äº†ä¸€ä¸ªè¿œç¨‹ä¸»æœºä¸Šï¼‰ã€‚-i å’Œ -t é€‰é¡¹è¡¨ç¤ºæ‰“å¼€ä¸€ä¸ªå·²ç»‘å®šäº† tty çš„äº¤äº’å¼ä¼šè¯ã€‚å½“ä½¿ç”¨ exit å‘½ä»¤é€€å‡º bash åŽï¼Œè¿è¡Œä¸­çš„å®¹å™¨ä¹Ÿä¼šåœæ­¢ã€‚ å¯ä»¥ä½¿ç”¨ docker start -i &lt;Container_name&gt; å‘½ä»¤å›žåˆ°äº¤äº’å¼ Shell ä¸­ åˆ—å‡º / åˆ é™¤å®¹å™¨docker ps å‘½ä»¤å¯ä»¥åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨åŠå…¶ç›¸å…³ä¿¡æ¯ï¼Œå¦‚å®¹å™¨IDã€ä½¿ç”¨çš„é•œåƒã€æ‰§è¡Œçš„å‘½ä»¤ã€åˆ›å»ºæ—¶é—´ã€å½“å‰çŠ¶æ€å’Œåç§°ç­‰ï¼ŒåŠ ä¸Š -a é€‰é¡¹åˆ™åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…å«å·²åœæ­¢è¿è¡Œçš„å®¹å™¨ï¼‰1234567$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES$$ docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESf74ed03352d3 debian &quot;/bin/bash&quot; 9 minutes ago Exited (0) 8 minutes ago mystifying_beaver45e9e3f3847b debian &quot;echo &apos;Hello World&apos;&quot; 9 minutes ago Exited (0) 9 minutes ago quirky_mirzakhani å¯ä»¥ä½¿ç”¨ docker rm &lt;Container_name&gt; å‘½ä»¤åˆ é™¤å·²åœæ­¢è¿è¡Œçš„å®¹å™¨ã€‚12345$ docker rm mystifying_beavermystifying_beaver$ docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES45e9e3f3847b debian &quot;echo &apos;Hello World&apos;&quot; 13 minutes ago Exited (0) 13 minutes ago quirky_mirzakhani docker rm -v $(docker ps -aq -f status=exited) å‘½ä»¤å¯ä»¥åˆ é™¤æ‰€æœ‰å·²åœæ­¢è¿è¡Œçš„å®¹å™¨ æ‰‹åŠ¨åˆ›å»ºé•œåƒæ–‡ä»¶ä»Ž Docker Hub ä¸Šæ‹‰å–çš„é•œåƒå¾ˆå¤šä¸ºåˆå§‹çš„ç²¾ç®€ç³»ç»Ÿï¼Œè¿è¡Œå®¹å™¨åŽï¼Œå¯ä»¥ç»™å®¹å™¨å†…çš„ç³»ç»Ÿå®‰è£…è½¯ä»¶å¹¶æäº¤æ›´æ”¹ï¼Œåšæˆæ–°çš„é•œåƒä¾›åŽæœŸä½¿ç”¨ã€‚ ä½¿ç”¨ docker run å‘½ä»¤è¿è¡Œå®¹å™¨å¹¶å®‰è£…è½¯ä»¶1234567891011121314$ docker run -it --name cowsay --hostname cowsay debian /bin/bashroot@cowsay:/# apt-get update...root@cowsay:/# apt-get install -y cowsay fortune...root@cowsay:/# /usr/games/fortune | /usr/games/cowsay ________________________&lt; Don&apos;t get to bragging. &gt; ------------------------ \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || || å…¶ä¸­ --name é€‰é¡¹ç”¨äºŽæŒ‡å®šå®¹å™¨çš„åç§°ï¼Œ--hostname é€‰é¡¹ç”¨äºŽæŒ‡å®šå®¹å™¨ç³»ç»Ÿçš„ä¸»æœºåã€‚ ä½¿ç”¨ docker commit å‘½ä»¤å°†å®¹å™¨è½¬æ¢æˆé•œåƒæ–‡ä»¶ã€‚123456$ docker commit cowsay test/cowsayimagesha256:2dcb2f4d09f824120db19f79d3bfbdb85c24d4888732bcc7eaae79f707d80e32$ docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEtest/cowsayimage latest 2dcb2f4d09f8 13 minutes ago 159MBdebian latest f2aae6ff5d89 3 weeks ago 101MB docker images å‘½ä»¤ç”¨æ¥æŸ¥çœ‹å·²åœ¨æœ¬åœ°çš„é•œåƒæ–‡ä»¶åŠå…¶ä¿¡æ¯ã€‚ ä½¿ç”¨ç”Ÿæˆçš„é•œåƒæ–‡ä»¶12345678910$ docker run test/cowsayimage /usr/games/fortune | /usr/games/cowsay _______________________________________/ Today is the first day of the rest of \\ the mess. / --------------------------------------- \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || || ä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒæ–‡ä»¶Dockerfile å…¶å®žå°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†åˆ›å»º Docker é•œåƒçš„ä¸€ç³»åˆ—æ­¥éª¤ã€‚ç›¸æ¯”äºŽæ‰‹åŠ¨åˆ›å»º Docker é•œåƒï¼Œä½¿ç”¨ Dockerfile è‡ªåŠ¨åœ°åˆ›å»ºé•œåƒæ–‡ä»¶ï¼ŒçœåŽ»äº†å¤§é‡é‡å¤çš„æ“ä½œï¼ŒåŒæ—¶ä¹Ÿä¾¿äºŽåˆ†äº«ç»™å…¶ä»–äººã€‚ ç¼–è¾‘ Dockerfile12$ mkdir cowsay &amp;&amp; cd cowsay$ vim Dockerfile ç„¶åŽåœ¨æ–°å»ºçš„ Dockerfile ä¸­å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š12FROM debian:wheezyRUN apt-get update &amp;&amp; apt-get install -y cowsay fortune å…¶ä¸­ FROM ç”¨äºŽæŒ‡å®šæž„å»ºæ—¶ä½¿ç”¨çš„åˆå§‹é•œåƒæ–‡ä»¶ï¼ŒRUN ç”¨äºŽæŒ‡å®šåœ¨é•œåƒä¸­æ‰§è¡Œçš„ Shell å‘½ä»¤ æž„å»ºé•œåƒå¹¶æµ‹è¯•ä½¿ç”¨ docker build å‘½ä»¤åˆ›å»º Docker é•œåƒï¼š 12345678910111213141516$ docker build -t test/cowsay-dockerfile .Sending build context to Docker daemon 2.048kBStep 1/2 : FROM debian:wheezywheezy: Pulling from library/debian703d6f3fb41c: Pull completeDigest: sha256:d00f167f8f2e70ecc2e0f5410a3cb74cd4ad720e33b9810da6a2dcfa81dccfc0Status: Downloaded newer image for debian:wheezy ---&gt; 94825a89630cStep 2/2 : RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune ---&gt; Running in efcf246bde0f...Setting up cowsay (3.03+dfsg1-4) ...Removing intermediate container efcf246bde0f ---&gt; 88e9a0f834cdSuccessfully built 88e9a0f834cdSuccessfully tagged test/cowsay-dockerfile:latest æµ‹è¯•åˆšæž„å»ºå¥½çš„ Docker é•œåƒï¼š123456789$ docker run test/cowsay-dockerfile /usr/games/cowsay &quot;Moo&quot; _____&lt; Moo &gt; ----- \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || || ENTRYPOINTDockerfile ä¸­çš„ ENTRYPOINT é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå®¹å™¨è¿è¡Œæ—¶è‡ªåŠ¨æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚å°† Dockerfile æ”¹ä¸ºå¦‚ä¸‹å†…å®¹å¹¶é‡æ–°æž„å»ºï¼š123FROM debian:wheezyRUN apt-get update &amp;&amp; apt-get install -y cowsay fortuneENTRYPOINT [&quot;/usr/games/cowsay&quot;] 1234567891011$ docker build -t test/cowsay-dockerfile ....$ docker run test/cowsay-dockerfile &quot;Moo&quot; _____&lt; Moo &gt; ----- \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || || è¿è¡Œä¸Šè¿°å®¹å™¨æ—¶åˆ™ä¸éœ€è¦å†æŒ‡å®šå‘½ä»¤ï¼ˆ/usr/games/cowsayï¼‰è€Œåªè¾“å…¥å‘½ä»¤çš„å‚æ•°å³å¯ã€‚ å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª entrypoint.sh è„šæœ¬ï¼š123456#!/bin/bashif [ $# -eq 0 ]; then /usr/games/fortune | /usr/games/cowsayelse /usr/games/cowsay &quot;$@&quot;fi ä¸Šè¿°å†…å®¹ä¸º Shell è„šæœ¬æ–‡ä»¶ï¼Œä¸ä½œè¯¦ç»†è§£é‡Šã€‚ä½œç”¨æ˜¯å½“ docker run æ²¡æœ‰ä¸ºå®¹å™¨ä¸­æ‰§è¡Œçš„å‘½ä»¤æä¾›å‚æ•°æ—¶ï¼Œæ‰§è¡Œ fortune | cowsay ï¼Œå¦‚æä¾›äº†å‚æ•°ï¼Œåˆ™æ‰§è¡Œ cowsay &lt;å‚æ•°&gt; å‘½ä»¤ã€‚ å°† entrypoint.sh æ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™ï¼šchmod +x entrypoint.shå°† Dockerfile æ”¹ä¸ºå¦‚ä¸‹ç‰ˆæœ¬ï¼š1234FROM debian:wheezyRUN apt-get update &amp;&amp; apt-get install -y cowsay fortuneCOPY entrypoint.sh /ENTRYPOINT [&quot;/entrypoint.sh&quot;] å…¶ä¸­ COPY é€‰é¡¹ç”¨æ¥å°†æœ¬åœ°ä¸»æœºä¸Šçš„æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿé‡Œï¼ˆç±»ä¼¼äºŽ cp å‘½ä»¤ï¼‰ æœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š123456789101112131415161718192021$ docker build -t test/cowsay-dockerfile ....$ docker run test/cowsay-dockerfile _________________________________________/ You don&apos;t become a failure until you&apos;re \\ satisfied with being one. / ----------------------------------------- \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || ||$ docker run test/cowsay-dockerfile Hello Moo ___________&lt; Hello Moo &gt; ----------- \ ^__^ \ (oo)\_______ (__)\ )\/\ ||----w | || || å››ã€åŸºæœ¬ä½¿ç”¨ç«¯å£è½¬å‘å‡å¦‚å®¹å™¨ä¸­è¿è¡Œç€ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œéœ€è¦å¤–éƒ¨ä¸–ç•Œå¯ä»¥è®¿é—®ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ docker çš„ -p æˆ– -P é€‰é¡¹ï¼Œå°†æœ¬åœ°ä¸»æœºçš„ç«¯å£è½¬å‘è‡³å®¹å™¨å†…çš„ç«¯å£ã€‚å¦‚ï¼š12345678910111213141516$ docker run -d -p 8000:80 nginxUnable to find image &apos;nginx:latest&apos; locallylatest: Pulling from library/nginx...Status: Downloaded newer image for nginx:latestbe1364f343ae7aff9d5a6f6040b5d6ca69363a4480f04548988dd798ab04ab7b$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESbe1364f343ae nginx &quot;nginx -g &apos;daemon ofâ€¦&quot; 8 seconds ago Up 7 seconds 0.0.0.0:8000-&gt;80/tcp quirky_mclean$ curl localhost:8000&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Welcome to nginx!&lt;/title&gt;...$ å…¶ä¸­ docker run -d -p 8000:80 nginx å‘½ä»¤ç”¨äºŽåœ¨åŽå°ï¼ˆ-d é€‰é¡¹ï¼‰å¯åŠ¨ä¸€ä¸ªç”±å®˜æ–¹ nginx é•œåƒåˆ›å»ºçš„å®¹å™¨ï¼Œå¹¶å°†æœ¬åœ°ä¸»æœºçš„ 8000 ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ 80 ç«¯å£ï¼ˆ-p 8000:80ï¼‰ï¼Œå³å®¹å™¨ä¸­ nginx æœåŠ¡è¿è¡Œçš„ç«¯å£ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½¿ç”¨ curl å‘½ä»¤è®¿é—®æœ¬åœ°ä¸»æœºçš„ 8000 ç«¯å£æ—¶ï¼Œç­‰åŒäºŽè®¿é—®äº†å®¹å™¨çš„ 80 ç«¯å£ï¼Œå³å®¹å™¨ä¸­çš„ nginx æœåŠ¡ã€‚ è€Œ -P é€‰é¡¹å¯ä»¥è‡ªåŠ¨é€‰æ‹©ç©ºé—²çš„ç«¯å£è¿›è¡Œè½¬å‘ï¼Œæ— éœ€æŒ‡å®šæœ¬åœ°ä¸»æœºæˆ–å®¹å™¨çš„ç«¯å£ã€‚å¯å‚è€ƒä»¥ä¸‹å®žä¾‹ï¼š123456789$ ID=$(docker run -d -P nginx)$ docker port $ID 800.0.0.0:32768$ curl localhost:32768&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Welcome to nginx!&lt;/title&gt;... å…³è”å®¹å™¨å®¹å™¨å…³è”å¯ä»¥å…è®¸åŒä¸€ä¸ªä¸»æœºä¸Šçš„å¤šä¸ªå®¹å™¨ç›¸äº’äº¤æ¢æ•°æ®ã€‚å½“ä½¿ç”¨é»˜è®¤çš„ç½‘ç»œæ¨¡åž‹æ—¶ï¼Œè¿™äº›å…³è”çš„å®¹å™¨é€šè¿‡å…¶â€œå†…éƒ¨â€ç½‘ç»œä¼ è¾“æ•°æ®ï¼Œå³å…³è”å®¹å™¨é—´çš„ç›¸äº’äº¤æµä¸ä¼šæš´éœ²ç»™æœ¬åœ°ä¸»æœºã€‚ å¯å‚è€ƒä»¥ä¸‹å®žä¾‹ï¼š1234567$ docker run --name myredis -d redisbe53967c42fd3292dfd59fd5d15e7025fa436816e46f6e7cbc3c47b06ddb0047$ docker run --rm -it --link myredis:redis redis /bin/bashroot@b27aca7d8c54:/data# redis-cli -h redis -p 6379redis:6379&gt; pingPONGredis:6379&gt; å…¶ä¸­ docker run --name myredis -d redis å‘½ä»¤ç”¨äºŽåœ¨åŽå°å¯åŠ¨ä¸€ä¸ª redis å®¹å™¨ï¼Œå¹¶å°†å…¶å‘½åä¸º myredis ã€‚åŒæ—¶è¿”å›žè¯¥å®¹å™¨çš„ ID åˆ°æ ‡å‡†è¾“å‡ºã€‚docker run --rm -it --link myredis:redis redis /bin/bash å‘½ä»¤ç”¨äºŽå¯åŠ¨å¦ä¸€ä¸ª redis å®¹å™¨ï¼Œå¹¶ä»¥äº¤äº’çš„æ–¹å¼è®¿é—®å…¶ Shell ï¼ˆ-it /bin/bashï¼‰ã€‚--rm é€‰é¡¹è¡¨ç¤ºè¯¥å®¹å™¨é€€å‡ºåŽå°†è‡ªåŠ¨åˆ é™¤ã€‚ å®¹å™¨å…³è”çš„æ“ä½œåˆ™ç”± --link myredis:redis é€‰é¡¹å®žçŽ°ã€‚è¡¨ç¤ºå°†æ–°å®¹å™¨å…³è”è‡³å·²å­˜åœ¨çš„ â€œmyredisâ€ å®¹å™¨ï¼Œå¹¶ä¸º â€œmyredisâ€ å®¹å™¨è®¾ç½®åˆ«åä¸º â€œredisâ€ ï¼Œå³å¯ä»¥åœ¨å½“å‰çš„æ–°å®¹å™¨ä¸­é€šè¿‡åˆ«åï¼ˆredisï¼‰è®¿é—®ã€‚ è¯¥é€‰é¡¹ä¼šåœ¨æ–°å®¹å™¨çš„ /etc/hosts æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡ä¸»æœºåä¸º redis çš„è®°å½•ï¼Œå¹¶å°†å…¶æŒ‡å‘ â€œmyredisâ€ å®¹å™¨çš„ IP åœ°å€ã€‚æ‰€ä»¥åœ¨å½“å‰å®¹å™¨çš„ Shell ä¸­ä½¿ç”¨ redis-cli å‘½ä»¤è®¿é—® â€œmyredisâ€ ä¸­çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥æ— éœ€æŒ‡å®šå…¶ IP åœ°å€ï¼Œç›´æŽ¥ä½¿ç”¨ä¸»æœºå â€œredisâ€ å³å¯ã€‚ï¼ˆredis-cli -h redis -P 6379ï¼‰ å­˜å‚¨å·å¯ä»¥åœ¨ä½¿ç”¨ docker run æ—¶é€šè¿‡ -v é€‰é¡¹æŒ‡å®šå­˜å‚¨å·ï¼š123456$ docker run -it --name container-test -h CONTAINER -v /data debian /bin/bashroot@CONTAINER:/# cd /data ; touch test-fileroot@CONTAINER:/data# lstest-fileroot@CONTAINER:/data# exitexit ä¸Šé¢çš„å‘½ä»¤ä¼šå°†å®¹å™¨ä¸­çš„ /data ç›®å½•å˜æˆä¸€ä¸ªå­˜å‚¨å·ï¼Œè¯¥ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶éƒ½ä¼šè¢«å¤åˆ¶åˆ°å·ä¸­ã€‚ å¯ä»¥ä½¿ç”¨ docker inspect å‘½ä»¤æŸ¥çœ‹è¯¥å­˜å‚¨å·åœ¨æœ¬åœ°ä¸»æœºä¸­çš„ä½ç½®ï¼š12$ docker inspect -f &#123;&#123;.Mounts&#125;&#125; container-test[&#123;volume 7ae1... /var/lib/docker/volumes/7ae1.../_data /data local true &#125;] å¯ä»¥åœ¨å­˜å‚¨å·å¯¹åº”äºŽæœ¬åœ°ä¸»æœºçš„ç›®å½•ï¼ˆ/var/lib/docker/volumes/7ae1.../_dataï¼‰ä¸­åˆ›å»ºæ–‡ä»¶ï¼Œå®¹å™¨ä¸­å¯¹åº”ç›®å½•ï¼ˆ/dataï¼‰ä¸‹åˆ™ä¼šç«‹å³å‡ºçŽ°åŒæ ·çš„æ–‡ä»¶ã€‚1234567$ sudo ls /var/lib/docker/volumes/7ae1.../_datatest-file$ sudo touch /var/lib/docker/volumes/7ae1.../_data/test-file2$ docker start -i container-testroot@CONTAINER:/# ls /datatest-file test-file2root@CONTAINER:/# å­˜å‚¨å·è¿˜å¯ä»¥é€šè¿‡ Dockerfile ä¸­çš„ VOLUME é€‰é¡¹æŒ‡å®šã€‚å¦‚ï¼šVOLUME /data å…±äº«æ•°æ®å¯ä»¥ä½¿ç”¨ -v HOST_DIR:CONTAINER_DIR é€‰é¡¹åœ¨æœ¬åœ°ä¸»æœºå’Œä¸€ï¼ˆæˆ–å¤šï¼‰ä¸ªå®¹å™¨é—´å…±äº«æ•°æ®ã€‚å¦‚ï¼š$ docker run -v /home/starky/data:/data debian ls /data è¯¥å‘½ä»¤ä¼šå°†æœ¬åœ°ä¸»æœºä¸Šçš„ /home/starky/data ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„ /data ç›®å½•ä¸‹ï¼Œæ‰€æœ‰å·²ç»å­˜åœ¨äºŽ /home/starky/data ç›®å½•ä¸‹çš„æ–‡ä»¶åœ¨å®¹å™¨ä¸­ä¹ŸåŒæ ·èƒ½å¤Ÿè¢«è®¿é—®ã€‚ä½†æ˜¯åŽŸæœ¬å­˜åœ¨äºŽå®¹å™¨çš„ /data ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ™è¢«éšè—ã€‚å¦‚æŸäº›é…ç½®æ–‡ä»¶å¯ä»¥ä¸€ç›´å­˜æ”¾åœ¨æœ¬åœ°ä¸»æœºä¸Šï¼Œå¹¶åœ¨éœ€è¦æ—¶æŒ‚è½½åˆ°é€šç”¨é•œåƒæž„å»ºçš„å®¹å™¨ä¸­ã€‚ å¯ä»¥ä½¿ç”¨ docker run å‘½ä»¤çš„ --volumes-from CONTAINER é€‰é¡¹åœ¨å®¹å™¨é—´å…±äº«æ•°æ®ã€‚å¦‚ï¼š1234$ docker run -it -h NEWCONTAINER --volumes-from container-test debian /bin/bashroot@NEWCONTAINER:/# ls /datatest-file test-file2root@NEWCONTAINER:/# ä¸Šé¢çš„å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œä¸”é€šè¿‡ --volumes-from é€‰é¡¹ï¼Œè¯¥å®¹å™¨å¯ä»¥è®¿é—®ä¹‹å‰çš„ container-test å®¹å™¨ä¸­çš„å­˜å‚¨å·ï¼ˆ/dataï¼‰ã€‚ æ•°æ®å®¹å™¨æ•°æ®å®¹å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®¹å™¨ï¼Œå…¶å”¯ä¸€ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿å…¶ä»–å®¹å™¨ä¹‹é—´å…±äº«æ•°æ®ã€‚å¦‚åˆ›å»ºä¸€ä¸ª PostgreSQL çš„æ•°æ®å®¹å™¨ï¼š$ docker run --name dbdata postgres echo &quot;Data-only container for postgres&quot;è¯¥å‘½ä»¤ç”¨äºŽä»Ž postgres é•œåƒåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¹¶åˆå§‹åŒ–é•œåƒé‡Œå®šä¹‰çš„å­˜å‚¨å·ã€‚ ä¹‹åŽå¯ä»¥é€šè¿‡ --volumes-from é€‰é¡¹ä½¿ç”¨æ•°æ®å®¹å™¨é‡Œçš„å­˜å‚¨å·ï¼š$ docker run -d --volumes-from dbdata --name db1 postgres å‚è€ƒèµ„æ–™Using Docker: Developing and Deploying Software with Containers]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Development</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux ç”¨æˆ·ç®¡ç†ç®€ä»‹]]></title>
    <url>%2F2018%2F09%2F05%2Flinux-user-management%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åˆ›å»ºç”¨æˆ·Linux ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ useradd å‘½ä»¤åˆ›å»ºæ–°ç”¨æˆ·ï¼š$ sudo useradd -m -c &#39;description&#39; &lt;username&gt; -m é€‰é¡¹è¡¨ç¤ºåˆ›å»ºç”¨æˆ·çš„åŒæ—¶è‡ªåŠ¨åœ¨ /home ç›®å½•ä¸‹åˆ›å»ºè¯¥ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆ/home/&lt;username&gt;ï¼‰ -c é€‰é¡¹ç”¨äºŽç»™æ–°ç”¨æˆ·æ·»åŠ æè¿°ï¼Œè¯¥æè¿°å°†ä¿å­˜åœ¨ /etc/passwd æ–‡ä»¶ä¸­ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–°åˆ›å»ºçš„ç”¨æˆ·å¹¶æœªåˆ†é…å¯†ç ï¼Œéœ€è¦ä½¿ç”¨ passwd &lt;username&gt; å‘½ä»¤ä¸ºæ–°ç”¨æˆ·è®¾ç½®å¯†ç ã€‚ PSï¼šåœ¨ä¸ºæ–°ç”¨æˆ·è‡ªåŠ¨åˆ›å»ºä¸»ç›®å½•æ—¶ï¼Œå¯ä»¥åŒæ—¶å¤åˆ¶ä¸€éƒ¨åˆ†åˆå§‹æ–‡ä»¶ï¼ˆå¦‚ .bashrcã€.vimrc ç­‰ï¼‰åˆ°è¯¥ç›®å½•ä¸‹ï¼Œå¤åˆ¶çš„æºæ–‡ä»¶é»˜è®¤ä½äºŽ /etc/skel ç›®å½•ä¸‹ã€‚å³åˆ›å»ºæ–°ç”¨æˆ·æ—¶ï¼Œ/etc/skel/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½å°†è‡ªåŠ¨å¤åˆ¶åˆ°æ–°ç”¨æˆ·çš„ä¸»ç›®å½•ä¸­ã€‚ åœ¨ Ubuntu ç³»ç»Ÿä¸­ï¼Œuseradd å‘½ä»¤é»˜è®¤ä¸è‡ªåŠ¨åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•ï¼Œæ‰€ä»¥éœ€è¦å¸¦ä¸Š -m é€‰é¡¹ã€‚è€Œ Centos ç³»ç»Ÿä¸­ï¼Œuseradd å‘½ä»¤é»˜è®¤ä¼šè‡ªåŠ¨åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•ï¼Œå¯ä»¥åŠ ä¸Š -M é€‰é¡¹è¡¨ç¤ºä¸åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•ã€‚ useradd çš„éƒ¨åˆ†å‘½ä»¤é€‰é¡¹ï¼š é€‰é¡¹ æè¿° -c, â€“comment æ·»åŠ ç”¨æˆ·æè¿° -d, â€“home-dir æŒ‡å®šç”¨æˆ·çš„ä¸»ç›®å½•ä½ç½® -m, â€“create-home è‡ªåŠ¨åˆ›å»ºç”¨æˆ·çš„ä¸»ç›®å½• -M, â€“no-create-home ä¸è‡ªåŠ¨åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•ï¼ˆCentOSï¼‰ -N, â€“no-user-group ä¸åˆ›å»ºåŒåçš„ç»„ -s, â€“shell æŒ‡å®šç”¨æˆ·ä½¿ç”¨çš„ shell -g, â€“gid æŒ‡å®šæ–°è´¦æˆ·ä¸»ç»„çš„åç§°æˆ– ID -G, â€“groups æŒ‡å®šæ–°è´¦æˆ·çš„é™„åŠ ç»„åˆ—è¡¨ -e, â€“expiredate æŒ‡å®šæ–°è´¦æˆ·çš„è¿‡æœŸæ—¥æœŸ -f, â€“inactive ç”¨æˆ·å¯†ç è¿‡æœŸåŽçš„é‡ç½®å¯†ç æœŸé™ -r, â€“system åˆ›å»ºä¸€ä¸ªç³»ç»Ÿè´¦æˆ· -k, â€“skel æŒ‡å®šéª¨æž¶ç›®å½•ï¼ˆé»˜è®¤ä¸º /etc/skelï¼‰ PSï¼šå…¶ä¸­çš„ INACTIVE å’Œ EXPIRE é€‰é¡¹ç”¨äºŽè®¾ç½®ç”¨æˆ·è´¦å·çš„è¿‡æœŸæ—¶é—´ã€‚INACTIVE ç”¨äºŽæŒ‡å®šä¸€ä¸ªæœŸé™ï¼ˆå•ä½ä¸ºå¤©ï¼‰ï¼Œåœ¨è¯¥æœŸé™å†…ï¼Œå¯†ç å¤±æ•ˆåŽçš„ç”¨æˆ·å¯ä»¥é‡ç½®è‡ªå·±çš„å¯†ç ã€‚è¯¥é€‰é¡¹å€¼ä¸º -1 æ—¶åˆ™ç¦ç”¨æ­¤ç‰¹æ€§ã€‚EXPIRE ç”¨äºŽæŒ‡å®šä¸€ä¸ªæˆªæ­¢æ—¥æœŸï¼ˆæ ¼å¼ä¸º YYYY-MM-DDï¼‰ï¼Œè¶…è¿‡è¯¥æœŸé™åŽç”¨æˆ·è´¦å·å³è¢«ç¦ç”¨ã€‚ $ sudo useradd -e 2018-10-01 temp_account # åˆ›å»ºä¸€ä¸ªä¸´æ—¶è´¦æˆ· ç”¨æˆ·é»˜è®¤è®¾ç½®æ–°ç”¨æˆ·åœ¨åˆ›å»ºæ—¶ä¼šä½¿ç”¨ä¸€äº›é¢„å…ˆå®šä¹‰çš„é»˜è®¤è®¾ç½®ï¼Œuseradd å‘½ä»¤ä»Ž /etc/default/useradd æ–‡ä»¶ä¸­èŽ·å–è¿™äº›é»˜è®¤è®¾ç½®ã€‚å½“å‰çš„é»˜è®¤é…ç½®å¯ä»¥é€šè¿‡ useradd -D å‘½ä»¤æ˜¾ç¤ºï¼š12345678$ useradd -DGROUP=100HOME=/homeINACTIVE=-1EXPIRE=SHELL=/bin/bashSKEL=/etc/skelCREATE_MAIL_SPOOL=no å¯ä»¥ç›´æŽ¥é€šè¿‡ useradd -D å‘½ä»¤ä¿®æ”¹ useradd çš„é»˜è®¤è®¾ç½®ï¼Œå¦‚ï¼š$ sudo useradd -D -s /bin/bash # å°†æ–°å»ºç”¨æˆ·çš„é»˜è®¤ shell è®¾ç½®ä¸º /bin/bash äºŒã€ç”¨æˆ·ç»„åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œä»»ä½•ä¸€ä¸ªç”¨æˆ·éƒ½å¿…é¡»å±žäºŽè‡³å°‘ä¸€ä¸ªç”¨æˆ·ç»„ã€‚å¯¹äºŽå¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼Œåˆ›å»ºæ–°ç”¨æˆ·æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåŒåçš„ç”¨æˆ·ç»„ã€‚åˆå§‹åˆ›å»ºçš„åŒåç”¨æˆ·ç»„å«åšåŸºç¡€å±žç»„ï¼ˆprimary groupï¼‰ï¼Œç”¨æˆ·è¿˜å¯ä»¥åŒæ—¶å±žäºŽå…¶ä»–ç”¨æˆ·ç»„ï¼Œè¿™äº›ç”¨æˆ·ç»„å«åšé™„åŠ å±žç»„ï¼ˆsupplementary groupï¼‰ã€‚å¦‚ï¼š12$ id starkyuid=1000(starky) gid=1000(starky) ç»„=1000(starky),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lpadmin),122(sambashare) æ¯ä¸€ä¸ªç”¨æˆ·å’Œç”¨æˆ·ç»„åœ¨åˆ›å»ºæ—¶éƒ½ä¼šå…³è”äºŽä¸€ä¸ªå”¯ä¸€çš„ UID å’Œ GIDã€‚UID å’Œ GID çš„å–å€¼èŒƒå›´éƒ½æ˜¯ 0-65535 ã€‚root ç”¨æˆ·çš„ UID å’Œ GID æ°¸è¿œéƒ½æ˜¯ 0 ã€‚12$ id rootuid=0(root) gid=0(root) ç»„=0(root Ubuntu ç³»ç»Ÿä¸­ 1-99 çš„ ID åªç”¨äºŽåˆ†é…ç»™ç³»ç»Ÿç”¨æˆ·ï¼ˆå¦‚è¿è¡ŒæœåŠ¡çš„ www-dataï¼‰ï¼Œ100-999 åˆ™åŠ¨æ€åœ°åˆ†é…ç»™ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹çš„ç”¨æˆ·ï¼ˆåœ¨åˆ›å»ºç”¨æˆ·æ—¶ä½¿ç”¨ --system é€‰é¡¹ï¼‰ã€‚è€Œç¬¬ä¸€ä¸ªæ™®é€šç”¨æˆ·åˆ™åˆ†é…å€¼ä¸º 1000 çš„ UID å’Œ GIDã€‚ ä½¿ç”¨ useradd å‘½ä»¤åˆ›å»ºæ–°ç”¨æˆ·æ—¶ï¼Œå¯ä»¥åŒæ—¶ä¸ºè¯¥ç”¨æˆ·å…³è”é™„åŠ å±žç»„ã€‚ç”¨æˆ·åˆ›å»ºå®ŒæˆåŽä¹Ÿå¯ä»¥ä½¿ç”¨ usermod å‘½ä»¤ä¿®æ”¹è¯¥ç”¨æˆ·çš„é™„åŠ å±žç»„ã€‚å¦‚ï¼š1234567$ sudo useradd test -G lpadmin,sambashare # åˆ›å»ºç”¨æˆ· test å¹¶å°†å…¶æ·»åŠ è‡³ lpadmin å’Œ sambashare ç»„$ id testuid=1004(test) gid=1004(test) ç»„=1004(test),116(lpadmin),122(sambashare)$$ sudo usermod test -a -G sudo # å°†ç”¨æˆ· test æ·»åŠ ï¼ˆ-aï¼‰è‡³ sudo ç”¨æˆ·ç»„$ id testuid=1004(test) gid=1004(test) ç»„=1004(test),27(sudo),116(lpadmin),122(sambashare) usermod å‘½ä»¤ç”¨äºŽä¿®æ”¹å·²ç»å­˜åœ¨çš„ç”¨æˆ·ã€‚å¸¸ç”¨å‘½ä»¤é€‰é¡¹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223$ usermodç”¨æ³•ï¼šusermod [é€‰é¡¹] ç™»å½•é€‰é¡¹ï¼š -c, --comment æ³¨é‡Š GECOS å­—æ®µçš„æ–°å€¼ -d, --home HOME_DIR ç”¨æˆ·çš„æ–°ä¸»ç›®å½• -e, --expiredate EXPIRE_DATE è®¾å®šå¸æˆ·è¿‡æœŸçš„æ—¥æœŸä¸º EXPIRE_DATE -f, --inactive INACTIVE è¿‡æœŸ INACTIVE å¤©æ•°åŽï¼Œè®¾å®šå¯†ç ä¸ºå¤±æ•ˆçŠ¶æ€ -g, --gid GROUP å¼ºåˆ¶ä½¿ç”¨ GROUP ä¸ºæ–°ä¸»ç»„ -G, --groups GROUPS æ–°çš„é™„åŠ ç»„åˆ—è¡¨ GROUPS -a, --append GROUP å°†ç”¨æˆ·è¿½åŠ è‡³ä¸Šè¾¹ -G ä¸­æåˆ°çš„é™„åŠ ç»„ä¸­ï¼Œ å¹¶ä¸ä»Žå…¶å®ƒç»„ä¸­åˆ é™¤æ­¤ç”¨æˆ· -h, --help æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º -l, --login LOGIN æ–°çš„ç™»å½•åç§° -L, --lock é”å®šç”¨æˆ·å¸å· -m, --move-home å°†å®¶ç›®å½•å†…å®¹ç§»è‡³æ–°ä½ç½® (ä»…ä¸Ž -d ä¸€èµ·ä½¿ç”¨) -o, --non-unique å…è®¸ä½¿ç”¨é‡å¤çš„(éžå”¯ä¸€çš„) UID -p, --password PASSWORD å°†åŠ å¯†è¿‡çš„å¯†ç  (PASSWORD) è®¾ä¸ºæ–°å¯†ç  -R, --root CHROOT_DIR chroot åˆ°çš„ç›®å½• -s, --shell SHELL è¯¥ç”¨æˆ·å¸å·çš„æ–°ç™»å½• shell -u, --uid UID ç”¨æˆ·å¸å·çš„æ–° UID -U, --unlock è§£é”ç”¨æˆ·å¸å· -Z, --selinux-user SEUSER ç”¨æˆ·è´¦æˆ·çš„æ–° SELinux ç”¨æˆ·æ˜ å°„ å…·ä½“å¯å‚è€ƒå‘½ä»¤ï¼šman usermod ä¸‰ã€åˆ é™¤ç”¨æˆ·ï¼ˆç»„ï¼‰userdel å‘½ä»¤å¯ç”¨äºŽåˆ é™¤ç”¨æˆ·ï¼Œgroupdel å‘½ä»¤å¯ç”¨äºŽåˆ é™¤ç”¨æˆ·ç»„ã€‚é»˜è®¤ä¸å¸¦é€‰é¡¹çš„ userdel å‘½ä»¤åªä¼šåˆ é™¤ç”¨æˆ·ï¼Œå¹¶ä¸ä¼šåŒæ—¶åˆ é™¤è¯¥ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆå¯ä»¥é€šè¿‡åŠ ä¸Š -r é€‰é¡¹å¼ºåˆ¶åˆ é™¤ç”¨æˆ·ä¸»ç›®å½•ï¼‰ã€‚ åˆ é™¤æŸä¸ªç”¨æˆ·åŽï¼Œæ‰€æœ‰åŽŸæœ¬å±žäºŽè¯¥ç”¨æˆ·çš„æ–‡ä»¶éƒ½å°†å¤±åŽ»å±žä¸»ï¼Œè€Œè¢«å¯¹åº”çš„ UID æ‰€ä»£æ›¿ã€‚å¦‚æžœä¹‹åŽåˆæ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè€Œè¯¥ç”¨æˆ·ä½¿ç”¨äº†ä¹‹å‰å·²åˆ é™¤è´¦æˆ·çš„ UIDï¼Œåˆ™æ–°è´¦æˆ·ä¼šæ›¿ä»£å·²åˆ é™¤çš„è´¦æˆ·å¹¶èŽ·å–å…¶æ–‡ä»¶çš„æƒé™ã€‚ å¯ä»¥ä½¿ç”¨ find / -user UID -o -group GID å‘½ä»¤å®šä½å·²åˆ é™¤è´¦æˆ·æ‹¥æœ‰çš„æ‰€æœ‰æ–‡ä»¶ å››ã€å¯†ç ä½¿ç”¨ useradd å‘½ä»¤åˆ›å»ºæ–°ç”¨æˆ·æ—¶ï¼Œæ˜¯ä¸è‡ªåŠ¨æç¤ºåˆ›å»ºå¯†ç çš„ï¼ˆUbuntuç³»ç»Ÿä¸­çš„ adduser å‘½ä»¤å¯ä»¥äº¤äº’åœ°åˆ›å»ºæ–°ç”¨æˆ·ï¼‰ã€‚éœ€è¦ä½¿ç”¨ passwd å‘½ä»¤ä¸ºç”¨æˆ·è®¾ç½®æˆ–ä¿®æ”¹å¯†ç ã€‚ å¯†ç æ—¶æ•ˆå¯ä»¥ä½¿ç”¨ chage å‘½ä»¤è®¾ç½®ç”¨æˆ·å¯†ç çš„æœ‰æ•ˆæœŸé™ï¼Œå¦‚ï¼š$ sudo chage -M 30 test30 å¤©åŽï¼Œç”¨æˆ· test çš„å¯†ç å°†ä¼šè¿‡æœŸï¼Œå¹¶æ”¶åˆ°æç¤ºéœ€è¦è¾“å…¥æ–°çš„å¯†ç ã€‚ chage å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹ï¼š|é€‰é¡¹|æè¿°||-|-||-m days|è®¾ç½®ç”¨æˆ·ä¿®æ”¹å¯†ç çš„æœ€å°é—´éš”æ—¶é—´ï¼Œå€¼ä¸º 0 æ—¶è¡¨ç¤ºå¯ä»¥åœ¨ä»»ä½•æ—¶é—´ä¿®æ”¹å¯†ç ||-M days|è®¾ç½®å¯†ç ä¿æŒæœ‰æ•ˆçš„æœ€é•¿æœŸé™ï¼Œå³ä¿®æ”¹å¯†ç çš„æœ€å¤§é—´éš”æ—¶é—´||-E date|è®¾ç½®ç”¨æˆ·è´¦æˆ·è¿‡æœŸå¹¶è‡ªåŠ¨è¢«ç¦ç”¨çš„æ—¥æœŸ||-W days|è®¾ç½®å¯†ç è¿‡æœŸå‰å¤šå°‘å¤©ç”¨æˆ·è¢«è­¦å‘Šéœ€è¦ä¿®æ”¹å¯†ç ||-I days|è®¾ç½®å¯†ç å¤±æ•ˆå¤šé•¿æ—¶é—´åŽè´¦æˆ·è¢«é”å®š| ä¸å¸¦ä»»ä½•é€‰é¡¹çš„ chage å‘½ä»¤å¯ä»¥äº¤äº’åœ°ä¿®æ”¹å¯†ç æ—¶æ•ˆï¼š1234567891011$ sudo chage testæ­£åœ¨ä¸º test ä¿®æ”¹å¹´é¾„ä¿¡æ¯è¯·è¾“å…¥æ–°å€¼ï¼Œæˆ–ç›´æŽ¥æ•²å›žè½¦é”®ä»¥ä½¿ç”¨é»˜è®¤å€¼ æœ€å°å¯†ç å¹´é¾„ [0]: æœ€å¤§å¯†ç å¹´é¾„ [99999]: 60 æœ€è¿‘ä¸€æ¬¡å¯†ç ä¿®æ”¹æ—¶é—´ (YYYY-MM-DD) [2018-09-03]: å¯†ç è¿‡æœŸè­¦å‘Š [7]: å¯†ç å¤±æ•ˆ [-1]: å¸æˆ·è¿‡æœŸæ—¶é—´ (YYYY-MM-DD) [-1]:$ ç”¨æˆ·å¯ä»¥ä½¿ç”¨ chage -l å‘½ä»¤æŸ¥çœ‹è‡ªå·±çš„å¯†ç æ—¶æ•ˆè®¾ç½®ï¼š12345678chage -l testæœ€è¿‘ä¸€æ¬¡å¯†ç ä¿®æ”¹æ—¶é—´ ï¼š 9æœˆ 03, 2018å¯†ç è¿‡æœŸæ—¶é—´ ï¼š 11æœˆ 02, 2018å¯†ç å¤±æ•ˆæ—¶é—´ ï¼š ä»Žä¸å¸æˆ·è¿‡æœŸæ—¶é—´ ï¼š ä»Žä¸ä¸¤æ¬¡æ”¹å˜å¯†ç ä¹‹é—´ç›¸è·çš„æœ€å°å¤©æ•° ï¼š0ä¸¤æ¬¡æ”¹å˜å¯†ç ä¹‹é—´ç›¸è·çš„æœ€å¤§å¤©æ•° ï¼š60åœ¨å¯†ç è¿‡æœŸä¹‹å‰è­¦å‘Šçš„å¤©æ•° ï¼š7 è´¦æˆ·ç¦ç”¨å¯ä»¥ä½¿ç”¨ passwd -l &lt;user&gt; å‘½ä»¤ç¦ç”¨ç”¨æˆ·è´¦å·ï¼Œä½¿ç”¨ passwd -u &lt;user&gt; å‘½ä»¤è§£é™¤è´¦æˆ·ç¦ç”¨ã€‚ä½†æ˜¯è¿™ä¸ªå‘½ä»¤å¹¶ä¸èƒ½å®Œå…¨ç¦æ­¢ç”¨æˆ·çš„è®¿é—®ï¼ˆå¦‚è¯¥ç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡ SSH è¿œç¨‹ç™»å½•ä¸»æœºï¼‰ã€‚ å¦‚éœ€å®Œå…¨ç¦ç”¨æŸç”¨æˆ·ï¼Œå¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼šsudo usermod --expiredate 1 &lt;user&gt;è¯¥å‘½ä»¤ä¼šå°†ç”¨æˆ·è´¦å·çš„å¤±æ•ˆæ—¥æœŸè®¾ç½®ä¸º 1970 å¹´ 1æœˆ 1 æ—¥ï¼ˆå³ç«‹å³ç¦ç”¨ï¼‰ã€‚ æˆ–è€…å°†ç”¨æˆ·ç™»å½•æ—¶çš„ shell ä¿®æ”¹ä¸º /bin/false æˆ– /usr/sbin/nologinã€‚$ sudo usermod -s /bin/false &lt;user&gt;è¯¥å‘½ä»¤ä¸ä¼šé”å®šè´¦æˆ·ï¼Œä½†è¯¥è´¦æˆ·å¯¹ shell çš„è®¿é—®å·²è¢«é™åˆ¶ã€‚ äº”ã€ç”¨æˆ·ä¿¡æ¯Linux ç³»ç»Ÿå°†ç”¨æˆ·ã€ç¾¤ç»„ç­‰ä¿¡æ¯ä¿å­˜åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶ä¸­ï¼š/etc/passwdã€/etc/shadowã€/etc/groupã€‚ /etc/passwd æ–‡ä»¶ä¸­åŒ…å«äº†æ‰€æœ‰ç”¨æˆ·çš„åˆ—è¡¨åŠè¯¦ç»†ä¿¡æ¯ï¼š1234567root:x:0:0:root:/root:/bin/bash...starky:x:1000:1000:starky,,,:/home/starky:/bin/bashsshd:x:112:65534::/run/sshd:/usr/sbin/nologinpostgres:x:113:123:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bashskitar:x:1001:1001::/home/skitar:/bin/bashmysql:x:114:124:MySQL Server,,,:/nonexistent:/bin/false è¯¥æ–‡ä»¶çš„æ ¼å¼ä¸ºï¼šusername:password:UID:GID:GECOS:Home:Shellå…¶ä¸­çš„ password é¡¹éƒ½ä¸º x ï¼Œè€Œå®žé™…çš„å¯†ç ä¿å­˜åœ¨ /etc/shadow æ–‡ä»¶ä¸­ã€‚ /etc/group æ–‡ä»¶çš„æ ¼å¼ä¸ºï¼šgroupname:password:GID:member,member å…­ã€sudosudo å‘½ä»¤å¯ä»¥ä½¿æ™®é€šç”¨æˆ·ä»¥ root ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚ä½¿ç”¨ useradd å‘½ä»¤æ–°å»ºçš„ç”¨æˆ·é»˜è®¤æ²¡æœ‰ä½¿ç”¨ sudo å‘½ä»¤çš„æƒé™ï¼Œéœ€è¦å…ˆå°†å…¶åŠ å…¥ sudo ç”¨æˆ·ç»„ã€‚$ sudo usermod &lt;user&gt; -a -G sudo sudo çš„æœ¬æ„æ˜¯ä»¥å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚å¯ä»¥ä½¿ç”¨ -u é€‰é¡¹æŒ‡å®šâ€œå…¶ä»–â€èº«ä»½ã€‚é»˜è®¤å³ä¸º root ç”¨æˆ·ã€‚ é…ç½® sudosudo å‘½ä»¤é€šè¿‡æ£€æŸ¥ /etc/sudoers ä¸­çš„é…ç½®æ¥ç¡®å®šæŽˆæƒè§„åˆ™ã€‚å¯ä»¥é€šè¿‡ç¼–è¾‘ sudoers æ–‡ä»¶å°† sudo çš„æŽˆæƒé™åˆ¶ä¸ºæŒ‡å®šçš„ç”¨æˆ·ï¼ŒæŒ‡å®šçš„ä¸»æœºï¼Œæˆ–åªèƒ½æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ã€‚sudoers æ–‡ä»¶çš„æ ¼å¼ä¸ºï¼šusername host = commandå¦‚ï¼štest ALL=/bin/userdel,/bin/useradd å¯ä»¥å°†æŽˆæƒä½¿ç”¨çš„å‘½ä»¤é™å®šä¸ºæŸä¸ªç›®å½•ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼ˆä½†ä¸åŒ…å«å…¶å­ç›®å½•ï¼‰ï¼Œå¦‚ï¼štest ALL=/bin/*,/sbin/* æœ‰äº›æ—¶å€™éœ€è¦å°†ä½¿ç”¨æŸä¸ªå‘½ä»¤çš„æƒé™æŽˆäºˆä¸€ä¸ªç”¨æˆ·ï¼Œä½†è¯¥å‘½ä»¤åˆéœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ‰§è¡Œï¼ˆå¦‚ MySQL çš„ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ï¼‰ã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ ¼å¼ï¼štest ALL=(mysql) /usr/bin/mysqld è¿˜å¯ä»¥é€šè¿‡ç”¨æˆ·ç»„ä¿¡æ¯å®Œæˆå¯¹ sudo çš„æŽˆæƒï¼š%groupname ALL=(ALL) ALLä¸Šé¢çš„é…ç½®è¡¨ç¤ºè¯¥ç»„çš„æ‰€æœ‰ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•ä¸»æœºä½¿ç”¨ sudo æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ åˆ«åè®¾ç½®/etc/sudoers æ–‡ä»¶ä¸­å…è®¸å®šä¹‰å’Œä½¿ç”¨åˆ«åï¼ŒåŒ…æ‹¬ç”¨æˆ·åˆ«åï¼ˆUser_Aliasï¼‰ã€ä¸»æœºåˆ«åï¼ˆHost_Aliasï¼‰å’Œå‘½ä»¤åˆ«åï¼ˆCmnd_Aliasï¼‰ã€‚å¦‚ï¼š123User_Alias ADMIN = skitar,testCmnd_Alias USER_COMMANDS = /bin/userdel,/bin/useraddADMIN ALL=/bin/groupadd,USER_COMMANDS ä¸Šé¢çš„é…ç½®è¡¨ç¤ºç”¨æˆ· skitar å’Œ test å¯ä»¥åœ¨æ‰€æœ‰ä¸»æœºä¸Šé€šè¿‡ sudo æ‰§è¡Œ userdelã€useradd å’Œ groupadd å‘½ä»¤ã€‚ è¿˜å¯ä»¥åœ¨åˆ«åå‰åŠ ä¸Šæ„Ÿå¹å·ï¼ˆ!ï¼‰è¡¨ç¤ºæ‹’ç»ï¼š12Cmnd_Alias DENIED_COMMANDS = /bin/su,/bin/mount/,/bin/umounttest ALL=/bin/*,!DENIED_COMMANDS ä¸Šé¢çš„é…ç½®è¡¨ç¤º test ç”¨æˆ·å¯ä»¥åœ¨æ‰€æœ‰ä¸»æœºä¸Šé€šè¿‡ sudo æ‰§è¡Œé™¤äº† suã€mount å’Œ umount ä»¥å¤–çš„æ‰€æœ‰ /bin ç›®å½•ä¸‹çš„å‘½ä»¤ã€‚ å‚è€ƒèµ„æ–™Pro Linux System Administration: Learn to Build Systems for Your Business Using Free and Open Source Software 2nd Edition]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Glances - Linux ä¸Šçš„å®žæ—¶ç³»ç»Ÿç›‘æŽ§å·¥å…·]]></title>
    <url>%2F2018%2F08%2F24%2Fuse-glances-monitor-system%2F</url>
    <content type="text"><![CDATA[Glances æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ã€åŸºäºŽå‘½ä»¤è¡Œçš„ç³»ç»Ÿç›‘æŽ§å·¥å…·ï¼Œç”± Python è¯­è¨€ç¼–å†™ï¼Œä½¿ç”¨ Python çš„ psutil åº“æ¥æŠ“å–ç³»ç»Ÿæ•°æ®ã€‚å¯ä»¥ç›‘æŽ§ CPUã€è´Ÿè½½å‡è¡¡ã€å†…å­˜ã€ç½‘ç»œè®¾å¤‡ã€ç£ç›˜ I/Oã€è¿›ç¨‹å’Œæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ç­‰ã€‚ ä¸€ã€è¾“å‡ºä¿¡æ¯æ¦‚è§ˆ CPU ä¿¡æ¯ï¼ˆç”¨æˆ·åº”ç”¨ã€ç³»ç»Ÿæ ¸å¿ƒç¨‹åºã€é—²ç½®ï¼‰ å†…å­˜ä¿¡æ¯ï¼ŒåŒ…æ‹¬ RAMã€äº¤æ¢ç©ºé—´ã€é—²ç½®å†…å­˜ç­‰ CPU çš„å¹³å‡è´Ÿè½½ï¼ˆè¿‡åŽ» 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿï¼‰ ç½‘ç»œè¿žæŽ¥çš„ä¸‹è½½ / ä¸Šä¼ é€ŸçŽ‡ è¿›ç¨‹æ€»æ•°ï¼ˆrunningã€sleeping ç­‰ï¼‰ ç£ç›˜ I/O è¯»å†™é€Ÿåº¦ å½“å‰å·²æŒ‚è½½è®¾å¤‡çš„ç£ç›˜ç©ºé—´ä½¿ç”¨ é«˜èµ„æºå ç”¨çš„è¿›ç¨‹ï¼ŒåŠå…¶ CPU/å†…å­˜å ç”¨ã€PIDã€çŠ¶æ€ç­‰ åº•éƒ¨æ˜¾ç¤ºå½“å‰æ—¶é—´ å°†èµ„æºæ¶ˆè€—è¿‡é«˜çš„è¿›ç¨‹çº¢è‰²é«˜äº®æ˜¾ç¤º äºŒã€è½¯ä»¶å®‰è£…Glances ä¸€èˆ¬å·²é›†æˆåˆ°å¤§å¤šæ•° Linux å‘è¡Œç‰ˆçš„å®˜æ–¹è½¯ä»¶æºä¸­ã€‚å¯ä»¥ç›´æŽ¥ä½¿ç”¨ç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ apt-getã€yumï¼‰å®‰è£…ï¼šsudo apt-get install glanceså½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ Python çš„åŒ…ç®¡ç†å™¨ï¼ˆpip å‘½ä»¤ï¼‰è¿›è¡Œå®‰è£…ï¼špip install glances é»˜è®¤æƒ…å†µä¸‹ï¼Œç›‘æŽ§ä¿¡æ¯çš„åˆ·æ–°æ—¶é—´ä¸º 1 ç§’é’Ÿã€‚å¯ä»¥ä½¿ç”¨ -t é€‰é¡¹è‡ªå®šä¹‰é—´éš”æ—¶é—´ï¼šglances -t 2 Glances æœ‰ 4 ç§é¢œè‰²æ ‡è®°ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸åŒçš„ç´§æ€¥ç¨‹åº¦ï¼š ç»¿è‰²ï¼šOK è“è‰²ï¼šCAREFUL ç´«è‰²ï¼šWARNING çº¢è‰²ï¼šCRITICAL å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ï¼ˆé»˜è®¤ä¸º /etc/glances/glances.conf ï¼‰ä¸­è‡ªè¡Œæ›´æ”¹é˜ˆå€¼ã€‚é»˜è®¤ä¸º careful = 50ã€warning = 70ã€critical = 90 ã€‚ ä¸‰ã€å‘½ä»¤é€‰é¡¹ï¼ˆçƒ­é”®ï¼‰ aï¼šè‡ªåŠ¨æŽ’åºè¿›ç¨‹ cï¼šæŒ‰ CPU ä½¿ç”¨çŽ‡æŽ’åºè¿›ç¨‹ mï¼šæŒ‰å†…å­˜å ç”¨æŽ’åºè¿›ç¨‹ pï¼šæŒ‰åç§°æŽ’åºè¿›ç¨‹ iï¼šæŒ‰ I/O é€ŸçŽ‡æŽ’åºè¿›ç¨‹ dï¼šæ˜¾ç¤ºæˆ–éšè—ç£ç›˜ I/O ç»Ÿè®¡ fï¼šæ˜¾ç¤ºæˆ–éšè—æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ç»Ÿè®¡ nï¼šæ˜¾ç¤ºæˆ–éšè—ç½‘ç»œæµé‡ç»Ÿè®¡ sï¼šæ˜¾ç¤ºæˆ–éšè—ä¼ æ„Ÿå™¨æ•°æ®ç»Ÿè®¡ lï¼šæ˜¾ç¤ºæˆ–éšè—æ—¥å¿— hï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ qï¼šé€€å‡º å››ã€ç›‘æŽ§è¿œç¨‹ç³»ç»Ÿå¯ä»¥åœ¨è¿œç¨‹ç³»ç»Ÿä¸­ä»¥æœåŠ¡æ¨¡å¼è¿è¡Œ glances ç¨‹åºï¼Œå†é€šè¿‡å®¢æˆ·ç«¯ä¸Šçš„ glances è¿žæŽ¥åˆ°è¿œç¨‹ç³»ç»Ÿï¼Œä»¥ç›‘æŽ§å…¶çŠ¶æ€ã€‚å¯ä»¥ä½¿ç”¨ -s é€‰é¡¹å¯ç”¨æœåŠ¡å™¨/å®¢æˆ·ç«¯æ¨¡å¼ï¼š123456$ glances -s --usernameDefine the Glances server username: starkyDefine the Glances server password (starky username):Password (confirm):Do you want to save the password? [Yes/No]: YesGlances XML-RPC server is running on 0.0.0.0:61209 å®¢æˆ·ç«¯ä½¿ç”¨ -c é€‰é¡¹è¿žæŽ¥ï¼šglances -c ip_address --username WebServer æ¨¡å¼åœ¨ glances çš„ WebServer æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯åªé€šè¿‡æµè§ˆå™¨è®¿é—®å°±å¯ä»¥èŽ·å–è¿œç¨‹æœåŠ¡å™¨çš„è¿è¡ŒçŠ¶æ€ã€‚è¯¥æ¨¡å¼éœ€è¦é¢å¤–å®‰è£… Python çš„ Bottle æ¨¡å—ï¼špip install bottleå®‰è£…æˆåŠŸåŽï¼Œä½¿ç”¨ glances -w å‘½ä»¤å³å¯å¼€å¯ WebServer æ¨¡å¼ã€‚å®¢æˆ·ç«¯ä½¿ç”¨æµè§ˆå™¨è®¿é—® http://SERVER_IP:61208/ è¿›å…¥ç›‘æŽ§ç•Œé¢ã€‚ å°† WebServer æ¨¡å¼é…ç½®ä¸ºç³»ç»ŸæœåŠ¡ åˆ›å»º Unit æ–‡ä»¶sudo vim /etc/systemd/system/glancesweb.serviceæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 1234567[Unit]Description = Glances in Web Server ModeAfter = network.target[Service]ExecStart = /usr/bin/glances -w -t 5 # glancesè·¯å¾„å› å®‰è£…æ–¹æ³•ä¸åŒæ ¹æ®å®žé™…æƒ…å†µç¡®å®šï¼Œå¯ä½¿ç”¨ which glances å‘½ä»¤èŽ·å–[Install]WantedBy = multi-user.target å¯ç”¨ systemd æœåŠ¡å¹¶è¿è¡Œ 123456789101112$ sudo systemctl enable glancesweb$ sudo systemctl start glancesweb$ systemctl status glanceswebâ— glancesweb.service - Glances in Web Server Mode Loaded: loaded (/etc/systemd/system/glancesweb.service; enabled; vendor preset: enabled) Active: active (running) since Tue 2018-08-21 00:02:17 CST; 8min ago Main PID: 27912 (glances) Tasks: 1 (limit: 4915) CGroup: /system.slice/glancesweb.service â””â”€27912 /home/starky/miniconda3/envs/python2/bin/python /home/starky/miniconda3/envs/python2/bin/glances -w -t 58æœˆ 21 00:02:17 starky-ThinkPad-T460 systemd[1]: Started Glances in Web Server Mode. å‚è€ƒæ–‡ç« Glances â€“ An Advanced Real Time System Monitoring Tool for LinuxUse Glances to Monitor Remote Linux in Web Server Mode]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux è¿›ç¨‹ç®¡ç†è¯¦è§£]]></title>
    <url>%2F2018%2F08%2F17%2FLinux-Process-Management%2F</url>
    <content type="text"><![CDATA[è¿›ç¨‹ æ˜¯ Unix å’Œ Linux ç³»ç»Ÿä¸­å¯¹æ­£åœ¨è¿è¡Œä¸­çš„åº”ç”¨ç¨‹åºçš„æŠ½è±¡ï¼Œé€šè¿‡å®ƒå¯ä»¥ç®¡ç†å’Œç›‘è§†ç¨‹åºå¯¹å†…å­˜ã€å¤„ç†å™¨æ—¶é—´å’Œ I / O èµ„æºçš„ä½¿ç”¨ã€‚ ä¸€ã€è¿›ç¨‹çš„ç»„æˆä¸€ä¸ªè¿›ç¨‹åŒ…å«å†…æ ¸ä¸­çš„ä¸€éƒ¨åˆ†åœ°å€ç©ºé—´å’Œä¸€ç³»åˆ—æ•°æ®ç»“æž„ã€‚å…¶ä¸­åœ°å€ç©ºé—´æ˜¯å†…æ ¸æ ‡è®°çš„ä¸€éƒ¨åˆ†å†…å­˜ä»¥ä¾›è¿›ç¨‹ä½¿ç”¨ï¼Œè€Œæ•°æ®ç»“æž„åˆ™ç”¨æ¥çºªå½•æ¯ä¸ªè¿›ç¨‹çš„å…·ä½“ä¿¡æ¯ã€‚ æœ€ä¸»è¦çš„è¿›ç¨‹ä¿¡æ¯åŒ…æ‹¬ï¼š è¿›ç¨‹çš„åœ°å€ç©ºé—´å›¾ è¿›ç¨‹å½“å‰çš„çŠ¶æ€ï¼ˆ sleepingã€stoppedã€runnable ç­‰ï¼‰ è¿›ç¨‹çš„æ‰§è¡Œä¼˜å…ˆçº§ è¿›ç¨‹è°ƒç”¨çš„èµ„æºä¿¡æ¯ è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶å’Œç½‘ç»œç«¯å£ä¿¡æ¯ è¿›ç¨‹çš„ä¿¡å·æŽ©ç ï¼ˆæŒ‡æ˜Žå“ªç§ä¿¡å·è¢«å±è”½ï¼‰ è¿›ç¨‹çš„å±žä¸» PID ï¼šè¿›ç¨‹ IDæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šä»Žå†…æ ¸èŽ·å–ä¸€ä¸ªå”¯ä¸€çš„ ID å€¼ã€‚ç»å¤§å¤šæ•°ç”¨æ¥æ“ä½œè¿›ç¨‹çš„å‘½ä»¤å’Œç³»ç»Ÿè°ƒç”¨ï¼Œéƒ½éœ€è¦ç”¨ PID æŒ‡å®šæ“ä½œçš„è¿›ç¨‹å¯¹è±¡ã€‚ PPID ï¼šçˆ¶è¿›ç¨‹ IDåœ¨ Unix å’Œ Linux ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªå·²ç»å­˜åœ¨çš„è¿›ç¨‹å¿…é¡»â€œå…‹éš†â€å®ƒè‡ªèº«æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚å½“æ–°çš„è¿›ç¨‹å…‹éš†åŽï¼Œæœ€åˆçš„è¿›ç¨‹ä¾¿ä½œä¸ºçˆ¶è¿›ç¨‹å­˜åœ¨ã€‚ UID &amp; EUIDï¼šçœŸå®žç”¨æˆ· ID å’Œæœ‰æ•ˆç”¨æˆ· IDä¸€ä¸ªè¿›ç¨‹çš„ UID æ˜¯å…¶åˆ›å»ºè€…çš„èº«ä»½æ ‡å¿—ï¼ˆä¹Ÿæ˜¯å¯¹å…¶çˆ¶è¿›ç¨‹ UID çš„å¤åˆ¶ï¼‰ã€‚é€šå¸¸åªæœ‰è¿›ç¨‹çš„åˆ›å»ºè€…å’Œè¶…çº§ç”¨æˆ·æ‰æœ‰æ“ä½œè¯¥è¿›ç¨‹çš„æƒé™ã€‚EUID æ˜¯ä¸€ä¸ªé¢å¤–çš„ UIDï¼Œç”¨æ¥å†³å®šåœ¨ä»»æ„ä¸€ä¸ªç‰¹å®šæ—¶é—´ç‚¹ï¼Œä¸€ä¸ªè¿›ç¨‹æœ‰æƒé™è®¿é—®çš„æ–‡ä»¶å’Œèµ„æºã€‚å¯¹ç»å¤§å¤šæ•°è¿›ç¨‹è€Œè¨€ï¼ŒUID å’Œ EUID æ˜¯ç›¸åŒçš„ï¼ˆç‰¹æ®Šæƒ…å†µå³ setuidï¼‰ Nicenessä¸€ä¸ªè¿›ç¨‹çš„è®¡åˆ’ä¼˜å…ˆçº§å†³å®šäº†å®ƒèƒ½èŽ·å–åˆ°çš„ CPU æ—¶é—´ã€‚å†…æ ¸æœ‰ä¸€ä¸ªåŠ¨æ€çš„ç®—æ³•æ¥è®¡ç®—ä¼˜å…ˆçº§ï¼ŒåŒæ—¶ä¹Ÿä¼šå…³æ³¨ä¸€ä¸ª Niceness å€¼ï¼Œæ¥å†³å®šç¨‹åºè¿è¡Œçš„ä¼˜å…ˆé¡ºåºã€‚ äºŒã€ä¿¡å·ä¿¡å·å±žäºŽè¿›ç¨‹çº§åˆ«çš„ä¸­æ–­è¯·æ±‚ã€‚å®ƒä»¬å¯ä»¥ä½œä¸ºè¿›ç¨‹é—´é€šä¿¡çš„æ‰‹æ®µï¼Œæˆ–è€…ç”±ç»ˆç«¯å‘é€ä»¥æ€æ­»ã€ä¸­æ–­ã€æŒ‚èµ·æŸä¸ªè¿›ç¨‹ã€‚ å¸¸è§ä¿¡å·åˆ—è¡¨ï¼š # name Description Default Can catch? Can block? Dump core? 1 HUP Hangup Terminate Yes Yes No 2 INT Interruptï¼ˆCtrl + Cï¼‰ Terminate Yes Yes No 3 Quit Quitï¼ˆCtrl + \ï¼‰ Terminate Yes Yes Yes 9 KILL Kill Terminate No No No BUS Bus error Terminate Yes Yes Yes 11 SEGV Segmentation fault Terminate Yes Yes Yes 15 TERM Software terminatation Terminate Yes Yes No STOP Stopï¼ˆCtrl + Zï¼‰ Stop No No No TSTP Keyboard stop Stop Yes Yes No CONT Continue after stop Ignore Yes No No ä¸‰ã€Kill å‘½ä»¤kill å‘½ä»¤å¸¸ç”¨æ¥ç»ˆæ­¢æŸä¸ªè¿›ç¨‹ï¼Œå®ƒå¯ä»¥å‘è¿›ç¨‹ä¼ é€’ä»»æ„ä¿¡å·ï¼ˆé»˜è®¤ä¸º TERMï¼‰ã€‚kill [-signal] pidä¸å¸¦ä»»ä½•æ•°å­—ï¼ˆä¿¡å·ï¼‰é€‰é¡¹çš„ kill å‘½ä»¤å¹¶ä¸èƒ½ä¿è¯æŒ‡å®šè¿›ç¨‹è¢«æ€æ­»ï¼Œå› ä¸º kill å‘½ä»¤é»˜è®¤å‘é€ TERM ä¿¡å·ï¼Œè€Œ TERM æ˜¯å¯ä»¥è¢«æ•èŽ·ã€å±è”½æˆ–å¿½ç•¥çš„ã€‚å¯ä»¥ä½¿ç”¨ kill -9 pid å‘½ä»¤å¼ºåˆ¶æ€æ­»è¿›ç¨‹ï¼ˆ9 ä»£è¡¨ KILL ä¿¡å·ï¼Œä¸å¯è¢«æ•èŽ·ã€å±è”½æˆ–å¿½ç•¥ï¼‰ã€‚ kill å‘½ä»¤éœ€è¦æŒ‡å®šè¿›ç¨‹çš„ PID å·ã€‚pgrep å‘½ä»¤å¯ä»¥é€šè¿‡ç¨‹åºåç§°ï¼ˆæˆ–å…¶ä»–å±žæ€§å¦‚ UIDï¼‰ç­›é€‰è¿›ç¨‹å·ï¼Œpkill å‘½ä»¤å¯ä»¥ç›´æŽ¥å‘é€æŒ‡å®šä¿¡å·ç»™ç­›é€‰ç»“æžœã€‚å¦‚ sudo pkill -u benè¯¥å‘½ä»¤å°†å‘é€ TERM ä¿¡å·ç»™æ‰€æœ‰å±žäºŽç”¨æˆ· ben çš„è¿›ç¨‹ã€‚ killall å‘½ä»¤å¯ä»¥é€šè¿‡ç¨‹åºåç§°æ€æ­»æŒ‡å®šè¿›ç¨‹çš„æ‰€æœ‰å®žä¾‹ã€‚å¦‚ï¼šsudo killall apache2123456789101112131415161718192021$ pgrep postgres # ç­›é€‰ postgres è¿›ç¨‹çš„ PID å· 25874258762587725878258792588025881$ pgrep -a postgres # ç­›é€‰ postgres è¿›ç¨‹çš„ PID å·ï¼Œå¹¶è¾“å‡ºè¯¦ç»†ä¿¡æ¯25874 /usr/lib/postgresql/10/bin/postgres -D /var/lib/postgresql/10/main -c config_file=/etc/postgresql/10/main/postgresql.conf25876 postgres: 10/main: checkpointer process25877 postgres: 10/main: writer process25878 postgres: 10/main: wal writer process25879 postgres: 10/main: autovacuum launcher process25880 postgres: 10/main: stats collector process25881 postgres: 10/main: bgworker: logical replication launcher$ sudo kill -9 `pgrep postgres` # æ€æ­» postgres è¿›ç¨‹$ sudo pkill postgres # åŒä¸Šä¸€æ¡å‘½ä»¤$ sudo killall postgres # æ€æ­» postgres è¿›ç¨‹çš„æ‰€æœ‰å®žä¾‹$ sudo pkill -9 -u postgres # æ€æ­»å±žäºŽ postgres ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ æ ¹æ®è¿›ç¨‹ PID å·æŸ¥æ‰¾è¿›ç¨‹å¯ä»¥ä½¿ç”¨ ps -p &lt;pid&gt; -o comm= å‘½ä»¤ å››ã€è¿›ç¨‹çŠ¶æ€ çŠ¶æ€ å«ä¹‰ Runnable è¯¥è¿›ç¨‹æ­£åœ¨ï¼ˆæ­£å‡†å¤‡ï¼‰æ‰§è¡Œ Sleeping è¯¥è¿›ç¨‹æ­£ç­‰å¾…æŸäº›èµ„æº Zombie è¯¥è¿›ç¨‹æ­£åŠªåŠ›å°è¯•ç»“æŸ Stopped è¯¥è¿›ç¨‹å·²æŒ‚èµ·ï¼ˆä¸å…è®¸æ‰§è¡Œï¼‰ Runnable è¡¨ç¤ºè¿›ç¨‹å·²ç»èŽ·å–åˆ°äº†è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰èµ„æºï¼Œåªæ˜¯ç­‰å¾…ç›¸åº”çš„ CPU æ—¶é—´æ¥å¤„ç†æ•°æ®ã€‚ Sleeping è¡¨ç¤ºè¿›ç¨‹å¤„äºŽç­‰å¾…ç‰¹å®šäº‹ä»¶å‘ç”Ÿçš„çŠ¶æ€ã€‚äº¤äº’å¼ Shell å’Œç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯ Sleeping çŠ¶æ€ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥æˆ–ç½‘ç»œè¿žæŽ¥ã€‚ Zombies è¡¨ç¤ºè¿›ç¨‹å·²ç»ç»“æŸæ‰§è¡Œï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ”¶é›†å®Œæ‰€æœ‰çš„çŠ¶æ€ï¼Œåœ¨è¿›ç¨‹è¡¨ä¸­ä»æœ‰çºªå½•ã€‚ Stopped è¡¨ç¤ºè¿›ç¨‹å·²åœæ­¢è¿è¡Œï¼Œé€šå¸¸æ˜¯æ”¶åˆ°äº†æŸç§åœæ­¢ä¿¡å·ã€‚ äº”ã€PS å‘½ä»¤ï¼šç›‘æŽ§èµ„æºps å‘½ä»¤æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ç›‘æŽ§è¿›ç¨‹çš„ä¸»è¦å·¥å…·ã€‚è¯¥å‘½ä»¤å¯ä»¥æ˜¾ç¤ºè¿›ç¨‹çš„ PIDã€UIDã€ä¼˜å…ˆçº§å’ŒæŽ§åˆ¶ç»ˆç«¯ï¼Œä»¥åŠè¿›ç¨‹å ç”¨çš„å†…å­˜ã€æ¶ˆè€—çš„ CPU æ—¶é—´å’Œå½“å‰çš„çŠ¶æ€ç­‰ä¿¡æ¯ã€‚ å¸¸ç”¨çš„ PS å‘½ä»¤é€‰é¡¹ç»„åˆï¼š 1. ps auxa é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œx é€‰é¡¹è¡¨ç¤ºåŒæ—¶æ˜¾ç¤ºæ²¡æœ‰æŽ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ï¼ˆTTY æ˜¾ç¤ºä¸º ?ï¼‰ï¼Œu é€‰é¡¹è¡¨ç¤ºä½¿ç”¨åŸºäºŽç”¨æˆ·çš„ä¿¡æ¯è¾“å‡ºæ ¼å¼1234567891011121314151617181920212223$ ps auxUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMANDroot 1 0.0 0.1 225428 9548 ? Ss 7æœˆ30 0:30 /lib/systemd/systemd --system --deserialize 19root 2 0.0 0.0 0 0 ? S 7æœˆ30 0:00 [kthreadd]root 4 0.0 0.0 0 0 ? I&lt; 7æœˆ30 0:00 [kworker/0:0H]root 6 0.0 0.0 0 0 ? I&lt; 7æœˆ30 0:00 [mm_percpu_wq]root 7 0.0 0.0 0 0 ? S 7æœˆ30 0:03 [ksoftirqd/0]root 8 0.0 0.0 0 0 ? I 7æœˆ30 14:49 [rcu_sched]...starky 6874 0.0 0.1 33016 8556 pts/2 Ss 8æœˆ07 0:00 bashstarky 7150 0.0 0.0 33016 6044 pts/2 S+ 8æœˆ07 0:00 bashstarky 7151 3.1 16.1 4763784 1227932 pts/2 Sl+ 8æœˆ07 272:54 java -Xmx1024M -Xms512M -jar minecraft_server.1.12.2.jar nogui...root 18447 0.0 0.0 107984 7116 ? Ss 13:55 0:00 sshd: starky [priv]starky 18535 0.0 0.0 108092 4268 ? S 13:55 0:00 sshd: starky@pts/1starky 18536 0.0 0.1 33096 8336 pts/1 Ss 13:55 0:00 -bashroot 18761 0.0 0.0 0 0 ? I 13:55 0:00 [kworker/u8:0]root 18799 0.0 0.0 0 0 ? I 14:01 0:00 [kworker/u8:1]root 18805 0.0 0.0 0 0 ? I 14:05 0:00 [kworker/0:2]starky 18874 0.0 0.0 46780 3568 pts/1 R+ 14:10 0:00 ps -auxredis 19235 0.2 0.0 58548 3736 ? Ssl 8æœˆ04 30:03 /usr/bin/redis-server 127.0.0.1:6379root 20799 0.0 0.0 107548 7504 ? Ss 8æœˆ05 0:00 /usr/sbin/cupsd -lroot 28342 0.0 0.4 535068 36940 ? Ss 8æœˆ10 0:16 /usr/sbin/apache2 -k start å…¶ä¸­å¸¦ä¸­æ‹¬å·çš„å‘½ä»¤ï¼ˆå¦‚ [kthreadd]ï¼‰å¹¶ä¸æ˜¯çœŸæ­£çš„å‘½ä»¤è€Œæ˜¯å†…æ ¸çº¿ç¨‹ã€‚ ps aux å‘½ä»¤è¾“å‡ºçš„å„åˆ—ä¿¡æ¯å«ä¹‰å¦‚ä¸‹ï¼š é¡¹ç›® è§£é‡Š USER è¿›ç¨‹å±žä¸»çš„ç”¨æˆ·å PID è¿›ç¨‹ ID %CPU è¿›ç¨‹å ç”¨çš„ CPU ç™¾åˆ†æ¯” %MEM è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ç™¾åˆ†æ¯” VSZ è¿›ç¨‹çš„è™šæ‹Ÿå¤§å° RSS é©»ç•™å†…å­˜å¤§å°ï¼ˆå†…å­˜ä¸­çš„é¡µæ•°ï¼‰ TTY æŽ§åˆ¶ç»ˆç«¯ ID STAT è¿›ç¨‹å½“å‰çš„çŠ¶æ€ï¼šR = RunnableD = In uninterruptible sleepS = Sleeping(&lt;20s)T = Traced or stoppedZ = Zombieé¢å¤–æ ‡è®°ï¼šW = Process is swapped out&lt; = è¿›ç¨‹æœ‰ç›¸å¯¹äºŽå¹³æ—¶æ›´é«˜çš„ä¼˜å…ˆçº§N = è¿›ç¨‹æœ‰ç›¸å¯¹äºŽå¹³æ—¶æ›´ä½Žçš„ä¼˜å…ˆçº§L = Some pages are locked in cores = Process is a session leader TIME è¿›ç¨‹å·²ç»æ¶ˆè€—çš„ CPU æ—¶é—´ COMMAND è¿›ç¨‹çš„å‘½ä»¤å’Œå‘½ä»¤é€‰é¡¹ 2. ps laxl é€‰é¡¹è¡¨ç¤ºä»¥è¯¦ç»†çš„æ ¼å¼è¾“å‡ºè¿›ç¨‹ä¿¡æ¯ã€‚1234567891011121314151617181920212223242526$ ps laxF UID PID PPID PRI NI VSZ RSS WCHAN STAT TTY TIME COMMAND4 0 1 0 20 0 225428 9548 - Ss ? 0:30 /lib/systemd/systemd --system --deserialize 191 0 2 0 20 0 0 0 - S ? 0:00 [kthreadd]1 0 4 2 0 -20 0 0 - I&lt; ? 0:00 [kworker/0:0H]1 0 6 2 0 -20 0 0 - I&lt; ? 0:00 [mm_percpu_wq]1 0 7 2 20 0 0 0 - S ? 0:03 [ksoftirqd/0]1 0 8 2 20 0 0 0 - I ? 14:58 [rcu_sched]...0 1000 6874 6871 20 0 33016 8556 wait Ss pts/2 0:00 bash1 1000 7150 6874 20 0 33016 6044 wait S+ pts/2 0:00 bash0 1000 7151 7150 20 0 4763784 1227932 futex_ Sl+ pts/2 275:03 java -Xmx1024M -Xms512M -jar minecraft_server.1.12.2.jar nogui...4 0 18447 619 20 0 107984 7116 - Ss ? 0:00 sshd: starky [priv]5 1000 18535 18447 20 0 108092 4268 - S ? 0:00 sshd: starky@pts/10 1000 18536 18535 20 0 33096 8336 wait Ss pts/1 0:00 -bash1 0 19051 2 20 0 0 0 - I ? 0:00 [kworker/3:0]1 0 19141 2 20 0 0 0 - I ? 0:00 [kworker/2:3]1 115 19235 1 20 0 58548 3736 - Ssl ? 30:22 /usr/bin/redis-server 127.0.0.1:63791 0 19246 2 20 0 0 0 - I ? 0:00 [kworker/2:0]1 0 19291 2 20 0 0 0 - I ? 0:00 [kworker/u8:0]1 0 19312 2 20 0 0 0 - I ? 0:00 [kworker/0:2]1 0 19405 2 20 0 0 0 - I ? 0:00 [kworker/u8:1]0 1000 19417 18536 20 0 36024 1596 - R+ pts/1 0:00 ps -lax4 0 20799 1 20 0 107548 7504 - Ss ? 0:00 /usr/sbin/cupsd -l5 0 28342 1 20 0 535068 36940 - Ss ? 0:16 /usr/sbin/apache2 -k start ps lax å‘½ä»¤çš„è¾“å‡ºåŒ…å«äº†çˆ¶è¿›ç¨‹ IDï¼ˆPPIDï¼‰ã€nice å€¼ï¼ˆNIï¼‰è¿˜æœ‰è¿›ç¨‹æ­£åœ¨ç­‰å¾…çš„èµ„æºç±»åž‹ï¼ˆWCHANï¼‰ç­‰ã€‚ 3. ps axjfps axjf å‘½ä»¤èƒ½å¤Ÿä»¥æ ‘çŠ¶ç»“æž„æ˜¾ç¤ºå„è¿›ç¨‹é—´çš„å±‚çº§å…³ç³»f é€‰é¡¹è¡¨ç¤ºç”¨ ASCII å­—ç¬¦æ˜¾ç¤ºæ ‘çŠ¶ç»“æž„ï¼Œè¡¨è¾¾ç¨‹åºé—´çš„ç›¸äº’å…³ç³»ã€‚12345678910111213141516171819202122$ ps axjf PPID PID PGID SID TTY TPGID STAT UID TIME COMMAND 0 2 0 0 ? -1 S 0 0:00 [kthreadd] 2 4 0 0 ? -1 I&lt; 0 0:00 \_ [kworker/0:0H] 2 6 0 0 ? -1 I&lt; 0 0:00 \_ [mm_percpu_wq] 2 7 0 0 ? -1 S 0 0:02 \_ [ksoftirqd/0] 2 8 0 0 ? -1 I 0 4:26 \_ [rcu_sched]... 1 672 672 672 ? -1 Ss 0 0:00 /usr/sbin/sshd -D 672 27078 27078 27078 ? -1 Ss 0 0:00 \_ sshd: starky [priv]27078 27166 27078 27078 ? -1 S 1000 0:00 \_ sshd: starky@pts/127166 27167 27167 27167 pts/1 27438 Ss 1000 0:00 \_ -bash27167 27438 27438 27167 pts/1 27438 R+ 1000 0:00 \_ ps axjf 1 681 681 681 ? -1 Ssl 115 9:40 /usr/bin/redis-server 127.0.0.1:6379 1 700 700 700 tty1 700 Ss+ 0 0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux 1 710 710 710 ? -1 Ss 0 0:14 /usr/sbin/apache2 -k start 710 25651 710 710 ? -1 S 33 0:00 \_ /usr/sbin/apache2 -k start 710 25652 710 710 ? -1 S 33 0:00 \_ /usr/sbin/apache2 -k start 710 25653 710 710 ? -1 S 33 0:00 \_ /usr/sbin/apache2 -k start 710 25654 710 710 ? -1 S 33 0:00 \_ /usr/sbin/apache2 -k start 710 25655 710 710 ? -1 S 33 0:00 \_ /usr/sbin/apache2 -k start ... 4. ps ops o å‘½ä»¤åŠ ä¸Šé€‰é¡¹å¯ä»¥æŒ‡å®šä¿¡æ¯çš„è¾“å‡ºæ ¼å¼ï¼ŒåŒæ—¶åŠ ä¸Š --sort é€‰é¡¹å¯æŒ‡å®šæŽ’åºä¾æ®å¦‚ï¼šps axo pid,ppid,%mem,%cpu,cmd --sort=-%memä¸Šé¢çš„å‘½ä»¤è¡¨ç¤ºè¾“å‡ºè¿›ç¨‹çš„ PIDã€PPIDã€å†…å­˜å ç”¨ã€CPUå ç”¨å’Œå‘½ä»¤é€‰é¡¹ã€‚å¹¶ä»¥å†…å­˜å ç”¨å¤§å°æŽ’åºã€‚ï¼ˆ--sort=-%mem ä¸­çš„ - è¡¨ç¤ºé€†å‘æŽ’åºï¼Œå³ç”±å¤§åˆ°å°æŽ’åºï¼‰1234567891011$ ps axo pid,ppid,%mem,%cpu,cmd --sort=-%mem | head PID PPID %MEM %CPU CMD 1790 1789 14.1 3.8 java -Xmx1024M -Xms512M -jar minecraft_server.1.12.2.jar nogui 1357 1 2.6 0.1 /usr/sbin/mysqld --daemonize --pid-file=/run/mysqld/mysqld.pid 9343 1 2.0 0.0 /usr/bin/python3 /usr/bin/update-manager --no-update --no-focus-on-map 1244 1 1.5 0.0 sogou-qimpanel %U 1024 1 1.0 0.0 /usr/bin/fcitx 1454 1 0.9 0.0 fcitx-qimpanel 7401 1067 0.7 0.0 lxterminal 248 1 0.6 0.0 /lib/systemd/systemd-journald 1119 1 0.6 0.0 nm-applet å¯ä»¥å°è¯•ä¸åŒçš„å‘½ä»¤é€‰é¡¹ç»„åˆæ¥èŽ·å–ç›¸åº”çš„ä¿¡æ¯ï¼Œå…·ä½“å¯å‚è€ƒ man ps å…­ã€ä½¿ç”¨ TOP å‘½ä»¤åŠ¨æ€ç›‘æŽ§è¿›ç¨‹top å‘½ä»¤å¯ä»¥å®žæ—¶æ˜¾ç¤ºç³»ç»Ÿå½“å‰æ´»è·ƒè¿›ç¨‹çš„æ€»ä½“ä¿¡æ¯åŠå…¶å ç”¨çš„èµ„æºã€‚top å‘½ä»¤çš„ -d é€‰é¡¹å¯ä»¥æŒ‡å®šä¿¡æ¯åˆ·æ–°çš„æ—¶é—´é—´éš”ã€‚åŒæ—¶è¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„äº¤äº’å‘½ä»¤ å‘½ä»¤ æè¿° h æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ k ç»ˆæ­¢æŸä¸ªè¿›ç¨‹ i å¿½ç•¥é—²ç½®å’Œåƒµæ­»è¿›ç¨‹ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¼€å…³å¼å‘½ä»¤ï¼‰ q é€€å‡º top ç¨‹åº r é‡æ–°è®¾ç½®æŸä¸ªè¿›ç¨‹çš„ä¼˜å…ˆçº§ s æ”¹å˜ä¸¤æ¬¡åˆ·æ–°ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ï¼ˆå•ä½ä¸ºsï¼‰ f æˆ– F ä»Žå½“å‰æ˜¾ç¤ºä¸­æ·»åŠ æˆ–è€…åˆ é™¤é¡¹ç›® l åˆ‡æ¢æ˜¾ç¤ºå¹³å‡è´Ÿè½½å’Œå¯åŠ¨æ—¶é—´ä¿¡æ¯ m åˆ‡æ¢æ˜¾ç¤ºå†…å­˜ä¿¡æ¯ t åˆ‡æ¢æ˜¾ç¤ºè¿›ç¨‹å’ŒCPUçŠ¶æ€ä¿¡æ¯ c åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤ M æ ¹æ®é©»ç•™å†…å­˜å¤§å°è¿›è¡ŒæŽ’åº P æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡ŒæŽ’åº T æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡ŒæŽ’åº w å°†å½“å‰è®¾ç½®å†™å…¥ ~/.toprc æ–‡ä»¶ä¸­ ä¸ƒã€å‰å°/åŽå°è¿›ç¨‹ å‰å°è¿›ç¨‹ï¼ˆä¹Ÿç§°ä½œäº¤äº’å¼è¿›ç¨‹ï¼‰ï¼šç”±æŸä¸ªç»ˆç«¯ä¼šè¯åˆ›å»ºå’ŒæŽ§åˆ¶çš„è¿›ç¨‹ã€‚å³éœ€è¦ç”¨æˆ·æŽ§åˆ¶è€Œä¸èƒ½ä½œä¸ºç³»ç»ŸæœåŠ¡è‡ªåŠ¨å¯åŠ¨ã€‚ åŽå°è¿›ç¨‹ï¼ˆä¹Ÿç§°ä½œéžäº¤äº’å¼è¿›ç¨‹ï¼‰ï¼šä¸å’Œç»ˆç«¯ç»‘å®šçš„è¿›ç¨‹ï¼Œä¸ç­‰å¾…ç”¨æˆ·è¾“å…¥ã€‚ å¯ä»¥åœ¨å‘½ä»¤åŽå¸¦ä¸Š &amp; ç¬¦å·ï¼Œåœ¨åŽå°å¯ç”¨ä¸€ä¸ª Linux è¿›ç¨‹æ‰§è¡Œè¯¥å‘½ä»¤ã€‚å¹¶é€šè¿‡ jobs å‘½ä»¤æŸ¥çœ‹å½“å‰çš„ä»»åŠ¡ã€‚ä½¿ç”¨ fg å‘½ä»¤å°†åŽå°æ‰§è¡Œçš„è¿›ç¨‹è°ƒåˆ°å‰å°æ‰§è¡Œä½¿ç”¨ Ctrl + Z ç»„åˆé”®ï¼ˆå‘é€ SIGSTOP ä¿¡å·ï¼‰æŒ‚èµ·å½“å‰è¿›ç¨‹ï¼ˆå‰å°ï¼‰ï¼Œå¹¶ä½¿ç”¨ bg å‘½ä»¤ä»¤å…¶åœ¨åŽå°ç»§ç»­æ‰§è¡Œ1234567891011121314$ python -m SimpleHTTPServer &amp; # åŽå°å¯åŠ¨ python è¿›ç¨‹[1] 28036$ Serving HTTP on 0.0.0.0 port 8000 ...$ jobs # ä½¿ç”¨ jobs å‘½ä»¤æŸ¥çœ‹åŽå°è¿›è¡Œçš„ä»»åŠ¡[1]+ è¿è¡Œä¸­ python -m SimpleHTTPServer &amp;$ fg %1 # å°†åŽå°æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªä»»åŠ¡è°ƒåˆ°å‰å°æ‰§è¡Œï¼ˆfg %1ï¼‰python -m SimpleHTTPServer^Z # ä½¿ç”¨ Ctrl + Z ç»„åˆé”®ï¼ˆå‘é€ STOP ä¿¡å·ï¼‰åœæ­¢å½“å‰è¿›ç¨‹[1]+ å·²åœæ­¢ python -m SimpleHTTPServer$ bg # ä½¿ç”¨ bg å‘½ä»¤å°†è¿›ç¨‹è°ƒè‡³åŽå°ç»§ç»­æ‰§è¡Œ[1]+ python -m SimpleHTTPServer &amp;$ fg %1python -m SimpleHTTPServer å‚è€ƒèµ„æ–™UNIX and Linux System Administration Handbook, 4th EditionAll You Need To Know About Processes in Linux]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux æ–‡æœ¬å¤„ç†å‘½ä»¤è¯¦è§£ï¼ˆtr cut sort uniqï¼‰]]></title>
    <url>%2F2018%2F07%2F03%2FLinux-text-manipulation%2F</url>
    <content type="text"><![CDATA[ä¸€ã€tr å‘½ä»¤tr (translate) å‘½ä»¤å¯ä»¥å¯¹æ¥è‡ªæ ‡å‡†è¾“å…¥çš„å­—ç¬¦è¿›è¡Œæ›¿æ¢ã€åŽ‹ç¼©å’Œåˆ é™¤æ“ä½œã€‚ è¯­æ³•1tr [option] string1 string2 é€‰é¡¹tr string1 string2 ï¼šå°†æ ‡å‡†è¾“å…¥ä¸­æ‰€æœ‰å±žäºŽ string1 çš„å­—ç¬¦æ›¿æ¢ä¸º string2 ä¸­çš„å­—ç¬¦-d ï¼šåˆ é™¤æ ‡å‡†è¾“å…¥ä¸­æ‰€æœ‰å±žäºŽ string1 çš„å­—ç¬¦-s ï¼šæŠŠæ ‡å‡†è¾“å…¥ä¸­è¿žç»­çš„é‡å¤å­—ç¬¦åŽ‹ç¼©æˆä¸€ä¸ªå­—ç¬¦æ˜¾ç¤º-c ï¼šå–ä»£æˆ–åˆ é™¤æ ‡å‡†è¾“å…¥ä¸­æ‰€æœ‰ä¸å±žäºŽ string1 çš„å­—ç¬¦ ç¤ºä¾‹123456789101112131415# æ›¿æ¢æŒ‡å®šå­—ç¬¦$ echo &quot;hello world&quot; | tr &apos;h&apos; &apos;H&apos;Hello world# åˆ é™¤æŒ‡å®šå­—ç¬¦ï¼ˆæ•°å­—å’Œç©ºæ ¼ï¼‰$ echo &quot;hello 12345 world&quot; | tr -d &apos;0-9 &apos;helloworld# åŽ‹ç¼©æŒ‡å®šå­—ç¬¦$ echo &quot;heeeeeeeeello world&quot; | tr -s &apos;e&apos;hello world# å­—ç¬¦é›†è¡¥é›†$ echo &quot;hello 12345 world&quot; | tr -c -d &apos;0-9&apos;12345 å­—ç¬¦é›†æ ¼å¼ï¼ˆstring1 / string2ï¼‰å­—ç¬¦é›†åˆï¼ˆå³å‘½ä»¤å‚æ•°ä¸­çš„ string1 å’Œ string2ï¼‰ç”¨äºŽæŒ‡å®šéœ€è¦æ›¿æ¢æˆ–åˆ é™¤çš„å­—ç¬¦ã€‚&#39;A-Za-z&#39;ã€&#39;A-F0-9&#39;ã€&#39;}.\t&#39; ç­‰éƒ½æ˜¯åˆæ³•çš„å­—ç¬¦é›†åˆã€‚ å­—ç¬¦ å«ä¹‰ \b é€€æ ¼ç¬¦ \n æ–°è¡Œ \r å›žè½¦ç¬¦ \t Tab ç¬¦ CHAR1-CHAR2 ä»Ž CHAR1 åˆ° CHAR2 çš„æ‰€æœ‰å­—ç¬¦ï¼ˆæŒ‰ ASCII å­—ç¬¦é¡ºåºï¼‰ [:alnum:] æ‰€æœ‰å­—æ¯å’Œæ•°å­— [:alpha:] æ‰€æœ‰å­—æ¯ [:blank:] æ‰€æœ‰ç©ºæ ¼å’Œ Tab å­—ç¬¦ [:cntrl:] æ‰€æœ‰æŽ§åˆ¶å­—ç¬¦ [:graph:] æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ï¼Œä¸åŒ…æ‹¬ç©ºæ ¼ [:lower:] æ‰€æœ‰å°å†™å­—ç¬¦ [:punct:] æ‰€æœ‰æ ‡ç‚¹ç¬¦å· [:space:] æ‰€æœ‰æ¨ªå‘æˆ–çºµå‘çš„ç©ºç™½å­—ç¬¦ [:upper:] æ‰€æœ‰å¤§å†™å­—ç¬¦ äºŒã€cut å‘½ä»¤cut å‘½ä»¤ç”¨äºŽåˆ‡å‰²å¹¶ç­›é€‰æ–‡æœ¬è¡Œä¸­çš„æŒ‡å®šéƒ¨åˆ†ï¼Œå…¶æ“ä½œå¯¹è±¡å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œå¦‚æœªæŒ‡å®šæ–‡ä»¶é€‰é¡¹æˆ–è¯¥é€‰é¡¹ä¸º â€œ-â€œï¼Œåˆ™ä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–éœ€è¦æ“ä½œçš„å†…å®¹ã€‚ è¯­æ³•cut &lt;option&gt; list [file ...]å…¶ä¸­ list é€‰é¡¹ä¸ºç”±é€—å·åˆ†éš”çš„æ•°å­—æˆ– â€œ-â€œ å·è¿žæŽ¥çš„æ•°å­—èŒƒå›´ï¼Œç”¨äºŽæŒ‡å®šæ–‡æœ¬è¡Œä¸­éœ€è¦æ˜¾ç¤ºçš„å­—æ®µã€‚ N-ï¼šä»Žç¬¬ N ä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç»“å°¾ N-Mï¼šä»Žç¬¬ N ä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç¬¬ M ä¸ªï¼ˆåŒ…æ‹¬ M åœ¨å†…ï¼‰ -Mï¼šä»Žç¬¬ 1 ä¸ªå­—èŠ‚ã€å­—ç¬¦ã€å­—æ®µåˆ°ç¬¬ M ä¸ªï¼ˆåŒ…æ‹¬ M åœ¨å†…ï¼‰ é€‰é¡¹-b listï¼šlist é€‰é¡¹æŒ‡å®šçš„æ˜¯ byte çš„èŒƒå›´-c listï¼šlist é€‰é¡¹æŒ‡å®šçš„æ˜¯å­—ç¬¦çš„èŒƒå›´-dï¼šæŒ‡å®šå­—æ®µçš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ Tab-f listï¼šlist é€‰é¡¹æŒ‡å®šçš„æ˜¯å­—æ®µçš„èŒƒå›´ ç¤ºä¾‹ç”¨äºŽæ¼”ç¤ºçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š12345$ cat students.txtNo Name Mark01 rose 6902 jack 7103 alex 68 ä½¿ç”¨ -f é€‰é¡¹æå–æŒ‡å®šå­—æ®µ12345$ cut -f 2,3 students.txtName Markrose 69jack 71alex 68 ä½¿ç”¨ -d é€‰é¡¹æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦12345678910$ cat students2.txtNo,Name,Mark01,rose,6902,jack,7103,alex,68$ cut -f 2,3 -d &quot;,&quot; students2.txtName,Markrose,69jack,71alex,68 ä½¿ç”¨ -c é€‰é¡¹æå–æŒ‡å®šå­—ç¬¦èŒƒå›´é‡Œçš„å†…å®¹123456789101112$ cat test.txtabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz$ cut -c -5 test.txtabcdeabcdeabcde$ cut -c 5- test.txtefghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyzefghijklmnopqrstuvwxyz ä¸‰ã€sort å‘½ä»¤sort å‘½ä»¤ç”¨äºŽå°†æ–‡ä»¶å†…å®¹è¿›è¡ŒæŽ’åºï¼Œå¹¶å°†æŽ’åºç»“æžœæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚å®ƒå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œæ–‡æœ¬è§†ä¸ºä¸€ä¸ªå•ä½ï¼Œä»Žé¦–å­—æ¯å‘åŽï¼Œä¾æ¬¡æŒ‰è¯¥å­—æ¯çš„ ASCII ç å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶æŒ‰å‡åºè¾“å‡ºã€‚ é€‰é¡¹-bï¼šå¿½ç•¥æ¯è¡Œè¡Œé¦–çš„ç©ºæ ¼å­—ç¬¦-cï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²æŒ‰é¡ºåºæŽ’åº-dï¼šæŽ’åºæ—¶ï¼Œåªè€ƒè™‘å­—æ¯ã€ç©ºæ ¼å’Œæ•°å­—ï¼Œå¿½ç•¥å…¶å®ƒå­—ç¬¦-fï¼šæŽ’åºæ—¶ï¼Œå°†å°å†™å­—æ¯è§†ä¸ºå¤§å†™å­—æ¯ï¼ˆå³å¿½ç•¥å¤§å°å†™ï¼‰-iï¼šæŽ’åºæ—¶ï¼Œå¿½ç•¥æ‰€æœ‰éžæ‰“å°å­—ç¬¦-Mï¼šå°†å‰é¢ä¸‰ä¸ªå­—æ¯æŒ‰æœˆä»½çš„ç¼©å†™è¿›è¡ŒæŽ’åº-nï¼šæŒ‰ç…§æ•°å€¼çš„å¤§å°è¿›è¡ŒæŽ’åº-oï¼šå°†æŽ’åºå¥½çš„ç»“æžœè¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ä¸­-rï¼šä»¥ç›¸åçš„é¡ºåºè¾“å‡ºæŽ’åºåŽçš„ç»“æžœ-tï¼šæŒ‡å®šæŽ’åºæ—¶ä½¿ç”¨çš„æ ä½åˆ†éš”ç¬¦-uï¼šåˆå¹¶æ˜¾ç¤ºå†…å®¹ç›¸åŒçš„è¡Œ ç¤ºä¾‹ç”¨äºŽæ¼”ç¤ºçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š123456$ cat sort.txtAAA:BBaaa:4ccc:10bbb:20bbb:8 ç®€å•æŽ’åº123456$ sort sort.txtAAA:BBaaa:4bbb:20bbb:8ccc:10 æŒ‰ç…§ BB åˆ—çš„æ•°å­—ç”±å¤§åˆ°å°æŽ’åº12345678$ sort -nr -t: -k2 sort.txtbbb:20ccc:10bbb:8aaa:4AAA:BB# -n è¡¨ç¤ºæŒ‰ç…§æ•°å­—å¤§å°æŽ’åºï¼Œ-r è¡¨ç¤ºåå‘æŽ’åº# -t: è¡¨ç¤ºå†’å·ä½œä¸ºæ ä½åˆ†éš”ç¬¦ï¼Œ-k2 è¡¨ç¤ºç¬¬äºŒæ ï¼ˆå³ BB åˆ—ï¼‰ä½œä¸ºæŽ’åºä¾æ® å››ã€uniq å‘½ä»¤uniq å‘½ä»¤ç”¨äºŽæŠ¥å‘Šæˆ–è¿‡æ»¤æ–‡ä»¶ä¸­å†…å®¹é‡å¤çš„è¡Œ é€‰é¡¹-cï¼šåœ¨æ¯è¡Œè¾“å‡ºå†…å®¹çš„è¡Œé¦–åŠ ä¸Šè¯¥è¡Œé‡å¤çš„æ¬¡æ•°-dï¼šä»…æ˜¾ç¤ºå†…å®¹é‡å¤çš„è¡Œ-uï¼šä»…æ˜¾ç¤ºå†…å®¹æœªé‡å¤çš„è¡Œ-fï¼šä¸æ¯”è¾ƒæŒ‡å®šçš„æ ä½-sï¼šä¸æ¯”è¾ƒæŒ‡å®šçš„å­—ç¬¦ ç¤ºä¾‹1234567891011121314151617181920212223242526# æºæ–‡ä»¶$ cat uniq.txthelloworldhelloworldhelloshellhellotext# åˆ é™¤é‡å¤è¡Œ$ uniq uniq.txthelloworldhelloshellhellotext# åªæ˜¾ç¤ºæœªé‡å¤çš„å†…å®¹$ uniq -u uniq.txthelloshellhellotext# ç»Ÿè®¡å„è¡Œå‡ºçŽ°çš„æ¬¡æ•°$ uniq -c uniq.txt 2 helloworld 1 helloshell 1 hellotext# åªæ˜¾ç¤ºé‡å¤è¡Œ$ uniq -d uniq.txthelloworld]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
        <tag>Text</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gawk ä½¿ç”¨æ–¹æ³•ç®€ä»‹]]></title>
    <url>%2F2018%2F06%2F30%2Fgawk-manual%2F</url>
    <content type="text"><![CDATA[gawk æ˜¯æœ€åˆ Unix ç³»ç»Ÿä¸Š awk ç¨‹åºçš„ GNU ç‰ˆæœ¬ã€‚ç›¸å¯¹äºŽä½œä¸ºæµå¼ç¼–è¾‘å™¨çš„ sed è€Œè¨€ï¼Œå®ƒæä¾›äº†æ›´ä¸ºå¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ç‰¹æ€§ã€‚ å…¶åŠŸèƒ½ä¸Žç‰¹æ€§åŒ…æ‹¬ï¼š å®šä¹‰å˜é‡æ¥å­˜å‚¨æ•°æ® é€šè¿‡ä»£æ•°è¿ç®—ç¬¦å’Œå­—ç¬¦ä¸²æ“ä½œç¬¦æ¥å¤„ç†æ•°æ® ä½¿ç”¨ç»“æž„åŒ–ç¼–ç¨‹è¯­å¥å¦‚ if-then å’Œå¾ªçŽ¯ç­‰ ä»Žæ•°æ®æ–‡ä»¶ä¸­æå–å‡ºæœ‰ä»·å€¼çš„å­—æ®µå†é‡æ–°ç»„åˆä»¥ç”Ÿæˆç»“æž„åŒ–çš„æŠ¥è¡¨ åŸºæœ¬è¯­æ³•gawk options program file æž„æˆ gawk è„šæœ¬çš„è¯­å¥é¡»åŒ…å«åœ¨ä¸€å¯¹å¤§æ‹¬å·ï¼ˆ {} ï¼‰ä¸­ï¼Œè€Œä½œä¸ºå‘½ä»¤é€‰é¡¹çš„æ•´ä¸ªè„šæœ¬éœ€è¦åŒ…å«åœ¨ä¸€å¯¹å¼•å·ä¸­ï¼š1234$ cat test.txtHello World!$ gawk &apos;&#123;print $0&#125;&apos; test.txtHello World! 1. ä½¿ç”¨å­—æ®µå˜é‡gawk ä¼šè‡ªåŠ¨åœ°å°†æ¯è¡Œæ–‡æœ¬ä¸­çš„æ¯ä¸ªæ•°æ®å­—æ®µèµ‹å€¼ç»™ä¸€ä¸ªæŒ‡å®šçš„å˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé¢„å…ˆå®šä¹‰çš„å˜é‡ä¸ºï¼š $0 è¡¨ç¤ºä¸€æ•´è¡Œæ–‡æœ¬ $1 è¡¨ç¤ºè¯¥è¡Œæ–‡æœ¬çš„ç¬¬ä¸€ä¸ªå­—æ®µ $2 è¡¨ç¤ºè¯¥è¡Œæ–‡æœ¬çš„ç¬¬äºŒä¸ªå­—æ®µ $n è¡¨ç¤ºè¯¥è¡Œæ–‡æœ¬çš„ç¬¬ n ä¸ªå­—æ®µ æ–‡æœ¬è¡Œä¸­çš„æ•°æ®å­—æ®µæ˜¯é€šè¿‡é¢„å…ˆå®šä¹‰çš„å­—æ®µåˆ†éš”ç¬¦æ¥åˆ†éš”å¼€çš„ï¼Œé»˜è®¤ä¸ºç©ºæ ¼ï¼ˆåŒ…æ‹¬ TAB ï¼‰12345678$ cat data.txtOne line of test text.Two lines of test text. Three lines of test text.$ gawk &apos;&#123;print $1&#125;&apos; data.txt OneTwoThree å¯ä»¥é€šè¿‡ -F é€‰é¡¹æŒ‡å®šå¦å¤–çš„åˆ†éš”ç¬¦ï¼ˆå¦‚ â€˜ , â€˜ ï¼‰12345678$ cat user.csvJack,male,20Rose,female,18Mike,male,24$ gawk -F, &apos;&#123;print $1&#125;&apos; user.csvJackRoseMike 2. å¤šä¸ªå‘½ä»¤gawk è¯­è¨€å…è®¸åœ¨è„šæœ¬è¯­å¥ä¸­ç»„åˆå¤šä¸ªå‘½ä»¤ä½¿ç”¨ï¼Œåªéœ€è¦åœ¨å„å‘½ä»¤ä¹‹é—´ä½¿ç”¨åˆ†å·ï¼ˆ ; ï¼‰åˆ†éš”å¼€å³å¯12$ echo &quot;My name is Rich&quot; | gawk &apos;&#123;$4=&quot;Christine&quot;; print $0&#125;&apos; My name is Christine ä¹Ÿå¯ä»¥è¿™æ ·ï¼š12345$ gawk &apos;&#123;&gt; $4=&quot;Christine&quot;&gt; print $0&#125;&apos;My name is RichMy name is Christine å…¶ä¸­ My name is Rich æ˜¯è¿è¡Œæ—¶ç¨‹åºèŽ·å–çš„ç”¨æˆ·è¾“å…¥ï¼ŒMy name is Christine æ˜¯ç¨‹åºè¿è¡ŒåŽçš„è¾“å‡º 3. BEGIN &amp; ENDé»˜è®¤æƒ…å†µä¸‹ï¼Œgawk ä»Žè¾“å…¥ä¸­è¯»å–ä¸€è¡Œæ–‡æœ¬ï¼Œå†å¯¹è¯¥æ–‡æœ¬æ‰§è¡Œç¨‹åºæŒ‡ä»¤ã€‚è€Œæœ‰æ—¶å€™éœ€è¦åœ¨è¯»å–å¾…å¤„ç†æ•°æ®ä¹‹å‰å…ˆæ‰§è¡ŒæŸäº›æŒ‡ä»¤ï¼Œæ­¤æ—¶å°±è¦ç”¨åˆ°BEGINå…³é”®å­—ã€‚åŒæ ·çš„ï¼ŒEND å…³é”®å­—å…è®¸ä½ æŒ‡å®šåœ¨æ•°æ®å¤„ç†å®ŒæˆåŽæ‰æ‰§è¡Œçš„è„šæœ¬ã€‚12345678$ gawk &apos;BEGIN &#123;print &quot;The data File Contents:&quot;&#125; &gt; &#123;print $0&#125;&gt; END &#123;print &quot;End of File&quot;&#125;&apos; data.txt The data File Contents:One line of test text.Two lines of test text. Three lines of test text.End of File 4. ä»Žæ–‡ä»¶ä¸­èŽ·å–è„šæœ¬gawk å…è®¸å…ˆå°†å…¶ç¨‹åºè„šæœ¬ä¿å­˜åœ¨æŸä¸ªæ–‡ä»¶ä¸­ï¼Œå†é€šè¿‡ -f é€‰é¡¹æŒ‡å®šè¯¥æ–‡ä»¶çš„æ–‡ä»¶åã€‚è€Œåœ¨è„šæœ¬æ–‡ä»¶ä¸­ï¼Œå„å‘½ä»¤ä¸å†éœ€è¦é€šè¿‡ â€˜;â€™ ç¬¦å·åˆ†éš”ï¼Œç›´æŽ¥åˆ†è¡Œåˆ—å‡ºå³å¯ã€‚12345678910111213141516171819$ cat script.gawkBEGIN &#123;print &quot;Users and their age&quot; print &quot;User \t Age&quot;FS=&quot;,&quot;&#125;&#123; print $1 &quot; \t &quot; $3&#125;END &#123;print &quot;There are three people&quot; &#125;$ gawk -f script.gawk user.csvUsers and their ageUser AgeJack 20Rose 18Mike 24There are three people ä¸Šè¿°è„šæœ¬æ–‡ä»¶ä¸­çš„ FS=â€,â€ ç”¨äºŽå®šä¹‰å­—æ®µåˆ†éš”ç¬¦ï¼Œæ•ˆæžœç­‰åŒäºŽ -F é€‰é¡¹ã€‚ é«˜çº§ç‰¹æ€§1. å˜é‡ç¨‹åºè¯­è¨€æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å®šä¹‰å’Œå¼•ç”¨å˜é‡ã€‚gawk è¯­è¨€æ”¯æŒä¸¤ç§ç±»åž‹çš„å˜é‡ï¼šå†…å»ºå˜é‡å’Œç”¨æˆ·è‡ªå®šä¹‰å˜é‡ã€‚ gawk ç¨‹åºåœ¨å¤„ç†æ–‡æœ¬æ•°æ®æ—¶ï¼Œä¸€æ¬¡åªè¯»å–ä¸€å°æ®µæ–‡æœ¬ï¼Œç§°ä¸º Record ã€‚é»˜è®¤çš„ Record åˆ†éš”ç¬¦å³ä¸ºæ¢è¡Œç¬¦ã€‚è€Œæ¯æ¡ Record åˆå¯è¿›ä¸€æ­¥åˆ’åˆ†æˆå­—æ®µï¼ˆData Fieldï¼‰ï¼Œå¹¶æŒ‰é¡ºåºä¾æ¬¡èµ‹å€¼ç»™ $1ï¼Œ$2ï¼Œ$n ç­‰ã€‚é»˜è®¤çš„å­—æ®µåˆ†éš”ç¬¦ä¸ºç©ºæ ¼ï¼ˆåŒ…æ‹¬ TABï¼‰ æŽ§åˆ¶æ•°æ®å­—æ®µå’Œ Record çš„å†…å»ºå˜é‡ï¼š å˜é‡å æè¿° FIELDWIDTHS ç”¨ä¸€ä¸²ç”±ç©ºæ ¼åˆ†éš”çš„æ•°å­—å®šä¹‰æ¯ä¸ªæ•°æ®å­—æ®µçš„å…·ä½“å®½åº¦ FS å®šä¹‰æ•°æ®å­—æ®µåˆ†å‰²ç¬¦ï¼ˆè¾“å…¥ï¼‰ RS å®šä¹‰ Record åˆ†å‰²ç¬¦ï¼ˆè¾“å…¥ï¼‰ OFS å®šä¹‰æ•°æ®å­—æ®µåˆ†å‰²ç¬¦ï¼ˆè¾“å‡ºï¼‰ ORS å®šä¹‰ Record åˆ†å‰²ç¬¦ï¼ˆè¾“å‡ºï¼‰ é»˜è®¤çš„ OFS ä¸ºç©ºæ ¼12345678$ gawk &apos;BEGIN&#123;FS=&quot;,&quot;&#125; &#123;print $1,$2,$3&#125;&apos; user.csvJack male 20Rose female 18Mike male 24$ gawk &apos;BEGIN&#123;FS=&quot;,&quot;;OFS=&quot;:&quot;&#125; &#123;print $1,$2,$3&#125;&apos; user.csvJack:male:20Rose:female:18Mike:male:24 å½“å®šä¹‰äº† FIELDWIDTHS å˜é‡æ—¶ï¼Œgawk åœ¨è¯»å–æ•°æ®æ—¶å°±ä¼šå¿½ç•¥å­—æ®µåˆ†å‰²ç¬¦ï¼ˆFSï¼‰ï¼Œè½¬è€Œä½¿ç”¨å­—æ®µå®½åº¦æ¥åˆ†å‰²æ•°æ®ã€‚12345678$ cat numbers.txt1005.3247596.3711522.349194.0005810.1298100.1$ gawk &apos;BEGIN&#123;FIELDWIDTHS=&quot;3 5 2 5&quot;&#125; &#123;print $1,$2,$3,$4&#125;&apos; numbers.txt100 5.324 75 96.37115 22.34 91 94.00 058 10.12 98 100.1 æœ‰äº›æ—¶å€™ä¼šé‡åˆ°å¦‚ä¸‹ç»„ç»‡æ–¹å¼çš„æ–‡æœ¬æ–‡ä»¶ï¼š12345678910$ cat people.txtRiley Mullen123 Main StreetChicago, IL 60601(312)555-1234Frank Williams456 Oak StreetIndianapolis, IN 46201(317)555-9876 æ­¤æ—¶å¯å°†å­—æ®µåˆ†éš”ç¬¦ï¼ˆFSï¼‰è®¾ç½®ä¸º â€œ\nâ€ï¼ŒRecord åˆ†éš”ç¬¦ï¼ˆRSï¼‰è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™ gawk ç¨‹åºä¼šå°†ç©ºè¡Œä½œä¸ºä¸€æ¡ Record çš„ç»ˆæ­¢ç‚¹ã€‚123$ gawk &apos;BEGIN&#123;FS=&quot;\n&quot;; RS=&quot;&quot;&#125; &#123;print $1,$4&#125;&apos; people.txtRiley Mullen (312)555-1234Frank Williams (317)555-9876 å…¶ä»–å†…å»ºå˜é‡ å˜é‡ æè¿° ARGC å½“å‰å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç›® ARGV ç”±å‘½ä»¤è¡Œå‚æ•°ç»„æˆçš„æ•°ç»„ CONVFMT æ•°å­—çš„è½¬æ¢æ ¼å¼ï¼Œé»˜è®¤å€¼ä¸º %.6 g ENVIRON åŒ…å«å½“å‰ç³»ç»ŸçŽ¯å¢ƒå˜é‡çš„å…³è”æ•°ç»„ï¼ˆå­—å…¸ï¼‰ ERRNO å½“è¯»å–æˆ–å…³é—­æ–‡ä»¶å‡ºçŽ°é”™è¯¯æ—¶è¿”å›žçš„ç³»ç»Ÿé”™è¯¯ FILENAME gawk å¤„ç†çš„æ•°æ®æ–‡ä»¶çš„æ–‡ä»¶å FNR å½“å‰æ­£åœ¨å¤„ç†çš„ Record åºå· IGNORECASE è®¾ç½®ä¸ºéžé›¶å€¼æ—¶å¿½ç•¥å¤§å°å†™ NF æ•°æ®æ–‡ä»¶ä¸­çš„å­—æ®µåºå· NR å·²å¤„ç†çš„ Record æ€»æ•° OFMT æ•°å­—çš„è¾“å‡ºæ ¼å¼ï¼Œé»˜è®¤ä¸º %.6 g 123456789$ gawk &apos;BEGIN&#123;FS=&quot;,&quot;;&gt; print ARGC,ARGV[0],ARGV[1];&gt; print ENVIRON[&quot;HOME&quot;]&#125;&gt; &#123;print FILENAME,FNR &quot;:&quot; $1&#125;&apos; user.csv2 gawk user.csv/Users/starkyuser.csv 1:Jackuser.csv 2:Roseuser.csv 3:Mike ARGV çš„ç´¢å¼•æ˜¯ä»Ž 0 å¼€å§‹çš„ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼ˆå‘ƒï¼Œæ‰€ä»¥é€šå¸¸å°±æ˜¯ gawk è¿™ä¸ªå‘½ä»¤æœ¬èº«ï¼‰ã€‚ç¨‹åºè„šæœ¬ï¼ˆå¼•å·ä¸­çš„å†…å®¹ï¼‰ä¸ç®—åœ¨å‚æ•°å†…ã€‚ ç”¨æˆ·è‡ªå®šä¹‰å˜é‡ åœ¨è„šæœ¬ä¸­å®šä¹‰å˜é‡ 1234567891011$ gawk &apos;&gt; BEGIN&#123;&gt; testing = &quot;This is a test&quot; &gt; print testing&gt; testing = 45&gt; print testing&gt; &#125;&apos;This is a test45$ gawk &apos;BEGIN&#123;x = 4; x = x * 2 + 3; print x&#125;&apos;11 åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­å®šä¹‰å˜é‡ 1234567$ cat script1.gawkBEGIN&#123;FS = &quot;,&quot;&#125;&#123;print $n&#125;$ gawk -f script1.gawk n=1 user.csvJackRoseMike 2. æ•°ç»„å®šä¹‰æ•°ç»„ï¼švar[index]=element1234567$ gawk &apos;BEGIN&#123;&gt; var[1] = 34&gt; var[2] = 3&gt; total = var[1] + var[2] &gt; print total&gt; &#125;&apos; 37 éåŽ†æ•°ç»„ï¼š1234for (var in array) &#123; statements&#125; 1234567891011121314$ gawk &apos;BEGIN&#123;&gt; var[&quot;a&quot;] = 1&gt; var[&quot;g&quot;] = 2&gt; var[&quot;m&quot;] = 3&gt; var[&quot;u&quot;] = 4&gt; for (test in var) &gt; &#123;&gt; print &quot;Index:&quot;,test,&quot; Value:&quot;,var[test] &gt; &#125;&gt; &#125;&apos;Index: u Value: 4Index: m Value: 3Index: a Value: 1Index: g Value: 2 å…³è”æ•°ç»„éåŽ†çš„é¡ºåºæ˜¯éšæœºçš„ 3. æ¨¡å¼åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼123456$ cat user.csvJack,male,20Rose,female,18Mike,male,24$ gawk &apos;BEGIN&#123;FS=&quot;,&quot;&#125; /Jack/&#123;print $0&#125;&apos; user.csvJack,male,20 åŒ¹é…ç¬¦ï¼ˆ~ï¼‰åŒ¹é…ç¬¦ï¼ˆ~ï¼‰ç”¨æ¥å¯¹ Record ä¸­çš„ç‰¹å®šå­—æ®µä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚!~ è¡¨ç¤ºä¸åŒ¹é…ã€‚1234567891011$ cat dataThis is line 1Another lineline threeThis is line four$ gawk &apos;$3 ~ /line/&#123;print $0&#125;&apos; dataThis is line 1This is line four$ gawk &apos;$3 !~ /line/&#123;print $0&#125;&apos; dataAnother lineline three æ•°å­¦è¡¨è¾¾å¼1234567$ cat user.csvJack,male,20Rose,female,18Mike,male,24$ gawk &apos;BEGIN&#123;FS=&quot;,&quot;&#125; $3 &gt;= 20&#123;print $0&#125;&apos; user.csvJack,male,20Mike,male,24 4. ç»“æž„åŒ–å‘½ä»¤if if (condition) statement123456789101112131415161718192021$ cat numbers246810$ gawk &apos;&#123;&gt; if ($1 &lt; 5)&gt; &#123;&gt; x = $1 - 2&gt; print x&gt; &#125; else&gt; &#123;&gt; x = $1 / 2&gt; print x&gt; &#125;&#125;&apos; numbers02345 while1234while (condition)&#123; statements&#125; 123456789101112131415161718cat number130 120 135160 113 140145 170 215$ gawk &apos;&#123;&gt; total = 0&gt; i = 1&gt; while (i &lt;= 3)&gt; &#123;&gt; total += $i&gt; i++&gt; &#125;&gt; avg = total / 3&gt; print &quot;Average:&quot;,avg&gt; &#125;&apos; numberAverage: 128.333Average: 137.667Average: 176.667 forfor( variable assignment; condition; iteration process)123456789101112$ gawk &apos;&#123;&gt; total = 0&gt; for (i = 1; i &lt; 4; i++)&gt; &#123;&gt; total += $1&gt; &#125;&gt; avg = total / 3&gt; print &quot;Average:&quot;,avg&gt; &#125;&apos; numberAverage: 130Average: 160Average: 145 5. æ ¼å¼åŒ–è¾“å‡ºprintf å‘½ä»¤æ ¼å¼ï¼šprintf &quot;format string&quot;, var1, var2 . . .å¸¸ç”¨æ ¼å¼æŽ§åˆ¶ç¬¦å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š æŽ§åˆ¶å­—ç¬¦ æè¿° c å°†æ•°å­—æ˜¾ç¤ºä¸ºå¯¹åº”çš„ ASCII å­—ç¬¦ d æˆ– i æ˜¾ç¤ºæ•´æ•° e å°†æ•°å­—ä»¥ç§‘å­¦è®°æ•°æ³•æ˜¾ç¤º f æ˜¾ç¤ºæµ®ç‚¹æ•° g ä»¥ç§‘å­¦è®¡ç®—æ³•æˆ–æµ®ç‚¹æ•°æ˜¾ç¤ºï¼ˆçœ‹å“ªç§æ›´çŸ­ï¼‰ o ä»¥å…«è¿›åˆ¶æ˜¾ç¤º s æ˜¾ç¤ºå­—ç¬¦ä¸² x ä»¥åå…­è¿›åˆ¶æ˜¾ç¤º X ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºï¼Œä½¿ç”¨å¤§å†™çš„ A-F 12345$ gawk &apos;BEGIN&#123;&gt; x = 10 * 100&gt; printf &quot;The answer is: %e\n&quot;, x&gt; &#125;&apos;The answer is: 1.000000e+03 é™¤æŽ§åˆ¶å­—ç¬¦ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¦å¤–ä¸‰ç§ä¿®é¥°ç¬¦ä»¥å¯¹è¾“å‡ºè¿›è¡Œæ›´å¤šçš„æŽ§åˆ¶ã€‚ width ï¼šè¯¥æ•°å€¼ç”¨äºŽæŒ‡å®šè¾“å‡ºçš„æœ€å°å®½åº¦ã€‚å¦‚é•¿åº¦ä¸å¤Ÿï¼Œç”¨ç©ºæ ¼è¡¥å…… prec ï¼šè¯¥æ•°å€¼ç”¨äºŽæŒ‡å®šæµ®ç‚¹æ•°çš„ç²¾ç¡®åº¦ï¼Œæˆ–è€…å­—ç¬¦ä¸²èƒ½åŒ…å«å­—ç¬¦çš„æœ€å¤§æ•°é‡ -ï¼ˆå‡å·ï¼‰ï¼šæ ¼å¼åŒ–è¾“å‡ºæ—¶ï¼Œä½¿ç”¨å·¦å¯¹é½ 1234567$ gawk &apos;BEGIN&#123;FS=&quot;\n&quot;; RS=&quot;&quot;&#125; &#123;printf &quot;%16s %s\n&quot;, $1, $4&#125;&apos; people.txt Riley Mullen (312)555-1234 Frank Williams (317)555-9876$$ gawk &apos;BEGIN&#123;FS=&quot;\n&quot;; RS=&quot;&quot;&#125; &#123;printf &quot;%-16s %s\n&quot;, $1, $4&#125;&apos; people.txtRiley Mullen (312)555-1234Frank Williams (317)555-9876 å‚è€ƒä¸‹é¢çš„ç¤ºä¾‹ï¼Œ %10.1f ä¸­çš„ 10 ç”¨äºŽæŒ‡å®šå­—æ®µçš„æœ€å°å®½åº¦ï¼ˆå³å¯¹é½ï¼Œå‰é¢ç”¨ç©ºæ ¼è¡¥ï¼‰ï¼Œ.1 ç”¨äºŽæŒ‡å®šç²¾ç¡®åº¦ã€‚123456789101112$ gawk &apos;&#123;&gt; total = 0&gt; for (i = 1; i &lt; 4; i++)&gt; &#123;&gt; total += $i&gt; &#125;&gt; avg = total / 3&gt; printf &quot;Average: %10.1f\n&quot;,avg&gt; &#125;&apos; numberAverage: 128.3Average: 137.7Average: 176.7 6. å†…å»ºå‡½æ•°æ•°å­¦å‡½æ•° å‡½æ•° æè¿° atan2(x,y) x / y çš„æ­£åˆ‡ cos(x) x çš„ä½™å¼¦ exp(x) x ä»¥ e ä¸ºåº•çš„æŒ‡æ•° int(x) x çš„æ•´æ•°éƒ¨åˆ† log(x) x çš„è‡ªç„¶å¯¹æ•° rand() ç”Ÿæˆä»‹äºŽ 0 å’Œ 1 ä¹‹é—´çš„éšæœºæ•° sin(x) x çš„æ­£å¼¦ sqrt(x) x çš„å¹³æ–¹æ ¹ srand(x) æŒ‡å®šç”Ÿæˆéšæœºæ•°çš„ç§å­ 1234$ gawk &apos;BEGIN&#123;x=exp(100); print x&#125;&apos;26881171418161356094253400435962903554686976$ gawk &apos;BEGIN&#123;x=exp(1000); print x&#125;&apos;inf å­—ç¬¦ä¸²å‡½æ•° å‡½æ•° æè¿° gensub(r, s, h [, t]) è¯¥å‡½æ•°ç”¨äºŽæ£€ç´¢å­—ç¬¦ä¸²ï¼ˆé»˜è®¤ä¸º $0 ï¼Œå¦‚ t æŒ‡å®šï¼Œåˆ™æ£€ç´¢å­—ç¬¦ä¸² tï¼‰ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼ r è¿›è¡ŒåŒ¹é…ï¼Œå¹¶å°†åŒ¹é…ç»“æžœæ›¿æ¢ä¸º s ã€‚å¦‚ h ä¸º â€œgâ€ æˆ– â€œGâ€ ï¼Œåˆ™æ‰§è¡Œå…¨å±€æ›¿æ¢ï¼›å¦‚ h ä¸ºæ•°å­—ï¼Œåˆ™åªå°†ç¬¬ h ä¸ªåŒ¹é…é¡¹æ›¿æ¢ä¸º s gsub(r, s [,t] è¯¥å‡½æ•°ç”¨äºŽæ£€ç´¢å­—ç¬¦ä¸²ï¼ˆé»˜è®¤ä¸º $0 ï¼Œå¦‚ t æŒ‡å®šï¼Œåˆ™æ£€ç´¢å­—ç¬¦ä¸² tï¼‰ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼ r è¿›è¡ŒåŒ¹é…ï¼Œå¹¶å°†åŒ¹é…ç»“æžœæ›¿æ¢ä¸º s ï¼ˆå…¨å±€æ›¿æ¢ï¼‰ index(s, t) è¯¥å‡½æ•°ç”¨äºŽè¿”å›žå­—ç¬¦ä¸² t åœ¨å­—ç¬¦ä¸² s ä¸­çš„ä½ç½®ç´¢å¼•ï¼ˆå¦‚ s ä¸åŒ…å« t ï¼Œåˆ™è¿”å›ž 0ï¼‰ length([s]) è¯¥å‡½æ•°ç”¨äºŽè¿”å›žå­—ç¬¦ä¸² s çš„é•¿åº¦ï¼Œå¦‚ s æœªæŒ‡å®šï¼Œåˆ™è¿”å›ž $0 çš„é•¿åº¦ match(s, r ) è¯¥å‡½æ•°ç”¨äºŽè¿”å›žå­—ç¬¦ä¸² s ä¸­æ­£åˆ™è¡¨è¾¾å¼ r çš„ä½ç½®ç´¢å¼• split(s, a [,r]) è¯¥å‡½æ•°ç”¨äºŽå°†å­—ç¬¦ä¸² s æ ¹æ® FS ç¬¦åˆ†å‰²åŽçš„å­—æ®µä¿å­˜åœ¨æ•°ç»„ a ä¸­ã€‚å¦‚å·²æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼ r ï¼Œåˆ™æ ¹æ® r è€Œä¸æ˜¯ FS è¿›è¡Œåˆ†å‰² sprintf(format, variablies) è¯¥å‡½æ•°ç”¨äºŽè¿”å›žä¸€ä¸ªæ ¼å¼åŒ–åŽçš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ç±»ä¼¼ printf å‡½æ•°çš„è¾“å‡º sub(r, s [,t]) è¯¥å‡½æ•°ç”¨äºŽæ£€ç´¢æŒ‡å®šå­—ç¬¦ä¸² t ï¼ˆå¦‚æžœæœªæŒ‡å®š t ï¼Œåˆ™æ£€ç´¢ $0ï¼‰ï¼Œå¹¶ä½¿ç”¨ s æ›¿æ¢ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åŒ¹é…ç»“æžœ tolower(s) å°†å­—ç¬¦ä¸² s ä¸­çš„æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå°å†™ toupper(s) å°†å­—ç¬¦ä¸² s ä¸­çš„æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå¤§å†™ 123456789101112131415161718192021222324252627$ gawk &apos;BEGIN&#123;&gt; x = &quot;hello world, hello gawk, hello text&quot;&gt; y = gensub(&quot;hello&quot;,&quot;nihao&quot;,&quot;g&quot;,x)&gt; print y&#125;&apos;nihao world, nihao gawk, nihao text$ gawk &apos;BEGIN&#123;&gt; x = &quot;hello world, hello gawk, hello text&quot;&gt; y = gensub(&quot;hello&quot;,&quot;nihao&quot;,2,x)&gt; print y&#125;&apos;hello world, nihao gawk, hello text$$ gawk &apos;BEGIN&#123;&gt; x = &quot;hello world, hello gawk, hello text&quot;&gt; gsub(&quot;hello&quot;,&quot;nihao&quot;,x)&gt; print x&#125;&apos;nihao world, nihao gawk, nihao text$$ gawk &apos;BEGIN&#123;&gt; x = &quot;hello world, hello gawk, hello text&quot;&gt; split(x,var)&gt; print var[2] var[4] var[6]&#125;&apos;world,gawk,text$ gawk &apos;BEGIN&#123;&gt; x = &quot;hello world, hello gawk, hello text&quot;&gt; split(x,var,&quot;,&quot;)&gt; print var[1] var[2] var[3]&#125;&apos;hello world hello gawk hello text æ—¶é—´å‡½æ•° å‡½æ•° æè¿° mktime(datespec) å°†æ™®é€šæ ¼å¼ï¼ˆ YYYY MM DD HH MM SS ï¼‰çš„æ—¶é—´æ—¥æœŸè½¬æ¢æˆæ—¶é—´æˆ³ strftime(format [,timestamp]) å°†æŒ‡å®šæ—¶é—´æˆ³ï¼ˆå¦‚æœªæŒ‡å®šï¼Œä½¿ç”¨å½“å‰æ—¶é—´æˆ³ï¼‰è½¬æ¢æˆæŒ‡å®šçš„æ—¶é—´æ—¥æœŸæ ¼å¼ systime() è¿”å›žå½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ 123456$ gawk &apos;BEGIN&#123;&gt; date = systime()&gt; day = strftime(&quot;%A, %B %d, %Y&quot;, date)&gt; print day&gt; &#125;&apos;Saturday, June 30, 2018 ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å®šä¹‰å‡½æ•°1234function name([variables])&#123; statements&#125; ä½¿ç”¨å‡½æ•°1234567891011$ gawk &apos;&gt; function myprint()&gt; &#123;&gt; printf &quot;%-16s - %s\n&quot;, $1, $4&gt; &#125;&gt; BEGIN&#123;FS=&quot;\n&quot;; RS=&quot;&quot;&#125;&gt; &#123;&gt; myprint()&gt; &#125;&apos; people.txtRiley Mullen - (312)555-1234Frank Williams - (317)555-9876 å‡½æ•°åº“åˆ›å»ºå‡½æ•°åº“12345678910111213$ cat funclibfunction myprint()&#123; printf &quot;%-16s - %s\n&quot;, $1, $4&#125;function myrand(limit)&#123; return int(limit * rand())&#125;function printthird()&#123; print $3&#125; è°ƒç”¨å‡½æ•°åº“123456789$ cat scriptBEGIN&#123; FS=&quot;\n&quot;; RS=&quot;&quot;&#125;&#123; myprint()&#125;$$ gawk -f funclib -f script people.txtRiley Mullen - (312)555-1234Frank Williams - (317)555-9876 å‚è€ƒä¹¦ç±Linux Command Line and Shell Scripting Bible 3rd Edition]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Text</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[emacs é€ŸæŸ¥æ‰‹å†Œ]]></title>
    <url>%2F2018%2F06%2F29%2Femacs-quick-reference%2F</url>
    <content type="text"><![CDATA[Emacs æ˜¯ä¸€ä¸ªåŽ†å²æ‚ ä¹…çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆæœ€åˆç‰ˆæœ¬å‘å¸ƒäºŽ 1976 å¹´ï¼‰ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ª Emacs Lispï¼ˆLisp ç¼–ç¨‹è¯­è¨€çš„ä¸€ç§æ–¹è¨€ï¼‰çš„è§£é‡Šå™¨ï¼Œè¿™ç»™äºˆäº†å®ƒè¿‘ä¹Žå˜æ€çš„æ‰©å±•æ€§å’Œå®šåˆ¶æ€§ã€‚Emacs æœ‰ç€â€œç¥žä¹‹ç¼–è¾‘å™¨â€å’Œâ€œä¼ªè£…æˆæ“ä½œç³»ç»Ÿçš„ç¼–è¾‘å™¨â€çš„ç§°å·ï¼ŒåŠŸèƒ½çš„å¼ºå¤§ä¸Žçµæ´»å¯æƒ³è€ŒçŸ¥ã€‚ ä¸€ã€è¿›å…¥ emacsç›´æŽ¥åœ¨ç»ˆç«¯è¾“å…¥ emacs å‘½ä»¤å³å¯è¿›å…¥ emacs ç¼–è¾‘å™¨ï¼Œè¯¥å‘½ä»¤åŽé¢å¯è·Ÿä¸€ä¸ªæˆ–å¤šä¸ªéœ€è¦ç¼–è¾‘çš„æ–‡ä»¶ã€‚ä½¿ç”¨ --no--init-file æˆ– -q é€‰é¡¹å¯ä»¥åœ¨å¯åŠ¨æ—¶ä¸ä½¿ç”¨ä»»ä½•åˆå§‹é…ç½®æ–‡ä»¶ï¼ˆ ~/.emacs æˆ– default.el ï¼‰å½“ç„¶è¿™ä¸ªç•Œé¢ï¼Œçœ‹ä¸ŠåŽ»ç¨å¾®æœ‰äº›å¹´ä»£æ„Ÿâ€¦â€¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å¯åŠ¨é…ç½®æ–‡ä»¶ï¼ˆ~/.emacsï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789101112; .emacs ç•Œé¢é…ç½®(setq default-frame-alist &apos;((vertical-scroll-bars) (top . 25) (left . 45) (background-color . &quot;black&quot;) (foreground-color . &quot;grey&quot;) (cursor-color . &quot;gold1&quot;) (tool-bar-lines . 0) (menu-bar-lines . 1)))(set-default-font &quot;Source Code Pro 16&quot;)(setq inhibit-startup-message t) ä¿®æ”¹åŽçš„æ•ˆæžœï¼š äºŒã€é€€å‡º emacs ç»„åˆé”®å®šä¹‰ï¼šC è¡¨ç¤º Ctrl é”®ï¼ŒM è¡¨ç¤º Windowsç³»ç»Ÿé‡Œçš„ alt é”®å’Œ MacOS ç³»ç»Ÿé‡Œçš„ option é”®ã€‚ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ï¼ˆæŒ‰ä¸‹ M-x åŽè¾“å…¥ï¼‰ æŒ‚èµ· emacsï¼ˆåœ¨å›¾å½¢æ¨¡å¼ä¸‹ï¼šæœ€å°åŒ–/è¿˜åŽŸï¼‰ C-z suspend-emacsï¼ˆsuspend-frameï¼‰ é€€å‡º emacs C-x C-c save-buffers-kill-terminal ä¸‰ã€æ–‡ä»¶æ“ä½œ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ï¼ˆæŒ‰ä¸‹ M-x åŽè¾“å…¥ï¼‰ è¯»å–æ–‡ä»¶å†…å®¹åˆ° emacs ä¸­ï¼ˆæ‰“å¼€æ–‡ä»¶ï¼‰ C-x C-f find-file ä¿å­˜æ–‡ä»¶ C-x C-s save-buffer ä¿å­˜æ‰€æœ‰æ–‡ä»¶ C-x s save-some-buffers å°†å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°å½“å‰æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶ä¸­ C-x i insert-file å…³é—­å½“å‰æ–‡ä»¶å¹¶æ‰“å¼€å¦ä¸€ä¸ªæ–‡ä»¶ C-x C-v find-alternate-file å°†å½“å‰ buffer ä¸­çš„å†…å®¹å†™å…¥åˆ°æŒ‡å®šçš„æ–‡ä»¶ï¼ˆå¦å­˜ä¸ºï¼‰ C-x C-w write-file å¯ç”¨/å…³é—­å½“å‰ buffer çš„åªè¯»æ¨¡å¼ C-x C-q read-only-mode å››ã€èŽ·å–å¸®åŠ© åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ æ–°æ‰‹æŒ‡å¼• C-h t help-with-tutorial æ˜¾ç¤ºåŒ¹é…æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„å‘½ä»¤ C-h a apropos-command æ˜¾ç¤ºç»‘å®šæŒ‡å®šå¿«æ·é”®çš„å‡½æ•°çš„å¸®åŠ©ä¿¡æ¯ C-h k describe-key æ˜¾ç¤ºæŒ‡å®šå‡½æ•°ï¼ˆå‘½ä»¤ï¼‰çš„å¸®åŠ©ä¿¡æ¯ C-h f describe-function æ˜¾ç¤º Mode ç›¸å…³çš„ä¿¡æ¯ C-h m describe-mode äº”ã€é”™è¯¯æ¢å¤ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ ä¸­æ–­æ­£åœ¨è¾“å…¥æˆ–æ‰§è¡Œä¸­çš„å‘½ä»¤ C-g keyboard-quit æ¢å¤ç”±äºŽç³»ç»Ÿå´©æºƒæœªä¿å­˜çš„æ–‡ä»¶ M-x recover-session recover-session æ’¤é”€ä¸æƒ³è¦çš„æ“ä½œ C-x u æˆ– C-_ æˆ– C-/ undo å°† buffer æ¢å¤åˆ°åˆå§‹çŠ¶æ€ M-x revert-buffer revert-buffer å…­ã€å¢žé‡æœç´¢ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ å‘å‰æœç´¢ï¼ˆå‘æ–‡æ¡£åº•éƒ¨æœç´¢ï¼‰ C-s isearch-repeat-forward å‘åŽæœç´¢ï¼ˆå‘æ–‡æ¡£é¡¶éƒ¨æœç´¢ï¼‰ C-r isearch-repeat-backward æ­£åˆ™è¡¨è¾¾å¼æœç´¢ï¼ˆå‘æ–‡æ¡£åº•éƒ¨ï¼‰ C-M-s isearch-forward-regexp æ­£åˆ™è¡¨è¾¾å¼æœç´¢ï¼ˆæƒ³æ–‡æ¡£é¡¶éƒ¨ï¼‰ C-M-r isearch-backward-regexp ä¸­æ–­å½“å‰æœç´¢ C-g keyboard-quit é‡å¤ä½¿ç”¨ C-s æˆ– C-r å¯ä»¥ç»§ç»­å½“å‰æ–¹å‘å¯¹åŒä¸€å…³é”®å­—çš„æœç´¢ï¼ˆå³è·³è½¬åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹ï¼‰ ä¸ƒã€Buffers åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ åˆ—å‡ºæ‰€æœ‰çš„ Buffer ä¿¡æ¯ C-x C-b list-buffers åˆ‡æ¢åˆ°å¦ä¸€ä¸ª Buffer C-x b switch-to-buffer å…³é—­ Buffer C-x k kill-buffer å…«ã€Shell å‘½ä»¤ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ æ‰§è¡Œ Shell å‘½ä»¤ M-! shell-command å¼‚æ­¥æ‰§è¡Œ Shell å‘½ä»¤ M-&amp; async-shell-command å¼€å¯ä¸€ä¸ª *Shell* çª—å£ç”¨äºŽæ‰§è¡Œå‘½ä»¤ M-x shell shell ä¹ã€ç§»åŠ¨ å¯¹è±¡ æ–¹å‘å‘åŽï¼ˆæ–‡æ¡£é¡¶éƒ¨ï¼‰ æ–¹å‘å‘å‰ï¼ˆæ–‡æ¡£åº•éƒ¨ï¼‰ å­—ç¬¦ C-b C-f å•è¯ M-b M-f è¡Œ C-p C-n è·³è½¬åˆ°è¡Œé¦–ï¼ˆè¡Œå°¾ï¼‰ C-a C-e å¥å­ M-a M-e æ®µè½ M-{ M-} é¡µé¢ C-x [ C-x ] å‡½æ•° C-M-a C-M-e è·³è½¬åˆ°æ–‡æ¡£å¼€å¤´ï¼ˆç»“å°¾ï¼‰ M-&lt; M-&gt; åã€è·³è½¬ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ æ»šåŠ¨åˆ°ä¸‹ï¼ˆåŽï¼‰ä¸€å± C-v scroll-up-command æ»šåŠ¨åˆ°ä¸Šï¼ˆå‰ï¼‰ä¸€å± M-v scroll-down-command å‘å·¦æ»šåŠ¨å±å¹• C-x &lt; scroll-left å‘å³æ»šåŠ¨å±å¹• C-x &gt; scroll-right å°†å½“å‰è¡Œç½®äºŽå±å¹•ä¸­å¤®/é¡¶éƒ¨/åº•éƒ¨ C-l recenter-top-bottom è·³è½¬åˆ°æŒ‡å®šè¡Œ M-g g goto-line è·³è½¬åˆ°æŒ‡å®šå­—ç¬¦ M-g c goto-char åä¸€ã€é€‰æ‹© åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ åœ¨å½“å‰ä½ç½®è®¾ç½®æ ‡è®° C-@ set-mark-command é€‰ä¸­æ•´ä¸ªæ®µè½ M-h mark-paragrath é€‰ä¸­æ•´ä¸ªé¡µé¢ C-x C-p mark-page é€‰ä¸­æ•´ä¸ªå‡½æ•° C-M-h mark-defun é€‰ä¸­æ•´ä¸ª Buffer C-x h mark-whole-buffer åäºŒã€æœç´¢æ›¿æ¢ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ ä»¥äº¤äº’çš„æ–¹å¼æ£€ç´¢å¹¶æ›¿æ¢å­—ç¬¦ä¸² M-% query-replace ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€ç´¢æ›¿æ¢ M-x query-replace-regexp query-replace-regexp äº¤æ¢æ¨¡å¼ä¸­çš„åˆæ³•è¾“å…¥ æ›¿æ¢å½“å‰åŒ¹é…å¹¶è·³è½¬åˆ°ä¸‹ä¸€ä¸ª SPACE æˆ– y æ›¿æ¢å½“å‰åŒ¹é…åŽä¸åšç§»åŠ¨ , è·³è¿‡å½“å‰åŒ¹é…ç›´æŽ¥åˆ°ä¸‹ä¸€ä¸ª DELETE æˆ– n æ›¿æ¢å‰©ä½™çš„æ‰€æœ‰åŒ¹é…é¡¹ ! è·³è½¬åˆ°ä¸Šä¸€ä¸ªåŒ¹é…é¡¹ ^ é€€å‡ºæœç´¢æ›¿æ¢æ¨¡å¼ ENTER åä¸‰ã€å¤šçª—å£ åŠŸèƒ½ å¿«æ·é”® å‘½ä»¤ å…³é—­å…¶ä»–æ‰€æœ‰çª—å£ï¼ˆåªæ˜¾ç¤ºå½“å‰çª—å£ï¼‰ C-x 1 delete-other-windows åˆ†å‰²å½“å‰çª—å£ï¼ˆä¸Šä¸‹ï¼‰ C-x 2 split-window-below å…³é—­å½“å‰çª—å£ C-x 0 delete-window åˆ†å‰²å½“å‰çª—å£ï¼ˆå·¦å³ï¼‰ C-x 3 split-window-right æ»šåŠ¨å¦ä¸€ä¸ªçª—å£çš„å†…å®¹ C-M-v scroll-other-window ç§»åŠ¨å…‰æ ‡åˆ°å¦ä¸€ä¸ªçª—å£ C-x o other-window åœ¨å¦ä¸€ä¸ªçª—å£æ‰“å¼€æ–‡ä»¶ C-x 4 f find-file-other-window åœ¨å¦ä¸€ä¸ªçª—å£è¿è¡Œ Dired C-x 4 d dired-other-window å¢žå¤§å½“å‰çª—å£é«˜åº¦ C-x ^ enlarge-window ç¼©å‡å½“å‰çª—å£å®½åº¦ C-x { shrink-window-horizontally å¢žå¤§å½“å‰çª—å£å®½åº¦ C-x } enlarge-window-horizontally åå››ã€Minibuffer åŠŸèƒ½ å¿«æ·é”® å°½å¯èƒ½è¡¥å…¨ TAB è¡¥å…¨è‡³ä¸€ä¸ªå®Œæ•´å•è¯ SPACE è¡¥å…¨å¹¶æ‰§è¡Œ ENTER æ˜¾ç¤ºæ‰€æœ‰å¯èƒ½çš„è¡¥å…¨ç»“æžœ ? èŽ·å–ä¸Šä¸€ä¸ªè¾“å…¥ M-p èŽ·å–ä¸‹ä¸€ä¸ªæˆ–é»˜è®¤è¾“å…¥ M-n å‘åŽæœç´¢è¾“å…¥åŽ†å²ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ M-r å‘å‰æœç´¢è¾“å…¥åŽ†å²ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ M-s ä¸­æ–­å‘½ä»¤æˆ–è¾“å…¥ C-g åäº”ã€ç®€å•å®šåˆ¶ åŠŸèƒ½ æŒ‰é”® å®šä¹‰å˜é‡æˆ–å¤–è§‚ M-x customize è‡ªå®šä¹‰å…¨å±€æŒ‰é”®æ˜ å°„ï¼ˆä¾‹å­ï¼‰ (global-set-key (kbd â€œC-c gâ€) â€˜search-forward) å‚è€ƒèµ„æ–™ &amp; æ‹“å±•é˜…è¯»Emacs Reference CardsGNU Emacs manualAn Introduction to Programming in Emacs LispEmacs Lisp Reference Manual]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
        <tag>Software</tag>
        <tag>Editor</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vim é€ŸæŸ¥æ‰‹å†Œ]]></title>
    <url>%2F2018%2F06%2F06%2Fvim-quick-reference%2F</url>
    <content type="text"><![CDATA[ä¸€ã€ç§»åŠ¨å…‰æ ‡å­—ç¬¦çº§ å‘½ä»¤ åŠŸèƒ½ h å‘ å·¦ ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦å•ä½ l å‘ å³ ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦å•ä½ j å‘ ä¸‹ ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦å•ä½ k å‘ ä¸Š ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦å•ä½ å•è¯çº§ å‘½ä»¤ åŠŸèƒ½ w/W å‘ å³ ç§»åŠ¨åˆ°ä¸‹ä¸€å•è¯å¼€å¤´ e/E å‘ å³ ç§»åŠ¨åˆ°å•è¯ç»“å°¾ b/B å‘ å·¦ ç§»åŠ¨åˆ°å•è¯å¼€å¤´ PSï¼šæ‰€è°“â€œå•è¯â€ï¼Œæ˜¯æŒ‰ç…§è‹±æ–‡çš„ä¹¦å†™å’Œä½¿ç”¨ä¹ æƒ¯æ¥å®šä¹‰çš„ã€‚ç”¨åœ¨ä¸­æ–‡ä¸Šï¼Œä¸€èˆ¬å°±ä¼šä»¥æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼ä½œä¸ºâ€œå•è¯â€çš„ç•Œé™ã€‚æ‰€ä»¥å¸¸å¸¸æ˜¯ä¸€å¥è¯ä¸€å¥è¯åœ°è·³è½¬ã€‚ å—çº§ å‘½ä»¤ åŠŸèƒ½ 0 ç§»åŠ¨åˆ°å½“å‰è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ ^ ç§»åŠ¨åˆ°å½“å‰è¡Œç¬¬ä¸€ä¸ªéžç©ºç™½å­—ç¬¦ $ ç§»åŠ¨åˆ°å½“å‰è¡Œè¡Œå°¾ + ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œçš„é¦–å­—æ¯ - ç§»åŠ¨åˆ°ä¸Šä¸€è¡Œçš„é¦–å­—æ¯ gg ç§»åŠ¨åˆ°æ–‡æ¡£ç¬¬ä¸€è¡Œ G ç§»åŠ¨åˆ°æ–‡æ¡£æœ€åŽä¸€è¡Œ H ç§»åŠ¨åˆ°å½“å‰å±å¹•çš„ç¬¬ä¸€è¡Œ M ç§»åŠ¨åˆ°å½“å‰å±å¹•çš„ä¸­é—´ä¸€è¡Œ L ç§»åŠ¨åˆ°å½“å‰å±å¹•çš„æœ€åŽä¸€è¡Œ : æˆ– gg è·³è½¬åˆ°ç¬¬ n è¡Œ :+ æˆ– j ä»Žå½“å‰ä½ç½®å‘ä¸‹è·³ n è¡Œ :- æˆ– k ä»Žå½“å‰ä½ç½®å‘ä¸Šè·³ n è¡Œ æ»šåŠ¨å±å¹• å‘½ä»¤ åŠŸèƒ½ Ctrl-d å‘ä¸‹æ»šåŠ¨åŠé¡µ Ctrl-u å‘ä¸Šæ»šåŠ¨åŠé¡µ Ctrl-f å‘ä¸‹ç§»æ»šåŠ¨ä¸€é¡µ Ctrl-b å‘ä¸Šæ»šåŠ¨ä¸€é¡µ z å°†å½“å‰è¡Œæ»šåŠ¨åˆ°å±å¹•é¡¶éƒ¨ z. å°†å½“å‰è¡Œæ»šåŠ¨åˆ°å±å¹•ä¸­é—´ z- å°†å½“å‰è¡Œæ»šåŠ¨åˆ°å±å¹•åº•éƒ¨ PSï¼šç»å¤§éƒ¨åˆ†å‘½ä»¤å‰éƒ½å¯ä»¥åŠ ä¸€ä¸ªæ•°å­— n ï¼Œé€šå¸¸è¡¨ç¤ºå¯¹å…¶åŽçš„å‘½ä»¤è¿žç»­æ‰§è¡Œ n æ¬¡ã€‚æ‰€ä»¥ 3j å¯ä»¥è¡¨ç¤ºå‘ä¸‹ç§»åŠ¨ 3 ä¸ªå­—ç¬¦å•ä½ï¼ˆå³ä¸‹ç§» 3 è¡Œï¼‰ã€‚3l è¡¨ç¤ºå‘å³ç§»åŠ¨ 3 ä¸ªå­—ç¬¦å•ä½ã€‚ç›¸å½“äºŽè¿žç»­æ‰§è¡Œäº† l å‘½ä»¤ 3 æ¬¡ã€‚è€Œ 9z. åˆ™è¡¨ç¤ºå…‰æ ‡ç§»åŠ¨åˆ°ç¬¬ 9 è¡Œçš„åŒæ—¶ï¼Œæ»šåŠ¨å±å¹•å¹¶ä½¿å¾—ç¬¬ 9 è¡Œä½äºŽå±å¹•ä¸­é—´ã€‚ï¼ˆè¿™ä¸ª 9 çš„å«ä¹‰ä¸åŒäºŽ 3l å‘½ä»¤ä¸­çš„ 3ï¼‰ å‰é¢å¸¦å†’å·çš„å‘½ä»¤ï¼ˆå¦‚ :+&lt;n&gt;ï¼Œå‘½ä»¤å†…å®¹ä¼šæ˜¾ç¤ºåœ¨åº•éƒ¨ï¼‰æ˜¯éœ€è¦æ‰‹åŠ¨è¾“å…¥å›žè½¦åŽæ‰æ‰§è¡Œçš„ã€‚è€Œä¸å¸¦å†’å·çš„å‘½ä»¤ï¼ˆå¦‚ &lt;n&gt;ggï¼‰éœ€è¦åœ¨é”®ç›˜ä¸Šä¸é—´æ–­åœ°æŒ‰ä¸‹ï¼Œä¹‹åŽå‘½ä»¤ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚ äºŒã€æ–‡æ¡£æ“ä½œ æ’å…¥ å‘½ä»¤ åŠŸèƒ½ i å½“å‰å­—ç¬¦å‰æ’å…¥ a å½“å‰å­—ç¬¦åŽæ’å…¥ I è¡Œé¦–æ’å…¥ A è¡Œå°¾æ’å…¥ o åœ¨ä¸‹ä¸€è¡Œæ’å…¥ O åœ¨ä¸Šä¸€è¡Œæ’å…¥ PSï¼šä»¥ä¸Šå‘½ä»¤ä¼šä½¿ vim è¿›å…¥ insert æ¨¡å¼ï¼ˆå³ç¼–è¾‘æ¨¡å¼ï¼‰ï¼Œæ­¤æ—¶è¾“å…¥çš„ä»»ä½•å‘½ä»¤éƒ½ä¼šä½œä¸ºå­—ç¬¦æ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚æŒ‰ esc é”®å¯é€€å‡º insert æ¨¡å¼ã€‚ åˆ é™¤ï¼ˆå¹¶å°†åˆ é™¤çš„å†…å®¹ä¿å­˜è‡³ vim å‰ªè´´æ¿ï¼‰ å‘½ä»¤ åŠŸèƒ½ x åˆ é™¤å½“å‰å­—ç¬¦ï¼ˆç­‰äºŽ insert æ¨¡å¼ä¸‹çš„ Deleteï¼‰ X åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ï¼ˆç­‰äºŽ insert æ¨¡å¼ä¸‹çš„ Backspaceï¼‰ dd åˆ é™¤å½“å‰è¡Œ d åˆ é™¤æŒ‡å®šå†…å®¹ D åˆ é™¤å½“å‰å…‰æ ‡ä½ç½®åˆ°è¡Œå°¾çš„æ‰€æœ‰å†…å®¹ã€‚ç­‰äºŽ d$ cc æ›¿æ¢æ•´è¡Œå†…å®¹ã€‚å³å°†æ•´è¡Œå†…å®¹åˆ é™¤å¹¶è¿›å…¥ insert æ¨¡å¼ c åˆ é™¤æŒ‡å®šå†…å®¹åŽï¼Œè¿›å…¥ insert æ¨¡å¼ã€‚ç›¸å½“äºŽ d&lt;x&gt;a C æ›¿æ¢å½“å‰å…‰æ ‡ä½ç½®åˆ°è¡Œå°¾çš„æ‰€æœ‰å†…å®¹ã€‚ç­‰äºŽ c$ éƒ¨åˆ†ç”¨äºŽæŒ‡å®šåˆ é™¤çš„èŒƒå›´ã€‚å¦‚ j è¡¨ç¤ºå°†å…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦å•ä½ï¼ˆå³ä¸‹ç§»ä¸€è¡Œï¼‰ï¼Œåˆ™ dj è¡¨ç¤ºåˆ é™¤å½“å‰è¡Œå’Œä¸‹ä¸€è¡Œçš„å†…å®¹ã€‚G è¡¨ç¤ºå°†å…‰æ ‡ç§»åŠ¨åˆ°æ–‡æ¡£æœ«å°¾ï¼Œåˆ™åœ¨å…‰æ ‡å®šä½åœ¨æ–‡æ¡£é¦–è¡Œæ—¶ï¼Œä½¿ç”¨ dG å‘½ä»¤å¯ä»¥æ¸…ç©ºæ•´ä¸ªæ–‡æ¡£çš„å†…å®¹ã€‚ PSï¼šä½¿ç”¨ä»¥ä¸Šå‘½ä»¤åˆ é™¤çš„å†…å®¹ä¼šè‡ªåŠ¨ä¿å­˜åˆ° vim çš„å‰ªè´´æ¿ä¸­ï¼Œå³æ‰€è°“â€œåˆ é™¤â€å®žé™…ä¸Šæ˜¯â€œå‰ªåˆ‡â€ï¼Œä½¿ç”¨ p å‘½ä»¤å³å¯ç²˜è´´åˆ é™¤çš„å†…å®¹ã€‚è€Œä¸”è¯¥å‰ªè´´æ¿é™äºŽ vim å†…éƒ¨ï¼Œä¸æ˜¯ç³»ç»Ÿå‰ªè´´æ¿ã€‚ å¤åˆ¶ä¸Žç²˜è´´ å‘½ä»¤ åŠŸèƒ½ yy å¤åˆ¶å½“å‰å†…å®¹åˆ° vim å‰ªè´´æ¿ y å¤åˆ¶æŒ‡å®šå†…å®¹åˆ° vim å‰ªè´´æ¿ p åœ¨å½“å‰ä½ç½®åŽç²˜è´´ P åœ¨å½“å‰ä½ç½®å‰ç²˜è´´ J å°†å½“å‰è¡Œä¸Žä¸‹ä¸€è¡Œå†…å®¹åˆå¹¶ä¸ºä¸€è¡Œ y&lt;x&gt; å‘½ä»¤ä¸­çš„ &lt;x&gt; åŒæ ·ç”¨äºŽæŒ‡å®šå¤åˆ¶çš„èŒƒå›´ã€‚å¦‚ 4j è¡¨ç¤ºå°†å…‰æ ‡ä¸‹ç§» 4 è¡Œï¼Œåˆ™ y4j è¡¨ç¤ºå°†å½“å‰è¡ŒåŠå…¶åŽ 4 è¡Œå†…å®¹å¤åˆ¶åˆ° vim å‰ªè´´æ¿ã€‚8gg è¡¨ç¤ºå°†å…‰æ ‡å®šä½è‡³ç¬¬ 8 è¡Œï¼Œåˆ™ y8gg è¡¨ç¤ºå¤åˆ¶å½“å‰è¡Œåˆ°ç¬¬ 8 è¡Œçš„æ‰€æœ‰å†…å®¹ã€‚å½“ vim å‰ªè´´æ¿ä¸­çš„å†…å®¹ä¸ºæ•´è¡Œæ—¶ï¼Œåˆ™ç²˜è´´å‘½ä»¤ï¼ˆp/Pï¼‰æ‰§è¡Œæ—¶ï¼Œä¹Ÿä¼šå˜æˆåœ¨å½“å‰è¡Œçš„å‰ï¼ˆåŽï¼‰ä¸€è¡Œç²˜è´´ã€‚ æŸ¥æ‰¾è¡Œå†…æŸ¥æ‰¾ å‘½ä»¤ åŠŸèƒ½ f å½“å‰è¡Œå‘è¡Œå°¾æ–¹å‘æŸ¥æ‰¾å¹¶å®šä½åˆ°å­—ç¬¦ x F å½“å‰è¡Œå‘è¡Œé¦–æ–¹å‘æŸ¥æ‰¾å¹¶å®šä½åˆ°å­—ç¬¦ x t å½“å‰è¡Œå‘è¡Œå°¾æ–¹å‘æŸ¥æ‰¾å¹¶å®šä½åˆ°å­—ç¬¦ x ä¹‹å‰ T å½“å‰è¡Œå‘è¡Œé¦–æ–¹å‘æŸ¥æ‰¾å¹¶å®šä½åˆ°å­—ç¬¦ x ä¹‹åŽ ; ç»§ç»­å‘å½“å‰æ–¹å‘æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå­—ç¬¦ , å‘å½“å‰æ–¹å‘çš„ç›¸åæ–¹å‘æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå­—ç¬¦ æ–‡æ¡£å†…æŸ¥æ‰¾ å‘½ä»¤ åŠŸèƒ½ * å‘åŽæŸ¥æ‰¾å…‰æ ‡å½“å‰æ‰€åœ¨å•è¯ # å‘å‰æŸ¥æ‰¾å…‰æ ‡å½“å‰æ‰€åœ¨å•è¯ / å‘åŽæŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²æˆ–æ¨¡å¼ ? å‘å‰æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²æˆ–æ¨¡å¼ n ç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼ˆä¾ç…§åŽŸæ–¹å‘ç»§ç»­æŸ¥æ‰¾ï¼‰ N ç»§ç»­æŸ¥æ‰¾ä¸Šä¸€ä¸ªï¼ˆä¾ç…§åŽŸæ–¹å‘è¿›è¡Œåå‘æŸ¥æ‰¾ï¼‰ PSï¼švim ä¸­å¯ä½¿ç”¨ % å¯¹æ‹¬å· ()[]{} è¿›è¡ŒåŒ¹é…æŸ¥æ‰¾ï¼Œå½“å…‰æ ‡ä½äºŽå…¶ä¸­ä¸€ä¸ªç¬¦åˆä¸Šæ—¶ï¼ŒæŒ‰ä¸‹ % ä¼šè·³è½¬åˆ°ä¸Žä¹‹åŒ¹é…çš„å¦å¤–ä¸€ä¸ªç¬¦åˆä¸Šã€‚ æ›¿æ¢ å‘½ä»¤ åŠŸèƒ½ r å°†å½“å‰å­—ç¬¦æ›¿æ¢ä¸ºå­—ç¬¦ x s åˆ é™¤å½“å‰å­—ç¬¦å¹¶è¿›å…¥ insert æ¨¡å¼ R è¿›å…¥ replace æ¨¡å¼ï¼Œé€å­—å¯¹å½“å‰å­—ç¬¦è¿›è¡Œæ›¿æ¢æ“ä½œï¼Œå¯ä»¥ç§»åŠ¨å…‰æ ‡å®šä½éœ€è¦æ›¿æ¢çš„å­—ç¬¦ã€‚ç›´åˆ°æŒ‰ä¸‹ ESC é”®é€€å‡ºè¯¥æ¨¡å¼ ~ å¯¹å½“å‰å­—ç¬¦è¿›è¡Œå¤§å°å†™åˆ‡æ¢ï¼ˆå³å¤§å†™è½¬å°å†™ï¼Œå°å†™è½¬å¤§å†™ï¼‰ gu å°†æŒ‡å®šçš„æ–‡æœ¬è½¬æ¢ä¸ºå°å†™ gU å°†æŒ‡å®šçš„æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™ g~ å°†æŒ‡å®šæ–‡æœ¬è¿›è¡Œå¤§å°å†™åˆ‡æ¢ :,s// ä»¥æŸä¸ªæ¨¡å¼ï¼ˆpatternï¼‰æ£€ç´¢æ•´ä¸ªæ–‡æ¡£ï¼Œå¹¶å°†ç¬¬ n1 è¡Œåˆ°ç¬¬ n2 è¡Œä¸­çš„åŒ¹é…é¡¹æ›¿æ¢ä¸ºæŒ‡å®šå†…å®¹ï¼ˆreplaceï¼‰ :%s// ä»¥æŸä¸ªæ¨¡å¼ï¼ˆpatternï¼‰æ£€ç´¢æ•´ä¸ªæ–‡æ¡£å¹¶å°†åŒ¹é…é¡¹æ›¿æ¢ä¸ºæŒ‡å®šå†…å®¹ï¼ˆreplaceï¼‰ã€‚ç­‰åŒäºŽ :1,$s// PSï¼š:%s/&lt;pattern&gt;/&lt;replace&gt; å‘½ä»¤ä¸­çš„ å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸”è¯¥å‘½ä»¤åªæ›¿æ¢æ¯è¡Œä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚å¦‚éœ€è¦å…¨å±€åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨ :%s/&lt;pattern&gt;/&lt;replace&gt;/g å‘½ä»¤ æ’¤é”€ã€é‡åš å‘½ä»¤ åŠŸèƒ½ . é‡å¤æ‰§è¡Œä¸Šä¸€æ¬¡çš„å‘½ä»¤ u æ’¤é”€ U æ’¤é”€å¯¹å½“å‰è¡Œçš„æ‰€æœ‰æ“ä½œ Ctrl-r é‡åš æ‰“å¼€ã€å…³é—­æ–‡æ¡£ å‘½ä»¤ åŠŸèƒ½ :e æ‰“å¼€åä¸º filename çš„æ–‡ä»¶ï¼Œå¦‚æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»º :Ex åœ¨ vim ä¸­æ‰“å¼€ç›®å½•æ ‘ï¼Œå…‰æ ‡é€‰å®šåŽå›žè½¦æ‰“å¼€å¯¹åº”æ–‡ä»¶ï¼ˆ- å‘½ä»¤è¿›å…¥ä¸Šçº§ç›®å½•ï¼‰ :w ä¿å­˜å½“å‰æ–‡ä»¶ :wa ä¿å­˜å…¨éƒ¨æ–‡ä»¶ :wq æˆ– ZZ ä¿å­˜æ–‡ä»¶å¹¶é€€å‡º vim :q! æˆ– ZQ å¼ºåˆ¶é€€å‡º vim ï¼Œä¸ä¿å­˜æ–‡ä»¶ :r è¯»å…¥å¦ä¸€ä¸ªæ–‡æ¡£ï¼ˆfilenameï¼‰çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹é™„åŠ åˆ°å½“å‰æ–‡æ¡£å…‰æ ‡æ‰€åœ¨è¡Œçš„åŽé¢ :saveas &lt;new_filename&gt; æ–‡ä»¶å¦å­˜ä¸º :w &lt;new_name&gt; å¦å­˜ä¸ºä¸€ä»½åä¸º new_name çš„å‰¯æœ¬å¹¶ç»§ç»­ç¼–è¾‘åŽŸæ–‡ä»¶ :,w &lt;new_name&gt; å°† n1 è¡Œåˆ° n2 è¡Œçš„æ‰€æœ‰å†…å®¹ä¿å­˜åˆ°åä¸º new_name çš„æ–°æ–‡æ¡£ä¸­ BufferBufferï¼ˆç¼“å†²åŒºï¼‰æŒ‡ vim ä¸­æ‰“å¼€çš„æ–‡ä»¶æ‰€å çš„å†…å­˜ç©ºé—´ï¼Œå½“æœªå†™å…¥ç£ç›˜æ—¶ï¼Œæ‰€æœ‰çš„ä¿®æ”¹éƒ½å‘ç”Ÿåœ¨å†…å­˜ä¸­ã€‚vim æ‰“å¼€è¿‡çš„æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šæ”¾åˆ°ä¸€ä¸ª Buffer ä¸­ï¼Œå¯ä»¥éšæ„åˆ‡æ¢å·²æ‰“å¼€çš„ Bufferã€‚ å‘½ä»¤ åŠŸèƒ½ :ls æˆ– :buffers æŸ¥çœ‹ buffer åˆ—è¡¨ :bn æ‰“å¼€ç¼“å†²åŒºä¸­ä¸‹ä¸€ä¸ªæ–‡ä»¶ :bp æ‰“å¼€ç¼“å†²åŒºä¸­ä¸Šä¸€ä¸ªæ–‡ä»¶ :b æ‰“å¼€ç¼“å†²åŒºä¸­ç¬¬ n ä¸ªæ–‡ä»¶ :bdelete åˆ é™¤éœ€è¦å…³é—­çš„ç¼“å†²åŒºæ–‡ä»¶ ä¸‰ã€å…¶ä»–æŠ€å·§ç¼©è¿› &gt;&gt; å‘å³ç¼©è¿›å½“å‰è¡Œ &lt;&lt; å‘å·¦ç¼©è¿›å½“å‰è¡Œ 4&gt;&gt; å‘å³ç¼©è¿›å½“å‰è¡Œçš„åŒæ—¶ï¼Œç¼©è¿›å½“å‰è¡Œä¸‹é¢çš„ 3 è¡Œå†…å®¹ &gt;G å‘å³ç¼©è¿›å½“å‰è¡Œåˆ°æ–‡æ¡£æœ«å°¾çš„æ‰€æœ‰å†…å®¹è‡ªåŠ¨æŽ’ç‰ˆ == è‡ªåŠ¨æŽ’ç‰ˆå½“å‰è¡Œ gg=G è‡ªåŠ¨æŽ’ç‰ˆæ•´ä¸ªæ–‡æ¡£ &lt;n&gt;== å¯¹ä»Žå½“å‰è¡Œå¼€å§‹çš„ n è¡Œè¿›è¡Œè‡ªåŠ¨æŽ’ç‰ˆ =&lt;n&gt;j å¯¹å½“å‰è¡Œä»¥åŠä¸‹é¢çš„ n è¡Œè¿›è¡Œè‡ªåŠ¨æŽ’ç‰ˆæ‰§è¡Œ shell å‘½ä»¤:!&lt;command&gt; å¯ä»¥æ‰§è¡Œç›¸åº”çš„ shell å‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡Œå®ŒæˆåŽæŒ‰ Enter å›žåˆ° vim ç•Œé¢ã€‚å¦‚ä½¿ç”¨ :1,9!sort å‘½ä»¤å¯ä»¥å°†å½“å‰æ–‡ä»¶ä¸­ç¬¬ 1 è¡Œåˆ°ç¬¬ 9 è¡Œçš„å†…å®¹é‡æ–°æŽ’åºã€‚:r !&lt;command&gt; å¯ä»¥å°†ç›¸åº” shell å‘½ä»¤æ‰§è¡ŒåŽçš„è¾“å‡ºè¯»å–åˆ°å½“å‰æ–‡ä»¶ä¸­ã€‚å¦‚ä½¿ç”¨ :r !date å‘½ä»¤å¯ä»¥å°†å½“å‰è¯¦ç»†çš„æ—¶é—´æ—¥æœŸæ’å…¥åˆ° vim ç¼–è¾‘çš„æ–‡ä»¶ä¸­ã€‚å››ã€åˆ†å±ä¸Žæ ‡ç­¾é¡µ çª—å£åˆ†å± åˆ†å±æ–¹å¼ :split æˆ– :sp æˆ– Ctrl-w s ï¼šä¸Šä¸‹åˆ†å± :vsplit æˆ– :vs æˆ– Ctrl-w v` ï¼šå·¦å³åˆ†å± :diffsplit æˆ– :diffs ï¼šdiff æ¨¡å¼æ‰“å¼€ä¸€ä¸ªåˆ†å±ï¼ŒåŽé¢å¯ä»¥åŠ  &lt;filename&gt; çª—å£è·³è½¬ Ctrl-w w ï¼šæ¿€æ´»ä¸‹ä¸€ä¸ªçª—å£ Ctrl-w j ï¼šæ¿€æ´»ä¸‹æ–¹çª—å£ Ctrl-w k ï¼šæ¿€æ´»ä¸Šæ–¹çª—å£ Ctrl-w h ï¼šæ¿€æ´»å·¦ä¾§çª—å£ Ctrl-w l ï¼šæ¿€æ´»å³ä¾§çª—å£ å±å¹•ç¼©æ”¾ Ctrl-w = ï¼šå¹³å‡çª—å£å°ºå¯¸ Ctrl-w + ï¼šå¢žåŠ å½“å‰çª—å£é«˜åº¦ Ctrl-w - ï¼šç¼©å‡çª—å£é«˜åº¦ Ctrl-w _ ï¼šæœ€å¤§çª—å£é«˜åº¦ Ctrl-w &gt; ï¼šå¢žåŠ çª—å£å®½åº¦ Ctrl-w &lt; ï¼šç¼©å‡çª—å£å®½åº¦ Ctrl-w | ï¼šæœ€å¤§çª—å£å®½åº¦ æ ‡ç­¾é¡µ åˆ›å»ºæ ‡ç­¾é¡µ:tabnew æˆ– :tabedit æˆ– :tabe ï¼šæ‰“å¼€æ–°æ ‡ç­¾é¡µè¯¥å‘½ä»¤åŒ…æ‹¬ä¸Šé¢çš„åˆ†å±å‘½ä»¤ï¼ˆ:sp æˆ– :vs ç­‰ï¼‰åŽé¢éƒ½å¯ä»¥è·Ÿ &lt;filename&gt; é€‰é¡¹ï¼Œç”¨ä»¥åœ¨æ–°æ ‡ç­¾é¡µï¼ˆæˆ–çª—å£ï¼‰ä¸­æ‰“å¼€æŒ‡å®šæ–‡ä»¶ åˆ‡æ¢æ ‡ç­¾é¡µ gt æˆ– :tabnext æˆ– :tabn ï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µï¼ˆæœ€åŽä¸€ä¸ªä¼šå¾ªçŽ¯åˆ°ç¬¬ä¸€ä¸ªï¼‰ gT æˆ– :tabprevious æˆ– :tabp ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ :tabrewind æˆ– :tabr æˆ– :tabfir ï¼šåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªæ ‡ç­¾é¡µ :tablast æˆ– :tabl ï¼šåˆ‡æ¢åˆ°æœ€åŽä¸€ä¸ªæ ‡ç­¾é¡µ å…³é—­æ ‡ç­¾é¡µ :tabclose æˆ– :tabc ï¼šå…³é—­å½“å‰æ ‡ç­¾é¡µ :-tabc ï¼šå…³é—­ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ :+tabc ï¼šå…³é—­ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µ :tabonly æˆ– :tabo ï¼šå…³é—­å…¶ä»–æ ‡ç­¾é¡µ é™„å½•ï¼švim æ¨¡å¼ä»‹ç»å¤§è‡´ä¸Š vim åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰ï¼Œç¼–è¾‘æ¨¡å¼ï¼ˆInsert modeï¼‰å’Œåº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰ã€‚ 1. å‘½ä»¤æ¨¡å¼vim å¯åŠ¨å³è¿›å…¥å‘½ä»¤æ¨¡å¼ã€‚æ­¤æ—¶æ•²å‡»é”®ç›˜åŠ¨ä½œä¼šè¢«è¯†åˆ«ä¸ºå‘½ä»¤ï¼Œè€Œä¸æ˜¯ä½œä¸ºå­—ç¬¦æ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚å¦‚ï¼š i åˆ‡æ¢åˆ°è¾“å…¥æ¨¡å¼ï¼ˆåœ¨å½“å‰å­—ç¬¦å‰æ’å…¥ï¼‰ : åˆ‡æ¢åˆ°åº•çº¿å‘½ä»¤æ¨¡å¼ï¼Œæ­¤æ—¶è¾“å…¥çš„å‘½ä»¤æ˜¾ç¤ºåœ¨æœ€åº•ä¸‹ä¸€è¡Œï¼Œ : ç¬¦å·åŽé¢å‘½ä»¤æ¨¡å¼ä¸‹åªæœ‰ä¸€äº›æœ€åŸºæœ¬çš„å‘½ä»¤ï¼Œè€Œåº•çº¿å‘½ä»¤æ¨¡å¼ä¸‹æ‹¥æœ‰æ›´å¤šçš„å‘½ä»¤ã€‚2. ç¼–è¾‘æ¨¡å¼åœ¨å‘½ä»¤æ¨¡å¼ä¸‹é”®å…¥ i ï¼ˆæˆ– aã€e ç­‰ï¼‰å³è¿›å…¥ç¼–è¾‘æ¨¡å¼åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œå¯ä»¥åƒåœ¨è®°äº‹æœ¬ä¸­é‚£æ ·ï¼Œä½¿ç”¨é”®ç›˜è¾“å…¥æˆ–ä¿®æ”¹æ–‡æ¡£å†…å®¹ã€‚æ³¨æ„ç¼–è¾‘å®Œæˆæ—¶ï¼Œå¯ä½¿ç”¨ ESC é”®é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›žåˆ°å‘½ä»¤æ¨¡å¼ã€‚3. åº•çº¿å‘½ä»¤æ¨¡å¼åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹ : å³è¿›å…¥åº•çº¿å‘½ä»¤æ¨¡å¼è¯¥æ¨¡å¼ä¸‹å¯ä»¥è¾“å…¥å•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„å‘½ä»¤ï¼Œä»¥å®Œæˆæ¯”å‘½ä»¤æ¨¡å¼ä¸‹æ›´å¤æ‚çš„æ“ä½œï¼ˆå¦‚ :wq ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºï¼‰æŒ‰ ESC é”®å¯éšæ—¶é€€å‡ºåº•çº¿å‘½ä»¤æ¨¡å¼ã€‚ å‚è€ƒä¹¦ç±vimtutorLearning The Vi And Vim Editors, 7th Edition]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Efficiency</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‘½ä»¤è¡Œä½¿ç”¨ gmail çš„ SMTP æœåŠ¡å‘é€ç”µå­é‚®ä»¶]]></title>
    <url>%2F2018%2F05%2F29%2Fusing-gmail-smtp-in-shell%2F</url>
    <content type="text"><![CDATA[SMTP å³ç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼ˆSimple Mail Transfer Protocolï¼‰ï¼Œæ˜¯ä¸€ç§åŸºäºŽ TCP çš„åº”ç”¨å±‚åè®®ï¼Œç”¨äºŽå°†ç”µå­é‚®ä»¶å‘é€åˆ°æ”¶ä»¶äººçš„é‚®ä»¶æœåŠ¡å™¨ã€‚ä¸ä½¿ç”¨ SSL/TLS åŠ å¯†çš„ SMTP åè®®é»˜è®¤ä½¿ç”¨ 25 ç«¯å£ï¼Œé€šè¿‡ SSL/TLS åŠ å¯†çš„ SMTP åè®®ä½¿ç”¨ 465/587 ç«¯å£ã€‚å‘½ä»¤è¡Œç»“åˆ SMTP åè®®ä¸»è¦æ˜¯ä¸ºäº†é€šè¿‡ä¸€äº›ç®€å•çš„è„šæœ¬ï¼Œå®Œæˆåœ¨ç‰¹å®šæƒ…æ™¯ä¸‹é€šçŸ¥é‚®ä»¶çš„è‡ªåŠ¨å‘é€ã€‚ MacOS ç³»ç»Ÿå’Œå¾ˆå¤š Linux å‘è¡Œç‰ˆé»˜è®¤å·²ç»é…ç½®å¥½äº† postfix æœåŠ¡ï¼Œå¯ä»¥ç›´æŽ¥å‘é€é‚®ä»¶ã€‚ä¸è¿‡æ­¤æ—¶ä½¿ç”¨çš„å‘ä»¶æœåŠ¡å™¨åœ¨æœ¬åœ°ï¼Œå‘ä»¶äººä¸ºç”¨æˆ·å@æœ¬åœ°ä¸»æœºåï¼Œè€Œè¯¥ç§ç±»åž‹çš„é‚®ä»¶ä¼šè¢«çŽ°åœ¨ç»å¤§å¤šæ•°çš„é‚®ç®±æœåŠ¡å°ç¦ã€‚å¯¼è‡´é‚®ä»¶å‘é€å¤±è´¥ã€‚ è€Œ postfix æœ¬èº«çš„é…ç½®ä¹Ÿè¾ƒå¤æ‚ï¼Œæ‰€ä»¥è¿™é‡Œè®¨è®ºé€šè¿‡ QQ é‚®ç®±æˆ– gmail ç­‰ç¬¬ä¸‰æ–¹ SMTP æœåŠ¡å™¨è¿›è¡Œé‚®ä»¶å‘é€çš„æ–¹å¼ã€‚ ä¸€ã€msmtpmsmtp æ˜¯ä¸€ä¸ªéžå¸¸ç®€å•åˆæ˜“ç”¨çš„ SMTP å®¢æˆ·ç«¯ï¼Œä¸”å®ƒä¸Ž sendmailæœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ã€‚MacOS ç³»ç»Ÿå’Œå¤§éƒ¨åˆ† Linux éƒ½å¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ã€‚ è½¯ä»¶åŒ…å®‰è£…ï¼šbrew install msmtpï¼ˆMacOSï¼‰sudo apt-get install msmtpï¼ˆUbuntuï¼‰ Ubuntu ç³»ç»Ÿä¸‹è¿˜éœ€è¦å®‰è£… ca-certificates è½¯ä»¶åŒ…ï¼ˆè¯ä¹¦ï¼‰sudo apt-get install ca-certificates è½¯ä»¶é…ç½®msmtp é…ç½®æ–‡ä»¶ï¼ˆLinuxï¼‰å¦‚ä¸‹ï¼ˆ~/.msmtprcï¼‰ï¼š123456789101112131415defaultsaccount gmailhost smtp.gmail.comtls ontls_starttls ontls_trust_file /etc/ssl/certs/ca-certificates.crt tls_certcheck onport 587auth loginfrom username@gmail.comuser username@gmail.compassword ****************account default: gmail å…¶ä¸­ host é¡¹ç”¨äºŽé…ç½®ä½¿ç”¨çš„å‘ä»¶æœåŠ¡å™¨ï¼ˆsmtp.gmail.comï¼‰ tls_starttls on ç”¨äºŽæŒ‡å®šå¯ç”¨ STARTTLS åŠ å¯†ï¼Œæ­¤æ—¶ port ï¼ˆç«¯å£å·ï¼‰åˆ™ä¸º 587 ã€‚é»˜è®¤çš„ 25 ç«¯å£ä¸ä½¿ç”¨åŠ å¯†ï¼Œåœ¨ gmail ç­‰æœåŠ¡å™¨ä¸­æ˜¯ä¸å…è®¸è®¿é—®çš„ tls_trust_file ç”¨äºŽæŒ‡å®šè¯ä¹¦æ–‡ä»¶ã€‚MacOS ç³»ç»Ÿä¸‹æ­¤è·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ™å¯ä»¥æ³¨é‡ŠæŽ‰ï¼ˆ#ï¼‰è¯¥è¡Œé…ç½®ï¼Œå¹¶å°† tls_certcheck ï¼ˆæ˜¯å¦éªŒè¯è¯ä¹¦ï¼‰è®¾ç½®ä¸º off ã€‚ï¼ˆå¯ä»¥æ­£å¸¸å‘ä»¶ï¼Œä½†ä¸å¤Ÿå®‰å…¨ï¼‰ from å’Œ user ä¸º gmail é‚®ç®±åœ°å€ï¼Œå¿…é¡»ä¸ºåŒä¸€ä¸ªé‚®ç®±è´¦å·ï¼Œå¦åˆ™æ— æ³•é€šè¿‡éªŒè¯ password å¹¶éžç™»å½• gmail æ—¶çš„å¯†ç ï¼Œè€Œæ˜¯ Google è´¦å·åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œå¯åœ¨æ­¤åœ°å€è¿›è¡Œåˆ›å»ºã€‚ ç¼–è¾‘ /etc/mail.rc é…ç½®æ–‡ä»¶ï¼Œä»¤ mail å‘½ä»¤ä½¿ç”¨ msmtp ä½œä¸ºå‘ä»¶ç¨‹åºï¼ˆå¯é€šè¿‡ which msmtp å‘½ä»¤æŸ¥çœ‹ msmtp ç¨‹åºçš„å…·ä½“è·¯å¾„ï¼‰1set sendmail=/usr/bin/msmtp é…ç½®å®ŒæˆåŽï¼Œå³å¯ä½¿ç”¨ mail å‘½ä»¤å‘é€é‚®ä»¶äº† äºŒã€sendemailsendemail æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å‘½ä»¤è¡Œä¸‹çš„ SMTP é‚®ä»¶å®¢æˆ·ç«¯ï¼Œç”¨ Perl è¯­è¨€ç¼–å†™ï¼Œç®€å•ä½†åŠŸèƒ½ä¸°å¯Œã€‚æ— éœ€é¢å¤–é…ç½®ï¼Œåªéœ€è¦é…åˆé€‚å½“çš„å‘½ä»¤é€‰é¡¹å’Œå‚æ•°ï¼Œå³å¯ä½¿ç”¨ gmail çš„ SMTP æœåŠ¡å‘é€ç”µå­é‚®ä»¶ã€‚MacOS å’Œ Linux ç³»ç»Ÿä¸‹éƒ½å¯ç›´æŽ¥ä½¿ç”¨åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼šï¼ˆbrew install sendemail æˆ– sudo apt-get install sendemailï¼‰ å‘½ä»¤ç¤ºä¾‹ï¼šsendemail -l email.log -f &quot;sender@gmail.com&quot; -u &quot;subject&quot; -t &quot;recipient@xx.com&quot; -s &quot;smtp.gmail.com:587&quot; -o tls=yes -xu &quot;sender@gmail.com&quot; -xp &quot;your_password&quot;å¯ä»¥é€šè¿‡å®ƒåˆ›å»ºç®€å•çš„ shell è„šæœ¬ï¼Œä½œä¸ºä¸€ä¸ªäº¤äº’å¼çš„å‘ä»¶ç¨‹åºã€‚æ›´å¤šç”¨æ³•å¯å‚è€ƒ man sendemail ä¸‰ã€Python &amp; smtplibPython è¯­è¨€çš„å†…ç½®åº“ä¸­å³åŒ…å«äº†å¯¹ç”µå­é‚®ä»¶çš„æ”¯æŒï¼Œæ¯”å¦‚ email æ¨¡å—å¯ç”¨äºŽç¼–è¾‘é‚®ä»¶å†…å®¹ï¼Œsmtplib æ¨¡å—å¯ç”¨äºŽè®¿é—® SMTP æœåŠ¡ã€‚é€šè¿‡ Python è„šæœ¬ä½¿ç”¨ gmail çš„ SMTP æœåŠ¡å‘é€é‚®ä»¶çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python3import getpassimport smtplibfrom email.mime.image import MIMEImagefrom email.mime.multipart import MIMEMultipartfrom email.mime.text import MIMETextSMTP_SERVER = &apos;smtp.gmail.com&apos;SMTP_PORT = 587def send_email(sender,recipient): msg = MIMEMultipart() msg[&apos;To&apos;] = recipient msg[&apos;From&apos;] = sender msg[&apos;Subject&apos;] = input(&apos;Subject: &apos;) message = input(&apos;Enter your message. Press Enter when finished:\n&apos;) part = MIMEText(&apos;text&apos;,&quot;plain&quot;) part.set_payload(message) msg.attach(part) session = smtplib.SMTP(SMTP_SERVER, SMTP_PORT)# session.set_debuglevel(1) session.ehlo() session.starttls() session.ehlo# password = getpass.getpass(prompt=&quot;Enter your email password:&quot;) password=&quot;your_password&quot; session.login(sender, password) session.sendmail(sender, recipient, msg.as_string()) print(&quot;Your email is sent to &#123;0&#125;.&quot;.format(recipient)) session.quit()if __name__ == &apos;__main__&apos;: sender=&quot;sender@gmail.com&quot; recipient = input(&quot;Enter recipient address: &quot;) send_email(sender, recipient) å–æ¶ˆ # session.set_debuglevel(1) å‰é¢çš„æ³¨é‡Šï¼Œå¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶è¾“å‡ºè°ƒè¯•ä¿¡æ¯ å‚è€ƒèµ„æ–™ï¼šLearning Python Network Programming by Dr. M. O. Faruque Sarker et al. msmtp - ArchWiki]]></content>
      <categories>
        <category>Admin</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Shell</tag>
        <tag>Python</tag>
        <tag>Script</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MacOS ç³»ç»Ÿä½¿ç”¨å‘½ä»¤å®‰è£…è½¯ä»¶åŒ…]]></title>
    <url>%2F2018%2F05%2F17%2Fmacos-install-software%2F</url>
    <content type="text"><![CDATA[Linux æ“ä½œç³»ç»Ÿå„å‘è¡Œç‰ˆéƒ½æœ‰è‡ªå·±çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œå¦‚ Ubuntu çš„ apt-get ï¼ŒFedora çš„ yum åŠ Arch çš„ pacman ç­‰ã€‚å®‰è£…è½¯ä»¶ä¸è¦å¤ªæ–¹ä¾¿ã€‚è€Œ MacOS ç³»ç»Ÿå¯åœ¨ Appstore ä¸­èŽ·å–å®‰è£…è½¯ä»¶ï¼Œæˆ–è€…ä»Žç½‘ä¸Šä¸‹è½½ pkg æ ¼å¼çš„å®‰è£…åŒ…åŒå‡»è¿è¡Œã€‚å…¶å®ž MacOS ç³»ç»Ÿä¸‹ä¹Ÿæœ‰ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŒ…ç®¡ç†è½¯ä»¶ Homebrew ï¼ˆä»¥åŠ Homebrew-Caskï¼‰ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚ä½†ä¸æ˜¯å†…ç½®è½¯ä»¶ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨å®‰è£…ã€‚å…¶å®ž pkg æ ¼å¼çš„å®‰è£…åŒ…ï¼Œä¸€æ ·å¯ä»¥é€šè¿‡å‘½ä»¤ï¼ˆinstallï¼‰æ¥å®‰è£…ã€‚è€Œå¸¸è§çš„ dmg æ ¼å¼çš„è½¯ä»¶åŒ…ï¼Œå…¶å®žåªæ˜¯å°†å®‰è£…æ–‡ä»¶åˆæ‰“åŒ…æˆäº† dmg ç£ç›˜é•œåƒã€‚æŒ‚è½½åŽå³å¯ç»§ç»­æ“ä½œã€‚ ä¸€ã€Homebrew &amp; Homebrew-Cask 1. HomebrewHomebrew æ˜¯ MacOS ç³»ç»Ÿé‡Œçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿï¼Œç±»ä¼¼äºŽ Ubuntu ä¸­çš„ apt-get ï¼Œè¿™ä¸ªè½¯ä»¶æœ¬èº«å®‰è£…èµ·æ¥ä¹Ÿå¾ˆç®€å•ã€‚ Homebrew å®˜ç½‘æä¾›äº†å®‰è£…å‘½ä»¤ï¼š/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;å°†è¯¥å‘½ä»¤ç›´æŽ¥å¤åˆ¶åˆ° terminal ä¸­å¹¶è¿è¡Œï¼Œæ‰§è¡Œå®ŒæˆåŽå³å¯ä½¿ç”¨ brew å‘½ä»¤æœç´¢æˆ–å®‰è£…è½¯ä»¶äº†ã€‚ 2. Homebrew-caskHomebrew-cask ç›¸å½“äºŽ Homebrew çš„æ‰©å±•ï¼ŒåŒºåˆ«åœ¨äºŽï¼Œbrew å‘½ä»¤é¦–å…ˆèŽ·å–ç¨‹åºæºç ç„¶åŽç¼–è¯‘å®‰è£…ï¼ˆåŒ…æ‹¬ä¾èµ–åº“ï¼‰ï¼Œå¹¶è‡ªåŠ¨åšå¥½å¿…è¦çš„é…ç½®ï¼ˆå¦‚çŽ¯å¢ƒå˜é‡ç­‰ï¼‰ï¼›è€Œ brew cask å‘½ä»¤æ˜¯ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„åº”ç”¨åŒ…å¹¶æ”¾åœ¨ç»Ÿä¸€çš„ç›®å½•ä¸­ã€‚ å®‰è£…å¥½ Homebrew åŽï¼Œå¯ä½¿ç”¨ brew tap caskroom/cask å‘½ä»¤ç›´æŽ¥å®‰è£… Homebrew-cask ã€‚ 3. å¸¸ç”¨å‘½ä»¤é€‰é¡¹ install &lt;formula&gt; ï¼šå®‰è£…è½¯ä»¶ uninstall &lt;formula&gt; ï¼šå¸è½½è½¯ä»¶ update ï¼šä½¿ç”¨ git èŽ·å–æœ€æ–°ç‰ˆæœ¬çš„ Homebrew list ï¼šåˆ—å‡ºæ‰€æœ‰å·²é€šè¿‡ brew å‘½ä»¤å®‰è£…çš„è½¯ä»¶ search &lt;text|/text/&gt; ï¼šé€šè¿‡å…³é”®å­— text æœç´¢å¯ä¾›å®‰è£…çš„è½¯ä»¶ï¼Œå¦‚æœç´¢å…³é”®å­—ä¸º /text/ ï¼Œåˆ™è¡¨ç¤ºç”± text ç»„æˆçš„æ­£åˆ™è¡¨è¾¾å¼ info &lt;formula&gt; ï¼šèŽ·å–è½¯ä»¶åŒ…çš„ç®€è¦ä¿¡æ¯ æ›´å¤šç”¨æ³•å¯å‚è€ƒï¼šman brew äºŒã€å®‰è£… pkg è½¯ä»¶åŒ…åœ¨å›¾å½¢ç•Œé¢ä¸‹ï¼Œpkg è½¯ä»¶åŒ…å¯ä»¥ç›´æŽ¥åŒå‡»è¿è¡Œã€‚è€Œå‘½ä»¤è¡Œç•Œé¢ä¸‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ installer å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚å‘½ä»¤æ ¼å¼ï¼šsudo installer -pkg &lt;package&gt; -target / ä¸‰ã€dmg æ ¼å¼çš„è½¯ä»¶åŒ…dmg æ ¼å¼çš„ç£ç›˜é•œåƒæ–‡ä»¶ï¼Œé€šå¸¸æ˜¯å¯¹åº”ç”¨ç¨‹åºæ–‡ä»¶æˆ–å®‰è£…ç¨‹åºçš„æ‰“åŒ…åŽ‹ç¼©ã€‚æ‰€ä»¥å®‰è£…æ—¶éœ€è¦å…ˆä½¿ç”¨ hdiutil å‘½ä»¤æŒ‚è½½ dmgï¼Œå†æ ¹æ®æ–‡ä»¶ç±»åž‹ç¡®å®šéœ€è¦æ‰§è¡Œçš„å®‰è£…æ“ä½œã€‚ 1. åº”ç”¨æ–‡ä»¶åƒ Tor Browser è¿™ç§ï¼Œä¸‹è½½ä¸‹æ¥æ˜¯ dmg æ ¼å¼çš„é•œåƒæ–‡ä»¶ï¼ŒæŒ‚è½½åŽç›®å½•ä¸­æ˜¯å·²ç¼–è¯‘å¥½çš„åº”ç”¨ç¨‹åºæ–‡ä»¶ï¼Œç›´æŽ¥æ‹–åŠ¨åˆ° Applications æ–‡ä»¶å¤¹å³å¯å®‰è£…æˆåŠŸã€‚ åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œæ—¶ï¼Œåˆ™éœ€è¦å…ˆä½¿ç”¨ hdiutil attach &lt;imgFile&gt; æŒ‚è½½é•œåƒæ–‡ä»¶ï¼ˆä¸€èˆ¬é»˜è®¤ä¼šæŒ‚è½½åˆ° /Volumes ç›®å½•ä¸‹ï¼‰ï¼Œç„¶åŽç›´æŽ¥å°†åº”ç”¨ç¨‹åºå¤åˆ¶åˆ° /Applications ç›®å½•ä¸‹å³å¯ã€‚ 2. pkg å®‰è£…åŒ…åƒ Wireshark è¿™ç§ï¼ŒæŒ‚è½½ dmg æ–‡ä»¶åŽï¼Œç›®å½•ä¸­æ˜¯å·²ç¼–è¯‘å¥½çš„ pkg å®‰è£…åŒ…ï¼Œåˆ™éœ€è¦ä½¿ç”¨ installer å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚å‘½ä»¤è¡Œå®‰è£…è¿‡ç¨‹å¦‚ä¸‹ï¼š é™„å½•Linux åŒ…ç®¡ç†å™¨1. pacman pacman -S &lt;package&gt; å®‰è£…è½¯ä»¶åŒ… pacman -Ss &lt;regex&gt; æœç´¢è½¯ä»¶åŒ… pacman -Su æ›´æ–°ç³»ç»Ÿ pacman -Syu åŒæ­¥æºå¹¶æ›´æ–°ç³»ç»Ÿ pacman -R &lt;package&gt; åˆ é™¤è½¯ä»¶åŒ… pacman -Rc &lt;package&gt; åˆ é™¤è½¯ä»¶åŒ…åŠä¾èµ–è¯¥è½¯ä»¶çš„åŒ… pacman -Rs &lt;package&gt; åˆ é™¤è½¯ä»¶åŒ…ï¼ŒåŠå…¶æ‰€æœ‰æœªè¢«å…¶ä»–è½¯ä»¶åŒ…ä½¿ç”¨çš„ä¾èµ–å…³ç³» pacman -Rsc &lt;package&gt; å¸è½½è½¯ä»¶åŠå…¶ä¾èµ–çš„åŒ… pacman -Sc æ¸…ç† /var/cache/pacman/pkg ç›®å½•ä¸‹çš„æ—§è½¯ä»¶åŒ… pacman -Scc æ¸…ç†æ‰€æœ‰ç¼“å­˜çš„è½¯ä»¶åŒ…å’Œæ•°æ®åº“ pacman -U &lt;path_to_package&gt; å®‰è£…æœ¬åœ°çš„è½¯ä»¶åŒ… pacman -Qi &lt;package&gt; æ˜¾ç¤ºå·²å®‰è£…è½¯ä»¶åŒ…çš„ä¿¡æ¯å¤§å°ã€å®‰è£…æ—¥æœŸã€åˆ›å»ºæ—¥æœŸã€ä¾èµ–å…³ç³»ã€å†²çªç­‰ï¼‰ pacman -Qip &lt;package.tar.gz&gt; æ˜¾ç¤ºæœªå®‰è£…è½¯ä»¶åŒ…çš„ä¿¡æ¯ pacman -Ql &lt;package&gt; æ˜¾ç¤ºè½¯ä»¶åŒ…æ‰€åŒ…å«çš„æ–‡ä»¶åˆ—è¡¨ 2. apt-get apt-cache search &lt;package&gt; æœç´¢è½¯ä»¶åŒ… apt-cache show &lt;package&gt; èŽ·å–è½¯ä»¶åŒ…çš„ä¿¡æ¯ apt-get install &lt;package&gt; å®‰è£…è½¯ä»¶åŒ… apt-get -f install &lt;package&gt; ä¿®å¤å®‰è£… apt-get remove &lt;package&gt; å¸è½½è½¯ä»¶åŒ… apt-get purge &lt;package&gt; å¸è½½è½¯ä»¶åŒ…ï¼ˆåŒ…æ‹¬åˆ é™¤é…ç½®æ–‡ä»¶ç­‰ï¼‰ apt-get update æ›´æ–°è½¯ä»¶æº apt-get upgrade æ›´æ–°å·²å®‰è£…çš„è½¯ä»¶åŒ… apt-get dist-upgrade å‡çº§ç³»ç»Ÿ 3. yum yum update æ›´æ–°æ‰€æœ‰è½¯ä»¶åŒ… yum update &lt;package&gt; æ›´æ–°æŒ‡å®šçš„è½¯ä»¶åŒ… yum install &lt;package&gt; å®‰è£…è½¯ä»¶åŒ… yum remove &lt;package&gt; åˆ é™¤è½¯ä»¶åŒ… yum search &lt;pattern&gt; æœç´¢åŒ¹é…ç‰¹å®šå†…å®¹çš„è½¯ä»¶åŒ… yum info &lt;package&gt; æŸ¥çœ‹è½¯ä»¶åŒ…ä¿¡æ¯ yum clean æ¸…é™¤ç¼“å­˜å’Œæ—§çš„åŒ… yum list installed åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶åŒ…]]></content>
      <categories>
        <category>MacOS</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
        <tag>MacOS</tag>
        <tag>software</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MacOS ç³»ç»Ÿä½¿ç”¨ dd å‘½ä»¤åˆ›å»º Linux å¯åŠ¨Uç›˜]]></title>
    <url>%2F2018%2F05%2F14%2Fcreate-startup-disk-using-dd%2F</url>
    <content type="text"><![CDATA[dd) å‘½ä»¤å¯ä»¥ä»Žæ ‡å‡†è¾“å…¥æˆ–æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œæ ¹æ®æŒ‡å®šçš„æ ¼å¼æ¥è½¬æ¢æ•°æ®ï¼Œå†è¾“å‡ºåˆ°æ–‡ä»¶ã€è®¾å¤‡æˆ–æ ‡å‡†è¾“å‡ºã€‚åŒæ ·æ˜¯å¯¹æ•°æ®çš„å¤åˆ¶è½¬ç§»æ“ä½œï¼Œcp å‘½ä»¤é’ˆå¯¹çš„æ˜¯æ–‡ä»¶ç³»ç»Ÿçº§åˆ«ï¼Œæ“ä½œçš„æ˜¯æ–‡ä»¶å’Œç›®å½•ï¼›è€Œ dd é’ˆå¯¹çš„æ˜¯æ‰‡åŒºçº§åˆ«ï¼Œå¯¹ blocks è¿›è¡Œæ“ä½œã€‚æ‰€ä»¥å¯ä»¥ç”¨å®ƒæ¥åšæ•´ç›˜æ•°æ®çš„å¤‡ä»½ä¸Žæ¢å¤ã€å¤‡ä»½ MBR åŠå¯åŠ¨ç›˜çš„åˆ¶ä½œç­‰ã€‚ æ¯”å¦‚å°† disk1 ä¸Šçš„æ•°æ®ä½¿ç”¨ dd å‘½ä»¤å¤åˆ¶åˆ° disk2 ä¸Šï¼Œåˆ™ä¸¤å—ç¡¬ç›˜ä¸Šçš„æ•°æ®åŒ…æ‹¬å¸ƒå±€éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼ˆæ‰‡åŒºçº§åˆ«ï¼‰ã€‚è€Œ cp å‘½ä»¤åªæ˜¯å°† disk1 ä¸Šçš„æ•°æ®å¤åˆ¶åˆ° disk2 ä¸Šï¼Œç”±äºŽç³»ç»Ÿå†™ç¡¬ç›˜ä¸æ˜¯é¡ºåºå†™çš„ï¼Œåˆ™ä¸¤å—ç¡¬ç›˜ä¸Šç›¸åŒæ‰‡åŒºå·ä¸Šçš„æ•°æ®æœ‰å¯èƒ½ä¸ä¸€æ ·ã€‚ dd å‘½ä»¤å°†åŽŸå§‹æ•°æ®æŒ‰ç…§æ•°æ®æºçš„æ ¼å¼åŽŸå°ä¸åŠ¨åœ°æ‹·è´åˆ°ç›®çš„åœ°ï¼›è€Œcpå°†æ–‡ä»¶å’Œç›®å½•æ‹·è´åˆ°ç›®çš„åœ°åŽæŒ‰ç…§ç›®çš„åœ°çš„æ ¼å¼æŽ’åˆ—æ–°æ•°æ®ã€‚å¯¹äºŽä¸èƒ½ä»¥æ–‡ä»¶æˆ–ç›®å½•æ ¼å¼å‘ˆçŽ°çš„æ•°æ®ï¼ˆå¦‚å¼•å¯¼æ‰‡åŒºçš„æ•°æ®ï¼‰ï¼Œcp æ˜¯ä¸èƒ½æ“ä½œçš„ã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨ dd å‘½ä»¤æ¥åˆ›å»ºå¯åŠ¨ U ç›˜ã€‚ ä¸€ã€é•œåƒæ ¼å¼è½¬æ¢ä»Žç½‘ä¸Šä¸‹è½½çš„ Linux iso é•œåƒæ–‡ä»¶ï¼Œæ˜¯ä¸å— MacOS ç³»ç»Ÿæ”¯æŒçš„ã€‚éœ€è¦å…ˆä½¿ç”¨ hdiutil å‘½ä»¤è¿›è¡Œæ ¼å¼è½¬æ¢ï¼Œæ‰å¯ä»¥ä½¿ç”¨ dd å‘½ä»¤è¯»å–ã€‚$ hdiutil convert -format UDRW -o &lt;dmg æ–‡ä»¶&gt; &lt;iso æ–‡ä»¶&gt;-format æŒ‡å®šç”Ÿæˆæ–‡ä»¶çš„æƒé™ï¼ŒUDRW è¡¨ç¤ºè½¬æ¢æˆæœ‰ read/write æƒé™çš„é•œåƒPSï¼šå‰é¢è®²è¿‡ dd å‘½ä»¤çš„åŽŸç†ï¼Œå³æ— è§†æ–‡ä»¶ç³»ç»Ÿï¼Œå®Œæˆæ‰‡åŒºçº§åˆ«çš„æ•°æ®è½¬ç§»ã€‚æ‰€ä»¥è™½ç„¶ï¼Œç½‘ä¸Šæ‰€æœ‰çš„æ•™ç¨‹éƒ½æœ‰æ ¼å¼è½¬æ¢è¿™ä¸€æ­¥ã€‚æˆ‘å°è¯•äº†ä¸åšè½¬æ¢ç›´æŽ¥å°† iso æ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œäº‹å®žè¯æ˜Žä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ äºŒã€å¸è½½Uç›˜æŸ¥çœ‹Uç›˜çš„è®¾å¤‡å·$ diskutil listå¯ä»¥é€šè¿‡ diskutil çš„ list é€‰é¡¹æŸ¥çœ‹ç³»ç»Ÿå½“å‰æŒ‚è½½çš„ç£ç›˜è®¾å¤‡ã€‚å…¶ä¸­çš„ /dev/disk2 å³ç”¨æ¥åˆ¶ä½œå¯åŠ¨ç›˜çš„Uç›˜ã€‚å¯ä½¿ç”¨ diskutil çš„ unmountDisk é€‰é¡¹æ¥å¸è½½Uç›˜ã€‚$ diskutil unmountDisk /dev/disk2åªæœ‰å½“Uç›˜æˆåŠŸå¸è½½åŽï¼Œæ‰å¯ä»¥ä½¿ç”¨ dd å‘½ä»¤å°†é•œåƒæ–‡ä»¶å†™å…¥Uç›˜ï¼ˆå¦åˆ™ä¼šæŠ¥ Resource busy é”™è¯¯ï¼‰ ä¸‰ã€å°†é•œåƒæ–‡ä»¶å†™å…¥Uç›˜$ sudo dd if=lubuntu-16.04.dmg of=/dev/disk2 bs=1må…¶ä¸­ if é€‰é¡¹ç”¨äºŽæŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œof é€‰é¡¹ç”¨äºŽæŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œbs é€‰é¡¹ç”¨äºŽæŒ‡å®šå—å¤§å°ã€‚å‡ºçŽ°ä»¥ä¸Šæç¤ºåŽï¼Œåˆ™æ•°æ®å†™å…¥æˆåŠŸã€‚Linux å¯åŠ¨Uç›˜åˆ¶ä½œå®Œæˆã€‚ é™„ï¼šdd å‘½ä»¤ä»‹ç»dd å‘½ä»¤å¯ä»¥ç”¨æŒ‡å®šå¤§å°çš„ blocks å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶åœ¨å¤åˆ¶çš„åŒæ—¶è¿›è¡ŒæŒ‡å®šçš„è½¬æ¢ã€‚ å‘½ä»¤å‚æ•° if=æ–‡ä»¶åï¼šæŒ‡å®šè¾“å…¥æ–‡ä»¶åï¼Œç¼ºçœä¸ºæ ‡å‡†è¾“å…¥ of=æ–‡ä»¶åï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œç¼ºçœä¸ºæ ‡å‡†è¾“å‡º ibs=bytesï¼šä¸€æ¬¡è¯»å…¥ bytes ä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šä¸€ä¸ªå—å¤§å°ä¸º bytes ä¸ªå­—èŠ‚ obs=bytesï¼šä¸€æ¬¡è¾“å‡º bytes ä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šä¸€ä¸ªå—å¤§å°ä¸º bytes ä¸ªå­—èŠ‚ bs=bytesï¼šåŒæ—¶è®¾ç½®è¯»å…¥/è¾“å‡ºçš„å—å¤§å°ä¸º bytes ä¸ªå­—èŠ‚ cbs=bytesï¼šä¸€æ¬¡è½¬æ¢ bytes ä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šè½¬æ¢ç¼“å†²åŒºå¤§å° skip=blocksï¼šä»Žè¾“å…¥æ–‡ä»¶å¼€å¤´è·³è¿‡ blocks ä¸ªå—åŽå†å¼€å§‹å¤åˆ¶ seek=blocksï¼šä»Žè¾“å‡ºæ–‡ä»¶å¼€å¤´è·³è¿‡ blocks ä¸ªå—åŽå†å¼€å§‹å¤åˆ¶ count=blocksï¼šä»…å¤åˆ¶ blocks ä¸ªå—ï¼Œå—å¤§å°ç­‰äºŽ ibs æŒ‡å®šçš„å­—èŠ‚æ•° å‘½ä»¤ç¤ºä¾‹ å°† /dev/disk2 å…¨ç›˜æ•°æ®å¤‡ä»½åˆ°æŒ‡å®šè·¯å¾„çš„ image æ–‡ä»¶dd if=/dev/disk2 of=/home/starky/image å°†å¤‡ä»½æ–‡ä»¶æ¢å¤åˆ°æŒ‡å®šç£ç›˜dd if=/home/starky/image of=/dev/disk2 å¤‡ä»½ /dev/disk2 å…¨ç›˜æ•°æ®ï¼Œå¹¶åˆ©ç”¨ gzip å·¥å…·è¿›è¡ŒåŽ‹ç¼©ï¼Œä¿å­˜åˆ°æŒ‡å®šè·¯å¾„dd if=/dev/disk2 | gzip &gt; /home/starky/image.gz å°†åŽ‹ç¼©çš„å¤‡ä»½æ–‡ä»¶æ¢å¤åˆ°æŒ‡å®šç›˜gzip -dc /home/starky/image.gz | dd of=/dev/disk2 å¤‡ä»½ç£ç›˜å¼€å§‹çš„ 512 ä¸ªå­—èŠ‚å¤§å°çš„ MBR ä¿¡æ¯åˆ°æŒ‡å®šæ–‡ä»¶dd if=/dev/disk2 of=/home/starky/image count=1 bs=512count=1 æŒ‡ä»…æ‹·è´ä¸€ä¸ªå—ï¼›bs=512 æŒ‡å—å¤§å°ä¸º 512 ä¸ªå­—èŠ‚ã€‚ æ‹·è´å†…å­˜å†…å®¹åˆ°ç¡¬ç›˜ï¼ˆLinuxï¼‰dd if=/dev/mem of=/home/starky/mem.bin bs=1024ï¼ˆæŒ‡å®šå—å¤§å°ä¸º 1kï¼‰ é”€æ¯ç£ç›˜æ•°æ®ï¼ˆåˆ©ç”¨éšæœºçš„æ•°æ®å¡«å……ç¡¬ç›˜ï¼‰dd if=/dev/urandom of=/dev/disk2 bs=16M æµ‹è¯• ä½¿ç”¨ dd å‘½ä»¤å°†æ•´ä¸ªUç›˜ï¼ˆåŒ…æ‹¬åˆ†åŒºä¿¡æ¯å’Œæ–‡ä»¶æ•°æ®ï¼‰å†™å…¥ dmg æ ¼å¼é•œåƒæ–‡ä»¶ä¸Šå›¾ä¸­çš„ hdiutil å‘½ä»¤åœ¨ MacOS ç³»ç»Ÿä¸­ç”¨äºŽæ“ä½œ dmg æ ¼å¼çš„ç£ç›˜é•œåƒï¼ˆåŒ…æ‹¬æŒ‚è½½ã€éªŒè¯ã€è½¬æ¢ã€åŽ‹ç¼©ã€çƒ§å½•ç­‰ï¼‰ã€‚è€Œ attach é€‰é¡¹åˆ™ç”¨äºŽæŒ‚è½½ dmg æ–‡ä»¶ï¼ˆå°±åƒä½¿ç”¨ mount å‘½ä»¤æŒ‚è½½ç‰©ç†ç£ç›˜ä¸€æ ·ï¼‰ã€‚è€Œä»Žæˆªå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒåŽŸ U ç›˜ï¼ˆdisk2ï¼‰å’ŒæŒ‚è½½çš„ dmg ç£ç›˜é•œåƒï¼ˆdisk3ï¼‰åˆ†åŒºä¿¡æ¯æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼ŒåŒæ ·çš„ç£ç›˜ï¼ˆåˆ†åŒºï¼‰å¤§å°ã€åˆ†åŒºè¡¨ç±»åž‹ï¼ˆmbrï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆFAT32ï¼‰å’Œå·æ ‡ï¼ˆF01ï¼‰ã€‚dmg æ–‡ä»¶å°±åƒæ˜¯å¯¹æ•´ä¸ª U ç›˜çš„å…‹éš†ï¼Œè€Œä¸åªæ˜¯æ–‡ä»¶æ•°æ®çš„è½¬ç§»ã€‚è€Œåˆ†åŒºä¸­çš„æ–‡ä»¶å†…å®¹ä¹Ÿå®Œå…¨ä¸€è‡´ã€‚ ä½¿ç”¨ dd å‘½ä»¤å°†éƒ¨åˆ†Uç›˜å†™å…¥ dmg æ ¼å¼çš„ç£ç›˜é•œåƒæ–‡ä»¶è¿™ç§è¡Œä¸ºï¼Œå…¶å®žå½“å‰æˆ‘ä¹Ÿä¸æ˜¯å¾ˆç†è§£ã€‚ã€‚ã€‚ å‚è€ƒèµ„æ–™man diskutilman hdiutilman dd]]></content>
      <categories>
        <category>MacOS</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
        <tag>Hardware</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MacOS ç£ç›˜ç®¡ç†å·¥å…· diskutil ä»‹ç»]]></title>
    <url>%2F2018%2F04%2F27%2Fdiskutil-manual%2F</url>
    <content type="text"><![CDATA[ç”µè„‘ä¸Šçš„æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºå’Œåº”ç”¨æ•°æ®ä¸€èˆ¬éƒ½éœ€è¦ä¿å­˜åœ¨æ°¸ä¹…å­˜å‚¨å™¨ä¸­ï¼ˆé€šå¸¸å°±æ˜¯ç¡¬ç›˜ï¼‰ï¼Œè¿™æ ·ç”µè„‘æ–­ç”µåŽåº”ç”¨æ•°æ®ç­‰å°±ä¸ä¼šä¸¢å¤±ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°ç»„ç»‡ç£ç›˜ä¸Šçš„æ•°æ®ä¿¡æ¯ï¼Œé€šå¸¸å°†ç£ç›˜é¢„å…ˆåˆ’åˆ†æˆä¸€ä¸ªæˆ–å¤šä¸ªç£ç›˜åˆ†åŒºï¼Œåˆ›å»ºå¯¹åº”çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥æ–¹ä¾¿è®¡ç®—æœºå¯¹å„åˆ†åŒºåˆ†åˆ«è¿›è¡Œç®¡ç†ã€‚MacOS ç³»ç»Ÿè‡ªå¸¦ä¸€ä¸ªå›¾å½¢åŒ–çš„ç£ç›˜ç®¡ç†å·¥å…·ï¼ˆDisk Utilityï¼‰ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤è¡Œç‰ˆæœ¬çš„ diskutilã€‚é€šè¿‡è¯¥å‘½ä»¤çš„ä½¿ç”¨ï¼Œå¯ä»¥å¾ˆå¿«æ·åœ°å¯¹æœ¬åœ°ç£ç›˜è¿›è¡Œæ“¦é™¤æ•°æ®ã€è°ƒæ•´åˆ†åŒºå¤§å°ã€æ ¼å¼åŒ–ç­‰æ“ä½œã€‚ ä¸€ã€verbdiskutil å‘½ä»¤çš„æ ¼å¼ä¸ºï¼šdiskutil &lt;verb&gt; &lt;options&gt;ä¸å¸¦ä»»ä½•é€‰é¡¹çš„ diskutil å‘½ä»¤ä¼šåˆ—å‡ºè¯¥å‘½ä»¤æ”¯æŒçš„ verb åŠå…¶å¯¹åº”çš„ä»‹ç»ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142âžœ ~ diskutilDisk Utility ToolUtility to manage local disks and volumesUsage: diskutil [quiet] &lt;verb&gt; &lt;options&gt;, where &lt;verb&gt; is as follows: list (List the partitions of a disk) info[rmation] (Get information on a specific disk or partition) listFilesystems (List file systems available for formatting) activity (Continuous log of system-wide disk arbitration) u[n]mount (Unmount a single volume) unmountDisk (Unmount an entire disk (all volumes)) eject (Eject a disk) mount (Mount a single volume) mountDisk (Mount an entire disk (all mountable volumes)) rename[Volume] (Rename a volume) verifyVolume (Verify the file system data structures of a volume) repairVolume (Repair the file system data structures of a volume) verifyDisk (Verify the components of a partition map of a disk) repairDisk (Repair the components of a partition map of a disk) eraseDisk (Erase an existing disk, removing all volumes) eraseVolume (Erase an existing volume) reformat (Erase an existing volume with same name and type) eraseOptical (Erase optical media (CD/RW, DVD/RW, etc.)) zeroDisk (Erase a disk, writing zeros to the media) randomDisk (Erase a disk, writing random data to the media) secureErase (Securely erase a disk or freespace on a volume) partitionDisk ((re)Partition a disk, removing all volumes) resizeVolume (Resize a volume, increasing or decreasing its size) splitPartition (Split an existing partition into two or more) mergePartitions (Combine two or more existing partitions into one) appleRAID &lt;verb&gt; (Perform additional verbs related to AppleRAID) coreStorage &lt;verb&gt; (Perform additional verbs related to CoreStorage) apfs &lt;verb&gt; (Perform additional verbs related to APFS)diskutil &lt;verb&gt; with no options will provide help on that verb ä¸Šé¢åˆ—å‡ºçš„ verb ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š èŽ·å–ç£ç›˜å’Œåˆ†åŒºä¿¡æ¯ï¼šå¦‚ listã€infoã€activity ç­‰ æŒ‚ï¼ˆå¸ï¼‰è½½ç£ç›˜æˆ–å·ï¼šå¦‚ mountã€ejectã€mountDisk ç­‰ éªŒè¯ã€ä¿®å¤ç£ç›˜åˆ†åŒºæˆ–æ–‡ä»¶ç³»ç»Ÿï¼šå¦‚ verifyVolumeã€repairDisk ç­‰ åˆ†åŒºæ“ä½œï¼šå¦‚ splitPartitionsã€mergePartitions ç­‰ å…¶ä»–ï¼šå¦‚ appleRAIDã€apfs ç­‰ å¦‚ä¸æ¸…æ¥šæŸä¸ª verb çš„å…·ä½“å‘½ä»¤æ ¼å¼ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ diskutil å‘½ä»¤åŠ ä¸Šè¯¥ verb å¹¶ä¸”ä¸å¸¦ä»»ä½•å…¶ä»–é€‰é¡¹ï¼Œå‘½ä»¤è¡Œå³è¾“å‡ºè¯¥ verb çš„ä½¿ç”¨ä»‹ç»ã€‚å¦‚ eraseDisk çš„ä½¿ç”¨ä»‹ç»ï¼š12345678910âžœ ~ diskutil eraseDiskUsage: diskutil eraseDisk format name [APM[Format]|MBR[Format]|GPT[Format]] MountPoint|DiskIdentifier|DeviceNodeCompletely erase an existing whole disk. All volumes on this disk will bedestroyed. Ownership of the affected disk is required.Format is the specific file system name you want to erase it as (HFS+, etc.).Example: diskutil eraseDisk JHFS+ UntitledUFS disk3 äºŒã€èŽ·å–ç£ç›˜åˆ†åŒºä¿¡æ¯1. listå¯ä»¥ä½¿ç”¨ list é€‰é¡¹ç®€è¦åˆ—å‡º MacOS ç³»ç»Ÿçš„ç£ç›˜åŠåˆ†åŒºä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†åŒºç±»åž‹ï¼ˆTYPEï¼‰ã€åˆ†åŒºåï¼ˆNAMEï¼‰ã€å®¹é‡å¤§å°ï¼ˆSIZEï¼‰å’Œæ ‡å¿—ç¬¦ï¼ˆIDENTIFIERï¼‰ç­‰ã€‚å¦‚æ­¤æ—¶ç³»ç»ŸæŒ‚è½½äº† dmg æ˜ åƒæ–‡ä»¶ï¼Œå…¶ä¿¡æ¯ä¹Ÿä¼šæ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ï¼ˆä¸‹è¡¨ä¸­çš„ disk3 ï¼‰ã€‚1234567891011121314151617181920212223242526âžœ ~ diskutil list/dev/disk0 (internal, physical): #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *121.3 GB disk0 1: EFI EFI 209.7 MB disk0s1 2: Apple_APFS Container disk1 121.1 GB disk0s2/dev/disk1 (synthesized): #: TYPE NAME SIZE IDENTIFIER 0: APFS Container Scheme - +121.1 GB disk1 Physical Store disk0s2 1: APFS Volume Mac OS 78.4 GB disk1s1 2: APFS Volume Preboot 22.5 MB disk1s2 3: APFS Volume Recovery 517.8 MB disk1s3 4: APFS Volume VM 3.2 GB disk1s4/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: FDisk_partition_scheme *7.8 GB disk2 1: Windows_FAT_32 UNTITLED 7.8 GB disk2s1/dev/disk3 (disk image): #: TYPE NAME SIZE IDENTIFIER 0: Apple_partition_scheme +39.1 MB disk3 1: Apple_partition_map 32.3 KB disk3s1 2: Apple_HFS Wireshark 39.1 MB disk3s2 å…¶ä¸­çš„ /dev/disk0 ä¸ºå†…ç½®ç£ç›˜ï¼Œ/dev/disk2 ä¸ºå¤–ç½®ç£ç›˜ï¼ˆU ç›˜ï¼Œå·²åœ¨ Windowsç³»ç»Ÿä¸‹æ ¼å¼åŒ–ä¸º FAT32 æ ¼å¼ï¼‰ï¼Œ/dev/disk3 ä¸º DMG æ˜ åƒæ–‡ä»¶ã€‚è€Œ /dev/disk1 å…¶å®žå°±æ˜¯ disk0s2 ä½œä¸º APFS æ–‡ä»¶ç³»ç»Ÿå®¹å™¨çš„å…·ä½“ä¿¡æ¯ã€‚ 2. infoinfo é€‰é¡¹å¯ä»¥åˆ—å‡ºæŒ‡å®šç£ç›˜æˆ–åˆ†åŒºçš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æŸ¥çœ‹ disk2 ï¼ˆå³ 8 G ä¼˜ç›˜ï¼‰çš„ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728~ diskutil info disk2 Device Identifier: disk2 Device Node: /dev/disk2 Whole: Yes Part of Whole: disk2 Device / Media Name: DataTraveler 2.0 Volume Name: Not applicable (no file system) Mounted: Not applicable (no file system) File System: None Content (IOContent): FDisk_partition_scheme OS Can Be Installed: No Media Type: Generic Protocol: USB SMART Status: Not Supported Disk Size: 7.8 GB (7807696896 Bytes) (exactly 15249408 512-Byte-Units) Device Block Size: 512 Bytes Read-Only Media: No Read-Only Volume: Not applicable (no file system) Device Location: External Removable Media: Removable Media Removal: Software-Activated Virtual: No è¾“å‡ºçš„ä¿¡æ¯åŒ…æ‹¬è®¾å¤‡æ ‡å¿—ç¬¦ï¼ˆDevice Identifierï¼‰ã€è®¾å¤‡èŠ‚ç‚¹ï¼ˆDevice Nodeï¼‰ã€è®¾å¤‡åï¼ˆDevice / Media Nameï¼‰ã€å®¹é‡å¤§å°ï¼ˆDisk Sizeï¼‰ã€å—å¤§å°ï¼ˆBlock Sizeï¼‰ç­‰ã€‚ ä¹Ÿå¯ä»¥æŸ¥çœ‹æŸä¸ªåˆ†åŒºçš„è¯¦ç»†ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041~ diskutil info disk1s1 Device Identifier: disk1s1 Device Node: /dev/disk1s1 Whole: No Part of Whole: disk1 Volume Name: Mac OS Mounted: Yes Mount Point: / Partition Type: 41504653-0000-11AA-AA11-00306543ECAC File System Personality: APFS Type (Bundle): apfs Name (User Visible): APFS Owners: Enabled OS Can Be Installed: Yes Booter Disk: disk1s2 Recovery Disk: disk1s3 Media Type: Generic Protocol: PCI SMART Status: Verified Volume UUID: E9D63DEC-29D7-3EE0-B9BB-3614E31EA747 Disk / Partition UUID: E9D63DEC-29D7-3EE0-B9BB-3614E31EA747 Disk Size: 121.1 GB (121123069952 Bytes) (exactly 236568496 512-Byte-Units) Device Block Size: 4096 Bytes Volume Total Space: 121.1 GB (121123069952 Bytes) (exactly 236568496 512-Byte-Units) Volume Used Space: 80.0 GB (79982071808 Bytes) (exactly 156214984 512-Byte-Units) (66.0%) Volume Free Space: 41.1 GB (41140998144 Bytes) (exactly 80353512 512-Byte-Units) (34.0%) Allocation Block Size: 4096 Bytes Read-Only Media: No Read-Only Volume: No Device Location: Internal Removable Media: Fixed Solid State: Yes Hardware AES Support: No ä¸‰ã€æ“¦é™¤ç£ç›˜æˆ–åˆ†åŒºeraseDisk é€‰é¡¹ç”¨äºŽæ“¦é™¤æ•´ä¸ªç£ç›˜å¹¶é‡æ–°æ ¼å¼åŒ–ã€‚è¯¥å‘½ä»¤çš„æ ¼å¼ä¸ºï¼šdiskutil eraseDisk &lt;format&gt; &lt;name&gt; [APM|MBR|GPT] MountPoint|DiskIdentifier|DeviceNodeformat ç”¨äºŽæŒ‡å®šæ“¦é™¤æ•°æ®åŽéœ€è¦é‡æ–°å»ºç«‹çš„æ–‡ä»¶ç³»ç»Ÿç±»åž‹ã€‚å¯ä»¥ä¸º %noformat% æ¥è·³è¿‡åˆå§‹åŒ–æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œã€‚å…¶ä»–æ”¯æŒçš„ç±»åž‹å¯ä»¥é€šè¿‡ listFilesystems é€‰é¡¹æŸ¥çœ‹ã€‚123456789101112131415161718192021222324252627âžœ ~ diskutil listFilesystemsFormattable file systemsThese file system personalities can be used for erasing and partitioning.When specifying a personality as a parameter to a verb, case is not considered.-------------------------------------------------------------------------------PERSONALITY USER VISIBLE NAME-------------------------------------------------------------------------------APFS APFS (or) APFSICase-sensitive APFS APFS (Case-sensitive)ExFAT ExFATFree Space Free Space (or) FREEMS-DOS MS-DOS (FAT)MS-DOS FAT12 MS-DOS (FAT12)MS-DOS FAT16 MS-DOS (FAT16)MS-DOS FAT32 MS-DOS (FAT32) (or) FAT32HFS+ Mac OS ExtendedCase-sensitive HFS+ Mac OS Extended (Case-sensitive) (or) HFSXCase-sensitive Journaled HFS+ Mac OS Extended (Case-sensitive, Journaled) (or) JHFSXJournaled HFS+ Mac OS Extended (Journaled) (or) JHFS+ ç”¨æ¥æµ‹è¯•çš„ä¼˜ç›˜å¦‚ä¸‹æ‰€ç¤ºï¼Œå·²åœ¨ Windows ä¸‹æ ¼å¼åŒ–ä¸º FAT32 æ ¼å¼ã€‚å¯ä»¥ä½¿ç”¨ diskutil eraseDisk ExFAT StarkyDisk disk2 å‘½ä»¤å°†ä¼˜ç›˜æ•°æ®æ“¦é™¤å¹¶æ ¼å¼åŒ–ä¸º ExFAT æ ¼å¼ã€‚123456789101112131415161718192021222324âžœ ~ diskutil eraseDisk ExFAT StarkyDisk disk2Started erase on disk2Unmounting diskCreating the partition mapWaiting for partitions to activateFormatting disk2s2 as ExFAT with name StarkyDiskVolume name : StarkyDiskPartition offset : 411648 sectors (210763776 bytes)Volume size : 14835712 sectors (7595884544 bytes)Bytes per sector : 512Bytes per cluster: 32768FAT offset : 2048 sectors (1048576 bytes)# FAT sectors : 2048Number of FATs : 1Cluster offset : 4096 sectors (2097152 bytes)# Clusters : 231744Volume Serial # : 5ad7f879Bitmap start : 2Bitmap file size : 28968Upcase start : 3Upcase file size : 5836Root start : 4Mounting diskFinished erase on disk2 æ­¤æ—¶çš„ä¼˜ç›˜ä¿¡æ¯ä¸ºï¼šåˆ†åŒºè¡¨å˜ä¸º GPT ç±»åž‹ï¼Œä¸”å¤šäº†ä¸€ä¸ª EFI åˆ†åŒºã€‚ ä¹Ÿå¯ä»¥åœ¨æ“¦é™¤ç£ç›˜æ—¶æŒ‡å®šåˆ†åŒºè¡¨ç±»åž‹ï¼š12345678910111213141516171819202122232425âžœ ~ sudo diskutil eraseDisk ExFAT StarkyDisk MBR disk2Password:Started erase on disk2Unmounting diskCreating the partition mapWaiting for partitions to activateFormatting disk2s1 as ExFAT with name StarkyDiskVolume name : StarkyDiskPartition offset : 2 sectors (1024 bytes)Volume size : 15249406 sectors (7807695872 bytes)Bytes per sector : 512Bytes per cluster: 32768FAT offset : 2048 sectors (1048576 bytes)# FAT sectors : 2048Number of FATs : 1Cluster offset : 4096 sectors (2097152 bytes)# Clusters : 238207Volume Serial # : 5ad80e37Bitmap start : 2Bitmap file size : 29776Upcase start : 3Upcase file size : 5836Root start : 4Mounting diskFinished erase on disk2 æ­¤æ—¶çš„ä¼˜ç›˜åˆ†åŒºè¡¨å˜ä¸º MBR ç±»åž‹ï¼š å…¶ä»–æ“¦é™¤å‘½ä»¤å¦‚ eraseVolume ï¼ˆå®Œå…¨æ“¦é™¤æ•´ä¸ªç£ç›˜æˆ–æŸä¸ªç£ç›˜åˆ†åŒºï¼Œåˆ›å»ºæ–°çš„æ–‡ä»¶ç³»ç»Ÿï¼‰ã€zeroDisk ï¼ˆå‘æ•´ä¸ªç£ç›˜æˆ–æŸä¸ªåˆ†åŒºå…¨éƒ¨å†™å…¥ â€˜0â€™ï¼‰ä½¿ç”¨ zeroDisk å‘½ä»¤æ“¦é™¤ç£ç›˜ï¼ˆè¯¥è¿‡ç¨‹ä¼šèŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ï¼Œæˆ‘è¯•äº†ï¼‰åŽï¼Œè¯¥ç£ç›˜ä¸Šçš„å…¨éƒ¨ä¿¡æ¯è¢«æŠ¹é™¤ï¼ŒåŒæ—¶ä¹Ÿä¸å†åŒ…å«åˆ†åŒºå’Œæ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼šåˆ™å†æ¬¡æ’å…¥æ­¤ä¼˜ç›˜ä¼šæç¤ºä½ ã€Žåˆå§‹åŒ–ã€æˆ–ã€Žæ ¼å¼åŒ–ã€è¯¥ç£ç›˜ã€‚ å››ã€åˆ›å»ºç£ç›˜åˆ†åŒºå¯ä»¥é€šè¿‡ partionDisk é€‰é¡¹å®Œæˆå¯¹ç£ç›˜çš„åˆ†åŒºæ“ä½œã€‚è¯¥å‘½ä»¤çš„æ ¼å¼ä¸ºï¼š1234diskutil partitionDisk MountPoint|DiskIdentifier|DeviceNode [numberOfPartitions] [APM|MBR|GPT] [part1Format part1Name part1Size part2Format part2Name part2Size part3Format part3Name part3Size ...] å‘½ä»¤é€‰é¡¹ä¸­çš„ Size ç”¨æ¥æŒ‡å®šåˆ†åŒºçš„å¤§å°ï¼ˆä»¥æ‰‡åŒºæ•°è®¡é‡ï¼‰ï¼Œåˆæ³•çš„å€¼åŒ…æ‹¬å¸¦æœ‰æŒ‡å®šåŽç¼€çš„æµ®ç‚¹æ•°ã€‚å…¶ä¸­çš„åŽç¼€æœ‰ B(ytes), S(512-byte-blocks), K(ilobytes), M(egabytes), G(igabytes), T(erabytes), P(etabytes)ï¼Œä¹Ÿå¯ä»¥æ˜¯ % æ¥è¡¨ç¤ºå¯¹æ•´ä¸ªç£ç›˜çš„å æ¯”ã€‚æœ€åŽä¸€ä¸ªåˆ†åŒºä¼šè‡ªåŠ¨æ‰©å±•åˆ°å ç”¨æ•´ä¸ªç£ç›˜çš„å‰©ä½™ç©ºé—´ï¼Œå¦‚æžœæƒ³ä¸ºæœ€åŽä¸€ä¸ªåˆ†åŒºæŒ‡å®šå›ºå®šçš„å¤§å°ï¼Œå¯åœ¨å…¶åŽå†åˆ›å»ºä¸€ä¸ªç±»åž‹ä¸ºã€Žfree spaceã€çš„åˆ†åŒºã€‚12345678910111213141516171819âžœ ~ sudo diskutil partitionDisk disk2 3 MBR MS-DOS F01 3G JHFS+ F02 3G &quot;Free Space&quot; F03 0Started partitioning on disk2Unmounting diskCreating the partition mapWaiting for partitions to activateFormatting disk2s1 as MS-DOS (FAT) with name F01512 bytes per physical sector/dev/rdisk2s1: 5847920 sectors in 730990 FAT32 clusters (4096 bytes/cluster)bps=512 spc=8 res=32 nft=2 mid=0xf8 spt=32 hds=255 hid=2 drv=0x80 bsec=5859376 bspf=5711 rdcl=2 infs=1 bkbs=6Mounting diskFormatting disk2s2 as Mac OS Extended (Journaled) with name F02Initialized /dev/rdisk2s2 as a 3 GB case-insensitive HFS Plus volume with a 8192k journalMounting diskFinished partitioning on disk2/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: FDisk_partition_scheme *7.8 GB disk2 1: DOS_FAT_32 F01 3.0 GB disk2s1 2: Apple_HFS F02 3.0 GB disk2s2 ä¸Šé¢çš„å‘½ä»¤åœ¨ä¼˜ç›˜ï¼ˆdisk2ï¼‰ä¸Šåˆ›å»ºäº† 3 ä¸ªåˆ†åŒºï¼Œç¬¬ä¸€ä¸ªï¼ˆF01ï¼‰æ ¼å¼ä¸º FAT32ï¼Œå¤§å°æ˜¯ 3 Gbã€‚ç¬¬äºŒä¸ªï¼ˆF02ï¼‰æ ¼å¼ä¸º JHFS+ï¼Œå¤§å°ä¸º 3 Gbã€‚æœ€åŽä¸€ä¸ªæ˜¯ã€Žè‡ªç”±ç©ºé—´ã€ï¼Œå¤§å°ä¸ºå‰©ä½™çš„å®¹é‡ã€‚æ‰€ä»¥å®žé™…ä¸Šåªæ˜¯åˆ†äº†ä¸¤ä¸ªåŒºï¼Œæ•´ä½“çš„åˆ†åŒºè¡¨ç±»åž‹ä¸º MBRã€‚ äº”ã€åˆ†å‰²/åˆå¹¶ç£ç›˜åˆ†åŒºsplitPartition é€‰é¡¹å¯ä»¥ç”¨æ¥å°†å·²å­˜åœ¨çš„æŸä¸ªåˆ†åŒºå†åˆ†å‰²æˆæ•°ä¸ªæ›´å°çš„åˆ†åŒºï¼Œæ³¨æ„åŽŸåˆ†åŒºä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¼šä¸¢å¤±ã€‚è¯¥é€‰é¡¹çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦åˆ†å‰²çš„åˆ†åŒºçš„æŒ‚è½½ç‚¹/æ ‡å¿—ç¬¦/è®¾å¤‡èŠ‚ç‚¹ï¼Œå…¶ä½™å‚æ•°å’Œä½¿ç”¨ partitionDisk æ—¶ç›¸åŒã€‚12345678910111213141516171819202122232425âžœ ~ sudo diskutil list | grep disk2/dev/disk2 (external, physical): 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS starky 7.5 GB disk2s2âžœ ~ sudo diskutil splitPartition disk2s2 2 MS-DOS F01 3g JHFS+ F02 3gStarted partitioning on disk2s2 starkySplittingUnmounting diskWaiting for partitions to activateFormatting disk2s2 as MS-DOS (FAT) with name F01512 bytes per physical sector/dev/rdisk2s2: 5845824 sectors in 730728 FAT32 clusters (4096 bytes/cluster)bps=512 spc=8 res=32 nft=2 mid=0xf8 spt=32 hds=255 hid=411648 drv=0x80 bsec=5857280 bspf=5709 rdcl=2 infs=1 bkbs=6Mounting diskFormatting disk2s3 as Mac OS Extended (Journaled) with name F02Initialized /dev/rdisk2s3 as a 4 GB case-insensitive HFS Plus volume with a 8192k journalMounting diskFinished partitioning on disk2s2 starky/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Microsoft Basic Data F01 3.0 GB disk2s2 3: Apple_HFS F02 4.5 GB disk2s3 ä¸Šé¢çš„å‘½ä»¤å°†ä¼˜ç›˜çš„ç¬¬äºŒä¸ªåˆ†åŒºï¼ˆdisk2s2ï¼‰åˆåˆ†å‰²æˆäº†ä¸¤ä¸ªæ›´å°çš„åˆ†åŒºï¼Œåˆ†åˆ«æ˜¯ FAT32 æ ¼å¼çš„ F01ï¼ˆdisk2s2ï¼‰ï¼Œå’Œ JHFS+ æ ¼å¼çš„ F02ï¼ˆdisk2s3ï¼‰ã€‚è™½ç„¶å‘½ä»¤ä¸­æŒ‡å®šäº† F02 çš„å¤§å°æ˜¯ 3Gï¼Œå› ä¸ºæ˜¯æœ€åŽä¸€ä¸ªåˆ†åŒºï¼Œæ‰€ä»¥è‡ªåŠ¨æ‰©å±•åˆ°å ç”¨å‰©ä½™çš„ç£ç›˜ç©ºé—´ã€‚æœ€åŽå®ƒçš„å®žé™…å¤§å°æ˜¯ 4.5Gã€‚ mergePartitions é€‰é¡¹ç”¨æ¥å°†å¤šä¸ªå·²å­˜åœ¨çš„åˆ†åŒºåˆå¹¶ä¸ºä¸€ä¸ªå¤§çš„åˆ†åŒºã€‚è¯¥é€‰é¡¹çš„æ ¼å¼ä¸ºï¼šdiskutil mergePartitions [force] format name DiskIdentifier|DeviceNode DiskIdentifier|DeviceNodeç¬¬ä¸€ä¸ªåˆ†åŒºå‚æ•°ä¸ºèµ·å§‹åˆ†åŒºï¼Œç¬¬äºŒä¸ªåˆ†åŒºå‚æ•°ä¸ºç»“æŸåˆ†åŒºã€‚è¿™ä¸¤ä¸ªåˆ†åŒºä¹‹é—´çš„æ‰€æœ‰åˆ†åŒºéƒ½å°†è¢«åˆå¹¶ã€‚å¦‚æžœ force é€‰é¡¹æ²¡æœ‰è¢«æŒ‡å®šï¼Œä¸”åˆå¹¶å‰çš„ç¬¬ä¸€ä¸ªåˆ†åŒºæ˜¯å¯è°ƒæ•´å¤§å°çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ JHFS+ï¼‰ï¼Œåˆ™ç¬¬ä¸€ä¸ªåˆ†åŒºä¸Šçš„æ•°æ®ä¼šä¿ç•™åˆ°åˆå¹¶åŽçš„åˆ†åŒºã€‚ 1234567891011121314151617181920âžœ ~ sudo diskutil list | grep disk2/dev/disk2 (external, physical): 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS F01 2.9 GB disk2s2 3: Microsoft Basic Data F02 4.5 GB disk2s4âžœ ~ sudo diskutil mergePartitions JHFS+ Starky disk2s2 disk2s4Merging partitions into a new partition Start partition: disk2s2 F01 Finish partition: disk2s4 F02Started partitioning on disk2Merging partitionsWaiting for partitions to activateGrowing diskFinished partitioning on disk2/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS F01 7.5 GB disk2s2 å…­ã€è°ƒæ•´åˆ†åŒºå¤§å°ï¼ˆæ— æŸï¼‰resizeVolume é€‰é¡¹å¯ä»¥æ— æŸè°ƒæ•´ï¼ˆå¢žåŠ æˆ–ç¼©å‡ï¼‰åˆ†åŒºå¤§å°ã€‚ å°† disk2s2 åˆ†åŒºç¼©å‡ä¸º 4g å¤§å°ï¼Œè…¾å‡ºçš„ç©ºé—´ä½œä¸ºã€Žfree spaceã€ï¼š1234567891011121314151617181920212223242526272829303132âžœ ~ diskutil list | grep disk2/dev/disk2 (external, physical): 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS F01 7.5 GB disk2s2âžœ ~ sudo diskutil resizeVolume disk2s2 4gResizing to 4000000000 bytesStarted partitioning on disk2s2 F01Verifying the diskVerifying file systemVolume was successfully unmountedPerforming fsck_hfs -fn -x /dev/rdisk2s2Checking Journaled HFS Plus volumeChecking extents overflow fileChecking catalog fileChecking multi-linked filesChecking catalog hierarchyChecking extended attributes fileChecking volume bitmapChecking volume informationThe volume F01 appears to be OKFile system check exit code is 0Restoring the original state found as mountedResizingShrinking file systemModifying partition mapFinished partitioning on disk2s2 F01/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS F01 4.0 GB disk2s2 æ­¤æ—¶ disk2s2 å†…çš„æ–‡ä»¶å¦‚ä¸‹ï¼š å°† disk2s2 åˆ†åŒºæ‰©å±•ï¼Œå¹¶å°½å¯èƒ½å ç”¨æ‰€æœ‰å¯ç”¨çš„è‡ªç”±ç©ºé—´ã€‚123456789101112131415161718192021222324252627âžœ ~ sudo diskutil resizeVolume disk2s2 RResizing to full size (fit to fill)Started partitioning on disk2s2 F01Verifying the diskVerifying file systemVolume was successfully unmountedPerforming fsck_hfs -fn -x /dev/rdisk2s2Checking Journaled HFS Plus volumeChecking extents overflow fileChecking catalog fileChecking multi-linked filesChecking catalog hierarchyChecking extended attributes fileChecking volume bitmapChecking volume informationThe volume F01 appears to be OKFile system check exit code is 0Restoring the original state found as mountedResizingModifying partition mapGrowing file systemFinished partitioning on disk2s2 F01/dev/disk2 (external, physical): #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *7.8 GB disk2 1: EFI EFI 209.7 MB disk2s1 2: Apple_HFS F01 7.5 GB disk2s2 æ­¤æ—¶ disk2s2 å†…çš„æ–‡ä»¶å¦‚ä¸‹ï¼š å‚è€ƒæ–‡ç« man diskutil]]></content>
      <categories>
        <category>MacOS</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
        <tag>Hardware</tag>
        <tag>MacOS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu 16.04 æ­å»º NFS æ–‡ä»¶å…±äº«æœåŠ¡å™¨]]></title>
    <url>%2F2018%2F04%2F10%2Fubuntu-1604-NFS-server%2F</url>
    <content type="text"><![CDATA[NFS å³ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNetwork File Systemï¼‰ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿåè®®ï¼Œè¯¥åè®®å…è®¸å®¢æˆ·ç«¯ä¸»æœºå¯ä»¥åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸€æ ·é€šè¿‡ç½‘ç»œè®¿é—®æœåŠ¡å™¨ç«¯æ–‡ä»¶ï¼Œå³å¯ä»¥å°†è¿œç¨‹æœåŠ¡å™¨æ–‡ä»¶ç›´æŽ¥ mountï¼ˆæŒ‚è½½ï¼‰åˆ°æœ¬åœ°çš„æ–‡ä»¶ç›®å½•ç»“æž„ä¸­è¿›è¡Œè®¿é—®ã€‚ ä¸€ã€è½¯ä»¶å®‰è£…æœåŠ¡å™¨ç«¯éœ€è¦å®‰è£… nfs-kernel-server è½¯ä»¶åŒ…ï¼š$ sudo apt-get update$ sudo apt-get install nfs-kernel-server äºŒã€æœåŠ¡å™¨é…ç½®é»˜è®¤æƒ…å†µä¸‹ï¼ŒNFS æœåŠ¡å™¨ä¸Šå®šä¹‰äº†æŸä¸ªå…±äº«ç›®å½•ï¼Œåˆ™è¯¥ç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½å¯è¢«è®¿é—®ã€‚å‡ºäºŽå¯¹å®‰å…¨çš„è€ƒè™‘ï¼Œå®¢æˆ·ç«¯ä»»ä½•éœ€è¦è¶…çº§ç”¨æˆ·ï¼ˆå³ root ç”¨æˆ·ï¼ŒUID=0 &amp; GID=0ï¼‰æƒé™çš„æ–‡ä»¶æ“ä½œéƒ½é»˜è®¤æ˜ å°„åˆ° UID=65534 å’Œ GID=65534 çš„ç”¨æˆ·ï¼Œå³ Ubuntu ç³»ç»Ÿä¸­çš„ nobody:nogroupã€‚ä¾‹å¦‚å®¢æˆ·ç«¯ä½¿ç”¨ root æƒé™åœ¨æŒ‚è½½çš„å…±äº«ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œè¯¥æ–‡ä»¶çš„å±žä¸»å’Œå±žç»„è‡ªåŠ¨å˜ä¸º nobody:nogroupï¼Œè€Œéž root:root ã€‚ 1. åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºå…±äº«ç›®å½•sudo mkdir -p /var/nfs/gernelsudo mkdir -p /var/nfs/publicsudo chown nobody:nogroup /var/nfs/gernel 2. ä¿®æ”¹ exports æ–‡ä»¶ä¸ºäº†ä½¿ NFS æœåŠ¡å™¨å®šä¹‰çš„å…±äº«æ–‡ä»¶å¯è¢«æŒ‡å®šçš„å®¢æˆ·ç«¯ä¸»æœºè®¿é—®ï¼Œéœ€è¦åœ¨æœåŠ¡å™¨ç«¯çš„ /etc/exports æ–‡ä»¶ä¸­æ·»åŠ å¯¹åº”çš„è®°å½•ã€‚è¯¥æ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼šDirectory Host(Options ...) Host(Options) #commentå…³äºŽ /etc/exports æ–‡ä»¶çš„è¯¦ç»†è¯­æ³•æ ¼å¼å¯å‚è€ƒ man exports ã€‚ æ–‡ä»¶ç¤ºä¾‹ï¼š123/var/nfs/gernel 192.168.56.0/24(rw,insecure,sync,no_subtree_check)/var/nfs/public *(ro,insecure,sync,no_subtree_check)/home/starky 192.168.56.1(rw,insecure,no_root_squash,sync,no_subtree_check) ç¬¬ä¸€æ¡çºªå½•è¡¨ç¤º 192.168.56.0/24 å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºéƒ½å¯æŒ‚è½½ var/nfs/gernel ç›®å½•å¹¶æ‹¥æœ‰è¯»å†™ï¼ˆrwï¼‰æƒé™ ç¬¬äºŒæ¡çºªå½•è¡¨ç¤ºæ‰€æœ‰ä¸»æœºéƒ½å¯æŒ‚è½½ /var/nfs/public ç›®å½•ä¸”æ‹¥æœ‰åªè¯»ï¼ˆroï¼‰æƒé™ ç¬¬ä¸‰æ¡çºªå½•è¡¨ç¤ºå®¢æˆ·ç«¯ IP åœ°å€ä¸º 192.168.56.1 çš„ä¸»æœºå¯ä»¥æŒ‚è½½ /home/starky ç›®å½•å¹¶æ‹¥æœ‰è¯»å†™æƒé™ï¼Œè€Œä¸”ä»»ä½• root æƒé™ï¼ˆUID=0 , GID=0ï¼‰çš„æ–‡ä»¶æ“ä½œéƒ½ä¸é»˜è®¤æ˜ å°„ç»™ nobody:nogroupï¼Œè€Œä¿æŒå±žä¸»ï¼ˆç»„ï¼‰ä»ä¸º rootï¼ˆno_root_squashï¼‰ insecure é€‰é¡¹ï¼šå…è®¸é€šè¿‡ä»»æ„ç«¯å£çš„è¿œç¨‹è®¿é—® sync é€‰é¡¹ï¼šå¼ºåˆ¶ NFS æœåŠ¡å™¨åœ¨å“åº”è¯·æ±‚ä¹‹å‰å°†æ–‡ä»¶çš„æ”¹åŠ¨å†™å…¥ç£ç›˜ï¼ˆå¼ºè°ƒå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ–‡ä»¶å†…å®¹çš„ä¸€è‡´æ€§ï¼Œä½†ä¼šé™ä½Žæ–‡ä»¶æ“ä½œçš„æ•ˆçŽ‡ï¼‰ã€‚ no_subtree_check é€‰é¡¹ï¼šç¦ç”¨ subtree_check ã€‚subtree_check ç”¨æ¥è®¾ç½®æœåŠ¡å™¨åœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œæ£€æŸ¥è¯¥æ–‡ä»¶æ˜¯å¦åœ¨æŒ‡å®šç›®å½•ç»“æž„ä¸­ä¾æ—§å¯ç”¨ï¼ˆè¯¥é€‰é¡¹ä¼šåœ¨æŸäº›æƒ…å†µä¸‹å‘ç”Ÿé”™è¯¯ï¼šé‡å‘½åæŸæ–‡ä»¶çš„åŒæ—¶ï¼Œè¯¥æ–‡ä»¶åœ¨å®¢æˆ·ç«¯æ‰“å¼€ï¼‰ã€‚ ä¸‰ã€å®¢æˆ·ç«¯æŒ‚è½½å…±äº«ç›®å½•åˆ—å‡º nfs æœåŠ¡å™¨ä¸Šçš„å…±äº«ç›®å½•12345$ showmount -e 192.168.56.102Exports list on 192.168.56.102:/home/starky 192.168.56.1/var/nfs/public */var/nfs/gernel 192.168.56.0/24 åˆ›å»ºæŒ‚è½½ç‚¹sudo mkdir -p /mnt/nfs/gernelsudo mkdir -p /mnt/nfs/publicsudo mkdir -p /mnt/nfs/starky æŒ‚è½½è¿œç¨‹ç›®å½•sudo mount 192.168.56.102:/var/nfs/gernel /mnt/nfs/gernelsudo mount 192.168.56.102:/var/nfs/public /mnt/nfs/publicsudo mount 192.168.56.102:/home/starky /mnt/nfs/starky æƒé™æµ‹è¯• å¦‚æˆªå›¾æ‰€ç¤ºï¼š NFS çš„æƒé™è®¾å®šåŸºäºŽ Linux æ–‡ä»¶ç³»ç»Ÿçš„æƒé™ç®¡ç†ï¼Œå³å®¢æˆ·ç«¯æŒ‚è½½è¿œç¨‹å…±äº«ç›®å½•åŽï¼Œä¼šæŠŠå®ƒä»¬å½“æˆæœ¬åœ°ç£ç›˜ç›®å½•ä¸€æ ·å¯¹å¾…ï¼Œä¹Ÿæ˜¯æ ¹æ®æ–‡ä»¶çš„å±žä¸»ï¼ˆç»„ï¼‰åŠå…¶å¯¹åº”çš„æƒé™è®¾å®šæ¥é™åˆ¶è®¿é—®ã€‚gernel ç›®å½•çš„å±žä¸»ï¼ˆç»„ï¼‰ä¸º nobody:nogroupï¼ˆ65534:65534ï¼‰ï¼Œæ‰€ä»¥è™½ç„¶è¯¥ç›®å½•ä¸ºè¯»å†™æƒé™ï¼Œéž root ç”¨æˆ·æ— æ³•æ‰§è¡Œæ–°å»ºæ“ä½œã€‚è€Œ root ç”¨æˆ·ç”±äºŽ NFS é»˜è®¤çš„å®‰å…¨æœºåˆ¶ï¼Œä¼šè‡ªåŠ¨æ˜ å°„åˆ° nobody:nogroupã€‚ç”±äºŽæˆ‘åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æœ‰ä¸€ä¸ªåä¸º starky çš„ç”¨æˆ·ï¼Œä¸”å®ƒä»¬çš„ UID:GID éƒ½ä¸º1000:1000ï¼Œæ‰€ä»¥æœåŠ¡ç«¯çš„ /home/starky ç›®å½•å¯ä»¥ç›´æŽ¥è¢«å®¢æˆ·ç«¯çš„ starky ç”¨æˆ·è®¿é—®ã€‚ä¸”ç”±äºŽ no_root_squash é€‰é¡¹ï¼Œé€šè¿‡ sudo å‘½ä»¤åˆ›å»ºçš„æ–‡ä»¶å…¶å±žä¸»ä»ä¸º rootï¼ˆè€Œä¸ä¼šå†æ˜ å°„ä¸º nobodyï¼‰ã€‚å½“ç„¶è¿™ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶éƒ½æœ‰ UIDï¼ˆGIDï¼‰ä¸º1000çš„ç”¨æˆ·ï¼ˆä¸ç®¡ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼‰ï¼Œåˆ™è¿™äº›ç”¨æˆ·ä¼šå…±äº«æœåŠ¡ç«¯ /home/starky ç›®å½•é‡Œçš„æ–‡ä»¶æƒé™ã€‚ å››ã€ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½å…±äº«ç›®å½•å¯ç¼–è¾‘ /etc/fstab æ–‡ä»¶ä»¤æŒ‚è½½å…±äº«ç›®å½•çš„ mount æ“ä½œæˆä¸ºç³»ç»Ÿçš„å›ºå®šé…ç½®ï¼ˆæ‰‹åŠ¨è¾“å…¥çš„ mount å‘½ä»¤å±žäºŽä¸´æ—¶æŒ‚è½½ï¼Œé‡å¯ä¼šè‡ªåŠ¨å¸è½½ï¼‰ï¼Œä½¿å¾—ç³»ç»Ÿé‡å¯åŽå¯ä»¥è‡ªåŠ¨æŒ‚è½½è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿã€‚/etc/fstab æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š1234# filesystem mountpoint fstype flags dump fsck192.168.56.102:/var/nfs/gernel /mnt/nfs/gernel nfs rw,bg,intr,hard,nodev,nosuid 0 0192.168.56.102:/var/nfs/public /mnt/nfs/public nfs4 ro,bg,intr,soft,nodev,nosuid 0 0192.168.56.102:/home/starky /mnt/nfs/starky nfs rw,bg,intr,hard,nodev,nosuid 0 0 é™„å½•ï¼š1. /etc/exports æ–‡ä»¶ä¸­çš„ Host æ ¼å¼/etc/exports æ–‡ä»¶çš„æ ¼å¼ä¸ºï¼šDirectory Host(Options ...) Host(Options) #commentå…¶ä¸­çš„ Host é¡¹ç”¨æ¥æŒ‡å®šå¯è®¿é—®å¯¹åº”å…±äº«ç›®å½•çš„ä¸»æœºï¼Œå…¶æ ¼å¼å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼š å•ä¸ªä¸»æœºHost é¡¹å¯ä»¥ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå•ç‹¬çš„ TCP/IP ä¸»æœºåæˆ– IP åœ°å€ 123adminadmin.starky.net192.168.56.101 IP å­ç½‘ 12310.0.0.0/255.0.0.0 172.16.0.0/255.255.0.0192.168.56.0/24 TCP/IP åŸŸé€šè¿‡ä½¿ç”¨é€šé…ç¬¦ï¼Œå¯ä»¥æŒ‡å®šæŸä¸ªç‰¹å®šåŸŸä¸­çš„å…¨éƒ¨æˆ–éƒ¨åˆ†ä¸»æœº 123*.starky.net*craft.starky.net???.starky.net NIS ç»„å¯ä»¥æŒ‡å®šæŸä¸ª NIS ç»„ä¸­æ‰€æœ‰ä¸»æœºçš„è®¿é—®æƒé™ï¼Œä½¿ç”¨ @group 2. /etc/exports æ–‡ä»¶ä¸­çš„ Options é€‰é¡¹ æè¿° ro åªè¯»æƒé™ rw è¯»å†™æƒé™ï¼ˆé»˜è®¤ï¼‰ rw=list é€šè¿‡ list æŒ‡å®šå…·æœ‰å†™æƒé™çš„å®¢æˆ·ç«¯ä¸»æœºï¼Œå…¶ä»–ä¸»æœºåˆ™ä¸ºåªè¯»æƒé™ root_squash å°† UID 0 å’Œ GID 0 æ˜ å°„åˆ° anonuid å’Œ anongidï¼ˆå³ Ubuntu ç³»ç»Ÿä¸­çš„ nobody å’Œ nogroupï¼‰ no_root_squash å…è®¸éœ€è¦ root æƒé™çš„æ–‡ä»¶æ“ä½œï¼Œæœ‰å®‰å…¨é£Žé™© all_squash å°†æ‰€æœ‰çš„ UID å’Œ GID æ˜ å°„åˆ°å®ƒä»¬çš„åŒ¿åå½¢å¼ï¼Œä¸»è¦é’ˆå¯¹ä¸ä¿¡ä»»çš„ä¸»æœº anonuid=xxx æŒ‡å®šå®¢æˆ·ç«¯ root æƒé™çš„æ“ä½œéœ€è¦æ˜ å°„åˆ°çš„ UIDï¼ˆé»˜è®¤æ˜¯65534ï¼‰ anongid=xxx æŒ‡å®šå®¢æˆ·ç«¯ root æƒé™çš„æ“ä½œéœ€è¦æ˜ å°„åˆ°çš„ GIDï¼ˆé»˜è®¤æ˜¯65534ï¼‰ insecure å…è®¸é€šè¿‡ä»»æ„ç«¯å£çš„è¿œç¨‹è®¿é—® async æœåŠ¡å™¨å¯ä»¥åœ¨å†™å…¥ç¡¬ç›˜ä¹‹å‰å“åº”å®¢æˆ·ç«¯çš„å†™å…¥è¯·æ±‚ wdelay é€šè¿‡å»¶è¿ŸåŒæ­¥å¤šä¸ªå®¢æˆ·ç«¯å¯¹æ–‡ä»¶çš„æ›´æ–° sec=flavor æŒ‡å®šå…±äº«ç›®å½•çš„å®‰å…¨éªŒè¯æ–¹æ³•ï¼ŒåŒ…æ‹¬ sysï¼ˆUNIX éªŒè¯ï¼‰ï¼Œdh (DES)ï¼Œkrb5iï¼Œkrb5p å’Œ noneï¼ˆåŒ¿åè®¿é—®ï¼‰ 3. NFS æŒ‚è½½é€‰é¡¹ é€‰é¡¹ æè¿° rw ä»¥è¯»å†™æ¨¡å¼æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼ˆrw ä¹Ÿéœ€åœ¨æœåŠ¡ç«¯å®šä¹‰ï¼‰ ro ä»¥åªè¯»æ¨¡å¼æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ bg å¦‚æŒ‚è½½å¤±è´¥ï¼ˆæœåŠ¡å™¨æ— å“åº”ï¼‰ï¼Œåœ¨åŽå°ç»§ç»­å°è¯•å¹¶æ‰§è¡Œå…¶ä»–æŒ‚è½½è¯·æ±‚ hard å¦‚æžœæœåŠ¡å™¨æ— å“åº”ï¼Œé‡å¤å‘é€è¯·æ±‚ç›´åˆ°æœåŠ¡å™¨å›žå¤ soft å¦‚æžœæœåŠ¡å™¨æ— å“åº”ï¼Œé‡å¤å‘é€è¯·æ±‚ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´åŽè¿”å›žé”™è¯¯ï¼Œè€Œä¸ä¼šä¸€ç›´é˜»å¡ž intr å…è®¸ç”¨æˆ·ä¸­æ–­é˜»å¡žçš„æ–‡ä»¶æ“ä½œï¼ˆå¹¶è¿”å›žé”™è¯¯ï¼‰ nointr ä¸å…è®¸ç”¨æˆ·ä¸­æ–­å®¢æˆ·ç«¯çš„æ–‡ä»¶æ“ä½œè¯·æ±‚ retrans=n åœ¨ soft æ¨¡å¼ä¸‹ï¼ŒæŒ‡å®šè¿”å›žé”™è¯¯å‰é‡å¤å‘é€è¯·æ±‚çš„æ¬¡æ•° timeo=n è®¾ç½®è¶…æ—¶åŽé‡å¤å‘é€è¯·æ±‚çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ 1/10 ç§’ï¼‰ rsize=n è®¾ç½®è¯»å– buffer å¤§å°ä¸º n bytes wsize=n è®¾ç½®å†™å…¥ buffer å¤§å°ä¸º n bytes sec=flavor è®¾ç½®å®‰å…¨éªŒè¯æ–¹æ³• proto=proto è®¾ç½®ä¼ è¾“åè®®ï¼ŒNFSv4 å¿…é¡»ä¸º TCP 4. NFS åè®®è®¨è®ºä¼ è¾“åè®®æœ€åˆçš„ NFSv2 ç”±äºŽæ€§èƒ½åŽŸå› ä½¿ç”¨ UDP åè®®ï¼Œè™½ç„¶ NFS æ·»åŠ äº†è‡ªå·±çš„åŒ…åºåˆ—é‡ç»„å’Œé”™è¯¯æ£€æŸ¥åŠŸèƒ½ï¼Œä½† UDP å’Œ NFS éƒ½ä¸å…·å¤‡é˜»å¡žæŽ§åˆ¶ç®—æ³•ï¼Œæ‰€ä»¥åœ¨å¤§åž‹çš„äº’è”ç½‘ç»œçŽ¯å¢ƒä¸­ç¼ºä¹è¶³å¤Ÿçš„æ€§èƒ½ã€‚NFSv3 æä¾›äº† UDP å’Œ TCP åè®®ä¹‹é—´çš„é€‰æ‹©ã€‚NFSv4 åªèƒ½ä½¿ç”¨ TCP åè®®ã€‚éšç€ CPUï¼Œå†…å­˜ç­‰ç¡¬ä»¶è®¾å¤‡å’Œç½‘ç»œä¼ è¾“é€Ÿåº¦çš„æé«˜ï¼Œæœ€åˆç”±äºŽæ€§èƒ½éœ€æ±‚è€Œå€¾å‘ UDP åè®®çš„é€‰æ‹©ä¹Ÿå˜å¾—ä¸å†å¿…è¦ã€‚ StateNFSv2 å’Œ NFSv3 æ˜¯æ— çŠ¶æ€çš„è¿žæŽ¥ï¼ŒæœåŠ¡ç«¯ä¸ä¼šè·Ÿè¸ªå®¢æˆ·ç«¯å¯¹å…±äº«ç›®å½•çš„æŒ‚è½½æƒ…å†µï¼Œè€Œæ˜¯ä½¿ç”¨ â€œcookieâ€ æ¥è®°å½•ä¸€æ¬¡æˆåŠŸçš„æŒ‚è½½ã€‚â€cookieâ€ ä¸ä¼šå› ä¸ºæœåŠ¡å™¨é‡å¯è€Œåˆ é™¤ï¼Œå¯ä»¥ç”¨æ¥åœ¨æœåŠ¡å™¨æŒ‚æŽ‰ä¹‹åŽä¿ç•™å®¢æˆ·ç«¯çš„è¿žæŽ¥ä¿¡æ¯ã€‚NFSv4 æ˜¯æœ‰çŠ¶æ€çš„è¿žæŽ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½ä¼šç»´æŠ¤æ–‡ä»¶æ“ä½œçºªå½•åŠæ–‡ä»¶é”çš„çŠ¶æ€ã€‚æ‰€ä»¥ä¸å†éœ€è¦ â€œcookieâ€ çš„ä½¿ç”¨ã€‚ æ–‡ä»¶é”æ—©æœŸç‰ˆæœ¬çš„ NFS åè®®ï¼ˆv2 &amp; v3ï¼‰ç”±äºŽæ˜¯æ— çŠ¶æ€çš„è¿žæŽ¥ï¼Œå®ƒä»¬å¹¶ä¸æ¸…æ¥šå“ªäº›ä¸»æœºæ­£åœ¨ä½¿ç”¨å“ªäº›æ–‡ä»¶ã€‚ä½†æ˜¯æ–‡ä»¶é”çš„å®žçŽ°åˆéœ€è¦èŽ·å–çŠ¶æ€ä¿¡æ¯ã€‚æ‰€ä»¥æ—©æœŸåè®®ä¸­çš„æ–‡ä»¶é”æ˜¯ç‹¬ç«‹äºŽ NFS å®žçŽ°çš„ã€‚è€Œ NFSv4 å°†æ–‡ä»¶é”çš„å®žçŽ°æ•´åˆåˆ°äº†æ ¸å¿ƒåè®®ä¸­ï¼Œè™½ç„¶æ­¤ä¸¾å¢žåŠ äº†å¤æ‚åº¦ï¼Œä½†åŒæ—¶ä¹Ÿè§£å†³äº†æ—©æœŸç‰ˆæœ¬ä¸­çš„å¾ˆå¤šé—®é¢˜ã€‚ä½†æ˜¯ä¸ºäº†å…¼å®¹ä½¿ç”¨ V2 å’Œ V3 åè®®çš„å®¢æˆ·ç«¯ï¼Œç‹¬ç«‹çš„ locked å’Œ statd å®ˆæŠ¤è¿›ç¨‹ä»æ—§éœ€è¦ã€‚ å®‰å…¨ç›¸å…³NFS åè®®æœ€åˆåœ¨è®¾è®¡æ—¶å¹¶ä¸å…³æ³¨å®‰å…¨æ€§ï¼ŒNFSv4 é€šè¿‡å¼•å…¥å¯¹æ›´å¼ºå¤§çš„å®‰å…¨æœåŠ¡å’Œèº«ä»½éªŒè¯çš„æ”¯æŒï¼ŒåŠ å¼ºäº†è¯¥åè®®çš„å®‰å…¨æ€§ã€‚ ä¼ ç»Ÿçš„ NFS åè®®å¤§å¤šä½¿ç”¨ AUTH_SYS éªŒè¯æ–¹å¼ï¼ŒåŸºäºŽ UNIX çš„ç”¨æˆ·å’Œç»„æ ‡è¯†ã€‚åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œå®¢æˆ·ç«¯åªéœ€è¦å‘é€è‡ªå·±çš„ UID å’Œ GID å¹¶ä¸ŽæœåŠ¡å™¨ä¸Šçš„ /etc/passwd æ–‡ä»¶å†…å®¹ä½œå¯¹æ¯”ï¼Œä»¥å†³å®šå…¶æ‹¥æœ‰æ€Žæ ·çš„æƒé™ã€‚æ‰€ä»¥å½“å¤šä¸ªå®¢æˆ·ç«¯å­˜åœ¨ UID ç›¸åŒçš„ç”¨æˆ·æ—¶ï¼Œè¿™äº›ç”¨æˆ·ä¼šæ‹¥æœ‰ç›¸åŒçš„æ–‡ä»¶æƒé™ã€‚æ›´è¿›ä¸€æ­¥ï¼Œæ‹¥æœ‰ root æƒé™çš„ç”¨æˆ·å¯ä»¥é€šè¿‡ su å‘½ä»¤åˆ‡æ¢åˆ°ä»»æ„ UID ç™»å½•ï¼ŒæœåŠ¡å™¨ä¼šå› æ­¤ç»™äºˆå…¶å¯¹åº” UID çš„æƒé™ã€‚ä¸ºäº†é˜²æ­¢ä¸Šé¢çš„é—®é¢˜å‡ºçŽ°ï¼ŒæœåŠ¡å™¨å¯é€‰æ‹©ä½¿ç”¨æ›´å¥å£®çš„éªŒè¯æœºåˆ¶æ¯”å¦‚ Kerberos ç»“åˆ NFS PRCSEC_GSSã€‚ NFS å…±äº«ç›®å½•çš„è®¿é—®æŽ§åˆ¶åŸºäºŽ /etc/exports æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸»æœºåæˆ– IP åœ°å€ã€‚ä½†æ˜¯å®¢æˆ·ç«¯å¾ˆå®¹æ˜“é’ˆå¯¹å…¶èº«ä»½å’Œ IP åœ°å€é€ å‡ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ã€‚NFSv4 åªä½¿ç”¨ TCP ä½œä¸ºè‡ªå·±çš„ä¼ è¾“åè®®ï¼Œè€Œä¸”é€šå¸¸åªå¼€æ”¾ 2049 ç«¯å£è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚åœ¨é…ç½®é˜²ç«å¢™æ—¶ï¼Œé™¤äº†æ”¾å¼€ 2049 ç«¯å£çš„é™åˆ¶å¤–ï¼Œè¿˜è¦æ—¶åˆ»æ³¨æ„æ•°æ®ä¼ è¾“çš„æºåœ°å€å’Œç›®æ ‡åœ°å€ã€‚ 5. Windows ç³»ç»ŸæŒ‚è½½å…±äº«ç›®å½•win10 ç³»ç»Ÿé»˜è®¤ä¸èƒ½æŒ‚è½½ NFS å…±äº«ç›®å½•ï¼Œéœ€è¦è¿›å…¥æŽ§åˆ¶é¢æ¿ - ç¨‹åº - ç¨‹åºå’ŒåŠŸèƒ½ - å¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½ï¼Œå‹¾é€‰ä¸Š NFS æœåŠ¡ã€‚ä¹‹åŽå°±å¯ä»¥ä½¿ç”¨ mount å‘½ä»¤æŒ‚è½½å…±äº«ç›®å½•äº†ã€‚åªæ˜¯ Windows ç³»ç»Ÿå¹¶ä¸ä½¿ç”¨ Linux é‚£æ ·çš„ç”¨æˆ·ç®¡ç†ï¼Œå¯¼è‡´æŒ‚è½½çš„å…±äº«ç›®å½•åªèƒ½è¯»å–è€Œæ²¡æœ‰å†™å…¥çš„æƒé™ã€‚è§£å†³åŠžæ³•æ˜¯åœ¨æ³¨å†Œè¡¨ä¸­æ–°å»ºä¸¤ä¸ª DWORD å€¼ï¼Œç”¨ä½œåŒ¿åç”¨æˆ·çš„ UID å’Œ GIDã€‚é»˜è®¤å‚æ•°ä¸‹çš„æŒ‚è½½é€‰é¡¹ï¼ŒUID å’Œ GID éƒ½ä¸º -2ï¼šå¯è¿›å…¥æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼ˆregeditï¼‰ï¼Œå®šä½åˆ° HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ClientForNFS\CurrentVersion\Default ï¼Œæ–°å»ºä¸¤ä¸ªåä¸º AnonymousUid å’Œ AnonymousGid çš„ DWORDï¼ˆ32ä½ï¼‰å€¼ï¼Œæ”¹æˆè‡ªå·±éœ€è¦ç”¨åˆ°çš„æ•°å­—ï¼ˆæˆ‘éƒ½æ”¹æˆäº† 0 ï¼Œå³å¯¹åº” Linux ç³»ç»Ÿä¸­çš„ root ç”¨æˆ·ã€‚å¦‚éœ€è¦æ”¹ä¸º 0 ä»¥å¤–çš„æ•°å­—ï¼Œæ³¨æ„å…ˆè½¬æ¢æˆ 16 ä½ï¼‰ã€‚æ­¤æ—¶çš„æŒ‚è½½é€‰é¡¹å˜ä¸ºï¼šå¦‚æ›´æ”¹æœªç”Ÿæ•ˆï¼Œå¯é‡å¯ç”µè„‘ã€‚ å‚è€ƒèµ„æ–™UNIX and Linux System Administration Handbook, 4th EditionHow to Mount an NFS Share Using a Windows 10 Machine]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Configuration</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[netstat å‘½ä»¤ç”¨æ³•è¯¦è§£]]></title>
    <url>%2F2018%2F03%2F29%2Fnetstat-manual%2F</url>
    <content type="text"><![CDATA[Netstatï¼ˆnetwork statisticsï¼‰æ˜¯åœ¨å†…æ ¸ä¸­è®¿é—®ç½‘ç»œè¿žæŽ¥çŠ¶æ€åŠå…¶ç›¸å…³ä¿¡æ¯çš„å‘½ä»¤è¡Œç¨‹åºï¼Œå¯ä»¥æ˜¾ç¤ºè·¯ç”±è¡¨ã€å®žé™…çš„ç½‘ç»œè¿žæŽ¥å’Œç½‘ç»œæŽ¥å£è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯ï¼Œä»¥åŠä¸Ž IPã€TCPã€UDP å’Œ ICMP åè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºŽæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œæœåŠ¡è¿è¡ŒçŠ¶å†µã€‚ å‘½ä»¤é€‰é¡¹ æ˜¾ç¤ºæ‰€æœ‰è¿žæŽ¥ã€‚-a é€‰é¡¹ä¼šåˆ—å‡º tcp, udp å’Œ unix åè®®ä¸‹æ‰€æœ‰å¥—æŽ¥å­—çš„æ‰€æœ‰è¿žæŽ¥ã€‚ åªåˆ—å‡º TCP æˆ– UDP åè®®çš„è¿žæŽ¥ ä½¿ç”¨ -t é€‰é¡¹åˆ—å‡º TCP åè®®çš„è¿žæŽ¥ï¼Œå¯å’Œ -a é€‰é¡¹é…åˆä½¿ç”¨ ä½¿ç”¨ -u é€‰é¡¹åˆ—å‡º UDP åè®®çš„è¿žæŽ¥ ç¦ç”¨åå‘åŸŸåè§£æžï¼ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦é»˜è®¤æƒ…å†µä¸‹ netstat ä¼šé€šè¿‡åå‘åŸŸåè§£æžæŸ¥æ‰¾æ¯ä¸ª IP åœ°å€å¯¹åº”çš„ä¸»æœºåï¼Œä¼šé™ä½ŽæŸ¥æ‰¾é€Ÿåº¦ã€‚n é€‰é¡¹å¯ä»¥ç¦ç”¨æ­¤è¡Œä¸ºï¼Œå¹¶ä¸”ç”¨æˆ· ID å’Œç«¯å£å·ä¹Ÿä¼˜å…ˆä½¿ç”¨æ•°å­—æ˜¾ç¤ºã€‚ åªåˆ—å‡ºç›‘å¬ä¸­çš„è¿žæŽ¥-l é€‰é¡¹å¯ä»¥åªåˆ—å‡ºæ­£åœ¨ç›‘å¬çš„è¿žæŽ¥ï¼ˆä¸èƒ½å’Œ a é€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼‰ èŽ·å–è¿›ç¨‹åã€è¿›ç¨‹å·ä»¥åŠç”¨æˆ· ID-p é€‰é¡¹å¯ä»¥æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ï¼ˆæ­¤æ—¶ netstat åº”å°½é‡è¿è¡Œåœ¨ root æƒé™ä¹‹ä¸‹ï¼Œå¦åˆ™ä¸èƒ½å¾—åˆ°è¿è¡Œåœ¨ root æƒé™ä¸‹çš„è¿›ç¨‹åï¼‰-pe é€‰é¡¹å¯ä»¥åŒæ—¶æŸ¥çœ‹è¿›ç¨‹åï¼ˆå·ï¼‰å’Œè¿›ç¨‹æ‰€å±žçš„ç”¨æˆ·å æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯ä½¿ç”¨ -r é€‰é¡¹æ‰“å°å†…æ ¸è·¯ç”±ä¿¡æ¯ï¼Œä¸Ž route å‘½ä»¤è¾“å‡ºä¸€æ ·ã€‚ ç½‘ç»œæŽ¥å£ä¿¡æ¯-i é€‰é¡¹å¯ä»¥è¾“å‡ºç½‘ç»œæŽ¥å£è®¾å¤‡çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œç»“åˆä¸Š -e é€‰é¡¹ï¼Œç­‰äºŽ ifconfig å‘½ä»¤çš„è¾“å‡ºã€‚ èŽ·å–ç½‘ç»œåè®®çš„ç»Ÿè®¡ä¿¡æ¯-s é€‰é¡¹å¯ä»¥è¾“å‡ºé’ˆå¯¹ä¸åŒç½‘ç»œåè®®çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Ipã€Icmpã€Tcp å’Œ Udp ç­‰ã€‚ å‘½ä»¤å®žä¾‹ æ‰“å° active çŠ¶æ€çš„è¿žæŽ¥ æŸ¥çœ‹æŒ‡å®šæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ å‚è€ƒæ–‡ç« netstat çš„10ä¸ªåŸºæœ¬ç”¨æ³•]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Networking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu 16.04 é…ç½® L2TP over IPSec VPN æœåŠ¡å™¨]]></title>
    <url>%2F2018%2F03%2F23%2FL2TP-VPN-Server-on-Ubuntu-1604%2F</url>
    <content type="text"><![CDATA[VPN å³ Virtual Private Networkï¼ˆè™šæ‹Ÿä¸“ç”¨ç½‘ï¼‰ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨å…¬å…±ç½‘ç»œä¸Šæ­å»ºä¸€æ¡è™šæ‹Ÿçš„ç§æœ‰é“¾è·¯ï¼Œå¯ä»¥é€šè¿‡è¯¥é“¾è·¯åŠ å…¥åˆ°è¿œç¨‹çš„ç§æœ‰ç½‘ç»œçŽ¯å¢ƒä¸­ã€‚æ‰€ä»¥å¸¸ç”¨æ¥å¸®åŠ©å‘˜å·¥åœ¨åŠžå…¬å®¤å¤–å®‰å…¨åœ°è®¿é—®ä¼ä¸šå†…éƒ¨ç½‘ã€‚åˆ›å»ºç§æœ‰é“¾è·¯éœ€è¦ä½¿ç”¨éš§é“æŠ€æœ¯ï¼Œç”¨åˆ°çš„åè®®åŒ…æ‹¬ç‚¹å¯¹ç‚¹éš§é“åè®®ï¼ˆPPTPï¼‰ï¼Œç¬¬2å±‚éš§é“åè®®ï¼ˆL2TPï¼‰ç­‰ã€‚macOS ç³»ç»Ÿå·²ç»ä¸å†æ”¯æŒ PPTP ç±»åž‹çš„ VPNã€‚ ä¸€ã€å®‰è£…è½¯ä»¶åŒ…$ sudo apt-get install strongswan xl2tpd ppp lsofIPSec æ˜¯ç»„å»ºå®‰å…¨çš„ VPN æ—¶ä½¿ç”¨çš„ä¸€ä¸ªåŠ å¯†å’Œè®¤è¯æ ‡å‡†ï¼Œè€Œ strongSwan æ˜¯ä¸€ä¸ªå®Œå…¨æ”¯æŒ IKEv1 å’Œ IKEv2 çš„ IKE åŽå°è¿›ç¨‹ã€‚ äºŒã€ä¿®æ”¹é…ç½®æ–‡ä»¶1. ä¿®æ”¹ç³»ç»Ÿè½¬å‘é…ç½®åœ¨ /etc/sysctl.conf æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š1234567net.ipv4.ip_forward = 1net.ipv4.conf.all.accept_redirects = 0net.ipv4.conf.all.send_redirects = 0net.ipv4.conf.default.rp_filter = 0net.ipv4.conf.default.accept_source_route = 0net.ipv4.conf.default.send_redirects = 0net.ipv4.icmp_ignore_bogus_error_responses = 1 å¯ç”¨é…ç½®ï¼š$ sudo sysctl -p 2. é…ç½® strongswan(IPSec)åœ¨ /etc/ipsec.conf æ–‡ä»¶æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š12345678910111213141516171819202122232425262728293031323334version 2 config setupconn L2TP-PSK-noNAT authby=secret #shared secret. Use rsasig for certificates. auto=add #the ipsec tunnel should be started and routes created when the ipsec daemon itself starts. keyingtries=3 #Only negotiate a conn. 3 times. ikelifetime=8h keylife=1h ike=aes256-sha1,aes128-sha1,3des-sha1 type=transport #because we use l2tp as tunnel protocol left=10.2.67.203 # VPN æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œ&apos;%any&apos; è¡¨ç¤ºä»»æ„åœ°å€ leftprotoport=17/1701 right=%any rightprotoport=17/%any dpddelay=10 # Dead Peer Dectection (RFC 3706) keepalives delay dpdtimeout=20 # length of time (in seconds) we will idle without hearing either an R_U_THERE poll from our peer, or an R_U_THERE_ACK reply. dpdaction=clear # When a DPD enabled peer is declared dead, what action should be taken. clear means the eroute and SA with both be cleared. é…ç½®å…±äº«å¯†é’¥ /etc/ipsec.secretsï¼š1%any : PSK &quot;PASSWORD&quot; %any é’ˆå¯¹ä»»æ„æœåŠ¡å™¨åœ°å€ï¼ŒPASSWORD éœ€è¦æ”¹ä¸ºè¶³å¤Ÿå®‰å…¨çš„é•¿å¯†ç  3. é…ç½® xl2tpdåœ¨ /etc/xl2tpd/xl2tpd.conf æ–‡ä»¶æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š1234567891011121314151617[global]ipsec saref = yessaref refinfo = 30;debug avp = yes;debug network = yes;debug state = yes;debug tunnel = yes[lns default]ip range = 192.168.100.100 - 192.168.100.200local ip = 192.168.100.1refuse pap = yesrequire authentication = yes;ppp debug = yespppoptfile = /etc/ppp/options.xl2tpdlength bit = yes local ip è¡¨ç¤º VPN è™šæ‹Ÿç½‘ç»œçš„ç½‘å…³ï¼Œip range è¡¨ç¤ºå®¢æˆ·ç«¯è¿žæŽ¥ VPN æœåŠ¡å™¨æ—¶èƒ½åˆ†é…åˆ°çš„ IP åœ°å€åœ¨ /etc/ppp/options.xl2tpd æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š12345678910111213require-mschap-v2ms-dns 10.2.64.1ms-dns 114.114.114.114authmtu 1200mru 1000crtsctshide-passwordmodemname l2tpdproxyarplcp-echo-interval 30lcp-echo-failure 4 ä¿®æ”¹ ms-dns ä¸ºéœ€è¦ vpn å®¢æˆ·ç«¯ä½¿ç”¨çš„ dns æœåŠ¡å™¨ 4. æ·»åŠ ç”¨æˆ·ä¿®æ”¹ /etc/ppp/chap-secrets æ–‡ä»¶ï¼š12starky l2tpd password1 *bob l2tpd password2 * æ ¼å¼ä¸ºï¼šç”¨æˆ·åã€æœåŠ¡ã€å¯†ç ã€é™åˆ¶ ip ã€‚ ä»¥ä¸Šçš„é…ç½®å®Œæˆä»¥åŽï¼Œé‡å¯æœåŠ¡å°±å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯è¿žæŽ¥äº†ã€‚ä¸è¿‡æ­¤æ—¶è¿˜ä¸èƒ½é€šè¿‡è¯¥ VPN è®¿é—®äº’è”ç½‘ï¼Œéœ€è¦éƒ¨ç½² IP è½¬å‘ï¼ˆä½¿ç”¨ iptables ï¼‰ã€‚ ä¸‰ã€é…ç½®è½¬å‘è¾“å…¥ä¸‹é¢çš„æŒ‡ä»¤ï¼Œå¼€å¯ gre åè®®ï¼Œå¹¶æ‰“å¼€æœåŠ¡å™¨ 47 å’Œ 1723 å·ç«¯å£ã€‚123$ sudo iptables -A INPUT -p gre -j ACCEPT $ sudo iptables -A INPUT -p tcp --dport 1723 -j ACCEPT $ sudo iptables -A INPUT -p tcp --dport 47 -j ACCEPT å¼€å¯ä¸€ä¸ª NAT è½¬å‘$ sudo iptables -t nat -A POSTROUTING -s 192.168.100.0/24 -o wlp4s0 -j MASQUERADEwlp4s0 è¡¨ç¤ºå½“å‰æœåŠ¡å™¨ä½¿ç”¨çš„ç½‘å¡è®¾å¤‡åã€‚å¯ä»¥é€šè¿‡ ifconfig å‘½ä»¤æŸ¥çœ‹ é€šè¿‡ä¸Šé¢çš„æŒ‡ä»¤ï¼Œiptables åšäº†è¿™æ ·ä¸€ä»¶äº‹ï¼šå°†æ‰€æœ‰ä»ŽæœåŠ¡å™¨ä¸Šä¼ å‡ºçš„æºåœ°å€ä¸º 192.168.100.1-255 çš„æ•°æ®åŒ…æº ip æ”¹æˆæœåŠ¡å™¨çš„ ip ã€‚ å››ã€è¿žæŽ¥æµ‹è¯•é¦–å…ˆéœ€è¦é‡å¯æœåŠ¡ï¼š12sudo ipsec restartsudo service xl2tpd restart Mac ç”µè„‘ä¸Šåœ¨ç½‘ç»œåå¥½è®¾ç½®é‡Œæ–°å»º VPN è¿žæŽ¥ï¼Œç±»åž‹é€‰ L2TP over IPSecã€‚éªŒè¯è®¾ç½®å¦‚ä¸‹å›¾ï¼šè¿žæŽ¥æˆåŠŸå›¾ç¤ºï¼šåœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨ Tcpdump çš„æŠ“åŒ…ç»“æžœï¼š å‚è€ƒæ–‡ç« Ubuntu 16.04 é…ç½®L2TP VPN Server]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Configuration</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Tcpdump å‘½ä»¤ç”¨æ³•è¯¦è§£]]></title>
    <url>%2F2018%2F03%2F20%2FTcpdump-manual%2F</url>
    <content type="text"><![CDATA[Tcpdump æ˜¯ä¿¡æ¯å®‰å…¨é¢†åŸŸå¸¸ç”¨çš„å—…æŽ¢å’Œç½‘ç»œåˆ†æžå·¥å…·ï¼Œè¿è¡Œåœ¨å‘½ä»¤è¡Œä¸‹ã€‚è™½ç„¶è¦ç”¨å¥½å®ƒéœ€è¦å¯¹ TCP/IP åè®®æœ‰è¶³å¤Ÿçš„äº†è§£ï¼Œä½†ä»Žå¦ä¸€ä¸ªè§’åº¦è®²ï¼Œå¤šç”¨ä¸€ä¸‹åŒæ ·ä¹Ÿèƒ½ä¿ƒè¿›å¯¹ç½‘ç»œåè®®çš„æŽŒæ¡ã€‚ å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆéƒ½å†…ç½®äº† Tcpdump å·¥å…·ã€‚å¦‚æžœæ²¡æœ‰ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨å¯¹åº”çš„åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼ˆå¦‚ï¼š$ sudo apt-get install tcpdump å’Œ $ sudo yum install tcpdumpï¼‰ ä¸€ã€å‘½ä»¤é€‰é¡¹ -i anyï¼šç›‘å¬æ‰€æœ‰ç½‘ç»œæŽ¥å£ -i eth0ï¼šç›‘å¬æŒ‡å®šçš„ç½‘ç»œæŽ¥å£ï¼ˆeth0ï¼‰ -Dï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ç½‘ç»œæŽ¥å£ -nï¼šä¸è§£æžä¸»æœºå -nnï¼šä¸è§£æžä¸»æœºåå’Œç«¯å£å -qï¼šè¾“å‡ºè¾ƒå°‘çš„ä¿¡æ¯ -tï¼šæ›´ä¾¿äºŽé˜…è¯»çš„æ—¶é—´æˆ³è¾“å‡º -ttttï¼šæœ€ä¾¿äºŽé˜…è¯»çš„æ—¶é—´æˆ³è¾“å‡º -Xï¼šä»¥ HEX å’Œ ASCII æ¨¡å¼è¾“å‡ºæ•°æ®åŒ…çš„å†…å®¹ -XXï¼šä¸Ž -X é€‰é¡¹ç›¸åŒï¼ŒåŒæ—¶è¿˜è¾“å‡º ethernet å¤´ -v, -vv, -vvvï¼šè¾“å‡ºæ›´å¤šæ•°æ®åŒ…çš„ä¿¡æ¯ -cï¼šèŽ·å–åˆ°æŒ‡å®šæ•°ç›®çš„æ•°æ®åŒ…åŽå°±åœæ­¢ -sï¼šå®šä¹‰ snaplength (size) ï¼Œ-s0 è¡¨ç¤ºèŽ·å–å…¨éƒ¨ -Sï¼šè¾“å‡ºç»å¯¹åºåˆ—å· -eï¼šèŽ·å– ethernet å¤´ä¿¡æ¯ -Eï¼šé€šè¿‡æä¾› key æ¥è§£å¯† IPSEC æµé‡ äºŒã€è¡¨è¾¾å¼é€šè¿‡è¡¨è¾¾å¼å¯ä»¥å¯¹å„ç§ä¸åŒç±»åž‹çš„ç½‘ç»œæµé‡è¿›è¡Œè¿‡æ»¤ï¼Œä»¥èŽ·å–åˆ°éœ€è¦çš„ä¿¡æ¯ã€‚è¿™ä¹Ÿæ˜¯ tcpdump å¼ºå¤§åŠŸèƒ½çš„ä¸€ä¸ªä½“çŽ°ã€‚ä¸»è¦æœ‰ 3 ç§ç±»åž‹çš„è¡¨è¾¾å¼ï¼š Typeï¼ˆç±»åž‹ï¼‰é€‰é¡¹åŒ…æ‹¬ host ã€net å’Œ port Directionï¼ˆæ–¹å‘ï¼‰é€‰é¡¹åŒ…æ‹¬ src å’Œ dst ä»¥åŠå®ƒä»¬çš„ç»„åˆ Protoï¼ˆåè®®ï¼‰åŒ…æ‹¬ tcp ã€udp ã€ICMP å’Œ ah ç­‰ ä¸‰ã€åº”ç”¨å®žä¾‹æŒ‡å®šç½‘ç»œæŽ¥å£ï¼š# tcpdump -i &lt;dev&gt;vboxnet0 æ˜¯ virtualvox è™šæ‹Ÿæœºé€šè¿‡ Host-only æ–¹å¼è™šæ‹Ÿçš„ä¸€å¼ ç½‘å¡ åŽŸå§‹ä¿¡æ¯è¾“å‡ºæ¨¡å¼ï¼š# tcpdump -ttttnnvvSæ›´è¯¦ç»†çš„è¾“å‡ºï¼Œä¸è§£æžä¸»æœºåå’Œç«¯å£åï¼Œä½¿ç”¨ç»å¯¹åºåˆ—å·ï¼Œæ–¹ä¾¿é˜…è¯»çš„æ—¶é—´æˆ³ é€šè¿‡IPåœ°å€è¿‡æ»¤ï¼š# tcpdump host 10.2.64.110.2.64.1 æ˜¯æˆ‘çš„ DNS æœåŠ¡å™¨åœ°å€ HEX è¾“å‡º# tcpdump -nnvXSs 0 -c1 icmp é€šè¿‡æºåœ°å€å’Œç›®æ ‡åœ°å€è¿›è¡Œè¿‡æ»¤# tcpdump src 10.2.67.203 # tcpdump dst 10.2.67.203 é€šè¿‡å­ç½‘è¿›è¡Œè¿‡æ»¤# tcpdump net 10.2.64.0/24 ç›‘å¬æŒ‡å®šç«¯å£å·# tcpdump port 515515 æ˜¯æœ¬åœ°æ‰“å°æœº LPD æœåŠ¡çš„ç«¯å£å· æŒ‡å®šåè®®# tcpdmp icmp ç«¯å£èŒƒå›´# tcpdump portrange 21-23 é€šè¿‡åŒ…å¤§å°è¿‡æ»¤# tcpdump less 32# tcpdump greater 64# tcpdump &lt;= 128 å†™å…¥ PCAP æ–‡ä»¶# tcpdump port 80 -w capture_file è¯»å– PCAP æ–‡ä»¶# tcpdump -r capture_file å››ã€é«˜çº§åŠŸèƒ½1. é€»è¾‘è¿ç®—ç¬¦å¯ä»¥é€šè¿‡å‘½ä»¤é€‰é¡¹çš„ä¸åŒç»„åˆï¼ˆä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ï¼‰å®Œæˆæ›´å¤æ‚çš„ä»»åŠ¡ã€‚è¿ç®—ç¬¦åŒ…æ‹¬ä»¥ä¸‹3ç§ï¼š ANDï¼ˆand æˆ– &amp;ï¼‰ ORï¼ˆor æˆ– ||ï¼‰ EXCEPT ï¼ˆnot æˆ– !ï¼‰ # tcpdump src 10.2.64.29 and dst port 80å³æ•æ‰ä»ŽæŒ‡å®šä¸»æœºï¼ˆ10.2.64.92ï¼‰å‘å‡ºï¼Œä¸”ç›®æ ‡ç«¯å£ä¸º 80 çš„æ‰€æœ‰ç½‘ç»œæ•°æ® # tcpdump src net 192.168.0.0/16 and dst net 10.0.0.0/8 or 172.16.0.0/16å³æ•æ‰ä»ŽæŒ‡å®šå­ç½‘ï¼ˆ192.168.0.0/16ï¼‰å‘é€åˆ°ç›®æ ‡å­ç½‘ï¼ˆ10.0.0.0/8 å’Œ 172.16.0.0/16ï¼‰çš„æ‰€æœ‰ç½‘ç»œæ•°æ® # tcpdump src 192.168.56.1 and not dst port 22å³æ•æ‰ä»ŽæŒ‡å®šä¸»æœºï¼ˆ192.168.56.1ï¼‰å‘å‡ºï¼Œä¸”ç›®æ ‡ç«¯å£ä¸ä¸º 22 çš„æ‰€æœ‰ç½‘ç»œæ•°æ® 2. æŒ‡å®š TCP æ ‡å¿—ä½ï¼ˆFlagsï¼‰# tcpdump &#39;tcp[13] &amp; 32!=0&#39; æ‰€æœ‰ URGENT (URG) åŒ…# tcpdump &#39;tcp[13] &amp; 16!=0&#39; æ‰€æœ‰ ACKNOWLEDGE (ACK) åŒ…# tcpdump &#39;tcp[13] &amp; 8!=0&#39; æ‰€æœ‰ PUSH (PSH) åŒ…# tcpdump &#39;tcp[13] &amp; 4!=0&#39; æ‰€æœ‰ RESET (RST) åŒ…# tcpdump &#39;tcp[13] &amp; 2!=0&#39; æ‰€æœ‰ SYNCHRONIZE (SYN) åŒ…# tcpdump &#39;tcp[13] &amp; 1!=0&#39; æ‰€æœ‰ FINISH (FIN) åŒ…# tcpdump &#39;tcp[13]=18&#39; æ‰€æœ‰ SYNCHRONIZE/ACKNOWLEDGE (SYNACK) åŒ… å…¶ä»–æŒ‡å®šæ ‡å¿—ä½çš„æ–¹å¼å¦‚ï¼š# tcpdump &#39;tcp[tcpflags] == tcp-syn&#39;# tcpdump &#39;tcp[tcpflags] == tcp-fin&#39; ä¸€äº›ç‰¹æ®Šçš„ç”¨æ³•# tcpdump &#39;tcp[13] = 6&#39; RST å’Œ SYN åŒæ—¶å¯ç”¨çš„æ•°æ®åŒ…ï¼ˆä¸æ­£å¸¸ï¼‰# tcpdump &#39;tcp[32:4] = 0x47455420&#39; èŽ·å– http GET è¯·æ±‚çš„æ–‡æœ¬# tcpdump &#39;tcp[(tcp[12]&gt;&gt;2):4] = 0x5353482D&#39; èŽ·å–ä»»ä½•ç«¯å£çš„ ssh è¿žæŽ¥ï¼ˆé€šè¿‡ banner ä¿¡æ¯ï¼‰# tcpdump &#39;ip[8] &lt; 10&#39; ttl å°äºŽ 10 çš„æ•°æ®åŒ…ï¼ˆå‡ºçŽ°é—®é¢˜æˆ– traceroute å‘½ä»¤ï¼‰# tcpdump &#39;ip[6] &amp; 128 != 0&#39; éžå¸¸æœ‰å¯èƒ½æ˜¯é»‘å®¢å…¥ä¾µçš„æƒ…å†µ å‚è€ƒæ–‡ç« ï¼šA tcpdump Tutorial and Primer with Examples]]></content>
      <categories>
        <category>Pentest</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Security</tag>
        <tag>Networking</tag>
        <tag>Pentest</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®€å•å®žç”¨çš„ vim é…ç½®æ–‡ä»¶]]></title>
    <url>%2F2018%2F03%2F20%2Fvim-configuration%2F</url>
    <content type="text"><![CDATA[Vim å·ç§°ã€Žç¼–è¾‘å™¨ä¹‹ç¥žã€ï¼Œæ—¢å·²æˆç¥žï¼Œè‡ªç„¶æœ‰å®ƒå‡Œé©¾äºŽä¼—ç”Ÿä¹‹ä¸Šçš„èµ„æœ¬ã€‚è€Œæˆ‘åªæ˜¯æ‹¿å®ƒå½“ä¸ªã€Žç¼–è¾‘å™¨ã€ç½¢äº†ã€‚ä»Žæ¥æ²¡æƒ³è¿‡é¼“æ£äº›ä»€ä¹ˆç¥žå¥‡çš„æ’ä»¶ï¼Œç„¶åŽæ‘‡èº«ä¸€å˜ï¼Œæˆäº†åˆ«äººçœ¼é‡Œæ— æ‰€ä¸èƒ½çš„ã€ŽIDEã€ã€‚åœ¨æˆ‘çœ‹æ¥æ€»æœ‰äº›æ‹›æ‘‡æ’žéª—çš„æ„Ÿè§‰ã€‚å¯èƒ½æŠ˜è…¾çš„è¿‡ç¨‹æ‰æ˜¯æœ€å€¼å¾—ä½“å‘³çš„å§ã€‚åªæ˜¯å› ä¸ºå®ƒçš„é«˜æ•ˆï¼Œéšæ‰‹å¯å¾—ï¼Œå¶å°”æ”¹æ”¹é…ç½®æ–‡ä»¶ä»€ä¹ˆçš„ï¼Œæ„Ÿè§‰å¾ˆé¡ºæ‰‹å°±å¤Ÿäº†ã€‚ æ‰€ä»¥è¿™å„¿è´´å‡ºçš„é…ç½®æ–‡ä»¶ï¼Œåˆè¡·ä¹Ÿåªæ˜¯æ‹¿å®ƒä½œä¸ºä¸€ä¸ªå†ç®€å•ä¸è¿‡çš„ç¼–è¾‘å™¨ï¼Œæœ€èµ·ç çš„è¦æ±‚ï¼Œå°±æ˜¯çœ‹ä¸ŠåŽ»æ›´åˆæˆ‘èƒƒå£ä¸€ç‚¹ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697&quot; å…³é—­å¯¹ vi çš„å…¼å®¹æ€§set nocompatible&quot; ä½¿é€€æ ¼é”®æ­£å¸¸å¤„ç† indent,eol,start ç­‰set backspace=2&quot; æ˜¾ç¤ºè¡Œå·set nu&quot; æ˜¾ç¤ºæ ‡å°ºset ruler&quot; çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œset cursorline&quot; é«˜äº®æ˜¾ç¤ºå¯¹åº”çš„æ‹¬å·set showmatch&quot; å¯¹åº”æ‹¬å·çš„é«˜äº®æ—¶é—´ï¼ˆå•ä½ 1/10 ç§’ï¼‰set matchtime=5&quot; é«˜äº®æœç´¢æ—¶çš„åŒ¹é…é¡¹set hlsearch&quot; æœç´¢æ—¶é€å­—ç¬¦åŒ¹é…set incsearch&quot; æœç´¢æ—¶å¿½ç•¥å¤§å°å†™set ignorecase&quot; å¼€å¯è¯­æ³•é«˜äº®syntax on&quot; å¼€å¯æ–‡ä»¶ç±»åž‹æ£€æµ‹filetype on&quot; å…è®¸è½½å…¥å¯¹åº”æ–‡ä»¶ç±»åž‹çš„æ’ä»¶filetype plugin on&quot; ä¸ºç‰¹å®šæ–‡ä»¶è½½å…¥å¯¹åº”çš„ç¼©è¿›æ–‡ä»¶filetype indent on&quot; å…³é—­å¤‡ä»½åŠŸèƒ½set nobackup&quot; æ–‡ä»¶æœªä¿å­˜(æˆ–æ–‡ä»¶åªè¯»)æ—¶å¼¹å‡ºç¡®è®¤set confirm&quot; åˆ‡æ¢ buffer æ—¶è‡ªåŠ¨ä¿å­˜å½“å‰æ–‡ä»¶set autowrite&quot; æ–‡ä»¶æœ‰å¤–éƒ¨æ”¹åŠ¨æ—¶è‡ªåŠ¨è½½å…¥set autoread&quot; è‡ªåŠ¨åˆ‡æ¢ä¸ºå½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•set autochdir&quot; è®¾ç½®é¼ æ ‡å¯ç”¨set mouse=aset selection=exclusiveset selectmode=mouse,key&quot; å…±äº«å‰ªè´´æ¿set clipboard+=unnamed&quot; éšè—å·¥å…·æ å’Œèœå•æ ï¼ˆGVimï¼‰&quot;set guioptions-=T&quot;set guioptions-=m&quot; tab å®½åº¦å’Œç¼©è¿›è®¾ç½®set tabstop=4set shiftwidth=4&quot; ä¸ä½¿ç”¨ç©ºæ ¼ä»£æ›¿åˆ¶è¡¨ç¬¦set noexpandtab&quot; åœ¨è¡Œå’Œæ®µå¼€å§‹å¤„ä½¿ç”¨åˆ¶è¡¨ç¬¦set smarttab&quot; ä½¿ç”¨ C é£Žæ ¼çš„ç¼©è¿›set cindent&quot; è‡ªåŠ¨ç¼©è¿›ï¼ˆç»§æ‰¿ä¸Šä¸€è¡Œçš„ç¼©è¿›æ–¹å¼ï¼‰set autoindent&quot; ä¸º C ç¨‹åºæä¾›è‡ªåŠ¨ç¼©è¿›set smartindent&quot; å…è®¸æŠ˜å set foldenable&quot; æ ¹æ®è¯­æ³•æŠ˜å set fdm=syntax&quot; æ‰‹åŠ¨æŠ˜å &quot; set fdm=manual&quot; è®¾å®šæŠ˜å å±‚æ•°setlocal foldlevel=1&quot; é€šè¿‡ç©ºæ ¼é”®å¼€å…³æŠ˜å nnoremap &lt;space&gt; @=((foldclosed(line(&apos;.&apos;)) &lt; 0) ? &apos;zc&apos; : &apos;zo&apos;)&lt;CR&gt;&quot; æ˜¾ç¤ºçŠ¶æ€æ set laststatus=2&quot; è®¾ç½®çŠ¶æ€æ æ˜¾ç¤ºçš„ä¿¡æ¯set statusline=\ %&lt;%.20F[%1*%M%*%n%R%H]%=\ [%&#123;&amp;ff&#125;:%&#123;&amp;encoding&#125;]\ %Y\ \ \ %l:%v\ %p%%/%L\ \ \ %&#123;strftime(\&quot;%y/%m/%d\ %H:%M\&quot;)&#125;\ \ &quot; æ˜¾ç¤ºè¾“å…¥çš„å‘½ä»¤set showcmd&quot; å¢žå¼ºæ¨¡å¼ä¸­çš„å‘½ä»¤è¡Œè‡ªåŠ¨å®ŒæˆåŠŸèƒ½set wildmenu&quot; è®¾ç½®å‘½ä»¤è¡Œçš„é«˜åº¦ï¼Œé»˜è®¤ä¸º 1set cmdheight=2&quot; è®¾ç½®ç¼–ç set encoding=utf-8set fileencodings=utf-8,usc-bom,shift-jis,gb18030,gbk,gb2312,cp936,utf-16,big-5,euc-jp,latin1set whichwrap=b,s,&lt;,&gt;,[,]&quot; å¼€å¯Normalæˆ–Visualæ¨¡å¼ä¸‹é€€æ ¼é”®ã€ç©ºæ ¼é”®ã€å·¦å³æ–¹å‘é”®ï¼ŒInsertæˆ–Replaceæ¨¡å¼ä¸‹å·¦å³æ–¹å‘é”®çš„è·³è¡ŒåŠŸèƒ½ æ²¡æœ‰æ’ä»¶ï¼Œç”šè‡³æ²¡æœ‰è‡ªå®šä¹‰ç»„åˆé”®ï¼Œè¿˜æ˜¯è§‰å¾—æ²¡é‚£ä¸ªå¿…è¦äº†ã€‚å€’æ˜¯çŠ¶æ€æ è´¹äº†å¥½ä¸€é˜µåŠŸå¤«ã€‚ã€‚ã€‚ä¹Ÿè®¸æœ‰æœºä¼šï¼Œå¯ä»¥å¥½å¥½é™ªå®ƒçŽ©ä¸€ä¸‹ï¼Œæ„Ÿå—æ„Ÿå—ç¥žä¹‹å…‰èŠ’çš„æ´—ç¤¼ã€‚è¿™ä¼šå„¿ï¼Œåªå½“å®ƒæ˜¯ä¸ªå·¥å…·ã€‚å¯¹ä¸èµ·å’¯]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Tools</tag>
        <tag>Configuration</tag>
        <tag>VIM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨ Ubuntu 16.04 ä¸Šé€šè¿‡ SSL/TLS æ­å»ºå®‰å…¨çš„ FTP æœåŠ¡å™¨]]></title>
    <url>%2F2018%2F03%2F19%2Fsecure-ftp-with-tls-on-ubuntu%2F</url>
    <content type="text"><![CDATA[FTP æ˜¯ File Transfer Protocol ï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰çš„ç®€ç§°ï¼Œç”¨äºŽåœ¨ Internet ä¸ŠæŽ§åˆ¶æ–‡ä»¶çš„åŒå‘ä¼ è¾“ã€‚ä½œä¸ºå¾ˆå¤è€çš„ä¸€ç§æ–‡ä»¶ä¼ è¾“åè®®ï¼Œç®€å•çš„æœåŠ¡å™¨æ­å»ºå’Œä¸°å¯Œçš„å®¢æˆ·ç«¯æ”¯æŒæ˜¯å®ƒçš„ä¼˜åŠ¿ï¼Œä½†å®‰å…¨æ€§å´æ˜¯å®ƒå¾ˆå¤§çš„ä¸€ä¸ªè½¯è‚‹ã€‚ï¼ˆåœ¨å»ºç«‹è¿žæŽ¥æ—¶ä½¿ç”¨æ˜Žæ–‡ä¼ è¾“ç”¨æˆ·åå’Œå¯†ç ç­‰é‡è¦ä¿¡æ¯ï¼‰ ä¸€ã€å®‰å…¨æ€§æµ‹è¯•1. å®‰è£… ftp æœåŠ¡ï¼šubuntu 16.04 å¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨ç›´æŽ¥å®‰è£… vsftpd ä»¥å»ºç«‹ ftp æœåŠ¡å™¨ã€‚$ sudo apt-get install vsftpd vsftpd çš„é…ç½®æ–‡ä»¶ä¸º /etc/vsftpd.confï¼Œé»˜è®¤å³å¼€å¯äº†æœ¬åœ°ç”¨æˆ·ï¼ˆlocal_enable=YESï¼‰çš„ç™»å½•å’Œä¸‹è½½æƒé™ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚å¦‚éœ€ä½¿ç”¨ä¸Šä¼ åŠŸèƒ½ï¼Œå¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­ #write_enable=YES å‰é¢çš„æ³¨é‡ŠåŽ»æŽ‰ã€‚å› ä¸ºä¸»è¦æ˜¯æµ‹è¯•å®‰å…¨æ€§ï¼Œå…¶ä»–é…ç½®é€‰é¡¹æš‚ä¸åšæ”¹åŠ¨ã€‚ 2. ä½¿ç”¨ wireshark æŠ“åŒ…Wireshark æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œæŠ“åŒ…å’Œåˆ†æžå·¥å…·ã€‚è¿™é‡Œä½¿ç”¨å®ƒæ¥å¯¹ FTP å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢è¿›è¡Œç›‘æŽ§ã€‚å› ä¸º Ubuntu æœåŠ¡å™¨å®‰è£…åœ¨ virtualbox è™šæ‹Ÿæœºä¸­ï¼Œè”ç½‘ä½¿ç”¨çš„æ˜¯ Host-only æ¨¡å¼ï¼Œæ‰€ä»¥æŠ“åŒ…æ—¶ç›‘æŽ§çš„æ˜¯ vboxnet0 è™šæ‹Ÿç½‘å¡ã€‚ æ•ˆæžœå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼ŒFTP çš„ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ä½¿ç”¨æ˜Žæ–‡ä¼ è¾“çš„ï¼Œå¯ä»¥ç›´æŽ¥è¢«çœ‹åˆ°ã€‚ 3. æ›´å®‰å…¨çš„ SFTP æœåŠ¡SFTP æ˜¯ Secure File Transfer Protocol ï¼ˆå®‰å…¨æ–‡ä»¶ä¼ é€åè®®ï¼‰çš„ç¼©å†™ï¼ŒåŒ…å«åœ¨ ssh æœåŠ¡ä¸­ã€‚Ubuntu 16.04 ç³»ç»Ÿä¸­ï¼Œé…ç½®å¥½ ssh æœåŠ¡åŽï¼Œsftp æœåŠ¡å³é»˜è®¤å¼€å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsftp ä½¿ç”¨äº†åŠ å¯†ã€è§£å¯†æŠ€æœ¯ï¼Œæ‰€ä»¥ä¼ è¾“æ•ˆçŽ‡æ¯”æ™®é€šçš„FTPè¦ä½Žå¾—å¤šã€‚ å¯ä»¥ä½¿ç”¨ sudo apt-get openssh-server å‘½ä»¤å®‰è£… ssh æœåŠ¡ï¼Œå¦‚ sftp æœåŠ¡æœªé»˜è®¤å¼€å¯ï¼Œå¯ä»¥ç¼–è¾‘ sshd é…ç½®æ–‡ä»¶ï¼š/etc/ssh/sshd_configï¼Œæ·»åŠ ä¸Š Subsystem sftp /usr/lib/openssh/sftp-serverã€‚ ä½¿ç”¨ sftp æœåŠ¡æ—¶çš„æŠ“åŒ…æˆªå›¾ï¼šå¯ä»¥çœ‹åˆ°ï¼ŒæˆªèŽ·çš„åŒ…å†…å®¹éƒ½å˜æˆäº† Encrypted packet äºŒã€æ­å»ºå®‰å…¨çš„ FTPS æœåŠ¡è¿™é‡Œè¦è¯¦ç»†è¯´æ˜Žçš„æ˜¯å¦å¤–ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨ SSL/TLS å¯¹ FTP çš„æ•°æ®ä¼ è¾“è¿›è¡ŒåŠ å¯†ã€‚å…³äºŽ SFTP ä¸Ž FTPS çš„ä¹‹é—´çš„å¯¹æ¯”ï¼Œå»ºè®®å‚è€ƒæ­¤æ–‡ç« ï¼šFTPS (FTP over SSL) vs SFTP (SSH File Transfer Protocol)ã€‚ 1. åˆ›å»ºè¯ä¹¦FTPS æ˜¯ä½¿ç”¨å®‰å…¨å¥—æŽ¥å±‚ï¼ˆSSLï¼‰è¯ä¹¦çš„ FTP æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ç”¨æˆ· IDã€å¯†ç å’Œ SSL è¯ä¹¦è¿›è¡Œèº«ä»½éªŒè¯ã€‚$ sudo openssl req -x509 -nodes -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem -days 365 -newkey rsa:2048ä¸Šé¢çš„å‘½ä»¤ç”¨äºŽç”Ÿæˆè¯ä¹¦å’Œ key å¹¶ä¿å­˜åœ¨ vsftpd.pem æ–‡ä»¶ä¸­ã€‚è¿è¡ŒåŽä¼šæç¤ºä½ è¾“å…¥ç›¸å…³ä¿¡æ¯ï¼ˆå¯ä»¥éšä¾¿å¡«å†™ï¼Œä¸è¦ç•™ç©ºï¼‰ï¼š1234567Country Name (2 letter code) [AU]:State or Province Name (full name) [Some-State]:Locality Name (eg, city) []:hangzhouOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Organizational Unit Name (eg, section) []:sectionCommon Name (e.g. server FQDN or YOUR name) []:starkyEmail Address []:starky@email.com 2. ä¿®æ”¹é…ç½®æ–‡ä»¶å¦‚æžœä½ æœ‰å¼€å¯ ufw é˜²ç«å¢™ï¼ˆé»˜è®¤æ˜¯æœªå¼€å¯çš„ï¼‰ï¼Œéœ€è¦å…ˆåœ¨é˜²ç«å¢™é…ç½®ä¸­å¼€æ”¾æŒ‡å®šç«¯å£ç”¨äºŽé€šè®¯å’Œæ•°æ®ä¼ è¾“ã€‚12$ sudo ufw allow 990/tcp$ sudo ufw allow 4000:5000/tcp æˆ‘è¿™é‡Œæ²¡æœ‰å¼€å¯ ufw ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»¥ä¸Šæ“ä½œã€‚ç›´æŽ¥ä¿®æ”¹ vsftpd çš„é…ç½®æ–‡ä»¶ï¼ˆ$ sudo vim /etc/vsftpd.confï¼‰ã€‚å°†æ–‡ä»¶ä¸­çš„å¯¹åº”é…ç½®åšå¦‚ä¸‹ä¿®æ”¹ï¼ˆæ²¡æœ‰å°±æ·»åŠ ï¼‰ï¼š1234567891011121314151617# å¼€å¯ ssl å¹¶æŒ‡å®šä½¿ç”¨çš„åè®®ssl_enable=YESssl_tlsv1=YESssl_sslv2=NOssl_sslv3=NO# æŒ‡å®šè¯ä¹¦å’Œ key æ–‡ä»¶rsa_cert_file=/etc/ssl/private/vsftpd.pemrsa_private_key_file=/etc/ssl/private/vsftpd.pem# å®‰å…¨é€‰é¡¹allow_anon_ssl=NOforce_local_data_ssl=YESforce_local_logins_ssl=YESrequire_ssl_reuse=NOssl_ciphers=HIGH# æŒ‡å®šä¸»åŠ¨æ¨¡å¼æ—¶ä½¿ç”¨çš„ç«¯å£èŒƒå›´pasv_min_port=40000pasv_max_port=50000 ä¿®æ”¹å®ŒæˆåŽé‡å¯ vsftpd æœåŠ¡ï¼š$ sudo systemctl restart vsftpd ä¸‰ã€è¿žæŽ¥éªŒè¯å®¢æˆ·ç«¯ä½¿ç”¨ filezilla è¿žæŽ¥æœåŠ¡å™¨ï¼Œæ–°å»ºç«™ç‚¹æ—¶ä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š12345Host: 192.168.56.102Protocol: FTP â€“ File Transfer ProtocolEncryption: Require explicit FTP over TLSLogon Type: Ask for passwordUser: username ç‚¹è¿žæŽ¥åŽä¼šè·³å‡ºè¾“å…¥å¯†ç ç•Œé¢å’Œè¯ä¹¦ä¿¡æ¯ï¼Œç¡®å®šä¹‹åŽå³å¯æˆåŠŸè¿žæŽ¥è€Œæ­¤æ—¶ wireshark çš„æŠ“åŒ…æˆªå›¾å¦‚ä¸‹ï¼šæ•æ‰åˆ°çš„è¯·æ±‚å’Œå“åº”ä¿¡æ¯éƒ½æ˜¯å·²åŠ å¯†è¿‡çš„å¯†æ–‡ã€‚ å‚è€ƒæ–‡ç« Setting Up a Secure FTP Server using SSL/TLS on Ubuntuå…³äºŽ vsftpd é…ç½®æ–‡ä»¶çš„è¯¦ç»†è§£é‡Šå¯å‚è€ƒï¼šVsftpd - Ubuntuä¸­æ–‡]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Server</tag>
        <tag>Ubuntu</tag>
        <tag>FTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èš‚èš±ä¹‹æ­»]]></title>
    <url>%2F2018%2F03%2F16%2FThe-Death-of-Grasshopper%2F</url>
    <content type="text"><![CDATA[æˆ‘å°æ—¶å€™æ˜¯ä¸ªæžæ¶æ¯’çš„å®¶ä¼™ç”°é‡Žåœ°å¤´å„¿ä¸Šèµ°ç€ï¼Œæ¯é‡èš‚èš±èŸ‹èŸ€ä¹‹æµæ— è®ºå¤§å°ï¼Œå¿…æ•è€Œæ€ä¹‹è¿˜æ˜¯å¾ˆæ®‹å¿çš„é‚£ç§ï¼Œå¤„å†³ç„¶åŽä»¥å¾—èƒœè€…çš„æ°”åŠ¿æ‰¬é•¿è€ŒåŽ»å¤§æœ‰æ›¿å¤©è¡Œé“çš„ä¾ è€…é£ŽèŒƒ ä»¥æ—§çš„ç¤¾ä¼šä¸»ä¹‰è®ºè°ƒè€Œè¨€ï¼Œå®ƒä»¬æ˜¯å®³è™«ï¼Œæ€äº†æ˜¯ä¸ºæ°‘é™¤å®³ä»Žç‰©ç«žå¤©æ‹©é€‚è€…ç”Ÿå­˜çš„è§‚å¿µæ¥è®²å¼ºè€…å‡Œé©¾äºŽå¼±è€…ä¹‹ä¸Šï¼Œåˆä¼¼ä¹Žå¤©ç»åœ°ä¹‰ äºŽæ˜¯ç»ˆäºŽå¦ç„¶ã€‚ç”šè‡³äºŽæœ‰äº†ä¸Šç˜¾çš„è¿¹è±¡ç›´åˆ°å¾ˆå¤šå¹´è¿‡åŽ»ï¼Œåˆ°äº†åŸŽé‡Œå¾ˆå°‘å†è§åˆ°å®ƒä»¬äº†ç«Ÿç„¶åˆå¼€å§‹æƒ³å¿µ æˆ‘ä»¬éƒ½æ˜¯äº›æ— èƒ½ä¸ºåŠ›çš„å¼±è€…åšç€äº›è‡ªæˆ‘æ¬ºéª—çš„å‹¾å½“ å°èš‚èš±ï¼Œå¸Œæœ›æœ‰æœºä¼šä½ æˆ‘å¯ä»¥è§’è‰²äº’æ¢]]></content>
      <categories>
        <category>nonsense</category>
      </categories>
      <tags>
        <tag>nonsense</tag>
        <tag>èƒ¡è¨€ä¹±è¯­</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ssh-ä½¿ç”¨-RSA-å¯†é’¥å®Œæˆå…å¯†ç ç™»å½•]]></title>
    <url>%2F2018%2F03%2F11%2Fssh-login-by-RSA%2F</url>
    <content type="text"><![CDATA[å¤§å¤šæ•° Linux æœåŠ¡å™¨å¹¶ä¸åŒ…å«å®Œå–„çš„ç”¨æˆ·ç•Œé¢ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿå¹¶éžå®‰è£…åœ¨æœ¬åœ°æœºå™¨ä¸Šã€‚è€Œæ˜¯ä½¿ç”¨ SSH è¿œç¨‹ç™»å½•çš„æ–¹å¼æ¥å®Œæˆå¯¹æœåŠ¡å™¨çš„æŽ§åˆ¶ã€‚SSHï¼ˆSecure Shellï¼‰æä¾›ä¸¤ç§çº§åˆ«çš„éªŒè¯æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯åŸºäºŽå£ä»¤çš„éªŒè¯ï¼Œå³ä½¿ç”¨è‡ªå·±çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•è¿œç¨‹æœºå™¨ã€‚ç¬¬äºŒç§æ˜¯åŸºäºŽå¯†é’¥çš„éªŒè¯ï¼Œå³å…ˆåœ¨æœ¬åœ°æœºå™¨ä¸Šåˆ›å»ºä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œå°†å…¬é’¥ä¸Šä¼ åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œç™»å½•æ—¶é€šè¿‡å¯¹æ¯”å®¢æˆ·ç«¯ä¸Žè¿œç¨‹ç«¯çš„å¯†é’¥æ¥è¿›è¡ŒéªŒè¯ã€‚åŸºäºŽå¯†é’¥çš„éªŒè¯æ˜¯ä¸éœ€è¦åœ¨ç½‘ç»œä¸Šä¼ è¾“å£ä»¤çš„ï¼Œç›¸å¯¹è€Œè¨€æ›´åŠ å®‰å…¨ã€‚ Linux ä¸Šçš„ ssh æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ openssh ï¼Œä½¿ç”¨è½¯ä»¶åŒ…ç®¡ç†å™¨ç›´æŽ¥å®‰è£…å³å¯ï¼š$ sudo apt-get install openssh-server ä½¿ç”¨å¯†é’¥è¿›è¡Œè¿œç¨‹ç™»å½•è¿˜å¯ä»¥å®žçŽ°è‡ªåŠ¨ç™»å½•ï¼ˆä¸éœ€è¦è¾“å…¥å¯†ç ï¼‰ï¼Œä»¥ä¸‹ä¸ºè¯¦ç»†é…ç½®è¿‡ç¨‹ã€‚ ä¸€ã€åœ¨æœ¬åœ°æœºå™¨ä¸Šåˆ›å»ºå¯†é’¥$ ssh-keygen -t rsa -C &#39;email@domain.com&#39;-t é€‰é¡¹ç”¨æ¥æŒ‡å®šå¯†é’¥ç±»åž‹ï¼Œé»˜è®¤å³ä¸º rsa)ï¼›-C é€‰é¡¹ç”¨æ¥æä¾›è¯´æ˜Žæ–‡å­—å‘½ä»¤æ‰§è¡ŒæˆåŠŸåŽä¼šåœ¨ ~/.ssh ç›®å½•ä¸‹åˆ†åˆ«åˆ›å»ºå…¬é’¥ï¼ˆé»˜è®¤ä¸º id_rsa.pubï¼‰å’Œç§é’¥ï¼ˆé»˜è®¤ä¸º id_rsaï¼‰æ–‡ä»¶ äºŒã€å°†å…¬é’¥ä¸Šä¼ è‡³æœåŠ¡å™¨è¿™ä¸€æ­¥éœ€è¦å°†æœ¬åœ°ç”Ÿæˆçš„å…¬é’¥æ–‡ä»¶ï¼ˆid_rsa.pubï¼‰å†…å®¹æ·»åŠ åˆ°æœåŠ¡å™¨ä¸Šçš„ ~/.ssh/authorized_keys æ–‡ä»¶ä¸­ã€‚ å¯ä½¿ç”¨ scp å‘½ä»¤å®Œæˆè¿œç¨‹å¤åˆ¶ï¼š1234$ scp ~/.ssh/id_rsa.pub username@hostname:~/ # å°†å…¬é’¥æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨ç”¨æˆ·ä¸»ç›®å½•$ ssh username@hostname # ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•è‡³æœåŠ¡å™¨$ mkdir .ssh # åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šåˆ›å»º .ssh ç›®å½•$ cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys # å°†å…¬é’¥æ–‡ä»¶å†…å®¹è¿½åŠ åˆ°authorized_keysæ–‡ä»¶æœ«å°¾ ä¸Šé¢æˆ‘ä½¿ç”¨çš„æ˜¯ virtualbox è™šæ‹Ÿæœºå®‰è£…çš„ ubuntu 16.04 Serverï¼Œåˆ©ç”¨ NAT çš„ç«¯å£è½¬å‘å°†å®¿ä¸»æœºçš„ 8022 ç«¯å£æ˜ å°„åˆ°äº†è™šæ‹Ÿæœºçš„ 22 ç«¯å£ã€‚-P 8022 ç”¨äºŽæŒ‡å®šç«¯å£å· ä»¥ä¸Šæ­¥éª¤å®ŒæˆåŽå°±å¯ä»¥é€šè¿‡ ssh username@hostname å‘½ä»¤ç›´æŽ¥ç™»å½•è¿œç¨‹ä¸»æœºã€‚ ä¸‰ã€é…ç½®ç™»å½•åˆ«åå¯ä»¥é€šè¿‡åœ¨æœ¬åœ°æœºå™¨ä¸Šçš„ ~/.ssh/config æ–‡ä»¶ä¸­å®šä¹‰åˆ«åï¼Œç„¶åŽä½¿ç”¨ ssh &lt;alias&gt; å‘½ä»¤å³å¯ç›´æŽ¥ç™»å½•è¿œç¨‹æœåŠ¡å™¨ã€‚è¯¥æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼š12345Host alias # è‡ªå®šä¹‰åˆ«åHostName hostname # æœåŠ¡å™¨åœ°å€Port port # è¿œç¨‹ ssh æœåŠ¡çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸º22User user # ç”¨æˆ·åIdentityFile ~/.ssh/id_rsa # æœ¬åœ°å…¬é’¥æ–‡ä»¶ä½ç½® ç™»å½•æ•ˆæžœï¼š é’ˆå¯¹ç¬¬äºŒæ­¥ä¸­ä¸Šä¼ å¯†é’¥çš„æ“ä½œï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤ï¼š$ cat ~/.ssh/id_rsa.pub | ssh username@hostname &quot;mkdir ~/.ssh; cat &gt;&gt; ~/.ssh/authorized_keys&quot; é™„ï¼šé…ç½® github è´¦å·æ—¶ä¹Ÿéœ€è¦ç”¨åˆ°ç”Ÿæˆå¯†é’¥çš„æ“ä½œï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„ ssh-keygen å‘½ä»¤]]></content>
      <categories>
        <category>Admin</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Server</tag>
        <tag>Networking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux æ‰“åŒ… åŽ‹ç¼© è§£åŽ‹ å‘½ä»¤è¯¦è§£]]></title>
    <url>%2F2018%2F03%2F11%2Fuse-tar-to-package-and-compress-files%2F</url>
    <content type="text"><![CDATA[tar å‘½ä»¤æ˜¯ Linux çŽ¯å¢ƒä¸‹æœ€åŸºæœ¬çš„æ‰“åŒ…å·¥å…·ï¼Œæ³¨æ„æ‰“åŒ…å¹¶ä¸ç­‰åŒäºŽåŽ‹ç¼©ã€‚æ‰“åŒ…åªæ˜¯è´Ÿè´£å°†å¤šä¸ªæ–‡ä»¶æ•´ç†åŽåˆæˆä¸ºä¸€ä¸ªæ–‡ä»¶åŒ…ï¼ˆå³å½’æ¡£ï¼Œæ–¹ä¾¿ä¼ è¾“åˆ†äº«ï¼‰ï¼Œä¸€èˆ¬åŽç¼€ä¸º .tarã€‚è€Œæ–‡ä»¶æ‰“åŒ…åŽé€šå¸¸éƒ½è¦è¿›è¡ŒåŽ‹ç¼©ï¼Œä»¥èŠ‚çœç©ºé—´å’Œä¼ è¾“æ—¶é—´ã€‚æ‰€ä»¥æ‰“åŒ…å’ŒåŽ‹ç¼©æ˜¯ç´§å¯†ç›¸å…³ä½†å¹¶ä¸ç›¸åŒçš„ä¸¤ä¸ªå‘½ä»¤ï¼ˆè¿‡ç¨‹ï¼‰ã€‚ç”¨ tar å‘½ä»¤åŠ ä¸Šé€‚å½“çš„é€‰é¡¹å¯ä»¥ç»Ÿä¸€æ‰§è¡Œè¿™ä¸¤é“ç¨‹åºã€‚ ä¸€ã€åŽ‹ç¼©å‘½ä»¤å¸¸ç”¨çš„ Linux åŽ‹ç¼©å·¥å…·å¦‚ä¸‹ï¼š åŽ‹ç¼©å·¥å…· å¯¹åº”åŽç¼€ å¯¹åº” tar é€‰é¡¹ gzip .gz z bzip2 .bz æˆ– .bz2 j compress .Z Z xz .xz J lzma .lzma a PSï¼šlzma ç­‰åŒäºŽ xz â€“format=lzma å…³äºŽä¸Šé¢è¡¨æ ¼ä¸­çš„åŽ‹ç¼©å‘½ä»¤ï¼Œå‘½ä»¤é€‰é¡¹éƒ½å¤§åŒå°å¼‚ã€‚å¯ä»¥æŸ¥çœ‹ç›¸åº”çš„å¸®åŠ©ä¿¡æ¯ï¼ˆå¦‚ gzip --helpï¼‰æˆ–æ‰‹å†Œï¼ˆå¦‚ man xzï¼‰ã€‚ äºŒã€ä½¿ç”¨ tar å‘½ä»¤æ‰“åŒ…åŽ‹ç¼©å•ç‹¬ä½¿ç”¨åŽ‹ç¼©å‘½ä»¤ï¼ˆå¦‚ gzip æˆ– bzip2ï¼‰çš„æƒ…å½¢å¹¶ä¸å¸¸è§ï¼Œå¤šç”¨äºŽå•ä¸ªæ–‡ä»¶æˆ–å¯¹å¤šä¸ªæ–‡ä»¶é€ä¸ªè¿›è¡ŒåŽ‹ç¼©ã€‚æ›´å¤šçš„æ—¶å€™ä½¿ç”¨ tar å‘½ä»¤å…ˆæ‰“åŒ…å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•åŽå†é…åˆæŒ‡å®šçš„é€‰é¡¹æ‰§è¡ŒåŽ‹ç¼©æ“ä½œã€‚ tar å‘½ä»¤é€‰é¡¹ï¼š ç¬¬ä¸€é€‰é¡¹ï¼ˆæŒ‡å®šæ“ä½œæ–¹å¼ï¼‰ï¼š -c ï¼šåˆ›å»ºå½’æ¡£æ–‡ä»¶ -x ï¼šè§£åŒ…å½’æ¡£æ–‡ä»¶ -t ï¼šåˆ—å‡ºå½’æ¡£æ–‡ä»¶çš„å†…å®¹åˆ—è¡¨ -r ï¼šå‘å½’æ¡£æ–‡ä»¶ä¸­æ·»åŠ ï¼ˆæ›¿æ¢ï¼‰æ–‡ä»¶ï¼ˆåªå¯¹æœªåŽ‹ç¼©çš„å½’æ¡£æ–‡ä»¶æœ‰æ•ˆï¼‰ -u ï¼šæ›´æ–°å½’æ¡£æ–‡ä»¶ä¸­çš„å†…å®¹ï¼ˆåªå¯¹æœªåŽ‹ç¼©çš„å½’æ¡£æ–‡ä»¶æœ‰æ•ˆï¼‰ åŽ‹ç¼©é€‰é¡¹ï¼ˆæŒ‡å®šåŽ‹ç¼©æ–¹æ³•ï¼‰ï¼š-zï¼Œ-jï¼Œ-Jï¼Œ-aï¼Œåˆ†åˆ«å¯¹åº”äºŽ gzipï¼Œbzip2ï¼Œxzï¼Œlzma å››ç§åŽ‹ç¼©å‘½ä»¤ã€‚ é€šç”¨é€‰é¡¹ï¼š -v ï¼šå¼€å¯æ›´è¯¦ç»†çš„è¾“å‡ºä¿¡æ¯ -f ï¼šæŒ‡å®šå½’æ¡£æ–‡ä»¶çš„ä½ç½® -w ï¼šäº¤äº’æ¨¡å¼ ä¸‰ã€æ€»ç»“ tar æ ¼å¼ï¼šæ‰“åŒ…ï¼štar -cvf Archive.tar DirNameè§£åŒ…ï¼štar -xvf Archive.tar gz æ ¼å¼ï¼šåŽ‹ç¼©ï¼šgzip FileNameè§£åŽ‹ï¼šgzip -d FileName.gz æˆ– gunzip FileName.gz tar.gz æˆ– tgz æ ¼å¼ï¼šåŽ‹ç¼©ï¼štar -czvf FileName.tar.gz DirNameè§£åŽ‹ï¼štar -xzvf FileName.tar.gz bz æˆ– bz2 æ ¼å¼ï¼šåŽ‹ç¼©ï¼šbzip2 -z FileNameè§£åŽ‹ï¼šbzip2 -d FileName.bz æˆ– bunzip2 FileName.bz tar.bz æˆ– tar.bz2 æ ¼å¼ï¼šåŽ‹ç¼©ï¼štar -cjvf FileName.tar.bz DirNameè§£åŽ‹ï¼štar -xjvf FileName.tar.bz Z æ ¼å¼ï¼šåŽ‹ç¼©ï¼šcompress FileNameè§£åŽ‹ï¼šuncompress FileName.Z tar.Z æ ¼å¼ï¼šåŽ‹ç¼©ï¼štar -cZvf FileName.tar.Z DirNameè§£åŽ‹ï¼štar -xZvf FileName.tar.Z xz æ ¼å¼ï¼šåŽ‹ç¼©ï¼šxz -z FileName.xz DirNameè§£åŽ‹ï¼šxz -d FileName.xz æˆ– unxz FileName.xz tar.xz æ ¼å¼ï¼šåŽ‹ç¼©ï¼štar -cJvf FileName.tar.xz DirNameè§£åŽ‹ï¼štar -xJvf FileName.tar.xz zip æ ¼å¼ï¼šåŽ‹ç¼©ï¼šzip FileName.zip DirNameè§£åŽ‹ï¼šunzip FileName.zip æ›´è¯¦ç»†çš„ tar å‘½ä»¤ä½¿ç”¨æ–¹æ³•å¯å‚è§ man tar]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQL Server 5.7 ä¿®æ”¹ root å¯†ç ]]></title>
    <url>%2F2018%2F03%2F09%2FMysql-change-root-password%2F</url>
    <content type="text"><![CDATA[é€šå¸¸å®‰è£… MySQL Server æ—¶ï¼Œå¦‚ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆæ¯”å¦‚ ubuntu çš„ apt-getï¼‰ï¼Œå¯åœ¨å®‰è£…è¿‡ç¨‹ä¸­è®¾ç½® MySQL çš„ root å¯†ç ã€‚è£…å¥½åŽä½¿ç”¨ mysql -u root -p å‘½ä»¤ç™»å½•å¹¶ç®¡ç†æ•°æ®åº“ã€‚è€Œä½¿ç”¨å…¶ä»–æ–¹å¼å®‰è£…çš„ MySQL æ•°æ®åº“ï¼ˆå¦‚ wamp ï¼‰é»˜è®¤è®¾ç½®äº†ç©ºçš„ root å¯†ç ã€‚å¯åœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œä¿®æ”¹ã€‚ ä¸€ã€SET PASSWORDä½¿ç”¨ç©ºå¯†ç ç™»å½• root ç”¨æˆ·å¹¶ç›´æŽ¥é‡æ–°è®¾ç½®å¯†ç 1234$ mysql -uroot -p...mysql&gt; SET PASSWORD FOR root@localhost=PASSWORD(&apos;your password&apos;);Query OK, 0 rows affected, 1 warning (0.02 sec) äºŒã€UPDATE mysqlä½¿ç”¨ç©ºå¯†ç ç™»å½• root ç”¨æˆ·å¹¶æ›´æ–° mysql æ•°æ®åº“ä¸­çš„ user è¡¨12345678$ mysql -uroot -p...mysql&gt; UPDATE mysql.user SET authentication_string=PASSWORD(&apos;your password&apos;) -&gt; WHERE user=&apos;root&apos; AND host=&apos;localhost&apos;;Query OK, 0 rows affected, 1 warning (0.00 sec)Rows matched: 1 Changed: 0 Warnings: 1mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.01 sec) ä¸‰ã€åˆ›å»ºæ•°æ®åº“å¹¶æŽˆäºˆæƒé™æœ€åŸºæœ¬çš„æ–¹æ³•ä¸ºï¼šä½¿ç”¨ root è´¦å·ç™»å½•å¹¶åˆ›å»ºæ•°æ®åº“ï¼Œå†åˆ†é…å…¶æƒé™ç»™æŸä¸ªæ™®é€šç”¨æˆ·ï¼Œå†å°†è¯¥æ•°æ®åº“ä¸ŽæŸä¸ªç½‘ç»œåº”ç”¨ç»‘å®šã€‚CREATE DATABASE db_nameGRANT privileges ON db_name.tables TO user@domains IDENTIFIED BY &#39;user_pass&#39;ALL æŒ‡ä»£è¯¥æ•°æ®åº“çš„æ‰€æœ‰æƒé™ï¼Œâ€˜%â€™ è¡¨ç¤ºå…è®¸è¯¥ç”¨æˆ·ä»Žä»»æ„ä¸»æœºç™»å½•ï¼ˆå¯ä¿®æ”¹ä¸ºæŒ‡å®š IP åœ°å€ï¼Œé»˜è®¤æ˜¯ localhostï¼‰ã€‚starky.* è¡¨ç¤ºè¯¥æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨æ ¼ é™„ï¼šubuntu 16.04 å–æ¶ˆ MySQL Server çš„é»˜è®¤è‡ªå¯åŠ¨$ sudo systemctl disable mysqlå–æ¶ˆ mysql å¼€æœºè‡ªå¯åŠ¨$ sudo systemctl start mysql å¯åŠ¨ mysql æœåŠ¡]]></content>
      <categories>
        <category>Database</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Database</tag>
        <tag>Mysql</tag>
        <tag>Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ ç¬”è®°]]></title>
    <url>%2F2018%2F02%2F25%2Flearn-regex%2F</url>
    <content type="text"><![CDATA[æ­£åˆ™è¡¨è¾¾å¼ï¼ˆregular expressionï¼‰ç”¨æ¥å®šä¹‰ä¸€ç§ æ¨¡å¼ï¼Œç›¸å…³çš„ Linux å·¥å…·ï¼ˆå¦‚ sedã€gawk ï¼‰ä»¥åŠ Perl ç­‰ç¼–ç¨‹è¯­è¨€å¯ä»¥é€šè¿‡è¯¥æ¨¡å¼å¯¹æ–‡æœ¬å†…å®¹è¿›è¡ŒåŒ¹é…ï¼Œå†è¿›è¡Œæ›¿æ¢ç­‰æ“ä½œã€‚æ­£åˆ™è¡¨è¾¾å¼å¹¶éžåªæœ‰ä¸€ç§å®žçŽ°ï¼Œåœ¨ Linux çŽ¯å¢ƒä¸­ï¼Œä¸åŒçš„åº”ç”¨ç¨‹åºå¾€å¾€ä½¿ç”¨ä¸åŒç±»åž‹çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚æœ€å¸¸è§çš„ä¸¤ç§æœ‰åŸºæœ¬æ­£åˆ™è¡¨è¾¾å¼ï¼ˆBREï¼‰å¼•æ“Žå’Œæ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆEREï¼‰å¼•æ“Žã€‚å¤§éƒ¨åˆ† Linux å·¥å…·è‡³å°‘éµå¾ª BRE å¯¹è§„åˆ™çš„å®šä¹‰ï¼Œç¼–ç¨‹è¯­è¨€å¤šä½¿ç”¨ ERE å¼•æ“Žã€‚å…¶ä¸­ gawk å°±ä½¿ç”¨äº† ERE å¼•æ“Žã€‚è¿™é‡Œåªä»‹ç»ä¸€äº›æœ€å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ æ™®é€šæ–‡æœ¬æ™®é€šå­—ç¬¦åŒ…æ‹¬æ²¡æœ‰æ˜¾å¼æŒ‡å®šä¸ºå…ƒå­—ç¬¦çš„æ‰€æœ‰å¯æ‰“å°å’Œä¸å¯æ‰“å°å­—ç¬¦ã€‚è¿™åŒ…æ‹¬æ‰€æœ‰å¤§å†™å’Œå°å†™å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·å’Œä¸€äº›å…¶ä»–ç¬¦å·ã€‚æ­£åˆ™è¡¨è¾¾å¼åœ¨åŒ¹é…æ–‡æœ¬æ—¶ï¼Œä¸ç®¡å…¶å®šä¹‰çš„æ¨¡å¼ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰å‡ºçŽ°åœ¨æ–‡æœ¬çš„ä»€ä¹ˆä½ç½®æˆ–è€…å‡ºçŽ°å‡ æ¬¡ï¼Œåªè¦æ–‡æœ¬ä¸­åŒ…å«æ­¤æ¨¡å¼ï¼Œè¯¥æ–‡æœ¬å°±ä¼šä¼ é€’ç»™ç›¸åº”çš„ Linux å·¥å…·åšè¿›ä¸€æ­¥çš„å¤„ç†ã€‚åœ¨ sed å’Œ gawk ç­‰å·¥å…·ä¸­ï¼Œæ¨¡å¼çš„å®šä¹‰åŒ…å«åœ¨ä¸¤ä¸ª â€˜ / â€˜ ä¸­ï¼Œä¸‹é¢çš„ sed -n &#39;/æ¨¡å¼/p&#39;å‘½ä»¤ç±»ä¼¼äºŽ Linux ä¸­çš„ grep ï¼Œå¯¹ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼çš„æ–‡æœ¬è¿›è¡Œæ‰“å°è¾“å‡ºã€‚123456789101112$ echo &quot;This is a test&quot; | sed -n &apos;/test/p&apos; This is a test$ echo &quot;This is a test&quot; | sed -n &apos;/trial/p&apos;$$ sed -n &apos;/ /p&apos; data1.txtThis is a normal line of text.This is a line with two spaces.This is a line with a TAB.$ sed -n &apos;/ /p&apos; data1.txtThis is a line with two spaces.$ gawk &apos;/\t/&#123;print $0&#125;&apos; data1.txtThis is a line with a TAB. ä¸Šé¢çš„ä¾‹å­ä¸­æ¶‰åŠåˆ°å¤šä¸ªç©ºæ ¼çš„åŒ¹é…ï¼ŒåŒæ—¶éžæ‰“å°å­—ç¬¦å¦‚åˆ¶è¡¨ç¬¦ï¼ˆ\tï¼‰ã€æ¢è¡Œç¬¦ï¼ˆ\nï¼‰ç­‰å®šä¹‰åœ¨ ERE ä¸­ï¼Œæ‰€ä»¥ sed å‘½ä»¤ä¸å†æ”¯æŒï¼Œä¾‹å­ä¸­ä½¿ç”¨çš„æ˜¯ gawk ã€‚ ç‰¹æ®Šå­—ç¬¦ç‰¹æ®Šå­—ç¬¦åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š.*[]^${}\+?|()ï¼Œå®ƒä»¬åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰ç€ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚ â€˜ . â€˜ åŒ¹é…ä»»ä½•å•å­—ç¬¦ã€‚è€Œå¯¹äºŽç‰¹æ®Šç¬¦å·è‡ªèº«çš„åŒ¹é…åˆ™éœ€è¦è¿›è¡Œè½¬ä¹‰ï¼ˆåœ¨è¯¥å­—ç¬¦å‰åŠ ä¸Š â€˜ \ â€˜ ï¼‰ï¼Œå³åŒ¹é… â€˜ . â€˜ éœ€ä½¿ç”¨ â€˜ \. â€˜ ã€‚ ç‰¹æ®Šå­—ç¬¦çš„æè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ç‰¹æ®Šå­—ç¬¦ æè¿° $ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½® ( ) æ ‡è®°ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚å­è¡¨è¾¾å¼å¯ä»¥èŽ·å–ä¾›ä»¥åŽä½¿ç”¨ * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ + åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ . åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ [ æ ‡è®°ä¸€ä¸ªä¸­æ‹¬å·è¡¨è¾¾å¼çš„å¼€å§‹ ? åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜Žä¸€ä¸ªéžè´ªå©ªé™å®šç¬¦ ^ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚åœ¨æ–¹æ‹¬å·ä¸­ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºä¸æŽ¥å—è¯¥å­—ç¬¦é›†åˆ { æ ‡è®°é™å®šç¬¦è¡¨è¾¾å¼çš„å¼€å§‹ ç®¡é“ç¬¦ æŒ‡æ˜Žä¸¤é¡¹ä¹‹é—´çš„ä¸€ä¸ªé€‰æ‹© 123456789$ cat data2.txtThe cost is $4.003 / 2$ sed -n &apos;/\$/p&apos; data2.txtThe cost is $4.00$ sed -n &apos;/\//p&apos; data2.txt3 / 2$ sed -n &apos;///p&apos; data2.txtsed: 1: &quot;///p&quot;: invalid command code / 1. å®šä½ç¬¦å®šä½ç¬¦ç”¨æ¥æè¿°å­—ç¬¦ä¸²æˆ–å•è¯çš„è¾¹ç•Œï¼Œ^ å’Œ $ åˆ†åˆ«æŒ‡å®šå­—ç¬¦ä¸²çš„å¼€å§‹ä¸Žç»“æŸä½ç½®ï¼Œ\b æè¿°å•è¯çš„å‰æˆ–åŽè¾¹ç•Œï¼Œ\B è¡¨ç¤ºéžå•è¯è¾¹ç•Œã€‚å½“ ^ å¹¶éžä½äºŽæ¨¡å¼å¼€å¤´æ—¶ï¼Œä»å½“æ™®é€šå­—ç¬¦çœ‹å¾…ã€‚123456789101112131415161718$ echo &quot;The book store&quot; | sed -n &apos;/^book/p&apos; $$ echo &quot;books are great&quot; | sed -n &apos;/^book/p&apos; Books are great$ echo &quot;This is a good book&quot; | sed -n &apos;/book$/p&apos;This is a good book$ echo &quot;This book is good&quot; | sed -n &apos;/book$/p&apos; $$ echo &quot;This ^ is a test&quot; | sed -n &apos;/s ^/p&apos; This ^ is a test&gt;&gt;&gt; import re&gt;&gt;&gt; re.findall(r&apos;\bbook&apos;,&apos;The book store&apos;)[&apos;book&apos;]&gt;&gt;&gt; re.findall(r&apos;\bbook&apos;,&apos;Thebook store&apos;)[]&gt;&gt;&gt; re.findall(r&apos;book\b&apos;,&apos;Thebook store&apos;)[&apos;book&apos;] \b å’Œ \B å±žäºŽ EREï¼Œä¸Šä¾‹ä¸­ä½¿ç”¨äº† Python çš„ re æ¨¡å—ï¼ˆæ³¨æ„ç©ºæ ¼å¦‚ä½•å½±å“è¾“å‡ºï¼‰ ç»„åˆå®šä½ç¬¦1234567$ cat data4this is a test of using both anchors I said this is a testthis is a testI&apos;m sure this is a test.$ sed -n &apos;/^this is a test$/p&apos; data4 this is a test è¿‡æ»¤ç©ºè¡Œ1234567$ cat data5This is one test line.This is another test line. $ sed &apos;/^$/d&apos; data5This is one test line. This is another test line. 2. â€˜ . â€˜ ç¬¦å·â€˜ . â€˜ åŒ¹é…é™¤ \n ä»¥å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€‚æ‰€ä»¥ /.at/ åŒ¹é… â€˜catâ€™ å’Œè¡Œä¸­é—´çš„ â€˜atâ€™ ï¼ˆå®žé™…ä¸º â€˜ atâ€™ ï¼‰ï¼Œå´ä¸åŒ¹é…è¡Œé¦–çš„ â€˜atâ€™ ã€‚123456&gt;&gt;&gt; print(text)The cat is sleeping.This test is at line two.at ten o&apos;clock we&apos;ll go home.&gt;&gt;&gt; re.findall(&apos;.at&apos;,text)[&apos;cat&apos;, &apos; at&apos;] 3. å­—ç¬¦é›†åˆåŒ…è£¹åœ¨ä¸€å¯¹ä¸­æ‹¬å·å†…çš„å¤šä¸ªå­—ç¬¦å’Œæ•°å­—æž„æˆä¸€ä¸ªå­—ç¬¦é›†åˆï¼Œç”¨æ¥é™åˆ¶è¯¥ä½ç½®åªåŒ¹é…é›†åˆä¸­å‡ºçŽ°çš„å­—ç¬¦ã€‚å¦‚ /[AaEeIiOoUu]/ å¯ä»¥åŒ¹é…æ‰€æœ‰å…ƒéŸ³å­—æ¯1234$ echo &quot;Yes&quot; | sed -n &apos;/[Yy]es/p&apos; Yes$ echo &quot;yes&quot; | sed -n &apos;/[Yy]es/p&apos; yes å­—ç¬¦èŒƒå›´ç”¨è¿žå­—å·å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦çš„èŒƒå›´ æ¨¡å¼ å«ä¹‰ [a-z] åŒ¹é…æ‰€æœ‰çš„å°å†™å­—æ¯ [A-Z] åŒ¹é…æ‰€æœ‰çš„å¤§å†™å­—æ¯ [a-zA-Z] åŒ¹é…æ‰€æœ‰çš„å­—æ¯ [0-9] åŒ¹é…æ‰€æœ‰çš„æ•°å­— [0-9\.\-] åŒ¹é…æ‰€æœ‰çš„æ•°å­—ã€å°æ•°ç‚¹å’Œè¿žå­—ç¬¦ å½“åœ¨ä¸€ç»„æ–¹æ‹¬å·é‡Œä½¿ç”¨ ^ æ—¶ï¼Œå®ƒè¡¨ç¤ºâ€éžâ€æˆ–â€æŽ’é™¤â€çš„æ„æ€ï¼Œå¸¸å¸¸ç”¨æ¥å‰”é™¤æŸä¸ªå­—ç¬¦ã€‚å¦‚ [^a-z] åŒ¹é…é™¤äº†å°å†™å­—æ¯ä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦é›†åˆã€‚ æ¨¡å¼ å«ä¹‰ [[:alpha:]] åŒ¹é…æ‰€æœ‰å­—æ¯ [[:digit:]] åŒ¹é…æ‰€æœ‰æ•°å­— [[:alnum:]] åŒ¹é…æ‰€æœ‰å­—æ¯å’Œæ•°å­— [[:blank:]] åŒ¹é…æ‰€æœ‰ç©ºæ ¼å’Œ Tab å­—ç¬¦ [[:space:]] åŒ¹é…æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼šSpace, Tab, NL, FF, VT, CR [[:upper:]] åŒ¹é…æ‰€æœ‰å¤§å†™å­—æ¯ [[:lower:]] åŒ¹é…æ‰€æœ‰å°å†™å­—æ¯ [[:print:]] åŒ¹é…æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ [[:punct:]] åŒ¹é…æ‰€æœ‰æ ‡ç‚¹ç¬¦å· [[:xdigit:]] åŒ¹é…æ‰€æœ‰16è¿›åˆ¶çš„æ•°å­—ï¼Œç›¸å½“äºŽ[0-9a-fA-F] 4. â€˜ * â€˜ ç¬¦å·â€˜ * â€˜ è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡12345678$ echo &quot;ik&quot; | sed -n &apos;/ie*k/p&apos; ik$ echo &quot;iek&quot; | sed -n &apos;/ie*k/p&apos; iek$ echo &quot;ieek&quot; | sed -n &apos;/ie*k/p&apos; ieek$ echo &quot;ieeek&quot; | sed -n &apos;/ie*k/p&apos; ieeek â€˜ * â€˜ å·è¿˜å¯ä»¥åº”ç”¨åœ¨å­—ç¬¦é›†åˆä¸Š12345678910$ echo &quot;bt&quot; | sed -n &apos;/b[ae]*t/p&apos; bt$ echo &quot;bat&quot; | sed -n &apos;/b[ae]*t/p&apos; bat$ echo &quot;bet&quot; | sed -n &apos;/b[ae]*t/p&apos; bet$ echo &quot;baaeeaeeat&quot; | sed -n &apos;/b[ae]*t/p&apos; baaeeaeeat$ echo &quot;baakeeet&quot; | sed -n &apos;/b[ae]*t/p&apos; $ 5. â€˜ ? â€˜ å’Œ â€˜ + â€˜ ç¬¦å·â€˜ ? â€˜ è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡123456$ echo &quot;bt&quot; | gawk &apos;/be?t/&#123;print $0&#125;&apos; bt$ echo &quot;bet&quot; | gawk &apos;/be?t/&#123;print $0&#125;&apos; bet$ echo &quot;beet&quot; | gawk &apos;/be?t/&#123;print $0&#125;&apos; $ â€˜ + â€˜ è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡123456$ echo &quot;beet&quot; | gawk &apos;/be+t/&#123;print $0&#125;&apos; beet$ echo &quot;bet&quot; | gawk &apos;/be+t/&#123;print $0&#125;&apos; bet$ echo &quot;bt&quot; | gawk &apos;/be+t/&#123;print $0&#125;&apos; $ 6. é™å®šç¬¦é™å®šç¬¦ç”¨æ¥æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªç»™å®šç»„ä»¶å¿…é¡»è¦å‡ºçŽ°å¤šå°‘æ¬¡æ‰èƒ½æ»¡è¶³åŒ¹é…ã€‚æœ‰ æˆ– + æˆ– ? æˆ– {n} æˆ– {n,} æˆ– {n,m} å…±6ç§ã€‚å‰ä¸‰ç§å‰é¢å·²ç»è®²åˆ°ï¼Œé™¤ å¤–å…¶ä»–5ç§éƒ½å±žäºŽ ERE ã€‚ æ¨¡å¼ å«ä¹‰ {n} n æ˜¯ä¸€ä¸ªéžè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œ/o{2}/ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª â€˜oâ€™ã€‚ {n,} n æ˜¯ä¸€ä¸ªéžè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œ/o{2,}/ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ â€˜oâ€™ã€‚/o{1,}/ ç­‰ä»·äºŽ /o+/ ã€‚/o{0,}/ åˆ™ç­‰ä»·äºŽ /o*/ ã€‚ {n,m} m å’Œ n å‡ä¸ºéžè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ n &lt;= m ã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œ/o{1,3}/ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª â€˜oâ€™ ã€‚/o{0,1}/ ç­‰ä»·äºŽ /o?/ ã€‚ 12345678$ echo &quot;bt&quot; | gawk --re-interval &apos;/be&#123;1,2&#125;t/&#123;print $0&#125;&apos; $$ echo &quot;bet&quot; | gawk --re-interval &apos;/be&#123;1,2&#125;t/&#123;print $0&#125;&apos; bet$ echo &quot;beet&quot; | gawk --re-interval &apos;/be&#123;1,2&#125;t/&#123;print $0&#125;&apos; beet$ echo &quot;beeet&quot; | gawk --re-interval &apos;/be&#123;1,2&#125;t/&#123;print $0&#125;&apos; $ /[ae]{1,2}/ åŒ¹é… â€˜aâ€™ , â€˜eâ€™ , â€˜aaâ€™ , â€˜aeâ€™ , â€˜eeâ€™ ã€‚ * å’Œ + é™å®šç¬¦éƒ½æ˜¯è´ªå©ªçš„ï¼Œå› ä¸ºå®ƒä»¬ä¼šå°½å¯èƒ½å¤šçš„åŒ¹é…æ–‡å­—ï¼Œåªæœ‰åœ¨å®ƒä»¬çš„åŽé¢åŠ ä¸Šä¸€ä¸ª ? å°±å¯ä»¥å®žçŽ°éžè´ªå©ªæˆ–æœ€å°åŒ¹é…ã€‚å¦‚åŒ¹é… HTML æ–‡æ¡£é‡Œçš„æ ‡ç­¾ï¼š12345&gt;&gt;&gt; text=&quot;&lt;h1&gt;Head Line&lt;/h1&gt;&quot;&gt;&gt;&gt; re.findall(r&apos;&lt;.*&gt;&apos;,text)[&apos;&lt;h1&gt;Head Line&lt;/h1&gt;&apos;]&gt;&gt;&gt; re.findall(r&apos;&lt;.*?&gt;&apos;,text)[&apos;&lt;h1&gt;&apos;, &apos;&lt;/h1&gt;&apos;] 7. â€˜ | â€˜ ç¬¦å·ç®¡é“ï¼ˆâ€™ | â€˜ï¼‰ç¬¦å·ç”¨æ¥å®šä¹‰ä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡å¼ï¼Œä¸”å½¼æ­¤ä¹‹é—´æ˜¯é€»è¾‘æˆ–çš„å…³ç³»ã€‚123456$ echo &quot;The cat is asleep&quot; | gawk &apos;/cat|dog/&#123;print $0&#125;&apos; The cat is asleep$ echo &quot;The dog is asleep&quot; | gawk &apos;/cat|dog/&#123;print $0&#125;&apos; The dog is asleep$ echo &quot;He has a hat.&quot; | gawk &apos;/[ch]at|dog/&#123;print $0&#125;&apos; He has a hat. 8. åˆ†ç»„å°æ‹¬å·ç”¨äºŽå°†æ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼è¿›è¡Œåˆ†ç»„1234$ echo &quot;Sat&quot; | gawk &apos;/Sat(urday)?/&#123;print $0&#125;&apos;Sat$ echo &quot;Saturday&quot; | gawk &apos;/Sat(urday)?/&#123;print $0&#125;&apos; Saturday ä¸Šä¾‹ä¸­çš„ /Sat(urday)?/ ç”¨äºŽåŒ¹é… â€˜Satâ€™ æˆ–è€… â€˜Saturdayâ€™ ï¼Œâ€™urdayâ€™ åŠ ä¸Šå°æ‹¬å·åŽè¢«å½“æˆä¸€ä¸ªæ•´ä½“ï¼Œå†é™„ä¸Š ? ç¬¦å·è¡¨ç¤ºè¯¥ç»„åˆå‡ºçŽ°é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ é™„å½•ï¼šè¿ç®—ç¬¦ä¼˜å…ˆçº§ è¿ç®—ç¬¦ï¼ˆç”±é«˜åˆ°ä½Žï¼‰ æè¿° åæ–œæ ï¼ˆ\ï¼‰ è½¬ä¹‰ç¬¦ (), (?:), (?=), [] åœ†æ‹¬å·å’Œæ–¹æ‹¬å· *, +, ?, {n}, {n,}, {n,m} é™å®šç¬¦ ^, $, ä»»ä½•å…ƒå­—ç¬¦ã€ä»»ä½•å­—ç¬¦ å®šä½ç‚¹å’Œåºåˆ—ï¼ˆå³ï¼šä½ç½®å’Œé¡ºåºï¼‰ æ›¿æ¢è¿ç®—ç¬¦ï¼ˆç®¡é“ç¬¦ï¼‰ æ›¿æ¢ï¼Œâ€æˆ–â€æ“ä½œ å­—ç¬¦å…·æœ‰é«˜äºŽæ›¿æ¢è¿ç®—ç¬¦ï¼ˆ|ï¼‰çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾— /m|food/ åŒ¹é… â€˜mâ€™ æˆ– â€˜foodâ€™ ã€‚è‹¥è¦åŒ¹é… â€˜moodâ€™ æˆ– â€˜foodâ€™ ï¼Œå¯ä½¿ç”¨æ‹¬å·åˆ›å»ºå­è¡¨è¾¾å¼ï¼š/(m|f)ood/ ã€‚ å‚è€ƒèµ„æ–™ï¼šLinux Command Line and Shell Scripting Bible 3rd Editionæ­£åˆ™è¡¨è¾¾å¼-èœé¸Ÿæ•™ç¨‹]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
        <tag>Programming</tag>
        <tag>regex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼ˆnvmã€virtualenv(wrapper)-å’Œ-rbenv-çš„å®‰è£…ä¸Žä½¿ç”¨ï¼‰]]></title>
    <url>%2F2018%2F02%2F02%2Fnvm-virtualenv-rbenv%2F</url>
    <content type="text"><![CDATA[æˆ‘æ˜¯ä¸ªæ‡’æƒ°çš„äººï¼Œå¯¹äºŽç¼–ç¨‹ç€å®žæ‡‚å¾—ä¸å¤šï¼Œèƒ½cloneä¸‹æ¥çš„ç»å¯¹ä¸è‡ªå·±å†™ã€‚ã€‚ã€‚ä½†æ˜¯åƒ nodejs å’Œ Python è¿™ä¿©å“¥ä»¬ï¼Œæœ¬æ¥ç‰ˆæœ¬å°±ä¸å°‘ï¼Œå†åŠ ä¸Šä¼—å¤šçš„è½¯ä»¶åŒ…ä¾èµ–ï¼Œå¸¸å¸¸cloneä¸‹æ¥äº†è¿è¡Œè¿˜æŠ¥é”™ã€‚å¯æƒ³è€ŒçŸ¥ï¼Œé…ç½®å¥½ç›¸äº’ç‹¬ç«‹çš„è¿è¡ŒçŽ¯å¢ƒï¼ˆé¿å…è½¯ä»¶åŒ…ç‰ˆæœ¬å†²çªï¼‰æ˜¯å¤šä¹ˆå¿…è¦çš„ä¸€ä»¶äº‹ã€‚ ä¸€ã€ nvmnvm æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ Node ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚Windowsç³»ç»Ÿä¸‹å¯å®‰è£… nvm-windowsï¼Œæœ‰ç¼–è¯‘å¥½çš„exeå®‰è£…åŒ…æ–‡ä»¶æä¾›ä¸‹è½½ï¼Œå®‰è£…å¥½åŽå¯ä»¥ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨ã€‚ Linux å’Œ Mac å¯ä»¥ä½¿ç”¨ç½‘ç«™ä¸Šæä¾›çš„å®‰è£…è„šæœ¬ï¼šä½¿ç”¨cURLï¼šcurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh | bashä½¿ç”¨wgetï¼šwget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh | bash å¦‚å®‰è£…å‡ºçŽ°é—®é¢˜ï¼Œè¯·ç¡®ä¿ä»¥ä¸‹å†…å®¹12export NVM_DIR=&quot;$HOME/.nvm&quot;[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot; å·²æ·»åŠ åˆ°ä½ çš„å‘½ä»¤è¡Œé…ç½®æ–‡ä»¶ï¼ˆ~/.bash_profile, ~/.zshrc, ~/.profile, æˆ– ~/.bashrcï¼‰ä¸­ã€‚å…·ä½“å¯å‚è€ƒ nvm çš„READMEã€‚ ä½¿ç”¨æŠ€å·§ nvm --help èŽ·å–è¯¥å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ nvm install [-s] &lt;version&gt; ä¸‹è½½å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Nodeï¼Œ[-s] è¡¨ç¤ºä»Žæºç å®‰è£…å¦‚ï¼šnvm install 8.9 å®‰è£…æœ€æ–°8.9.xç¨³å®šç‰ˆæœ¬çš„Nodejs nvm ls-remote æŸ¥çœ‹å¯ä¾›ä¸‹è½½å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬ nvm use &lt;version&gt; ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ Nodeï¼ˆå³åˆ‡æ¢å½“å‰è¿è¡ŒçŽ¯å¢ƒä¸ºè¯¥ç‰ˆæœ¬çš„ Nodeï¼‰ nvm run &lt;version&gt; [&lt;args&gt;] è¿è¡ŒæŒ‡å®šç‰ˆæœ¬çš„ Node ç¨‹åºå¦‚ï¼šnvm run 8.9.4 app.js ç”¨ 8.9.4 ç‰ˆæœ¬çš„ nodejs æ‰§è¡Œ app.js nvm which &lt;version&gt; èŽ·å–è¯¥ç‰ˆæœ¬Nodeå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ nvm ls åˆ—å‡ºå·²å®‰è£…çš„ç‰ˆæœ¬ nvm alias default &lt;version&gt; è®¾ç½®è¿›å…¥ä»»ä½•æ–°ç»ˆç«¯æ—¶çš„é»˜è®¤ Node ç‰ˆæœ¬ nvm current æŸ¥çœ‹å½“å‰é…ç½®ä¸‹çš„ Node ç‰ˆæœ¬ PSï¼š export NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/mirrors/node ç”¨äºŽå°†å®‰è£…æºæ”¹ä¸ºå›½å†…é•œåƒ äºŒã€virtualenv å’Œ virtualenvwrapper1.virtualenvvirtualenv æ˜¯ç”¨æ¥åˆ›å»ºç‹¬ç«‹çš„ Python è¿è¡ŒçŽ¯å¢ƒçš„å·¥å…·ã€‚å¯ä»¥ç›´æŽ¥é€šè¿‡ Python çš„ pip å‘½ä»¤å®‰è£…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç³»ç»Ÿçš„è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ Ubuntu çš„ apt-getï¼‰ã€‚ å®‰è£…ï¼š[sudo] pip install virtualenv åŠ ä¸Š sudo è¡¨ç¤ºå…¨å±€å®‰è£…åŸºæœ¬ç”¨æ³•ï¼švirtualenv -p PYTHON_EXE DEST_DIR -p PYTHON_EXE æŒ‡å®šåˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒæ—¶ä½¿ç”¨çš„ Python å¯æ‰§è¡Œç¨‹åºçš„è·¯å¾„ï¼Œé»˜è®¤æ˜¯ç”¨æ¥å®‰è£… virtualenv çš„ Pythonã€‚ DEST_DIR è¡¨ç¤ºå°†è™šæ‹ŸçŽ¯å¢ƒå®‰è£…è‡³ç›®æ ‡æ–‡ä»¶å¤¹ å¦‚ï¼švirtualenv -p python3 webè¡¨ç¤ºä½¿ç”¨ç³»ç»Ÿ PATH å˜é‡æŒ‡å®šçš„ Python3 ç¨‹åºï¼Œå°†è™šæ‹ŸçŽ¯å¢ƒå®‰è£…è‡³å½“å‰ç›®å½•ä¸‹çš„ web ç›®å½•ã€‚source web/bin/activateå‘½ä»¤ç”¨äºŽæ¿€æ´»æ­¤è™šæ‹ŸçŽ¯å¢ƒï¼ˆWindowsç³»ç»Ÿæ­¤å‘½ä»¤ä¸ºï¼šweb\Scripts\activateï¼‰ã€‚å¾…æ“ä½œå®Œæˆéœ€è¦é€€å‡ºæ—¶ï¼Œè¾“å…¥deactivateå³å¯ã€‚ 2.virtualenvwrappervirtualenvwrapper æ˜¯é’ˆå¯¹ virtualenv çš„ä¸€ç»„æ‰©å±•å·¥å…·ã€‚Windows ç³»ç»ŸçŽ¯å¢ƒä¸‹å¯å®‰è£… virtualenvwrapper-win ã€‚å®‰è£…ï¼šLinux or Macï¼špip install virtualenvwrapperWindowsï¼špip install virtualenvwrapper-win å®ŒæˆåŽå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°å‘½ä»¤è¡Œé…ç½®æ–‡ä»¶ä¸­123export WORKON_HOME=$HOME/.virtualenvsexport PROJECT_HOME=$HOME/Develsource /usr/local/bin/virtualenvwrapper.sh WORKON_HOME å®šä¹‰äº†åœ¨ä»€ä¹ˆä½ç½®åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒPROJECT_HOME å®šä¹‰äº†åœ¨ä»€ä¹ˆä½ç½®åˆ›å»º Python ä»£ç é¡¹ç›® PSï¼šå¦‚æžœå®‰è£… virtualenvwrapper æ—¶ä½¿ç”¨çš„ python å¹¶éž PATH çŽ¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„é»˜è®¤å€¼ï¼Œå¯ä»¥é¢å¤–æ·»åŠ ä¸€è¡Œexport VIRTUALENVWRAPPER_PYTHON = &lt;PYTHON_EXE&gt; ä½¿ç”¨æŠ€å·§ mkvirtualenv ï¼šåœ¨ WORKON_HOME å®šä¹‰çš„è·¯å¾„ä¸‹åˆ›å»ºæ–°çš„è¿è¡ŒçŽ¯å¢ƒè¯­æ³•ï¼šmkvirtualenv [-a project_path] [-i package] [-r requirements_file] [virtualenv options] ENVNAMEä¾‹ï¼šmkvirtualenv -i flask -p /usr/local/bin/python3 env_flask rmvirtualenv ï¼šåˆ é™¤ WORKON_HOME é‡Œå·²å®‰è£…çš„æŸä¸ªè¿è¡ŒçŽ¯å¢ƒè¯­æ³•ï¼šrmvirtualenv ENVNAME workon :åˆ—å‡ºæˆ–åˆ‡æ¢è™šæ‹Ÿè¿è¡ŒçŽ¯å¢ƒ mkproject ï¼šåœ¨ WORK_ON ç›®å½•é‡Œåˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒçš„åŒæ—¶åœ¨ PROJECT_HOME ç›®å½•ä¸‹åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹å…¶ä»–å‘½ä»¤åŠç”¨æ³•å¯å‚è€ƒ virtualenvwrapper æ–‡æ¡£ ä¸‰ã€rbenvrbenv æ˜¯ ruby è¯­è¨€çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚MacOS ç³»ç»Ÿå¯ç›´æŽ¥ä½¿ç”¨ brew å‘½ä»¤å®‰è£…ï¼šbrew install rbenv Linuxç³»ç»Ÿå¯ä½¿ç”¨ git å‘½ä»¤æ‰‹åŠ¨å®‰è£…ã€‚åœ¨å‘½ä»¤è¡Œç•Œé¢ä¾æ­¤è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š1234$ git clone https://github.com/rbenv/rbenv.git ~/.rbenv$ echo &apos;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&apos; &gt;&gt; ~/.bashrc$ echo &apos;eval &quot;$(rbenv init -)&quot;&apos; &gt;&gt; ~/.bashrc$ source ~/.bashrc ä»¥ä¸Šå‘½ä»¤å°† rbenv çš„é¡¹ç›®æ–‡ä»¶ clone åˆ°æœ¬åœ°åŒæ—¶æ›´æ–° PATH çŽ¯å¢ƒå˜é‡ã€‚ä¹‹åŽè¾“å…¥ å¦‚æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å’Œå¸®åŠ©å†…å®¹ï¼Œåˆ™å®‰è£…æˆåŠŸã€‚123æ­¤æ—¶çš„ rbenv å‘½ä»¤æ˜¯æ²¡æœ‰ install é€‰é¡¹çš„ï¼Œå¦‚éœ€è¦ä½¿ç”¨ rbenv install å‘½ä»¤ä¸‹è½½å¹¶ç¼–è¯‘å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„ rubyï¼Œéœ€è¦å†å®‰è£…ç”¨æ¥ç¼–è¯‘ Ruby æºä»£ç çš„å·¥å…· [ruby-build](https://github.com/rbenv/ruby-build) ã€‚å› ä¸ºæ˜¯ç¼–è¯‘å®‰è£… rubyï¼Œéœ€è¦å…ˆå®‰è£…å¥½ç¼–è¯‘ç”¨åˆ°çš„ä¾èµ–åº“ï¼Œç„¶åŽå°† ruby-build é¡¹ç›®æ–‡ä»¶ clone åˆ°æœ¬åœ°å³å¯ï¼š $ sudo apt-get install autoconf bison build-essential libssl-dev libyaml-dev libreadline6 libreadline6-dev zlib1g zlib1g-dev$ git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build` å‘½ä»¤ç®€ä»‹ rbenv install -l åˆ—å‡ºæ‰€æœ‰å¯ä¾›å®‰è£…çš„ ruby ç‰ˆæœ¬ rbenv install &lt;version&gt; ç¼–è¯‘å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ ruby rbenv versions æŸ¥çœ‹å·²å®‰è£…çš„æ‰€æœ‰ ruby ç‰ˆæœ¬ rbenv global &lt;version&gt; è®¾ç½®å…¨å±€ç‰ˆæœ¬ rbenv local &lt;version&gt; è®¾ç½®æœ¬åœ°ç‰ˆæœ¬ï¼ˆé’ˆå¯¹ç‰¹å®šçš„é¡¹ç›®ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º .rbenv-version æ–‡ä»¶è¦†ç›–å…¨å±€ç‰ˆæœ¬é…ç½®ï¼‰ rbenv shell &lt;version&gt; è®¾ç½®å½“å‰ç»ˆç«¯ç‰ˆæœ¬ã€‚ä¼˜å…ˆçº§æœ€é«˜ã€‚ å‚è€ƒæ–‡ç« ï¼šHow To Install Ruby on Rails with rbenv on Ubuntu 16.04]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Python</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cURL-åŸºæœ¬ä½¿ç”¨æ–¹æ³•ä»‹ç»]]></title>
    <url>%2F2018%2F01%2F11%2FcURL-Manual%2F</url>
    <content type="text"><![CDATA[cURLæ˜¯ä¸€ä¸ªåˆ©ç”¨URLè¯­æ³•åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ˜¯ç»¼åˆä¼ è¾“å·¥å…·ã€‚å…¶æºä»£ç å¯åœ¨ Github ä¸Šé˜…è¯»å’ŒèŽ·å–ï¼ˆåŒ…æ‹¬libcurlï¼‰ï¼Œè¿™é‡Œåªç®€å•åœ°ä»‹ç»ä¸‹å¸¸è§çš„ä½¿ç”¨æ–¹æ³•ã€‚ ä¸€ã€èŽ·å–æ–‡ä»¶è¯­æ³•ï¼šcurl -option URLä¸åŠ ä»»ä½•é€‰é¡¹æ—¶ï¼Œé»˜è®¤å°†ç»“æžœæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰-o filename é€‰é¡¹ï¼šå°†èŽ·å–åˆ°çš„å†…å®¹ä»¥æŒ‡å®šæ–‡ä»¶åï¼ˆfilenameï¼‰ä¿å­˜è‡³æœ¬åœ°-O é€‰é¡¹ï¼šä½¿ç”¨URLä¸­çš„æ–‡ä»¶åå°†å…¶ä¿å­˜è‡³æœ¬åœ°â€“progress é€‰é¡¹è¡¨ç¤ºä»…ç”¨ã€Ž#ã€å’Œç™¾åˆ†æ¯”è¡¨ç¤ºä¸‹è½½è¿›åº¦ï¼Œè‹¥ä¸‹è½½ä¸­æ–­ï¼Œå¯ä»¥æ·»åŠ -C - é€‰é¡¹æ–­ç‚¹ç»­ä¼ â€“limit-rate é€‰é¡¹å¯¹ä¸‹è½½æ–‡ä»¶æ—¶çš„é€Ÿåº¦è¿›è¡Œé™åˆ¶ äºŒã€èŽ·å–å“åº”å¤´ä¿¡æ¯-i é€‰é¡¹ï¼šè¾“å‡ºæ—¶å“åº”å¤´å’Œæ–‡æ¡£å†…å®¹éƒ½æ˜¾ç¤º-I é€‰é¡¹ï¼šåªæ˜¾ç¤ºå“åº”å¤´ä¿¡æ¯ä¸æ˜¾ç¤ºæ–‡æ¡£å†…å®¹ å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ cURL ä¸ä¼šå‘é€ HTTP Location headersï¼ˆé‡å®šå‘ï¼‰ï¼Œå³é‡åˆ°éœ€è¦è·³è½¬çš„ç½‘é¡µä¸è‡ªåŠ¨è·³è½¬ã€‚curl www.jianshu.comä¼šå¾—åˆ° ã€Ž301 Moved Permanentlyã€ï¼Œè€Œä¸ä¼šè·³è½¬è‡³ https://www.jianshu.comã€‚ å¯ä»¥é€šè¿‡æ·»åŠ  -L é€‰é¡¹è¿›è¡Œé‡å®šå‘ã€‚ï¼ˆå›¾ä¸­çš„ -s é€‰é¡¹è¡¨ç¤ºé™é»˜æ¨¡å¼ï¼‰ ä¸‰ã€è‡ªå®šä¹‰User-AgentUser-Agent æ˜¯æµè§ˆå™¨çš„èº«ä»½æ ‡è¯†ï¼Œè¿œç¨‹æœåŠ¡å™¨é€šè¿‡å®ƒå¯ä»¥èŽ·å–å®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨ç‰ˆæœ¬ç­‰ä¿¡æ¯ã€‚ï¼ˆå†™è¿‡çˆ¬è™«çš„éƒ½çŸ¥é“â€¦â€¦ï¼‰-A é€‰é¡¹å¯ä»¥è‡ªå®šä¹‰ User-Agent ä¿¡æ¯ï¼Œé»˜è®¤æ˜¯ curl/ç‰ˆæœ¬å·è®¿é—®ä¸Šå›¾ä¸­çš„ç½‘ç«™æ—¶ä¼šè¿”å›žæµè§ˆè€…çš„ User-Agent ä¿¡æ¯â€“header é€‰é¡¹å¯ä»¥è‡ªå®šä¹‰å…¶ä»–è¯·æ±‚å¤´ä¿¡æ¯å¦‚curl --header &quot;Content-Type:application/json&quot; URL å…³äºŽHTTPæ¶ˆæ¯å¤´ï¼ˆåŒ…æ‹¬è¯·æ±‚å¤´å’Œå“åº”å¤´ï¼‰çš„ç®€ä»‹ï¼Œå¯å‚è€ƒè¿™ç¯‡æ–‡ç« https://itbilu.com/other/relate/EJ3fKUwUx.html å››ã€cookieä¿¡æ¯Cookie æ˜¯è®¿é—®çš„è¿œç¨‹ç«™ç‚¹å­˜å‚¨åœ¨å®¢æˆ·ç«¯è®¡ç®—æœºä¸Šçš„ä¸€æ®µä¿¡æ¯ï¼Œé€šå¸¸å‚¨å­˜ç€ç”¨æˆ·å¯¹æŸä¸ªç«™ç‚¹çš„è®¾ç½®ï¼Œæ¯”å¦‚åå¥½çš„è¯­è¨€æˆ–åœ°ç†ä½ç½®ï¼Œä¹ŸåŒ…æ‹¬ä¸ªäººèº«ä»½è¯†åˆ«ä¿¡æ¯ã€‚â€“cookie é€‰é¡¹å¯ä»¥é™„åŠ ä¸Š cookie ä¿¡æ¯-c cookie-file å¯ä»¥ä¿å­˜æœåŠ¡å™¨è¿”å›žçš„ cookie åˆ°æ–‡ä»¶-b cookie-file å¯ä»¥ä½¿ç”¨è¯¥æ–‡ä»¶ä½œä¸º cookie ä¿¡æ¯ äº”ã€HTTPåŠ¨è¯é»˜è®¤æ— é€‰é¡¹çš„ curl å‘½ä»¤å³ä½¿ç”¨äº† GETï¼ˆèŽ·å–ï¼‰ åŠ¨è¯ï¼Œå¦å¤–è¿˜æœ‰ POSTï¼ˆæ–°å»ºï¼‰ï¼ŒPUTï¼ˆæ›´æ–°ï¼‰ï¼ŒDELETEï¼ˆåˆ é™¤ï¼‰ç­‰æ–¹æ³•ã€‚é€šè¿‡è¿™äº›åŠ¨è¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¿é—® Restful æž¶æž„çš„ APIã€‚å‘½ä»¤æ ¼å¼ä¸ºï¼šcurl -d data -X method URL-d é€‰é¡¹æŒ‡å®šè¦ä¼ è¾“çš„æ•°æ®ï¼Œ-X é€‰é¡¹æŒ‡å®šä½¿ç”¨çš„æ–¹æ³•ã€‚åªé™„åŠ  -d é€‰é¡¹åˆ™é»˜è®¤ä½¿ç”¨ POST æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡æ­¤å‘½ä»¤å®Œæˆç®€å•çš„è¡¨å•éªŒè¯æ“ä½œ é™„å½•ï¼šå‚è€ƒæ–‡ç« ï¼šUsing curl to automate HTTP jobs]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
        <tag>Networking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nmap-ç½‘ç»œæ‰«æå®žæˆ˜ï¼ˆ2ï¼‰--ç«¯å£æ‰«æ]]></title>
    <url>%2F2017%2F11%2F29%2Fscan-network-using-Nmap-2%2F</url>
    <content type="text"><![CDATA[å¼€æ”¾çš„ç«¯å£æ„å‘³ç€è¿œç¨‹ä¸»æœºä¸Šæ­£åœ¨è¿è¡Œç€è”ç½‘çš„æœåŠ¡ï¼Œè€ŒæŸäº›éš¾ä»¥å¯Ÿè§‰çš„ç¼–ç¨‹é”™è¯¯æˆ–å®žçŽ°ç¼ºé™·ä¼šä½¿è¿™äº›æœåŠ¡å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œæœ‰æ—¶ç”šè‡³æˆä¸ºä¾µå…¥æ•´ä¸ªç³»ç»Ÿçš„çªç ´å£ã€‚è¿™äº›ç½‘ç»œæœåŠ¡å¾€å¾€ä½¿ç”¨ TCP æˆ– UDP ä½œä¸ºä¼ è¾“åè®®ã€‚TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯ä¸€ç§è¿žæŽ¥å¯¼å‘çš„åè®®ï¼Œç›¸å¯¹æ›´å¸¸ç”¨ã€‚è€Œ UDPï¼ˆUser Datagram Protocolï¼‰æ˜¯ä¸€ç§éžè¿žæŽ¥å¯¼å‘çš„åè®®ï¼Œå¤šç”¨äºŽå¯¹ä¼ è¾“é€Ÿåº¦çš„è¦æ±‚é«˜äºŽæ•°æ®å®Œæ•´æ€§çš„æœåŠ¡ã€‚è€Œé€šè¿‡æ£€æµ‹ç«¯å£åŠæœåŠ¡æ¥å…¥ä¾µè¿œç¨‹ç³»ç»Ÿçš„æ¸—é€æµ‹è¯•æ–¹æ³•å³ä¸ºç«¯å£æ‰«æã€‚ ä¸€ã€TCP ç«¯å£æ‰«ææŠ€æœ¯1. Connect æ‰«æConnect æ‰«æå¯¹æ¯ä¸€ä¸ªç«¯å£éƒ½å°è¯•å»ºç«‹å®Œæ•´çš„ TCP è¿žæŽ¥ï¼ˆä¸‰æ­¥æ¡æ‰‹ï¼‰ï¼Œå¦‚æžœè¿žæŽ¥åˆ›å»ºæˆåŠŸï¼Œåˆ™è¯¥ç«¯å£è¢«åˆ¤å®šä¸ºå¼€æ”¾çš„ã€‚ 2. Stealth æ‰«æStealth æ‰«æä¹Ÿå¸¸è¢«ç§°ä½œ SYN æ‰«ææˆ–åŠå¼€æ”¾æ‰«æã€‚è¯¥æŠ€æœ¯å‘æ¯ä¸€ä¸ªè¢«æ‰«æçš„ç«¯å£å‘é€ä¸€ä¸ªå•ç‹¬çš„ SYN åŒ…ï¼Œå¦‚æžœæ”¶åˆ° SYN+ACK å›žå¤ï¼Œåˆ™è¯¥ç«¯å£è¢«åˆ¤å®šä¸ºå¼€æ”¾çš„ã€‚è¿™ä¹‹åŽä¸ä¼šå†éµç…§ä¸‰æ­¥æ¡æ‰‹çš„ç¨‹åºå‘ç›®æ ‡ä¸»æœºå‘é€ ACK åŒ…ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å¼€å¯å®Œæ•´çš„TCPè¿žæŽ¥ï¼Œè€Œç›®æ ‡ä¸»æœºçš„æ—¥å¿—ç³»ç»Ÿä¸€èˆ¬ä¹Ÿä¸ä¼šè®°å½•è¿™ç±»æ‰«æçš„ç—•è¿¹ã€‚ 3. Zombie æ‰«æã€Žåƒµå°¸ã€æ‰«æèƒŒåŽçš„å®žçŽ°åŽŸç†æ¯”è¾ƒè´Ÿè´£ã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç®€å•æ¥è¯´ï¼Œ å…ˆæ‰¾ä¸€ä¸ªè¿œç¨‹ç³»ç»Ÿä½œä¸ºã€Žåƒµå°¸ã€ä¸»æœºï¼Œè¯¥ä¸»æœºä¸Žç½‘ç»œä¸­çš„å…¶ä»–ä¸»æœºä¹‹é—´ä¸å­˜åœ¨æ´»è·ƒçš„ç½‘ç»œè¿žæŽ¥ã€‚ å‘ã€Žåƒµå°¸ã€ä¸»æœºå‘é€ä¸€ä¸ª SYN+ACK åŒ…å¹¶è®°å½•ä¸‹è¯¥ä¸»æœºåˆå§‹çš„ IPID å€¼ã€‚ ä¼ªè£…æˆã€Žåƒµå°¸ã€ä¸»æœºï¼ˆå°†æŠ¥æ–‡ä¸­çš„æºIPåœ°å€æ›¿æ¢ä¸ºã€Žåƒµå°¸ã€ä¸»æœºçš„ï¼‰å‘ç›®æ ‡ä¸»æœºå‘é€ä¸€ä¸ª SYN æ•°æ®åŒ…ã€‚ å¦‚æžœç›®æ ‡ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œåˆ™ç›®æ ‡ä¸»æœºä¼šå‘ã€Žåƒµå°¸ã€ä¸»æœºè¿”å›žä¸€ä¸ª SYN+ACK åŒ…ï¼Œè€Œã€Žåƒµå°¸ã€ä¸»æœºï¼ˆè§‰å¾—å¾ˆæ‡µé€¼ã€‚ã€‚ã€‚ï¼‰åˆ™è¿”å›žä¸€ä¸ª RST åŒ…å¹¶æŠŠè‡ªå·±çš„ IPID å€¼å¢žåŠ  1ã€‚å¦‚æžœç›®æ ‡ç«¯å£æ˜¯å…³é—­çš„ï¼Œåˆ™ç›®æ ‡ä¸»æœºä¼šå‘ã€Žåƒµå°¸ã€ä¸»æœºè¿”å›ž RST å“åº”ï¼Œè€Œæ”¶åˆ° RST çš„ã€Žåƒµå°¸ã€ä¸»æœºï¼ˆä¾ç„¶ä¸æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆï¼‰åˆ™ä¸åšä»»ä½•åŠ¨ä½œï¼ŒIPID å€¼ä¹Ÿä¸ä¼šå¢žåŠ ã€‚ å‘ã€Žåƒµå°¸ã€ä¸»æœºå‘é€å¦ä¸€ä¸ª SYN+ACK åŒ…ï¼Œä»Žè¿”å›žçš„ RST åŒ…ä¸­èŽ·å–æœ€ç»ˆçš„ IPID å€¼ã€‚å¦‚æžœè¯¥å€¼æ¯”ç¬¬ 2 æ­¥æ—¶å¢žåŠ äº† 1ï¼Œåˆ™ç›®æ ‡ç«¯å£æ˜¯å…³é—­çš„ã€‚å¦‚æžœæœ€ç»ˆå¢žåŠ äº† 2ï¼Œåˆ™ç›®æ ‡ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚ ä¸€ç‚¹å„¿ä¹Ÿä¸ç®€å•å“ˆã€‚ã€‚ã€‚ å‘½ä»¤ç¤ºä¾‹åœ¨ç‰¹æƒç”¨æˆ·ä¸‹æ‰§è¡Œæ—¶ï¼Œnmap é»˜è®¤é‡‡ç”¨ SYN æ‰«ææ–¹å¼ï¼ˆå³ä¸å¼€å¯å®Œæ•´çš„TCPè¿žæŽ¥ï¼‰ä»¥èŠ‚çœæ‰«ææ—¶é—´ã€‚åŒæ—¶è¿™ç§æ‰«æè¡Œä¸ºä¹Ÿä¸æ˜“è¢«ç›®æ ‡ä¸»æœºçš„æ—¥å¿—ç³»ç»Ÿè®°å½•åˆ°ã€‚è€Œæ™®é€šç”¨æˆ·ä¸å…·æœ‰ä¿®æ”¹åŽŸå§‹æ•°æ®åŒ…çš„æƒé™ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡ connectç³»ç»Ÿè°ƒç”¨ æ‰“å¼€å®Œæ•´çš„ TCP è¿žæŽ¥ä»¥å®Œæˆå¯¹è¿œç¨‹ç³»ç»Ÿçš„æ‰«æã€‚æ‰€ä»¥ä»Žæ•ˆçŽ‡å’Œå®‰å…¨çš„è§’åº¦å‡ºå‘ï¼Œåº”ä¼˜å…ˆé€‰æ‹© SYN æ‰«æè€Œéž connect æ‰«æã€‚å…·ä½“å¯å‚è€ƒ nmap å®˜æ–¹æ–‡æ¡£â€”â€”ç«¯å£æ‰«ææŠ€æœ¯12345$ sudo nmap 10.2.64.1 -p 80# ç‰¹æƒç”¨æˆ· SYN æ‰«æ$ nmap 10.2.64.1 -p 80# æ™®é€šç”¨æˆ· connect æ‰«æ ä¹Ÿå¯ä»¥æ˜¾å¼åœ°æŒ‡å®šé‡‡ç”¨å“ªç§æ‰«ææ–¹å¼ï¼Œ-sT è¡¨ç¤º connect æ‰«æï¼Œ-sS è¡¨ç¤º SYN æ‰«æã€‚-p é€‰é¡¹ç”¨æ¥æŒ‡å®šæ‰«æçš„ç«¯å£å·æˆ–ç«¯å£èŒƒå›´ï¼ˆä¸€å…±æœ‰65535ä¸ªç«¯å£å¯ä¾›æ‰«æï¼Œé»˜è®¤æ‰«æ1000ä¸ªå¸¸ç”¨çš„ç«¯å£ï¼‰ã€‚å¦‚ï¼š12$ sudo nmap 10.2.64.1 -p 21,22,80,443$ sudo nmap 10.2.64.1 -p 20-25 ä»Žä¸Šè¿°å‘½ä»¤çš„è¾“å‡ºç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯¥ä¸»æœºçš„ 22,80 ç«¯å£æ˜¯å¼€æ”¾çš„ï¼ˆå¾ˆå¯èƒ½è¿è¡Œç€sshæœåŠ¡å’ŒhttpæœåŠ¡ï¼‰ï¼Œ21 å’Œ 443 ç«¯å£æ˜¯å…³é—­çš„ã€‚ äºŒã€UDP ç«¯å£æ‰«ææŠ€æœ¯UDP æ‰«æç›¸å¯¹æ˜¾å¾—æ›´æœ‰éš¾åº¦ï¼ŒåŒæ—¶ä¹Ÿæ›´ä¹å‘³å’Œè€—æ—¶ã€‚å…¶ä¸­ä¸€ç§æ–¹å¼ä¾èµ–äºŽICMPç«¯å£ä¸å¯è¾¾å“åº”ï¼Œå³å‡è®¾æ¯ä¸€ä¸ªè¢«æ‰«æçš„ UDP ç«¯å£åœ¨ä¸å¼€æ”¾æ—¶éƒ½ä¼šå›žå¤ ICMP ç«¯å£ä¸å¯è¾¾çš„å“åº”ï¼Œè€Œæ”¶ä¸åˆ°è¯¥å“åº”æ—¶åˆ™åˆ¤å®šç«¯å£ä¸ºå¼€æ”¾çš„ã€‚ä½†æœ‰æ—¶å€™è¢«æ‰«æä¸»æœºä¸å…è®¸ç”Ÿæˆç«¯å£ä¸å¯è¾¾å“åº”ï¼Œæˆ–è¯¥å“åº”è¢«é™åˆ¶åœ¨ä¸€å®šé¢‘çŽ‡å†…ï¼Œä¹Ÿå¯èƒ½æ˜¯è¢«ä¸»æœºçš„é˜²ç«å¢™éš”ç¦»ã€‚æ­¤ç§æ–¹æ³•å°±ä¼šäº§ç”Ÿä¸å‡†ç¡®çš„ç»“æžœã€‚å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡å‘é€æœåŠ¡ç›¸å…³çš„è¯·æ±‚æ¥æŽ¢æµ‹è¿œç¨‹ä¸»æœºä¸Šå¯¹åº”çš„æœåŠ¡ã€‚æ­¤ç§æ–¹æ³•å¯ä¿¡åº¦æ›´é«˜ï¼Œä½†åŒæ—¶æ¶ˆè€—çš„æ—¶é—´ä¹Ÿæ›´å¤šã€‚open|filtered è¡¨ç¤ºè¯¥ç«¯å£å¯èƒ½æ˜¯å¼€æ”¾çš„ï¼Œä¹Ÿå¯èƒ½è¢«é˜²ç«å¢™å±è”½æŽ‰äº†ã€‚]]></content>
      <categories>
        <category>Pentest</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Security</tag>
        <tag>Networking</tag>
        <tag>Pentest</tag>
        <tag>Hacking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[grep å‘½ä»¤ä½¿ç”¨æŠ€å·§]]></title>
    <url>%2F2017%2F11%2F23%2Fgrep-Tricks%2F</url>
    <content type="text"><![CDATA[grepï¼ˆglobally search a regular expression and printï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ã€‚å¸¸å¸¸å‡ºçŽ°åœ¨ç®¡é“ç¬¦ï¼ˆ|ï¼‰èº«åŽï¼Œå¯¹å¤§æ®µçš„æ–‡æœ¬è¾“å‡ºè¿›è¡Œè¿‡æ»¤ï¼Œæ‰“å°å‡ºä¸Žç‰¹å®šæ¨¡å¼ç›¸åŒ¹é…çš„å†…å®¹ã€‚ 1. åŸºæœ¬ç”¨æ³•$ grep pattern filenameæˆ– $ cat filename | grep patternæˆ– $ grep pattern file1 file2 â€¦ï¼ˆæœç´¢å¤šä¸ªæ–‡ä»¶ï¼‰ ç¤ºä¾‹æ–‡ä»¶ï¼ˆnumbers.txtï¼‰ï¼š123456789101 1 1 1 1 12 2 2 2 2 23 3 3 3 3 34 4 4 4 4 45 5 5 5 5 5six six sixseven seven seveneight eight eightnine nine nine10 10 10 10 å‘½ä»¤è¾“å‡ºï¼š 2. -vï¼ˆæ‰“å° ä¸åŒ…å« åŒ¹é…é¡¹çš„è¡Œï¼‰å…¶ä¸­ -E é€‰é¡¹è¡¨ç¤ºå¼€å¯æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆgrep -E ç­‰åŒäºŽ egrepï¼‰æ·»åŠ ä¸Š -v é€‰é¡¹åŽè¾“å‡ºçš„æ˜¯ä¸åŒ¹é…çš„å†…å®¹ 3. -oï¼ˆåªè¾“å‡ºåŒ¹é…é¡¹è€Œä¸æ˜¯é»˜è®¤çš„æ•´è¡Œå†…å®¹ï¼‰ 4. -cï¼ˆç»Ÿè®¡åŒ…å«åŒ¹é…é¡¹çš„è¡Œæ•°ï¼‰å¦‚$ grep 1 numbers.txtè¾“å‡ºä¸º 2ï¼Œï¼ˆå³ç¬¬ä¸€è¡Œ 1 1 1 1 1 1 1 å’Œæœ€åŽä¸€è¡Œ 10 10 10 10ï¼Œè®¡ç®—çš„æ˜¯è¡Œæ•°ï¼‰ 5. -nï¼ˆæ‰“å°è¾“å‡ºæ—¶é¢å¤–æ˜¾ç¤ºè¡Œå·ï¼‰ 6. -i ï¼ˆæœç´¢æ—¶å¿½ç•¥åŒ¹é…æ¨¡å¼ä¸­çš„å¤§å°å†™ï¼‰grep é»˜è®¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼ŒåŠ  -i é€‰é¡¹å¯ä»¥åœ¨åŒ¹é…æ—¶ä¸åŒºåˆ†å¤§å°å†™ã€‚ 7. -eï¼ˆå¤šä¸ªåŒ¹é…æ¨¡å¼ï¼‰æ³¨æ„æ ¼å¼ 8. æ‰“å°åŒ¹é…æ–‡æœ¬ä¹‹å‰æˆ–ä¹‹åŽçš„å†…å®¹-A n ï¼šé¢å¤–æ‰“å°åŒ¹é…æ–‡æœ¬ä¹‹åŽnè¡Œå†…å®¹-B n ï¼šé¢å¤–æ‰“å°åŒ¹é…æ–‡æœ¬ä¹‹å‰nè¡Œå†…å®¹-C n ï¼šé¢å¤–æ‰“å°åŒ¹é…æ–‡æœ¬å‰åŽnè¡Œå†…å®¹ 9. -lï¼ˆæœç´¢å¤šä¸ªæ–‡ä»¶å¹¶æŸ¥æ‰¾åŒ¹é…æ–‡æœ¬åœ¨å“ªäº›æ–‡ä»¶ä¸­ï¼‰$ grep -l pattern file1 file2 â€¦è¯¥å‘½ä»¤çš„è¾“å‡ºä¸ºåŒ…å« pattern çš„æ–‡ä»¶ååŒæ—¶å¯ä»¥ä½¿ç”¨ -r é€‰é¡¹å¯¹ç›®å½•è¿›è¡Œé€’å½’æœç´¢$ grep -r pattern dir]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sed å‘½ä»¤è¯¦è§£]]></title>
    <url>%2F2017%2F11%2F09%2Fsed-manual%2F</url>
    <content type="text"><![CDATA[sed å³ stream editorï¼Œä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„æ–‡æœ¬è§£æžè½¬æ¢å·¥å…·ï¼Œ1973-1974å¹´æœŸé—´ç”±è´å°”å®žéªŒå®¤çš„ Lee E. McMahon å¼€å‘ï¼Œèƒ½å¤Ÿå®Œç¾Žçš„é…åˆæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ã€‚å¤„ç†æ–‡æœ¬æ—¶ï¼Œå½“å‰å¤„ç†çš„è¡Œä¼šå…ˆå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸ºæ¨¡å¼ç©ºé—´ï¼ˆpattern spaceï¼‰ï¼Œæ“ä½œå®ŒæˆåŽå†æŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æŽ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰æ”¹å˜ï¼Œé™¤éžä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚sed ä¸»è¦ç”¨æ¥è‡ªåŠ¨ç¼–è¾‘ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œç®€åŒ–å¯¹æ–‡ä»¶çš„åå¤æ“ä½œï¼Œç¼–å†™è½¬æ¢ç¨‹åºç­‰ã€‚ 1. ä½¿ç”¨ s å‘½ä»¤æ›¿æ¢åŸºæœ¬ä½¿ç”¨sed é»˜è®¤æƒ…å†µä¸‹é€šè¿‡ STDIN è¾“å…¥æµè¯»å–æ•°æ®ï¼Œå¯ä»¥åˆ©ç”¨ç®¡é“ç¬¦ï¼ˆ|ï¼‰è¿›è¡Œé‡å®šå‘ã€‚å¦‚ä¸‹ï¼š12$ echo &quot;This is a test&quot; | sed &apos;s/test/big test/&apos;This is a big test s æ›¿æ¢å‘½ä»¤çš„æ ¼å¼ä¸ºï¼šs/pattern/replacement/flags ï¼Œå¦‚ä¸‹ï¼š1234567891011$ cat test.txtThe quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.$$ sed &apos;s/dog/cat/&apos; test.txtThe quick brown fox jumps over the lazy cat.The quick brown fox jumps over the lazy cat.The quick brown fox jumps over the lazy cat.The quick brown fox jumps over the lazy cat. ä½¿ç”¨ s å‘½ä»¤è¿›è¡Œæ›¿æ¢æ—¶ï¼Œé»˜è®¤åªæ›¿æ¢æ¯è¡Œä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚å…¨å±€æ›¿æ¢éœ€å¢žåŠ  g é€‰é¡¹ã€‚12345$ sed &apos;s/o/O/g&apos; test.txtThe quick brOwn fOx jumps Over the lazy dOg.The quick brOwn fOx jumps Over the lazy dOg.The quick brOwn fOx jumps Over the lazy dOg.The quick brOwn fOx jumps Over the lazy dOg. sed é»˜è®¤åªå°†å¤„ç†åŽçš„å†…å®¹è¾“å‡ºï¼Œè€Œä¸å¯¹åŽŸæ–‡ä»¶çš„å†…å®¹åšä»»ä½•æ”¹åŠ¨ã€‚å¦‚éœ€å†™å…¥æ–‡ä»¶ï¼Œå¯ä½¿ç”¨é‡å®šå‘ï¼š$ sed &#39;s/dog/cat/&#39; test.txt &gt; test2.txtæˆ–é€šè¿‡ -i é€‰é¡¹ç›´æŽ¥ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼š$ sed -i &#39;s/dog/cat/&#39; test.txt addresså¦‚æžœéœ€è¦å°†å‘½ä»¤åº”ç”¨åˆ°ç‰¹å®šçš„ä¸€è¡Œæˆ–å¤šè¡Œå†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ line addressingã€‚æ ¼å¼ä¸º [address[,address]][!]commandã€‚address å¯ä»¥æ˜¯æ•°å­—æˆ–æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é€—å·åˆ†éš”ä¸¤ä¸ª address è¡¨ç¤ºä¸€ä¸ªåŒºé—´èŒƒå›´ã€‚å¦‚åªå°†ç¬¬2è¡Œä¸­çš„ dog æ›¿æ¢ä¸º catï¼š12345$ sed &apos;2s/dog/cat/&apos; test.txtThe quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy cat.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog. æˆ–è€…$ sed &#39;1,3s/dog/cat/&#39; test.txtï¼Œæ›¿æ¢1-3è¡Œçš„å†…å®¹ã€‚$ sed &#39;2,$s/dog/cat/&#39; test.txtï¼Œæ›¿æ¢ç¬¬2è¡Œåˆ°æœ€åŽä¸€è¡Œçš„å†…å®¹ã€‚ ! è¡¨ç¤ºå®ŒæˆåŒ¹é…åŽæ˜¯å¦åœ¨è¯¥è¡Œæ‰§è¡Œæ›¿æ¢å‘½ä»¤ã€‚åŠ ä¸Š ! è¡¨ç¤ºä¸æ‰§è¡Œã€‚å¦‚ä¸‹ï¼š1234567891011121314151617$ cat lines.txtThis is line oneThis is line twoThis is line threeThis is line four$$ sed &apos;/one/,2s/line/LINE/&apos; lines.txtThis is LINE oneThis is LINE twoThis is line threeThis is line four$$ sed &apos;/one/,2!s/line/LINE/&apos; lines.txtThis is line oneThis is line twoThis is LINE threeThis is LINE four æ›¿æ¢é€‰é¡¹sed çš„æ›¿æ¢å‘½ä»¤é™¤äº†å¯ä»¥é™„åŠ  g é€‰é¡¹ï¼ˆå…¨å±€æ›¿æ¢ï¼‰å¤–ï¼Œè¿˜æœ‰æ›´å¤šé€‰é¡¹é€‚ç”¨äºŽä¸åŒçš„æƒ…å½¢ã€‚ æ•°å­—ã€‚è¡¨ç¤ºåªæ›¿æ¢æ¯è¡Œä¸­çš„ç¬¬ n ä¸ªåŒ¹é…é¡¹ï¼Œå¦‚ï¼š12345$ sed &apos;s/o/O/2&apos; test.txtThe quick brown fOx jumps over the lazy dog.The quick brown fOx jumps over the lazy dog.The quick brown fOx jumps over the lazy dog.The quick brown fOx jumps over the lazy dog. æˆ–$ sed &#39;s/o/O/2g&#39; test.txt æ›¿æ¢æ¯è¡Œä¸­ä»Žç¬¬äºŒä¸ªå¼€å§‹çš„æ‰€æœ‰åŒ¹é…é¡¹ï¼ˆå³æ›¿æ¢æ¯è¡Œä¸­ä»Žç¬¬äºŒä¸ª o å¼€å§‹ç›´åˆ°è¯¥è¡Œè¡Œå°¾çš„æ‰€æœ‰ o å­—ç¬¦ï¼‰ pï¼Œè¡¨ç¤ºæ‰“å°å¤„ç†å‰çš„åŽŸå§‹å†…å®¹ï¼Œç»“åˆä¸Š -n é€‰é¡¹ï¼ˆä¸æ‰“å°è¾“å‡ºï¼‰åˆ™å¯ä»¥åªè¾“å‡ºå¤„ç†è¿‡çš„å†…å®¹ã€‚ 123456789$ sed &apos;s/three/3/p&apos; lines.txtThis is line oneThis is line twoThis is line 3This is line 3This is line four$$ sed -n &apos;s/three/3/p&apos; lines.txtThis is line 3 wï¼Œå°†å¤„ç†è¿‡çš„å†…å®¹å†™å…¥æ–‡ä»¶ 1234$ sed &apos;s/three/3/w line3.txt&apos; lines.txt$$ cat line3.txtThis is line 3 sed å‘½ä»¤é€‰é¡¹ åˆ é™¤ï¼šd$ sed &#39;2,$d&#39; lines.txt åˆ é™¤ lines.txt ä¸­ç¬¬2è¡Œåˆ°æœ€åŽä¸€è¡Œçš„å†…å®¹ã€‚$ sed &#39;/two/d&#39; lines.txt åˆ é™¤ lines.txt ä¸­åŒ…å« two çš„è¡Œã€‚ è¿½åŠ ï¼ˆè¡Œä¸‹ï¼‰ï¼ša 1234567$ sed &apos;/two/a\&gt; This is a line behind line 2&apos; lines.txtThis is line oneThis is line twoThis is a line behind line 2This is line threeThis is line four æ’å…¥ï¼ˆè¡Œä¸Šï¼‰ï¼ši 12$ sed &apos;2i\&gt; This is a line above line 2&apos; lines.txt åœ¨ç¬¬2è¡Œä»¥ä¸Šæ’å…¥å†…å®¹ã€‚ ä¿®æ”¹ï¼šc12$ sed &apos;/two/c\&gt; Line 2&apos; lines.txt å°†åŒ…å« two çš„è¡Œä¿®æ”¹ä¸º Line 2ï¼ˆæ•´è¡Œå†…å®¹æ›¿æ¢ä¸º Line 2ï¼‰ã€‚ å­—ç¬¦è½¬æ¢ï¼šyæ ¼å¼ä¸ºï¼š[address]y/inchars/outchars/è¾“å…¥æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«åœ¨ inchars ä¸­çš„å­—ç¬¦éƒ½å°†æ›¿æ¢ä¸º outchars ä¸­å¯¹åº”çš„å­—ç¬¦ã€‚1234567891011$ cat line_number.txtThis is line 1.This is line 2.This is line 3.This is another line 1.$$ sed &apos;y/123/456/&apos; line_number.txtThis is line 4.This is line 5.This is line 6.This is another line 4. å…¶ä»–ç”¨æ³• æ‰“å°è¾“å‡ºsed çš„ p å‘½ä»¤å¯ä»¥è¾¾åˆ°ç±»ä¼¼ grep çš„æ•ˆæžœï¼Œç»“åˆä¸Š address åŠŸèƒ½è¿˜å¯ä»¥å®Œæˆæ›´å¤æ‚çš„ç­›é€‰æ‰“å°æ“ä½œã€‚ 12345678910111213$ sed -n &apos;p&apos; lines.txtThis is line oneThis is line twoThis is line threeThis is line four$$ sed -n &apos;2,3p&apos; lines.txtThis is line twoThis is line three$$sed -n &apos;/two/,/three/p&apos; lines.txtThis is line twoThis is line three å¤šä¸ªåŒ¹é…å¯ä»¥é€šè¿‡ -e é€‰é¡¹å®žçŽ°å¤šä¸ªåŒ¹é…çš„æ›¿æ¢ 12345$ sed -e &apos;s/fox/kangaroo/;s/dog/cat/&apos; test.txtThe quick brown kangaroo jumps over the lazy cat.The quick brown kangaroo jumps over the lazy cat.The quick brown kangaroo jumps over the lazy cat.The quick brown kangaroo jumps over the lazy cat. ä¹Ÿå¯ä»¥è¿™æ ·ï¼š12345678$ sed -e &apos;&gt; s/brown/red/&gt; s/fox/kangaroo/&gt; s/dog/cat/&apos; test.txtThe quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat. ä»Žè„šæœ¬æ–‡ä»¶ä¸­è¯»å–å‘½ä»¤ 12345678910$ cat script.seds/brown/red/s/fox/kangaroo/s/dog/cat$$ sed -f script.sed test.txtThe quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat.The quick red kangaroo jumps over the lazy cat. å¯ä»¥ä½¿ç”¨ &amp; å˜é‡è¡¨ç¤ºå‰é¢çš„åŒ¹é…é¡¹ï¼Œå¦‚ï¼š 12345$ sed &apos;s/fox/&amp;es/&apos; test.txtThe quick brown foxes jumps over the lazy dog.The quick brown foxes jumps over the lazy dog.The quick brown foxes jumps over the lazy dog.The quick brown foxes jumps over the lazy dog. å‚è€ƒä¹¦ç±å’Œæ–‡ç« ï¼šLinux Command Line and Shell Scripting Bible, 3rd EditionSED ç®€æ˜Žæ•™ç¨‹ by é™ˆçš“Linux å‘½ä»¤å¤§å…¨ / SED å‘½ä»¤]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux-ç³»ç»Ÿç®¡ç†ï¼ˆ1ï¼‰----èŽ·å–ç¡¬ä»¶ä¿¡æ¯]]></title>
    <url>%2F2017%2F11%2F02%2FLinux-get-System-Infomation%2F</url>
    <content type="text"><![CDATA[å½“ç³»ç»Ÿå¯åŠ¨æ—¶ï¼ŒLinux å†…æ ¸ä¼šè‡ªåŠ¨æ£€æµ‹ç¡¬ä»¶è®¾å¤‡å¹¶åŠ è½½ç›¸åº”çš„é©±åŠ¨ç¨‹åºã€‚ä½†è¿™äº›ç¡¬ä»¶æ£€æµ‹ä¿¡æ¯åœ¨å¯åŠ¨æ—¶å¾ˆå¿«å°±æ»šåŠ¨æ¶ˆå¤±ï¼Œæ‰€ä»¥éœ€è¦åœ¨è¿›å…¥ç³»ç»ŸåŽå†æ¬¡æ˜¾ç¤ºè¿™ç±»ä¿¡æ¯ï¼Œä»¥å‘çŽ°æ½œåœ¨çš„é—®é¢˜ã€‚ demsgdmesg å‘½ä»¤å¯ä»¥åˆ—å‡ºç³»ç»Ÿå¯åŠ¨æ—¶ç¡¬ä»¶æ£€æµ‹å’Œé©±åŠ¨åŠ è½½çš„æƒ…å†µï¼Œä»¥åŠåŽç»­ç”±å†…æ ¸ç”Ÿæˆçš„å…¶ä»–ä¿¡æ¯ã€‚dmesg å‘½ä»¤çš„è¾“å‡ºç¤ºä¾‹ï¼šä»Žè¾“å‡ºä¿¡æ¯ä¸­å¯ä»¥æ‰¾åˆ° Linux å†…æ ¸ç‰ˆæœ¬ã€å†…æ ¸å‘½ä»¤è¡Œé€‰é¡¹ä»¥åŠè¿žæŽ¥åˆ°æ­¤è®¡ç®—æœºçš„ç¡¬ä»¶è®¾å¤‡ï¼Œå¦‚ä¸²å£ã€é¼ æ ‡æŽ¥å£ã€CDé©±åŠ¨å™¨ã€ç½‘å¡å’Œå¹¶è¡Œç«¯å£ç­‰ã€‚ tips:dmesg å‘½ä»¤çš„è¾“å‡ºç¡®å®žæœ‰ç‚¹é•¿ï¼Œæ‰€ä»¥å¸¸é€šè¿‡ç®¡é“ç¬¦ï¼ˆ|ï¼‰å°†å…¶å¯¼å‘ more æˆ– less å‘½ä»¤å•é¡µæ˜¾ç¤ºã€‚æˆ–è€…è¾“é€ç»™ headã€tailã€grepç­‰æ–‡å­—å¤„ç†å·¥å…·ã€‚å¦‚ï¼š# dmesg | head -20 åªè¾“å‡ºå‰ 20 è¡Œæ—¥å¿—# dmesg | tail -20 åªè¾“å‡ºæœ€åŽ 20 è¡Œæ—¥å¿—# dmesg | grep -i usb åªè¾“å‡ºåŒ…å« â€œusbâ€ å­—ç¬¦ä¸²çš„æ—¥å¿—è¡Œï¼ˆ-i é€‰é¡¹è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ï¼‰å¸¸ç”¨ä½œç­›é€‰çš„å­—ç¬¦ä¸²åŒ…æ‹¬ usbã€dmaã€ttyã€memoryã€ethã€sdaç­‰ï¼Œä¹Ÿå¯ä»¥å¤šä¸ªå…³é”®å­—ç›¸ç»„åˆã€‚# dmesg | grep -E -i &quot;eth|sda&quot; ç­›é€‰åŒ…å«å­—ç¬¦ä¸² â€œethâ€ æˆ– â€œsdaâ€ çš„æ—¥å¿—è¡Œ lspcilspci å‘½ä»¤å¯ä»¥åˆ—å‡ºç³»ç»Ÿä¸­çš„ PCI æ€»çº¿åŠå…¶è¿žæŽ¥çš„è®¾å¤‡ã€‚è¯¥å‘½ä»¤çš„è¾“å‡ºå¦‚ä¸‹ï¼šè¾“å‡ºä¿¡æ¯ä¸­åŒ…æ‹¬å£°éŸ³ï¼ˆMultimedia audio controllerï¼‰ï¼ŒUSBè®¾å¤‡ï¼ˆUSB controllerï¼‰ï¼Œè§†é¢‘è¾“å‡ºï¼ˆVGA compatible controllerï¼‰ï¼Œæœ‰çº¿ç½‘å¡ï¼ˆEthernet controllerï¼‰å’Œç£ç›˜ï¼ˆSATA controllerï¼‰ç­‰ã€‚å¦‚éœ€èŽ·å–æ›´è¯¦å°½çš„ä¿¡æ¯ï¼Œè¿˜å¯ä»¥åœ¨è¯¥å‘½ä»¤åŽå¢žåŠ ä¸€è‡³å¤šä¸ª -v é€‰é¡¹ï¼ˆå¦‚ -vvvï¼‰ã€‚ lsusbå¦‚æžœåªå¯¹USBè®¾å¤‡æ„Ÿå…´è¶£ï¼Œå¯ä»¥é€šè¿‡ lsusb å‘½ä»¤æ¥èŽ·çŸ¥USBè®¾å¤‡çš„æƒ…å†µï¼ˆåŒæ ·å¯ä»¥é€šè¿‡å¢žåŠ  -v é€‰é¡¹æ¥èŽ·å–æ›´è¯¦ç»†çš„è¾“å‡ºï¼‰ã€‚ä»¥ä¸Šé¢æˆªå›¾ä¸­ç¬¬ä¸‰è¡Œä¸ºä¾‹ï¼š Bus 002 æŒ‡æ˜Žè®¾å¤‡è¿žæŽ¥åˆ°å“ªæ¡æ€»çº¿ Device 003 è¡¨æ˜Žè¿™æ˜¯è¿žæŽ¥åˆ°æŸæ¡æ€»çº¿çš„ç¬¬ä¸‰å°è®¾å¤‡ ID æŒ‡è®¾å¤‡ id Logitech, Inc. Unifying Receiver è¡¨ç¤ºç”Ÿäº§å•†å’Œè®¾å¤‡å tipsï¼šæ‰¾å‡ºè¿žæŽ¥äº†å¤šå°‘ USB è®¾å¤‡ï¼šfind /dev/bus åˆ—å‡ºæŸå° USB è®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ï¼šlsusb -D /dev/bus/usb/001/002ä»¥æ ‘å±‚ç»“æž„åˆ—å‡º USB è®¾å¤‡ï¼šlsusb -tå…¶ä¸­ 12M å’Œ 480M æŒ‡ USB ç±»åž‹çš„ä¼ è¾“é€ŸçŽ‡ã€‚ 12M æ„å‘³ç€ USB1.0/1.1 çš„é€ŸçŽ‡æ˜¯12Mbit/s 480M æ„å‘³ç€ USB2.0 çš„é€ŸçŽ‡æ˜¯ 480Mbit/s 5.0G æ„å‘³ç€ USB3.0 çš„é€ŸçŽ‡æ˜¯ 5.0 Gbit/s lsblklsblk å‘½ä»¤ç”¨äºŽåˆ—å‡ºæ‰€æœ‰å¯ç”¨å—è®¾å¤‡çš„ä¿¡æ¯ï¼Œè¿˜èƒ½æ˜¾ç¤ºä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚å—è®¾å¤‡æœ‰ç¡¬ç›˜ï¼Œé—ªå­˜ç›˜ï¼Œcd-ROMç­‰ç­‰ã€‚ NAME ï¼šå—è®¾å¤‡åã€‚ MAJ:MIN ï¼šä¸»è¦å’Œæ¬¡è¦è®¾å¤‡å·ã€‚ RM ï¼šè®¾å¤‡æ˜¯å¦å±žäºŽå¯ç§»åŠ¨è®¾å¤‡ã€‚å¦‚ sdb çš„ RM å€¼ä¸º1ï¼Œæ˜¯å¯ç§»åŠ¨è®¾å¤‡ã€‚ SIZE ï¼šè®¾å¤‡çš„å®¹é‡å¤§å°ä¿¡æ¯ã€‚ RO ï¼šè®¾å¤‡æ˜¯å¦ä¸ºåªè¯»ã€‚ TYPE ï¼šè®¾å¤‡æ˜¯ç£ç›˜è¿˜æ˜¯ç£ç›˜ä¸Šçš„ä¸€ä¸ªåˆ†åŒºã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œsda å’Œ sdb æ˜¯ç£ç›˜ï¼Œè€Œ sr0 æ˜¯åªè¯»å­˜å‚¨ï¼ˆromï¼‰ã€‚ MOUNTPOINT ï¼šè®¾å¤‡çš„æŒ‚è½½ç‚¹ã€‚ lscpulscpu å‘½ä»¤å¯ä»¥èŽ·å¾— CPU çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚CPUæž¶æž„ï¼ˆå¦‚ i686 æˆ– x86_64ï¼‰ã€è¿ç®—æ¨¡å¼ï¼ˆ32bit æˆ– 64bitï¼‰ã€æ ¸å¿ƒæ•°ã€æ¯é¢—æ ¸å¿ƒçš„çº¿ç¨‹æ•°ã€åž‹å·ã€ä¸»é¢‘ç­‰ã€‚ lsmodå¦‚æžœä½ æ–°å¢žåŠ äº†ç¡¬ä»¶ï¼Œå´ä¸èƒ½è¢«ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«ã€‚å¯èƒ½ä½ éœ€è¦æ‰‹åŠ¨åœ°åŠ è½½å¯¹åº”çš„å†…æ ¸æ¨¡å—ã€‚å†…æ ¸æ¨¡å—å®‰è£…åœ¨ /lib/modules/ çš„å­ç›®å½•ä¸‹ï¼Œè¯¥å­ç›®å½•çš„åå­—å¯¹åº”å†…æ ¸çš„ç‰ˆæœ¬ã€‚å³ /lib/modules/4.10.0-19-generic ç›®å½•ä¸‹åŒ…å«äº† 4.10.0-19-generic å†…æ ¸çš„é©±åŠ¨ç¨‹åºã€‚lsmod å‘½ä»¤ç”¨äºŽåˆ—å‡ºå½“å‰ç³»ç»Ÿä¸‹å·²ç»è½½å…¥çš„å†…æ ¸æ¨¡å—ã€‚èŽ·å–å·²åŠ è½½æ¨¡å—çš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ modinfo å‘½ä»¤ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ modprobe å‘½ä»¤åŠ è½½æ¨¡å—ï¼Œrmmod å‘½ä»¤ç§»é™¤æ¨¡å—ã€‚ å‚è€ƒä¹¦ç›®å’Œæ–‡ç« ï¼šLinux Bibleï¼Œ9th EditionLinux lsblk å‘½ä»¤è¯¦è§£Linuxä¸­æ˜¾ç¤ºç³»ç»Ÿä¸­USBä¿¡æ¯çš„lsusbå‘½ä»¤]]></content>
      <categories>
        <category>Admin</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>System</tag>
        <tag>Tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nmap-ç½‘ç»œæ‰«æå®žæˆ˜ï¼ˆ1ï¼‰--ä¸»æœºå‘çŽ°]]></title>
    <url>%2F2017%2F11%2F02%2Fscan-network-using-Nmap-1%2F</url>
    <content type="text"><![CDATA[ä¸»æœºå‘çŽ°æŒ‡çš„æ˜¯ä»Žç½‘ç»œä¸­å¯»æ‰¾æ´»è·ƒä¸»æœºçš„è¿‡ç¨‹ã€‚è¯¥è¿‡ç¨‹çš„å…³æ³¨ç‚¹ä¸åœ¨äºŽå¦‚ä½•èŽ·å–ç›®æ ‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œè€Œæ˜¯åœ¨å°½é‡å‡å°‘èµ„æºæ¶ˆè€—çš„æƒ…å†µä¸‹ï¼ŒèŽ·å¾—ç›®æ ‡ä»¬åœ¨é€»è¾‘ä¸Šçš„åˆ†å¸ƒã€‚ OSI æ¨¡åž‹ OSI æ¨¡åž‹ï¼ˆå³ Open Systems Interconnection model å¼€æ”¾å¼ç³»ç»Ÿäº’è”é€šä¿¡å‚è€ƒæ¨¡åž‹ï¼‰ï¼Œç”±å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰æå‡ºï¼Œæ˜¯ä¸€ä¸ªè¯•å›¾ä½¿å„ç§ç½‘ç»œè®¾å¤‡åœ¨ä¸–ç•ŒèŒƒå›´å†…äº’è”é€šä¿¡çš„æ ‡å‡†æ¡†æž¶ã€‚è¯¥æ¨¡åž‹å°†è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æž„åˆ’åˆ†ä¸º7å±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæœ¬æ–‡æ¶‰åŠåˆ°çš„ä¸»æœºæŽ¢æµ‹æ–¹æ³•ï¼Œä¸»è¦åˆ©ç”¨äº†å®šä¹‰åœ¨ Layer 2ï¼Œ3 å’Œ 4 ä¸Šçš„ç½‘ç»œåè®®ã€‚ 1. Layer 2ï¼ˆARPï¼‰ ä¼˜åŠ¿ éžå¸¸å¿«é€Ÿ é«˜å¯ä¿¡åº¦ åŠ£åŠ¿ ä¸èƒ½æŽ¢æµ‹è¿œç¨‹ç³»ç»Ÿï¼ˆARP å±žäºŽä¸å¯è·¯ç”±åè®®ï¼‰ ARPï¼ˆAddress Resolution Protocol åœ°å€è§£æžåè®®ï¼‰æ˜¯é€šè¿‡è§£æžç½‘è·¯å±‚ï¼ˆLayer 3ï¼‰åœ°å€æ¥æ‰¾å¯»æ•°æ®é“¾è·¯å±‚ï¼ˆLayer 2ï¼‰åœ°å€çš„ä¸€ä¸ªé‡è¦çš„ç½‘ç»œä¼ è¾“åè®®ï¼Œå³å°† Layer 3 ä¸­é€»è¾‘æ€§çš„ IP åœ°å€ç¿»è¯‘æˆ Layer 2 ä¸­ç‰©ç†æ€§çš„ MAC åœ°å€ã€‚å‘èµ·æŸ¥è¯¢çš„ä¸»æœºå…ˆåœ¨æœ¬åœ°ç½‘ç»œä¸­å¹¿æ’­ä¸€æ¡ ARP è¯·æ±‚ï¼Œç¬¦åˆè¯¥æŸ¥è¯¢çš„ä¸»æœºåˆ™ç›´æŽ¥è¿”å›žä¸€æ¡åŒ…å«å…¶ MAC åœ°å€çš„ ARP å›žå¤ï¼Œæ”¶åˆ°å›žå¤åŽçš„ä¸»æœºä¼šæ›´æ–°ä¿å­˜åœ¨æœ¬åœ°çš„ ARP ç¼“å­˜å¹¶å¼€å¯ä¸¤è€…é—´çš„ç½‘ç»œé€šä¿¡ã€‚è¯¥è¿‡ç¨‹ä¸ä½¿ç”¨ä»»ä½•å½¢å¼çš„èº«ä»½éªŒè¯å’ŒæŽˆæƒã€‚ å‘½ä»¤ç¤ºä¾‹# nmap -sn 10.1.87.0-255# nmap -sn 10.1.87.0/24# nmap -iL iplist.txt -sn -sn é€‰é¡¹åŒ -sPï¼Œå³å…³é—­é»˜è®¤çš„ç«¯å£æ‰«æï¼Œåªæ‰§è¡Œ Ping æ‰«æï¼Œè¿™åœ¨ä¸»æœºå‘çŽ°æ—¶å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚ä»Žè¡¨é¢ä¸Šçœ‹ï¼Œæ‰§è¡Œçš„ Ping æ‰«æå±žäºŽ Layer 3 ä¸Šçš„åè®®ã€‚è¿™é‡Œ nmap ä¼šæ ¹æ®æä¾›çš„ IP åœ°å€è‡ªåŠ¨åˆ¤å®šæ˜¯å¦ä¸ºæœ¬åœ°å­ç½‘ï¼Œå¯¹æœ¬åœ°å­ç½‘å‘é€ ARP è¯·æ±‚ï¼Œå¯¹è¿œç¨‹ç½‘ç»œåˆ™æ‰§è¡Œ Ping æ‰«æã€‚å¦‚ä¸‹å›¾ï¼ˆæœ¬åœ°å­ç½‘ï¼‰ï¼š è¾“å‡ºå†…å®¹åŒ…æ‹¬æ´»è·ƒä¸»æœºçš„ IP åœ°å€ã€ç½‘ç»œå»¶è¿Ÿã€MAC åœ°å€åŠå¯¹åº”çš„ç¡¬ä»¶åŽ‚å•†ã€‚WireShark æ•èŽ·åˆ°çš„æµé‡ä¿¡æ¯ï¼š å½“æŽ¢æµ‹çš„ IP åœ°å€ä¸å±žäºŽæœ¬åœ°å­ç½‘æ—¶ï¼Œåˆ™æ‰§è¡Œ Ping æ‰«æï¼ˆè¾“å‡ºä¿¡æ¯æ—  MAC åœ°å€ï¼‰ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š WireShark æ•èŽ·åˆ°çš„æµé‡ä¿¡æ¯ï¼š 2. Layer 3ï¼ˆICMPï¼‰ ä¼˜åŠ¿ å¯æŽ¢æµ‹è¿œç¨‹ç³»ç»Ÿï¼ˆå¯è·¯ç”±åè®®ï¼‰ ç›¸å¯¹è¾ƒå¿« åŠ£åŠ¿ æ¯” ARP æ…¢ å¯èƒ½è¢«é˜²ç«å¢™æ‹¦æˆª Layer 3 ä¸Šçš„ ICMP æŽ¢æµ‹æ˜¯æœ€ä¸ºäººç†ŸçŸ¥çš„æ‰«ææ‰‹æ®µï¼ˆping å‘½ä»¤æ€»ç”¨è¿‡çš„å§ï¼‰ã€‚ICMP ä»£è¡¨ Internet Control Message Protocolï¼ˆäº’è”ç½‘æŽ§åˆ¶æ¶ˆæ¯åè®®ï¼‰ï¼Œå®ƒçš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå°±æ˜¯é€šè¿‡å‘ç›®æ ‡ä¸»æœºå‘é€ ICMP echo è¯·æ±‚ï¼Œçœ‹æ˜¯å¦æ”¶åˆ° echo å“åº”ï¼Œæ¥ç¡®å®šå…¶æ˜¯å¦å¤„äºŽæ´»è·ƒçŠ¶æ€ã€‚å¦‚ Ping å‘½ä»¤çš„è¾“å‡ºï¼šè¿”å›žç»“æžœä¸­åŒ…æ‹¬ä¿¡å·å¾€è¿”æ—¶é—´å’Œ(ä¿¡æ¯)åŒ…ä¸¢å¤±æƒ…å†µçš„ç»Ÿè®¡ä¿¡æ¯ã€‚ å‰é¢å·²ç»æåˆ°è¿‡ï¼Œnmap çš„ Ping æ‰«æå¯ä»¥æ ¹æ® IP åœ°å€è‡ªè¡Œåœ¨ ARP å’Œ ICMP åè®®é—´åˆ‡æ¢ï¼Œä¸éœ€è¦é¢å¤–çš„é€‰é¡¹ã€‚ 3. Layer 4ï¼ˆTCPï¼‰ ä¼˜åŠ¿ å¯æŽ¢æµ‹è¿œç¨‹ç³»ç»Ÿ æ¯” ICMP æ›´å¯é  åŠ£åŠ¿ æœ‰æ—¶é˜²ç«å¢™ä¼šå¯¼è‡´å¼‚å¸¸ç»“æžœ å…¨å±€æ‰«æä¼šéžå¸¸è€—æ—¶ TCP æ‰«æçš„åŽŸç†åœ¨äºŽï¼Œä¸€æ¡å•ç‹¬çš„ TCP Finish(FIN) åŒ…æˆ–è€… Acknowledge(ACK) åŒ…é€šå¸¸ä¼šè§¦å‘è¿œç¨‹ä¸»æœºçš„ Reset(RST) å“åº”ï¼Œè€Œå‘é€è‡³è¿œç¨‹ä¸»æœºçš„ Synchronize(SYN) åŒ…é€šå¸¸ä¼šè§¦å‘ SYN+ACK æˆ–è€… RST å“åº”ï¼ˆå–å†³äºŽè¢«æ‰«æç«¯å£çš„å¼€æ”¾æƒ…å†µï¼‰ã€‚é‡ç‚¹åœ¨äºŽï¼Œæ¥è‡ªæŒ‡å®šä¸»æœºçš„ä»»ä½•å“åº”éƒ½å¯ä»¥ç¡®å®šè¯¥ä¸»æœºå¤„äºŽå­˜æ´»çŠ¶æ€ã€‚ å½“ç›®æ ‡ä¸»æœºæ‰€æœ‰çš„ TCP æœåŠ¡éƒ½è¢«é˜²ç«å¢™éš”ç¦»æ—¶ï¼ŒUDP æ‰«ææœ‰æ—¶å°±æ˜¾å¾—æžä¸ºæœ‰æ•ˆã€‚ä½†æœ‰äº› UDP æœåŠ¡å›žå¤çš„æ˜¯ ICMP ç«¯å£ä¸å¯è¾¾å“åº”ï¼Œè€Œè¿™ç±»å“åº”ä¼šè¢«é«˜é˜²æŠ¤çš„é˜²ç«å¢™é˜»æ­¢ã€‚å¦ä¸€äº› UDP æœåŠ¡åˆ™åªå¯¹ç‰¹å®šçš„è¯·æ±‚ä½œå‡ºå“åº”ï¼Œä½¿å¾—æœ‰æ•ˆçš„ UDP æ‰«æéœ€è¦é’ˆå¯¹ä¸åŒçš„æœåŠ¡é‡‡ç”¨é’ˆå¯¹æ€§çš„æŠ€æœ¯ã€‚ å‘½ä»¤ç¤ºä¾‹ UDP æ‰«æ# nmap 10.1.87.0-255 -PU53 -sn TCP æ‰«æï¼ˆå‘é€ ACK åŒ…ï¼‰# nmap 10.1.87.0/24 -PA80 -sn é™„ï¼š1. TCP &amp; UDPåœ¨ OSI æ¨¡åž‹ä¸­ï¼ŒIP åè®®ä½äºŽç½‘è·¯å±‚ï¼ˆLayer 3ï¼‰ï¼Œå®ƒå¯ä»¥æä¾›å¯»å€ã€æ•°æ®æŠ¥è·¯ç”±åŠå…¶ä»–åŠŸèƒ½ï¼Œå°†ä¸€å°è®¾å¤‡è¿žæŽ¥è‡³å¦å¤–ä¸€å°è®¾å¤‡ã€‚TCP åè®®ä½äºŽä¼ è¾“å±‚ï¼ˆLayer 4ï¼‰ï¼Œè´Ÿè´£ç®¡ç†è¿žæŽ¥ä»¥åŠå„è®¾å¤‡é—´æ•°æ®çš„ç¨³å®šä¼ è¾“ã€‚ TCP æ˜¯ä¸€ç§è¿žæŽ¥å¯¼å‘ï¼ˆconnection-orientedï¼‰çš„åè®®ã€‚åœ¨ TCP ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´éœ€è¦é€šè¿‡ä¸€ç§ä¸‰æ­¥æ¡æ‰‹çš„æœºåˆ¶æ¥åˆ›å»ºè¿žæŽ¥ã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯é€šè¿‡å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªåŒ…å« SYNï¼ˆsynchronizeï¼‰æ ‡å¿—çš„æ•°æ®åŒ…æ¥åˆå§‹åŒ–è¿žæŽ¥ï¼Œåœ¨ SYN å­—æ®µä¸­åŒ…å«äº†ä¸€ä¸ªéšæœºçš„åˆå§‹åºåˆ—å·ï¼ˆISNï¼‰ã€‚ æŽ¥ç€æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯åŒæ ·å›žå¤ä¸€ä¸ª SYN åŒ…ï¼ˆå…¶ä¸­æœ‰å®ƒè‡ªå·±çš„ ISNï¼‰ã€‚åŒæ—¶æœåŠ¡ç«¯å‘é€ä¸€ä¸ª ACKï¼ˆacknowledgeï¼‰åŒ…æ¥å‘Šè¯‰å®¢æˆ·ç«¯è‡ªå·±æ”¶åˆ°äº†å‰é¢çš„ä¿¡æ¯ã€‚è¯¥ ACK æŠ¥æ–‡ä¸­åŒ…å«äº†å®¢æˆ·ç«¯çš„ ISN+1 çš„å€¼ã€‚ å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ACK åŒ…ï¼ˆåŒ…å« æœåŠ¡ç«¯çš„ ISN+1ï¼‰æ¥å‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œè‡ªå·±å·²æ”¶åˆ°æ¶ˆæ¯ã€‚æ­¤æ—¶ï¼Œä¸¤è€…ä¹‹é—´æ‰å¼€å§‹äº¤æ¢æ•°æ®ã€‚ å½“è¿žæŽ¥å…³é—­æ—¶ï¼š å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåŒ…å« FINï¼ˆfinishï¼‰æ ‡å¿—çš„æ•°æ®åŒ…ã€‚ æœåŠ¡ç«¯å‘é€ ACK åŒ…è¡¨ç¤ºè‡ªå·±å·²æ”¶åˆ°ã€‚ å½“æœåŠ¡ç«¯å‡†å¤‡å¥½å…³é—­æ—¶ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª FIN åŒ…ã€‚ å®¢æˆ·ç«¯å‘é€ ACK åŒ…è¡¨ç¤ºè‡ªå·±å·²æ”¶åˆ°ã€‚å¼€å¯è¿žæŽ¥çš„è¿‡ç¨‹å¯å‚è€ƒä¸‹å›¾ï¼š TCP æ˜¯ä¸€ç§å¼ºè°ƒæ•°æ®å®Œæ•´æ€§çš„åè®®ã€‚é€šè¿‡ä¸Šè¿°æœºåˆ¶ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è‹¥æœ‰ä¸€ä¸ªåŒ…ä¸¢å¤±ï¼ŒTCP ä¼šè‡ªåŠ¨é‡æ–°ä¼ è¾“ï¼ˆç›´åˆ°æŽ¥æ”¶è€…å‘å‡º ACK åŒ…ï¼‰ã€‚å¦‚æžœæ•°æ®åŒ…åˆ°è¾¾æ—¶æ¬¡åºé”™è¯¯ï¼ŒTCP ä¼šå¯¹å®ƒä»¬è¿›è¡Œé‡æŽ’ï¼Œä¹‹åŽæ‰äº¤ç»™åº”ç”¨ç¨‹åºã€‚æ‰€ä»¥ä¼ è¾“æ–‡ä»¶æˆ–è€…é‡è¦æ•°æ®å¦‚ HTTP å’Œ FTP éƒ½æ˜¯ç”¨çš„ TCP åè®®ã€‚ UDP å±žäºŽéžè¿žæŽ¥å¯¼å‘ï¼ˆconnectionlessï¼‰çš„åè®®ã€‚åœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œä»–ä¸éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª UDP è¿žæŽ¥ã€‚å¦‚æžœå‘ç”Ÿä¸¢åŒ…ï¼ŒUDP ä¹Ÿä¸ä¼šé‡å¤å‘é€ï¼ˆä¸¢å¤±åŒ…çš„é‡å‘æ ¹æ®æƒ…å†µç”±åº”ç”¨ç¨‹åºæ¥å®Œæˆï¼‰ã€‚æ‰€ä»¥åƒè§†é¢‘æµç­‰å¯ä»¥æ‰¿å—ä¸¢åŒ…æŸå¤±çš„å¤šåª’ä½“åº”ç”¨å¸¸é€šè¿‡ UDP ä¼ è¾“ã€‚å¸¸è§çš„ä½¿ç”¨ UDP çš„åº”ç”¨ï¼šDNSã€DHCPã€SNMP ç­‰ã€‚ 2. TCPè¡¨å¤´æ ¼å¼ å‚è€ƒä¹¦ç±åŠæ–‡ç« ï¼šKali Linux Network Scanning Cookbook by Justin HutchensTCP ä¸‰å‘äº¤æ¡ (Three-way Handshake)]]></content>
      <categories>
        <category>Pentest</category>
      </categories>
      <tags>
        <tag>Tools</tag>
        <tag>Security</tag>
        <tag>Networking</tag>
        <tag>Pentest</tag>
        <tag>Hacking</tag>
        <tag>TCP/IP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ncat--ç½‘ç»œå·¥å…·ç®±é‡Œçš„ã€Žç‘žå£«å†›åˆ€ã€]]></title>
    <url>%2F2017%2F10%2F19%2FNcat-document%2F</url>
    <content type="text"><![CDATA[Ncat is a general-purpose command-line tool for reading, writing, redirecting, and encrypting data across a network. It aims to be your network Swiss Army knife, handling a wide variety of security testing and administration tasks. ä»¥å‰åœ¨æ‰‹æœºä¸Šè£… busybox ï¼Œæ€»å¬äººè®²åˆ°ä»€ä¹ˆã€Žç‘žå£«å†›åˆ€ã€ã€‚å“¥ä»¬å„¿å°åœ°æ–¹çš„å¨ƒï¼Œæ²¡è§è¿‡å¤§åœºé¢ï¼Œè¿™å›žæ€»ç®—åœ¨ç½‘ä¸Šæ‰¾åˆ°å¼ å›¾ç‰‡ã€‚æ€»çš„æ¥è¯´ï¼ŒNcat è¿˜æ˜¯å¯¹å¾—èµ·è¿™ä¸ªç§°å·çš„ï¼Œå°å·§ä½†åŠŸèƒ½å¼ºæ‚ã€‚è¿™é‡Œåªç®€è¦åœ°ä»‹ç»ä¸‹æœ‰è¶£çš„åŠŸèƒ½ã€‚å…³äºŽå®‰è£…ï¼ŒNcat å…¶å®žæ˜¯ nmap é¡¹ç›®å¯¹ä¼ ç»Ÿçš„ Netcatï¼ˆå³ nc å‘½ä»¤ï¼‰çš„é‡å†™ï¼Œæ˜¯åŒ…å«åœ¨ nmap å®‰è£…åŒ…é‡Œçš„ï¼Œå…·ä½“å¯å‚è€ƒå®˜ç½‘ã€‚ä¸åšèµ˜è¿°ã€‚ ä¸€ã€Ncat ä½œä¸ºæµè§ˆå™¨å‘½ä»¤ç¤ºä¾‹ï¼šncat -C scanme.nmap.org 80å…¶ä¸­ -C æ˜¯æ ¼å¼åŒ–é€‰é¡¹ï¼Œ80 æŒ‡ä»£ç«¯å£å·ï¼ˆ web æœåŠ¡ç›‘å¬ï¼‰ã€‚è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å‘½ä»¤æ˜¯ä»¥äº¤äº’çš„æ–¹å¼æ‰§è¡Œçš„ã€‚å³è¾“å…¥ ncat -C scanme.nmap.org 80 å’Œ å›žè½¦ åŽï¼ŒæŽ¥ç€ç»§ç»­è¾“å…¥ GET / HTTP/1.0 ï¼Œå†æ•²å‡»ä¸¤æ¬¡ å›žè½¦ ã€‚å³å¯èŽ·å–ç›®æ ‡ç½‘ç«™çš„ HTML æ–‡æ¡£å†…å®¹ã€‚ äºŒã€ç›‘å¬æ¨¡å¼ï¼ˆæ¨¡æ‹Ÿ web æœåŠ¡å™¨ï¼‰å‘½ä»¤ç¤ºä¾‹ï¼šncat -l 8080 &lt; hello.httpå…¶ä¸­ hello.http çš„æ–‡ä»¶å†…å®¹ï¼š1234567HTTP/1.0 200 OK&lt;html&gt; &lt;body&gt; &lt;h1&gt;Hello, world!&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; -l å³ â€“listenï¼ˆç›‘å¬ï¼‰ã€‚å®žé™…æ•ˆæžœå¦‚ä¸‹ï¼šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè®¿é—®ä¸€æ¬¡åŽç¨‹åºå³è‡ªåŠ¨é€€å‡ºã€‚ ä¸‰ã€æ‰§è¡Œå‘½ä»¤ï¼ˆè¿œç¨‹ shellï¼‰å‘½ä»¤ç¤ºä¾‹ï¼šncat -l 8080 --exec &quot;/bin/echo Hello.&quot;æ•ˆæžœå¦‚ä¸‹ï¼šè¿›ä¸€æ­¥ï¼Œå¯ä»¥å¼€å¯ä¸€ä¸ªè¿œç¨‹ shell ä¾›å…¶ä»–è®¾å¤‡è¿žæŽ¥ã€‚å‘½ä»¤å¦‚ä¸‹ï¼šncat -l 8022 --exec &quot;/bin/bash -i&quot;æ•ˆæžœå¦‚ä¸‹ï¼š Ncat åŒæ—¶è¿˜æ”¯æŒ sh è„šæœ¬ï¼ˆ â€“sh-exec ï¼‰å’Œ lua è„šæœ¬ï¼ˆ â€“lua-exec ï¼‰ æ³¨ï¼šä»¥ä¸Šæƒ…å½¢å‡æ”¯æŒå±€åŸŸç½‘è¿œç¨‹è®¿é—®ï¼Œè®¿é—®æ—¶å°† IP åœ°å€æ”¹ä¸ºå¯¹åº”æ•°å­—ã€‚æˆªå›¾ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œåªåœ¨æœ¬åœ°æµ‹è¯•ã€‚ å››ã€è®¿é—®æŽ§åˆ¶ åªå…è®¸æŒ‡å®šå®¢æˆ·ç«¯è¿žæŽ¥ï¼šncat -l --allow 10.2.67.204 åªæ‹’ç»æŒ‡å®šå®¢æˆ·ç«¯è¿žæŽ¥ï¼šncat -l --deny 10.2.67.204 åªå…è®¸æŒ‡å®šç½‘æ®µçš„æœ¬åœ° IPï¼š ncat -l --allow 10.2.67.0/24 ncat -l --allow 10.2.67.0-255 ä»Žæ–‡ä»¶ä¸­èŽ·å–å…è®¸è®¿é—®çš„åœ°å€åˆ—è¡¨ï¼šncat -l --allowfile trusted_hosts.txt è®¾ç½®æœ€å¤§è¿žæŽ¥æ•°ä¸º5ï¼šncat -l â€“max-conns 5äº”ã€æ–‡ä»¶ä¼ è¾“ #####ä¼ è¾“å•ä¸ªæ–‡ä»¶ æŽ¥æ”¶è€…ç›‘å¬ï¼šreceiver$ ncat -l &gt; outputfilesender$ ncat --send-only receiver_ip &lt; inputfile å‘é€è€…ç›‘å¬ï¼šsender$ ncat -l --send-only &lt; inputfilereceiver$ ncat sender_ip &gt; outputfile #####ä¼ è¾“ç›®å½•receiver$ ncat -l | tar xzvf -sender$ tar czvf - dirname | ncat --send-only receiver_ipæ•ˆæžœå¦‚ä¸‹ï¼š #####ä¼ è¾“ç£ç›˜é•œåƒï¼ˆåŽ‹ç¼©ï¼‰receiver$ ncat -l | bzip2 -d &gt; sender-hda.imagesender$ cat /dev/hda | bzip2 | ncat --send-only receiver_ipå…­ã€èŠå¤© #####åŒäººèŠå¤©host1$ ncat -lhost2$ ncat host1 #####å¤šäººèŠå¤©server$ ncat -l --chatclients$ ncat server_ipæ•ˆæžœå¦‚ä¸‹ï¼šä¸ƒã€ç®€æ˜“ web æœåŠ¡å™¨ Linux ç”¨æˆ·ï¼šncat -lk -p 8080 --sh-exec &quot;echo -e &#39;HTTP/1.1 200 OK\r\n&#39;; cat index.html&quot; Windows ç”¨æˆ·ï¼šncat -lk -p 8080 --sh-exec &quot;echo HTTP/1.1 200 OK&amp; echo(&amp;type index.html&quot;å…«ã€æµåª’ä½“è§†é¢‘server$ $cat video.avi | ncat -lclient$ ncat server_ip | mplayer -vo x11 -cache 3000 -æ•ˆæžœå¦‚ä¸‹ï¼š]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Admin</tag>
        <tag>Tools</tag>
        <tag>Trick</tag>
        <tag>Networking</tag>
      </tags>
  </entry>
</search>
